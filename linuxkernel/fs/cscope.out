cscope 15 $HOME/podarch/backup/shwetasshinde24-podos-83e288ccac99/linux-3.2/fs               0001979105
	@aio.c

11 
	~<lšux/k”Ãl.h
>

12 
	~<lšux/š™.h
>

13 
	~<lšux/”ºo.h
>

14 
	~<lšux/time.h
>

15 
	~<lšux/aio_abi.h
>

16 
	~<lšux/moduË.h
>

17 
	~<lšux/sysÿÎs.h
>

18 
	~<lšux/backšg-dev.h
>

19 
	~<lšux/uio.h
>

21 
	#DEBUG
 0

	)

23 
	~<lšux/sched.h
>

24 
	~<lšux/fs.h
>

25 
	~<lšux/fe.h
>

26 
	~<lšux/mm.h
>

27 
	~<lšux/mmª.h
>

28 
	~<lšux/mmu_cÚ‹xt.h
>

29 
	~<lšux/¦ab.h
>

30 
	~<lšux/tim”.h
>

31 
	~<lšux/aio.h
>

32 
	~<lšux/highmem.h
>

33 
	~<lšux/wÜkqueue.h
>

34 
	~<lšux/£cur™y.h
>

35 
	~<lšux/ev’tfd.h
>

36 
	~<lšux/blkdev.h
>

37 
	~<lšux/com·t.h
>

39 
	~<asm/km­_ty³s.h
>

40 
	~<asm/uacûss.h
>

42 #ià
DEBUG
 > 1

43 
	#d´štk
 
´štk


	)

45 
	#d´štk
(
x
...èdØ{ ; } 0)

	)

49 
DEFINE_SPINLOCK
(
aio_Ä_lock
);

50 
	gaio_Ä
;

51 
	gaio_max_Ä
 = 0x10000;

54 
kmem_ÿche
 *
	gkiocb_ÿch•
;

55 
kmem_ÿche
 *
	gkioùx_ÿch•
;

57 
wÜkqueue_¡ruù
 *
	gaio_wq
;

60 
aio_åut_routše
(
wÜk_¡ruù
 *);

61 
DECLARE_WORK
(
åut_wÜk
, 
aio_åut_routše
);

63 
DEFINE_SPINLOCK
(
åut_lock
);

64 
LIST_HEAD
(
åut_h—d
);

66 
aio_kick_hªdËr
(
wÜk_¡ruù
 *);

67 
aio_queue_wÜk
(
kioùx
 *);

73 
__š™
 
	$aio_£tup
()

75 
kiocb_ÿch•
 = 
	`KMEM_CACHE
(
kiocb
, 
SLAB_HWCACHE_ALIGN
|
SLAB_PANIC
);

76 
kioùx_ÿch•
 = 
	`KMEM_CACHE
(
kioùx
,
SLAB_HWCACHE_ALIGN
|
SLAB_PANIC
);

78 
aio_wq
 = 
	`®loc_wÜkqueue
("aio", 0, 1);

79 
	`BUG_ON
(!
aio_wq
);

81 
	`´_debug
("aio_£tup: sizeof(¡ruù…ageèğ%d\n", ()(
·ge
));

84 
	}
}

85 
__š™ÿÎ
(
aio_£tup
);

87 
	$aio_ä“_ršg
(
kioùx
 *
ùx
)

89 
aio_ršg_šfo
 *
šfo
 = &
ùx
->
ršg_šfo
;

90 
i
;

92 
i
=0; i<
šfo
->
Ä_·ges
; i++)

93 
	`put_·ge
(
šfo
->
ršg_·ges
[
i
]);

95 ià(
šfo
->
mm­_size
) {

96 
	`down_wr™e
(&
ùx
->
mm
->
mm­_£m
);

97 
	`do_munm­
(
ùx
->
mm
, 
šfo
->
mm­_ba£
, info->
mm­_size
);

98 
	`up_wr™e
(&
ùx
->
mm
->
mm­_£m
);

101 ià(
šfo
->
ršg_·ges
 && info->ršg_·ge !ğšfo->
š‹º®_·ges
)

102 
	`kä“
(
šfo
->
ršg_·ges
);

103 
šfo
->
ršg_·ges
 = 
NULL
;

104 
šfo
->
Ä
 = 0;

105 
	}
}

107 
	$aio_£tup_ršg
(
kioùx
 *
ùx
)

109 
aio_ršg
 *
ršg
;

110 
aio_ršg_šfo
 *
šfo
 = &
ùx
->
ršg_šfo
;

111 
Ä_ev’ts
 = 
ùx
->
max_»qs
;

112 
size
;

113 
Ä_·ges
;

116 
Ä_ev’ts
 += 2;

118 
size
 = (
aio_ršg
);

119 
size
 +ğ(
io_ev’t
è* 
Ä_ev’ts
;

120 
Ä_·ges
 = (
size
 + 
PAGE_SIZE
-1è>> 
PAGE_SHIFT
;

122 ià(
Ä_·ges
 < 0)

123  -
EINVAL
;

125 
Ä_ev’ts
 = (
PAGE_SIZE
 * 
Ä_·ges
 - (
aio_ršg
)è/ (
io_ev’t
);

127 
šfo
->
Ä
 = 0;

128 
šfo
->
ršg_·ges
 = info->
š‹º®_·ges
;

129 ià(
Ä_·ges
 > 
AIO_RING_PAGES
) {

130 
šfo
->
ršg_·ges
 = 
	`kÿÎoc
(
Ä_·ges
, (
·ge
 *), 
GFP_KERNEL
);

131 ià(!
šfo
->
ršg_·ges
)

132  -
ENOMEM
;

135 
šfo
->
mm­_size
 = 
Ä_·ges
 * 
PAGE_SIZE
;

136 
	`d´štk
("©‹m±šg mm­ oà%lu by‹s\n", 
šfo
->
mm­_size
);

137 
	`down_wr™e
(&
ùx
->
mm
->
mm­_£m
);

138 
šfo
->
mm­_ba£
 = 
	`do_mm­
(
NULL
, 0, info->
mm­_size
,

139 
PROT_READ
|
PROT_WRITE
, 
MAP_ANONYMOUS
|
MAP_PRIVATE
,

141 ià(
	`IS_ERR
((*)
šfo
->
mm­_ba£
)) {

142 
	`up_wr™e
(&
ùx
->
mm
->
mm­_£m
);

143 
šfo
->
mm­_size
 = 0;

144 
	`aio_ä“_ršg
(
ùx
);

145  -
EAGAIN
;

148 
	`d´štk
("mm­‡dd»ss: 0x%08lx\n", 
šfo
->
mm­_ba£
);

149 
šfo
->
Ä_·ges
 = 
	`g‘_u£r_·ges
(
cu¼’t
, 
ùx
->
mm
,

150 
šfo
->
mm­_ba£
, 
Ä_·ges
,

151 1, 0, 
šfo
->
ršg_·ges
, 
NULL
);

152 
	`up_wr™e
(&
ùx
->
mm
->
mm­_£m
);

154 ià(
	`uÆik–y
(
šfo
->
Ä_·ges
 !=‚r_pages)) {

155 
	`aio_ä“_ršg
(
ùx
);

156  -
EAGAIN
;

159 
ùx
->
u£r_id
 = 
šfo
->
mm­_ba£
;

161 
šfo
->
Ä
 = 
Ä_ev’ts
;

163 
ršg
 = 
	`km­_©omic
(
šfo
->
ršg_·ges
[0], 
KM_USER0
);

164 
ršg
->
Ä
 = 
Ä_ev’ts
;

165 
ršg
->
id
 = 
ùx
->
u£r_id
;

166 
ršg
->
h—d
 =„šg->

 = 0;

167 
ršg
->
magic
 = 
AIO_RING_MAGIC
;

168 
ršg
->
com·t_ã©u»s
 = 
AIO_RING_COMPAT_FEATURES
;

169 
ršg
->
šcom·t_ã©u»s
 = 
AIO_RING_INCOMPAT_FEATURES
;

170 
ršg
->
h—d”_Ëngth
 = (
aio_ršg
);

171 
	`kunm­_©omic
(
ršg
, 
KM_USER0
);

174 
	}
}

180 
	#AIO_EVENTS_PER_PAGE
 (
PAGE_SIZE
 / (
io_ev’t
))

	)

181 
	#AIO_EVENTS_FIRST_PAGE
 ((
PAGE_SIZE
 - (
aio_ršg
)è/ (
io_ev’t
))

	)

182 
	#AIO_EVENTS_OFFSET
 (
AIO_EVENTS_PER_PAGE
 - 
AIO_EVENTS_FIRST_PAGE
)

	)

184 
	#aio_ršg_ev’t
(
šfo
, 
Ä
, 
km
) ({ \

185 
pos
 = (
Ä
è+ 
AIO_EVENTS_OFFSET
; \

186 
io_ev’t
 *
__ev’t
; \

187 
__ev’t
 = 
	`km­_©omic
( \

188 (
šfo
)->
ršg_·ges
[
pos
 / 
AIO_EVENTS_PER_PAGE
], 
km
); \

189 
__ev’t
 +ğ
pos
 % 
AIO_EVENTS_PER_PAGE
; \

190 
__ev’t
; \

191 })

	)

193 
	#put_aio_ršg_ev’t
(
ev’t
, 
km
) do { \

194 
io_ev’t
 *
__ev’t
 = (
ev’t
); \

195 ()
__ev’t
; \

196 
	`kunm­_©omic
((*)(()
__ev’t
 & 
PAGE_MASK
), 
km
); \

197 } 0)

	)

199 
	$ùx_rcu_ä“
(
rcu_h—d
 *
h—d
)

201 
kioùx
 *
ùx
 = 
	`cÚš”_of
(
h—d
, kioùx, 
rcu_h—d
);

202 
Ä_ev’ts
 = 
ùx
->
max_»qs
;

204 
	`kmem_ÿche_ä“
(
kioùx_ÿch•
, 
ùx
);

206 ià(
Ä_ev’ts
) {

207 
	`¥š_lock
(&
aio_Ä_lock
);

208 
	`BUG_ON
(
aio_Ä
 - 
Ä_ev’ts
 >‡io_nr);

209 
aio_Ä
 -ğ
Ä_ev’ts
;

210 
	`¥š_uÆock
(&
aio_Ä_lock
);

212 
	}
}

218 
	$__put_ioùx
(
kioùx
 *
ùx
)

220 
	`BUG_ON
(
ùx
->
»qs_aùive
);

222 
	`ÿnûl_d–ayed_wÜk
(&
ùx
->
wq
);

223 
	`ÿnûl_wÜk_sync
(&
ùx
->
wq
.
wÜk
);

224 
	`aio_ä“_ršg
(
ùx
);

225 
	`mmdrİ
(
ùx
->
mm
);

226 
ùx
->
mm
 = 
NULL
;

227 
	`´_debug
("__put_ioùx: f»ešg %p\n", 
ùx
);

228 
	`ÿÎ_rcu
(&
ùx
->
rcu_h—d
, 
ùx_rcu_ä“
);

229 
	}
}

231 
šlše
 
	$g‘_ioùx
(
kioùx
 *kioctx)

233 
	`BUG_ON
(
	`©omic_»ad
(&
kioùx
->
u£rs
) <= 0);

234 
	`©omic_šc
(&
kioùx
->
u£rs
);

235 
	}
}

237 
šlše
 
	$Œy_g‘_ioùx
(
kioùx
 *kioctx)

239  
	`©omic_šc_nÙ_z”o
(&
kioùx
->
u£rs
);

240 
	}
}

242 
šlše
 
	$put_ioùx
(
kioùx
 *kioctx)

244 
	`BUG_ON
(
	`©omic_»ad
(&
kioùx
->
u£rs
) <= 0);

245 ià(
	`uÆik–y
(
	`©omic_dec_ªd_‹¡
(&
kioùx
->
u£rs
)))

246 
	`__put_ioùx
(
kioùx
);

247 
	}
}

252 
kioùx
 *
	$ioùx_®loc
(
Ä_ev’ts
)

254 
mm_¡ruù
 *
mm
;

255 
kioùx
 *
ùx
;

256 
did_sync
 = 0;

259 ià((
Ä_ev’ts
 > (0x10000000U / (
io_ev’t
))) ||

260 (
Ä_ev’ts
 > (0x10000000U / (
kiocb
)))) {

261 
	`´_debug
("ENOMEM:‚r_eventsoo high\n");

262  
	`ERR_PTR
(-
EINVAL
);

265 ià(()
Ä_ev’ts
 > 
aio_max_Ä
)

266  
	`ERR_PTR
(-
EAGAIN
);

268 
ùx
 = 
	`kmem_ÿche_z®loc
(
kioùx_ÿch•
, 
GFP_KERNEL
);

269 ià(!
ùx
)

270  
	`ERR_PTR
(-
ENOMEM
);

272 
ùx
->
max_»qs
 = 
Ä_ev’ts
;

273 
mm
 = 
ùx
->mm = 
cu¼’t
->mm;

274 
	`©omic_šc
(&
mm
->
mm_couÁ
);

276 
	`©omic_£t
(&
ùx
->
u£rs
, 1);

277 
	`¥š_lock_š™
(&
ùx
->
ùx_lock
);

278 
	`¥š_lock_š™
(&
ùx
->
ršg_šfo
.
ršg_lock
);

279 
	`š™_wa™queue_h—d
(&
ùx
->
wa™
);

281 
	`INIT_LIST_HEAD
(&
ùx
->
aùive_»qs
);

282 
	`INIT_LIST_HEAD
(&
ùx
->
run_li¡
);

283 
	`INIT_DELAYED_WORK
(&
ùx
->
wq
, 
aio_kick_hªdËr
);

285 ià(
	`aio_£tup_ršg
(
ùx
) < 0)

286 
out_ä“ùx
;

290 
	`¥š_lock_bh
(&
aio_Ä_lock
);

291 ià(
aio_Ä
 + 
Ä_ev’ts
 > 
aio_max_Ä
 ||

292 
aio_Ä
 + 
Ä_ev’ts
 <‡io_nr)

293 
ùx
->
max_»qs
 = 0;

295 
aio_Ä
 +ğ
ùx
->
max_»qs
;

296 
	`¥š_uÆock_bh
(&
aio_Ä_lock
);

297 ià(
ùx
->
max_»qs
 || 
did_sync
)

301 
	`synchrÚize_rcu
();

302 
did_sync
 = 1;

303 
ùx
->
max_»qs
 = 
Ä_ev’ts
;

306 ià(
ùx
->
max_»qs
 == 0)

307 
out_ş—nup
;

310 
	`¥š_lock
(&
mm
->
ioùx_lock
);

311 
	`hli¡_add_h—d_rcu
(&
ùx
->
li¡
, &
mm
->
ioùx_li¡
);

312 
	`¥š_uÆock
(&
mm
->
ioùx_lock
);

314 
	`d´štk
("aio:‡llocated ioctx %p[%ld]: mm=%p mask=0x%x\n",

315 
ùx
, ctx->
u£r_id
, 
cu¼’t
->
mm
, ctx->
ršg_šfo
.
Ä
);

316  
ùx
;

318 
out_ş—nup
:

319 
	`__put_ioùx
(
ùx
);

320  
	`ERR_PTR
(-
EAGAIN
);

322 
out_ä“ùx
:

323 
	`mmdrİ
(
mm
);

324 
	`kmem_ÿche_ä“
(
kioùx_ÿch•
, 
ùx
);

325 
ùx
 = 
	`ERR_PTR
(-
ENOMEM
);

327 
	`d´štk
("aio:ƒ¼Ü‡Îoÿtšg ioùx %p\n", 
ùx
);

328  
ùx
;

329 
	}
}

336 
	$aio_ÿnûl_®l
(
kioùx
 *
ùx
)

338 (*
ÿnûl
)(
kiocb
 *, 
io_ev’t
 *);

339 
io_ev’t
 
»s
;

340 
	`¥š_lock_œq
(&
ùx
->
ùx_lock
);

341 
ùx
->
d—d
 = 1;

342 !
	`li¡_em±y
(&
ùx
->
aùive_»qs
)) {

343 
li¡_h—d
 *
pos
 = 
ùx
->
aùive_»qs
.
Ãxt
;

344 
kiocb
 *
iocb
 = 
	`li¡_kiocb
(
pos
);

345 
	`li¡_d–_š™
(&
iocb
->
ki_li¡
);

346 
ÿnûl
 = 
iocb
->
ki_ÿnûl
;

347 
	`kiocbS‘CªûÎed
(
iocb
);

348 ià(
ÿnûl
) {

349 
iocb
->
ki_u£rs
++;

350 
	`¥š_uÆock_œq
(&
ùx
->
ùx_lock
);

351 
	`ÿnûl
(
iocb
, &
»s
);

352 
	`¥š_lock_œq
(&
ùx
->
ùx_lock
);

355 
	`¥š_uÆock_œq
(&
ùx
->
ùx_lock
);

356 
	}
}

358 
	$wa™_fÜ_®l_aios
(
kioùx
 *
ùx
)

360 
sk_¡ruù
 *
tsk
 = 
cu¼’t
;

361 
	`DECLARE_WAITQUEUE
(
wa™
, 
tsk
);

363 
	`¥š_lock_œq
(&
ùx
->
ùx_lock
);

364 ià(!
ùx
->
»qs_aùive
)

365 
out
;

367 
	`add_wa™_queue
(&
ùx
->
wa™
, &wait);

368 
	`£t_sk_¡©e
(
tsk
, 
TASK_UNINTERRUPTIBLE
);

369 
ùx
->
»qs_aùive
) {

370 
	`¥š_uÆock_œq
(&
ùx
->
ùx_lock
);

371 
	`io_scheduË
();

372 
	`£t_sk_¡©e
(
tsk
, 
TASK_UNINTERRUPTIBLE
);

373 
	`¥š_lock_œq
(&
ùx
->
ùx_lock
);

375 
	`__£t_sk_¡©e
(
tsk
, 
TASK_RUNNING
);

376 
	`»move_wa™_queue
(&
ùx
->
wa™
, &wait);

378 
out
:

379 
	`¥š_uÆock_œq
(&
ùx
->
ùx_lock
);

380 
	}
}

385 
ssize_t
 
	$wa™_Ú_sync_kiocb
(
kiocb
 *
iocb
)

387 
iocb
->
ki_u£rs
) {

388 
	`£t_cu¼’t_¡©e
(
TASK_UNINTERRUPTIBLE
);

389 ià(!
iocb
->
ki_u£rs
)

391 
	`io_scheduË
();

393 
	`__£t_cu¼’t_¡©e
(
TASK_RUNNING
);

394  
iocb
->
ki_u£r_d©a
;

395 
	}
}

396 
EXPORT_SYMBOL
(
wa™_Ú_sync_kiocb
);

405 
	$ex™_aio
(
mm_¡ruù
 *
mm
)

407 
kioùx
 *
ùx
;

409 !
	`hli¡_em±y
(&
mm
->
ioùx_li¡
)) {

410 
ùx
 = 
	`hli¡_’Œy
(
mm
->
ioùx_li¡
.
fœ¡
, 
kioùx
, 
li¡
);

411 
	`hli¡_d–_rcu
(&
ùx
->
li¡
);

413 
	`aio_ÿnûl_®l
(
ùx
);

415 
	`wa™_fÜ_®l_aios
(
ùx
);

419 
	`ÿnûl_wÜk_sync
(&
ùx
->
wq
.
wÜk
);

421 ià(1 !ğ
	`©omic_»ad
(&
ùx
->
u£rs
))

422 
	`´štk
(
KERN_DEBUG


424 
	`©omic_»ad
(&
ùx
->
u£rs
), ctx->
d—d
,

425 
ùx
->
»qs_aùive
);

426 
	`put_ioùx
(
ùx
);

428 
	}
}

440 
kiocb
 *
	$__aio_g‘_»q
(
kioùx
 *
ùx
)

442 
kiocb
 *
»q
 = 
NULL
;

444 
»q
 = 
	`kmem_ÿche_®loc
(
kiocb_ÿch•
, 
GFP_KERNEL
);

445 ià(
	`uÆik–y
(!
»q
))

446  
NULL
;

448 
»q
->
ki_æags
 = 0;

449 
»q
->
ki_u£rs
 = 2;

450 
»q
->
ki_key
 = 0;

451 
»q
->
ki_ùx
 = 
ùx
;

452 
»q
->
ki_ÿnûl
 = 
NULL
;

453 
»q
->
ki_»Œy
 = 
NULL
;

454 
»q
->
ki_dtÜ
 = 
NULL
;

455 
»q
->
´iv©e
 = 
NULL
;

456 
»q
->
ki_iovec
 = 
NULL
;

457 
	`INIT_LIST_HEAD
(&
»q
->
ki_run_li¡
);

458 
»q
->
ki_ev’tfd
 = 
NULL
;

460  
»q
;

461 
	}
}

467 
	#KIOCB_BATCH_SIZE
 32L

	)

468 
	skiocb_b©ch
 {

469 
li¡_h—d
 
	mh—d
;

470 
	mcouÁ
;

473 
	$kiocb_b©ch_š™
(
kiocb_b©ch
 *
b©ch
, 
tÙ®
)

475 
	`INIT_LIST_HEAD
(&
b©ch
->
h—d
);

476 
b©ch
->
couÁ
 = 
tÙ®
;

477 
	}
}

479 
	$kiocb_b©ch_ä“
(
kiocb_b©ch
 *
b©ch
)

481 
kiocb
 *
»q
, *
n
;

483 
	`li¡_fÜ_—ch_’Œy_§ã
(
»q
, 
n
, &
b©ch
->
h—d
, 
ki_b©ch
) {

484 
	`li¡_d–
(&
»q
->
ki_b©ch
);

485 
	`kmem_ÿche_ä“
(
kiocb_ÿch•
, 
»q
);

487 
	}
}

493 
	$kiocb_b©ch_»fl
(
kioùx
 *
ùx
, 
kiocb_b©ch
 *
b©ch
)

495 
®loÿ‹d
, 
to_®loc
;

496 
ava
;

497 
boŞ
 
ÿÎed_åut
 = 
çl£
;

498 
kiocb
 *
»q
, *
n
;

499 
aio_ršg
 *
ršg
;

501 
to_®loc
 = 
	`mš
(
b©ch
->
couÁ
, 
KIOCB_BATCH_SIZE
);

502 
®loÿ‹d
 = 0;‡Îoÿ‹d < 
to_®loc
;‡llocated++) {

503 
»q
 = 
	`__aio_g‘_»q
(
ùx
);

504 ià(!
»q
)

507 
	`li¡_add
(&
»q
->
ki_b©ch
, &
b©ch
->
h—d
);

510 ià(
®loÿ‹d
 == 0)

511 
out
;

513 
»Œy
:

514 
	`¥š_lock_œq
(&
ùx
->
ùx_lock
);

515 
ršg
 = 
	`km­_©omic
(
ùx
->
ršg_šfo
.
ršg_·ges
[0]);

517 
ava
 = 
	`aio_ršg_ava
(&
ùx
->
ršg_šfo
, 
ršg
è- ctx->
»qs_aùive
;

518 
	`BUG_ON
(
ava
 < 0);

519 ià(
ava
 =ğ0 && !
ÿÎed_åut
) {

528 
	`kunm­_©omic
(
ršg
);

529 
	`¥š_uÆock_œq
(&
ùx
->
ùx_lock
);

530 
	`aio_åut_routše
(
NULL
);

531 
ÿÎed_åut
 = 
Œue
;

532 
»Œy
;

535 ià(
ava
 < 
®loÿ‹d
) {

537 
	`li¡_fÜ_—ch_’Œy_§ã
(
»q
, 
n
, &
b©ch
->
h—d
, 
ki_b©ch
) {

538 
	`li¡_d–
(&
»q
->
ki_b©ch
);

539 
	`kmem_ÿche_ä“
(
kiocb_ÿch•
, 
»q
);

540 ià(--
®loÿ‹d
 <ğ
ava
)

545 
b©ch
->
couÁ
 -ğ
®loÿ‹d
;

546 
	`li¡_fÜ_—ch_’Œy
(
»q
, &
b©ch
->
h—d
, 
ki_b©ch
) {

547 
	`li¡_add
(&
»q
->
ki_li¡
, &
ùx
->
aùive_»qs
);

548 
ùx
->
»qs_aùive
++;

551 
	`kunm­_©omic
(
ršg
);

552 
	`¥š_uÆock_œq
(&
ùx
->
ùx_lock
);

554 
out
:

555  
®loÿ‹d
;

556 
	}
}

558 
šlše
 
kiocb
 *
	$aio_g‘_»q
(
kioùx
 *
ùx
,

559 
kiocb_b©ch
 *
b©ch
)

561 
kiocb
 *
»q
;

563 ià(
	`li¡_em±y
(&
b©ch
->
h—d
))

564 ià(
	`kiocb_b©ch_»fl
(
ùx
, 
b©ch
) == 0)

565  
NULL
;

566 
»q
 = 
	`li¡_fœ¡_’Œy
(&
b©ch
->
h—d
, 
kiocb
, 
ki_b©ch
);

567 
	`li¡_d–
(&
»q
->
ki_b©ch
);

568  
»q
;

569 
	}
}

571 
šlše
 
	$»®ly_put_»q
(
kioùx
 *
ùx
, 
kiocb
 *
»q
)

573 
	`as£¹_¥š_locked
(&
ùx
->
ùx_lock
);

575 ià(
»q
->
ki_ev’tfd
 !ğ
NULL
)

576 
	`ev’tfd_ùx_put
(
»q
->
ki_ev’tfd
);

577 ià(
»q
->
ki_dtÜ
)

578 
»q
->
	`ki_dtÜ
(req);

579 ià(
»q
->
ki_iovec
 !ğ&»q->
ki_šlše_vec
)

580 
	`kä“
(
»q
->
ki_iovec
);

581 
	`kmem_ÿche_ä“
(
kiocb_ÿch•
, 
»q
);

582 
ùx
->
»qs_aùive
--;

584 ià(
	`uÆik–y
(!
ùx
->
»qs_aùive
 && ctx->
d—d
))

585 
	`wake_up_®l
(&
ùx
->
wa™
);

586 
	}
}

588 
	$aio_åut_routše
(
wÜk_¡ruù
 *
d©a
)

590 
	`¥š_lock_œq
(&
åut_lock
);

591 
	`lik–y
(!
	`li¡_em±y
(&
åut_h—d
))) {

592 
kiocb
 *
»q
 = 
	`li¡_kiocb
(
åut_h—d
.
Ãxt
);

593 
kioùx
 *
ùx
 = 
»q
->
ki_ùx
;

595 
	`li¡_d–
(&
»q
->
ki_li¡
);

596 
	`¥š_uÆock_œq
(&
åut_lock
);

599 ià(
»q
->
ki_fp
 !ğ
NULL
)

600 
	`åut
(
»q
->
ki_fp
);

603 
	`¥š_lock_œq
(&
ùx
->
ùx_lock
);

604 
	`»®ly_put_»q
(
ùx
, 
»q
);

605 
	`¥š_uÆock_œq
(&
ùx
->
ùx_lock
);

607 
	`put_ioùx
(
ùx
);

608 
	`¥š_lock_œq
(&
åut_lock
);

610 
	`¥š_uÆock_œq
(&
åut_lock
);

611 
	}
}

616 
	$__aio_put_»q
(
kioùx
 *
ùx
, 
kiocb
 *
»q
)

618 
	`d´štk
(
KERN_DEBUG
 "aio_put(%p): f_count=%ld\n",

619 
»q
, 
	`©omic_lÚg_»ad
(&»q->
ki_fp
->
f_couÁ
));

621 
	`as£¹_¥š_locked
(&
ùx
->
ùx_lock
);

623 
»q
->
ki_u£rs
--;

624 
	`BUG_ON
(
»q
->
ki_u£rs
 < 0);

625 ià(
	`lik–y
(
»q
->
ki_u£rs
))

627 
	`li¡_d–
(&
»q
->
ki_li¡
);

628 
»q
->
ki_ÿnûl
 = 
NULL
;

629 
»q
->
ki_»Œy
 = 
NULL
;

637 ià(
	`uÆik–y
(!
	`åut_©omic
(
»q
->
ki_fp
))) {

638 
	`g‘_ioùx
(
ùx
);

639 
	`¥š_lock
(&
åut_lock
);

640 
	`li¡_add
(&
»q
->
ki_li¡
, &
åut_h—d
);

641 
	`¥š_uÆock
(&
åut_lock
);

642 
	`scheduË_wÜk
(&
åut_wÜk
);

644 
»q
->
ki_fp
 = 
NULL
;

645 
	`»®ly_put_»q
(
ùx
, 
»q
);

648 
	}
}

654 
	$aio_put_»q
(
kiocb
 *
»q
)

656 
kioùx
 *
ùx
 = 
»q
->
ki_ùx
;

657 
»t
;

658 
	`¥š_lock_œq
(&
ùx
->
ùx_lock
);

659 
»t
 = 
	`__aio_put_»q
(
ùx
, 
»q
);

660 
	`¥š_uÆock_œq
(&
ùx
->
ùx_lock
);

661  
»t
;

662 
	}
}

663 
EXPORT_SYMBOL
(
aio_put_»q
);

665 
kioùx
 *
	$lookup_ioùx
(
ùx_id
)

667 
mm_¡ruù
 *
mm
 = 
cu¼’t
->mm;

668 
kioùx
 *
ùx
, *
»t
 = 
NULL
;

669 
hli¡_node
 *
n
;

671 
	`rcu_»ad_lock
();

673 
	`hli¡_fÜ_—ch_’Œy_rcu
(
ùx
, 
n
, &
mm
->
ioùx_li¡
, 
li¡
) {

680 ià(
ùx
->
u£r_id
 =ğ
ùx_id
 && !ùx->
d—d
 && 
	`Œy_g‘_ioùx
(ctx)){

681 
»t
 = 
ùx
;

686 
	`rcu_»ad_uÆock
();

687  
»t
;

688 
	}
}

699 
šlše
 
	$__queue_kicked_iocb
(
kiocb
 *
iocb
)

701 
kioùx
 *
ùx
 = 
iocb
->
ki_ùx
;

703 
	`as£¹_¥š_locked
(&
ùx
->
ùx_lock
);

705 ià(
	`li¡_em±y
(&
iocb
->
ki_run_li¡
)) {

706 
	`li¡_add_
(&
iocb
->
ki_run_li¡
,

707 &
ùx
->
run_li¡
);

711 
	}
}

735 
ssize_t
 
	$aio_run_iocb
(
kiocb
 *
iocb
)

737 
kioùx
 *
ùx
 = 
iocb
->
ki_ùx
;

738 
	`ssize_t
 (*
»Œy
)(
kiocb
 *);

739 
ssize_t
 
»t
;

741 ià(!(
»Œy
 = 
iocb
->
ki_»Œy
)) {

742 
	`´štk
("aio_run_iocb: iocb->ki_retry = NULL\n");

765 
	`kiocbCË¬Kicked
(
iocb
);

773 
iocb
->
ki_run_li¡
.
Ãxt
 = iocb->ki_run_li¡.
´ev
 = 
NULL
;

774 
	`¥š_uÆock_œq
(&
ùx
->
ùx_lock
);

777 ià(
	`kiocbIsCªûÎed
(
iocb
)) {

778 
»t
 = -
EINTR
;

779 
	`aio_com¶‘e
(
iocb
, 
»t
, 0);

781 
out
;

788 
»t
 = 
	`»Œy
(
iocb
);

790 ià(
»t
 !ğ-
EIOCBRETRY
 &&„‘ !ğ-
EIOCBQUEUED
) {

795 ià(
	`uÆik–y
(
»t
 =ğ-
ERESTARTSYS
 ||„‘ =ğ-
ERESTARTNOINTR
 ||

796 
»t
 =ğ-
ERESTARTNOHAND
 ||„‘ =ğ-
ERESTART_RESTARTBLOCK
))

797 
»t
 = -
EINTR
;

798 
	`aio_com¶‘e
(
iocb
, 
»t
, 0);

800 
out
:

801 
	`¥š_lock_œq
(&
ùx
->
ùx_lock
);

803 ià(-
EIOCBRETRY
 =ğ
»t
) {

812 
	`INIT_LIST_HEAD
(&
iocb
->
ki_run_li¡
);

815 ià(
	`kiocbIsKicked
(
iocb
)) {

816 
	`__queue_kicked_iocb
(
iocb
);

824 
	`aio_queue_wÜk
(
ùx
);

827  
»t
;

828 
	}
}

837 
	$__aio_run_iocbs
(
kioùx
 *
ùx
)

839 
kiocb
 *
iocb
;

840 
li¡_h—d
 
run_li¡
;

842 
	`as£¹_¥š_locked
(&
ùx
->
ùx_lock
);

844 
	`li¡_»¶aû_š™
(&
ùx
->
run_li¡
, &run_list);

845 !
	`li¡_em±y
(&
run_li¡
)) {

846 
iocb
 = 
	`li¡_’Œy
(
run_li¡
.
Ãxt
, 
kiocb
,

847 
ki_run_li¡
);

848 
	`li¡_d–
(&
iocb
->
ki_run_li¡
);

852 
iocb
->
ki_u£rs
++;

853 
	`aio_run_iocb
(
iocb
);

854 
	`__aio_put_»q
(
ùx
, 
iocb
);

856 ià(!
	`li¡_em±y
(&
ùx
->
run_li¡
))

859 
	}
}

861 
	$aio_queue_wÜk
(
kioùx
 * 
ùx
)

863 
timeout
;

868 
	`smp_mb
();

869 ià(
	`wa™queue_aùive
(&
ùx
->
wa™
))

870 
timeout
 = 1;

872 
timeout
 = 
HZ
/10;

873 
	`queue_d–ayed_wÜk
(
aio_wq
, &
ùx
->
wq
, 
timeout
);

874 
	}
}

883 
šlše
 
	$aio_run_®l_iocbs
(
kioùx
 *
ùx
)

885 
	`¥š_lock_œq
(&
ùx
->
ùx_lock
);

886 
	`__aio_run_iocbs
(
ùx
))

888 
	`¥š_uÆock_œq
(&
ùx
->
ùx_lock
);

889 
	}
}

900 
	$aio_kick_hªdËr
(
wÜk_¡ruù
 *
wÜk
)

902 
kioùx
 *
ùx
 = 
	`cÚš”_of
(
wÜk
, kioùx, 
wq
.work);

903 
mm_£gm’t_t
 
Şdfs
 = 
	`g‘_fs
();

904 
mm_¡ruù
 *
mm
;

905 
»queue
;

907 
	`£t_fs
(
USER_DS
);

908 
	`u£_mm
(
ùx
->
mm
);

909 
	`¥š_lock_œq
(&
ùx
->
ùx_lock
);

910 
»queue
 =
	`__aio_run_iocbs
(
ùx
);

911 
mm
 = 
ùx
->mm;

912 
	`¥š_uÆock_œq
(&
ùx
->
ùx_lock
);

913 
	`unu£_mm
(
mm
);

914 
	`£t_fs
(
Şdfs
);

918 ià(
»queue
)

919 
	`queue_d–ayed_wÜk
(
aio_wq
, &
ùx
->
wq
, 0);

920 
	}
}

928 
	$Œy_queue_kicked_iocb
(
kiocb
 *
iocb
)

930 
kioùx
 *
ùx
 = 
iocb
->
ki_ùx
;

931 
æags
;

932 
run
 = 0;

934 
	`¥š_lock_œq§ve
(&
ùx
->
ùx_lock
, 
æags
);

937 ià(!
	`kiocbTryKick
(
iocb
))

938 
run
 = 
	`__queue_kicked_iocb
(
iocb
);

939 
	`¥š_uÆock_œq»¡Üe
(&
ùx
->
ùx_lock
, 
æags
);

940 ià(
run
)

941 
	`aio_queue_wÜk
(
ùx
);

942 
	}
}

951 
	$kick_iocb
(
kiocb
 *
iocb
)

955 ià(
	`is_sync_kiocb
(
iocb
)) {

956 
	`kiocbS‘Kicked
(
iocb
);

957 
	`wake_up_´oûss
(
iocb
->
ki_obj
.
tsk
);

961 
	`Œy_queue_kicked_iocb
(
iocb
);

962 
	}
}

963 
EXPORT_SYMBOL
(
kick_iocb
);

970 
	$aio_com¶‘e
(
kiocb
 *
iocb
, 
»s
, 
»s2
)

972 
kioùx
 *
ùx
 = 
iocb
->
ki_ùx
;

973 
aio_ršg_šfo
 *
šfo
;

974 
aio_ršg
 *
ršg
;

975 
io_ev’t
 *
ev’t
;

976 
æags
;

977 

;

978 
»t
;

987 ià(
	`is_sync_kiocb
(
iocb
)) {

988 
	`BUG_ON
(
iocb
->
ki_u£rs
 != 1);

989 
iocb
->
ki_u£r_d©a
 = 
»s
;

990 
iocb
->
ki_u£rs
 = 0;

991 
	`wake_up_´oûss
(
iocb
->
ki_obj
.
tsk
);

995 
šfo
 = &
ùx
->
ršg_šfo
;

1003 
	`¥š_lock_œq§ve
(&
ùx
->
ùx_lock
, 
æags
);

1005 ià(
iocb
->
ki_run_li¡
.
´ev
 && !
	`li¡_em±y
(&iocb->ki_run_list))

1006 
	`li¡_d–_š™
(&
iocb
->
ki_run_li¡
);

1012 ià(
	`kiocbIsCªûÎed
(
iocb
))

1013 
put_rq
;

1015 
ršg
 = 
	`km­_©omic
(
šfo
->
ršg_·ges
[0], 
KM_IRQ1
);

1017 

 = 
šfo
->tail;

1018 
ev’t
 = 
	`aio_ršg_ev’t
(
šfo
, 

, 
KM_IRQ0
);

1019 ià(++

 >ğ
šfo
->
Ä
)

1020 

 = 0;

1022 
ev’t
->
obj
 = (
u64
)()
iocb
->
ki_obj
.
u£r
;

1023 
ev’t
->
d©a
 = 
iocb
->
ki_u£r_d©a
;

1024 
ev’t
->
»s
 =„es;

1025 
ev’t
->
»s2
 =„es2;

1027 
	`d´štk
("aio_complete: %p[%lu]: %p: %p %Lx %lx %lx\n",

1028 
ùx
, 

, 
iocb
, iocb->
ki_obj
.
u£r
, iocb->
ki_u£r_d©a
,

1029 
»s
, 
»s2
);

1034 
	`smp_wmb
();

1036 
šfo
->

 =ail;

1037 
ršg
->

 =ail;

1039 
	`put_aio_ršg_ev’t
(
ev’t
, 
KM_IRQ0
);

1040 
	`kunm­_©omic
(
ršg
, 
KM_IRQ1
);

1042 
	`´_debug
("addedØršg %°© [%lu]\n", 
iocb
, 

);

1049 ià(
iocb
->
ki_ev’tfd
 !ğ
NULL
)

1050 
	`ev’tfd_sigÇl
(
iocb
->
ki_ev’tfd
, 1);

1052 
put_rq
:

1054 
»t
 = 
	`__aio_put_»q
(
ùx
, 
iocb
);

1062 
	`smp_mb
();

1064 ià(
	`wa™queue_aùive
(&
ùx
->
wa™
))

1065 
	`wake_up
(&
ùx
->
wa™
);

1067 
	`¥š_uÆock_œq»¡Üe
(&
ùx
->
ùx_lock
, 
æags
);

1068  
»t
;

1069 
	}
}

1070 
EXPORT_SYMBOL
(
aio_com¶‘e
);

1078 
	$aio_»ad_evt
(
kioùx
 *
ioùx
, 
io_ev’t
 *
’t
)

1080 
aio_ršg_šfo
 *
šfo
 = &
ioùx
->
ršg_šfo
;

1081 
aio_ršg
 *
ršg
;

1082 
h—d
;

1083 
»t
 = 0;

1085 
ršg
 = 
	`km­_©omic
(
šfo
->
ršg_·ges
[0], 
KM_USER0
);

1086 
	`d´štk
("in‡io_read_evt h%lu%lu m%lu\n",

1087 ()
ršg
->
h—d
, (ìšg->

,

1088 ()
ršg
->
Ä
);

1090 ià(
ršg
->
h—d
 =ğršg->

)

1091 
out
;

1093 
	`¥š_lock
(&
šfo
->
ršg_lock
);

1095 
h—d
 = 
ršg
->h—d % 
šfo
->
Ä
;

1096 ià(
h—d
 !ğ
ršg
->

) {

1097 
io_ev’t
 *
evp
 = 
	`aio_ršg_ev’t
(
šfo
, 
h—d
, 
KM_USER1
);

1098 *
’t
 = *
evp
;

1099 
h—d
 = (h—d + 1è% 
šfo
->
Ä
;

1100 
	`smp_mb
();

1101 
ršg
->
h—d
 = head;

1102 
»t
 = 1;

1103 
	`put_aio_ršg_ev’t
(
evp
, 
KM_USER1
);

1105 
	`¥š_uÆock
(&
šfo
->
ršg_lock
);

1107 
out
:

1108 
	`kunm­_©omic
(
ršg
, 
KM_USER0
);

1109 
	`d´štk
("Ëavšg‡io_»ad_evt: %d h%lu%lu\n", 
»t
,

1110 ()
ršg
->
h—d
, (ìšg->

);

1111  
»t
;

1112 
	}
}

1114 
	saio_timeout
 {

1115 
tim”_li¡
 
	mtim”
;

1116 
	mtimed_out
;

1117 
sk_¡ruù
 *
	mp
;

1120 
	$timeout_func
(
d©a
)

1122 
aio_timeout
 *
to
 = (aio_timeouˆ*)
d©a
;

1124 
to
->
timed_out
 = 1;

1125 
	`wake_up_´oûss
(
to
->
p
);

1126 
	}
}

1128 
šlše
 
	$š™_timeout
(
aio_timeout
 *
to
)

1130 
	`£tup_tim”_Ú_¡ack
(&
to
->
tim”
, 
timeout_func
, ()o);

1131 
to
->
timed_out
 = 0;

1132 
to
->
p
 = 
cu¼’t
;

1133 
	}
}

1135 
šlše
 
	$£t_timeout
(
¡¬t_jiff›s
, 
aio_timeout
 *
to
,

1136 cÚ¡ 
time¥ec
 *
ts
)

1138 
to
->
tim”
.
expœes
 = 
¡¬t_jiff›s
 + 
	`time¥ec_to_jiff›s
(
ts
);

1139 ià(
	`time_aá”
(
to
->
tim”
.
expœes
, 
jiff›s
))

1140 
	`add_tim”
(&
to
->
tim”
);

1142 
to
->
timed_out
 = 1;

1143 
	}
}

1145 
šlše
 
	$ş—r_timeout
(
aio_timeout
 *
to
)

1147 
	`d–_sšgËshÙ_tim”_sync
(&
to
->
tim”
);

1148 
	}
}

1150 
	$»ad_ev’ts
(
kioùx
 *
ùx
,

1151 
mš_Ä
, 
Ä
,

1152 
io_ev’t
 
__u£r
 *
ev’t
,

1153 
time¥ec
 
__u£r
 *
timeout
)

1155 
¡¬t_jiff›s
 = 
jiff›s
;

1156 
sk_¡ruù
 *
tsk
 = 
cu¼’t
;

1157 
	`DECLARE_WAITQUEUE
(
wa™
, 
tsk
);

1158 
»t
;

1159 
i
 = 0;

1160 
io_ev’t
 
’t
;

1161 
aio_timeout
 
to
;

1162 
»Œy
 = 0;

1167 
	`mem£t
(&
’t
, 0, (ent));

1168 
»Œy
:

1169 
»t
 = 0;

1170 
	`lik–y
(
i
 < 
Ä
)) {

1171 
»t
 = 
	`aio_»ad_evt
(
ùx
, &
’t
);

1172 ià(
	`uÆik–y
(
»t
 <= 0))

1175 
	`d´štk
("readƒvent: %Lx %Lx %Lx %Lx\n",

1176 
’t
.
d©a
,ƒÁ.
obj
,ƒÁ.
»s
,ƒÁ.
»s2
);

1179 
»t
 = -
EFAULT
;

1180 ià(
	`uÆik–y
(
	`cİy_to_u£r
(
ev’t
, &
’t
, (ent)))) {

1181 
	`d´štk
("aio:†ost‡nƒvent dueo EFAULT.\n");

1184 
»t
 = 0;

1187 
ev’t
 ++;

1188 
i
 ++;

1191 ià(
mš_Ä
 <ğ
i
)

1192  
i
;

1193 ià(
»t
)

1194  
»t
;

1199 ià(!
»Œy
 && 
	`uÆik–y
(!
	`li¡_em±y
(&
ùx
->
run_li¡
))) {

1200 
»Œy
 = 1;

1201 
	`aio_run_®l_iocbs
(
ùx
);

1202 
»Œy
;

1205 
	`š™_timeout
(&
to
);

1206 ià(
timeout
) {

1207 
time¥ec
 
ts
;

1208 
»t
 = -
EFAULT
;

1209 ià(
	`uÆik–y
(
	`cİy_äom_u£r
(&
ts
, 
timeout
, (ts))))

1210 
out
;

1212 
	`£t_timeout
(
¡¬t_jiff›s
, &
to
, &
ts
);

1215 
	`lik–y
(
i
 < 
Ä
)) {

1216 
	`add_wa™_queue_exşusive
(&
ùx
->
wa™
, &wait);

1218 
	`£t_sk_¡©e
(
tsk
, 
TASK_INTERRUPTIBLE
);

1219 
»t
 = 
	`aio_»ad_evt
(
ùx
, &
’t
);

1220 ià(
»t
)

1222 ià(
mš_Ä
 <ğ
i
)

1224 ià(
	`uÆik–y
(
ùx
->
d—d
)) {

1225 
»t
 = -
EINVAL
;

1228 ià(
to
.
timed_out
)

1232 ià(
ùx
->
»qs_aùive
)

1233 
	`io_scheduË
();

1235 
	`scheduË
();

1236 ià(
	`sigÇl_³ndšg
(
tsk
)) {

1237 
»t
 = -
EINTR
;

1243 
	`£t_sk_¡©e
(
tsk
, 
TASK_RUNNING
);

1244 
	`»move_wa™_queue
(&
ùx
->
wa™
, &wait);

1246 ià(
	`uÆik–y
(
»t
 <= 0))

1249 
»t
 = -
EFAULT
;

1250 ià(
	`uÆik–y
(
	`cİy_to_u£r
(
ev’t
, &
’t
, (ent)))) {

1251 
	`d´štk
("aio:†ost‡nƒvent dueo EFAULT.\n");

1256 
ev’t
 ++;

1257 
i
 ++;

1260 ià(
timeout
)

1261 
	`ş—r_timeout
(&
to
);

1262 
out
:

1263 
	`de¡roy_tim”_Ú_¡ack
(&
to
.
tim”
);

1264  
i
 ? i : 
»t
;

1265 
	}
}

1270 
	$io_de¡roy
(
kioùx
 *
ioùx
)

1272 
mm_¡ruù
 *
mm
 = 
cu¼’t
->mm;

1273 
was_d—d
;

1276 
	`¥š_lock
(&
mm
->
ioùx_lock
);

1277 
was_d—d
 = 
ioùx
->
d—d
;

1278 
ioùx
->
d—d
 = 1;

1279 
	`hli¡_d–_rcu
(&
ioùx
->
li¡
);

1280 
	`¥š_uÆock
(&
mm
->
ioùx_lock
);

1282 
	`d´štk
("aio_»Ëa£(%p)\n", 
ioùx
);

1283 ià(
	`lik–y
(!
was_d—d
))

1284 
	`put_ioùx
(
ioùx
);

1286 
	`aio_ÿnûl_®l
(
ioùx
);

1287 
	`wa™_fÜ_®l_aios
(
ioùx
);

1294 
	`wake_up_®l
(&
ioùx
->
wa™
);

1295 
	`put_ioùx
(
ioùx
);

1296 
	}
}

1311 
	$SYSCALL_DEFINE2
(
io_£tup
, , 
Ä_ev’ts
, 
aio_cÚ‹xt_t
 
__u£r
 *, 
ùxp
)

1313 
kioùx
 *
ioùx
 = 
NULL
;

1314 
ùx
;

1315 
»t
;

1317 
»t
 = 
	`g‘_u£r
(
ùx
, 
ùxp
);

1318 ià(
	`uÆik–y
(
»t
))

1319 
out
;

1321 
»t
 = -
EINVAL
;

1322 ià(
	`uÆik–y
(
ùx
 || 
Ä_ev’ts
 == 0)) {

1323 
	`´_debug
("EINVAL: io_setup: ctx %lu‚r_events %u\n",

1324 
ùx
, 
Ä_ev’ts
);

1325 
out
;

1328 
ioùx
 = 
	`ioùx_®loc
(
Ä_ev’ts
);

1329 
»t
 = 
	`PTR_ERR
(
ioùx
);

1330 ià(!
	`IS_ERR
(
ioùx
)) {

1331 
»t
 = 
	`put_u£r
(
ioùx
->
u£r_id
, 
ùxp
);

1332 ià(!
»t
)

1335 
	`g‘_ioùx
(
ioùx
);

1336 
	`io_de¡roy
(
ioùx
);

1339 
out
:

1340  
»t
;

1341 
	}
}

1349 
	$SYSCALL_DEFINE1
(
io_de¡roy
, 
aio_cÚ‹xt_t
, 
ùx
)

1351 
kioùx
 *
ioùx
 = 
	`lookup_ioùx
(
ùx
);

1352 ià(
	`lik–y
(
NULL
 !ğ
ioùx
)) {

1353 
	`io_de¡roy
(
ioùx
);

1356 
	`´_debug
("EINVAL: io_destroy: invalid context id\n");

1357  -
EINVAL
;

1358 
	}
}

1360 
	$aio_advªû_iovec
(
kiocb
 *
iocb
, 
ssize_t
 
»t
)

1362 
iovec
 *
iov
 = &
iocb
->
ki_iovec
[iocb->
ki_cur_£g
];

1364 
	`BUG_ON
(
»t
 <= 0);

1366 
iocb
->
ki_cur_£g
 < iocb->
ki_Ä_£gs
 && 
»t
 > 0) {

1367 
ssize_t
 
this
 = 
	`mš
((ssize_t)
iov
->
iov_Ën
, 
»t
);

1368 
iov
->
iov_ba£
 +ğ
this
;

1369 
iov
->
iov_Ën
 -ğ
this
;

1370 
iocb
->
ki_Ëá
 -ğ
this
;

1371 
»t
 -ğ
this
;

1372 ià(
iov
->
iov_Ën
 == 0) {

1373 
iocb
->
ki_cur_£g
++;

1374 
iov
++;

1380 
	`BUG_ON
(
»t
 > 0 && 
iocb
->
ki_Ëá
 == 0);

1381 
	}
}

1383 
ssize_t
 
	$aio_rw_veù_»Œy
(
kiocb
 *
iocb
)

1385 
fe
 *fğ
iocb
->
ki_fp
;

1386 
add»ss_¥aû
 *
m­pšg
 = 
fe
->
f_m­pšg
;

1387 
šode
 *šodğ
m­pšg
->
ho¡
;

1388 
	`ssize_t
 (*
rw_İ
)(
kiocb
 *, cÚ¡ 
iovec
 *,

1389 , 
loff_t
);

1390 
ssize_t
 
»t
 = 0;

1391 
İcode
;

1393 ià((
iocb
->
ki_İcode
 =ğ
IOCB_CMD_PREADV
) ||

1394 (
iocb
->
ki_İcode
 =ğ
IOCB_CMD_PREAD
)) {

1395 
rw_İ
 = 
fe
->
f_İ
->
aio_»ad
;

1396 
İcode
 = 
IOCB_CMD_PREADV
;

1398 
rw_İ
 = 
fe
->
f_İ
->
aio_wr™e
;

1399 
İcode
 = 
IOCB_CMD_PWRITEV
;

1403 ià(
iocb
->
ki_pos
 < 0)

1404  -
EINVAL
;

1407 
»t
 = 
	`rw_İ
(
iocb
, &iocb->
ki_iovec
[iocb->
ki_cur_£g
],

1408 
iocb
->
ki_Ä_£gs
 - iocb->
ki_cur_£g
,

1409 
iocb
->
ki_pos
);

1410 ià(
»t
 > 0)

1411 
	`aio_advªû_iovec
(
iocb
, 
»t
);

1415 } 
»t
 > 0 && 
iocb
->
ki_Ëá
 > 0 &&

1416 (
İcode
 =ğ
IOCB_CMD_PWRITEV
 ||

1417 (!
	`S_ISFIFO
(
šode
->
i_mode
è&& !
	`S_ISSOCK
(inode->i_mode))));

1421 ià((
»t
 =ğ0è|| (
iocb
->
ki_Ëá
 == 0))

1422 
»t
 = 
iocb
->
ki_nby‹s
 - iocb->
ki_Ëá
;

1426 ià(
İcode
 =ğ
IOCB_CMD_PWRITEV


1427 && 
»t
 < 0 &&„‘ !ğ-
EIOCBQUEUED
 &&„‘ !ğ-
EIOCBRETRY


1428 && 
iocb
->
ki_nby‹s
 - iocb->
ki_Ëá
)

1429 
»t
 = 
iocb
->
ki_nby‹s
 - iocb->
ki_Ëá
;

1431  
»t
;

1432 
	}
}

1434 
ssize_t
 
	$aio_fdsync
(
kiocb
 *
iocb
)

1436 
fe
 *fğ
iocb
->
ki_fp
;

1437 
ssize_t
 
»t
 = -
EINVAL
;

1439 ià(
fe
->
f_İ
->
aio_fsync
)

1440 
»t
 = 
fe
->
f_İ
->
	`aio_fsync
(
iocb
, 1);

1441  
»t
;

1442 
	}
}

1444 
ssize_t
 
	$aio_fsync
(
kiocb
 *
iocb
)

1446 
fe
 *fğ
iocb
->
ki_fp
;

1447 
ssize_t
 
»t
 = -
EINVAL
;

1449 ià(
fe
->
f_İ
->
aio_fsync
)

1450 
»t
 = 
fe
->
f_İ
->
	`aio_fsync
(
iocb
, 0);

1451  
»t
;

1452 
	}
}

1454 
ssize_t
 
	$aio_£tup_veùÜed_rw
(
ty³
, 
kiocb
 *kiocb, 
boŞ
 
com·t
)

1456 
ssize_t
 
»t
;

1458 #ifdeà
CONFIG_COMPAT


1459 ià(
com·t
)

1460 
»t
 = 
	`com·t_rw_cİy_check_uveùÜ
(
ty³
,

1461 (
com·t_iovec
 
__u£r
 *)
kiocb
->
ki_buf
,

1462 
kiocb
->
ki_nby‹s
, 1, &kiocb->
ki_šlše_vec
,

1463 &
kiocb
->
ki_iovec
, 1);

1466 
»t
 = 
	`rw_cİy_check_uveùÜ
(
ty³
,

1467 (
iovec
 
__u£r
 *)
kiocb
->
ki_buf
,

1468 
kiocb
->
ki_nby‹s
, 1, &kiocb->
ki_šlše_vec
,

1469 &
kiocb
->
ki_iovec
, 1);

1470 ià(
»t
 < 0)

1471 
out
;

1473 
kiocb
->
ki_Ä_£gs
 = kiocb->
ki_nby‹s
;

1474 
kiocb
->
ki_cur_£g
 = 0;

1476 
kiocb
->
ki_nby‹s
 = 
»t
;

1477 
kiocb
->
ki_Ëá
 = 
»t
;

1479 
»t
 = 0;

1480 
out
:

1481  
»t
;

1482 
	}
}

1484 
ssize_t
 
	$aio_£tup_sšgË_veùÜ
(
kiocb
 *kiocb)

1486 
kiocb
->
ki_iovec
 = &kiocb->
ki_šlše_vec
;

1487 
kiocb
->
ki_iovec
->
iov_ba£
 = kiocb->
ki_buf
;

1488 
kiocb
->
ki_iovec
->
iov_Ën
 = kiocb->
ki_Ëá
;

1489 
kiocb
->
ki_Ä_£gs
 = 1;

1490 
kiocb
->
ki_cur_£g
 = 0;

1492 
	}
}

1499 
ssize_t
 
	$aio_£tup_iocb
(
kiocb
 *kiocb, 
boŞ
 
com·t
)

1501 
fe
 *fğ
kiocb
->
ki_fp
;

1502 
ssize_t
 
»t
 = 0;

1504 
kiocb
->
ki_İcode
) {

1505 
IOCB_CMD_PREAD
:

1506 
»t
 = -
EBADF
;

1507 ià(
	`uÆik–y
(!(
fe
->
f_mode
 & 
FMODE_READ
)))

1509 
»t
 = -
EFAULT
;

1510 ià(
	`uÆik–y
(!
	`acûss_ok
(
VERIFY_WRITE
, 
kiocb
->
ki_buf
,

1511 
kiocb
->
ki_Ëá
)))

1513 
»t
 = 
	`£cur™y_fe_³rmissiÚ
(
fe
, 
MAY_READ
);

1514 ià(
	`uÆik–y
(
»t
))

1516 
»t
 = 
	`aio_£tup_sšgË_veùÜ
(
kiocb
);

1517 ià(
»t
)

1519 
»t
 = -
EINVAL
;

1520 ià(
fe
->
f_İ
->
aio_»ad
)

1521 
kiocb
->
ki_»Œy
 = 
aio_rw_veù_»Œy
;

1523 
IOCB_CMD_PWRITE
:

1524 
»t
 = -
EBADF
;

1525 ià(
	`uÆik–y
(!(
fe
->
f_mode
 & 
FMODE_WRITE
)))

1527 
»t
 = -
EFAULT
;

1528 ià(
	`uÆik–y
(!
	`acûss_ok
(
VERIFY_READ
, 
kiocb
->
ki_buf
,

1529 
kiocb
->
ki_Ëá
)))

1531 
»t
 = 
	`£cur™y_fe_³rmissiÚ
(
fe
, 
MAY_WRITE
);

1532 ià(
	`uÆik–y
(
»t
))

1534 
»t
 = 
	`aio_£tup_sšgË_veùÜ
(
kiocb
);

1535 ià(
»t
)

1537 
»t
 = -
EINVAL
;

1538 ià(
fe
->
f_İ
->
aio_wr™e
)

1539 
kiocb
->
ki_»Œy
 = 
aio_rw_veù_»Œy
;

1541 
IOCB_CMD_PREADV
:

1542 
»t
 = -
EBADF
;

1543 ià(
	`uÆik–y
(!(
fe
->
f_mode
 & 
FMODE_READ
)))

1545 
»t
 = 
	`£cur™y_fe_³rmissiÚ
(
fe
, 
MAY_READ
);

1546 ià(
	`uÆik–y
(
»t
))

1548 
»t
 = 
	`aio_£tup_veùÜed_rw
(
READ
, 
kiocb
, 
com·t
);

1549 ià(
»t
)

1551 
»t
 = -
EINVAL
;

1552 ià(
fe
->
f_İ
->
aio_»ad
)

1553 
kiocb
->
ki_»Œy
 = 
aio_rw_veù_»Œy
;

1555 
IOCB_CMD_PWRITEV
:

1556 
»t
 = -
EBADF
;

1557 ià(
	`uÆik–y
(!(
fe
->
f_mode
 & 
FMODE_WRITE
)))

1559 
»t
 = 
	`£cur™y_fe_³rmissiÚ
(
fe
, 
MAY_WRITE
);

1560 ià(
	`uÆik–y
(
»t
))

1562 
»t
 = 
	`aio_£tup_veùÜed_rw
(
WRITE
, 
kiocb
, 
com·t
);

1563 ià(
»t
)

1565 
»t
 = -
EINVAL
;

1566 ià(
fe
->
f_İ
->
aio_wr™e
)

1567 
kiocb
->
ki_»Œy
 = 
aio_rw_veù_»Œy
;

1569 
IOCB_CMD_FDSYNC
:

1570 
»t
 = -
EINVAL
;

1571 ià(
fe
->
f_İ
->
aio_fsync
)

1572 
kiocb
->
ki_»Œy
 = 
aio_fdsync
;

1574 
IOCB_CMD_FSYNC
:

1575 
»t
 = -
EINVAL
;

1576 ià(
fe
->
f_İ
->
aio_fsync
)

1577 
kiocb
->
ki_»Œy
 = 
aio_fsync
;

1580 
	`d´štk
("EINVAL: io_submit:‚o operation…rovided\n");

1581 
»t
 = -
EINVAL
;

1584 ià(!
kiocb
->
ki_»Œy
)

1585  
»t
;

1588 
	}
}

1590 
	$io_subm™_Úe
(
kioùx
 *
ùx
, 
iocb
 
__u£r
 *
u£r_iocb
,

1591 
iocb
 *iocb, 
kiocb_b©ch
 *
b©ch
,

1592 
boŞ
 
com·t
)

1594 
kiocb
 *
»q
;

1595 
fe
 *file;

1596 
ssize_t
 
»t
;

1599 ià(
	`uÆik–y
(
iocb
->
aio_»£rved1
 || iocb->
aio_»£rved2
)) {

1600 
	`´_debug
("EINVAL: io_submit:„eserve field set\n");

1601  -
EINVAL
;

1605 ià(
	`uÆik–y
(

1606 (
iocb
->
aio_buf
 != ()iocb->aio_buf) ||

1607 (
iocb
->
aio_nby‹s
 !ğ(
size_t
)iocb->aio_nbytes) ||

1608 ((
ssize_t
)
iocb
->
aio_nby‹s
 < 0)

1610 
	`´_debug
("EINVAL: io_submit: overflow check\n");

1611  -
EINVAL
;

1614 
fe
 = 
	`fg‘
(
iocb
->
aio_fdes
);

1615 ià(
	`uÆik–y
(!
fe
))

1616  -
EBADF
;

1618 
»q
 = 
	`aio_g‘_»q
(
ùx
, 
b©ch
);

1619 ià(
	`uÆik–y
(!
»q
)) {

1620 
	`åut
(
fe
);

1621  -
EAGAIN
;

1623 
»q
->
ki_fp
 = 
fe
;

1624 ià(
iocb
->
aio_æags
 & 
IOCB_FLAG_RESFD
) {

1631 
»q
->
ki_ev’tfd
 = 
	`ev’tfd_ùx_fdg‘
((è
iocb
->
aio_»sfd
);

1632 ià(
	`IS_ERR
(
»q
->
ki_ev’tfd
)) {

1633 
»t
 = 
	`PTR_ERR
(
»q
->
ki_ev’tfd
);

1634 
»q
->
ki_ev’tfd
 = 
NULL
;

1635 
out_put_»q
;

1639 
»t
 = 
	`put_u£r
(
»q
->
ki_key
, &
u£r_iocb
->
aio_key
);

1640 ià(
	`uÆik–y
(
»t
)) {

1641 
	`d´štk
("EFAULT:‡io_key\n");

1642 
out_put_»q
;

1645 
»q
->
ki_obj
.
u£r
 = 
u£r_iocb
;

1646 
»q
->
ki_u£r_d©a
 = 
iocb
->
aio_d©a
;

1647 
»q
->
ki_pos
 = 
iocb
->
aio_off£t
;

1649 
»q
->
ki_buf
 = (
__u£r
 *)()
iocb
->
aio_buf
;

1650 
»q
->
ki_Ëá
 =„eq->
ki_nby‹s
 = 
iocb
->
aio_nby‹s
;

1651 
»q
->
ki_İcode
 = 
iocb
->
aio_lio_İcode
;

1653 
»t
 = 
	`aio_£tup_iocb
(
»q
, 
com·t
);

1655 ià(
»t
)

1656 
out_put_»q
;

1658 
	`¥š_lock_œq
(&
ùx
->
ùx_lock
);

1671 ià(
ùx
->
d—d
) {

1672 
	`¥š_uÆock_œq
(&
ùx
->
ùx_lock
);

1673 
»t
 = -
EINVAL
;

1674 
out_put_»q
;

1676 
	`aio_run_iocb
(
»q
);

1677 ià(!
	`li¡_em±y
(&
ùx
->
run_li¡
)) {

1679 
	`__aio_run_iocbs
(
ùx
))

1682 
	`¥š_uÆock_œq
(&
ùx
->
ùx_lock
);

1684 
	`aio_put_»q
(
»q
);

1687 
out_put_»q
:

1688 
	`aio_put_»q
(
»q
);

1689 
	`aio_put_»q
(
»q
);

1690  
»t
;

1691 
	}
}

1693 
	$do_io_subm™
(
aio_cÚ‹xt_t
 
ùx_id
, 
Ä
,

1694 
iocb
 
__u£r
 *__u£¸*
iocbµ
, 
boŞ
 
com·t
)

1696 
kioùx
 *
ùx
;

1697 
»t
 = 0;

1698 
i
 = 0;

1699 
blk_¶ug
 
¶ug
;

1700 
kiocb_b©ch
 
b©ch
;

1702 ià(
	`uÆik–y
(
Ä
 < 0))

1703  -
EINVAL
;

1705 ià(
	`uÆik–y
(
Ä
 > 
LONG_MAX
/(*
iocbµ
)))

1706 
Ä
 = 
LONG_MAX
/(*
iocbµ
);

1708 ià(
	`uÆik–y
(!
	`acûss_ok
(
VERIFY_READ
, 
iocbµ
, (
Ä
*(*iocbpp)))))

1709  -
EFAULT
;

1711 
ùx
 = 
	`lookup_ioùx
(
ùx_id
);

1712 ià(
	`uÆik–y
(!
ùx
)) {

1713 
	`´_debug
("EINVAL: io_submit: invalid context id\n");

1714  -
EINVAL
;

1717 
	`kiocb_b©ch_š™
(&
b©ch
, 
Ä
);

1719 
	`blk_¡¬t_¶ug
(&
¶ug
);

1725 
i
=0; i<
Ä
; i++) {

1726 
iocb
 
__u£r
 *
u£r_iocb
;

1727 
iocb
 
tmp
;

1729 ià(
	`uÆik–y
(
	`__g‘_u£r
(
u£r_iocb
, 
iocbµ
 + 
i
))) {

1730 
»t
 = -
EFAULT
;

1734 ià(
	`uÆik–y
(
	`cİy_äom_u£r
(&
tmp
, 
u£r_iocb
, (tmp)))) {

1735 
»t
 = -
EFAULT
;

1739 
»t
 = 
	`io_subm™_Úe
(
ùx
, 
u£r_iocb
, &
tmp
, &
b©ch
, 
com·t
);

1740 ià(
»t
)

1743 
	`blk_fšish_¶ug
(&
¶ug
);

1745 
	`kiocb_b©ch_ä“
(&
b©ch
);

1746 
	`put_ioùx
(
ùx
);

1747  
i
 ? i : 
»t
;

1748 
	}
}

1762 
	$SYSCALL_DEFINE3
(
io_subm™
, 
aio_cÚ‹xt_t
, 
ùx_id
, , 
Ä
,

1763 
iocb
 
__u£r
 * __u£¸*, 
iocbµ
)

1765  
	`do_io_subm™
(
ùx_id
, 
Ä
, 
iocbµ
, 0);

1766 
	}
}

1771 
kiocb
 *
	$lookup_kiocb
(
kioùx
 *
ùx
, 
iocb
 
__u£r
 *iocb,

1772 
u32
 
key
)

1774 
li¡_h—d
 *
pos
;

1776 
	`as£¹_¥š_locked
(&
ùx
->
ùx_lock
);

1779 
	`li¡_fÜ_—ch
(
pos
, &
ùx
->
aùive_»qs
) {

1780 
kiocb
 *kiocb = 
	`li¡_kiocb
(
pos
);

1781 ià(
kiocb
->
ki_obj
.
u£r
 =ğ
iocb
 && kiocb->
ki_key
 =ğ
key
)

1782  
kiocb
;

1784  
NULL
;

1785 
	}
}

1797 
	$SYSCALL_DEFINE3
(
io_ÿnûl
, 
aio_cÚ‹xt_t
, 
ùx_id
, 
iocb
 
__u£r
 *, iocb,

1798 
io_ev’t
 
__u£r
 *, 
»suÉ
)

1800 (*
ÿnûl
)(
kiocb
 *
iocb
, 
io_ev’t
 *
»s
);

1801 
kioùx
 *
ùx
;

1802 
kiocb
 *kiocb;

1803 
u32
 
key
;

1804 
»t
;

1806 
»t
 = 
	`g‘_u£r
(
key
, &
iocb
->
aio_key
);

1807 ià(
	`uÆik–y
(
»t
))

1808  -
EFAULT
;

1810 
ùx
 = 
	`lookup_ioùx
(
ùx_id
);

1811 ià(
	`uÆik–y
(!
ùx
))

1812  -
EINVAL
;

1814 
	`¥š_lock_œq
(&
ùx
->
ùx_lock
);

1815 
»t
 = -
EAGAIN
;

1816 
kiocb
 = 
	`lookup_kiocb
(
ùx
, 
iocb
, 
key
);

1817 ià(
kiocb
 && kiocb->
ki_ÿnûl
) {

1818 
ÿnûl
 = 
kiocb
->
ki_ÿnûl
;

1819 
kiocb
->
ki_u£rs
 ++;

1820 
	`kiocbS‘CªûÎed
(
kiocb
);

1822 
ÿnûl
 = 
NULL
;

1823 
	`¥š_uÆock_œq
(&
ùx
->
ùx_lock
);

1825 ià(
NULL
 !ğ
ÿnûl
) {

1826 
io_ev’t
 
tmp
;

1827 
	`´_debug
("calling cancel\n");

1828 
	`mem£t
(&
tmp
, 0, (tmp));

1829 
tmp
.
obj
 = (
u64
)()
kiocb
->
ki_obj
.
u£r
;

1830 
tmp
.
d©a
 = 
kiocb
->
ki_u£r_d©a
;

1831 
»t
 = 
	`ÿnûl
(
kiocb
, &
tmp
);

1832 ià(!
»t
) {

1836 ià(
	`cİy_to_u£r
(
»suÉ
, &
tmp
, (tmp)))

1837 
»t
 = -
EFAULT
;

1840 
»t
 = -
EINVAL
;

1842 
	`put_ioùx
(
ùx
);

1844  
»t
;

1845 
	}
}

1860 
	$SYSCALL_DEFINE5
(
io_g‘ev’ts
, 
aio_cÚ‹xt_t
, 
ùx_id
,

1861 , 
mš_Ä
,

1862 , 
Ä
,

1863 
io_ev’t
 
__u£r
 *, 
ev’ts
,

1864 
time¥ec
 
__u£r
 *, 
timeout
)

1866 
kioùx
 *
ioùx
 = 
	`lookup_ioùx
(
ùx_id
);

1867 
»t
 = -
EINVAL
;

1869 ià(
	`lik–y
(
ioùx
)) {

1870 ià(
	`lik–y
(
mš_Ä
 <ğ
Ä
 && min_nr >= 0))

1871 
»t
 = 
	`»ad_ev’ts
(
ioùx
, 
mš_Ä
, 
Ä
, 
ev’ts
, 
timeout
);

1872 
	`put_ioùx
(
ioùx
);

1875 
	`asmlškage_´Ùeù
(5, 
»t
, 
ùx_id
, 
mš_Ä
, 
Ä
, 
ev’ts
, 
timeout
);

1876  
»t
;

1877 
	}
}

	@anon_inodes.c

11 
	~<lšux/üed.h
>

12 
	~<lšux/fe.h
>

13 
	~<lšux/pŞl.h
>

14 
	~<lšux/sched.h
>

15 
	~<lšux/š™.h
>

16 
	~<lšux/fs.h
>

17 
	~<lšux/mouÁ.h
>

18 
	~<lšux/moduË.h
>

19 
	~<lšux/k”Ãl.h
>

20 
	~<lšux/magic.h
>

21 
	~<lšux/ªÚ_šodes.h
>

23 
	~<asm/uacûss.h
>

25 
vfsmouÁ
 *
ªÚ_šode_mÁ
 
	g__»ad_mo¡ly
;

26 
šode
 *
	gªÚ_šode_šode
;

27 cÚ¡ 
fe_İ”©iÚs
 
	gªÚ_šode_fİs
;

32 *
	$ªÚ_šodefs_dÇme
(
d’Œy
 *d’Œy, *
bufãr
, 
buæ’
)

34  
	`dyÇmic_dÇme
(
d’Œy
, 
bufãr
, 
buæ’
, "anon_inode:%s",

35 
d’Œy
->
d_Çme
.
Çme
);

36 
	}
}

38 cÚ¡ 
d’Œy_İ”©iÚs
 
	gªÚ_šodefs_d’Œy_İ”©iÚs
 = {

39 .
d_dÇme
 = 
ªÚ_šodefs_dÇme
,

42 
d’Œy
 *
	$ªÚ_šodefs_mouÁ
(
fe_sy¡em_ty³
 *
fs_ty³
,

43 
æags
, cÚ¡ *
dev_Çme
, *
d©a
)

45  
	`mouÁ_p£udo
(
fs_ty³
, "ªÚ_šode:", 
NULL
,

46 &
ªÚ_šodefs_d’Œy_İ”©iÚs
, 
ANON_INODE_FS_MAGIC
);

47 
	}
}

49 
fe_sy¡em_ty³
 
	gªÚ_šode_fs_ty³
 = {

50 .
Çme
 = "anon_inodefs",

51 .
	gmouÁ
 = 
ªÚ_šodefs_mouÁ
,

52 .
	gkl_sb
 = 
kl_ªÚ_su³r
,

59 
	$ªÚ_£t_·ge_dœty
(
·ge
 *page)

62 
	}
};

64 cÚ¡ 
add»ss_¥aû_İ”©iÚs
 
	gªÚ_aİs
 = {

65 .
£t_·ge_dœty
 = 
ªÚ_£t_·ge_dœty
,

84 
fe
 *
	$ªÚ_šode_g‘fe
(cÚ¡ *
Çme
,

85 cÚ¡ 
fe_İ”©iÚs
 *
fİs
,

86 *
´iv
, 
æags
)

88 
q¡r
 
this
;

89 
·th
…ath;

90 
fe
 *file;

91 
”rÜ
;

93 ià(
	`IS_ERR
(
ªÚ_šode_šode
))

94  
	`ERR_PTR
(-
ENODEV
);

96 ià(
fİs
->
owÃr
 && !
	`Œy_moduË_g‘
(fops->owner))

97  
	`ERR_PTR
(-
ENOENT
);

103 
”rÜ
 = -
ENOMEM
;

104 
this
.
Çme
 =‚ame;

105 
this
.
Ën
 = 
	`¡¾’
(
Çme
);

106 
this
.
hash
 = 0;

107 
·th
.
d’Œy
 = 
	`d_®loc_p£udo
(
ªÚ_šode_mÁ
->
mÁ_sb
, &
this
);

108 ià(!
·th
.
d’Œy
)

109 
”r_moduË
;

111 
·th
.
mÁ
 = 
	`mÁg‘
(
ªÚ_šode_mÁ
);

116 
	`ihŞd
(
ªÚ_šode_šode
);

118 
	`d_š¡ªtŸ‹
(
·th
.
d’Œy
, 
ªÚ_šode_šode
);

120 
”rÜ
 = -
ENFILE
;

121 
fe
 = 
	`®loc_fe
(&
·th
, 
	`OPEN_FMODE
(
æags
), 
fİs
);

122 ià(!
fe
)

123 
”r_dput
;

124 
fe
->
f_m­pšg
 = 
ªÚ_šode_šode
->
i_m­pšg
;

126 
fe
->
f_pos
 = 0;

127 
fe
->
f_æags
 = 
æags
 & (
O_ACCMODE
 | 
O_NONBLOCK
);

128 
fe
->
f_v”siÚ
 = 0;

129 
fe
->
´iv©e_d©a
 = 
´iv
;

131  
fe
;

133 
”r_dput
:

134 
	`·th_put
(&
·th
);

135 
”r_moduË
:

136 
	`moduË_put
(
fİs
->
owÃr
);

137  
	`ERR_PTR
(
”rÜ
);

138 
	}
}

139 
EXPORT_SYMBOL_GPL
(
ªÚ_šode_g‘fe
);

157 
	$ªÚ_šode_g‘fd
(cÚ¡ *
Çme
, cÚ¡ 
fe_İ”©iÚs
 *
fİs
,

158 *
´iv
, 
æags
)

160 
”rÜ
, 
fd
;

161 
fe
 *file;

163 
”rÜ
 = 
	`g‘_unu£d_fd_æags
(
æags
);

164 ià(
”rÜ
 < 0)

165  
”rÜ
;

166 
fd
 = 
”rÜ
;

168 
fe
 = 
	`ªÚ_šode_g‘fe
(
Çme
, 
fİs
, 
´iv
, 
æags
);

169 ià(
	`IS_ERR
(
fe
)) {

170 
”rÜ
 = 
	`PTR_ERR
(
fe
);

171 
”r_put_unu£d_fd
;

173 
	`fd_š¡®l
(
fd
, 
fe
);

175  
fd
;

177 
”r_put_unu£d_fd
:

178 
	`put_unu£d_fd
(
fd
);

179  
”rÜ
;

180 
	}
}

181 
EXPORT_SYMBOL_GPL
(
ªÚ_šode_g‘fd
);

188 
šode
 *
	$ªÚ_šode_mkšode
()

190 
šode
 *šodğ
	`Ãw_šode_p£udo
(
ªÚ_šode_mÁ
->
mÁ_sb
);

192 ià(!
šode
)

193  
	`ERR_PTR
(-
ENOMEM
);

195 
šode
->
i_šo
 = 
	`g‘_Ãxt_šo
();

196 
šode
->
i_fİ
 = &
ªÚ_šode_fİs
;

198 
šode
->
i_m­pšg
->
a_İs
 = &
ªÚ_aİs
;

206 
šode
->
i_¡©e
 = 
I_DIRTY
;

207 
šode
->
i_mode
 = 
S_IRUSR
 | 
S_IWUSR
;

208 
šode
->
i_uid
 = 
	`cu¼’t_fsuid
();

209 
šode
->
i_gid
 = 
	`cu¼’t_fsgid
();

210 
šode
->
i_æags
 |ğ
S_PRIVATE
;

211 
šode
->
i_©ime
 = inode->
i_mtime
 = inode->
i_ùime
 = 
CURRENT_TIME
;

212  
šode
;

213 
	}
}

215 
__š™
 
	$ªÚ_šode_š™
()

217 
”rÜ
;

219 
”rÜ
 = 
	`»gi¡”_fesy¡em
(&
ªÚ_šode_fs_ty³
);

220 ià(
”rÜ
)

221 
”r_ex™
;

222 
ªÚ_šode_mÁ
 = 
	`k”n_mouÁ
(&
ªÚ_šode_fs_ty³
);

223 ià(
	`IS_ERR
(
ªÚ_šode_mÁ
)) {

224 
”rÜ
 = 
	`PTR_ERR
(
ªÚ_šode_mÁ
);

225 
”r_uÄegi¡”_fesy¡em
;

227 
ªÚ_šode_šode
 = 
	`ªÚ_šode_mkšode
();

228 ià(
	`IS_ERR
(
ªÚ_šode_šode
)) {

229 
”rÜ
 = 
	`PTR_ERR
(
ªÚ_šode_šode
);

230 
”r_mÁput
;

235 
”r_mÁput
:

236 
	`k”n_unmouÁ
(
ªÚ_šode_mÁ
);

237 
”r_uÄegi¡”_fesy¡em
:

238 
	`uÄegi¡”_fesy¡em
(&
ªÚ_šode_fs_ty³
);

239 
”r_ex™
:

240 
	`·nic
(
KERN_ERR
 "ªÚ_šode_š™(èçed (%d)\n", 
”rÜ
);

241 
	}
}

243 
fs_š™ÿÎ
(
ªÚ_šode_š™
);

	@attr.c

8 
	~<lšux/moduË.h
>

9 
	~<lšux/time.h
>

10 
	~<lšux/mm.h
>

11 
	~<lšux/¡ršg.h
>

12 
	~<lšux/ÿ·b™y.h
>

13 
	~<lšux/f¢Ùify.h
>

14 
	~<lšux/fú.h
>

15 
	~<lšux/£cur™y.h
>

16 
	~<lšux/evm.h
>

30 
	$šode_chªge_ok
(cÚ¡ 
šode
 *šode, 
Ÿ‰r
 *
©Œ
)

32 
Ÿ_v®id
 = 
©Œ
->ia_valid;

38 ià(
Ÿ_v®id
 & 
ATTR_SIZE
) {

39 
”rÜ
 = 
	`šode_Ãwsize_ok
(
šode
, 
©Œ
->
Ÿ_size
);

40 ià(
”rÜ
)

41  
”rÜ
;

45 ià(
Ÿ_v®id
 & 
ATTR_FORCE
)

49 ià((
Ÿ_v®id
 & 
ATTR_UID
) &&

50 (
	`cu¼’t_fsuid
(è!ğ
šode
->
i_uid
 ||

51 
©Œ
->
Ÿ_uid
 !ğ
šode
->
i_uid
è&& !
	`ÿ·bË
(
CAP_CHOWN
))

52  -
EPERM
;

55 ià((
Ÿ_v®id
 & 
ATTR_GID
) &&

56 (
	`cu¼’t_fsuid
(è!ğ
šode
->
i_uid
 ||

57 (!
	`š_group_p
(
©Œ
->
Ÿ_gid
è&&‡‰r->Ÿ_gid !ğ
šode
->
i_gid
)) &&

58 !
	`ÿ·bË
(
CAP_CHOWN
))

59  -
EPERM
;

62 ià(
Ÿ_v®id
 & 
ATTR_MODE
) {

63 ià(!
	`šode_owÃr_Ü_ÿ·bË
(
šode
))

64  -
EPERM
;

66 ià(!
	`š_group_p
((
Ÿ_v®id
 & 
ATTR_GID
è? 
©Œ
->
Ÿ_gid
 :

67 
šode
->
i_gid
è&& !
	`ÿ·bË
(
CAP_FSETID
))

68 
©Œ
->
Ÿ_mode
 &ğ~
S_ISGID
;

72 ià(
Ÿ_v®id
 & (
ATTR_MTIME_SET
 | 
ATTR_ATIME_SET
 | 
ATTR_TIMES_SET
)) {

73 ià(!
	`šode_owÃr_Ü_ÿ·bË
(
šode
))

74  -
EPERM
;

78 
	}
}

79 
EXPORT_SYMBOL
(
šode_chªge_ok
);

96 
	$šode_Ãwsize_ok
(cÚ¡ 
šode
 *šode, 
loff_t
 
off£t
)

98 ià(
šode
->
i_size
 < 
off£t
) {

99 
lim™
;

101 
lim™
 = 
	`¾im™
(
RLIMIT_FSIZE
);

102 ià(
lim™
 !ğ
RLIM_INFINITY
 && 
off£t
 >†imit)

103 
out_sig
;

104 ià(
off£t
 > 
šode
->
i_sb
->
s_maxby‹s
)

105 
out_big
;

112 ià(
	`IS_SWAPFILE
(
šode
))

113  -
ETXTBSY
;

117 
out_sig
:

118 
	`£nd_sig
(
SIGXFSZ
, 
cu¼’t
, 0);

119 
out_big
:

120  -
EFBIG
;

121 
	}
}

122 
EXPORT_SYMBOL
(
šode_Ãwsize_ok
);

139 
	$£‰r_cİy
(
šode
 *šode, cÚ¡ 
Ÿ‰r
 *
©Œ
)

141 
Ÿ_v®id
 = 
©Œ
->ia_valid;

143 ià(
Ÿ_v®id
 & 
ATTR_UID
)

144 
šode
->
i_uid
 = 
©Œ
->
Ÿ_uid
;

145 ià(
Ÿ_v®id
 & 
ATTR_GID
)

146 
šode
->
i_gid
 = 
©Œ
->
Ÿ_gid
;

147 ià(
Ÿ_v®id
 & 
ATTR_ATIME
)

148 
šode
->
i_©ime
 = 
	`time¥ec_Œunc
(
©Œ
->
Ÿ_©ime
,

149 
šode
->
i_sb
->
s_time_g¿n
);

150 ià(
Ÿ_v®id
 & 
ATTR_MTIME
)

151 
šode
->
i_mtime
 = 
	`time¥ec_Œunc
(
©Œ
->
Ÿ_mtime
,

152 
šode
->
i_sb
->
s_time_g¿n
);

153 ià(
Ÿ_v®id
 & 
ATTR_CTIME
)

154 
šode
->
i_ùime
 = 
	`time¥ec_Œunc
(
©Œ
->
Ÿ_ùime
,

155 
šode
->
i_sb
->
s_time_g¿n
);

156 ià(
Ÿ_v®id
 & 
ATTR_MODE
) {

157 
umode_t
 
mode
 = 
©Œ
->
Ÿ_mode
;

159 ià(!
	`š_group_p
(
šode
->
i_gid
è&& !
	`ÿ·bË
(
CAP_FSETID
))

160 
mode
 &ğ~
S_ISGID
;

161 
šode
->
i_mode
 = 
mode
;

163 
	}
}

164 
EXPORT_SYMBOL
(
£‰r_cİy
);

166 
	$nÙify_chªge
(
d’Œy
 * d’Œy, 
Ÿ‰r
 * 
©Œ
)

168 
šode
 *šodğ
d’Œy
->
d_šode
;

169 
mode_t
 
mode
 = 
šode
->
i_mode
;

170 
”rÜ
;

171 
time¥ec
 
now
;

172 
Ÿ_v®id
 = 
©Œ
->ia_valid;

174 ià(
Ÿ_v®id
 & (
ATTR_MODE
 | 
ATTR_UID
 | 
ATTR_GID
 | 
ATTR_TIMES_SET
)) {

175 ià(
	`IS_IMMUTABLE
(
šode
è|| 
	`IS_APPEND
(inode))

176  -
EPERM
;

179 ià((
Ÿ_v®id
 & 
ATTR_MODE
)) {

180 
mode_t
 
amode
 = 
©Œ
->
Ÿ_mode
;

182 ià(
	`is_sxid
(
amode
))

183 
šode
->
i_æags
 &ğ~
S_NOSEC
;

186 
now
 = 
	`cu¼’t_fs_time
(
šode
->
i_sb
);

188 
©Œ
->
Ÿ_ùime
 = 
now
;

189 ià(!(
Ÿ_v®id
 & 
ATTR_ATIME_SET
))

190 
©Œ
->
Ÿ_©ime
 = 
now
;

191 ià(!(
Ÿ_v®id
 & 
ATTR_MTIME_SET
))

192 
©Œ
->
Ÿ_mtime
 = 
now
;

193 ià(
Ÿ_v®id
 & 
ATTR_KILL_PRIV
) {

194 
©Œ
->
Ÿ_v®id
 &ğ~
ATTR_KILL_PRIV
;

195 
Ÿ_v®id
 &ğ~
ATTR_KILL_PRIV
;

196 
”rÜ
 = 
	`£cur™y_šode_Ãed_kÍriv
(
d’Œy
);

197 ià(
”rÜ
 > 0)

198 
”rÜ
 = 
	`£cur™y_šode_kÍriv
(
d’Œy
);

199 ià(
”rÜ
)

200  
”rÜ
;

210 ià((
Ÿ_v®id
 & (
ATTR_KILL_SUID
|
ATTR_KILL_SGID
)) &&

211 (
Ÿ_v®id
 & 
ATTR_MODE
))

212 
	`BUG
();

214 ià(
Ÿ_v®id
 & 
ATTR_KILL_SUID
) {

215 ià(
mode
 & 
S_ISUID
) {

216 
Ÿ_v®id
 = 
©Œ
->Ÿ_v®id |ğ
ATTR_MODE
;

217 
©Œ
->
Ÿ_mode
 = (
šode
->
i_mode
 & ~
S_ISUID
);

220 ià(
Ÿ_v®id
 & 
ATTR_KILL_SGID
) {

221 ià((
mode
 & (
S_ISGID
 | 
S_IXGRP
)) == (S_ISGID | S_IXGRP)) {

222 ià(!(
Ÿ_v®id
 & 
ATTR_MODE
)) {

223 
Ÿ_v®id
 = 
©Œ
->Ÿ_v®id |ğ
ATTR_MODE
;

224 
©Œ
->
Ÿ_mode
 = 
šode
->
i_mode
;

226 
©Œ
->
Ÿ_mode
 &ğ~
S_ISGID
;

229 ià(!(
©Œ
->
Ÿ_v®id
 & ~(
ATTR_KILL_SUID
 | 
ATTR_KILL_SGID
)))

232 
”rÜ
 = 
	`£cur™y_šode_£‰r
(
d’Œy
, 
©Œ
);

233 ià(
”rÜ
)

234  
”rÜ
;

236 ià(
šode
->
i_İ
->
£‰r
)

237 
”rÜ
 = 
šode
->
i_İ
->
	`£‰r
(
d’Œy
, 
©Œ
);

239 
”rÜ
 = 
	`sim¶e_£‰r
(
d’Œy
, 
©Œ
);

241 ià(!
”rÜ
) {

242 
	`f¢Ùify_chªge
(
d’Œy
, 
Ÿ_v®id
);

243 
	`evm_šode_po¡_£‰r
(
d’Œy
, 
Ÿ_v®id
);

246  
”rÜ
;

247 
	}
}

249 
EXPORT_SYMBOL
(
nÙify_chªge
);

	@bad_inode.c

11 
	~<lšux/fs.h
>

12 
	~<lšux/moduË.h
>

13 
	~<lšux/¡©.h
>

14 
	~<lšux/time.h
>

15 
	~<lšux/Çmei.h
>

16 
	~<lšux/pŞl.h
>

19 
loff_t
 
	$bad_fe_Î£ek
(
fe
 *fe, 
loff_t
 
off£t
, 
Üigš
)

21  -
EIO
;

22 
	}
}

24 
ssize_t
 
	$bad_fe_»ad
(
fe
 *
fp
, 
__u£r
 *
buf
,

25 
size_t
 
size
, 
loff_t
 *
µos
)

27  -
EIO
;

28 
	}
}

30 
ssize_t
 
	$bad_fe_wr™e
(
fe
 *
fp
, cÚ¡ 
__u£r
 *
buf
,

31 
size_t
 
siz
, 
loff_t
 *
µos
)

33  -
EIO
;

34 
	}
}

36 
ssize_t
 
	$bad_fe_aio_»ad
(
kiocb
 *
iocb
, cÚ¡ 
iovec
 *
iov
,

37 
Ä_£gs
, 
loff_t
 
pos
)

39  -
EIO
;

40 
	}
}

42 
ssize_t
 
	$bad_fe_aio_wr™e
(
kiocb
 *
iocb
, cÚ¡ 
iovec
 *
iov
,

43 
Ä_£gs
, 
loff_t
 
pos
)

45  -
EIO
;

46 
	}
}

48 
	$bad_fe_»addœ
(
fe
 *
fp
, *
dœ’t
, 
fldœ_t
 
fldœ
)

50  -
EIO
;

51 
	}
}

53 
	$bad_fe_pŞl
(
fe
 *
fp
, 
pŞl_bË
 *
wa™
)

55  
POLLERR
;

56 
	}
}

58 
	$bad_fe_uÆocked_ioùl
(
fe
 *fe, 
cmd
,

59 
¬g
)

61  -
EIO
;

62 
	}
}

64 
	$bad_fe_com·t_ioùl
(
fe
 *fe, 
cmd
,

65 
¬g
)

67  -
EIO
;

68 
	}
}

70 
	$bad_fe_mm­
(
fe
 *fe, 
vm_¬—_¡ruù
 *
vma
)

72  -
EIO
;

73 
	}
}

75 
	$bad_fe_İ’
(
šode
 *šode, 
fe
 *
fp
)

77  -
EIO
;

78 
	}
}

80 
	$bad_fe_æush
(
fe
 *fe, 
æ_owÃr_t
 
id
)

82  -
EIO
;

83 
	}
}

85 
	$bad_fe_»Ëa£
(
šode
 *šode, 
fe
 *
fp
)

87  -
EIO
;

88 
	}
}

90 
	$bad_fe_fsync
(
fe
 *fe, 
loff_t
 
¡¬t
,†off_ˆ
’d
,

91 
d©async
)

93  -
EIO
;

94 
	}
}

96 
	$bad_fe_aio_fsync
(
kiocb
 *
iocb
, 
d©async
)

98  -
EIO
;

99 
	}
}

101 
	$bad_fe_çsync
(
fd
, 
fe
 *
fp
, 
Ú
)

103  -
EIO
;

104 
	}
}

106 
	$bad_fe_lock
(
fe
 *fe, 
cmd
, 
fe_lock
 *
æ
)

108  -
EIO
;

109 
	}
}

111 
ssize_t
 
	$bad_fe_£nd·ge
(
fe
 *fe, 
·ge
 *page,

112 
off
, 
size_t
 
Ën
, 
loff_t
 *
pos
, 
mÜe
)

114  -
EIO
;

115 
	}
}

117 
	$bad_fe_g‘_unm­³d_¬—
(
fe
 *file,

118 
addr
, 
Ën
,

119 
pgoff
, 
æags
)

121  -
EIO
;

122 
	}
}

124 
	$bad_fe_check_æags
(
æags
)

126  -
EIO
;

127 
	}
}

129 
	$bad_fe_æock
(
fe
 *
fp
, 
cmd
, 
fe_lock
 *
æ
)

131  -
EIO
;

132 
	}
}

134 
ssize_t
 
	$bad_fe_¥liû_wr™e
(
pe_šode_šfo
 *
pe
,

135 
fe
 *
out
, 
loff_t
 *
µos
, 
size_t
 
Ën
,

136 
æags
)

138  -
EIO
;

139 
	}
}

141 
ssize_t
 
	$bad_fe_¥liû_»ad
(
fe
 *
š
, 
loff_t
 *
µos
,

142 
pe_šode_šfo
 *
pe
, 
size_t
 
Ën
,

143 
æags
)

145  -
EIO
;

146 
	}
}

148 cÚ¡ 
fe_İ”©iÚs
 
	gbad_fe_İs
 =

150 .
Î£ek
 = 
bad_fe_Î£ek
,

151 .
	g»ad
 = 
bad_fe_»ad
,

152 .
	gwr™e
 = 
bad_fe_wr™e
,

153 .
	gaio_»ad
 = 
bad_fe_aio_»ad
,

154 .
	gaio_wr™e
 = 
bad_fe_aio_wr™e
,

155 .
	g»addœ
 = 
bad_fe_»addœ
,

156 .
	gpŞl
 = 
bad_fe_pŞl
,

157 .
	guÆocked_ioùl
 = 
bad_fe_uÆocked_ioùl
,

158 .
	gcom·t_ioùl
 = 
bad_fe_com·t_ioùl
,

159 .
	gmm­
 = 
bad_fe_mm­
,

160 .
	gİ’
 = 
bad_fe_İ’
,

161 .
	gæush
 = 
bad_fe_æush
,

162 .
	g»Ëa£
 = 
bad_fe_»Ëa£
,

163 .
	gfsync
 = 
bad_fe_fsync
,

164 .
	gaio_fsync
 = 
bad_fe_aio_fsync
,

165 .
	gçsync
 = 
bad_fe_çsync
,

166 .
	glock
 = 
bad_fe_lock
,

167 .
	g£nd·ge
 = 
bad_fe_£nd·ge
,

168 .
	gg‘_unm­³d_¬—
 = 
bad_fe_g‘_unm­³d_¬—
,

169 .
	gcheck_æags
 = 
bad_fe_check_æags
,

170 .
	gæock
 = 
bad_fe_æock
,

171 .
	g¥liû_wr™e
 = 
bad_fe_¥liû_wr™e
,

172 .
	g¥liû_»ad
 = 
bad_fe_¥liû_»ad
,

175 
	$bad_šode_ü—‹
 (
šode
 *
dœ
, 
d’Œy
 *dentry,

176 
mode
, 
Çmeid©a
 *
nd
)

178  -
EIO
;

179 
	}
}

181 
d’Œy
 *
	$bad_šode_lookup
(
šode
 *
dœ
,

182 
d’Œy
 *d’Œy, 
Çmeid©a
 *
nd
)

184  
	`ERR_PTR
(-
EIO
);

185 
	}
}

187 
	$bad_šode_lšk
 (
d’Œy
 *
Şd_d’Œy
, 
šode
 *
dœ
,

188 
d’Œy
 *dentry)

190  -
EIO
;

191 
	}
}

193 
	$bad_šode_uÆšk
(
šode
 *
dœ
, 
d’Œy
 *dentry)

195  -
EIO
;

196 
	}
}

198 
	$bad_šode_symlšk
 (
šode
 *
dœ
, 
d’Œy
 *dentry,

199 cÚ¡ *
symÇme
)

201  -
EIO
;

202 
	}
}

204 
	$bad_šode_mkdœ
(
šode
 *
dœ
, 
d’Œy
 *dentry,

205 
mode
)

207  -
EIO
;

208 
	}
}

210 
	$bad_šode_rmdœ
 (
šode
 *
dœ
, 
d’Œy
 *dentry)

212  -
EIO
;

213 
	}
}

215 
	$bad_šode_mknod
 (
šode
 *
dœ
, 
d’Œy
 *dentry,

216 
mode
, 
dev_t
 
rdev
)

218  -
EIO
;

219 
	}
}

221 
	$bad_šode_»Çme
 (
šode
 *
Şd_dœ
, 
d’Œy
 *
Şd_d’Œy
,

222 
šode
 *
Ãw_dœ
, 
d’Œy
 *
Ãw_d’Œy
)

224  -
EIO
;

225 
	}
}

227 
	$bad_šode_»adlšk
(
d’Œy
 *d’Œy, 
__u£r
 *
bufãr
,

228 
buæ’
)

230  -
EIO
;

231 
	}
}

233 
	$bad_šode_³rmissiÚ
(
šode
 *šode, 
mask
)

235  -
EIO
;

236 
	}
}

238 
	$bad_šode_g‘©Œ
(
vfsmouÁ
 *
mÁ
, 
d’Œy
 *dentry,

239 
k¡©
 *
¡©
)

241  -
EIO
;

242 
	}
}

244 
	$bad_šode_£‰r
(
d’Œy
 *
dœ’Œy
, 
Ÿ‰r
 *
©Œs
)

246  -
EIO
;

247 
	}
}

249 
	$bad_šode_£tx©Œ
(
d’Œy
 *d’Œy, cÚ¡ *
Çme
,

250 cÚ¡ *
v®ue
, 
size_t
 
size
, 
æags
)

252  -
EIO
;

253 
	}
}

255 
ssize_t
 
	$bad_šode_g‘x©Œ
(
d’Œy
 *d’Œy, cÚ¡ *
Çme
,

256 *
bufãr
, 
size_t
 
size
)

258  -
EIO
;

259 
	}
}

261 
ssize_t
 
	$bad_šode_li¡x©Œ
(
d’Œy
 *d’Œy, *
bufãr
,

262 
size_t
 
bufãr_size
)

264  -
EIO
;

265 
	}
}

267 
	$bad_šode_»movex©Œ
(
d’Œy
 *d’Œy, cÚ¡ *
Çme
)

269  -
EIO
;

270 
	}
}

272 cÚ¡ 
šode_İ”©iÚs
 
	gbad_šode_İs
 =

274 .
ü—‹
 = 
bad_šode_ü—‹
,

275 .
	glookup
 = 
bad_šode_lookup
,

276 .
	glšk
 = 
bad_šode_lšk
,

277 .
	guÆšk
 = 
bad_šode_uÆšk
,

278 .
	gsymlšk
 = 
bad_šode_symlšk
,

279 .
	gmkdœ
 = 
bad_šode_mkdœ
,

280 .
	grmdœ
 = 
bad_šode_rmdœ
,

281 .
	gmknod
 = 
bad_šode_mknod
,

282 .
	g»Çme
 = 
bad_šode_»Çme
,

283 .
	g»adlšk
 = 
bad_šode_»adlšk
,

288 .
	g³rmissiÚ
 = 
bad_šode_³rmissiÚ
,

289 .
	gg‘©Œ
 = 
bad_šode_g‘©Œ
,

290 .
	g£‰r
 = 
bad_šode_£‰r
,

291 .
	g£tx©Œ
 = 
bad_šode_£tx©Œ
,

292 .
	gg‘x©Œ
 = 
bad_šode_g‘x©Œ
,

293 .
	gli¡x©Œ
 = 
bad_šode_li¡x©Œ
,

294 .
	g»movex©Œ
 = 
bad_šode_»movex©Œ
,

317 
	$make_bad_šode
(
šode
 *inode)

319 
	`»move_šode_hash
(
šode
);

321 
šode
->
i_mode
 = 
S_IFREG
;

322 
šode
->
i_©ime
 = inode->
i_mtime
 = inode->
i_ùime
 =

323 
	`cu¼’t_fs_time
(
šode
->
i_sb
);

324 
šode
->
i_İ
 = &
bad_šode_İs
;

325 
šode
->
i_fİ
 = &
bad_fe_İs
;

326 
	}
}

327 
EXPORT_SYMBOL
(
make_bad_šode
);

342 
	$is_bad_šode
(
šode
 *inode)

344  (
šode
->
i_İ
 =ğ&
bad_šode_İs
);

345 
	}
}

347 
EXPORT_SYMBOL
(
is_bad_šode
);

355 
	$ig‘_çed
(
šode
 *inode)

357 
	`make_bad_šode
(
šode
);

358 
	`uÆock_Ãw_šode
(
šode
);

359 
	`ut
(
šode
);

360 
	}
}

361 
EXPORT_SYMBOL
(
ig‘_çed
);

	@binfmt_aout.c

7 
	~<lšux/moduË.h
>

9 
	~<lšux/time.h
>

10 
	~<lšux/k”Ãl.h
>

11 
	~<lšux/mm.h
>

12 
	~<lšux/mmª.h
>

13 
	~<lšux/a.out.h
>

14 
	~<lšux/”ºo.h
>

15 
	~<lšux/sigÇl.h
>

16 
	~<lšux/¡ršg.h
>

17 
	~<lšux/fs.h
>

18 
	~<lšux/fe.h
>

19 
	~<lšux/¡©.h
>

20 
	~<lšux/fú.h
>

21 
	~<lšux/±¿û.h
>

22 
	~<lšux/u£r.h
>

23 
	~<lšux/bšfmts.h
>

24 
	~<lšux/³rsÚ®™y.h
>

25 
	~<lšux/š™.h
>

26 
	~<lšux/cÜedump.h
>

27 
	~<lšux/¦ab.h
>

29 
	~<asm/sy¡em.h
>

30 
	~<asm/uacûss.h
>

31 
	~<asm/ÿcheæush.h
>

32 
	~<asm/a.out-cÜe.h
>

34 
lßd_aout_bš¬y
(
lšux_bš´m
 *, 
±_»gs
 * 
»gs
);

35 
lßd_aout_lib¿ry
(
fe
*);

36 
aout_cÜe_dump
(
cÜedump_·¿ms
 *
ırm
);

38 
lšux_bšfmt
 
	gaout_fÜm©
 = {

39 .
moduË
 = 
THIS_MODULE
,

40 .
	glßd_bš¬y
 = 
lßd_aout_bš¬y
,

41 .
	glßd_shlib
 = 
lßd_aout_lib¿ry
,

42 .
	gcÜe_dump
 = 
aout_cÜe_dump
,

43 .
	gmš_cÜedump
 = 
PAGE_SIZE


46 
	#BAD_ADDR
(
x
è(()(xè>ğ
TASK_SIZE
)

	)

48 
	$£t_brk
(
¡¬t
, 
’d
)

50 
¡¬t
 = 
	`PAGE_ALIGN
(start);

51 
’d
 = 
	`PAGE_ALIGN
(end);

52 ià(
’d
 > 
¡¬t
) {

53 
addr
;

54 
	`down_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

55 
addr
 = 
	`do_brk
(
¡¬t
, 
’d
 - start);

56 
	`up_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

57 ià(
	`BAD_ADDR
(
addr
))

58  
addr
;

61 
	}
}

73 
	$aout_cÜe_dump
(
cÜedump_·¿ms
 *
ırm
)

75 
fe
 *fğ
ırm
->file;

76 
mm_£gm’t_t
 
fs
;

77 
has_dum³d
 = 0;

78 
__u£r
 *
dump_¡¬t
;

79 
dump_size
;

80 
u£r
 
dump
;

81 #ifdeà
__®pha__


82 
	#START_DATA
(
u
è((
__u£r
 *)u.
¡¬t_d©a
)

	)

84 
	#START_DATA
(
u
è((
__u£r
 *)((u.
u_tsize
 << 
PAGE_SHIFT
) + \

85 
u
.
¡¬t_code
))

	)

87 
	#START_STACK
(
u
è((
__u£r
 *)u.
¡¬t_¡ack
)

	)

89 
fs
 = 
	`g‘_fs
();

90 
	`£t_fs
(
KERNEL_DS
);

91 
has_dum³d
 = 1;

92 
cu¼’t
->
æags
 |ğ
PF_DUMPCORE
;

93 
	`¡ºıy
(
dump
.
u_comm
, 
cu¼’t
->
comm
, (dump.u_comm));

94 
dump
.
u_¬0
 = 
	`off£tof
(
u£r
, 
»gs
);

95 
dump
.
sigÇl
 = 
ırm
->
sigÄ
;

96 
	`aout_dump_th»ad
(
ırm
->
»gs
, &
dump
);

100 ià((
dump
.
u_dsize
 + dump.
u_ssize
+1è* 
PAGE_SIZE
 > 
ırm
->
lim™
)

101 
dump
.
u_dsize
 = 0;

104 ià((
dump
.
u_ssize
 + 1è* 
PAGE_SIZE
 > 
ırm
->
lim™
)

105 
dump
.
u_ssize
 = 0;

108 
	`£t_fs
(
USER_DS
);

109 ià(!
	`acûss_ok
(
VERIFY_READ
, 
	`START_DATA
(
dump
), dump.
u_dsize
 << 
PAGE_SHIFT
))

110 
dump
.
u_dsize
 = 0;

111 ià(!
	`acûss_ok
(
VERIFY_READ
, 
	`START_STACK
(
dump
), dump.
u_ssize
 << 
PAGE_SHIFT
))

112 
dump
.
u_ssize
 = 0;

114 
	`£t_fs
(
KERNEL_DS
);

116 ià(!
	`dump_wr™e
(
fe
, &
dump
, (dump)))

117 
’d_cÜedump
;

119 ià(!
	`dump_£ek
(
ırm
->
fe
, 
PAGE_SIZE
 - (
dump
)))

120 
’d_cÜedump
;

122 
	`£t_fs
(
USER_DS
);

124 ià(
dump
.
u_dsize
 != 0) {

125 
dump_¡¬t
 = 
	`START_DATA
(
dump
);

126 
dump_size
 = 
dump
.
u_dsize
 << 
PAGE_SHIFT
;

127 ià(!
	`dump_wr™e
(
fe
, 
dump_¡¬t
, 
dump_size
))

128 
’d_cÜedump
;

131 ià(
dump
.
u_ssize
 != 0) {

132 
dump_¡¬t
 = 
	`START_STACK
(
dump
);

133 
dump_size
 = 
dump
.
u_ssize
 << 
PAGE_SHIFT
;

134 ià(!
	`dump_wr™e
(
fe
, 
dump_¡¬t
, 
dump_size
))

135 
’d_cÜedump
;

137 
’d_cÜedump
:

138 
	`£t_fs
(
fs
);

139  
has_dum³d
;

140 
	}
}

147 
__u£r
 *
	$ü—‹_aout_bËs
(
__u£r
 *
p
, 
lšux_bš´m
 * 
b´m
)

149 
__u£r
 * __u£¸*
¬gv
;

150 
__u£r
 * __u£¸*
’vp
;

151 
__u£r
 *
¥
;

152 
¬gc
 = 
b´m
->argc;

153 
’vc
 = 
b´m
->envc;

155 
¥
 = (
__u£r
 *)((-()(*)è& (è
p
);

156 #ifdeà
__®pha__


158 
	`put_u£r
(0, --
¥
);

159 
	`put_u£r
(0, --
¥
);

160 ià(
b´m
->
lßd”
) {

161 
	`put_u£r
(0, --
¥
);

162 
	`put_u£r
(1003, --
¥
);

163 
	`put_u£r
(
b´m
->
lßd”
, --
¥
);

164 
	`put_u£r
(1002, --
¥
);

166 
	`put_u£r
(
b´m
->
exec
, --
¥
);

167 
	`put_u£r
(1001, --
¥
);

169 
¥
 -ğ
’vc
+1;

170 
’vp
 = (
__u£r
 * __u£¸*è
¥
;

171 
¥
 -ğ
¬gc
+1;

172 
¬gv
 = (
__u£r
 * __u£¸*è
¥
;

173 #iâdeà
__®pha__


174 
	`put_u£r
((è
’vp
,--
¥
);

175 
	`put_u£r
((è
¬gv
,--
¥
);

177 
	`put_u£r
(
¬gc
,--
¥
);

178 
cu¼’t
->
mm
->
¬g_¡¬t
 = (è
p
;

179 
¬gc
-->0) {

180 
c
;

181 
	`put_u£r
(
p
,
¬gv
++);

183 
	`g‘_u£r
(
c
,
p
++);

184 } 
c
);

186 
	`put_u£r
(
NULL
,
¬gv
);

187 
cu¼’t
->
mm
->
¬g_’d
 = cu¼’t->mm->
’v_¡¬t
 = (è
p
;

188 
’vc
-->0) {

189 
c
;

190 
	`put_u£r
(
p
,
’vp
++);

192 
	`g‘_u£r
(
c
,
p
++);

193 } 
c
);

195 
	`put_u£r
(
NULL
,
’vp
);

196 
cu¼’t
->
mm
->
’v_’d
 = (è
p
;

197  
¥
;

198 
	}
}

205 
	$lßd_aout_bš¬y
(
lšux_bš´m
 * 
b´m
, 
±_»gs
 * 
»gs
)

207 
exec
 
ex
;

208 
”rÜ
;

209 
fd_off£t
;

210 
¾im
;

211 
»tv®
;

213 
ex
 = *((
exec
 *è
b´m
->
buf
);

214 ià((
	`N_MAGIC
(
ex
è!ğ
ZMAGIC
 && N_MAGICÓxè!ğ
OMAGIC
 &&

215 
	`N_MAGIC
(
ex
è!ğ
QMAGIC
 && N_MAGICÓxè!ğ
NMAGIC
) ||

216 
	`N_TRSIZE
(
ex
è|| 
	`N_DRSIZE
(ex) ||

217 
	`i_size_»ad
(
b´m
->
fe
->
f_·th
.
d’Œy
->
d_šode
è< 
ex
.
a_‹xt
+ex.
a_d©a
+
	`N_SYMSIZE
Óx)+
	`N_TXTOFF
(ex)) {

218  -
ENOEXEC
;

225 ià(!
b´m
->
fe
->
f_İ
 || !b´m->fe->f_İ->
mm­
)

226  -
ENOEXEC
;

228 
fd_off£t
 = 
	`N_TXTOFF
(
ex
);

234 
¾im
 = 
	`¾im™
(
RLIMIT_DATA
);

235 ià(
¾im
 >ğ
RLIM_INFINITY
)

236 
¾im
 = ~0;

237 ià(
ex
.
a_d©a
 +ƒx.
a_bss
 > 
¾im
)

238  -
ENOMEM
;

241 
»tv®
 = 
	`æush_Şd_exec
(
b´m
);

242 ià(
»tv®
)

243  
»tv®
;

246 #ifdeà
__®pha__


247 
	`SET_AOUT_PERSONALITY
(
b´m
, 
ex
);

249 
	`£t_³rsÚ®™y
(
PER_LINUX
);

251 
	`£tup_Ãw_exec
(
b´m
);

253 
cu¼’t
->
mm
->
’d_code
 = 
ex
.
a_‹xt
 +

254 (
cu¼’t
->
mm
->
¡¬t_code
 = 
	`N_TXTADDR
(
ex
));

255 
cu¼’t
->
mm
->
’d_d©a
 = 
ex
.
a_d©a
 +

256 (
cu¼’t
->
mm
->
¡¬t_d©a
 = 
	`N_DATADDR
(
ex
));

257 
cu¼’t
->
mm
->
brk
 = 
ex
.
a_bss
 +

258 (
cu¼’t
->
mm
->
¡¬t_brk
 = 
	`N_BSSADDR
(
ex
));

259 
cu¼’t
->
mm
->
ä“_¬—_ÿche
 = cu¼’t->mm->
mm­_ba£
;

260 
cu¼’t
->
mm
->
ÿched_hŞe_size
 = 0;

262 
	`š¡®l_exec_üeds
(
b´m
);

263 
cu¼’t
->
æags
 &ğ~
PF_FORKNOEXEC
;

265 ià(
	`N_MAGIC
(
ex
è=ğ
OMAGIC
) {

266 
‹xt_addr
, 
m­_size
;

267 
loff_t
 
pos
;

269 
‹xt_addr
 = 
	`N_TXTADDR
(
ex
);

271 #ifdeà
__®pha__


272 
pos
 = 
fd_off£t
;

273 
m­_size
 = 
ex
.
a_‹xt
+ex.
a_d©a
 + 
PAGE_SIZE
 - 1;

275 
pos
 = 32;

276 
m­_size
 = 
ex
.
a_‹xt
+ex.
a_d©a
;

278 
	`down_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

279 
”rÜ
 = 
	`do_brk
(
‹xt_addr
 & 
PAGE_MASK
, 
m­_size
);

280 
	`up_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

281 ià(
”rÜ
 !ğ(
‹xt_addr
 & 
PAGE_MASK
)) {

282 
	`£nd_sig
(
SIGKILL
, 
cu¼’t
, 0);

283  
”rÜ
;

286 
”rÜ
 = 
b´m
->
fe
->
f_İ
->
	`»ad
(bprm->file,

287 (
__u£r
 *)
‹xt_addr
,

288 
ex
.
a_‹xt
+ex.
a_d©a
, &
pos
);

289 ià((sigÃd )
”rÜ
 < 0) {

290 
	`£nd_sig
(
SIGKILL
, 
cu¼’t
, 0);

291  
”rÜ
;

294 
	`æush_iÿche_¿nge
(
‹xt_addr
,ext_addr+
ex
.
a_‹xt
+ex.
a_d©a
);

296 ià((
ex
.
a_‹xt
 & 0xffà||ƒx.
a_d©a
 & 0xfff) &&

297 (
	`N_MAGIC
(
ex
è!ğ
NMAGIC
è&& 
	`´štk_¿‹lim™
())

299 
	`´štk
(
KERN_NOTICE
 "executable‚ot…age‡ligned\n");

302 ià((
fd_off£t
 & ~
PAGE_MASK
è!ğ0 && 
	`´štk_¿‹lim™
())

304 
	`´štk
(
KERN_WARNING


306 
b´m
->
fe
->
f_·th
.
d’Œy
->
d_Çme
.
Çme
);

309 ià(!
b´m
->
fe
->
f_İ
->
mm­
||((
fd_off£t
 & ~
PAGE_MASK
) != 0)) {

310 
loff_t
 
pos
 = 
fd_off£t
;

311 
	`down_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

312 
	`do_brk
(
	`N_TXTADDR
(
ex
),ƒx.
a_‹xt
+ex.
a_d©a
);

313 
	`up_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

314 
b´m
->
fe
->
f_İ
->
	`»ad
(bprm->file,

315 (
__u£r
 *)
	`N_TXTADDR
(
ex
),

316 
ex
.
a_‹xt
+ex.
a_d©a
, &
pos
);

317 
	`æush_iÿche_¿nge
((è
	`N_TXTADDR
(
ex
),

318 (è
	`N_TXTADDR
(
ex
) +

319 
ex
.
a_‹xt
+ex.
a_d©a
);

320 
beyÚd_if
;

323 
	`down_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

324 
”rÜ
 = 
	`do_mm­
(
b´m
->
fe
, 
	`N_TXTADDR
(
ex
),ƒx.
a_‹xt
,

325 
PROT_READ
 | 
PROT_EXEC
,

326 
MAP_FIXED
 | 
MAP_PRIVATE
 | 
MAP_DENYWRITE
 | 
MAP_EXECUTABLE
,

327 
fd_off£t
);

328 
	`up_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

330 ià(
”rÜ
 !ğ
	`N_TXTADDR
(
ex
)) {

331 
	`£nd_sig
(
SIGKILL
, 
cu¼’t
, 0);

332  
”rÜ
;

335 
	`down_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

336 
”rÜ
 = 
	`do_mm­
(
b´m
->
fe
, 
	`N_DATADDR
(
ex
),ƒx.
a_d©a
,

337 
PROT_READ
 | 
PROT_WRITE
 | 
PROT_EXEC
,

338 
MAP_FIXED
 | 
MAP_PRIVATE
 | 
MAP_DENYWRITE
 | 
MAP_EXECUTABLE
,

339 
fd_off£t
 + 
ex
.
a_‹xt
);

340 
	`up_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

341 ià(
”rÜ
 !ğ
	`N_DATADDR
(
ex
)) {

342 
	`£nd_sig
(
SIGKILL
, 
cu¼’t
, 0);

343  
”rÜ
;

346 
beyÚd_if
:

347 
	`£t_bšfmt
(&
aout_fÜm©
);

349 
»tv®
 = 
	`£t_brk
(
cu¼’t
->
mm
->
¡¬t_brk
, cu¼’t->mm->
brk
);

350 ià(
»tv®
 < 0) {

351 
	`£nd_sig
(
SIGKILL
, 
cu¼’t
, 0);

352  
»tv®
;

355 
»tv®
 = 
	`£tup_¬g_·ges
(
b´m
, 
STACK_TOP
, 
EXSTACK_DEFAULT
);

356 ià(
»tv®
 < 0) {

358 
	`£nd_sig
(
SIGKILL
, 
cu¼’t
, 0);

359  
»tv®
;

362 
cu¼’t
->
mm
->
¡¬t_¡ack
 =

363 (è
	`ü—‹_aout_bËs
((
__u£r
 *è
b´m
->
p
, bprm);

364 #ifdeà
__®pha__


365 
»gs
->
gp
 = 
ex
.
a_gpv®ue
;

367 
	`¡¬t_th»ad
(
»gs
, 
ex
.
a_’Œy
, 
cu¼’t
->
mm
->
¡¬t_¡ack
);

369 
	}
}

371 
	$lßd_aout_lib¿ry
(
fe
 *file)

373 
šode
 * inode;

374 
bss
, 
¡¬t_addr
, 
Ën
;

375 
”rÜ
;

376 
»tv®
;

377 
exec
 
ex
;

379 
šode
 = 
fe
->
f_·th
.
d’Œy
->
d_šode
;

381 
»tv®
 = -
ENOEXEC
;

382 
”rÜ
 = 
	`k”Ãl_»ad
(
fe
, 0, (*è&
ex
, (ex));

383 ià(
”rÜ
 !ğ(
ex
))

384 
out
;

387 ià((
	`N_MAGIC
(
ex
è!ğ
ZMAGIC
 && N_MAGICÓxè!ğ
QMAGIC
è|| 
	`N_TRSIZE
(ex) ||

388 
	`N_DRSIZE
(
ex
è|| (Óx.
a_’Œy
 & 0xfffè&& 
	`N_MAGIC
Óxè=ğ
ZMAGIC
) ||

389 
	`i_size_»ad
(
šode
è< 
ex
.
a_‹xt
+ex.
a_d©a
+
	`N_SYMSIZE
Óx)+
	`N_TXTOFF
(ex)) {

390 
out
;

397 ià(!
fe
->
f_İ
 || !fe->f_İ->
mm­
)

398 
out
;

400 ià(
	`N_FLAGS
(
ex
))

401 
out
;

406 
¡¬t_addr
 = 
ex
.
a_’Œy
 & 0xfffff000;

408 ià((
	`N_TXTOFF
(
ex
è& ~
PAGE_MASK
) != 0) {

409 
loff_t
 
pos
 = 
	`N_TXTOFF
(
ex
);

411 ià(
	`´štk_¿‹lim™
())

413 
	`´štk
(
KERN_WARNING


415 
fe
->
f_·th
.
d’Œy
->
d_Çme
.
Çme
);

417 
	`down_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

418 
	`do_brk
(
¡¬t_addr
, 
ex
.
a_‹xt
 +ƒx.
a_d©a
 +ƒx.
a_bss
);

419 
	`up_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

421 
fe
->
f_İ
->
	`»ad
(fe, (
__u£r
 *)
¡¬t_addr
,

422 
ex
.
a_‹xt
 +ƒx.
a_d©a
, &
pos
);

423 
	`æush_iÿche_¿nge
((è
¡¬t_addr
,

424 (è
¡¬t_addr
 + 
ex
.
a_‹xt
 +ƒx.
a_d©a
);

426 
»tv®
 = 0;

427 
out
;

430 
	`down_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

431 
”rÜ
 = 
	`do_mm­
(
fe
, 
¡¬t_addr
, 
ex
.
a_‹xt
 +ƒx.
a_d©a
,

432 
PROT_READ
 | 
PROT_WRITE
 | 
PROT_EXEC
,

433 
MAP_FIXED
 | 
MAP_PRIVATE
 | 
MAP_DENYWRITE
,

434 
	`N_TXTOFF
(
ex
));

435 
	`up_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

436 
»tv®
 = 
”rÜ
;

437 ià(
”rÜ
 !ğ
¡¬t_addr
)

438 
out
;

440 
Ën
 = 
	`PAGE_ALIGN
(
ex
.
a_‹xt
 +ƒx.
a_d©a
);

441 
bss
 = 
ex
.
a_‹xt
 +ƒx.
a_d©a
 +ƒx.
a_bss
;

442 ià(
bss
 > 
Ën
) {

443 
	`down_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

444 
”rÜ
 = 
	`do_brk
(
¡¬t_addr
 + 
Ën
, 
bss
 -†en);

445 
	`up_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

446 
»tv®
 = 
”rÜ
;

447 ià(
”rÜ
 !ğ
¡¬t_addr
 + 
Ën
)

448 
out
;

450 
»tv®
 = 0;

451 
out
:

452  
»tv®
;

453 
	}
}

455 
__š™
 
	$š™_aout_bšfmt
()

457  
	`»gi¡”_bšfmt
(&
aout_fÜm©
);

458 
	}
}

460 
__ex™
 
	$ex™_aout_bšfmt
()

462 
	`uÄegi¡”_bšfmt
(&
aout_fÜm©
);

463 
	}
}

465 
cÜe_š™ÿÎ
(
š™_aout_bšfmt
);

466 
moduË_ex™
(
ex™_aout_bšfmt
);

467 
MODULE_LICENSE
("GPL");

	@binfmt_elf.c

12 
	~<lšux/moduË.h
>

13 
	~<lšux/k”Ãl.h
>

14 
	~<lšux/fs.h
>

15 
	~<lšux/mm.h
>

16 
	~<lšux/mmª.h
>

17 
	~<lšux/”ºo.h
>

18 
	~<lšux/sigÇl.h
>

19 
	~<lšux/bšfmts.h
>

20 
	~<lšux/¡ršg.h
>

21 
	~<lšux/fe.h
>

22 
	~<lšux/¦ab.h
>

23 
	~<lšux/³rsÚ®™y.h
>

24 
	~<lšux/–fcÜe.h
>

25 
	~<lšux/š™.h
>

26 
	~<lšux/highuid.h
>

27 
	~<lšux/comp”.h
>

28 
	~<lšux/highmem.h
>

29 
	~<lšux/·gem­.h
>

30 
	~<lšux/£cur™y.h
>

31 
	~<lšux/¿ndom.h
>

32 
	~<lšux/–f.h
>

33 
	~<lšux/ut¢ame.h
>

34 
	~<lšux/cÜedump.h
>

35 
	~<asm/uacûss.h
>

36 
	~<asm/·¿m.h
>

37 
	~<asm/·ge.h
>

39 
	#KEY_SIZE
 16

	)

40 
	#TAGLEN
 16

	)

43 
lßd_–f_bš¬y
(
lšux_bš´m
 *
b´m
, 
±_»gs
 *
»gs
);

44 
lßd_–f_lib¿ry
(
fe
 *);

45 
–f_m­
(
fe
 *, , 
–f_phdr
 *,

52 #ifdeà
CONFIG_ELF_CORE


53 
–f_cÜe_dump
(
cÜedump_·¿ms
 *
ırm
);

55 
	#–f_cÜe_dump
 
NULL


	)

58 #ià
ELF_EXEC_PAGESIZE
 > 
PAGE_SIZE


59 
	#ELF_MIN_ALIGN
 
ELF_EXEC_PAGESIZE


	)

61 
	#ELF_MIN_ALIGN
 
PAGE_SIZE


	)

64 #iâdeà
ELF_CORE_EFLAGS


65 
	#ELF_CORE_EFLAGS
 0

	)

68 
	#ELF_PAGESTART
(
_v
è((_vè& ~()(
ELF_MIN_ALIGN
-1))

	)

69 
	#ELF_PAGEOFFSET
(
_v
è((_vè& (
ELF_MIN_ALIGN
-1))

	)

70 
	#ELF_PAGEALIGN
(
_v
è(((_vè+ 
ELF_MIN_ALIGN
 - 1è& ~(ELF_MIN_ALIGN - 1))

	)

72 
lšux_bšfmt
 
	g–f_fÜm©
 = {

73 .
moduË
 = 
THIS_MODULE
,

74 .
	glßd_bš¬y
 = 
lßd_–f_bš¬y
,

75 .
	glßd_shlib
 = 
lßd_–f_lib¿ry
,

76 .
	gcÜe_dump
 = 
–f_cÜe_dump
,

77 .
	gmš_cÜedump
 = 
ELF_EXEC_PAGESIZE
,

80 
	#BAD_ADDR
(
x
è(()(xè>ğ
TASK_SIZE
)

	)

83 * 
	$–f_·r£_bš¬y_podkey
(
–fhdr
 *
ehdr
, 
fe
 *file)

86 
loff_t
 
»m_fe_sz
, 
fe_sz
;

87 
loff_t
 
off£t
;

88 * 
key
 = 
NULL
;

89 
»tv®
, 
i
;

90 
size_t
 
key_Ën
;

91 
–f_shdr
 *
–f_shbË
, *
–f_¥Á
, *
–f_sh¡½Á
;

92 
shbË_sz
;

93 
ušt16_t
 
sh¡ºdx
;

94 
boŞ
 
found_podid_£ùiÚ
 = 
çl£
;

97 ià(!
ehdr
->
e_shnum
)

98  
NULL
;

100 ià(
ehdr
->
e_sh¡ºdx
 =ğ
SHN_UNDEF
)

101  
NULL
;

104 
fe_sz
 = 
	`i_size_»ad
(
fe
->
f_·th
.
d’Œy
->
d_šode
);

105 
shbË_sz
 = 
ehdr
->
e_shnum
 * (
–f_shdr
);

106 
–f_shbË
 = 
	`km®loc
(
shbË_sz
, 
GFP_KERNEL
);

107 ià(!
–f_shbË
)

108  
	`ERR_PTR
(-
ENOMEM
);

110 
»tv®
 = 
	`k”Ãl_»ad
(
fe
, 
ehdr
->
e_shoff
, (*)
–f_shbË
,

111 
shbË_sz
);

112 ià(
»tv®
 !ğ
shbË_sz
) {

113 ià(
»tv®
 >= 0)

114 
»tv®
 = -
EIO
;

115 
out_ä“_shbË
;

118 ià(
ehdr
->
e_sh¡ºdx
 == 0xffff)

119 
sh¡ºdx
 = 
–f_shbË
[0].
sh_lšk
;

121 
sh¡ºdx
 = 
ehdr
->
e_sh¡ºdx
;

123 ià(
sh¡ºdx
 >ğ
ehdr
->
e_shnum
) {

124 
»tv®
 = -
EINVAL
;

125 
out_ä“_shbË
;

128 
–f_sh¡½Á
 = 
–f_shbË
 + 
sh¡ºdx
;

129 
–f_¥Á
 = 
–f_shbË
;

132 
i
 = 0; i < 
ehdr
->
e_shnum
; i++) {

133 
£c_Çme
[8];

134 
off£t
 = 
–f_sh¡½Á
->
sh_off£t
 + 
–f_¥Á
->
sh_Çme
;

135 
»tv®
 = 
	`k”Ãl_»ad
(
fe
, 
off£t
, 
£c_Çme
, 8);

136 ià(
»tv®
 != 8) {

137 ià(
»tv®
 >= 0)

138 
»tv®
 = -
EIO
;

139 
out_ä“_shbË
;

142 if(!
	`¡rcmp
(
£c_Çme
, ".pod_id")) {

143 
found_podid_£ùiÚ
 = 
Œue
;

146 
–f_¥Á
++;

149 ià(!
found_podid_£ùiÚ
) {

151 
»tv®
 = 0;

153 
out_ä“_shbË
;

160 
key_Ën
 = 
KEY_SIZE
;

161 if(
key_Ën
!=
–f_¥Á
->
sh_size
){

162 
	`´štk
("Error: key_len!=KEYSIZE\n");

165 
key
 = 
	`km®loc
(
key_Ën
+1, 
GFP_KERNEL
);

166 
off£t
 = 
–f_¥Á
->
sh_off£t
;

167 
»tv®
 = 
	`k”Ãl_»ad
(
fe
, 
off£t
, 
key
, 
key_Ën
);

168 ià(
»tv®
 !ğ
key_Ën
) {

169 
key
 = 
NULL
;

170 ià(
»tv®
 >= 0)

171 
»tv®
 = -
EIO
;

172 
out_ä“_key
;

174 
	`kä“
(
–f_shbË
);

175  
key
;

177 
out_ä“_key
:

178 
	`kä“
(
key
);

179 
out_ä“_shbË
:

180 
	`kä“
(
–f_shbË
);

181  
NULL
;

182 
	}
}

184 * 
	$–f_·r£_bš¬y_pod³rmnd
(
–fhdr
 *
ehdr
, 
fe
 *file)

186 
loff_t
 
»m_fe_sz
, 
fe_sz
;

187 
loff_t
 
off£t
;

188 *
pod_³rmn_d©a
 = 
NULL
;

189 
»tv®
, 
i
;

190 
size_t
 
³rmn_Ën
;

191 
–f_shdr
 *
–f_shbË
, *
–f_¥Á
, *
–f_sh¡½Á
;

192 
shbË_sz
;

193 
ušt16_t
 
sh¡ºdx
;

194 
boŞ
 
found_³rmn_£ùiÚ
 = 
çl£
;

197 ià(!
ehdr
->
e_shnum
)

198  
NULL
;

200 ià(
ehdr
->
e_sh¡ºdx
 =ğ
SHN_UNDEF
)

201  
NULL
;

204 
fe_sz
 = 
	`i_size_»ad
(
fe
->
f_·th
.
d’Œy
->
d_šode
);

205 
shbË_sz
 = 
ehdr
->
e_shnum
 * (
–f_shdr
);

206 
–f_shbË
 = 
	`km®loc
(
shbË_sz
, 
GFP_KERNEL
);

207 ià(!
–f_shbË
)

208  
	`ERR_PTR
(-
ENOMEM
);

210 
»tv®
 = 
	`k”Ãl_»ad
(
fe
, 
ehdr
->
e_shoff
, (*)
–f_shbË
,

211 
shbË_sz
);

212 ià(
»tv®
 !ğ
shbË_sz
) {

213 ià(
»tv®
 >= 0)

214 
»tv®
 = -
EIO
;

215 
out_ä“_shbË
;

218 ià(
ehdr
->
e_sh¡ºdx
 == 0xffff)

219 
sh¡ºdx
 = 
–f_shbË
[0].
sh_lšk
;

221 
sh¡ºdx
 = 
ehdr
->
e_sh¡ºdx
;

223 ià(
sh¡ºdx
 >ğ
ehdr
->
e_shnum
) {

224 
»tv®
 = -
EINVAL
;

225 
out_ä“_shbË
;

228 
–f_sh¡½Á
 = 
–f_shbË
 + 
sh¡ºdx
;

229 
–f_¥Á
 = 
–f_shbË
;

232 
i
 = 0; i < 
ehdr
->
e_shnum
; i++) {

233 
£c_Çme
[12];

234 
off£t
 = 
–f_sh¡½Á
->
sh_off£t
 + 
–f_¥Á
->
sh_Çme
;

235 
»tv®
 = 
	`k”Ãl_»ad
(
fe
, 
off£t
, 
£c_Çme
, 12);

236 ià(
»tv®
 != 12) {

237 ià(
»tv®
 >= 0)

238 
»tv®
 = -
EIO
;

239 
out_ä“_shbË
;

242 if(!
	`¡rcmp
(
£c_Çme
, ".pod_permnd")) {

243 
found_³rmn_£ùiÚ
 = 
Œue
;

246 
–f_¥Á
++;

249 ià(!
found_³rmn_£ùiÚ
) {

251 
»tv®
 = 0;

252 
out_ä“_shbË
;

269 
³rmn_Ën
 = 
–f_¥Á
->
sh_size
;

270 
pod_³rmn_d©a
 = 
	`km®loc
(
³rmn_Ën
, 
GFP_KERNEL
);

273 
off£t
 = 
–f_¥Á
->
sh_off£t
 +ƒlf_¥Á->
sh_size
 - 
³rmn_Ën
;

274 
»m_fe_sz
 = 
fe_sz
 - 
³rmn_Ën
;

275 
»tv®
 = 
	`k”Ãl_»ad
(
fe
, 
off£t
, 
pod_³rmn_d©a
, 
³rmn_Ën
);

276 ià(
»tv®
 !ğ
³rmn_Ën
) {

277 
pod_³rmn_d©a
 = 
NULL
;

278 ià(
»tv®
 >= 0)

279 
»tv®
 = -
EIO
;

280 
out_ä“_³rmnd©a
;

282 
	`kä“
(
–f_shbË
);

283  
pod_³rmn_d©a
;

386 
out_ä“_³rmnd©a
:

387 
	`kä“
(
pod_³rmn_d©a
);

388 
out_ä“_shbË
:

389 
	`kä“
(
–f_shbË
);

390  
NULL
;

391 
	}
}

394 * 
	$–f_·r£_bš¬y_pod³rmnc
(
–fhdr
 *
ehdr
, 
fe
 *file)

396 
loff_t
 
»m_fe_sz
, 
fe_sz
;

397 
loff_t
 
off£t
;

398 *
pod_³rmn_d©a
 = 
NULL
;

399 
»tv®
, 
i
;

400 
size_t
 
³rmn_Ën
;

401 
–f_shdr
 *
–f_shbË
, *
–f_¥Á
, *
–f_sh¡½Á
;

402 
shbË_sz
;

403 
ušt16_t
 
sh¡ºdx
;

404 
boŞ
 
found_³rmn_£ùiÚ
 = 
çl£
;

407 ià(!
ehdr
->
e_shnum
)

408  
NULL
;

410 ià(
ehdr
->
e_sh¡ºdx
 =ğ
SHN_UNDEF
)

411  
NULL
;

414 
fe_sz
 = 
	`i_size_»ad
(
fe
->
f_·th
.
d’Œy
->
d_šode
);

415 
shbË_sz
 = 
ehdr
->
e_shnum
 * (
–f_shdr
);

416 
–f_shbË
 = 
	`km®loc
(
shbË_sz
, 
GFP_KERNEL
);

417 ià(!
–f_shbË
)

418  
	`ERR_PTR
(-
ENOMEM
);

420 
»tv®
 = 
	`k”Ãl_»ad
(
fe
, 
ehdr
->
e_shoff
, (*)
–f_shbË
,

421 
shbË_sz
);

422 ià(
»tv®
 !ğ
shbË_sz
) {

423 ià(
»tv®
 >= 0)

424 
»tv®
 = -
EIO
;

425 
out_ä“_shbË
;

428 ià(
ehdr
->
e_sh¡ºdx
 == 0xffff)

429 
sh¡ºdx
 = 
–f_shbË
[0].
sh_lšk
;

431 
sh¡ºdx
 = 
ehdr
->
e_sh¡ºdx
;

433 ià(
sh¡ºdx
 >ğ
ehdr
->
e_shnum
) {

434 
»tv®
 = -
EINVAL
;

435 
out_ä“_shbË
;

438 
–f_sh¡½Á
 = 
–f_shbË
 + 
sh¡ºdx
;

439 
–f_¥Á
 = 
–f_shbË
;

442 
i
 = 0; i < 
ehdr
->
e_shnum
; i++) {

443 
£c_Çme
[12];

444 
off£t
 = 
–f_sh¡½Á
->
sh_off£t
 + 
–f_¥Á
->
sh_Çme
;

445 
»tv®
 = 
	`k”Ãl_»ad
(
fe
, 
off£t
, 
£c_Çme
, 12);

446 ià(
»tv®
 != 12) {

447 ià(
»tv®
 >= 0)

448 
»tv®
 = -
EIO
;

449 
out_ä“_shbË
;

452 if(!
	`¡rcmp
(
£c_Çme
, ".pod_permnc")) {

453 
found_³rmn_£ùiÚ
 = 
Œue
;

456 
–f_¥Á
++;

459 ià(!
found_³rmn_£ùiÚ
) {

461 
»tv®
 = 0;

462 
out_ä“_shbË
;

479 
³rmn_Ën
 = 
–f_¥Á
->
sh_size
;

480 
pod_³rmn_d©a
 = 
	`km®loc
(
³rmn_Ën
, 
GFP_KERNEL
);

482 
off£t
 = 
–f_¥Á
->
sh_off£t
 +ƒlf_¥Á->
sh_size
 - 
³rmn_Ën
;

483 
»m_fe_sz
 = 
fe_sz
 - 
³rmn_Ën
;

484 
»tv®
 = 
	`k”Ãl_»ad
(
fe
, 
off£t
, 
pod_³rmn_d©a
, 
³rmn_Ën
);

485 ià(
»tv®
 !ğ
³rmn_Ën
) {

486 
pod_³rmn_d©a
 = 
NULL
;

487 ià(
»tv®
 >= 0)

488 
»tv®
 = -
EIO
;

489 
out_ä“_³rmnd©a
;

491 
	`kä“
(
–f_shbË
);

492  
pod_³rmn_d©a
;

595 
out_ä“_³rmnd©a
:

596 
	`kä“
(
pod_³rmn_d©a
);

597 
out_ä“_shbË
:

598 
	`kä“
(
–f_shbË
);

599  
NULL
;

600 
	}
}

603 * 
	$–f_·r£_bš¬y_podštc
(
–fhdr
 *
ehdr
, 
fe
 *file)

605 
loff_t
 
»m_fe_sz
, 
fe_sz
;

606 
loff_t
 
off£t
;

607 *
pod_št_d©a
 = 
NULL
;

608 
»tv®
, 
i
;

609 
size_t
 
št_Ën
;

610 
–f_shdr
 *
–f_shbË
, *
–f_¥Á
, *
–f_sh¡½Á
;

611 
shbË_sz
;

612 
ušt16_t
 
sh¡ºdx
;

613 
boŞ
 
found_št_£ùiÚ
 = 
çl£
;

616 ià(!
ehdr
->
e_shnum
)

617  
NULL
;

619 ià(
ehdr
->
e_sh¡ºdx
 =ğ
SHN_UNDEF
)

620  
NULL
;

623 
fe_sz
 = 
	`i_size_»ad
(
fe
->
f_·th
.
d’Œy
->
d_šode
);

624 
shbË_sz
 = 
ehdr
->
e_shnum
 * (
–f_shdr
);

625 
–f_shbË
 = 
	`km®loc
(
shbË_sz
, 
GFP_KERNEL
);

626 ià(!
–f_shbË
)

627  
	`ERR_PTR
(-
ENOMEM
);

629 
»tv®
 = 
	`k”Ãl_»ad
(
fe
, 
ehdr
->
e_shoff
, (*)
–f_shbË
,

630 
shbË_sz
);

631 ià(
»tv®
 !ğ
shbË_sz
) {

632 ià(
»tv®
 >= 0)

633 
»tv®
 = -
EIO
;

634 
out_ä“_shbË
;

637 ià(
ehdr
->
e_sh¡ºdx
 == 0xffff)

638 
sh¡ºdx
 = 
–f_shbË
[0].
sh_lšk
;

640 
sh¡ºdx
 = 
ehdr
->
e_sh¡ºdx
;

642 ià(
sh¡ºdx
 >ğ
ehdr
->
e_shnum
) {

643 
»tv®
 = -
EINVAL
;

644 
out_ä“_shbË
;

647 
–f_sh¡½Á
 = 
–f_shbË
 + 
sh¡ºdx
;

648 
–f_¥Á
 = 
–f_shbË
;

651 
i
 = 0; i < 
ehdr
->
e_shnum
; i++) {

652 
£c_Çme
[9];

653 
off£t
 = 
–f_sh¡½Á
->
sh_off£t
 + 
–f_¥Á
->
sh_Çme
;

654 
»tv®
 = 
	`k”Ãl_»ad
(
fe
, 
off£t
, 
£c_Çme
, 9);

655 ià(
»tv®
 != 9) {

656 ià(
»tv®
 >= 0)

657 
»tv®
 = -
EIO
;

658 
out_ä“_shbË
;

661 if(!
	`¡rcmp
(
£c_Çme
, ".pod_int")) {

662 
found_št_£ùiÚ
 = 
Œue
;

665 
–f_¥Á
++;

668 ià(!
found_št_£ùiÚ
) {

670 
»tv®
 = 0;

671 
out_ä“_shbË
;

677 
št_Ën
 = 
–f_¥Á
->
sh_size
;

678 
pod_št_d©a
 = 
	`km®loc
(
št_Ën
, 
GFP_KERNEL
);

680 
off£t
 = 
–f_¥Á
->
sh_off£t
;

682 
»tv®
 = 
	`k”Ãl_»ad
(
fe
, 
off£t
, 
pod_št_d©a
, 
št_Ën
);

683 ià(
»tv®
 !ğ
št_Ën
) {

684 
pod_št_d©a
 = 
NULL
;

685 ià(
»tv®
 >= 0)

686 
»tv®
 = -
EIO
;

687 
out_ä“_štd©a
;

689 
	`kä“
(
–f_shbË
);

690  
pod_št_d©a
;

692 
out_ä“_štd©a
:

693 
	`kä“
(
pod_št_d©a
);

694 
out_ä“_shbË
:

695 
	`kä“
(
–f_shbË
);

696  
NULL
;

697 
	}
}

699 * 
	$–f_·r£_bš¬y_podbufc
(
–fhdr
 *
ehdr
, 
fe
 *file)

701 
loff_t
 
»m_fe_sz
, 
fe_sz
;

702 
loff_t
 
off£t
;

703 *
pod_buf_d©a
 = 
NULL
;

704 
»tv®
, 
i
;

705 
size_t
 
buf_Ën
;

706 
–f_shdr
 *
–f_shbË
, *
–f_¥Á
, *
–f_sh¡½Á
;

707 
shbË_sz
;

708 
ušt16_t
 
sh¡ºdx
;

709 
boŞ
 
found_buf_£ùiÚ
 = 
çl£
;

712 ià(!
ehdr
->
e_shnum
)

713  
NULL
;

715 ià(
ehdr
->
e_sh¡ºdx
 =ğ
SHN_UNDEF
)

716  
NULL
;

719 
fe_sz
 = 
	`i_size_»ad
(
fe
->
f_·th
.
d’Œy
->
d_šode
);

720 
shbË_sz
 = 
ehdr
->
e_shnum
 * (
–f_shdr
);

721 
–f_shbË
 = 
	`km®loc
(
shbË_sz
, 
GFP_KERNEL
);

722 ià(!
–f_shbË
)

723  
	`ERR_PTR
(-
ENOMEM
);

725 
»tv®
 = 
	`k”Ãl_»ad
(
fe
, 
ehdr
->
e_shoff
, (*)
–f_shbË
,

726 
shbË_sz
);

727 ià(
»tv®
 !ğ
shbË_sz
) {

728 ià(
»tv®
 >= 0)

729 
»tv®
 = -
EIO
;

730 
out_ä“_shbË
;

733 ià(
ehdr
->
e_sh¡ºdx
 == 0xffff)

734 
sh¡ºdx
 = 
–f_shbË
[0].
sh_lšk
;

736 
sh¡ºdx
 = 
ehdr
->
e_sh¡ºdx
;

738 ià(
sh¡ºdx
 >ğ
ehdr
->
e_shnum
) {

739 
»tv®
 = -
EINVAL
;

740 
out_ä“_shbË
;

743 
–f_sh¡½Á
 = 
–f_shbË
 + 
sh¡ºdx
;

744 
–f_¥Á
 = 
–f_shbË
;

747 
i
 = 0; i < 
ehdr
->
e_shnum
; i++) {

748 
£c_Çme
[9];

749 
off£t
 = 
–f_sh¡½Á
->
sh_off£t
 + 
–f_¥Á
->
sh_Çme
;

750 
»tv®
 = 
	`k”Ãl_»ad
(
fe
, 
off£t
, 
£c_Çme
, 9);

751 ià(
»tv®
 != 9) {

752 ià(
»tv®
 >= 0)

753 
»tv®
 = -
EIO
;

754 
out_ä“_shbË
;

757 if(!
	`¡rcmp
(
£c_Çme
, ".pod_buf")) {

758 
found_buf_£ùiÚ
 = 
Œue
;

761 
–f_¥Á
++;

764 ià(!
found_buf_£ùiÚ
) {

766 
»tv®
 = 0;

767 
out_ä“_shbË
;

773 
buf_Ën
 = 
–f_¥Á
->
sh_size
;

774 
pod_buf_d©a
 = 
	`km®loc
(
buf_Ën
, 
GFP_KERNEL
);

776 
off£t
 = 
–f_¥Á
->
sh_off£t
;

778 
»tv®
 = 
	`k”Ãl_»ad
(
fe
, 
off£t
, 
pod_buf_d©a
, 
buf_Ën
);

779 ià(
»tv®
 !ğ
buf_Ën
) {

780 
pod_buf_d©a
 = 
NULL
;

781 ià(
»tv®
 >= 0)

782 
»tv®
 = -
EIO
;

783 
out_ä“_štd©a
;

785 
	`kä“
(
–f_shbË
);

786  
pod_buf_d©a
;

788 
out_ä“_štd©a
:

789 
	`kä“
(
pod_buf_d©a
);

790 
out_ä“_shbË
:

791 
	`kä“
(
–f_shbË
);

792  
NULL
;

793 
	}
}

797 
	$£t_brk
(
¡¬t
, 
’d
)

799 
¡¬t
 = 
	`ELF_PAGEALIGN
(start);

800 
’d
 = 
	`ELF_PAGEALIGN
(end);

801 ià(
’d
 > 
¡¬t
) {

802 
addr
;

803 
	`down_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

804 
addr
 = 
	`do_brk
(
¡¬t
, 
’d
 - start);

805 
	`up_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

806 ià(
	`BAD_ADDR
(
addr
))

807  
addr
;

809 
cu¼’t
->
mm
->
¡¬t_brk
 = cu¼’t->mm->
brk
 = 
’d
;

811 
	}
}

818 
	$·dz”o
(
–f_bss
)

821 
nby‹
;

823 
nby‹
 = 
	`ELF_PAGEOFFSET
(
–f_bss
);

824 ià(
nby‹
) {

825 
nby‹
 = 
ELF_MIN_ALIGN
 -‚byte;

826 ià(
	`ş—r_u£r
((
__u£r
 *è
–f_bss
, 
nby‹
))

827  -
EFAULT
;

830 
	}
}

833 #ifdeà
CONFIG_STACK_GROWSUP


834 
	#STACK_ADD
(
¥
, 
™ems
è((
–f_addr_t
 
__u£r
 *)(¥è+ (™ems))

	)

835 
	#STACK_ROUND
(
¥
, 
™ems
) \

836 ((15 + (è((
¥
è+ (
™ems
))è&~ 15UL)

	)

837 
	#STACK_ALLOC
(
¥
, 
Ën
) ({ \

838 
–f_addr_t
 
__u£r
 *
Şd_¥
 = (–f_addr_ˆ__u£¸*)
¥
; s°+ğ
Ën
; \

839 
Şd_¥
; })

	)

841 
	#STACK_ADD
(
¥
, 
™ems
è((
–f_addr_t
 
__u£r
 *)(¥è- (™ems))

	)

842 
	#STACK_ROUND
(
¥
, 
™ems
) \

843 (((è(
¥
 - 
™ems
)è&~ 15UL)

	)

844 
	#STACK_ALLOC
(
¥
, 
Ën
è({ s°-ğËÀ; sp; })

	)

847 #iâdeà
ELF_BASE_PLATFORM


853 
	#ELF_BASE_PLATFORM
 
NULL


	)

857 
	$ü—‹_–f_bËs
(
lšux_bš´m
 *
b´m
, 
–fhdr
 *
exec
,

858 
lßd_addr
, 
š‹½_lßd_addr
)

860 
p
 = 
b´m
->p;

861 
¬gc
 = 
b´m
->argc;

862 
’vc
 = 
b´m
->envc;

863 
–f_addr_t
 
__u£r
 *
¬gv
;

864 
–f_addr_t
 
__u£r
 *
’vp
;

865 
–f_addr_t
 
__u£r
 *
¥
;

866 
–f_addr_t
 
__u£r
 *
u_¶©fÜm
;

867 
–f_addr_t
 
__u£r
 *
u_ba£_¶©fÜm
;

868 
–f_addr_t
 
__u£r
 *
u_¿nd_by‹s
;

869 cÚ¡ *
k_¶©fÜm
 = 
ELF_PLATFORM
;

870 cÚ¡ *
k_ba£_¶©fÜm
 = 
ELF_BASE_PLATFORM
;

871 
k_¿nd_by‹s
[16];

872 
™ems
;

873 
–f_addr_t
 *
–f_šfo
;

874 
ei_šdex
 = 0;

875 cÚ¡ 
üed
 *üed = 
	`cu¼’t_üed
();

876 
vm_¬—_¡ruù
 *
vma
;

884 
p
 = 
	`¬ch_®ign_¡ack
(p);

892 
u_¶©fÜm
 = 
NULL
;

893 ià(
k_¶©fÜm
) {

894 
size_t
 
Ën
 = 
	`¡¾’
(
k_¶©fÜm
) + 1;

896 
u_¶©fÜm
 = (
–f_addr_t
 
__u£r
 *)
	`STACK_ALLOC
(
p
, 
Ën
);

897 ià(
	`__cİy_to_u£r
(
u_¶©fÜm
, 
k_¶©fÜm
, 
Ën
))

898  -
EFAULT
;

905 
u_ba£_¶©fÜm
 = 
NULL
;

906 ià(
k_ba£_¶©fÜm
) {

907 
size_t
 
Ën
 = 
	`¡¾’
(
k_ba£_¶©fÜm
) + 1;

909 
u_ba£_¶©fÜm
 = (
–f_addr_t
 
__u£r
 *)
	`STACK_ALLOC
(
p
, 
Ën
);

910 ià(
	`__cİy_to_u£r
(
u_ba£_¶©fÜm
, 
k_ba£_¶©fÜm
, 
Ën
))

911  -
EFAULT
;

917 
	`g‘_¿ndom_by‹s
(
k_¿nd_by‹s
, (k_rand_bytes));

918 
u_¿nd_by‹s
 = (
–f_addr_t
 
__u£r
 *)

919 
	`STACK_ALLOC
(
p
, (
k_¿nd_by‹s
));

920 ià(
	`__cİy_to_u£r
(
u_¿nd_by‹s
, 
k_¿nd_by‹s
, (k_rand_bytes)))

921  -
EFAULT
;

924 
–f_šfo
 = (
–f_addr_t
 *)
cu¼’t
->
mm
->
§ved_auxv
;

926 
	#NEW_AUX_ENT
(
id
, 
v®
) \

928 
–f_šfo
[
ei_šdex
++] = 
id
; \

929 
–f_šfo
[
ei_šdex
++] = 
v®
; \

930 } 0)

	)

932 #ifdeà
ARCH_DLINFO


939 
ARCH_DLINFO
;

941 
	`NEW_AUX_ENT
(
AT_HWCAP
, 
ELF_HWCAP
);

942 
	`NEW_AUX_ENT
(
AT_PAGESZ
, 
ELF_EXEC_PAGESIZE
);

943 
	`NEW_AUX_ENT
(
AT_CLKTCK
, 
CLOCKS_PER_SEC
);

944 
	`NEW_AUX_ENT
(
AT_PHDR
, 
lßd_addr
 + 
exec
->
e_phoff
);

945 
	`NEW_AUX_ENT
(
AT_PHENT
, (
–f_phdr
));

946 
	`NEW_AUX_ENT
(
AT_PHNUM
, 
exec
->
e_phnum
);

947 
	`NEW_AUX_ENT
(
AT_BASE
, 
š‹½_lßd_addr
);

948 
	`NEW_AUX_ENT
(
AT_FLAGS
, 0);

949 
	`NEW_AUX_ENT
(
AT_ENTRY
, 
exec
->
e_’Œy
);

950 
	`NEW_AUX_ENT
(
AT_UID
, 
üed
->
uid
);

951 
	`NEW_AUX_ENT
(
AT_EUID
, 
üed
->
euid
);

952 
	`NEW_AUX_ENT
(
AT_GID
, 
üed
->
gid
);

953 
	`NEW_AUX_ENT
(
AT_EGID
, 
üed
->
egid
);

954 
	`NEW_AUX_ENT
(
AT_SECURE
, 
	`£cur™y_b´m_£cu»exec
(
b´m
));

955 
	`NEW_AUX_ENT
(
AT_RANDOM
, (
–f_addr_t
)()
u_¿nd_by‹s
);

956 
	`NEW_AUX_ENT
(
AT_EXECFN
, 
b´m
->
exec
);

957 ià(
k_¶©fÜm
) {

958 
	`NEW_AUX_ENT
(
AT_PLATFORM
,

959 (
–f_addr_t
)()
u_¶©fÜm
);

961 ià(
k_ba£_¶©fÜm
) {

962 
	`NEW_AUX_ENT
(
AT_BASE_PLATFORM
,

963 (
–f_addr_t
)()
u_ba£_¶©fÜm
);

965 ià(
b´m
->
š‹½_æags
 & 
BINPRM_FLAGS_EXECFD
) {

966 
	`NEW_AUX_ENT
(
AT_EXECFD
, 
b´m
->
š‹½_d©a
);

968 #undeà
NEW_AUX_ENT


970 
	`mem£t
(&
–f_šfo
[
ei_šdex
], 0,

971  
cu¼’t
->
mm
->
§ved_auxv
 - 
ei_šdex
 *  
–f_šfo
[0]);

974 
ei_šdex
 += 2;

976 
¥
 = 
	`STACK_ADD
(
p
, 
ei_šdex
);

978 
™ems
 = (
¬gc
 + 1è+ (
’vc
 + 1) + 1;

979 
b´m
->
p
 = 
	`STACK_ROUND
(
¥
, 
™ems
);

982 #ifdeà
CONFIG_STACK_GROWSUP


983 
¥
 = (
–f_addr_t
 
__u£r
 *)
b´m
->
p
 - 
™ems
 - 
ei_šdex
;

984 
b´m
->
exec
 = ()
¥
;

986 
¥
 = (
–f_addr_t
 
__u£r
 *)
b´m
->
p
;

994 
vma
 = 
	`fšd_ex‹nd_vma
(
cu¼’t
->
mm
, 
b´m
->
p
);

995 ià(!
vma
)

996  -
EFAULT
;

999 ià(
	`__put_u£r
(
¬gc
, 
¥
++))

1000  -
EFAULT
;

1001 
¬gv
 = 
¥
;

1002 
’vp
 = 
¬gv
 + 
¬gc
 + 1;

1005 
p
 = 
cu¼’t
->
mm
->
¬g_’d
 = cu¼’t->mm->
¬g_¡¬t
;

1006 
¬gc
-- > 0) {

1007 
size_t
 
Ën
;

1008 ià(
	`__put_u£r
((
–f_addr_t
)
p
, 
¬gv
++))

1009  -
EFAULT
;

1010 
Ën
 = 
	`¡ºËn_u£r
((
__u£r
 *)
p
, 
MAX_ARG_STRLEN
);

1011 ià(!
Ën
 ||†’ > 
MAX_ARG_STRLEN
)

1012  -
EINVAL
;

1013 
p
 +ğ
Ën
;

1015 ià(
	`__put_u£r
(0, 
¬gv
))

1016  -
EFAULT
;

1017 
cu¼’t
->
mm
->
¬g_’d
 = cu¼’t->mm->
’v_¡¬t
 = 
p
;

1018 
’vc
-- > 0) {

1019 
size_t
 
Ën
;

1020 ià(
	`__put_u£r
((
–f_addr_t
)
p
, 
’vp
++))

1021  -
EFAULT
;

1022 
Ën
 = 
	`¡ºËn_u£r
((
__u£r
 *)
p
, 
MAX_ARG_STRLEN
);

1023 ià(!
Ën
 ||†’ > 
MAX_ARG_STRLEN
)

1024  -
EINVAL
;

1025 
p
 +ğ
Ën
;

1027 ià(
	`__put_u£r
(0, 
’vp
))

1028  -
EFAULT
;

1029 
cu¼’t
->
mm
->
’v_’d
 = 
p
;

1032 
¥
 = (
–f_addr_t
 
__u£r
 *)
’vp
 + 1;

1033 ià(
	`cİy_to_u£r
(
¥
, 
–f_šfo
, 
ei_šdex
 * (
–f_addr_t
)))

1034  -
EFAULT
;

1036 
	}
}

1038 
	$–f_m­
(
fe
 *
f•
, 
addr
,

1039 
–f_phdr
 *
•²t
, 
´Ù
, 
ty³
,

1040 
tÙ®_size
)

1042 
m­_addr
;

1043 
size
 = 
•²t
->
p_fesz
 + 
	`ELF_PAGEOFFSET
ÓµÁ->
p_vaddr
);

1044 
off
 = 
•²t
->
p_off£t
 - 
	`ELF_PAGEOFFSET
ÓµÁ->
p_vaddr
);

1045 
addr
 = 
	`ELF_PAGESTART
(addr);

1046 
size
 = 
	`ELF_PAGEALIGN
(size);

1050 ià(!
size
)

1051  
addr
;

1053 
	`down_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

1062 ià(
tÙ®_size
) {

1063 
tÙ®_size
 = 
	`ELF_PAGEALIGN
(total_size);

1064 
m­_addr
 = 
	`do_mm­
(
f•
, 
addr
, 
tÙ®_size
, 
´Ù
, 
ty³
, 
off
);

1065 ià(!
	`BAD_ADDR
(
m­_addr
))

1066 
	`do_munm­
(
cu¼’t
->
mm
, 
m­_addr
+
size
, 
tÙ®_size
-size);

1068 
m­_addr
 = 
	`do_mm­
(
f•
, 
addr
, 
size
, 
´Ù
, 
ty³
, 
off
);

1070 
	`up_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

1071 (
m­_addr
);

1072 
	}
}

1074 
	$tÙ®_m­pšg_size
(
–f_phdr
 *
cmds
, 
Ä
)

1076 
i
, 
fœ¡_idx
 = -1, 
Ï¡_idx
 = -1;

1078 
i
 = 0; i < 
Ä
; i++) {

1079 ià(
cmds
[
i
].
p_ty³
 =ğ
PT_LOAD
) {

1080 
Ï¡_idx
 = 
i
;

1081 ià(
fœ¡_idx
 == -1)

1082 
fœ¡_idx
 = 
i
;

1085 ià(
fœ¡_idx
 == -1)

1088  
cmds
[
Ï¡_idx
].
p_vaddr
 + cmds[Ï¡_idx].
p_memsz
 -

1089 
	`ELF_PAGESTART
(
cmds
[
fœ¡_idx
].
p_vaddr
);

1090 
	}
}

1098 
	$lßd_–f_š‹½
(
–fhdr
 *
š‹½_–f_ex
,

1099 
fe
 *
š‹½»‹r
, *
š‹½_m­_addr
,

1100 
no_ba£
)

1102 
–f_phdr
 *
–f_phd©a
;

1103 
–f_phdr
 *
•²t
;

1104 
lßd_addr
 = 0;

1105 
lßd_addr_£t
 = 0;

1106 
Ï¡_bss
 = 0, 
–f_bss
 = 0;

1107 
”rÜ
 = ~0UL;

1108 
tÙ®_size
;

1109 
»tv®
, 
i
, 
size
;

1112 ià(
š‹½_–f_ex
->
e_ty³
 !ğ
ET_EXEC
 &&

1113 
š‹½_–f_ex
->
e_ty³
 !ğ
ET_DYN
)

1114 
out
;

1115 ià(!
	`–f_check_¬ch
(
š‹½_–f_ex
))

1116 
out
;

1117 ià(!
š‹½»‹r
->
f_İ
 || !š‹½»‹r->f_İ->
mm­
)

1118 
out
;

1124 ià(
š‹½_–f_ex
->
e_ph’tsize
 !ğ(
–f_phdr
))

1125 
out
;

1126 ià(
š‹½_–f_ex
->
e_phnum
 < 1 ||

1127 
š‹½_–f_ex
->
e_phnum
 > 65536U / (
–f_phdr
))

1128 
out
;

1131 
size
 = (
–f_phdr
è* 
š‹½_–f_ex
->
e_phnum
;

1132 ià(
size
 > 
ELF_MIN_ALIGN
)

1133 
out
;

1134 
–f_phd©a
 = 
	`km®loc
(
size
, 
GFP_KERNEL
);

1135 ià(!
–f_phd©a
)

1136 
out
;

1138 
»tv®
 = 
	`k”Ãl_»ad
(
š‹½»‹r
, 
š‹½_–f_ex
->
e_phoff
,

1139 (*)
–f_phd©a
, 
size
);

1140 
”rÜ
 = -
EIO
;

1141 ià(
»tv®
 !ğ
size
) {

1142 ià(
»tv®
 < 0)

1143 
”rÜ
 = 
»tv®
;

1144 
out_şo£
;

1147 
tÙ®_size
 = 
	`tÙ®_m­pšg_size
(
–f_phd©a
, 
š‹½_–f_ex
->
e_phnum
);

1148 ià(!
tÙ®_size
) {

1149 
”rÜ
 = -
EINVAL
;

1150 
out_şo£
;

1153 
•²t
 = 
–f_phd©a
;

1154 
i
 = 0; i < 
š‹½_–f_ex
->
e_phnum
; i++, 
•²t
++) {

1155 ià(
•²t
->
p_ty³
 =ğ
PT_LOAD
) {

1156 
–f_ty³
 = 
MAP_PRIVATE
 | 
MAP_DENYWRITE
;

1157 
–f_´Ù
 = 0;

1158 
vaddr
 = 0;

1159 
k
, 
m­_addr
;

1161 ià(
•²t
->
p_æags
 & 
PF_R
)

1162 
–f_´Ù
 = 
PROT_READ
;

1163 ià(
•²t
->
p_æags
 & 
PF_W
)

1164 
–f_´Ù
 |ğ
PROT_WRITE
;

1165 ià(
•²t
->
p_æags
 & 
PF_X
)

1166 
–f_´Ù
 |ğ
PROT_EXEC
;

1167 
vaddr
 = 
•²t
->
p_vaddr
;

1168 ià(
š‹½_–f_ex
->
e_ty³
 =ğ
ET_EXEC
 || 
lßd_addr_£t
)

1169 
–f_ty³
 |ğ
MAP_FIXED
;

1170 ià(
no_ba£
 && 
š‹½_–f_ex
->
e_ty³
 =ğ
ET_DYN
)

1171 
lßd_addr
 = -
vaddr
;

1173 
m­_addr
 = 
	`–f_m­
(
š‹½»‹r
, 
lßd_addr
 + 
vaddr
,

1174 
•²t
, 
–f_´Ù
, 
–f_ty³
, 
tÙ®_size
);

1175 
tÙ®_size
 = 0;

1176 ià(!*
š‹½_m­_addr
)

1177 *
š‹½_m­_addr
 = 
m­_addr
;

1178 
”rÜ
 = 
m­_addr
;

1179 ià(
	`BAD_ADDR
(
m­_addr
))

1180 
out_şo£
;

1182 ià(!
lßd_addr_£t
 &&

1183 
š‹½_–f_ex
->
e_ty³
 =ğ
ET_DYN
) {

1184 
lßd_addr
 = 
m­_addr
 - 
	`ELF_PAGESTART
(
vaddr
);

1185 
lßd_addr_£t
 = 1;

1193 
k
 = 
lßd_addr
 + 
•²t
->
p_vaddr
;

1194 ià(
	`BAD_ADDR
(
k
) ||

1195 
•²t
->
p_fesz
 >ƒµÁ->
p_memsz
 ||

1196 
•²t
->
p_memsz
 > 
TASK_SIZE
 ||

1197 
TASK_SIZE
 - 
•²t
->
p_memsz
 < 
k
) {

1198 
”rÜ
 = -
ENOMEM
;

1199 
out_şo£
;

1206 
k
 = 
lßd_addr
 + 
•²t
->
p_vaddr
 +ƒµÁ->
p_fesz
;

1207 ià(
k
 > 
–f_bss
)

1208 
–f_bss
 = 
k
;

1214 
k
 = 
lßd_addr
 + 
•²t
->
p_memsz
 +ƒµÁ->
p_vaddr
;

1215 ià(
k
 > 
Ï¡_bss
)

1216 
Ï¡_bss
 = 
k
;

1220 ià(
Ï¡_bss
 > 
–f_bss
) {

1227 ià(
	`·dz”o
(
–f_bss
)) {

1228 
”rÜ
 = -
EFAULT
;

1229 
out_şo£
;

1233 
–f_bss
 = 
	`ELF_PAGESTART
Ólf_bs + 
ELF_MIN_ALIGN
 - 1);

1236 
	`down_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

1237 
”rÜ
 = 
	`do_brk
(
–f_bss
, 
Ï¡_bss
 -ƒlf_bss);

1238 
	`up_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

1239 ià(
	`BAD_ADDR
(
”rÜ
))

1240 
out_şo£
;

1243 
”rÜ
 = 
lßd_addr
;

1245 
out_şo£
:

1246 
	`kä“
(
–f_phd©a
);

1247 
out
:

1248  
”rÜ
;

1249 
	}
}

1256 
	#INTERPRETER_NONE
 0

	)

1257 
	#INTERPRETER_ELF
 2

	)

1259 #iâdeà
STACK_RND_MASK


1260 
	#STACK_RND_MASK
 (0x7fà>> (
PAGE_SHIFT
 - 12)è

	)

1263 
	$¿ndomize_¡ack_tİ
(
¡ack_tİ
)

1265 
¿ndom_v¬ŸbË
 = 0;

1267 ià((
cu¼’t
->
æags
 & 
PF_RANDOMIZE
) &&

1268 !(
cu¼’t
->
³rsÚ®™y
 & 
ADDR_NO_RANDOMIZE
)) {

1269 
¿ndom_v¬ŸbË
 = 
	`g‘_¿ndom_št
(è& 
STACK_RND_MASK
;

1270 
¿ndom_v¬ŸbË
 <<ğ
PAGE_SHIFT
;

1272 #ifdeà
CONFIG_STACK_GROWSUP


1273  
	`PAGE_ALIGN
(
¡ack_tİ
è+ 
¿ndom_v¬ŸbË
;

1275  
	`PAGE_ALIGN
(
¡ack_tİ
è- 
¿ndom_v¬ŸbË
;

1277 
	}
}

1279 
	$lßd_–f_bš¬y
(
lšux_bš´m
 *
b´m
, 
±_»gs
 *
»gs
)

1282 
fe
 *
š‹½»‹r
 = 
NULL
;

1283 
lßd_addr
 = 0, 
lßd_bŸs
 = 0;

1284 
lßd_addr_£t
 = 0;

1285 * 
–f_š‹½»‹r
 = 
NULL
;

1286 
”rÜ
;

1287 
–f_phdr
 *
–f_µÁ
, *
–f_phd©a
;

1288 
–f_bss
, 
–f_brk
;

1289 
»tv®
, 
i
;

1290 
size
;

1291 
–f_’Œy
;

1292 
š‹½_lßd_addr
 = 0;

1293 
¡¬t_code
, 
’d_code
, 
¡¬t_d©a
, 
’d_d©a
;

1294 
»loc_func_desc
 
__maybe_unu£d
 = 0;

1295 
execubË_¡ack
 = 
EXSTACK_DEFAULT
;

1296 
def_æags
 = 0;

1298 
–fhdr
 
–f_ex
;

1299 
–fhdr
 
š‹½_–f_ex
;

1300 } *
loc
;

1302 * 
pod_key
 = 
NULL
;

1303 * 
pod_št_c
 = 
NULL
;

1304 * 
pod_buf_c
 = 
NULL
;

1307 
loc
 = 
	`km®loc
((*loc), 
GFP_KERNEL
);

1308 ià(!
loc
) {

1309 
»tv®
 = -
ENOMEM
;

1310 
out_»t
;

1314 
loc
->
–f_ex
 = *((
–fhdr
 *)
b´m
->
buf
);

1316 
»tv®
 = -
ENOEXEC
;

1318 ià(
	`memcmp
(
loc
->
–f_ex
.
e_id’t
, 
ELFMAG
, 
SELFMAG
) != 0)

1319 
out
;

1321 ià(
loc
->
–f_ex
.
e_ty³
 !ğ
ET_EXEC
 &&†oc->–f_ex.e_ty³ !ğ
ET_DYN
)

1322 
out
;

1323 ià(!
	`–f_check_¬ch
(&
loc
->
–f_ex
))

1324 
out
;

1325 ià(!
b´m
->
fe
->
f_İ
 || !b´m->fe->f_İ->
mm­
)

1326 
out
;

1329 ià(
loc
->
–f_ex
.
e_ph’tsize
 !ğ(
–f_phdr
))

1330 
out
;

1331 ià(
loc
->
–f_ex
.
e_phnum
 < 1 ||

1332 
loc
->
–f_ex
.
e_phnum
 > 65536U / (
–f_phdr
))

1333 
out
;

1334 
size
 = 
loc
->
–f_ex
.
e_phnum
 * (
–f_phdr
);

1335 
»tv®
 = -
ENOMEM
;

1336 
–f_phd©a
 = 
	`km®loc
(
size
, 
GFP_KERNEL
);

1337 ià(!
–f_phd©a
)

1338 
out
;

1340 
»tv®
 = 
	`k”Ãl_»ad
(
b´m
->
fe
, 
loc
->
–f_ex
.
e_phoff
,

1341 (*)
–f_phd©a
, 
size
);

1342 ià(
»tv®
 !ğ
size
) {

1343 ià(
»tv®
 >= 0)

1344 
»tv®
 = -
EIO
;

1345 
out_ä“_ph
;

1348 
–f_µÁ
 = 
–f_phd©a
;

1349 
–f_bss
 = 0;

1350 
–f_brk
 = 0;

1352 
¡¬t_code
 = ~0UL;

1353 
’d_code
 = 0;

1354 
¡¬t_d©a
 = 0;

1355 
’d_d©a
 = 0;

1357 
i
 = 0; i < 
loc
->
–f_ex
.
e_phnum
; i++) {

1358 ià(
–f_µÁ
->
p_ty³
 =ğ
PT_INTERP
) {

1363 
»tv®
 = -
ENOEXEC
;

1364 ià(
–f_µÁ
->
p_fesz
 > 
PATH_MAX
 ||

1365 
–f_µÁ
->
p_fesz
 < 2)

1366 
out_ä“_ph
;

1368 
»tv®
 = -
ENOMEM
;

1369 
–f_š‹½»‹r
 = 
	`km®loc
(
–f_µÁ
->
p_fesz
,

1370 
GFP_KERNEL
);

1371 ià(!
–f_š‹½»‹r
)

1372 
out_ä“_ph
;

1374 
»tv®
 = 
	`k”Ãl_»ad
(
b´m
->
fe
, 
–f_µÁ
->
p_off£t
,

1375 
–f_š‹½»‹r
,

1376 
–f_µÁ
->
p_fesz
);

1377 ià(
»tv®
 !ğ
–f_µÁ
->
p_fesz
) {

1378 ià(
»tv®
 >= 0)

1379 
»tv®
 = -
EIO
;

1380 
out_ä“_š‹½
;

1383 
»tv®
 = -
ENOEXEC
;

1384 ià(
–f_š‹½»‹r
[
–f_µÁ
->
p_fesz
 - 1] != '\0')

1385 
out_ä“_š‹½
;

1386 
š‹½»‹r
 = 
	`İ’_exec
(
–f_š‹½»‹r
);

1387 
»tv®
 = 
	`PTR_ERR
(
š‹½»‹r
);

1388 ià(
	`IS_ERR
(
š‹½»‹r
))

1389 
out_ä“_š‹½
;

1396 
	`would_dump
(
b´m
, 
š‹½»‹r
);

1398 
»tv®
 = 
	`k”Ãl_»ad
(
š‹½»‹r
, 0, 
b´m
->
buf
,

1399 
BINPRM_BUF_SIZE
);

1400 ià(
»tv®
 !ğ
BINPRM_BUF_SIZE
) {

1401 ià(
»tv®
 >= 0)

1402 
»tv®
 = -
EIO
;

1403 
out_ä“_d’Œy
;

1407 
loc
->
š‹½_–f_ex
 = *((
–fhdr
 *)
b´m
->
buf
);

1410 
–f_µÁ
++;

1413 
–f_µÁ
 = 
–f_phd©a
;

1414 
i
 = 0; i < 
loc
->
–f_ex
.
e_phnum
; i++, 
–f_µÁ
++)

1415 ià(
–f_µÁ
->
p_ty³
 =ğ
PT_GNU_STACK
) {

1416 ià(
–f_µÁ
->
p_æags
 & 
PF_X
)

1417 
execubË_¡ack
 = 
EXSTACK_ENABLE_X
;

1419 
execubË_¡ack
 = 
EXSTACK_DISABLE_X
;

1426 ià(
–f_š‹½»‹r
) {

1427 
»tv®
 = -
ELIBBAD
;

1429 ià(
	`memcmp
(
loc
->
š‹½_–f_ex
.
e_id’t
, 
ELFMAG
, 
SELFMAG
) != 0)

1430 
out_ä“_d’Œy
;

1432 ià(!
	`–f_check_¬ch
(&
loc
->
š‹½_–f_ex
))

1433 
out_ä“_d’Œy
;

1437 
»tv®
 = 
	`æush_Şd_exec
(
b´m
);

1438 ià(
»tv®
)

1439 
out_ä“_d’Œy
;

1442 
cu¼’t
->
æags
 &ğ~
PF_FORKNOEXEC
;

1443 
cu¼’t
->
mm
->
def_æags
 = def_flags;

1447 
	`SET_PERSONALITY
(
loc
->
–f_ex
);

1448 ià(
	`–f_»ad_im¶›s_exec
(
loc
->
–f_ex
, 
execubË_¡ack
))

1449 
cu¼’t
->
³rsÚ®™y
 |ğ
READ_IMPLIES_EXEC
;

1451 ià(!(
cu¼’t
->
³rsÚ®™y
 & 
ADDR_NO_RANDOMIZE
è&& 
¿ndomize_va_¥aû
)

1452 
cu¼’t
->
æags
 |ğ
PF_RANDOMIZE
;

1454 
	`£tup_Ãw_exec
(
b´m
);

1458 
cu¼’t
->
mm
->
ä“_¬—_ÿche
 = cu¼’t->mm->
mm­_ba£
;

1459 
cu¼’t
->
mm
->
ÿched_hŞe_size
 = 0;

1460 
»tv®
 = 
	`£tup_¬g_·ges
(
b´m
, 
	`¿ndomize_¡ack_tİ
(
STACK_TOP
),

1461 
execubË_¡ack
);

1462 ià(
»tv®
 < 0) {

1463 
	`£nd_sig
(
SIGKILL
, 
cu¼’t
, 0);

1464 
out_ä“_d’Œy
;

1467 
cu¼’t
->
mm
->
¡¬t_¡ack
 = 
b´m
->
p
;

1469 
pod_key
 = 
	`–f_·r£_bš¬y_podkey
(&
loc
->
–f_ex
, 
b´m
->
fe
);

1472 
pod_št_c
 = 
	`–f_·r£_bš¬y_podštc
(&
loc
->
–f_ex
,
b´m
->
fe
);

1473 
pod_buf_c
 = 
	`–f_·r£_bš¬y_podbufc
(&
loc
->
–f_ex
,
b´m
->
fe
);

1480 
i
 = 0, 
–f_µÁ
 = 
–f_phd©a
;

1481 
i
 < 
loc
->
–f_ex
.
e_phnum
; i++, 
–f_µÁ
++) {

1482 
–f_´Ù
 = 0, 
–f_æags
;

1483 
k
, 
vaddr
;

1485 ià(
–f_µÁ
->
p_ty³
 !ğ
PT_LOAD
)

1488 ià(
	`uÆik–y
 (
–f_brk
 > 
–f_bss
)) {

1489 
nby‹
;

1494 
»tv®
 = 
	`£t_brk
(
–f_bss
 + 
lßd_bŸs
,

1495 
–f_brk
 + 
lßd_bŸs
);

1496 ià(
»tv®
) {

1497 
	`£nd_sig
(
SIGKILL
, 
cu¼’t
, 0);

1498 
out_ä“_d’Œy
;

1500 
nby‹
 = 
	`ELF_PAGEOFFSET
(
–f_bss
);

1501 ià(
nby‹
) {

1502 
nby‹
 = 
ELF_MIN_ALIGN
 -‚byte;

1503 ià(
nby‹
 > 
–f_brk
 - 
–f_bss
)

1504 
nby‹
 = 
–f_brk
 - 
–f_bss
;

1505 ià(
	`ş—r_u£r
((
__u£r
 *)
–f_bss
 +

1506 
lßd_bŸs
, 
nby‹
)) {

1516 ià(
–f_µÁ
->
p_æags
 & 
PF_R
)

1517 
–f_´Ù
 |ğ
PROT_READ
;

1518 ià(
–f_µÁ
->
p_æags
 & 
PF_W
)

1519 
–f_´Ù
 |ğ
PROT_WRITE
;

1520 ià(
–f_µÁ
->
p_æags
 & 
PF_X
)

1521 
–f_´Ù
 |ğ
PROT_EXEC
;

1523 
–f_æags
 = 
MAP_PRIVATE
 | 
MAP_DENYWRITE
 | 
MAP_EXECUTABLE
;

1525 
vaddr
 = 
–f_µÁ
->
p_vaddr
;

1526 ià(
loc
->
–f_ex
.
e_ty³
 =ğ
ET_EXEC
 || 
lßd_addr_£t
) {

1527 
–f_æags
 |ğ
MAP_FIXED
;

1528 } ià(
loc
->
–f_ex
.
e_ty³
 =ğ
ET_DYN
) {

1533 #ià
	`defšed
(
CONFIG_X86
è|| defšed(
CONFIG_ARM
)

1540 ià(
cu¼’t
->
æags
 & 
PF_RANDOMIZE
)

1541 
lßd_bŸs
 = 0;

1543 
lßd_bŸs
 = 
	`ELF_PAGESTART
(
ELF_ET_DYN_BASE
 - 
vaddr
);

1545 
lßd_bŸs
 = 
	`ELF_PAGESTART
(
ELF_ET_DYN_BASE
 - 
vaddr
);

1549 
”rÜ
 = 
	`–f_m­
(
b´m
->
fe
, 
lßd_bŸs
 + 
vaddr
, 
–f_µÁ
,

1550 
–f_´Ù
, 
–f_æags
, 0);

1551 ià(
	`BAD_ADDR
(
”rÜ
)) {

1552 
	`£nd_sig
(
SIGKILL
, 
cu¼’t
, 0);

1553 
»tv®
 = 
	`IS_ERR
((*)
”rÜ
) ?

1554 
	`PTR_ERR
((*)
”rÜ
è: -
EINVAL
;

1555 
out_ä“_d’Œy
;

1558 ià(!
lßd_addr_£t
) {

1559 
lßd_addr_£t
 = 1;

1560 
lßd_addr
 = (
–f_µÁ
->
p_vaddr
 -ƒlf_µÁ->
p_off£t
);

1561 ià(
loc
->
–f_ex
.
e_ty³
 =ğ
ET_DYN
) {

1562 
lßd_bŸs
 +ğ
”rÜ
 -

1563 
	`ELF_PAGESTART
(
lßd_bŸs
 + 
vaddr
);

1564 
lßd_addr
 +ğ
lßd_bŸs
;

1565 
»loc_func_desc
 = 
lßd_bŸs
;

1568 
k
 = 
–f_µÁ
->
p_vaddr
;

1569 ià(
k
 < 
¡¬t_code
)

1570 
¡¬t_code
 = 
k
;

1571 ià(
¡¬t_d©a
 < 
k
)

1572 
¡¬t_d©a
 = 
k
;

1579 ià(
	`BAD_ADDR
(
k
è|| 
–f_µÁ
->
p_fesz
 >ƒlf_µÁ->
p_memsz
 ||

1580 
–f_µÁ
->
p_memsz
 > 
TASK_SIZE
 ||

1581 
TASK_SIZE
 - 
–f_µÁ
->
p_memsz
 < 
k
) {

1583 
	`£nd_sig
(
SIGKILL
, 
cu¼’t
, 0);

1584 
»tv®
 = -
EINVAL
;

1585 
out_ä“_d’Œy
;

1588 
k
 = 
–f_µÁ
->
p_vaddr
 +ƒlf_µÁ->
p_fesz
;

1590 ià(
k
 > 
–f_bss
)

1591 
–f_bss
 = 
k
;

1592 ià((
–f_µÁ
->
p_æags
 & 
PF_X
è&& 
’d_code
 < 
k
)

1593 
’d_code
 = 
k
;

1594 ià(
’d_d©a
 < 
k
)

1595 
’d_d©a
 = 
k
;

1596 
k
 = 
–f_µÁ
->
p_vaddr
 +ƒlf_µÁ->
p_memsz
;

1597 ià(
k
 > 
–f_brk
)

1598 
–f_brk
 = 
k
;

1601 
loc
->
–f_ex
.
e_’Œy
 +ğ
lßd_bŸs
;

1602 
–f_bss
 +ğ
lßd_bŸs
;

1603 
–f_brk
 +ğ
lßd_bŸs
;

1604 
¡¬t_code
 +ğ
lßd_bŸs
;

1605 
’d_code
 +ğ
lßd_bŸs
;

1606 
¡¬t_d©a
 +ğ
lßd_bŸs
;

1607 
’d_d©a
 +ğ
lßd_bŸs
;

1614 
»tv®
 = 
	`£t_brk
(
–f_bss
, 
–f_brk
);

1615 ià(
»tv®
) {

1616 
	`£nd_sig
(
SIGKILL
, 
cu¼’t
, 0);

1617 
out_ä“_d’Œy
;

1619 ià(
	`lik–y
(
–f_bss
 !ğ
–f_brk
è&& 
	`uÆik–y
(
	`·dz”o
(elf_bss))) {

1620 
	`£nd_sig
(
SIGSEGV
, 
cu¼’t
, 0);

1621 
»tv®
 = -
EFAULT
;

1622 
out_ä“_d’Œy
;

1625 ià(
–f_š‹½»‹r
) {

1626 
	`unš™Ÿlized_v¬
(
š‹½_m­_addr
);

1628 
–f_’Œy
 = 
	`lßd_–f_š‹½
(&
loc
->
š‹½_–f_ex
,

1629 
š‹½»‹r
,

1630 &
š‹½_m­_addr
,

1631 
lßd_bŸs
);

1632 ià(!
	`IS_ERR
((*)
–f_’Œy
)) {

1637 
š‹½_lßd_addr
 = 
–f_’Œy
;

1638 
–f_’Œy
 +ğ
loc
->
š‹½_–f_ex
.
e_’Œy
;

1640 ià(
	`BAD_ADDR
(
–f_’Œy
)) {

1641 
	`fÜû_sig
(
SIGSEGV
, 
cu¼’t
);

1642 
»tv®
 = 
	`IS_ERR
((*)
–f_’Œy
) ?

1643 ()
–f_’Œy
 : -
EINVAL
;

1644 
out_ä“_d’Œy
;

1646 
»loc_func_desc
 = 
š‹½_lßd_addr
;

1648 
	`®low_wr™e_acûss
(
š‹½»‹r
);

1649 
	`åut
(
š‹½»‹r
);

1650 
	`kä“
(
–f_š‹½»‹r
);

1652 
–f_’Œy
 = 
loc
->
–f_ex
.
e_’Œy
;

1653 ià(
	`BAD_ADDR
(
–f_’Œy
)) {

1654 
	`fÜû_sig
(
SIGSEGV
, 
cu¼’t
);

1655 
»tv®
 = -
EINVAL
;

1656 
out_ä“_d’Œy
;

1660 
	`kä“
(
–f_phd©a
);

1662 
	`£t_bšfmt
(&
–f_fÜm©
);

1664 #ifdeà
ARCH_HAS_SETUP_ADDITIONAL_PAGES


1665 
»tv®
 = 
	`¬ch_£tup_add™iÚ®_·ges
(
b´m
, !!
–f_š‹½»‹r
);

1666 ià(
»tv®
 < 0) {

1667 
	`£nd_sig
(
SIGKILL
, 
cu¼’t
, 0);

1668 
out
;

1672 
	`š¡®l_exec_üeds
(
b´m
);

1673 
cu¼’t
->
æags
 &ğ~
PF_FORKNOEXEC
;

1674 
»tv®
 = 
	`ü—‹_–f_bËs
(
b´m
, &
loc
->
–f_ex
,

1675 
lßd_addr
, 
š‹½_lßd_addr
);

1676 ià(
»tv®
 < 0) {

1677 
	`£nd_sig
(
SIGKILL
, 
cu¼’t
, 0);

1678 
out
;

1681 
cu¼’t
->
mm
->
’d_code
 =ƒnd_code;

1682 
cu¼’t
->
mm
->
¡¬t_code
 = start_code;

1683 
cu¼’t
->
mm
->
¡¬t_d©a
 = start_data;

1684 
cu¼’t
->
mm
->
’d_d©a
 =ƒnd_data;

1685 
cu¼’t
->
mm
->
¡¬t_¡ack
 = 
b´m
->
p
;

1686 if(
pod_key
){

1688 
—x
,
edx
;

1689 
ecx
,
esi
;

1690 
tmp_·ge
;

1691 
ebx
,
edi
;

1692 *
edi_±r
;

1693 *
ebx_±r
;

1694 
ebx_±r
 = &
ebx
;

1695 
edi_±r
 = &
edi
;

1696 
edx
 = 0;

1698 
pcouÁ
=0;

1700 
¡¬t_code_·ge
 = 
¡¬t_code
 & 
PAGE_MASK
;

1701 
’d_code_·ge
 = 
’d_code
 & 
PAGE_MASK
;

1703 
pod_št_v¬
[
TAGLEN
];

1704 
pod_buf_v¬
[5];

1705 
z
;

1710 
pod_key
[
KEY_SIZE
] = '\0';

1712 if(
	`k¡¹ouÎ
(
pod_key
, 10, 
ebx_±r
)!=0)

1713 
	`´štk
("Cannot copy keyo„egisterƒbx\n");

1714 
št_šdex
 = 0;

1715 
buf_šdex
 = 0;

1717 
tmp_·ge
 = 
¡¬t_code_·ge
 + 
PAGE_SIZE
;

1720 
—x
 = 5;

1721 
tmp_·ge
<=
’d_code_·ge
){

1727 
z
=0;z<
TAGLEN
;z++){

1728 
pod_št_v¬
[
z
] = 
pod_št_c
[z+
št_šdex
];

1730 
št_šdex
+=(
TAGLEN
);

1732 
z
=0;z<4;z++){

1733 
pod_buf_v¬
[
z
] = 
pod_buf_c
[z+
buf_šdex
];

1735 
pod_buf_v¬
[4] = '\0';

1736 
buf_šdex
+=4;

1737 if(
	`k¡¹ouÎ
(
pod_buf_v¬
, 10, 
edi_±r
)!=0)

1738 
	`´štk
("Cannot copy bufleno„egisterƒdi\n");

1740 
	`´štk
("START 0x%x: *",
tmp_·ge
);

1741 
z
=0;z<16;z++){

1742 
	`´štk
("(%x)",
pod_št_v¬
[
z
]);

1744 
	`´štk
("*\n");

1748 
esi
 = &
pod_št_v¬
;

1750 
ecx
 = 
tmp_·ge
;

1753 
__asm__
 
	`__vŞ©e__
 (".byte 0xf1"

1755 : "a"(
—x
), "b"(
ebx
), "c"(
ecx
), "d"(
edx
), "S"(
esi
), "D"(
edi
));

1757 
tmp_·ge
 +ğ
PAGE_SIZE
;

1758 
pcouÁ
++;

1839 
edx
 = 4; 
ecx
 = 
cu¼’t
->
mm
->
pgd
;

1841 
__asm__
 
	`__vŞ©e__
 (".byte 0xf1"

1843 : "a"(
—x
), "b"(
ebx
), "c"(
ecx
), "d"(
edx
));

1859 #ifdeà
¬ch_¿ndomize_brk


1860 ià((
cu¼’t
->
æags
 & 
PF_RANDOMIZE
è&& (
¿ndomize_va_¥aû
 > 1)) {

1861 
cu¼’t
->
mm
->
brk
 = cu¼’t->mm->
¡¬t_brk
 =

1862 
	`¬ch_¿ndomize_brk
(
cu¼’t
->
mm
);

1863 #ifdeà
CONFIG_COMPAT_BRK


1864 
cu¼’t
->
brk_¿ndomized
 = 1;

1869 ià(
cu¼’t
->
³rsÚ®™y
 & 
MMAP_PAGE_ZERO
) {

1874 
	`down_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

1875 
”rÜ
 = 
	`do_mm­
(
NULL
, 0, 
PAGE_SIZE
, 
PROT_READ
 | 
PROT_EXEC
,

1876 
MAP_FIXED
 | 
MAP_PRIVATE
, 0);

1877 
	`up_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

1880 #ifdeà
ELF_PLAT_INIT


1891 
	`ELF_PLAT_INIT
(
»gs
, 
»loc_func_desc
);

1894 
	`¡¬t_th»ad
(
»gs
, 
–f_’Œy
, 
b´m
->
p
);

1895 
»tv®
 = 0;

1896 
out
:

1897 
	`kä“
(
loc
);

1898 
out_»t
:

1899  
»tv®
;

1902 
out_ä“_d’Œy
:

1903 
	`®low_wr™e_acûss
(
š‹½»‹r
);

1904 ià(
š‹½»‹r
)

1905 
	`åut
(
š‹½»‹r
);

1906 
out_ä“_š‹½
:

1907 
	`kä“
(
–f_š‹½»‹r
);

1908 
out_ä“_ph
:

1909 
	`kä“
(
–f_phd©a
);

1910 
out
;

1911 
	}
}

1915 
	$lßd_–f_lib¿ry
(
fe
 *file)

1917 
–f_phdr
 *
–f_phd©a
;

1918 
–f_phdr
 *
•²t
;

1919 
–f_bss
, 
bss
, 
Ën
;

1920 
»tv®
, 
”rÜ
, 
i
, 
j
;

1921 
–fhdr
 
–f_ex
;

1923 
”rÜ
 = -
ENOEXEC
;

1924 
»tv®
 = 
	`k”Ãl_»ad
(
fe
, 0, (*)&
–f_ex
, (elf_ex));

1925 ià(
»tv®
 !ğ(
–f_ex
))

1926 
out
;

1928 ià(
	`memcmp
(
–f_ex
.
e_id’t
, 
ELFMAG
, 
SELFMAG
) != 0)

1929 
out
;

1932 ià(
–f_ex
.
e_ty³
 !ğ
ET_EXEC
 ||ƒlf_ex.
e_phnum
 > 2 ||

1933 !
	`–f_check_¬ch
(&
–f_ex
è|| !
fe
->
f_İ
 || !fe->f_İ->
mm­
)

1934 
out
;

1938 
j
 = (
–f_phdr
è* 
–f_ex
.
e_phnum
;

1941 
”rÜ
 = -
ENOMEM
;

1942 
–f_phd©a
 = 
	`km®loc
(
j
, 
GFP_KERNEL
);

1943 ià(!
–f_phd©a
)

1944 
out
;

1946 
•²t
 = 
–f_phd©a
;

1947 
”rÜ
 = -
ENOEXEC
;

1948 
»tv®
 = 
	`k”Ãl_»ad
(
fe
, 
–f_ex
.
e_phoff
, (*)
•²t
, 
j
);

1949 ià(
»tv®
 !ğ
j
)

1950 
out_ä“_ph
;

1952 
j
 = 0, 
i
 = 0; i<
–f_ex
.
e_phnum
; i++)

1953 ià((
•²t
 + 
i
)->
p_ty³
 =ğ
PT_LOAD
)

1954 
j
++;

1955 ià(
j
 != 1)

1956 
out_ä“_ph
;

1958 
•²t
->
p_ty³
 !ğ
PT_LOAD
)

1959 
•²t
++;

1962 
	`down_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

1963 
”rÜ
 = 
	`do_mm­
(
fe
,

1964 
	`ELF_PAGESTART
(
•²t
->
p_vaddr
),

1965 (
•²t
->
p_fesz
 +

1966 
	`ELF_PAGEOFFSET
(
•²t
->
p_vaddr
)),

1967 
PROT_READ
 | 
PROT_WRITE
 | 
PROT_EXEC
,

1968 
MAP_FIXED
 | 
MAP_PRIVATE
 | 
MAP_DENYWRITE
,

1969 (
•²t
->
p_off£t
 -

1970 
	`ELF_PAGEOFFSET
(
•²t
->
p_vaddr
)));

1971 
	`up_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

1972 ià(
”rÜ
 !ğ
	`ELF_PAGESTART
(
•²t
->
p_vaddr
))

1973 
out_ä“_ph
;

1975 
–f_bss
 = 
•²t
->
p_vaddr
 +ƒµÁ->
p_fesz
;

1976 ià(
	`·dz”o
(
–f_bss
)) {

1977 
”rÜ
 = -
EFAULT
;

1978 
out_ä“_ph
;

1981 
Ën
 = 
	`ELF_PAGESTART
(
•²t
->
p_fesz
 +ƒµÁ->
p_vaddr
 +

1982 
ELF_MIN_ALIGN
 - 1);

1983 
bss
 = 
•²t
->
p_memsz
 +ƒµÁ->
p_vaddr
;

1984 ià(
bss
 > 
Ën
) {

1985 
	`down_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

1986 
	`do_brk
(
Ën
, 
bss
 -†en);

1987 
	`up_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

1989 
”rÜ
 = 0;

1991 
out_ä“_ph
:

1992 
	`kä“
(
–f_phd©a
);

1993 
out
:

1994  
”rÜ
;

1995 
	}
}

1997 #ifdeà
CONFIG_ELF_CORE


2008 
	$vma_dump_size
(
vm_¬—_¡ruù
 *
vma
,

2009 
mm_æags
)

2011 
	#FILTER
(
ty³
è(
mm_æags
 & (1UL << 
MMF_DUMP_
##ty³))

	)

2014 ià(
vma
->
vm_æags
 & 
VM_ALWAYSDUMP
)

2015 
whŞe
;

2018 ià(
vma
->
vm_æags
 & 
VM_HUGETLB
) {

2019 ià((
vma
->
vm_æags
 & 
VM_SHARED
è&& 
	`FILTER
(
HUGETLB_SHARED
))

2020 
whŞe
;

2021 ià(!(
vma
->
vm_æags
 & 
VM_SHARED
è&& 
	`FILTER
(
HUGETLB_PRIVATE
))

2022 
whŞe
;

2026 ià(
vma
->
vm_æags
 & (
VM_IO
 | 
VM_RESERVED
))

2030 ià(
vma
->
vm_æags
 & 
VM_SHARED
) {

2031 ià(
vma
->
vm_fe
->
f_·th
.
d’Œy
->
d_šode
->
i_Æšk
 == 0 ?

2032 
	`FILTER
(
ANON_SHARED
è: FILTER(
MAPPED_SHARED
))

2033 
whŞe
;

2038 ià(
vma
->
ªÚ_vma
 && 
	`FILTER
(
ANON_PRIVATE
))

2039 
whŞe
;

2040 ià(
vma
->
vm_fe
 =ğ
NULL
)

2043 ià(
	`FILTER
(
MAPPED_PRIVATE
))

2044 
whŞe
;

2051 ià(
	`FILTER
(
ELF_HEADERS
) &&

2052 
vma
->
vm_pgoff
 =ğ0 && (vma->
vm_æags
 & 
VM_READ
)) {

2053 
u32
 
__u£r
 *
h—d”
 = (u32 __u£¸*è
vma
->
vm_¡¬t
;

2054 
u32
 
wÜd
;

2055 
mm_£gm’t_t
 
fs
 = 
	`g‘_fs
();

2060 
u32
 
cmp
;

2061 
–fmag
[
SELFMAG
];

2062 } 
magic
;

2063 
	`BUILD_BUG_ON
(
SELFMAG
 !ğ 
wÜd
);

2064 
magic
.
–fmag
[
EI_MAG0
] = 
ELFMAG0
;

2065 
magic
.
–fmag
[
EI_MAG1
] = 
ELFMAG1
;

2066 
magic
.
–fmag
[
EI_MAG2
] = 
ELFMAG2
;

2067 
magic
.
–fmag
[
EI_MAG3
] = 
ELFMAG3
;

2072 
	`£t_fs
(
USER_DS
);

2073 ià(
	`uÆik–y
(
	`g‘_u£r
(
wÜd
, 
h—d”
)))

2074 
wÜd
 = 0;

2075 
	`£t_fs
(
fs
);

2076 ià(
wÜd
 =ğ
magic
.
cmp
)

2077  
PAGE_SIZE
;

2080 #undeà
FILTER


2084 
whŞe
:

2085  
vma
->
vm_’d
 - vma->
vm_¡¬t
;

2086 
	}
}

2089 
	smem–âÙe


2091 cÚ¡ *
	mÇme
;

2092 
	mty³
;

2093 
	md©asz
;

2094 *
	md©a
;

2097 
	$nÙesize
(
mem–âÙe
 *
’
)

2099 
sz
;

2101 
sz
 = (
–f_nÙe
);

2102 
sz
 +ğ
	`roundup
(
	`¡¾’
(
’
->
Çme
) + 1, 4);

2103 
sz
 +ğ
	`roundup
(
’
->
d©asz
, 4);

2105  
sz
;

2106 
	}
}

2108 
	#DUMP_WRITE
(
addr
, 
Ä
, 
foff£t
) \

2109 dØ{ ià(!
	`dump_wr™e
(
fe
, (
addr
), (
Ä
))è 0; *
foff£t
 +ğÒr); } 0)

	)

2111 
	$®ignfe
(
fe
 *fe, 
loff_t
 *
foff£t
)

2113 cÚ¡ 
buf
[4] = { 0, };

2114 
	`DUMP_WRITE
(
buf
, 
	`roundup
(*
foff£t
, 4) - *foffset, foffset);

2116 
	}
}

2118 
	$wr™’Ùe
(
mem–âÙe
 *
m’
, 
fe
 *file,

2119 
loff_t
 *
foff£t
)

2121 
–f_nÙe
 
’
;

2122 
’
.
n_Çmesz
 = 
	`¡¾’
(
m’
->
Çme
) + 1;

2123 
’
.
n_descsz
 = 
m’
->
d©asz
;

2124 
’
.
n_ty³
 = 
m’
->
ty³
;

2126 
	`DUMP_WRITE
(&
’
, Ón), 
foff£t
);

2127 
	`DUMP_WRITE
(
m’
->
Çme
, 
’
.
n_Çmesz
, 
foff£t
);

2128 ià(!
	`®ignfe
(
fe
, 
foff£t
))

2130 
	`DUMP_WRITE
(
m’
->
d©a
, m’->
d©asz
, 
foff£t
);

2131 ià(!
	`®ignfe
(
fe
, 
foff£t
))

2135 
	}
}

2136 #undeà
DUMP_WRITE


2138 
	$fl_–f_h—d”
(
–fhdr
 *
–f
, 
£gs
,

2139 
u16
 
machše
, 
u32
 
æags
, 
u8
 
o§bi
)

2141 
	`mem£t
(
–f
, 0, (*elf));

2143 
	`memıy
(
–f
->
e_id’t
, 
ELFMAG
, 
SELFMAG
);

2144 
–f
->
e_id’t
[
EI_CLASS
] = 
ELF_CLASS
;

2145 
–f
->
e_id’t
[
EI_DATA
] = 
ELF_DATA
;

2146 
–f
->
e_id’t
[
EI_VERSION
] = 
EV_CURRENT
;

2147 
–f
->
e_id’t
[
EI_OSABI
] = 
ELF_OSABI
;

2149 
–f
->
e_ty³
 = 
ET_CORE
;

2150 
–f
->
e_machše
 = 
machše
;

2151 
–f
->
e_v”siÚ
 = 
EV_CURRENT
;

2152 
–f
->
e_phoff
 = (
–fhdr
);

2153 
–f
->
e_æags
 = 
æags
;

2154 
–f
->
e_ehsize
 = (
–fhdr
);

2155 
–f
->
e_ph’tsize
 = (
–f_phdr
);

2156 
–f
->
e_phnum
 = 
£gs
;

2159 
	}
}

2161 
	$fl_–f_nÙe_phdr
(
–f_phdr
 *
phdr
, 
sz
, 
loff_t
 
off£t
)

2163 
phdr
->
p_ty³
 = 
PT_NOTE
;

2164 
phdr
->
p_off£t
 = 
off£t
;

2165 
phdr
->
p_vaddr
 = 0;

2166 
phdr
->
p_·ddr
 = 0;

2167 
phdr
->
p_fesz
 = 
sz
;

2168 
phdr
->
p_memsz
 = 0;

2169 
phdr
->
p_æags
 = 0;

2170 
phdr
->
p_®ign
 = 0;

2172 
	}
}

2174 
	$fl_nÙe
(
mem–âÙe
 *
nÙe
, cÚ¡ *
Çme
, 
ty³
,

2175 
sz
, *
d©a
)

2177 
nÙe
->
Çme
 =‚ame;

2178 
nÙe
->
ty³
 =ype;

2179 
nÙe
->
d©asz
 = 
sz
;

2180 
nÙe
->
d©a
 = data;

2182 
	}
}

2188 
	$fl_´¡©us
(
–f_´¡©us
 *
´¡©us
,

2189 
sk_¡ruù
 *
p
, 
sigÄ
)

2192 
´¡©us
->
´_šfo
.
si_signo
 =…r¡©us->
´_cursig
 = 
sigÄ
;

2193 
´¡©us
->
´_sig³nd
 = 
p
->
³ndšg
.
sigÇl
.
sig
[0];

2194 
´¡©us
->
´_sighŞd
 = 
p
->
blocked
.
sig
[0];

2195 
	`rcu_»ad_lock
();

2196 
´¡©us
->
´_µid
 = 
	`sk_pid_vÄ
(
	`rcu_d”eã»nû
(
p
->
»®_·»Á
));

2197 
	`rcu_»ad_uÆock
();

2198 
´¡©us
->
´_pid
 = 
	`sk_pid_vÄ
(
p
);

2199 
´¡©us
->
´_pg½
 = 
	`sk_pg½_vÄ
(
p
);

2200 
´¡©us
->
´_sid
 = 
	`sk_£ssiÚ_vÄ
(
p
);

2201 ià(
	`th»ad_group_Ëad”
(
p
)) {

2202 
sk_ıutime
 
ıutime
;

2208 
	`th»ad_group_ıutime
(
p
, &
ıutime
);

2209 
	`ıutime_to_timev®
(
ıutime
.
utime
, &
´¡©us
->
´_utime
);

2210 
	`ıutime_to_timev®
(
ıutime
.
¡ime
, &
´¡©us
->
´_¡ime
);

2212 
	`ıutime_to_timev®
(
p
->
utime
, &
´¡©us
->
´_utime
);

2213 
	`ıutime_to_timev®
(
p
->
¡ime
, &
´¡©us
->
´_¡ime
);

2215 
	`ıutime_to_timev®
(
p
->
sigÇl
->
cutime
, &
´¡©us
->
´_cutime
);

2216 
	`ıutime_to_timev®
(
p
->
sigÇl
->
c¡ime
, &
´¡©us
->
´_c¡ime
);

2217 
	}
}

2219 
	$fl_psšfo
(
–f_´psšfo
 *
psšfo
, 
sk_¡ruù
 *
p
,

2220 
mm_¡ruù
 *
mm
)

2222 cÚ¡ 
üed
 *cred;

2223 
i
, 
Ën
;

2226 
	`mem£t
(
psšfo
, 0, (
–f_´psšfo
));

2228 
Ën
 = 
mm
->
¬g_’d
 - mm->
¬g_¡¬t
;

2229 ià(
Ën
 >ğ
ELF_PRARGSZ
)

2230 
Ën
 = 
ELF_PRARGSZ
-1;

2231 ià(
	`cİy_äom_u£r
(&
psšfo
->
´_p§rgs
,

2232 (cÚ¡ 
__u£r
 *)
mm
->
¬g_¡¬t
, 
Ën
))

2233  -
EFAULT
;

2234 
i
 = 0; i < 
Ën
; i++)

2235 ià(
psšfo
->
´_p§rgs
[
i
] == 0)

2236 
psšfo
->
´_p§rgs
[
i
] = ' ';

2237 
psšfo
->
´_p§rgs
[
Ën
] = 0;

2239 
	`rcu_»ad_lock
();

2240 
psšfo
->
´_µid
 = 
	`sk_pid_vÄ
(
	`rcu_d”eã»nû
(
p
->
»®_·»Á
));

2241 
	`rcu_»ad_uÆock
();

2242 
psšfo
->
´_pid
 = 
	`sk_pid_vÄ
(
p
);

2243 
psšfo
->
´_pg½
 = 
	`sk_pg½_vÄ
(
p
);

2244 
psšfo
->
´_sid
 = 
	`sk_£ssiÚ_vÄ
(
p
);

2246 
i
 = 
p
->
¡©e
 ? 
	`ffz
(~p->state) + 1 : 0;

2247 
psšfo
->
´_¡©e
 = 
i
;

2248 
psšfo
->
´_¢ame
 = (
i
 > 5) ? '.' : "RSDTZW"[i];

2249 
psšfo
->
´_zomb
 =…sšfo->
´_¢ame
 == 'Z';

2250 
psšfo
->
´_niû
 = 
	`sk_niû
(
p
);

2251 
psšfo
->
´_æag
 = 
p
->
æags
;

2252 
	`rcu_»ad_lock
();

2253 
üed
 = 
	`__sk_üed
(
p
);

2254 
	`SET_UID
(
psšfo
->
´_uid
, 
üed
->
uid
);

2255 
	`SET_GID
(
psšfo
->
´_gid
, 
üed
->
gid
);

2256 
	`rcu_»ad_uÆock
();

2257 
	`¡ºıy
(
psšfo
->
´_âame
, 
p
->
comm
, (psinfo->pr_fname));

2260 
	}
}

2262 
	$fl_auxv_nÙe
(
mem–âÙe
 *
nÙe
, 
mm_¡ruù
 *
mm
)

2264 
–f_addr_t
 *
auxv
 = (–f_addr_ˆ*è
mm
->
§ved_auxv
;

2265 
i
 = 0;

2267 
i
 += 2;

2268 
auxv
[
i
 - 2] !ğ
AT_NULL
);

2269 
	`fl_nÙe
(
nÙe
, "CORE", 
NT_AUXV
, 
i
 * (
–f_addr_t
), 
auxv
);

2270 
	}
}

2272 #ifdeà
CORE_DUMP_USE_REGSET


2273 
	~<lšux/»g£t.h
>

2275 
	s–f_th»ad_cÜe_šfo
 {

2276 
–f_th»ad_cÜe_šfo
 *
	mÃxt
;

2277 
sk_¡ruù
 *
	msk
;

2278 
–f_´¡©us
 
	m´¡©us
;

2279 
mem–âÙe
 
	mnÙes
[0];

2282 
	s–f_nÙe_šfo
 {

2283 
–f_th»ad_cÜe_šfo
 *
	mth»ad
;

2284 
mem–âÙe
 
	mpsšfo
;

2285 
mem–âÙe
 
	mauxv
;

2286 
size_t
 
	msize
;

2287 
	mth»ad_nÙes
;

2295 
	$do_th»ad_»g£t_wr™eback
(
sk_¡ruù
 *
sk
,

2296 cÚ¡ 
u£r_»g£t
 *
»g£t
)

2298 ià(
»g£t
->
wr™eback
)

2299 
»g£t
->
	`wr™eback
(
sk
,„egset, 1);

2300 
	}
}

2302 
	$fl_th»ad_cÜe_šfo
(
–f_th»ad_cÜe_šfo
 *
t
,

2303 cÚ¡ 
u£r_»g£t_v›w
 *
v›w
,

2304 
sigÄ
, 
size_t
 *
tÙ®
)

2306 
i
;

2314 
	`fl_´¡©us
(&
t
->
´¡©us
,->
sk
, 
sigÄ
);

2315 (è
v›w
->
»g£ts
[0].
	`g‘
(
t
->
sk
, &view->regsets[0],

2316 0, (
t
->
´¡©us
.
´_»g
),

2317 &
t
->
´¡©us
.
´_»g
, 
NULL
);

2319 
	`fl_nÙe
(&
t
->
nÙes
[0], "CORE", 
NT_PRSTATUS
,

2320 (
t
->
´¡©us
), &t->prstatus);

2321 *
tÙ®
 +ğ
	`nÙesize
(&
t
->
nÙes
[0]);

2323 
	`do_th»ad_»g£t_wr™eback
(
t
->
sk
, &
v›w
->
»g£ts
[0]);

2330 
i
 = 1; i < 
v›w
->
n
; ++i) {

2331 cÚ¡ 
u£r_»g£t
 *
»g£t
 = &
v›w
->
»g£ts
[
i
];

2332 
	`do_th»ad_»g£t_wr™eback
(
t
->
sk
, 
»g£t
);

2333 ià(
»g£t
->
cÜe_nÙe_ty³
 &&

2334 (!
»g£t
->
aùive
 ||„eg£t->
	`aùive
(
t
->
sk
,„egset))) {

2335 
»t
;

2336 
size_t
 
size
 = 
»g£t
->
n
 *„egset->size;

2337 *
d©a
 = 
	`km®loc
(
size
, 
GFP_KERNEL
);

2338 ià(
	`uÆik–y
(!
d©a
))

2340 
»t
 = 
»g£t
->
	`g‘
(
t
->
sk
,„egset,

2341 0, 
size
, 
d©a
, 
NULL
);

2342 ià(
	`uÆik–y
(
»t
))

2343 
	`kä“
(
d©a
);

2345 ià(
»g£t
->
cÜe_nÙe_ty³
 !ğ
NT_PRFPREG
)

2346 
	`fl_nÙe
(&
t
->
nÙes
[
i
], "LINUX",

2347 
»g£t
->
cÜe_nÙe_ty³
,

2348 
size
, 
d©a
);

2350 
t
->
´¡©us
.
´_åv®id
 = 1;

2351 
	`fl_nÙe
(&
t
->
nÙes
[
i
], "CORE",

2352 
NT_PRFPREG
, 
size
, 
d©a
);

2354 *
tÙ®
 +ğ
	`nÙesize
(&
t
->
nÙes
[
i
]);

2360 
	}
}

2362 
	$fl_nÙe_šfo
(
–fhdr
 *
–f
, 
phdrs
,

2363 
–f_nÙe_šfo
 *
šfo
,

2364 
sigÄ
, 
±_»gs
 *
»gs
)

2366 
sk_¡ruù
 *
dump_sk
 = 
cu¼’t
;

2367 cÚ¡ 
u£r_»g£t_v›w
 *
v›w
 = 
	`sk_u£r_»g£t_v›w
(
dump_sk
);

2368 
–f_th»ad_cÜe_šfo
 *
t
;

2369 
–f_´psšfo
 *
psšfo
;

2370 
cÜe_th»ad
 *
ù
;

2371 
i
;

2373 
šfo
->
size
 = 0;

2374 
šfo
->
th»ad
 = 
NULL
;

2376 
psšfo
 = 
	`km®loc
((*psšfo), 
GFP_KERNEL
);

2377 ià(
psšfo
 =ğ
NULL
)

2380 
	`fl_nÙe
(&
šfo
->
psšfo
, "CORE", 
NT_PRPSINFO
, (*psinfo),…sinfo);

2385 
šfo
->
th»ad_nÙes
 = 0;

2386 
i
 = 0; i < 
v›w
->
n
; ++i)

2387 ià(
v›w
->
»g£ts
[
i
].
cÜe_nÙe_ty³
 != 0)

2388 ++
šfo
->
th»ad_nÙes
;

2394 ià(
	`uÆik–y
(
šfo
->
th»ad_nÙes
 == 0) ||

2395 
	`uÆik–y
(
v›w
->
»g£ts
[0].
cÜe_nÙe_ty³
 !ğ
NT_PRSTATUS
)) {

2396 
	`WARN_ON
(1);

2403 
	`fl_–f_h—d”
(
–f
, 
phdrs
,

2404 
v›w
->
e_machše
, v›w->
e_æags
, v›w->
ei_o§bi
);

2409 
ù
 = &
dump_sk
->
mm
->
cÜe_¡©e
->
dum³r
; ct; cˆğù->
Ãxt
) {

2410 
t
 = 
	`kz®loc
(
	`off£tof
(
–f_th»ad_cÜe_šfo
,

2411 
nÙes
[
šfo
->
th»ad_nÙes
]),

2412 
GFP_KERNEL
);

2413 ià(
	`uÆik–y
(!
t
))

2416 
t
->
sk
 = 
ù
->task;

2417 ià(
ù
->
sk
 =ğ
dump_sk
 || !
šfo
->
th»ad
) {

2418 
t
->
Ãxt
 = 
šfo
->
th»ad
;

2419 
šfo
->
th»ad
 = 
t
;

2425 
t
->
Ãxt
 = 
šfo
->
th»ad
->next;

2426 
šfo
->
th»ad
->
Ãxt
 = 
t
;

2433 
t
 = 
šfo
->
th»ad
; !ğ
NULL
; =->
Ãxt
)

2434 ià(!
	`fl_th»ad_cÜe_šfo
(
t
, 
v›w
, 
sigÄ
, &
šfo
->
size
))

2440 
	`fl_psšfo
(
psšfo
, 
dump_sk
->
group_Ëad”
, dump_sk->
mm
);

2441 
šfo
->
size
 +ğ
	`nÙesize
(&šfo->
psšfo
);

2443 
	`fl_auxv_nÙe
(&
šfo
->
auxv
, 
cu¼’t
->
mm
);

2444 
šfo
->
size
 +ğ
	`nÙesize
(&šfo->
auxv
);

2447 
	}
}

2449 
size_t
 
	$g‘_nÙe_šfo_size
(
–f_nÙe_šfo
 *
šfo
)

2451  
šfo
->
size
;

2452 
	}
}

2458 
	$wr™e_nÙe_šfo
(
–f_nÙe_šfo
 *
šfo
,

2459 
fe
 *fe, 
loff_t
 *
foff£t
)

2461 
boŞ
 
fœ¡
 = 1;

2462 
–f_th»ad_cÜe_šfo
 *
t
 = 
šfo
->
th»ad
;

2465 
i
;

2467 ià(!
	`wr™’Ùe
(&
t
->
nÙes
[0], 
fe
, 
foff£t
))

2470 ià(
fœ¡
 && !
	`wr™’Ùe
(&
šfo
->
psšfo
, 
fe
, 
foff£t
))

2472 ià(
fœ¡
 && !
	`wr™’Ùe
(&
šfo
->
auxv
, 
fe
, 
foff£t
))

2475 
i
 = 1; i < 
šfo
->
th»ad_nÙes
; ++i)

2476 ià(
t
->
nÙes
[
i
].
d©a
 &&

2477 !
	`wr™’Ùe
(&
t
->
nÙes
[
i
], 
fe
, 
foff£t
))

2480 
fœ¡
 = 0;

2481 
t
 =->
Ãxt
;

2482 } 
t
);

2485 
	}
}

2487 
	$ä“_nÙe_šfo
(
–f_nÙe_šfo
 *
šfo
)

2489 
–f_th»ad_cÜe_šfo
 *
th»ads
 = 
šfo
->
th»ad
;

2490 
th»ads
) {

2491 
i
;

2492 
–f_th»ad_cÜe_šfo
 *
t
 = 
th»ads
;

2493 
th»ads
 = 
t
->
Ãxt
;

2494 
	`WARN_ON
(
t
->
nÙes
[0].
d©a
 &&->nÙes[0].d©¨!ğ&t->
´¡©us
);

2495 
i
 = 1; i < 
šfo
->
th»ad_nÙes
; ++i)

2496 
	`kä“
(
t
->
nÙes
[
i
].
d©a
);

2497 
	`kä“
(
t
);

2499 
	`kä“
(
šfo
->
psšfo
.
d©a
);

2500 
	}
}

2505 
	s–f_th»ad_¡©us


2507 
li¡_h—d
 
	mli¡
;

2508 
–f_´¡©us
 
	m´¡©us
;

2509 
–f_å»g£t_t
 
	måu
;

2510 
sk_¡ruù
 *
	mth»ad
;

2511 #ifdeà
ELF_CORE_COPY_XFPREGS


2512 
–f_åx»g£t_t
 
	mxåu
;

2514 
mem–âÙe
 
	mnÙes
[3];

2515 
	mnum_nÙes
;

2523 
	$–f_dump_th»ad_¡©us
(
sigÄ
, 
–f_th»ad_¡©us
 *
t
)

2526 
sz
 = 0;

2527 
sk_¡ruù
 *
p
 = 
t
->
th»ad
;

2528 
t
->
num_nÙes
 = 0;

2530 
	`fl_´¡©us
(&
t
->
´¡©us
, 
p
, 
sigÄ
);

2531 
	`–f_cÜe_cİy_sk_»gs
(
p
, &
t
->
´¡©us
.
´_»g
);

2533 
	`fl_nÙe
(&
t
->
nÙes
[0], "CORE", 
NT_PRSTATUS
, Ñ->
´¡©us
),

2534 &(
t
->
´¡©us
));

2535 
t
->
num_nÙes
++;

2536 
sz
 +ğ
	`nÙesize
(&
t
->
nÙes
[0]);

2538 ià((
t
->
´¡©us
.
´_åv®id
 = 
	`–f_cÜe_cİy_sk_å»gs
(
p
, 
NULL
,

2539 &
t
->
åu
))) {

2540 
	`fl_nÙe
(&
t
->
nÙes
[1], "CORE", 
NT_PRFPREG
, Ñ->
åu
),

2541 &(
t
->
åu
));

2542 
t
->
num_nÙes
++;

2543 
sz
 +ğ
	`nÙesize
(&
t
->
nÙes
[1]);

2546 #ifdeà
ELF_CORE_COPY_XFPREGS


2547 ià(
	`–f_cÜe_cİy_sk_xå»gs
(
p
, &
t
->
xåu
)) {

2548 
	`fl_nÙe
(&
t
->
nÙes
[2], "LINUX", 
ELF_CORE_XFPREG_TYPE
,

2549 (
t
->
xåu
), &t->xfpu);

2550 
t
->
num_nÙes
++;

2551 
sz
 +ğ
	`nÙesize
(&
t
->
nÙes
[2]);

2554  
sz
;

2555 
	}
}

2557 
	s–f_nÙe_šfo
 {

2558 
mem–âÙe
 *
	mnÙes
;

2559 
–f_´¡©us
 *
	m´¡©us
;

2560 
–f_´psšfo
 *
	mpsšfo
;

2561 
li¡_h—d
 
	mth»ad_li¡
;

2562 
–f_å»g£t_t
 *
	måu
;

2563 #ifdeà
ELF_CORE_COPY_XFPREGS


2564 
–f_åx»g£t_t
 *
	mxåu
;

2566 
	mth»ad_¡©us_size
;

2567 
	mnumnÙe
;

2570 
	$–f_nÙe_šfo_š™
(
–f_nÙe_šfo
 *
šfo
)

2572 
	`mem£t
(
šfo
, 0, (*info));

2573 
	`INIT_LIST_HEAD
(&
šfo
->
th»ad_li¡
);

2576 
šfo
->
nÙes
 = 
	`km®loc
(6 * (
mem–âÙe
), 
GFP_KERNEL
);

2577 ià(!
šfo
->
nÙes
)

2579 
šfo
->
psšfo
 = 
	`km®loc
((*šfo->psšfo), 
GFP_KERNEL
);

2580 ià(!
šfo
->
psšfo
)

2581 
nÙes_ä“
;

2582 
šfo
->
´¡©us
 = 
	`km®loc
((*šfo->´¡©us), 
GFP_KERNEL
);

2583 ià(!
šfo
->
´¡©us
)

2584 
psšfo_ä“
;

2585 
šfo
->
åu
 = 
	`km®loc
((*šfo->åu), 
GFP_KERNEL
);

2586 ià(!
šfo
->
åu
)

2587 
´¡©us_ä“
;

2588 #ifdeà
ELF_CORE_COPY_XFPREGS


2589 
šfo
->
xåu
 = 
	`km®loc
((*šfo->xåu), 
GFP_KERNEL
);

2590 ià(!
šfo
->
xåu
)

2591 
åu_ä“
;

2594 #ifdeà
ELF_CORE_COPY_XFPREGS


2595 
åu_ä“
:

2596 
	`kä“
(
šfo
->
åu
);

2598 
´¡©us_ä“
:

2599 
	`kä“
(
šfo
->
´¡©us
);

2600 
psšfo_ä“
:

2601 
	`kä“
(
šfo
->
psšfo
);

2602 
nÙes_ä“
:

2603 
	`kä“
(
šfo
->
nÙes
);

2605 
	}
}

2607 
	$fl_nÙe_šfo
(
–fhdr
 *
–f
, 
phdrs
,

2608 
–f_nÙe_šfo
 *
šfo
,

2609 
sigÄ
, 
±_»gs
 *
»gs
)

2612 
li¡_h—d
 *
t
;

2614 ià(!
	`–f_nÙe_šfo_š™
(
šfo
))

2617 ià(
sigÄ
) {

2618 
cÜe_th»ad
 *
ù
;

2619 
–f_th»ad_¡©us
 *
‘s
;

2621 
ù
 = 
cu¼’t
->
mm
->
cÜe_¡©e
->
dum³r
.
Ãxt
;

2622 
ù
; cˆğù->
Ãxt
) {

2623 
‘s
 = 
	`kz®loc
((*‘s), 
GFP_KERNEL
);

2624 ià(!
‘s
)

2627 
‘s
->
th»ad
 = 
ù
->
sk
;

2628 
	`li¡_add
(&
‘s
->
li¡
, &
šfo
->
th»ad_li¡
);

2631 
	`li¡_fÜ_—ch
(
t
, &
šfo
->
th»ad_li¡
) {

2632 
sz
;

2634 
‘s
 = 
	`li¡_’Œy
(
t
, 
–f_th»ad_¡©us
, 
li¡
);

2635 
sz
 = 
	`–f_dump_th»ad_¡©us
(
sigÄ
, 
‘s
);

2636 
šfo
->
th»ad_¡©us_size
 +ğ
sz
;

2640 
	`mem£t
(
šfo
->
´¡©us
, 0, (*info->prstatus));

2641 
	`fl_´¡©us
(
šfo
->
´¡©us
, 
cu¼’t
, 
sigÄ
);

2642 
	`–f_cÜe_cİy_»gs
(&
šfo
->
´¡©us
->
´_»g
, 
»gs
);

2645 
	`fl_–f_h—d”
(
–f
, 
phdrs
, 
ELF_ARCH
, 
ELF_CORE_EFLAGS
, 
ELF_OSABI
);

2652 
	`fl_nÙe
(
šfo
->
nÙes
 + 0, "CORE", 
NT_PRSTATUS
,

2653 (*
šfo
->
´¡©us
), info->prstatus);

2654 
	`fl_psšfo
(
šfo
->
psšfo
, 
cu¼’t
->
group_Ëad”
, cu¼’t->
mm
);

2655 
	`fl_nÙe
(
šfo
->
nÙes
 + 1, "CORE", 
NT_PRPSINFO
,

2656 (*
šfo
->
psšfo
), info->psinfo);

2658 
šfo
->
numnÙe
 = 2;

2660 
	`fl_auxv_nÙe
(&
šfo
->
nÙes
[šfo->
numnÙe
++], 
cu¼’t
->
mm
);

2663 
šfo
->
´¡©us
->
´_åv®id
 = 
	`–f_cÜe_cİy_sk_å»gs
(
cu¼’t
, 
»gs
,

2664 
šfo
->
åu
);

2665 ià(
šfo
->
´¡©us
->
´_åv®id
)

2666 
	`fl_nÙe
(
šfo
->
nÙes
 + info->
numnÙe
++,

2667 "CORE", 
NT_PRFPREG
, (*
šfo
->
åu
), info->fpu);

2668 #ifdeà
ELF_CORE_COPY_XFPREGS


2669 ià(
	`–f_cÜe_cİy_sk_xå»gs
(
cu¼’t
, 
šfo
->
xåu
))

2670 
	`fl_nÙe
(
šfo
->
nÙes
 + info->
numnÙe
++,

2671 "LINUX", 
ELF_CORE_XFPREG_TYPE
,

2672 (*
šfo
->
xåu
), info->xfpu);

2676 
	}
}

2678 
size_t
 
	$g‘_nÙe_šfo_size
(
–f_nÙe_šfo
 *
šfo
)

2680 
sz
 = 0;

2681 
i
;

2683 
i
 = 0; i < 
šfo
->
numnÙe
; i++)

2684 
sz
 +ğ
	`nÙesize
(
šfo
->
nÙes
 + 
i
);

2686 
sz
 +ğ
šfo
->
th»ad_¡©us_size
;

2688  
sz
;

2689 
	}
}

2691 
	$wr™e_nÙe_šfo
(
–f_nÙe_šfo
 *
šfo
,

2692 
fe
 *fe, 
loff_t
 *
foff£t
)

2694 
i
;

2695 
li¡_h—d
 *
t
;

2697 
i
 = 0; i < 
šfo
->
numnÙe
; i++)

2698 ià(!
	`wr™’Ùe
(
šfo
->
nÙes
 + 
i
, 
fe
, 
foff£t
))

2702 
	`li¡_fÜ_—ch
(
t
, &
šfo
->
th»ad_li¡
) {

2703 
–f_th»ad_¡©us
 *
tmp
 =

2704 
	`li¡_’Œy
(
t
, 
–f_th»ad_¡©us
, 
li¡
);

2706 
i
 = 0; i < 
tmp
->
num_nÙes
; i++)

2707 ià(!
	`wr™’Ùe
(&
tmp
->
nÙes
[
i
], 
fe
, 
foff£t
))

2712 
	}
}

2714 
	$ä“_nÙe_šfo
(
–f_nÙe_šfo
 *
šfo
)

2716 !
	`li¡_em±y
(&
šfo
->
th»ad_li¡
)) {

2717 
li¡_h—d
 *
tmp
 = 
šfo
->
th»ad_li¡
.
Ãxt
;

2718 
	`li¡_d–
(
tmp
);

2719 
	`kä“
(
	`li¡_’Œy
(
tmp
, 
–f_th»ad_¡©us
, 
li¡
));

2722 
	`kä“
(
šfo
->
´¡©us
);

2723 
	`kä“
(
šfo
->
psšfo
);

2724 
	`kä“
(
šfo
->
nÙes
);

2725 
	`kä“
(
šfo
->
åu
);

2726 #ifdeà
ELF_CORE_COPY_XFPREGS


2727 
	`kä“
(
šfo
->
xåu
);

2729 
	}
}

2733 
vm_¬—_¡ruù
 *
	$fœ¡_vma
(
sk_¡ruù
 *
tsk
,

2734 
vm_¬—_¡ruù
 *
g©e_vma
)

2736 
vm_¬—_¡ruù
 *
»t
 = 
tsk
->
mm
->
mm­
;

2738 ià(
»t
)

2739  
»t
;

2740  
g©e_vma
;

2741 
	}
}

2746 
vm_¬—_¡ruù
 *
	$Ãxt_vma
(
vm_¬—_¡ruù
 *
this_vma
,

2747 
vm_¬—_¡ruù
 *
g©e_vma
)

2749 
vm_¬—_¡ruù
 *
»t
;

2751 
»t
 = 
this_vma
->
vm_Ãxt
;

2752 ià(
»t
)

2753  
»t
;

2754 ià(
this_vma
 =ğ
g©e_vma
)

2755  
NULL
;

2756  
g©e_vma
;

2757 
	}
}

2759 
	$fl_exŠum_šfo
(
–fhdr
 *
–f
, 
–f_shdr
 *
shdr4exŠum
,

2760 
–f_addr_t
 
e_shoff
, 
£gs
)

2762 
–f
->
e_shoff
 =ƒ_shoff;

2763 
–f
->
e_sh’tsize
 = (*
shdr4exŠum
);

2764 
–f
->
e_shnum
 = 1;

2765 
–f
->
e_sh¡ºdx
 = 
SHN_UNDEF
;

2767 
	`mem£t
(
shdr4exŠum
, 0, (*shdr4extnum));

2769 
shdr4exŠum
->
sh_ty³
 = 
SHT_NULL
;

2770 
shdr4exŠum
->
sh_size
 = 
–f
->
e_shnum
;

2771 
shdr4exŠum
->
sh_lšk
 = 
–f
->
e_sh¡ºdx
;

2772 
shdr4exŠum
->
sh_šfo
 = 
£gs
;

2773 
	}
}

2775 
size_t
 
	$–f_cÜe_vma_d©a_size
(
vm_¬—_¡ruù
 *
g©e_vma
,

2776 
mm_æags
)

2778 
vm_¬—_¡ruù
 *
vma
;

2779 
size_t
 
size
 = 0;

2781 
vma
 = 
	`fœ¡_vma
(
cu¼’t
, 
g©e_vma
); vm¨!ğ
NULL
;

2782 
vma
 = 
	`Ãxt_vma
(vma, 
g©e_vma
))

2783 
size
 +ğ
	`vma_dump_size
(
vma
, 
mm_æags
);

2784  
size
;

2785 
	}
}

2794 
	$–f_cÜe_dump
(
cÜedump_·¿ms
 *
ırm
)

2797 
has_dum³d
 = 0;

2798 
mm_£gm’t_t
 
fs
;

2799 
£gs
;

2800 
size_t
 
size
 = 0;

2801 
vm_¬—_¡ruù
 *
vma
, *
g©e_vma
;

2802 
–fhdr
 *
–f
 = 
NULL
;

2803 
loff_t
 
off£t
 = 0, 
d©aoff
, 
foff£t
;

2804 
–f_nÙe_šfo
 
šfo
;

2805 
–f_phdr
 *
phdr4nÙe
 = 
NULL
;

2806 
–f_shdr
 *
shdr4exŠum
 = 
NULL
;

2807 
Elf_H®f
 
e_phnum
;

2808 
–f_addr_t
 
e_shoff
;

2823 
–f
 = 
	`km®loc
((*–f), 
GFP_KERNEL
);

2824 ià(!
–f
)

2825 
out
;

2830 
£gs
 = 
cu¼’t
->
mm
->
m­_couÁ
;

2831 
£gs
 +ğ
	`–f_cÜe_exŒa_phdrs
();

2833 
g©e_vma
 = 
	`g‘_g©e_vma
(
cu¼’t
->
mm
);

2834 ià(
g©e_vma
 !ğ
NULL
)

2835 
£gs
++;

2838 
£gs
++;

2843 
e_phnum
 = 
£gs
 > 
PN_XNUM
 ? PN_XNUM : segs;

2849 ià(!
	`fl_nÙe_šfo
(
–f
, 
e_phnum
, &
šfo
, 
ırm
->
sigÄ
, c´m->
»gs
))

2850 
ş—nup
;

2852 
has_dum³d
 = 1;

2853 
cu¼’t
->
æags
 |ğ
PF_DUMPCORE
;

2855 
fs
 = 
	`g‘_fs
();

2856 
	`£t_fs
(
KERNEL_DS
);

2858 
off£t
 +ğ(*
–f
);

2859 
off£t
 +ğ
£gs
 * (
–f_phdr
);

2860 
foff£t
 = 
off£t
;

2864 
size_t
 
sz
 = 
	`g‘_nÙe_šfo_size
(&
šfo
);

2866 
sz
 +ğ
	`–f_cÜedump_exŒa_nÙes_size
();

2868 
phdr4nÙe
 = 
	`km®loc
((*phdr4nÙe), 
GFP_KERNEL
);

2869 ià(!
phdr4nÙe
)

2870 
’d_cÜedump
;

2872 
	`fl_–f_nÙe_phdr
(
phdr4nÙe
, 
sz
, 
off£t
);

2873 
off£t
 +ğ
sz
;

2876 
d©aoff
 = 
off£t
 = 
	`roundup
(off£t, 
ELF_EXEC_PAGESIZE
);

2878 
off£t
 +ğ
	`–f_cÜe_vma_d©a_size
(
g©e_vma
, 
ırm
->
mm_æags
);

2879 
off£t
 +ğ
	`–f_cÜe_exŒa_d©a_size
();

2880 
e_shoff
 = 
off£t
;

2882 ià(
e_phnum
 =ğ
PN_XNUM
) {

2883 
shdr4exŠum
 = 
	`km®loc
((*shdr4exŠum), 
GFP_KERNEL
);

2884 ià(!
shdr4exŠum
)

2885 
’d_cÜedump
;

2886 
	`fl_exŠum_šfo
(
–f
, 
shdr4exŠum
, 
e_shoff
, 
£gs
);

2889 
off£t
 = 
d©aoff
;

2891 
size
 +ğ(*
–f
);

2892 ià(
size
 > 
ırm
->
lim™
 || !
	`dump_wr™e
(ırm->
fe
, 
–f
, (*elf)))

2893 
’d_cÜedump
;

2895 
size
 +ğ(*
phdr4nÙe
);

2896 ià(
size
 > 
ırm
->
lim™


2897 || !
	`dump_wr™e
(
ırm
->
fe
, 
phdr4nÙe
, (*phdr4note)))

2898 
’d_cÜedump
;

2901 
vma
 = 
	`fœ¡_vma
(
cu¼’t
, 
g©e_vma
); vm¨!ğ
NULL
;

2902 
vma
 = 
	`Ãxt_vma
(vma, 
g©e_vma
)) {

2903 
–f_phdr
 
phdr
;

2905 
phdr
.
p_ty³
 = 
PT_LOAD
;

2906 
phdr
.
p_off£t
 = 
off£t
;

2907 
phdr
.
p_vaddr
 = 
vma
->
vm_¡¬t
;

2908 
phdr
.
p_·ddr
 = 0;

2909 
phdr
.
p_fesz
 = 
	`vma_dump_size
(
vma
, 
ırm
->
mm_æags
);

2910 
phdr
.
p_memsz
 = 
vma
->
vm_’d
 - vma->
vm_¡¬t
;

2911 
off£t
 +ğ
phdr
.
p_fesz
;

2912 
phdr
.
p_æags
 = 
vma
->
vm_æags
 & 
VM_READ
 ? 
PF_R
 : 0;

2913 ià(
vma
->
vm_æags
 & 
VM_WRITE
)

2914 
phdr
.
p_æags
 |ğ
PF_W
;

2915 ià(
vma
->
vm_æags
 & 
VM_EXEC
)

2916 
phdr
.
p_æags
 |ğ
PF_X
;

2917 
phdr
.
p_®ign
 = 
ELF_EXEC_PAGESIZE
;

2919 
size
 +ğ(
phdr
);

2920 ià(
size
 > 
ırm
->
lim™


2921 || !
	`dump_wr™e
(
ırm
->
fe
, &
phdr
, (phdr)))

2922 
’d_cÜedump
;

2925 ià(!
	`–f_cÜe_wr™e_exŒa_phdrs
(
ırm
->
fe
, 
off£t
, &
size
, c´m->
lim™
))

2926 
’d_cÜedump
;

2929 ià(!
	`wr™e_nÙe_šfo
(&
šfo
, 
ırm
->
fe
, &
foff£t
))

2930 
’d_cÜedump
;

2932 ià(
	`–f_cÜedump_exŒa_nÙes_wr™e
(
ırm
->
fe
, &
foff£t
))

2933 
’d_cÜedump
;

2936 ià(!
	`dump_£ek
(
ırm
->
fe
, 
d©aoff
 - 
foff£t
))

2937 
’d_cÜedump
;

2939 
vma
 = 
	`fœ¡_vma
(
cu¼’t
, 
g©e_vma
); vm¨!ğ
NULL
;

2940 
vma
 = 
	`Ãxt_vma
(vma, 
g©e_vma
)) {

2941 
addr
;

2942 
’d
;

2944 
’d
 = 
vma
->
vm_¡¬t
 + 
	`vma_dump_size
(vma, 
ırm
->
mm_æags
);

2946 
addr
 = 
vma
->
vm_¡¬t
;‡dd¸< 
’d
;‡dd¸+ğ
PAGE_SIZE
) {

2947 
·ge
 *page;

2948 
¡İ
;

2950 
·ge
 = 
	`g‘_dump_·ge
(
addr
);

2951 ià(
·ge
) {

2952 *
kaddr
 = 
	`km­
(
·ge
);

2953 
¡İ
 = ((
size
 +ğ
PAGE_SIZE
è> 
ırm
->
lim™
) ||

2954 !
	`dump_wr™e
(
ırm
->
fe
, 
kaddr
,

2955 
PAGE_SIZE
);

2956 
	`kunm­
(
·ge
);

2957 
	`·ge_ÿche_»Ëa£
(
·ge
);

2959 
¡İ
 = !
	`dump_£ek
(
ırm
->
fe
, 
PAGE_SIZE
);

2960 ià(
¡İ
)

2961 
’d_cÜedump
;

2965 ià(!
	`–f_cÜe_wr™e_exŒa_d©a
(
ırm
->
fe
, &
size
, c´m->
lim™
))

2966 
’d_cÜedump
;

2968 ià(
e_phnum
 =ğ
PN_XNUM
) {

2969 
size
 +ğ(*
shdr4exŠum
);

2970 ià(
size
 > 
ırm
->
lim™


2971 || !
	`dump_wr™e
(
ırm
->
fe
, 
shdr4exŠum
,

2972 (*
shdr4exŠum
)))

2973 
’d_cÜedump
;

2976 
’d_cÜedump
:

2977 
	`£t_fs
(
fs
);

2979 
ş—nup
:

2980 
	`ä“_nÙe_šfo
(&
šfo
);

2981 
	`kä“
(
shdr4exŠum
);

2982 
	`kä“
(
phdr4nÙe
);

2983 
	`kä“
(
–f
);

2984 
out
:

2985  
has_dum³d
;

2986 
	}
}

2990 
__š™
 
	$š™_–f_bšfmt
()

2992  
	`»gi¡”_bšfmt
(&
–f_fÜm©
);

2993 
	}
}

2995 
__ex™
 
	$ex™_–f_bšfmt
()

2998 
	`uÄegi¡”_bšfmt
(&
–f_fÜm©
);

2999 
	}
}

3001 
cÜe_š™ÿÎ
(
š™_–f_bšfmt
);

3002 
moduË_ex™
(
ex™_–f_bšfmt
);

3003 
MODULE_LICENSE
("GPL");

	@binfmt_elf_fdpic.c

13 
	~<lšux/moduË.h
>

15 
	~<lšux/fs.h
>

16 
	~<lšux/¡©.h
>

17 
	~<lšux/sched.h
>

18 
	~<lšux/mm.h
>

19 
	~<lšux/mmª.h
>

20 
	~<lšux/”ºo.h
>

21 
	~<lšux/sigÇl.h
>

22 
	~<lšux/bšfmts.h
>

23 
	~<lšux/¡ršg.h
>

24 
	~<lšux/fe.h
>

25 
	~<lšux/fú.h
>

26 
	~<lšux/¦ab.h
>

27 
	~<lšux/·gem­.h
>

28 
	~<lšux/£cur™y.h
>

29 
	~<lšux/highmem.h
>

30 
	~<lšux/highuid.h
>

31 
	~<lšux/³rsÚ®™y.h
>

32 
	~<lšux/±¿û.h
>

33 
	~<lšux/š™.h
>

34 
	~<lšux/–f.h
>

35 
	~<lšux/–f-fdpic.h
>

36 
	~<lšux/–fcÜe.h
>

37 
	~<lšux/cÜedump.h
>

39 
	~<asm/uacûss.h
>

40 
	~<asm/·¿m.h
>

41 
	~<asm/pg®loc.h
>

43 *
	t–f_ÿddr_t
;

46 
	#kdebug
(
fmt
, ...è
	`´štk
("FDPIC "fmt"\n" ,##
__VA_ARGS__
 )

	)

48 
	#kdebug
(
fmt
, ...èdØ{} 0)

	)

52 
	#kdcÜe
(
fmt
, ...è
	`´štk
("FDPIC "fmt"\n" ,##
__VA_ARGS__
 )

	)

54 
	#kdcÜe
(
fmt
, ...èdØ{} 0)

	)

57 
MODULE_LICENSE
("GPL");

59 
lßd_–f_fdpic_bš¬y
(
lšux_bš´m
 *, 
±_»gs
 *);

60 
–f_fdpic_ãtch_phdrs
(
–f_fdpic_·¿ms
 *, 
fe
 *);

61 
–f_fdpic_m­_fe
(
–f_fdpic_·¿ms
 *, 
fe
 *,

62 
mm_¡ruù
 *, const *);

64 
ü—‹_–f_fdpic_bËs
(
lšux_bš´m
 *, 
mm_¡ruù
 *,

65 
–f_fdpic_·¿ms
 *,

66 
–f_fdpic_·¿ms
 *);

68 #iâdeà
CONFIG_MMU


69 
–f_fdpic_Œªsãr_¬gs_to_¡ack
(
lšux_bš´m
 *,

71 
–f_fdpic_m­_fe_cÚ¡di¥_Ú_uşšux
(
–f_fdpic_·¿ms
 *,

72 
fe
 *,

73 
mm_¡ruù
 *);

76 
–f_fdpic_m­_fe_by_dœeù_mm­
(
–f_fdpic_·¿ms
 *,

77 
fe
 *, 
mm_¡ruù
 *);

79 #ifdeà
CONFIG_ELF_CORE


80 
–f_fdpic_cÜe_dump
(
cÜedump_·¿ms
 *
ırm
);

83 
lšux_bšfmt
 
	g–f_fdpic_fÜm©
 = {

84 .
moduË
 = 
THIS_MODULE
,

85 .
	glßd_bš¬y
 = 
lßd_–f_fdpic_bš¬y
,

86 #ifdeà
CONFIG_ELF_CORE


87 .
	gcÜe_dump
 = 
–f_fdpic_cÜe_dump
,

89 .
	gmš_cÜedump
 = 
ELF_EXEC_PAGESIZE
,

92 
__š™
 
	$š™_–f_fdpic_bšfmt
()

94  
	`»gi¡”_bšfmt
(&
–f_fdpic_fÜm©
);

95 
	}
}

97 
__ex™
 
	$ex™_–f_fdpic_bšfmt
()

99 
	`uÄegi¡”_bšfmt
(&
–f_fdpic_fÜm©
);

100 
	}
}

102 
cÜe_š™ÿÎ
(
š™_–f_fdpic_bšfmt
);

103 
moduË_ex™
(
ex™_–f_fdpic_bšfmt
);

105 
	$is_–f_fdpic
(
–fhdr
 *
hdr
, 
fe
 *file)

107 ià(
	`memcmp
(
hdr
->
e_id’t
, 
ELFMAG
, 
SELFMAG
) != 0)

109 ià(
hdr
->
e_ty³
 !ğ
ET_EXEC
 && hdr->e_ty³ !ğ
ET_DYN
)

111 ià(!
	`–f_check_¬ch
(
hdr
è|| !
	`–f_check_fdpic
(hdr))

113 ià(!
fe
->
f_İ
 || !fe->f_İ->
mm­
)

116 
	}
}

122 
	$–f_fdpic_ãtch_phdrs
(
–f_fdpic_·¿ms
 *
·¿ms
,

123 
fe
 *file)

125 
–f32_phdr
 *
phdr
;

126 
size
;

127 
»tv®
, 
loİ
;

129 ià(
·¿ms
->
hdr
.
e_ph’tsize
 !ğ(
–f_phdr
))

130  -
ENOMEM
;

131 ià(
·¿ms
->
hdr
.
e_phnum
 > 65536U / (
–f_phdr
))

132  -
ENOMEM
;

134 
size
 = 
·¿ms
->
hdr
.
e_phnum
 * (
–f_phdr
);

135 
·¿ms
->
phdrs
 = 
	`km®loc
(
size
, 
GFP_KERNEL
);

136 ià(!
·¿ms
->
phdrs
)

137  -
ENOMEM
;

139 
»tv®
 = 
	`k”Ãl_»ad
(
fe
, 
·¿ms
->
hdr
.
e_phoff
,

140 (*è
·¿ms
->
phdrs
, 
size
);

141 ià(
	`uÆik–y
(
»tv®
 !ğ
size
))

142  
»tv®
 < 0 ?„‘v® : -
ENOEXEC
;

145 
phdr
 = 
·¿ms
->
phdrs
;

146 
loİ
 = 0;†oİ < 
·¿ms
->
hdr
.
e_phnum
;†oİ++, 
phdr
++) {

147 ià(
phdr
->
p_ty³
 !ğ
PT_GNU_STACK
)

150 ià(
phdr
->
p_æags
 & 
PF_X
)

151 
·¿ms
->
æags
 |ğ
ELF_FDPIC_FLAG_EXEC_STACK
;

153 
·¿ms
->
æags
 |ğ
ELF_FDPIC_FLAG_NOEXEC_STACK
;

155 
·¿ms
->
¡ack_size
 = 
phdr
->
p_memsz
;

160 
	}
}

166 
	$lßd_–f_fdpic_bš¬y
(
lšux_bš´m
 *
b´m
,

167 
±_»gs
 *
»gs
)

169 
–f_fdpic_·¿ms
 
exec_·¿ms
, 
š‹½_·¿ms
;

170 
–f_phdr
 *
phdr
;

171 
¡ack_size
, 
’Œyaddr
;

172 #ifdeà
ELF_FDPIC_PLAT_INIT


173 
dyÇddr
;

175 #iâdeà
CONFIG_MMU


176 
¡ack_´Ù
;

178 
fe
 *
š‹½»‹r
 = 
NULL
;

179 *
š‹½»‹r_Çme
 = 
NULL
;

180 
execubË_¡ack
;

181 
»tv®
, 
i
;

183 
	`kdebug
("____ LOAD %d ____", 
cu¼’t
->
pid
);

185 
	`mem£t
(&
exec_·¿ms
, 0, (exec_params));

186 
	`mem£t
(&
š‹½_·¿ms
, 0, (interp_params));

188 
exec_·¿ms
.
hdr
 = *(
–fhdr
 *è
b´m
->
buf
;

189 
exec_·¿ms
.
æags
 = 
ELF_FDPIC_FLAG_PRESENT
 | 
ELF_FDPIC_FLAG_EXECUTABLE
;

192 
»tv®
 = -
ENOEXEC
;

193 ià(!
	`is_–f_fdpic
(&
exec_·¿ms
.
hdr
, 
b´m
->
fe
))

194 
”rÜ
;

197 
»tv®
 = 
	`–f_fdpic_ãtch_phdrs
(&
exec_·¿ms
, 
b´m
->
fe
);

198 ià(
»tv®
 < 0)

199 
”rÜ
;

202 
phdr
 = 
exec_·¿ms
.
phdrs
;

204 
i
 = 0; i < 
exec_·¿ms
.
hdr
.
e_phnum
; i++, 
phdr
++) {

205 
phdr
->
p_ty³
) {

206 
PT_INTERP
:

207 
»tv®
 = -
ENOMEM
;

208 ià(
phdr
->
p_fesz
 > 
PATH_MAX
)

209 
”rÜ
;

210 
»tv®
 = -
ENOENT
;

211 ià(
phdr
->
p_fesz
 < 2)

212 
”rÜ
;

215 
š‹½»‹r_Çme
 = 
	`km®loc
(
phdr
->
p_fesz
, 
GFP_KERNEL
);

216 ià(!
š‹½»‹r_Çme
)

217 
”rÜ
;

219 
»tv®
 = 
	`k”Ãl_»ad
(
b´m
->
fe
,

220 
phdr
->
p_off£t
,

221 
š‹½»‹r_Çme
,

222 
phdr
->
p_fesz
);

223 ià(
	`uÆik–y
(
»tv®
 !ğ
phdr
->
p_fesz
)) {

224 ià(
»tv®
 >= 0)

225 
»tv®
 = -
ENOEXEC
;

226 
”rÜ
;

229 
»tv®
 = -
ENOENT
;

230 ià(
š‹½»‹r_Çme
[
phdr
->
p_fesz
 - 1] != '\0')

231 
”rÜ
;

233 
	`kdebug
("Usšg ELF iÁ”´‘” %s", 
š‹½»‹r_Çme
);

236 
š‹½»‹r
 = 
	`İ’_exec
(
š‹½»‹r_Çme
);

237 
»tv®
 = 
	`PTR_ERR
(
š‹½»‹r
);

238 ià(
	`IS_ERR
(
š‹½»‹r
)) {

239 
š‹½»‹r
 = 
NULL
;

240 
”rÜ
;

248 
	`would_dump
(
b´m
, 
š‹½»‹r
);

250 
»tv®
 = 
	`k”Ãl_»ad
(
š‹½»‹r
, 0, 
b´m
->
buf
,

251 
BINPRM_BUF_SIZE
);

252 ià(
	`uÆik–y
(
»tv®
 !ğ
BINPRM_BUF_SIZE
)) {

253 ià(
»tv®
 >= 0)

254 
»tv®
 = -
ENOEXEC
;

255 
”rÜ
;

258 
š‹½_·¿ms
.
hdr
 = *((
–fhdr
 *è
b´m
->
buf
);

261 
PT_LOAD
:

262 #ifdeà
CONFIG_MMU


263 ià(
exec_·¿ms
.
lßd_addr
 == 0)

264 
exec_·¿ms
.
lßd_addr
 = 
phdr
->
p_vaddr
;

271 ià(
	`–f_check_cÚ¡_di¥Ïûm’t
(&
exec_·¿ms
.
hdr
))

272 
exec_·¿ms
.
æags
 |ğ
ELF_FDPIC_FLAG_CONSTDISP
;

275 ià(
š‹½»‹r_Çme
) {

276 
»tv®
 = -
ELIBBAD
;

277 ià(!
	`is_–f_fdpic
(&
š‹½_·¿ms
.
hdr
, 
š‹½»‹r
))

278 
”rÜ
;

280 
š‹½_·¿ms
.
æags
 = 
ELF_FDPIC_FLAG_PRESENT
;

283 
»tv®
 = 
	`–f_fdpic_ãtch_phdrs
(&
š‹½_·¿ms
, 
š‹½»‹r
);

284 ià(
»tv®
 < 0)

285 
”rÜ
;

288 
¡ack_size
 = 
exec_·¿ms
.stack_size;

289 ià(
exec_·¿ms
.
æags
 & 
ELF_FDPIC_FLAG_EXEC_STACK
)

290 
execubË_¡ack
 = 
EXSTACK_ENABLE_X
;

291 ià(
exec_·¿ms
.
æags
 & 
ELF_FDPIC_FLAG_NOEXEC_STACK
)

292 
execubË_¡ack
 = 
EXSTACK_DISABLE_X
;

294 
execubË_¡ack
 = 
EXSTACK_DEFAULT
;

296 ià(
¡ack_size
 == 0) {

297 
¡ack_size
 = 
š‹½_·¿ms
.stack_size;

298 ià(
š‹½_·¿ms
.
æags
 & 
ELF_FDPIC_FLAG_EXEC_STACK
)

299 
execubË_¡ack
 = 
EXSTACK_ENABLE_X
;

300 ià(
š‹½_·¿ms
.
æags
 & 
ELF_FDPIC_FLAG_NOEXEC_STACK
)

301 
execubË_¡ack
 = 
EXSTACK_DISABLE_X
;

303 
execubË_¡ack
 = 
EXSTACK_DEFAULT
;

306 
»tv®
 = -
ENOEXEC
;

307 ià(
¡ack_size
 == 0)

308 
”rÜ
;

310 ià(
	`–f_check_cÚ¡_di¥Ïûm’t
(&
š‹½_·¿ms
.
hdr
))

311 
š‹½_·¿ms
.
æags
 |ğ
ELF_FDPIC_FLAG_CONSTDISP
;

314 
»tv®
 = 
	`æush_Şd_exec
(
b´m
);

315 ià(
»tv®
)

316 
”rÜ
;

321 
	`£t_³rsÚ®™y
(
PER_LINUX_FDPIC
);

322 ià(
	`–f_»ad_im¶›s_exec
(&
exec_·¿ms
.
hdr
, 
execubË_¡ack
))

323 
cu¼’t
->
³rsÚ®™y
 |ğ
READ_IMPLIES_EXEC
;

325 
	`£tup_Ãw_exec
(
b´m
);

327 
	`£t_bšfmt
(&
–f_fdpic_fÜm©
);

329 
cu¼’t
->
mm
->
¡¬t_code
 = 0;

330 
cu¼’t
->
mm
->
’d_code
 = 0;

331 
cu¼’t
->
mm
->
¡¬t_¡ack
 = 0;

332 
cu¼’t
->
mm
->
¡¬t_d©a
 = 0;

333 
cu¼’t
->
mm
->
’d_d©a
 = 0;

334 
cu¼’t
->
mm
->
cÚ‹xt
.
exec_fdpic_lßdm­
 = 0;

335 
cu¼’t
->
mm
->
cÚ‹xt
.
š‹½_fdpic_lßdm­
 = 0;

337 
cu¼’t
->
æags
 &ğ~
PF_FORKNOEXEC
;

339 #ifdeà
CONFIG_MMU


340 
	`–f_fdpic_¬ch_Ïy_out_mm
(&
exec_·¿ms
,

341 &
š‹½_·¿ms
,

342 &
cu¼’t
->
mm
->
¡¬t_¡ack
,

343 &
cu¼’t
->
mm
->
¡¬t_brk
);

345 
»tv®
 = 
	`£tup_¬g_·ges
(
b´m
, 
cu¼’t
->
mm
->
¡¬t_¡ack
,

346 
execubË_¡ack
);

347 ià(
»tv®
 < 0) {

348 
	`£nd_sig
(
SIGKILL
, 
cu¼’t
, 0);

349 
”rÜ_kl
;

354 
»tv®
 = 
	`–f_fdpic_m­_fe
(&
exec_·¿ms
, 
b´m
->
fe
, 
cu¼’t
->
mm
,

356 ià(
»tv®
 < 0)

357 
”rÜ_kl
;

359 ià(
š‹½»‹r_Çme
) {

360 
»tv®
 = 
	`–f_fdpic_m­_fe
(&
š‹½_·¿ms
, 
š‹½»‹r
,

361 
cu¼’t
->
mm
, "interpreter");

362 ià(
»tv®
 < 0) {

363 
	`´štk
(
KERN_ERR
 "Unableo†oad interpreter\n");

364 
”rÜ_kl
;

367 
	`®low_wr™e_acûss
(
š‹½»‹r
);

368 
	`åut
(
š‹½»‹r
);

369 
š‹½»‹r
 = 
NULL
;

372 #ifdeà
CONFIG_MMU


373 ià(!
cu¼’t
->
mm
->
¡¬t_brk
)

374 
cu¼’t
->
mm
->
¡¬t_brk
 = cu¼’t->mm->
’d_d©a
;

376 
cu¼’t
->
mm
->
brk
 = cu¼’t->mm->
¡¬t_brk
 =

377 
	`PAGE_ALIGN
(
cu¼’t
->
mm
->
¡¬t_brk
);

384 
¡ack_size
 = (¡ack_siz+ 
PAGE_SIZE
 - 1è& 
PAGE_MASK
;

385 ià(
¡ack_size
 < 
PAGE_SIZE
 * 2)

386 
¡ack_size
 = 
PAGE_SIZE
 * 2;

388 
¡ack_´Ù
 = 
PROT_READ
 | 
PROT_WRITE
;

389 ià(
execubË_¡ack
 =ğ
EXSTACK_ENABLE_X
 ||

390 (
execubË_¡ack
 =ğ
EXSTACK_DEFAULT
 && 
VM_STACK_FLAGS
 & 
VM_EXEC
))

391 
¡ack_´Ù
 |ğ
PROT_EXEC
;

393 
	`down_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

394 
cu¼’t
->
mm
->
¡¬t_brk
 = 
	`do_mm­
(
NULL
, 0, 
¡ack_size
, 
¡ack_´Ù
,

395 
MAP_PRIVATE
 | 
MAP_ANONYMOUS
 |

396 
MAP_UNINITIALIZED
 | 
MAP_GROWSDOWN
,

399 ià(
	`IS_ERR_VALUE
(
cu¼’t
->
mm
->
¡¬t_brk
)) {

400 
	`up_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

401 
»tv®
 = 
cu¼’t
->
mm
->
¡¬t_brk
;

402 
cu¼’t
->
mm
->
¡¬t_brk
 = 0;

403 
”rÜ_kl
;

406 
	`up_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

408 
cu¼’t
->
mm
->
brk
 = cu¼’t->mm->
¡¬t_brk
;

409 
cu¼’t
->
mm
->
cÚ‹xt
.
’d_brk
 = cu¼’t->mm->
¡¬t_brk
;

410 
cu¼’t
->
mm
->
cÚ‹xt
.
’d_brk
 +=

411 (
¡ack_size
 > 
PAGE_SIZE
) ? (stack_size - PAGE_SIZE) : 0;

412 
cu¼’t
->
mm
->
¡¬t_¡ack
 = cu¼’t->mm->
¡¬t_brk
 + 
¡ack_size
;

415 
	`š¡®l_exec_üeds
(
b´m
);

416 
cu¼’t
->
æags
 &ğ~
PF_FORKNOEXEC
;

417 ià(
	`ü—‹_–f_fdpic_bËs
(
b´m
, 
cu¼’t
->
mm
,

418 &
exec_·¿ms
, &
š‹½_·¿ms
) < 0)

419 
”rÜ_kl
;

421 
	`kdebug
("- s¹_cod %lx", 
cu¼’t
->
mm
->
¡¬t_code
);

422 
	`kdebug
("-ƒnd_cod %lx", 
cu¼’t
->
mm
->
’d_code
);

423 
	`kdebug
("- s¹_d©¨ %lx", 
cu¼’t
->
mm
->
¡¬t_d©a
);

424 
	`kdebug
("-ƒnd_d©¨ %lx", 
cu¼’t
->
mm
->
’d_d©a
);

425 
	`kdebug
("- s¹_brk %lx", 
cu¼’t
->
mm
->
¡¬t_brk
);

426 
	`kdebug
("- brk %lx", 
cu¼’t
->
mm
->
brk
);

427 
	`kdebug
("- s¹_¡ack %lx", 
cu¼’t
->
mm
->
¡¬t_¡ack
);

429 #ifdeà
ELF_FDPIC_PLAT_INIT


436 
dyÇddr
 = 
š‹½_·¿ms
.
dyÇmic_addr
 ?: 
exec_·¿ms
.dynamic_addr;

437 
	`ELF_FDPIC_PLAT_INIT
(
»gs
, 
exec_·¿ms
.
m­_addr
, 
š‹½_·¿ms
.map_addr,

438 
dyÇddr
);

442 
’Œyaddr
 = 
š‹½_·¿ms
.
’Œy_addr
 ?: 
exec_·¿ms
.entry_addr;

443 
	`¡¬t_th»ad
(
»gs
, 
’Œyaddr
, 
cu¼’t
->
mm
->
¡¬t_¡ack
);

445 
»tv®
 = 0;

447 
”rÜ
:

448 ià(
š‹½»‹r
) {

449 
	`®low_wr™e_acûss
(
š‹½»‹r
);

450 
	`åut
(
š‹½»‹r
);

452 
	`kä“
(
š‹½»‹r_Çme
);

453 
	`kä“
(
exec_·¿ms
.
phdrs
);

454 
	`kä“
(
exec_·¿ms
.
lßdm­
);

455 
	`kä“
(
š‹½_·¿ms
.
phdrs
);

456 
	`kä“
(
š‹½_·¿ms
.
lßdm­
);

457  
»tv®
;

460 
”rÜ_kl
:

461 
	`£nd_sig
(
SIGSEGV
, 
cu¼’t
, 0);

462 
”rÜ
;

464 
	}
}

468 #iâdeà
ELF_BASE_PLATFORM


474 
	#ELF_BASE_PLATFORM
 
NULL


	)

481 
	$ü—‹_–f_fdpic_bËs
(
lšux_bš´m
 *
b´m
,

482 
mm_¡ruù
 *
mm
,

483 
–f_fdpic_·¿ms
 *
exec_·¿ms
,

484 
–f_fdpic_·¿ms
 *
š‹½_·¿ms
)

486 cÚ¡ 
üed
 *üed = 
	`cu¼’t_üed
();

487 
¥
, 
c¥
, 
n™ems
;

488 
–f_ÿddr_t
 
__u£r
 *
¬gv
, *
’vp
;

489 
size_t
 
¶©fÜm_Ën
 = 0, 
Ën
;

490 *
k_¶©fÜm
, *
k_ba£_¶©fÜm
;

491 
__u£r
 *
u_¶©fÜm
, *
u_ba£_¶©fÜm
, *
p
;

492 
hwÿp
;

493 
loİ
;

494 
Ä
;

496 #ifdeà
CONFIG_MMU


502 
¥
 = 
	`¬ch_®ign_¡ack
(
b´m
->
p
);

504 
¥
 = 
mm
->
¡¬t_¡ack
;

507 ià(
	`–f_fdpic_Œªsãr_¬gs_to_¡ack
(
b´m
, &
¥
) < 0)

508  -
EFAULT
;

511 
hwÿp
 = 
ELF_HWCAP
;

519 
k_¶©fÜm
 = 
ELF_PLATFORM
;

520 
u_¶©fÜm
 = 
NULL
;

522 ià(
k_¶©fÜm
) {

523 
¶©fÜm_Ën
 = 
	`¡¾’
(
k_¶©fÜm
) + 1;

524 
¥
 -ğ
¶©fÜm_Ën
;

525 
u_¶©fÜm
 = (
__u£r
 *è
¥
;

526 ià(
	`__cİy_to_u£r
(
u_¶©fÜm
, 
k_¶©fÜm
, 
¶©fÜm_Ën
) != 0)

527  -
EFAULT
;

534 
k_ba£_¶©fÜm
 = 
ELF_BASE_PLATFORM
;

535 
u_ba£_¶©fÜm
 = 
NULL
;

537 ià(
k_ba£_¶©fÜm
) {

538 
¶©fÜm_Ën
 = 
	`¡¾’
(
k_ba£_¶©fÜm
) + 1;

539 
¥
 -ğ
¶©fÜm_Ën
;

540 
u_ba£_¶©fÜm
 = (
__u£r
 *è
¥
;

541 ià(
	`__cİy_to_u£r
(
u_ba£_¶©fÜm
, 
k_ba£_¶©fÜm
, 
¶©fÜm_Ën
) != 0)

542  -
EFAULT
;

545 
¥
 &= ~7UL;

548 
Ën
 = (
–f32_fdpic_lßdm­
);

549 
Ën
 +ğ(
–f32_fdpic_lßd£g
è* 
exec_·¿ms
->
lßdm­
->
n£gs
;

550 
¥
 = (¥ - 
Ën
) & ~7UL;

551 
exec_·¿ms
->
m­_addr
 = 
¥
;

553 ià(
	`cİy_to_u£r
((
__u£r
 *è
¥
, 
exec_·¿ms
->
lßdm­
, 
Ën
) != 0)

554  -
EFAULT
;

556 
cu¼’t
->
mm
->
cÚ‹xt
.
exec_fdpic_lßdm­
 = (è
¥
;

558 ià(
š‹½_·¿ms
->
lßdm­
) {

559 
Ën
 = (
–f32_fdpic_lßdm­
);

560 
Ën
 +ğ(
–f32_fdpic_lßd£g
) *

561 
š‹½_·¿ms
->
lßdm­
->
n£gs
;

562 
¥
 = (¥ - 
Ën
) & ~7UL;

563 
š‹½_·¿ms
->
m­_addr
 = 
¥
;

565 ià(
	`cİy_to_u£r
((
__u£r
 *è
¥
, 
š‹½_·¿ms
->
lßdm­
,

566 
Ën
) != 0)

567  -
EFAULT
;

569 
cu¼’t
->
mm
->
cÚ‹xt
.
š‹½_fdpic_lßdm­
 = (è
¥
;

573 
	#DLINFO_ITEMS
 15

	)

575 
n™ems
 = 1 + 
DLINFO_ITEMS
 + (
k_¶©fÜm
 ? 1 : 0) +

576 (
k_ba£_¶©fÜm
 ? 1 : 0è+ 
AT_VECTOR_SIZE_ARCH
;

578 ià(
b´m
->
š‹½_æags
 & 
BINPRM_FLAGS_EXECFD
)

579 
n™ems
++;

581 
c¥
 = 
¥
;

582 
¥
 -ğ
n™ems
 * 2 * ();

583 
¥
 -ğ(
b´m
->
’vc
 + 1) * (*);

584 
¥
 -ğ(
b´m
->
¬gc
 + 1) * (*);

585 
¥
 -= 1 * ();

587 
c¥
 -ğ
¥
 & 15UL;

588 
¥
 -= sp & 15UL;

591 
	#NEW_AUX_ENT
(
id
, 
v®
) \

593 ¡ruù { 
_id
, 
_v®
; } 
__u£r
 *
’t
; \

595 
’t
 = (
__u£r
 *è
c¥
; \

596 
	`__put_u£r
((
id
), &
’t
[
Ä
].
_id
); \

597 
	`__put_u£r
((
v®
), &
’t
[
Ä
].
_v®
); \

598 
Ä
++; \

599 } 0)

	)

601 
Ä
 = 0;

602 
c¥
 -= 2 * ();

603 
	`NEW_AUX_ENT
(
AT_NULL
, 0);

604 ià(
k_¶©fÜm
) {

605 
Ä
 = 0;

606 
c¥
 -= 2 * ();

607 
	`NEW_AUX_ENT
(
AT_PLATFORM
,

608 (
–f_addr_t
è(è
u_¶©fÜm
);

611 ià(
k_ba£_¶©fÜm
) {

612 
Ä
 = 0;

613 
c¥
 -= 2 * ();

614 
	`NEW_AUX_ENT
(
AT_BASE_PLATFORM
,

615 (
–f_addr_t
è(è
u_ba£_¶©fÜm
);

618 ià(
b´m
->
š‹½_æags
 & 
BINPRM_FLAGS_EXECFD
) {

619 
Ä
 = 0;

620 
c¥
 -= 2 * ();

621 
	`NEW_AUX_ENT
(
AT_EXECFD
, 
b´m
->
š‹½_d©a
);

624 
Ä
 = 0;

625 
c¥
 -ğ
DLINFO_ITEMS
 * 2 * ();

626 
	`NEW_AUX_ENT
(
AT_HWCAP
, 
hwÿp
);

627 
	`NEW_AUX_ENT
(
AT_PAGESZ
, 
PAGE_SIZE
);

628 
	`NEW_AUX_ENT
(
AT_CLKTCK
, 
CLOCKS_PER_SEC
);

629 
	`NEW_AUX_ENT
(
AT_PHDR
, 
exec_·¿ms
->
ph_addr
);

630 
	`NEW_AUX_ENT
(
AT_PHENT
, (
–f_phdr
));

631 
	`NEW_AUX_ENT
(
AT_PHNUM
, 
exec_·¿ms
->
hdr
.
e_phnum
);

632 
	`NEW_AUX_ENT
(
AT_BASE
, 
š‹½_·¿ms
->
–fhdr_addr
);

633 
	`NEW_AUX_ENT
(
AT_FLAGS
, 0);

634 
	`NEW_AUX_ENT
(
AT_ENTRY
, 
exec_·¿ms
->
’Œy_addr
);

635 
	`NEW_AUX_ENT
(
AT_UID
, (
–f_addr_t
è
üed
->
uid
);

636 
	`NEW_AUX_ENT
(
AT_EUID
, (
–f_addr_t
è
üed
->
euid
);

637 
	`NEW_AUX_ENT
(
AT_GID
, (
–f_addr_t
è
üed
->
gid
);

638 
	`NEW_AUX_ENT
(
AT_EGID
, (
–f_addr_t
è
üed
->
egid
);

639 
	`NEW_AUX_ENT
(
AT_SECURE
, 
	`£cur™y_b´m_£cu»exec
(
b´m
));

640 
	`NEW_AUX_ENT
(
AT_EXECFN
, 
b´m
->
exec
);

642 #ifdeà
ARCH_DLINFO


643 
Ä
 = 0;

644 
c¥
 -ğ
AT_VECTOR_SIZE_ARCH
 * 2 * ();

649 
ARCH_DLINFO
;

651 #undeà
NEW_AUX_ENT


654 
c¥
 -ğ(
b´m
->
’vc
 + 1è* (
–f_ÿddr_t
);

655 
’vp
 = (
–f_ÿddr_t
 
__u£r
 *è
c¥
;

656 
c¥
 -ğ(
b´m
->
¬gc
 + 1è* (
–f_ÿddr_t
);

657 
¬gv
 = (
–f_ÿddr_t
 
__u£r
 *è
c¥
;

660 
c¥
 -= ();

661 
	`__put_u£r
(
b´m
->
¬gc
, (
__u£r
 *è
c¥
);

663 
	`BUG_ON
(
c¥
 !ğ
¥
);

666 #ifdeà
CONFIG_MMU


667 
cu¼’t
->
mm
->
¬g_¡¬t
 = 
b´m
->
p
;

669 
cu¼’t
->
mm
->
¬g_¡¬t
 = cu¼’t->mm->
¡¬t_¡ack
 -

670 (
MAX_ARG_PAGES
 * 
PAGE_SIZE
 - 
b´m
->
p
);

673 
p
 = (
__u£r
 *è
cu¼’t
->
mm
->
¬g_¡¬t
;

674 
loİ
 = 
b´m
->
¬gc
;†oop > 0;†oop--) {

675 
	`__put_u£r
((
–f_ÿddr_t
è
p
, 
¬gv
++);

676 
Ën
 = 
	`¡ºËn_u£r
(
p
, 
MAX_ARG_STRLEN
);

677 ià(!
Ën
 ||†’ > 
MAX_ARG_STRLEN
)

678  -
EINVAL
;

679 
p
 +ğ
Ën
;

681 
	`__put_u£r
(
NULL
, 
¬gv
);

682 
cu¼’t
->
mm
->
¬g_’d
 = (è
p
;

685 
cu¼’t
->
mm
->
’v_¡¬t
 = (è
p
;

686 
loİ
 = 
b´m
->
’vc
;†oop > 0;†oop--) {

687 
	`__put_u£r
((
–f_ÿddr_t
)(è
p
, 
’vp
++);

688 
Ën
 = 
	`¡ºËn_u£r
(
p
, 
MAX_ARG_STRLEN
);

689 ià(!
Ën
 ||†’ > 
MAX_ARG_STRLEN
)

690  -
EINVAL
;

691 
p
 +ğ
Ën
;

693 
	`__put_u£r
(
NULL
, 
’vp
);

694 
cu¼’t
->
mm
->
’v_’d
 = (è
p
;

696 
mm
->
¡¬t_¡ack
 = (è
¥
;

698 
	}
}

705 #iâdeà
CONFIG_MMU


706 
	$–f_fdpic_Œªsãr_¬gs_to_¡ack
(
lšux_bš´m
 *
b´m
,

707 *
_¥
)

709 
šdex
, 
¡İ
, 
¥
;

710 *
¤c
;

711 
»t
 = 0;

713 
¡İ
 = 
b´m
->
p
 >> 
PAGE_SHIFT
;

714 
¥
 = *
_¥
;

716 
šdex
 = 
MAX_ARG_PAGES
 - 1; index >ğ
¡İ
; index--) {

717 
¤c
 = 
	`km­
(
b´m
->
·ge
[
šdex
]);

718 
¥
 -ğ
PAGE_SIZE
;

719 ià(
	`cİy_to_u£r
((*è
¥
, 
¤c
, 
PAGE_SIZE
) != 0)

720 
»t
 = -
EFAULT
;

721 
	`kunm­
(
b´m
->
·ge
[
šdex
]);

722 ià(
»t
 < 0)

723 
out
;

726 *
_¥
 = (*_¥ - (
MAX_ARG_PAGES
 * 
PAGE_SIZE
 - 
b´m
->
p
)) & ~15;

728 
out
:

729  
»t
;

730 
	}
}

744 
	$–f_fdpic_m­_fe
(
–f_fdpic_·¿ms
 *
·¿ms
,

745 
fe
 *file,

746 
mm_¡ruù
 *
mm
,

747 cÚ¡ *
wh©
)

749 
–f32_fdpic_lßdm­
 *
lßdm­
;

750 #ifdeà
CONFIG_MMU


751 
–f32_fdpic_lßd£g
 *
m£g
;

753 
–f32_fdpic_lßd£g
 *
£g
;

754 
–f32_phdr
 *
phdr
;

755 
lßd_addr
, 
¡İ
;

756 
Æßds
, 
tmp
;

757 
size_t
 
size
;

758 
loİ
, 
»t
;

761 
Æßds
 = 0;

762 
loİ
 = 0;†oİ < 
·¿ms
->
hdr
.
e_phnum
;†oop++)

763 ià(
·¿ms
->
phdrs
[
loİ
].
p_ty³
 =ğ
PT_LOAD
)

764 
Æßds
++;

766 ià(
Æßds
 == 0)

767  -
ELIBBAD
;

769 
size
 = (*
lßdm­
è+ 
Æßds
 * (*
£g
);

770 
lßdm­
 = 
	`kz®loc
(
size
, 
GFP_KERNEL
);

771 ià(!
lßdm­
)

772  -
ENOMEM
;

774 
·¿ms
->
lßdm­
 =†oadmap;

776 
lßdm­
->
v”siÚ
 = 
ELF32_FDPIC_LOADMAP_VERSION
;

777 
lßdm­
->
n£gs
 = 
Æßds
;

779 
lßd_addr
 = 
·¿ms
->load_addr;

780 
£g
 = 
lßdm­
->
£gs
;

783 
·¿ms
->
æags
 & 
ELF_FDPIC_FLAG_ARRANGEMENT
) {

784 
ELF_FDPIC_FLAG_CONSTDISP
:

785 
ELF_FDPIC_FLAG_CONTIGUOUS
:

786 #iâdeà
CONFIG_MMU


787 
»t
 = 
	`–f_fdpic_m­_fe_cÚ¡di¥_Ú_uşšux
(
·¿ms
, 
fe
, 
mm
);

788 ià(
»t
 < 0)

789  
»t
;

793 
»t
 = 
	`–f_fdpic_m­_fe_by_dœeù_mm­
(
·¿ms
, 
fe
, 
mm
);

794 ià(
»t
 < 0)

795  
»t
;

800 ià(
·¿ms
->
hdr
.
e_’Œy
) {

801 
£g
 = 
lßdm­
->
£gs
;

802 
loİ
 = 
lßdm­
->
n£gs
;†oİ > 0;†oİ--, 
£g
++) {

803 ià(
·¿ms
->
hdr
.
e_’Œy
 >ğ
£g
->
p_vaddr
 &&

804 
·¿ms
->
hdr
.
e_’Œy
 < 
£g
->
p_vaddr
 + seg->
p_memsz
) {

805 
·¿ms
->
’Œy_addr
 =

806 (
·¿ms
->
hdr
.
e_’Œy
 - 
£g
->
p_vaddr
) +

807 
£g
->
addr
;

814 
¡İ
 = 
·¿ms
->
hdr
.
e_phoff
;

815 
¡İ
 +ğ
·¿ms
->
hdr
.
e_phnum
 *  (
–f_phdr
);

816 
phdr
 = 
·¿ms
->
phdrs
;

818 
loİ
 = 0;†oİ < 
·¿ms
->
hdr
.
e_phnum
;†oİ++, 
phdr
++) {

819 ià(
phdr
->
p_ty³
 !ğ
PT_LOAD
)

822 ià(
phdr
->
p_off£t
 > 
·¿ms
->
hdr
.
e_phoff
 ||

823 
phdr
->
p_off£t
 +…hdr->
p_fesz
 < 
¡İ
)

826 
£g
 = 
lßdm­
->
£gs
;

827 
loİ
 = 
lßdm­
->
n£gs
;†oİ > 0;†oİ--, 
£g
++) {

828 ià(
phdr
->
p_vaddr
 >ğ
£g
->p_vaddr &&

829 
phdr
->
p_vaddr
 +…hdr->
p_fesz
 <=

830 
£g
->
p_vaddr
 + seg->
p_memsz
) {

831 
·¿ms
->
ph_addr
 =

832 (
phdr
->
p_vaddr
 - 
£g
->p_vaddr) +

833 
£g
->
addr
 +

834 
·¿ms
->
hdr
.
e_phoff
 - 
phdr
->
p_off£t
;

842 
phdr
 = 
·¿ms
->
phdrs
;

843 
loİ
 = 0;†oİ < 
·¿ms
->
hdr
.
e_phnum
;†oİ++, 
phdr
++) {

844 ià(
phdr
->
p_ty³
 !ğ
PT_DYNAMIC
)

847 
£g
 = 
lßdm­
->
£gs
;

848 
loİ
 = 
lßdm­
->
n£gs
;†oİ > 0;†oİ--, 
£g
++) {

849 ià(
phdr
->
p_vaddr
 >ğ
£g
->p_vaddr &&

850 
phdr
->
p_vaddr
 +…hdr->
p_memsz
 <=

851 
£g
->
p_vaddr
 + seg->
p_memsz
) {

852 
·¿ms
->
dyÇmic_addr
 =

853 (
phdr
->
p_vaddr
 - 
£g
->p_vaddr) +

854 
£g
->
addr
;

859 ià(
phdr
->
p_memsz
 == 0 ||

860 
phdr
->
p_memsz
 % (
Elf32_Dyn
) != 0)

861 
dyÇmic_”rÜ
;

863 
tmp
 = 
phdr
->
p_memsz
 / (
Elf32_Dyn
);

864 ià(((
Elf32_Dyn
 *)

865 
·¿ms
->
dyÇmic_addr
)[
tmp
 - 1].
d_g
 != 0)

866 
dyÇmic_”rÜ
;

877 #ifdeà
CONFIG_MMU


878 
Æßds
 = 
lßdm­
->
n£gs
;

879 
m£g
 = 
lßdm­
->
£gs
;

880 
£g
 = 
m£g
 + 1;

881 
loİ
 = 1;†oİ < 
Æßds
;†oop++) {

883 ià(
£g
->
p_vaddr
 - 
m£g
->p_vadd¸=ğ£g->
addr
 - mseg->addr) {

884 
lßd_addr
 = 
	`PAGE_ALIGN
(
m£g
->
addr
 + m£g->
p_memsz
);

885 ià(
lßd_addr
 =ğ(
£g
->
addr
 & 
PAGE_MASK
)) {

886 
m£g
->
p_memsz
 +=

887 
lßd_addr
 -

888 (
m£g
->
addr
 + m£g->
p_memsz
);

889 
m£g
->
p_memsz
 +ğ
£g
->
addr
 & ~
PAGE_MASK
;

890 
m£g
->
p_memsz
 +ğ
£g
->p_memsz;

891 
lßdm­
->
n£gs
--;

896 
m£g
++;

897 ià(
m£g
 !ğ
£g
)

898 *
m£g
 = *
£g
;

902 
	`kdebug
("M­³d Objeù [%s]:", 
wh©
);

903 
	`kdebug
("-ƒlfhd¸ : %lx", 
·¿ms
->
–fhdr_addr
);

904 
	`kdebug
("-ƒÁry : %lx", 
·¿ms
->
’Œy_addr
);

905 
	`kdebug
("- PHDR[] : %lx", 
·¿ms
->
ph_addr
);

906 
	`kdebug
("- DYNAMIC[]: %lx", 
·¿ms
->
dyÇmic_addr
);

907 
£g
 = 
lßdm­
->
£gs
;

908 
loİ
 = 0;†oİ < 
lßdm­
->
n£gs
;†oİ++, 
£g
++)

909 
	`kdebug
("- LOAD[%d] : %08x-%08x [va=%x ms=%x]",

910 
loİ
,

911 
£g
->
addr
, seg->add¸+ seg->
p_memsz
 - 1,

912 
£g
->
p_vaddr
, seg->
p_memsz
);

916 
dyÇmic_”rÜ
:

917 
	`´štk
("ELF FDPIC %s with invalid DYNAMIC section (inode=%lu)\n",

918 
wh©
, 
fe
->
f_·th
.
d’Œy
->
d_šode
->
i_šo
);

919  -
ELIBBAD
;

920 
	}
}

926 #iâdeà
CONFIG_MMU


927 
	$–f_fdpic_m­_fe_cÚ¡di¥_Ú_uşšux
(

928 
–f_fdpic_·¿ms
 *
·¿ms
,

929 
fe
 *file,

930 
mm_¡ruù
 *
mm
)

932 
–f32_fdpic_lßd£g
 *
£g
;

933 
–f32_phdr
 *
phdr
;

934 
lßd_addr
, 
ba£
 = 
ULONG_MAX
, 
tİ
 = 0, 
maddr
 = 0, 
mæags
;

935 
loff_t
 
åos
;

936 
loİ
, 
»t
;

938 
lßd_addr
 = 
·¿ms
->load_addr;

939 
£g
 = 
·¿ms
->
lßdm­
->
£gs
;

943 
phdr
 = 
·¿ms
->
phdrs
;

944 
loİ
 = 0;†oİ < 
·¿ms
->
hdr
.
e_phnum
;†oİ++, 
phdr
++) {

945 ià(
·¿ms
->
phdrs
[
loİ
].
p_ty³
 !ğ
PT_LOAD
)

948 ià(
ba£
 > 
phdr
->
p_vaddr
)

949 
ba£
 = 
phdr
->
p_vaddr
;

950 ià(
tİ
 < 
phdr
->
p_vaddr
 +…hdr->
p_memsz
)

951 
tİ
 = 
phdr
->
p_vaddr
 +…hdr->
p_memsz
;

955 
mæags
 = 
MAP_PRIVATE
;

956 ià(
·¿ms
->
æags
 & 
ELF_FDPIC_FLAG_EXECUTABLE
)

957 
mæags
 |ğ
MAP_EXECUTABLE
;

959 
	`down_wr™e
(&
mm
->
mm­_£m
);

960 
maddr
 = 
	`do_mm­
(
NULL
, 
lßd_addr
, 
tİ
 - 
ba£
,

961 
PROT_READ
 | 
PROT_WRITE
 | 
PROT_EXEC
, 
mæags
, 0);

962 
	`up_wr™e
(&
mm
->
mm­_£m
);

963 ià(
	`IS_ERR_VALUE
(
maddr
))

964  (è
maddr
;

966 ià(
lßd_addr
 != 0)

967 
lßd_addr
 +ğ
	`PAGE_ALIGN
(
tİ
 - 
ba£
);

970 
phdr
 = 
·¿ms
->
phdrs
;

971 
loİ
 = 0;†oİ < 
·¿ms
->
hdr
.
e_phnum
;†oİ++, 
phdr
++) {

972 ià(
·¿ms
->
phdrs
[
loİ
].
p_ty³
 !ğ
PT_LOAD
)

975 
åos
 = 
phdr
->
p_off£t
;

977 
£g
->
addr
 = 
maddr
 + (
phdr
->
p_vaddr
 - 
ba£
);

978 
£g
->
p_vaddr
 = 
phdr
->p_vaddr;

979 
£g
->
p_memsz
 = 
phdr
->p_memsz;

981 
»t
 = 
fe
->
f_İ
->
	`»ad
(fe, (*è
£g
->
addr
,

982 
phdr
->
p_fesz
, &
åos
);

983 ià(
»t
 < 0)

984  
»t
;

987 ià(
phdr
->
p_off£t
 == 0)

988 
·¿ms
->
–fhdr_addr
 = 
£g
->
addr
;

991 ià(
phdr
->
p_fesz
 <…hdr->
p_memsz
) {

992 ià(
	`ş—r_u£r
((*è(
£g
->
addr
 + 
phdr
->
p_fesz
),

993 
phdr
->
p_memsz
 -…hdr->
p_fesz
))

994  -
EFAULT
;

997 ià(
mm
) {

998 ià(
phdr
->
p_æags
 & 
PF_X
) {

999 ià(!
mm
->
¡¬t_code
) {

1000 
mm
->
¡¬t_code
 = 
£g
->
addr
;

1001 
mm
->
’d_code
 = 
£g
->
addr
 +

1002 
phdr
->
p_memsz
;

1004 } ià(!
mm
->
¡¬t_d©a
) {

1005 
mm
->
¡¬t_d©a
 = 
£g
->
addr
;

1006 
mm
->
’d_d©a
 = 
£g
->
addr
 + 
phdr
->
p_memsz
;

1010 
£g
++;

1014 
	}
}

1021 
	$–f_fdpic_m­_fe_by_dœeù_mm­
(
–f_fdpic_·¿ms
 *
·¿ms
,

1022 
fe
 *file,

1023 
mm_¡ruù
 *
mm
)

1025 
–f32_fdpic_lßd£g
 *
£g
;

1026 
–f32_phdr
 *
phdr
;

1027 
lßd_addr
, 
d–_vaddr
;

1028 
loİ
, 
dv£t
;

1030 
lßd_addr
 = 
·¿ms
->load_addr;

1031 
d–_vaddr
 = 0;

1032 
dv£t
 = 0;

1034 
£g
 = 
·¿ms
->
lßdm­
->
£gs
;

1037 
phdr
 = 
·¿ms
->
phdrs
;

1038 
loİ
 = 0;†oİ < 
·¿ms
->
hdr
.
e_phnum
;†oİ++, 
phdr
++) {

1039 
maddr
, 
di¥
, 
exûss
, 
exûss1
;

1040 
´Ù
 = 0, 
æags
;

1042 ià(
phdr
->
p_ty³
 !ğ
PT_LOAD
)

1045 
	`kdebug
("[LOAD] va=%lx of=%lx fs=%lx ms=%lx",

1046 (è
phdr
->
p_vaddr
,

1047 (è
phdr
->
p_off£t
,

1048 (è
phdr
->
p_fesz
,

1049 (è
phdr
->
p_memsz
);

1052 ià(
phdr
->
p_æags
 & 
PF_R
è
´Ù
 |ğ
PROT_READ
;

1053 ià(
phdr
->
p_æags
 & 
PF_W
è
´Ù
 |ğ
PROT_WRITE
;

1054 ià(
phdr
->
p_æags
 & 
PF_X
è
´Ù
 |ğ
PROT_EXEC
;

1056 
æags
 = 
MAP_PRIVATE
 | 
MAP_DENYWRITE
;

1057 ià(
·¿ms
->
æags
 & 
ELF_FDPIC_FLAG_EXECUTABLE
)

1058 
æags
 |ğ
MAP_EXECUTABLE
;

1060 
maddr
 = 0;

1062 
·¿ms
->
æags
 & 
ELF_FDPIC_FLAG_ARRANGEMENT
) {

1063 
ELF_FDPIC_FLAG_INDEPENDENT
:

1067 
ELF_FDPIC_FLAG_HONOURVADDR
:

1069 
maddr
 = 
phdr
->
p_vaddr
;

1070 
æags
 |ğ
MAP_FIXED
;

1073 
ELF_FDPIC_FLAG_CONSTDISP
:

1078 ià(!
dv£t
) {

1079 
maddr
 = 
lßd_addr
;

1080 
d–_vaddr
 = 
phdr
->
p_vaddr
;

1081 
dv£t
 = 1;

1083 
maddr
 = 
lßd_addr
 + 
phdr
->
p_vaddr
 - 
d–_vaddr
;

1084 
æags
 |ğ
MAP_FIXED
;

1088 
ELF_FDPIC_FLAG_CONTIGUOUS
:

1093 
	`BUG
();

1096 
maddr
 &ğ
PAGE_MASK
;

1099 
di¥
 = 
phdr
->
p_vaddr
 & ~
PAGE_MASK
;

1100 
	`down_wr™e
(&
mm
->
mm­_£m
);

1101 
maddr
 = 
	`do_mm­
(
fe
, maddr, 
phdr
->
p_memsz
 + 
di¥
, 
´Ù
, 
æags
,

1102 
phdr
->
p_off£t
 - 
di¥
);

1103 
	`up_wr™e
(&
mm
->
mm­_£m
);

1105 
	`kdebug
("mmap[%d] <file> sz=%lx…r=%x fl=%x of=%lx --> %08lx",

1106 
loİ
, 
phdr
->
p_memsz
 + 
di¥
, 
´Ù
, 
æags
,

1107 
phdr
->
p_off£t
 - 
di¥
, 
maddr
);

1109 ià(
	`IS_ERR_VALUE
(
maddr
))

1110  (è
maddr
;

1112 ià((
·¿ms
->
æags
 & 
ELF_FDPIC_FLAG_ARRANGEMENT
) ==

1113 
ELF_FDPIC_FLAG_CONTIGUOUS
)

1114 
lßd_addr
 +ğ
	`PAGE_ALIGN
(
phdr
->
p_memsz
 + 
di¥
);

1116 
£g
->
addr
 = 
maddr
 + 
di¥
;

1117 
£g
->
p_vaddr
 = 
phdr
->p_vaddr;

1118 
£g
->
p_memsz
 = 
phdr
->p_memsz;

1121 ià(
phdr
->
p_off£t
 == 0)

1122 
·¿ms
->
–fhdr_addr
 = 
£g
->
addr
;

1126 ià(
´Ù
 & 
PROT_WRITE
 && 
di¥
 > 0) {

1127 
	`kdebug
("ş—r[%d]‡d=%lx sz=%lx", 
loİ
, 
maddr
, 
di¥
);

1128 ià(
	`ş—r_u£r
((
__u£r
 *è
maddr
, 
di¥
))

1129  -
EFAULT
;

1130 
maddr
 +ğ
di¥
;

1138 
exûss
 = 
phdr
->
p_memsz
 -…hdr->
p_fesz
;

1139 
exûss1
 = 
PAGE_SIZE
 - ((
maddr
 + 
phdr
->
p_fesz
è& ~
PAGE_MASK
);

1141 #ifdeà
CONFIG_MMU


1142 ià(
exûss
 > 
exûss1
) {

1143 
xaddr
 = 
maddr
 + 
phdr
->
p_fesz
 + 
exûss1
;

1144 
xmaddr
;

1146 
æags
 |ğ
MAP_FIXED
 | 
MAP_ANONYMOUS
;

1147 
	`down_wr™e
(&
mm
->
mm­_£m
);

1148 
xmaddr
 = 
	`do_mm­
(
NULL
, 
xaddr
, 
exûss
 - 
exûss1
,

1149 
´Ù
, 
æags
, 0);

1150 
	`up_wr™e
(&
mm
->
mm­_£m
);

1152 
	`kdebug
("mmap[%d] <anon>"

1154 
loİ
, 
xaddr
, 
exûss
 - 
exûss1
, 
´Ù
, 
æags
,

1155 
xmaddr
);

1157 ià(
xmaddr
 !ğ
xaddr
)

1158  -
ENOMEM
;

1161 ià(
´Ù
 & 
PROT_WRITE
 && 
exûss1
 > 0) {

1162 
	`kdebug
("clear[%d]‡d=%lx sz=%lx",

1163 
loİ
, 
maddr
 + 
phdr
->
p_fesz
, 
exûss1
);

1164 ià(
	`ş—r_u£r
((
__u£r
 *è
maddr
 + 
phdr
->
p_fesz
,

1165 
exûss1
))

1166  -
EFAULT
;

1170 ià(
exûss
 > 0) {

1171 
	`kdebug
("clear[%d]‡d=%lx sz=%lx",

1172 
loİ
, 
maddr
 + 
phdr
->
p_fesz
, 
exûss
);

1173 ià(
	`ş—r_u£r
((*è
maddr
 + 
phdr
->
p_fesz
, 
exûss
))

1174  -
EFAULT
;

1178 ià(
mm
) {

1179 ià(
phdr
->
p_æags
 & 
PF_X
) {

1180 ià(!
mm
->
¡¬t_code
) {

1181 
mm
->
¡¬t_code
 = 
maddr
;

1182 
mm
->
’d_code
 = 
maddr
 + 
phdr
->
p_memsz
;

1184 } ià(!
mm
->
¡¬t_d©a
) {

1185 
mm
->
¡¬t_d©a
 = 
maddr
;

1186 
mm
->
’d_d©a
 = 
maddr
 + 
phdr
->
p_memsz
;

1190 
£g
++;

1194 
	}
}

1205 #ifdeà
CONFIG_ELF_CORE


1214 
	$maydump
(
vm_¬—_¡ruù
 *
vma
, 
mm_æags
)

1216 
dump_ok
;

1219 ià(
vma
->
vm_æags
 & (
VM_IO
 | 
VM_RESERVED
)) {

1220 
	`kdcÜe
("%08lx: %08lx:‚Ø(IO)", 
vma
->
vm_¡¬t
, vma->
vm_æags
);

1227 ià(!(
vma
->
vm_æags
 & 
VM_READ
)) {

1228 
	`kdcÜe
("%08lx: %08lx:‚Ø(!»ad)", 
vma
->
vm_¡¬t
, vma->
vm_æags
);

1233 ià(
vma
->
vm_æags
 & 
VM_SHARED
) {

1234 ià(
vma
->
vm_fe
->
f_·th
.
d’Œy
->
d_šode
->
i_Æšk
 == 0) {

1235 
dump_ok
 = 
	`‹¡_b™
(
MMF_DUMP_ANON_SHARED
, &
mm_æags
);

1236 
	`kdcÜe
("%08lx: %08lx: % (sh¬e)", 
vma
->
vm_¡¬t
,

1237 
vma
->
vm_æags
, 
dump_ok
 ? "yes" : "no");

1238  
dump_ok
;

1241 
dump_ok
 = 
	`‹¡_b™
(
MMF_DUMP_MAPPED_SHARED
, &
mm_æags
);

1242 
	`kdcÜe
("%08lx: %08lx: % (sh¬e)", 
vma
->
vm_¡¬t
,

1243 
vma
->
vm_æags
, 
dump_ok
 ? "yes" : "no");

1244  
dump_ok
;

1247 #ifdeà
CONFIG_MMU


1249 ià(!
vma
->
ªÚ_vma
) {

1250 
dump_ok
 = 
	`‹¡_b™
(
MMF_DUMP_MAPPED_PRIVATE
, &
mm_æags
);

1251 
	`kdcÜe
("%08lx: %08lx: % (!ªÚ)", 
vma
->
vm_¡¬t
,

1252 
vma
->
vm_æags
, 
dump_ok
 ? "yes" : "no");

1253  
dump_ok
;

1257 
dump_ok
 = 
	`‹¡_b™
(
MMF_DUMP_ANON_PRIVATE
, &
mm_æags
);

1258 
	`kdcÜe
("%08lx: %08lx: %s", 
vma
->
vm_¡¬t
, vma->
vm_æags
,

1259 
dump_ok
 ? "yes" : "no");

1260  
dump_ok
;

1261 
	}
}

1264 
	smem–âÙe


1266 cÚ¡ *
	mÇme
;

1267 
	mty³
;

1268 
	md©asz
;

1269 *
	md©a
;

1272 
	$nÙesize
(
mem–âÙe
 *
’
)

1274 
sz
;

1276 
sz
 = (
–f_nÙe
);

1277 
sz
 +ğ
	`roundup
(
	`¡¾’
(
’
->
Çme
) + 1, 4);

1278 
sz
 +ğ
	`roundup
(
’
->
d©asz
, 4);

1280  
sz
;

1281 
	}
}

1285 
	#DUMP_WRITE
(
addr
, 
Ä
, 
foff£t
) \

1286 dØ{ ià(!
	`dump_wr™e
(
fe
, (
addr
), (
Ä
))è 0; *
foff£t
 +ğÒr); } 0)

	)

1288 
	$®ignfe
(
fe
 *fe, 
loff_t
 *
foff£t
)

1290 cÚ¡ 
buf
[4] = { 0, };

1291 
	`DUMP_WRITE
(
buf
, 
	`roundup
(*
foff£t
, 4) - *foffset, foffset);

1293 
	}
}

1295 
	$wr™’Ùe
(
mem–âÙe
 *
m’
, 
fe
 *file,

1296 
loff_t
 *
foff£t
)

1298 
–f_nÙe
 
’
;

1299 
’
.
n_Çmesz
 = 
	`¡¾’
(
m’
->
Çme
) + 1;

1300 
’
.
n_descsz
 = 
m’
->
d©asz
;

1301 
’
.
n_ty³
 = 
m’
->
ty³
;

1303 
	`DUMP_WRITE
(&
’
, Ón), 
foff£t
);

1304 
	`DUMP_WRITE
(
m’
->
Çme
, 
’
.
n_Çmesz
, 
foff£t
);

1305 ià(!
	`®ignfe
(
fe
, 
foff£t
))

1307 
	`DUMP_WRITE
(
m’
->
d©a
, m’->
d©asz
, 
foff£t
);

1308 ià(!
	`®ignfe
(
fe
, 
foff£t
))

1312 
	}
}

1313 #undeà
DUMP_WRITE


1315 
šlše
 
	$fl_–f_fdpic_h—d”
(
–fhdr
 *
–f
, 
£gs
)

1317 
	`memıy
(
–f
->
e_id’t
, 
ELFMAG
, 
SELFMAG
);

1318 
–f
->
e_id’t
[
EI_CLASS
] = 
ELF_CLASS
;

1319 
–f
->
e_id’t
[
EI_DATA
] = 
ELF_DATA
;

1320 
–f
->
e_id’t
[
EI_VERSION
] = 
EV_CURRENT
;

1321 
–f
->
e_id’t
[
EI_OSABI
] = 
ELF_OSABI
;

1322 
	`mem£t
(
–f
->
e_id’t
+
EI_PAD
, 0, 
EI_NIDENT
-EI_PAD);

1324 
–f
->
e_ty³
 = 
ET_CORE
;

1325 
–f
->
e_machše
 = 
ELF_ARCH
;

1326 
–f
->
e_v”siÚ
 = 
EV_CURRENT
;

1327 
–f
->
e_’Œy
 = 0;

1328 
–f
->
e_phoff
 = (
–fhdr
);

1329 
–f
->
e_shoff
 = 0;

1330 
–f
->
e_æags
 = 
ELF_FDPIC_CORE_EFLAGS
;

1331 
–f
->
e_ehsize
 = (
–fhdr
);

1332 
–f
->
e_ph’tsize
 = (
–f_phdr
);

1333 
–f
->
e_phnum
 = 
£gs
;

1334 
–f
->
e_sh’tsize
 = 0;

1335 
–f
->
e_shnum
 = 0;

1336 
–f
->
e_sh¡ºdx
 = 0;

1338 
	}
}

1340 
šlše
 
	$fl_–f_nÙe_phdr
(
–f_phdr
 *
phdr
, 
sz
, 
loff_t
 
off£t
)

1342 
phdr
->
p_ty³
 = 
PT_NOTE
;

1343 
phdr
->
p_off£t
 = 
off£t
;

1344 
phdr
->
p_vaddr
 = 0;

1345 
phdr
->
p_·ddr
 = 0;

1346 
phdr
->
p_fesz
 = 
sz
;

1347 
phdr
->
p_memsz
 = 0;

1348 
phdr
->
p_æags
 = 0;

1349 
phdr
->
p_®ign
 = 0;

1351 
	}
}

1353 
šlše
 
	$fl_nÙe
(
mem–âÙe
 *
nÙe
, cÚ¡ *
Çme
, 
ty³
,

1354 
sz
, *
d©a
)

1356 
nÙe
->
Çme
 =‚ame;

1357 
nÙe
->
ty³
 =ype;

1358 
nÙe
->
d©asz
 = 
sz
;

1359 
nÙe
->
d©a
 = data;

1361 
	}
}

1367 
	$fl_´¡©us
(
–f_´¡©us
 *
´¡©us
,

1368 
sk_¡ruù
 *
p
, 
sigÄ
)

1370 
´¡©us
->
´_šfo
.
si_signo
 =…r¡©us->
´_cursig
 = 
sigÄ
;

1371 
´¡©us
->
´_sig³nd
 = 
p
->
³ndšg
.
sigÇl
.
sig
[0];

1372 
´¡©us
->
´_sighŞd
 = 
p
->
blocked
.
sig
[0];

1373 
	`rcu_»ad_lock
();

1374 
´¡©us
->
´_µid
 = 
	`sk_pid_vÄ
(
	`rcu_d”eã»nû
(
p
->
»®_·»Á
));

1375 
	`rcu_»ad_uÆock
();

1376 
´¡©us
->
´_pid
 = 
	`sk_pid_vÄ
(
p
);

1377 
´¡©us
->
´_pg½
 = 
	`sk_pg½_vÄ
(
p
);

1378 
´¡©us
->
´_sid
 = 
	`sk_£ssiÚ_vÄ
(
p
);

1379 ià(
	`th»ad_group_Ëad”
(
p
)) {

1380 
sk_ıutime
 
ıutime
;

1386 
	`th»ad_group_ıutime
(
p
, &
ıutime
);

1387 
	`ıutime_to_timev®
(
ıutime
.
utime
, &
´¡©us
->
´_utime
);

1388 
	`ıutime_to_timev®
(
ıutime
.
¡ime
, &
´¡©us
->
´_¡ime
);

1390 
	`ıutime_to_timev®
(
p
->
utime
, &
´¡©us
->
´_utime
);

1391 
	`ıutime_to_timev®
(
p
->
¡ime
, &
´¡©us
->
´_¡ime
);

1393 
	`ıutime_to_timev®
(
p
->
sigÇl
->
cutime
, &
´¡©us
->
´_cutime
);

1394 
	`ıutime_to_timev®
(
p
->
sigÇl
->
c¡ime
, &
´¡©us
->
´_c¡ime
);

1396 
´¡©us
->
´_exec_fdpic_lßdm­
 = 
p
->
mm
->
cÚ‹xt
.
exec_fdpic_lßdm­
;

1397 
´¡©us
->
´_š‹½_fdpic_lßdm­
 = 
p
->
mm
->
cÚ‹xt
.
š‹½_fdpic_lßdm­
;

1398 
	}
}

1400 
	$fl_psšfo
(
–f_´psšfo
 *
psšfo
, 
sk_¡ruù
 *
p
,

1401 
mm_¡ruù
 *
mm
)

1403 cÚ¡ 
üed
 *cred;

1404 
i
, 
Ën
;

1407 
	`mem£t
(
psšfo
, 0, (
–f_´psšfo
));

1409 
Ën
 = 
mm
->
¬g_’d
 - mm->
¬g_¡¬t
;

1410 ià(
Ën
 >ğ
ELF_PRARGSZ
)

1411 
Ën
 = 
ELF_PRARGSZ
 - 1;

1412 ià(
	`cİy_äom_u£r
(&
psšfo
->
´_p§rgs
,

1413 (cÚ¡ 
__u£r
 *è
mm
->
¬g_¡¬t
, 
Ën
))

1414  -
EFAULT
;

1415 
i
 = 0; i < 
Ën
; i++)

1416 ià(
psšfo
->
´_p§rgs
[
i
] == 0)

1417 
psšfo
->
´_p§rgs
[
i
] = ' ';

1418 
psšfo
->
´_p§rgs
[
Ën
] = 0;

1420 
	`rcu_»ad_lock
();

1421 
psšfo
->
´_µid
 = 
	`sk_pid_vÄ
(
	`rcu_d”eã»nû
(
p
->
»®_·»Á
));

1422 
	`rcu_»ad_uÆock
();

1423 
psšfo
->
´_pid
 = 
	`sk_pid_vÄ
(
p
);

1424 
psšfo
->
´_pg½
 = 
	`sk_pg½_vÄ
(
p
);

1425 
psšfo
->
´_sid
 = 
	`sk_£ssiÚ_vÄ
(
p
);

1427 
i
 = 
p
->
¡©e
 ? 
	`ffz
(~p->state) + 1 : 0;

1428 
psšfo
->
´_¡©e
 = 
i
;

1429 
psšfo
->
´_¢ame
 = (
i
 > 5) ? '.' : "RSDTZW"[i];

1430 
psšfo
->
´_zomb
 =…sšfo->
´_¢ame
 == 'Z';

1431 
psšfo
->
´_niû
 = 
	`sk_niû
(
p
);

1432 
psšfo
->
´_æag
 = 
p
->
æags
;

1433 
	`rcu_»ad_lock
();

1434 
üed
 = 
	`__sk_üed
(
p
);

1435 
	`SET_UID
(
psšfo
->
´_uid
, 
üed
->
uid
);

1436 
	`SET_GID
(
psšfo
->
´_gid
, 
üed
->
gid
);

1437 
	`rcu_»ad_uÆock
();

1438 
	`¡ºıy
(
psšfo
->
´_âame
, 
p
->
comm
, (psinfo->pr_fname));

1441 
	}
}

1444 
	s–f_th»ad_¡©us


1446 
li¡_h—d
 
	mli¡
;

1447 
–f_´¡©us
 
	m´¡©us
;

1448 
–f_å»g£t_t
 
	måu
;

1449 
sk_¡ruù
 *
	mth»ad
;

1450 #ifdeà
ELF_CORE_COPY_XFPREGS


1451 
–f_åx»g£t_t
 
	mxåu
;

1453 
mem–âÙe
 
	mnÙes
[3];

1454 
	mnum_nÙes
;

1462 
	$–f_dump_th»ad_¡©us
(
sigÄ
, 
–f_th»ad_¡©us
 *
t
)

1464 
sk_¡ruù
 *
p
 = 
t
->
th»ad
;

1465 
sz
 = 0;

1467 
t
->
num_nÙes
 = 0;

1469 
	`fl_´¡©us
(&
t
->
´¡©us
, 
p
, 
sigÄ
);

1470 
	`–f_cÜe_cİy_sk_»gs
(
p
, &
t
->
´¡©us
.
´_»g
);

1472 
	`fl_nÙe
(&
t
->
nÙes
[0], "CORE", 
NT_PRSTATUS
, Ñ->
´¡©us
),

1473 &
t
->
´¡©us
);

1474 
t
->
num_nÙes
++;

1475 
sz
 +ğ
	`nÙesize
(&
t
->
nÙes
[0]);

1477 
t
->
´¡©us
.
´_åv®id
 = 
	`–f_cÜe_cİy_sk_å»gs
(
p
, 
NULL
, &t->
åu
);

1478 ià(
t
->
´¡©us
.
´_åv®id
) {

1479 
	`fl_nÙe
(&
t
->
nÙes
[1], "CORE", 
NT_PRFPREG
, Ñ->
åu
),

1480 &
t
->
åu
);

1481 
t
->
num_nÙes
++;

1482 
sz
 +ğ
	`nÙesize
(&
t
->
nÙes
[1]);

1485 #ifdeà
ELF_CORE_COPY_XFPREGS


1486 ià(
	`–f_cÜe_cİy_sk_xå»gs
(
p
, &
t
->
xåu
)) {

1487 
	`fl_nÙe
(&
t
->
nÙes
[2], "LINUX", 
ELF_CORE_XFPREG_TYPE
,

1488 (
t
->
xåu
), &t->xfpu);

1489 
t
->
num_nÙes
++;

1490 
sz
 +ğ
	`nÙesize
(&
t
->
nÙes
[2]);

1493  
sz
;

1494 
	}
}

1496 
	$fl_exŠum_šfo
(
–fhdr
 *
–f
, 
–f_shdr
 *
shdr4exŠum
,

1497 
–f_addr_t
 
e_shoff
, 
£gs
)

1499 
–f
->
e_shoff
 =ƒ_shoff;

1500 
–f
->
e_sh’tsize
 = (*
shdr4exŠum
);

1501 
–f
->
e_shnum
 = 1;

1502 
–f
->
e_sh¡ºdx
 = 
SHN_UNDEF
;

1504 
	`mem£t
(
shdr4exŠum
, 0, (*shdr4extnum));

1506 
shdr4exŠum
->
sh_ty³
 = 
SHT_NULL
;

1507 
shdr4exŠum
->
sh_size
 = 
–f
->
e_shnum
;

1508 
shdr4exŠum
->
sh_lšk
 = 
–f
->
e_sh¡ºdx
;

1509 
shdr4exŠum
->
sh_šfo
 = 
£gs
;

1510 
	}
}

1515 #ifdeà
CONFIG_MMU


1516 
	$–f_fdpic_dump_£gm’ts
(
fe
 *fe, 
size_t
 *
size
,

1517 *
lim™
, 
mm_æags
)

1519 
vm_¬—_¡ruù
 *
vma
;

1520 
”r
 = 0;

1522 
vma
 = 
cu¼’t
->
mm
->
mm­
; vma; vm¨ğvma->
vm_Ãxt
) {

1523 
addr
;

1525 ià(!
	`maydump
(
vma
, 
mm_æags
))

1528 
addr
 = 
vma
->
vm_¡¬t
;‡dd¸< vma->
vm_’d
;

1529 
addr
 +ğ
PAGE_SIZE
) {

1530 
·ge
 *·gğ
	`g‘_dump_·ge
(
addr
);

1531 ià(
·ge
) {

1532 *
kaddr
 = 
	`km­
(
·ge
);

1533 *
size
 +ğ
PAGE_SIZE
;

1534 ià(*
size
 > *
lim™
)

1535 
”r
 = -
EFBIG
;

1536 ià(!
	`dump_wr™e
(
fe
, 
kaddr
, 
PAGE_SIZE
))

1537 
”r
 = -
EIO
;

1538 
	`kunm­
(
·ge
);

1539 
	`·ge_ÿche_»Ëa£
(
·ge
);

1540 } ià(!
	`dump_£ek
(
fe
, 
PAGE_SIZE
))

1541 
”r
 = -
EFBIG
;

1542 ià(
”r
)

1543 
out
;

1546 
out
:

1547  
”r
;

1548 
	}
}

1554 #iâdeà
CONFIG_MMU


1555 
	$–f_fdpic_dump_£gm’ts
(
fe
 *fe, 
size_t
 *
size
,

1556 *
lim™
, 
mm_æags
)

1558 
vm_¬—_¡ruù
 *
vma
;

1560 
vma
 = 
cu¼’t
->
mm
->
mm­
; vma; vm¨ğvma->
vm_Ãxt
) {

1561 ià(!
	`maydump
(
vma
, 
mm_æags
))

1564 ià((*
size
 +ğ
PAGE_SIZE
è> *
lim™
)

1565  -
EFBIG
;

1567 ià(!
	`dump_wr™e
(
fe
, (*è
vma
->
vm_¡¬t
,

1568 
vma
->
vm_’d
 - vma->
vm_¡¬t
))

1569  -
EIO
;

1573 
	}
}

1576 
size_t
 
	$–f_cÜe_vma_d©a_size
(
mm_æags
)

1578 
vm_¬—_¡ruù
 *
vma
;

1579 
size_t
 
size
 = 0;

1581 
vma
 = 
cu¼’t
->
mm
->
mm­
; vma; vm¨ğvma->
vm_Ãxt
)

1582 ià(
	`maydump
(
vma
, 
mm_æags
))

1583 
size
 +ğ
vma
->
vm_’d
 - vma->
vm_¡¬t
;

1584  
size
;

1585 
	}
}

1594 
	$–f_fdpic_cÜe_dump
(
cÜedump_·¿ms
 *
ırm
)

1596 
	#NUM_NOTES
 6

	)

1597 
has_dum³d
 = 0;

1598 
mm_£gm’t_t
 
fs
;

1599 
£gs
;

1600 
size_t
 
size
 = 0;

1601 
i
;

1602 
vm_¬—_¡ruù
 *
vma
;

1603 
–fhdr
 *
–f
 = 
NULL
;

1604 
loff_t
 
off£t
 = 0, 
d©aoff
, 
foff£t
;

1605 
numnÙe
;

1606 
mem–âÙe
 *
nÙes
 = 
NULL
;

1607 
–f_´¡©us
 *
´¡©us
 = 
NULL
;

1608 
–f_´psšfo
 *
psšfo
 = 
NULL
;

1609 
	`LIST_HEAD
(
th»ad_li¡
);

1610 
li¡_h—d
 *
t
;

1611 
–f_å»g£t_t
 *
åu
 = 
NULL
;

1612 #ifdeà
ELF_CORE_COPY_XFPREGS


1613 
–f_åx»g£t_t
 *
xåu
 = 
NULL
;

1615 
th»ad_¡©us_size
 = 0;

1616 
–f_addr_t
 *
auxv
;

1617 
–f_phdr
 *
phdr4nÙe
 = 
NULL
;

1618 
–f_shdr
 *
shdr4exŠum
 = 
NULL
;

1619 
Elf_H®f
 
e_phnum
;

1620 
–f_addr_t
 
e_shoff
;

1635 
–f
 = 
	`km®loc
((*–f), 
GFP_KERNEL
);

1636 ià(!
–f
)

1637 
ş—nup
;

1638 
´¡©us
 = 
	`kz®loc
((*´¡©us), 
GFP_KERNEL
);

1639 ià(!
´¡©us
)

1640 
ş—nup
;

1641 
psšfo
 = 
	`km®loc
((*psšfo), 
GFP_KERNEL
);

1642 ià(!
psšfo
)

1643 
ş—nup
;

1644 
nÙes
 = 
	`km®loc
(
NUM_NOTES
 * (
mem–âÙe
), 
GFP_KERNEL
);

1645 ià(!
nÙes
)

1646 
ş—nup
;

1647 
åu
 = 
	`km®loc
((*åu), 
GFP_KERNEL
);

1648 ià(!
åu
)

1649 
ş—nup
;

1650 #ifdeà
ELF_CORE_COPY_XFPREGS


1651 
xåu
 = 
	`km®loc
((*xåu), 
GFP_KERNEL
);

1652 ià(!
xåu
)

1653 
ş—nup
;

1656 ià(
ırm
->
sigÄ
) {

1657 
cÜe_th»ad
 *
ù
;

1658 
–f_th»ad_¡©us
 *
tmp
;

1660 
ù
 = 
cu¼’t
->
mm
->
cÜe_¡©e
->
dum³r
.
Ãxt
;

1661 
ù
; cˆğù->
Ãxt
) {

1662 
tmp
 = 
	`kz®loc
((*tmp), 
GFP_KERNEL
);

1663 ià(!
tmp
)

1664 
ş—nup
;

1666 
tmp
->
th»ad
 = 
ù
->
sk
;

1667 
	`li¡_add
(&
tmp
->
li¡
, &
th»ad_li¡
);

1670 
	`li¡_fÜ_—ch
(
t
, &
th»ad_li¡
) {

1671 
–f_th»ad_¡©us
 *
tmp
;

1672 
sz
;

1674 
tmp
 = 
	`li¡_’Œy
(
t
, 
–f_th»ad_¡©us
, 
li¡
);

1675 
sz
 = 
	`–f_dump_th»ad_¡©us
(
ırm
->
sigÄ
, 
tmp
);

1676 
th»ad_¡©us_size
 +ğ
sz
;

1681 
	`fl_´¡©us
(
´¡©us
, 
cu¼’t
, 
ırm
->
sigÄ
);

1682 
	`–f_cÜe_cİy_»gs
(&
´¡©us
->
´_»g
, 
ırm
->
»gs
);

1684 
£gs
 = 
cu¼’t
->
mm
->
m­_couÁ
;

1685 
£gs
 +ğ
	`–f_cÜe_exŒa_phdrs
();

1688 
£gs
++;

1693 
e_phnum
 = 
£gs
 > 
PN_XNUM
 ? PN_XNUM : segs;

1696 
	`fl_–f_fdpic_h—d”
(
–f
, 
e_phnum
);

1698 
has_dum³d
 = 1;

1699 
cu¼’t
->
æags
 |ğ
PF_DUMPCORE
;

1706 
	`fl_nÙe
(
nÙes
 + 0, "CORE", 
NT_PRSTATUS
, (*
´¡©us
),…rstatus);

1707 
	`fl_psšfo
(
psšfo
, 
cu¼’t
->
group_Ëad”
, cu¼’t->
mm
);

1708 
	`fl_nÙe
(
nÙes
 + 1, "CORE", 
NT_PRPSINFO
, (*
psšfo
),…sinfo);

1710 
numnÙe
 = 2;

1712 
auxv
 = (
–f_addr_t
 *è
cu¼’t
->
mm
->
§ved_auxv
;

1714 
i
 = 0;

1716 
i
 += 2;

1717 
auxv
[
i
 - 2] !ğ
AT_NULL
);

1718 
	`fl_nÙe
(&
nÙes
[
numnÙe
++], "CORE", 
NT_AUXV
,

1719 
i
 * (
–f_addr_t
), 
auxv
);

1722 ià((
´¡©us
->
´_åv®id
 =

1723 
	`–f_cÜe_cİy_sk_å»gs
(
cu¼’t
, 
ırm
->
»gs
, 
åu
)))

1724 
	`fl_nÙe
(
nÙes
 + 
numnÙe
++,

1725 "CORE", 
NT_PRFPREG
, (*
åu
), fpu);

1726 #ifdeà
ELF_CORE_COPY_XFPREGS


1727 ià(
	`–f_cÜe_cİy_sk_xå»gs
(
cu¼’t
, 
xåu
))

1728 
	`fl_nÙe
(
nÙes
 + 
numnÙe
++,

1729 "LINUX", 
ELF_CORE_XFPREG_TYPE
, (*
xåu
), xfpu);

1732 
fs
 = 
	`g‘_fs
();

1733 
	`£t_fs
(
KERNEL_DS
);

1735 
off£t
 +ğ(*
–f
);

1736 
off£t
 +ğ
£gs
 * (
–f_phdr
);

1737 
foff£t
 = 
off£t
;

1741 
sz
 = 0;

1743 
i
 = 0; i < 
numnÙe
; i++)

1744 
sz
 +ğ
	`nÙesize
(
nÙes
 + 
i
);

1746 
sz
 +ğ
th»ad_¡©us_size
;

1748 
phdr4nÙe
 = 
	`km®loc
((*phdr4nÙe), 
GFP_KERNEL
);

1749 ià(!
phdr4nÙe
)

1750 
’d_cÜedump
;

1752 
	`fl_–f_nÙe_phdr
(
phdr4nÙe
, 
sz
, 
off£t
);

1753 
off£t
 +ğ
sz
;

1757 
d©aoff
 = 
off£t
 = 
	`roundup
(off£t, 
ELF_EXEC_PAGESIZE
);

1759 
off£t
 +ğ
	`–f_cÜe_vma_d©a_size
(
ırm
->
mm_æags
);

1760 
off£t
 +ğ
	`–f_cÜe_exŒa_d©a_size
();

1761 
e_shoff
 = 
off£t
;

1763 ià(
e_phnum
 =ğ
PN_XNUM
) {

1764 
shdr4exŠum
 = 
	`km®loc
((*shdr4exŠum), 
GFP_KERNEL
);

1765 ià(!
shdr4exŠum
)

1766 
’d_cÜedump
;

1767 
	`fl_exŠum_šfo
(
–f
, 
shdr4exŠum
, 
e_shoff
, 
£gs
);

1770 
off£t
 = 
d©aoff
;

1772 
size
 +ğ(*
–f
);

1773 ià(
size
 > 
ırm
->
lim™
 || !
	`dump_wr™e
(ırm->
fe
, 
–f
, (*elf)))

1774 
’d_cÜedump
;

1776 
size
 +ğ(*
phdr4nÙe
);

1777 ià(
size
 > 
ırm
->
lim™


1778 || !
	`dump_wr™e
(
ırm
->
fe
, 
phdr4nÙe
, (*phdr4note)))

1779 
’d_cÜedump
;

1782 
vma
 = 
cu¼’t
->
mm
->
mm­
; vma; vm¨ğvma->
vm_Ãxt
) {

1783 
–f_phdr
 
phdr
;

1784 
size_t
 
sz
;

1786 
sz
 = 
vma
->
vm_’d
 - vma->
vm_¡¬t
;

1788 
phdr
.
p_ty³
 = 
PT_LOAD
;

1789 
phdr
.
p_off£t
 = 
off£t
;

1790 
phdr
.
p_vaddr
 = 
vma
->
vm_¡¬t
;

1791 
phdr
.
p_·ddr
 = 0;

1792 
phdr
.
p_fesz
 = 
	`maydump
(
vma
, 
ırm
->
mm_æags
è? 
sz
 : 0;

1793 
phdr
.
p_memsz
 = 
sz
;

1794 
off£t
 +ğ
phdr
.
p_fesz
;

1795 
phdr
.
p_æags
 = 
vma
->
vm_æags
 & 
VM_READ
 ? 
PF_R
 : 0;

1796 ià(
vma
->
vm_æags
 & 
VM_WRITE
)

1797 
phdr
.
p_æags
 |ğ
PF_W
;

1798 ià(
vma
->
vm_æags
 & 
VM_EXEC
)

1799 
phdr
.
p_æags
 |ğ
PF_X
;

1800 
phdr
.
p_®ign
 = 
ELF_EXEC_PAGESIZE
;

1802 
size
 +ğ(
phdr
);

1803 ià(
size
 > 
ırm
->
lim™


1804 || !
	`dump_wr™e
(
ırm
->
fe
, &
phdr
, (phdr)))

1805 
’d_cÜedump
;

1808 ià(!
	`–f_cÜe_wr™e_exŒa_phdrs
(
ırm
->
fe
, 
off£t
, &
size
, c´m->
lim™
))

1809 
’d_cÜedump
;

1812 
i
 = 0; i < 
numnÙe
; i++)

1813 ià(!
	`wr™’Ùe
(
nÙes
 + 
i
, 
ırm
->
fe
, &
foff£t
))

1814 
’d_cÜedump
;

1817 
	`li¡_fÜ_—ch
(
t
, &
th»ad_li¡
) {

1818 
–f_th»ad_¡©us
 *
tmp
 =

1819 
	`li¡_’Œy
(
t
, 
–f_th»ad_¡©us
, 
li¡
);

1821 
i
 = 0; i < 
tmp
->
num_nÙes
; i++)

1822 ià(!
	`wr™’Ùe
(&
tmp
->
nÙes
[
i
], 
ırm
->
fe
, &
foff£t
))

1823 
’d_cÜedump
;

1826 ià(!
	`dump_£ek
(
ırm
->
fe
, 
d©aoff
 - 
foff£t
))

1827 
’d_cÜedump
;

1829 ià(
	`–f_fdpic_dump_£gm’ts
(
ırm
->
fe
, &
size
, &ırm->
lim™
,

1830 
ırm
->
mm_æags
) < 0)

1831 
’d_cÜedump
;

1833 ià(!
	`–f_cÜe_wr™e_exŒa_d©a
(
ırm
->
fe
, &
size
, c´m->
lim™
))

1834 
’d_cÜedump
;

1836 ià(
e_phnum
 =ğ
PN_XNUM
) {

1837 
size
 +ğ(*
shdr4exŠum
);

1838 ià(
size
 > 
ırm
->
lim™


1839 || !
	`dump_wr™e
(
ırm
->
fe
, 
shdr4exŠum
,

1840 (*
shdr4exŠum
)))

1841 
’d_cÜedump
;

1844 ià(
ırm
->
fe
->
f_pos
 !ğ
off£t
) {

1846 
	`´štk
(
KERN_WARNING


1848 
ırm
->
fe
->
f_pos
, 
off£t
);

1851 
’d_cÜedump
:

1852 
	`£t_fs
(
fs
);

1854 
ş—nup
:

1855 !
	`li¡_em±y
(&
th»ad_li¡
)) {

1856 
li¡_h—d
 *
tmp
 = 
th»ad_li¡
.
Ãxt
;

1857 
	`li¡_d–
(
tmp
);

1858 
	`kä“
(
	`li¡_’Œy
(
tmp
, 
–f_th»ad_¡©us
, 
li¡
));

1860 
	`kä“
(
phdr4nÙe
);

1861 
	`kä“
(
–f
);

1862 
	`kä“
(
´¡©us
);

1863 
	`kä“
(
psšfo
);

1864 
	`kä“
(
nÙes
);

1865 
	`kä“
(
åu
);

1866 
	`kä“
(
shdr4exŠum
);

1867 #ifdeà
ELF_CORE_COPY_XFPREGS


1868 
	`kä“
(
xåu
);

1870  
has_dum³d
;

1871 #undeà
NUM_NOTES


1872 
	}
}

	@binfmt_em86.c

11 
	~<lšux/moduË.h
>

12 
	~<lšux/¡ršg.h
>

13 
	~<lšux/¡©.h
>

14 
	~<lšux/bšfmts.h
>

15 
	~<lšux/–f.h
>

16 
	~<lšux/š™.h
>

17 
	~<lšux/fs.h
>

18 
	~<lšux/fe.h
>

19 
	~<lšux/”ºo.h
>

22 
	#EM86_INTERP
 "/u¤/bš/em86"

	)

23 
	#EM86_I_NAME
 "em86"

	)

25 
	$lßd_em86
(
lšux_bš´m
 *
b´m
,
±_»gs
 *
»gs
)

27 *
š‹½
, *
i_Çme
, *
i_¬g
;

28 
fe
 * file;

29 
»tv®
;

30 
–fhdr
 
–f_ex
;

33 
–f_ex
 = *((
–fhdr
 *)
b´m
->
buf
);

35 ià(
	`memcmp
(
–f_ex
.
e_id’t
, 
ELFMAG
, 
SELFMAG
) != 0)

36  -
ENOEXEC
;

39 ià((
–f_ex
.
e_ty³
 !ğ
ET_EXEC
 &&ƒlf_ex.e_ty³ !ğ
ET_DYN
) ||

40 (!((
–f_ex
.
e_machše
 =ğ
EM_386
è|| (–f_ex.e_machš=ğ
EM_486
))) ||

41 (!
b´m
->
fe
->
f_İ
 || !b´m->fe->f_İ->
mm­
)) {

42  -
ENOEXEC
;

45 
b´m
->
»cursiÚ_d•th
++;

46 
	`®low_wr™e_acûss
(
b´m
->
fe
);

47 
	`åut
(
b´m
->
fe
);

48 
b´m
->
fe
 = 
NULL
;

53 
š‹½
 = 
EM86_INTERP
;

54 
i_Çme
 = 
EM86_I_NAME
;

55 
i_¬g
 = 
NULL
;

65 
	`»move_¬g_z”o
(
b´m
);

66 
»tv®
 = 
	`cİy_¡ršgs_k”Ãl
(1, &
b´m
->
f’ame
, bprm);

67 ià(
»tv®
 < 0) „etval;

68 
b´m
->
¬gc
++;

69 ià(
i_¬g
) {

70 
»tv®
 = 
	`cİy_¡ršgs_k”Ãl
(1, &
i_¬g
, 
b´m
);

71 ià(
»tv®
 < 0) „etval;

72 
b´m
->
¬gc
++;

74 
»tv®
 = 
	`cİy_¡ršgs_k”Ãl
(1, &
i_Çme
, 
b´m
);

75 ià(
»tv®
 < 0) „etval;

76 
b´m
->
¬gc
++;

83 
fe
 = 
	`İ’_exec
(
š‹½
);

84 ià(
	`IS_ERR
(
fe
))

85  
	`PTR_ERR
(
fe
);

87 
b´m
->
fe
 = file;

89 
»tv®
 = 
	`´•¬e_bš´m
(
b´m
);

90 ià(
»tv®
 < 0)

91  
»tv®
;

93  
	`£¬ch_bš¬y_hªdËr
(
b´m
, 
»gs
);

94 
	}
}

96 
lšux_bšfmt
 
	gem86_fÜm©
 = {

97 .
moduË
 = 
THIS_MODULE
,

98 .
	glßd_bš¬y
 = 
lßd_em86
,

101 
__š™
 
	$š™_em86_bšfmt
()

103  
	`»gi¡”_bšfmt
(&
em86_fÜm©
);

104 
	}
}

106 
__ex™
 
	$ex™_em86_bšfmt
()

108 
	`uÄegi¡”_bšfmt
(&
em86_fÜm©
);

109 
	}
}

111 
cÜe_š™ÿÎ
(
š™_em86_bšfmt
);

112 
moduË_ex™
(
ex™_em86_bšfmt
);

113 
MODULE_LICENSE
("GPL");

	@binfmt_flat.c

18 
	~<lšux/moduË.h
>

19 
	~<lšux/k”Ãl.h
>

20 
	~<lšux/sched.h
>

21 
	~<lšux/mm.h
>

22 
	~<lšux/mmª.h
>

23 
	~<lšux/”ºo.h
>

24 
	~<lšux/sigÇl.h
>

25 
	~<lšux/¡ršg.h
>

26 
	~<lšux/fs.h
>

27 
	~<lšux/fe.h
>

28 
	~<lšux/¡©.h
>

29 
	~<lšux/fú.h
>

30 
	~<lšux/±¿û.h
>

31 
	~<lšux/u£r.h
>

32 
	~<lšux/¦ab.h
>

33 
	~<lšux/bšfmts.h
>

34 
	~<lšux/³rsÚ®™y.h
>

35 
	~<lšux/š™.h
>

36 
	~<lšux/æ©.h
>

37 
	~<lšux/sysÿÎs.h
>

39 
	~<asm/by‹Üd”.h
>

40 
	~<asm/sy¡em.h
>

41 
	~<asm/uacûss.h
>

42 
	~<asm/uÇligÃd.h
>

43 
	~<asm/ÿcheæush.h
>

44 
	~<asm/·ge.h
>

49 
	#DEBUG
 1

	)

52 #ifdeà
DEBUG


53 
	#DBG_FLT
(
a
...è
	`´štk
×)

	)

55 
	#DBG_FLT
(
a
...)

	)

64 
	#FLAT_DATA_ALIGN
 (0x20)

	)

71 
	#FLAT_STACK_ALIGN
 
	`max_t
(, (*), 
ARCH_SLAB_MINALIGN
)

	)

73 
	#RELOC_FAILED
 0xff00ff01

	)

74 
	#UNLOADED_LIB
 0x7ff000fà

	)

76 
	slib_šfo
 {

78 
	m¡¬t_code
;

79 
	m¡¬t_d©a
;

80 
	m¡¬t_brk
;

81 
	m‹xt_Ën
;

82 
	m’Œy
;

83 
	mbud_d©e
;

84 
	mlßded
;

85 } 
	mlib_li¡
[
MAX_SHARED_LIBS
];

88 #ifdeà
CONFIG_BINFMT_SHARED_FLAT


89 
lßd_æ©_sh¬ed_lib¿ry
(
id
, 
lib_šfo
 *
p
);

92 
lßd_æ©_bš¬y
(
lšux_bš´m
 *, 
±_»gs
 * 
»gs
);

93 
æ©_cÜe_dump
(
cÜedump_·¿ms
 *
ırm
);

95 
lšux_bšfmt
 
	gæ©_fÜm©
 = {

96 .
moduË
 = 
THIS_MODULE
,

97 .
	glßd_bš¬y
 = 
lßd_æ©_bš¬y
,

98 .
	gcÜe_dump
 = 
æ©_cÜe_dump
,

99 .
	gmš_cÜedump
 = 
PAGE_SIZE


108 
	$æ©_cÜe_dump
(
cÜedump_·¿ms
 *
ırm
)

110 
	`´štk
("Process %s:%d„eceived signr %d‡nd should have core dumped\n",

111 
cu¼’t
->
comm
, cu¼’t->
pid
, (è
ırm
->
sigÄ
);

113 
	}
}

122 
	$ü—‹_æ©_bËs
(

123 
µ
,

124 
lšux_bš´m
 * 
b´m
)

126 *
¬gv
,*
’vp
;

127 * 
¥
;

128 * 
p
 = (*)
µ
;

129 
¬gc
 = 
b´m
->argc;

130 
’vc
 = 
b´m
->envc;

131 
	`unš™Ÿlized_v¬
(
dummy
);

133 
¥
 = (*)
p
;

134 
¥
 -ğ(
’vc
 + 
¬gc
 + 2è+ 1 + (
	`æ©_¬gvp_’vp_Ú_¡ack
() ? 2 : 0);

135 
¥
 = (*è(()¥ & -
FLAT_STACK_ALIGN
);

136 
¬gv
 = 
¥
 + 1 + (
	`æ©_¬gvp_’vp_Ú_¡ack
() ? 2 : 0);

137 
’vp
 = 
¬gv
 + (
¬gc
 + 1);

139 ià(
	`æ©_¬gvp_’vp_Ú_¡ack
()) {

140 
	`put_u£r
((è
’vp
, 
¥
 + 2);

141 
	`put_u£r
((è
¬gv
, 
¥
 + 1);

144 
	`put_u£r
(
¬gc
, 
¥
);

145 
cu¼’t
->
mm
->
¬g_¡¬t
 = (è
p
;

146 
¬gc
-->0) {

147 
	`put_u£r
((è
p
, 
¬gv
++);

149 
	`g‘_u£r
(
dummy
, 
p
);…++;

150 } 
dummy
);

152 
	`put_u£r
((è
NULL
, 
¬gv
);

153 
cu¼’t
->
mm
->
¬g_’d
 = cu¼’t->mm->
’v_¡¬t
 = (è
p
;

154 
’vc
-->0) {

155 
	`put_u£r
(()
p
, 
’vp
);ƒnvp++;

157 
	`g‘_u£r
(
dummy
, 
p
);…++;

158 } 
dummy
);

160 
	`put_u£r
((è
NULL
, 
’vp
);

161 
cu¼’t
->
mm
->
’v_’d
 = (è
p
;

162  ()
¥
;

163 
	}
}

167 #ifdeà
CONFIG_BINFMT_ZFLAT


169 
	~<lšux/zlib.h
>

171 
	#LBUFSIZE
 4000

	)

174 
	#ASCII_FLAG
 0x01

	)

175 
	#CONTINUATION
 0x02

	)

176 
	#EXTRA_FIELD
 0x04

	)

177 
	#ORIG_NAME
 0x08

	)

178 
	#COMMENT
 0x10

	)

179 
	#ENCRYPTED
 0x20

	)

180 
	#RESERVED
 0xC0

	)

182 
	$decom´ess_exec
(

183 
lšux_bš´m
 *
b´m
,

184 
off£t
,

185 *
d¡
,

186 
Ën
,

187 
fd
)

189 *
buf
;

190 
z_¡»am
 
¡rm
;

191 
loff_t
 
åos
;

192 
»t
, 
»tv®
;

194 
	`DBG_FLT
("decom´ess_exec(off£t=%x,buf=%x,Ën=%x)\n",()
off£t
, ()
d¡
, ()
Ën
);

196 
	`mem£t
(&
¡rm
, 0, (strm));

197 
¡rm
.
wÜk¥aû
 = 
	`km®loc
(
	`zlib_šæ©e_wÜk¥aûsize
(), 
GFP_KERNEL
);

198 ià(
¡rm
.
wÜk¥aû
 =ğ
NULL
) {

199 
	`DBG_FLT
("binfmt_flat:‚o memory for decompress workspace\n");

200  -
ENOMEM
;

202 
buf
 = 
	`km®loc
(
LBUFSIZE
, 
GFP_KERNEL
);

203 ià(
buf
 =ğ
NULL
) {

204 
	`DBG_FLT
("binfmt_flat:‚o memory for„ead buffer\n");

205 
»tv®
 = -
ENOMEM
;

206 
out_ä“
;

210 
åos
 = 
off£t
;

211 
»t
 = 
b´m
->
fe
->
f_İ
->
	`»ad
(b´m->fe, 
buf
, 
LBUFSIZE
, &
åos
);

213 
¡rm
.
Ãxt_š
 = 
buf
;

214 
¡rm
.
ava_š
 = 
»t
;

215 
¡rm
.
tÙ®_š
 = 0;

217 
»tv®
 = -
ENOEXEC
;

220 ià(
»t
 < 10) {

221 
	`DBG_FLT
("binfmt_flat: fileoo small?\n");

222 
out_ä“_buf
;

226 ià((
buf
[0] != 037) || ((buf[1] != 0213) && (buf[1] != 0236))) {

227 
	`DBG_FLT
("binfmt_flat: unknown compression magic?\n");

228 
out_ä“_buf
;

232 ià(
buf
[2] != 8) {

233 
	`DBG_FLT
("binfmt_flat: unknown compression method?\n");

234 
out_ä“_buf
;

237 ià((
buf
[3] & 
ENCRYPTED
è|| (buf[3] & 
CONTINUATION
) ||

238 (
buf
[3] & 
RESERVED
)) {

239 
	`DBG_FLT
("binfmt_flat: unknown flags?\n");

240 
out_ä“_buf
;

243 
»t
 = 10;

244 ià(
buf
[3] & 
EXTRA_FIELD
) {

245 
»t
 +ğ2 + 
buf
[10] + (buf[11] << 8);

246 ià(
	`uÆik–y
(
LBUFSIZE
 <ğ
»t
)) {

247 
	`DBG_FLT
("binfmt_flat: buffer overflow (EXTRA)?\n");

248 
out_ä“_buf
;

251 ià(
buf
[3] & 
ORIG_NAME
) {

252 
»t
 < 
LBUFSIZE
 && 
buf
[ret++] != 0)

254 ià(
	`uÆik–y
(
LBUFSIZE
 =ğ
»t
)) {

255 
	`DBG_FLT
("binfmt_flat: buffer overflow (ORIG_NAME)?\n");

256 
out_ä“_buf
;

259 ià(
buf
[3] & 
COMMENT
) {

260 
»t
 < 
LBUFSIZE
 && 
buf
[ret++] != 0)

262 ià(
	`uÆik–y
(
LBUFSIZE
 =ğ
»t
)) {

263 
	`DBG_FLT
("binfmt_flat: buffer overflow (COMMENT)?\n");

264 
out_ä“_buf
;

268 
¡rm
.
Ãxt_š
 +ğ
»t
;

269 
¡rm
.
ava_š
 -ğ
»t
;

271 
¡rm
.
Ãxt_out
 = 
d¡
;

272 
¡rm
.
ava_out
 = 
Ën
;

273 
¡rm
.
tÙ®_out
 = 0;

275 ià(
	`zlib_šæ©eIn™2
(&
¡rm
, -
MAX_WBITS
è!ğ
Z_OK
) {

276 
	`DBG_FLT
("binfmt_flat: zlib init failed?\n");

277 
out_ä“_buf
;

280 (
»t
 = 
	`zlib_šæ©e
(&
¡rm
, 
Z_NO_FLUSH
)è=ğ
Z_OK
) {

281 
»t
 = 
b´m
->
fe
->
f_İ
->
	`»ad
(b´m->fe, 
buf
, 
LBUFSIZE
, &
åos
);

282 ià(
»t
 <= 0)

284 
Ën
 -ğ
»t
;

286 
¡rm
.
Ãxt_š
 = 
buf
;

287 
¡rm
.
ava_š
 = 
»t
;

288 
¡rm
.
tÙ®_š
 = 0;

291 ià(
»t
 < 0) {

292 
	`DBG_FLT
("binfmt_flat: decompression failed (%d), %s\n",

293 
»t
, 
¡rm
.
msg
);

294 
out_zlib
;

297 
»tv®
 = 0;

298 
out_zlib
:

299 
	`zlib_šæ©eEnd
(&
¡rm
);

300 
out_ä“_buf
:

301 
	`kä“
(
buf
);

302 
out_ä“
:

303 
	`kä“
(
¡rm
.
wÜk¥aû
);

304  
»tv®
;

305 
	}
}

312 
	$ÿlc_»loc
(
r
, 
lib_šfo
 *
p
, 
curid
, 
š‹º®p
)

314 
addr
;

315 
id
;

316 
¡¬t_brk
;

317 
¡¬t_d©a
;

318 
‹xt_Ën
;

319 
¡¬t_code
;

321 #ifdeà
CONFIG_BINFMT_SHARED_FLAT


322 ià(
r
 == 0)

323 
id
 = 
curid
;

325 
id
 = (
r
 >> 24) & 0xff;

326 
r
 &= 0x00ffffff;

328 ià(
id
 >ğ
MAX_SHARED_LIBS
) {

329 
	`´štk
("BINFMT_FLAT:„eference 0x%xo shared†ibrary %d",

330 (è
r
, 
id
);

331 
çed
;

333 ià(
curid
 !ğ
id
) {

334 ià(
š‹º®p
) {

335 
	`´štk
("BINFMT_FLAT:„eloc‡ddress 0x%x‚ot in same module "

336 "(%d !ğ%d)", (è
r
, 
curid
, 
id
);

337 
çed
;

338 } iàĞ! 
p
->
lib_li¡
[
id
].
lßded
 &&

339 
	`IS_ERR_VALUE
(
	`lßd_æ©_sh¬ed_lib¿ry
(
id
, 
p
))) {

340 
	`´štk
("BINFMT_FLAT: faedØlßd†ib¿ry %d", 
id
);

341 
çed
;

344 ià(
p
->
lib_li¡
[
id
].
bud_d©e
 &&…->lib_li¡[
curid
].build_date &&

345 
p
->
lib_li¡
[
curid
].
bud_d©e
 <…->lib_li¡[
id
].build_date) {

346 
	`´štk
("BINFMT_FLAT:†ib¿ry %d i young”hª %d", 
id
, 
curid
);

347 
çed
;

351 
id
 = 0;

354 
¡¬t_brk
 = 
p
->
lib_li¡
[
id
].start_brk;

355 
¡¬t_d©a
 = 
p
->
lib_li¡
[
id
].start_data;

356 
¡¬t_code
 = 
p
->
lib_li¡
[
id
].start_code;

357 
‹xt_Ën
 = 
p
->
lib_li¡
[
id
].text_len;

359 ià(!
	`æ©_»loc_v®id
(
r
, 
¡¬t_brk
 - 
¡¬t_d©a
 + 
‹xt_Ën
)) {

360 
	`´štk
("BINFMT_FLAT:„eloc outside…rogram 0x%x (0 - 0x%x/0x%x)",

361 (è
r
,()(
¡¬t_brk
-
¡¬t_d©a
+
‹xt_Ën
),()text_len);

362 
çed
;

365 ià(
r
 < 
‹xt_Ën
)

366 
addr
 = 
r
 + 
¡¬t_code
;

368 
addr
 = 
r
 - 
‹xt_Ën
 + 
¡¬t_d©a
;

371 (
addr
);

373 
çed
:

374 
	`´štk
(", klšg %s!\n", 
cu¼’t
->
comm
);

375 
	`£nd_sig
(
SIGSEGV
, 
cu¼’t
, 0);

377  
RELOC_FAILED
;

378 
	}
}

382 
	$Şd_»loc
(
¾
)

384 #ifdeà
DEBUG


385 *
£gm’t
[] = { "TEXT", "DATA", "BSS", "*UNKNOWN*" };

387 
æ©_v2_»loc_t
 
r
;

388 *
±r
;

390 
r
.
v®ue
 = 
¾
;

391 #ià
	`defšed
(
CONFIG_COLDFIRE
)

392 
±r
 = (*è(
cu¼’t
->
mm
->
¡¬t_code
 + 
r
.
»loc
.
off£t
);

394 
±r
 = (*è(
cu¼’t
->
mm
->
¡¬t_d©a
 + 
r
.
»loc
.
off£t
);

397 #ifdeà
DEBUG


398 
	`´štk
("Relocation of variable‡t DATASEG+%x "

400 
r
.
»loc
.
off£t
, 
±r
, ()*±r, 
£gm’t
[r.»loc.
ty³
]);

403 
r
.
»loc
.
ty³
) {

404 
OLD_FLAT_RELOC_TYPE_TEXT
:

405 *
±r
 +ğ
cu¼’t
->
mm
->
¡¬t_code
;

407 
OLD_FLAT_RELOC_TYPE_DATA
:

408 *
±r
 +ğ
cu¼’t
->
mm
->
¡¬t_d©a
;

410 
OLD_FLAT_RELOC_TYPE_BSS
:

411 *
±r
 +ğ
cu¼’t
->
mm
->
’d_d©a
;

414 
	`´štk
("BINFMT_FLAT: UnknowÀ»loÿtiÚy³=%x\n", 
r
.
»loc
.
ty³
);

418 #ifdeà
DEBUG


419 
	`´štk
("R–oÿtiÚ beÿm%x\n", ()*
±r
);

421 
	}
}

425 
	$lßd_æ©_fe
(
lšux_bš´m
 * 
b´m
,

426 
lib_šfo
 *
libšfo
, 
id
, *
exŒa_¡ack
)

428 
æ©_hdr
 * 
hdr
;

429 
‹xos
 = 0, 
d©­os
 = 0, 
»suÉ
;

430 
»®d©a¡¬t
 = 0;

431 
‹xt_Ën
, 
d©a_Ën
, 
bss_Ën
, 
¡ack_Ën
, 
æags
;

432 
Ën
, 
memp
 = 0;

433 
memp_size
, 
exŒa
, 
¾im
;

434 *
»loc
 = 0, *
½
;

435 
šode
 *inode;

436 
i
, 
»v
, 
»locs
 = 0;

437 
loff_t
 
åos
;

438 
¡¬t_code
, 
’d_code
;

439 
»t
;

441 
hdr
 = ((
æ©_hdr
 *è
b´m
->
buf
);

442 
šode
 = 
b´m
->
fe
->
f_·th
.
d’Œy
->
d_šode
;

444 
‹xt_Ën
 = 
	`Áohl
(
hdr
->
d©a_¡¬t
);

445 
d©a_Ën
 = 
	`Áohl
(
hdr
->
d©a_’d
è-‚tohl(hdr->
d©a_¡¬t
);

446 
bss_Ën
 = 
	`Áohl
(
hdr
->
bss_’d
è-‚tohl(hdr->
d©a_’d
);

447 
¡ack_Ën
 = 
	`Áohl
(
hdr
->
¡ack_size
);

448 ià(
exŒa_¡ack
) {

449 
¡ack_Ën
 +ğ*
exŒa_¡ack
;

450 *
exŒa_¡ack
 = 
¡ack_Ën
;

452 
»locs
 = 
	`Áohl
(
hdr
->
»loc_couÁ
);

453 
æags
 = 
	`Áohl
(
hdr
->flags);

454 
»v
 = 
	`Áohl
(
hdr
->rev);

456 ià(
	`¡ºcmp
(
hdr
->
magic
, "bFLT", 4)) {

464 
»t
 = -
ENOEXEC
;

465 
”r
;

468 ià(
æags
 & 
FLAT_FLAG_KTRACE
)

469 
	`´štk
("BINFMT_FLAT: Lßdšg fe: %s\n", 
b´m
->
f’ame
);

471 ià(
»v
 !ğ
FLAT_VERSION
 &&„ev !ğ
OLD_FLAT_VERSION
) {

472 
	`´štk
("BINFMT_FLAT: bad flat file version 0x%x (supported "

474 
»v
, 
FLAT_VERSION
, 
OLD_FLAT_VERSION
);

475 
»t
 = -
ENOEXEC
;

476 
”r
;

480 ià(
»v
 =ğ
OLD_FLAT_VERSION
 && 
id
 != 0) {

481 
	`´štk
("BINFMT_FLAT: shared†ibraries‡re‚ot‡vailable before„ev 0x%x\n",

482 (è
FLAT_VERSION
);

483 
»t
 = -
ENOEXEC
;

484 
”r
;

491 ià(
»v
 =ğ
OLD_FLAT_VERSION
 && 
	`æ©_Şd_¿m_æag
(
æags
))

492 
æags
 = 
FLAT_FLAG_RAM
;

494 #iâdeà
CONFIG_BINFMT_ZFLAT


495 ià(
æags
 & (
FLAT_FLAG_GZIP
|
FLAT_FLAG_GZDATA
)) {

496 
	`´štk
("Support for ZFLATƒxecutables is‚otƒnabled.\n");

497 
»t
 = -
ENOEXEC
;

498 
”r
;

507 
¾im
 = 
	`¾im™
(
RLIMIT_DATA
);

508 ià(
¾im
 >ğ
RLIM_INFINITY
)

509 
¾im
 = ~0;

510 ià(
d©a_Ën
 + 
bss_Ën
 > 
¾im
) {

511 
»t
 = -
ENOMEM
;

512 
”r
;

516 ià(
id
 == 0) {

517 
»suÉ
 = 
	`æush_Şd_exec
(
b´m
);

518 ià(
»suÉ
) {

519 
»t
 = 
»suÉ
;

520 
”r
;

524 
	`£t_³rsÚ®™y
(
PER_LINUX_32BIT
);

525 
	`£tup_Ãw_exec
(
b´m
);

531 
exŒa
 = 
	`max_t
(, 
bss_Ën
 + 
¡ack_Ën
,

532 
»locs
 * ());

539 ià((
æags
 & (
FLAT_FLAG_RAM
|
FLAT_FLAG_GZIP
)) == 0) {

544 
	`DBG_FLT
("BINFMT_FLAT: ROM mapping of file (we hope)\n");

546 
	`down_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

547 
‹xos
 = 
	`do_mm­
(
b´m
->
fe
, 0, 
‹xt_Ën
, 
PROT_READ
|
PROT_EXEC
,

548 
MAP_PRIVATE
|
MAP_EXECUTABLE
, 0);

549 
	`up_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

550 ià(!
‹xos
 || 
	`IS_ERR_VALUE
(textpos)) {

551 ià(!
‹xos
)

552 
‹xos
 = (è-
ENOMEM
;

553 
	`´štk
("UÇbËØmm­…roûs ‹xt,ƒ¼nØ%d\n", ()-
‹xos
);

554 
»t
 = 
‹xos
;

555 
”r
;

558 
Ën
 = 
d©a_Ën
 + 
exŒa
 + 
MAX_SHARED_LIBS
 * ();

559 
Ën
 = 
	`PAGE_ALIGN
(len);

560 
	`down_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

561 
»®d©a¡¬t
 = 
	`do_mm­
(0, 0, 
Ën
,

562 
PROT_READ
|
PROT_WRITE
|
PROT_EXEC
, 
MAP_PRIVATE
, 0);

563 
	`up_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

565 ià(
»®d©a¡¬t
 =ğ0 || 
	`IS_ERR_VALUE
(realdatastart)) {

566 ià(!
»®d©a¡¬t
)

567 
»®d©a¡¬t
 = (è-
ENOMEM
;

568 
	`´štk
("Unableo‡llocate RAM for…rocess data,ƒrrno %d\n",

569 ()-
»®d©a¡¬t
);

570 
	`do_munm­
(
cu¼’t
->
mm
, 
‹xos
, 
‹xt_Ën
);

571 
»t
 = 
»®d©a¡¬t
;

572 
”r
;

574 
d©­os
 = 
	`ALIGN
(
»®d©a¡¬t
 +

575 
MAX_SHARED_LIBS
 * (),

576 
FLAT_DATA_ALIGN
);

578 
	`DBG_FLT
("BINFMT_FLAT: Allocated data+bss+stack (%d bytes): %x\n",

579 ()(
d©a_Ën
 + 
bss_Ën
 + 
¡ack_Ën
), ()
d©­os
);

581 
åos
 = 
	`Áohl
(
hdr
->
d©a_¡¬t
);

582 #ifdeà
CONFIG_BINFMT_ZFLAT


583 ià(
æags
 & 
FLAT_FLAG_GZDATA
) {

584 
»suÉ
 = 
	`decom´ess_exec
(
b´m
, 
åos
, (*è
d©­os
,

585 
d©a_Ën
 + (
»locs
 * ()), 0);

589 
»suÉ
 = 
b´m
->
fe
->
f_İ
->
	`»ad
(b´m->fe, (*è
d©­os
,

590 
d©a_Ën
 + (
»locs
 * ()), &
åos
);

592 ià(
	`IS_ERR_VALUE
(
»suÉ
)) {

593 
	`´štk
("UÇbËØ»ad d©a+bss,ƒ¼nØ%d\n", ()-
»suÉ
);

594 
	`do_munm­
(
cu¼’t
->
mm
, 
‹xos
, 
‹xt_Ën
);

595 
	`do_munm­
(
cu¼’t
->
mm
, 
»®d©a¡¬t
, 
Ën
);

596 
»t
 = 
»suÉ
;

597 
”r
;

600 
»loc
 = (*è(
d©­os
+(
	`Áohl
(
hdr
->
»loc_¡¬t
)-
‹xt_Ën
));

601 
memp
 = 
»®d©a¡¬t
;

602 
memp_size
 = 
Ën
;

605 
Ën
 = 
‹xt_Ën
 + 
d©a_Ën
 + 
exŒa
 + 
MAX_SHARED_LIBS
 * ();

606 
Ën
 = 
	`PAGE_ALIGN
(len);

607 
	`down_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

608 
‹xos
 = 
	`do_mm­
(0, 0, 
Ën
,

609 
PROT_READ
 | 
PROT_EXEC
 | 
PROT_WRITE
, 
MAP_PRIVATE
, 0);

610 
	`up_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

612 ià(!
‹xos
 || 
	`IS_ERR_VALUE
(textpos)) {

613 ià(!
‹xos
)

614 
‹xos
 = (è-
ENOMEM
;

615 
	`´štk
("Unableo‡llocate RAM for…rocessext/data,ƒrrno %d\n",

616 ()-
‹xos
);

617 
»t
 = 
‹xos
;

618 
”r
;

621 
»®d©a¡¬t
 = 
‹xos
 + 
	`Áohl
(
hdr
->
d©a_¡¬t
);

622 
d©­os
 = 
	`ALIGN
(
»®d©a¡¬t
 +

623 
MAX_SHARED_LIBS
 * (),

624 
FLAT_DATA_ALIGN
);

626 
»loc
 = (*)

627 (
d©­os
 + (
	`Áohl
(
hdr
->
»loc_¡¬t
è- 
‹xt_Ën
));

628 
memp
 = 
‹xos
;

629 
memp_size
 = 
Ën
;

630 #ifdeà
CONFIG_BINFMT_ZFLAT


634 ià(
æags
 & 
FLAT_FLAG_GZIP
) {

635 
»suÉ
 = 
	`decom´ess_exec
(
b´m
,  (
æ©_hdr
),

636 (((*è
‹xos
è+  (
æ©_hdr
)),

637 (
‹xt_Ën
 + 
d©a_Ën
 + (
»locs
 * ())

638 -  (
æ©_hdr
)),

640 
	`memmove
((*è
d©­os
, (*è
»®d©a¡¬t
,

641 
d©a_Ën
 + (
»locs
 * ()));

642 } ià(
æags
 & 
FLAT_FLAG_GZDATA
) {

643 
åos
 = 0;

644 
»suÉ
 = 
b´m
->
fe
->
f_İ
->
	`»ad
(bprm->file,

645 (*è
‹xos
, 
‹xt_Ën
, &
åos
);

646 ià(!
	`IS_ERR_VALUE
(
»suÉ
))

647 
»suÉ
 = 
	`decom´ess_exec
(
b´m
, 
‹xt_Ën
, (*è
d©­os
,

648 
d©a_Ën
 + (
»locs
 * ()), 0);

653 
åos
 = 0;

654 
»suÉ
 = 
b´m
->
fe
->
f_İ
->
	`»ad
(bprm->file,

655 (*è
‹xos
, 
‹xt_Ën
, &
åos
);

656 ià(!
	`IS_ERR_VALUE
(
»suÉ
)) {

657 
åos
 = 
	`Áohl
(
hdr
->
d©a_¡¬t
);

658 
»suÉ
 = 
b´m
->
fe
->
f_İ
->
	`»ad
(b´m->fe, (*è
d©­os
,

659 
d©a_Ën
 + (
»locs
 * ()), &
åos
);

662 ià(
	`IS_ERR_VALUE
(
»suÉ
)) {

663 
	`´štk
("UÇbËØ»ad code+d©a+bss,ƒ¼nØ%d\n",()-
»suÉ
);

664 
	`do_munm­
(
cu¼’t
->
mm
, 
‹xos
, 
‹xt_Ën
 + 
d©a_Ën
 + 
exŒa
 +

665 
MAX_SHARED_LIBS
 * ());

666 
»t
 = 
»suÉ
;

667 
”r
;

671 ià(
æags
 & 
FLAT_FLAG_KTRACE
)

672 
	`´štk
("Mapping is %x, Entry…oint is %x, data_start is %x\n",

673 ()
‹xos
, 0x00ffffff&
	`Áohl
(
hdr
->
’Œy
),‚tohl(hdr->
d©a_¡¬t
));

676 
¡¬t_code
 = 
‹xos
 +  (
æ©_hdr
);

677 
’d_code
 = 
‹xos
 + 
‹xt_Ën
;

678 ià(
id
 == 0) {

679 
cu¼’t
->
mm
->
¡¬t_code
 = start_code;

680 
cu¼’t
->
mm
->
’d_code
 =ƒnd_code;

681 
cu¼’t
->
mm
->
¡¬t_d©a
 = 
d©­os
;

682 
cu¼’t
->
mm
->
’d_d©a
 = 
d©­os
 + 
d©a_Ën
;

690 
cu¼’t
->
mm
->
¡¬t_brk
 = 
d©­os
 + 
d©a_Ën
 + 
bss_Ën
;

691 
cu¼’t
->
mm
->
brk
 = (cu¼’t->mm->
¡¬t_brk
 + 3) & ~3;

692 
cu¼’t
->
mm
->
cÚ‹xt
.
’d_brk
 = 
memp
 + 
memp_size
 - 
¡ack_Ën
;

695 ià(
æags
 & 
FLAT_FLAG_KTRACE
)

696 
	`´štk
("%s %s: TEXT=%x-%x DATA=%x-%x BSS=%x-%x\n",

697 
id
 ? "Lib" : "Lßd", 
b´m
->
f’ame
,

698 (è
¡¬t_code
, (è
’d_code
,

699 (è
d©­os
,

700 (è(
d©­os
 + 
d©a_Ën
),

701 (è(
d©­os
 + 
d©a_Ën
),

702 (è(((
d©­os
 + 
d©a_Ën
 + 
bss_Ën
) + 3) & ~3));

704 
‹xt_Ën
 -ğ(
æ©_hdr
);

707 
libšfo
->
lib_li¡
[
id
].
¡¬t_code
 = start_code;

708 
libšfo
->
lib_li¡
[
id
].
¡¬t_d©a
 = 
d©­os
;

709 
libšfo
->
lib_li¡
[
id
].
¡¬t_brk
 = 
d©­os
 + 
d©a_Ën
 + 
bss_Ën
;

710 
libšfo
->
lib_li¡
[
id
].
‹xt_Ën
 =ext_len;

711 
libšfo
->
lib_li¡
[
id
].
lßded
 = 1;

712 
libšfo
->
lib_li¡
[
id
].
’Œy
 = (0x00fffffà& 
	`Áohl
(
hdr
->’Œy)è+ 
‹xos
;

713 
libšfo
->
lib_li¡
[
id
].
bud_d©e
 = 
	`Áohl
(
hdr
->build_date);

727 ià(
æags
 & 
FLAT_FLAG_GOTPIC
) {

728 
½
 = (*)
d©­os
; *rp != 0xffffffff;„p++) {

729 
addr
;

730 ià(*
½
) {

731 
addr
 = 
	`ÿlc_»loc
(*
½
, 
libšfo
, 
id
, 0);

732 ià(
addr
 =ğ
RELOC_FAILED
) {

733 
»t
 = -
ENOEXEC
;

734 
”r
;

736 *
½
 = 
addr
;

752 ià(
»v
 > 
OLD_FLAT_VERSION
) {

753 
³rsi¡’t
 = 0;

754 
i
=0; i < 
»locs
; i++) {

755 
addr
, 
»lv®
;

760 
»lv®
 = 
	`Áohl
(
»loc
[
i
]);

761 ià(
	`æ©_£t_³rsi¡’t
 (
»lv®
, &
³rsi¡’t
))

763 
addr
 = 
	`æ©_g‘_»loÿ‹_addr
(
»lv®
);

764 
½
 = (*è
	`ÿlc_»loc
(
addr
, 
libšfo
, 
id
, 1);

765 ià(
½
 =ğ(*)
RELOC_FAILED
) {

766 
»t
 = -
ENOEXEC
;

767 
”r
;

771 
addr
 = 
	`æ©_g‘_addr_äom_½
(
½
, 
»lv®
, 
æags
,

772 &
³rsi¡’t
);

773 ià(
addr
 != 0) {

778 ià((
æags
 & 
FLAT_FLAG_GOTPIC
) == 0)

779 
addr
 = 
	`Áohl
(addr);

780 
addr
 = 
	`ÿlc_»loc
×ddr, 
libšfo
, 
id
, 0);

781 ià(
addr
 =ğ
RELOC_FAILED
) {

782 
»t
 = -
ENOEXEC
;

783 
”r
;

787 
	`æ©_put_addr_©_½
(
½
, 
addr
, 
»lv®
);

791 
i
=0; i < 
»locs
; i++)

792 
	`Şd_»loc
(
	`Áohl
(
»loc
[
i
]));

795 
	`æush_iÿche_¿nge
(
¡¬t_code
, 
’d_code
);

798 
	`mem£t
((*)(
d©­os
 + 
d©a_Ën
), 0, 
bss_Ën
 +

799 (
memp
 + 
memp_size
 - 
¡ack_Ën
 -

800 
libšfo
->
lib_li¡
[
id
].
¡¬t_brk
) +

801 
¡ack_Ën
);

804 
”r
:

805  
»t
;

806 
	}
}

810 #ifdeà
CONFIG_BINFMT_SHARED_FLAT


817 
	$lßd_æ©_sh¬ed_lib¿ry
(
id
, 
lib_šfo
 *
libs
)

819 
lšux_bš´m
 
b´m
;

820 
»s
;

821 
buf
[16];

823 
	`mem£t
(&
b´m
, 0, (bprm));

826 
	`¥rštf
(
buf
, "/lib/lib%d.so", 
id
);

829 
b´m
.
f’ame
 = 
buf
;

830 
b´m
.
fe
 = 
	`İ’_exec
(b´m.
f’ame
);

831 
»s
 = 
	`PTR_ERR
(
b´m
.
fe
);

832 ià(
	`IS_ERR
(
b´m
.
fe
))

833  
»s
;

835 
b´m
.
üed
 = 
	`´•¬e_exec_üeds
();

836 
»s
 = -
ENOMEM
;

837 ià(!
b´m
.
üed
)

838 
out
;

844 
b´m
.
üed_´•¬ed
 = 1;

846 
»s
 = 
	`´•¬e_bš´m
(&
b´m
);

848 ià(!
	`IS_ERR_VALUE
(
»s
))

849 
»s
 = 
	`lßd_æ©_fe
(&
b´m
, 
libs
, 
id
, 
NULL
);

851 
	`abÜt_üeds
(
b´m
.
üed
);

853 
out
:

854 
	`®low_wr™e_acûss
(
b´m
.
fe
);

855 
	`åut
(
b´m
.
fe
);

857 (
»s
);

858 
	}
}

868 
	$lßd_æ©_bš¬y
(
lšux_bš´m
 * 
b´m
, 
±_»gs
 * 
»gs
)

870 
lib_šfo
 
libšfo
;

871 
p
 = 
b´m
->p;

872 
¡ack_Ën
;

873 
¡¬t_addr
;

874 *
¥
;

875 
»s
;

876 
i
, 
j
;

878 
	`mem£t
(&
libšfo
, 0, (libinfo));

886 
	#TOP_OF_ARGS
 (
PAGE_SIZE
 * 
MAX_ARG_PAGES
 - (*))

	)

887 
¡ack_Ën
 = 
TOP_OF_ARGS
 - 
b´m
->
p
;

888 
¡ack_Ën
 +ğ(
b´m
->
¬gc
 + 1) * (*);

889 
¡ack_Ën
 +ğ(
b´m
->
’vc
 + 1) * (*);

890 
¡ack_Ën
 +ğ
FLAT_STACK_ALIGN
 - 1;

892 
»s
 = 
	`lßd_æ©_fe
(
b´m
, &
libšfo
, 0, &
¡ack_Ën
);

893 ià(
	`IS_ERR_VALUE
(
»s
))

894  
»s
;

897 
i
=0; i<
MAX_SHARED_LIBS
; i++)

898 ià(
libšfo
.
lib_li¡
[
i
].
lßded
)

899 
j
=0; j<
MAX_SHARED_LIBS
; j++)

900 (-(
j
+1))[(*)(
libšfo
.
lib_li¡
[
i
].
¡¬t_d©a
)] =

901 (
libšfo
.
lib_li¡
[
j
].
lßded
)?

902 
libšfo
.
lib_li¡
[
j
].
¡¬t_d©a
:
UNLOADED_LIB
;

904 
	`š¡®l_exec_üeds
(
b´m
);

905 
cu¼’t
->
æags
 &ğ~
PF_FORKNOEXEC
;

907 
	`£t_bšfmt
(&
æ©_fÜm©
);

909 
p
 = ((
cu¼’t
->
mm
->
cÚ‹xt
.
’d_brk
 + 
¡ack_Ën
 + 3) & ~3) - 4;

910 
	`DBG_FLT
("p=%x\n", ()
p
);

913 
i
 = 
TOP_OF_ARGS
 - 1; i >ğ
b´m
->
p
; i--)

914 * (*è--
p
 =

915 ((*è
	`·ge_add»ss
(
b´m
->
·ge
[
i
/
PAGE_SIZE
]))[i % PAGE_SIZE];

917 
¥
 = (*è
	`ü—‹_æ©_bËs
(
p
, 
b´m
);

923 
¡¬t_addr
 = 
libšfo
.
lib_li¡
[0].
’Œy
;

925 #ifdeà
CONFIG_BINFMT_SHARED_FLAT


926 
i
 = 
MAX_SHARED_LIBS
-1; i>0; i--) {

927 ià(
libšfo
.
lib_li¡
[
i
].
lßded
) {

929 --
¥
; 
	`put_u£r
(
¡¬t_addr
, sp);

930 
¡¬t_addr
 = 
libšfo
.
lib_li¡
[
i
].
’Œy
;

936 
cu¼’t
->
mm
->
¡¬t_¡ack
 = ()
¥
;

938 #ifdeà
FLAT_PLAT_INIT


939 
	`FLAT_PLAT_INIT
(
»gs
);

941 
	`DBG_FLT
("start_thread(regs=0x%x,ƒntry=0x%x, start_stack=0x%x)\n",

942 ()
»gs
, ()
¡¬t_addr
, ()
cu¼’t
->
mm
->
¡¬t_¡ack
);

944 
	`¡¬t_th»ad
(
»gs
, 
¡¬t_addr
, 
cu¼’t
->
mm
->
¡¬t_¡ack
);

947 
	}
}

951 
__š™
 
	$š™_æ©_bšfmt
()

953  
	`»gi¡”_bšfmt
(&
æ©_fÜm©
);

954 
	}
}

958 
cÜe_š™ÿÎ
(
š™_æ©_bšfmt
);

	@binfmt_misc.c

19 
	~<lšux/moduË.h
>

20 
	~<lšux/š™.h
>

21 
	~<lšux/sched.h
>

22 
	~<lšux/bšfmts.h
>

23 
	~<lšux/¦ab.h
>

24 
	~<lšux/ùy³.h
>

25 
	~<lšux/fe.h
>

26 
	~<lšux/·gem­.h
>

27 
	~<lšux/Çmei.h
>

28 
	~<lšux/mouÁ.h
>

29 
	~<lšux/sysÿÎs.h
>

30 
	~<lšux/fs.h
>

32 
	~<asm/uacûss.h
>

35 
	mVERBOSE_STATUS
 = 1

38 
LIST_HEAD
(
’Œ›s
);

39 
	g’abËd
 = 1;

41 ’um {
	mEÇbËd
, 
	mMagic
};

42 
	#MISC_FMT_PRESERVE_ARGV0
 (1<<31)

	)

43 
	#MISC_FMT_OPEN_BINARY
 (1<<30)

	)

44 
	#MISC_FMT_CREDENTIALS
 (1<<29)

	)

47 
li¡_h—d
 
	mli¡
;

48 
	mæags
;

49 
	moff£t
;

50 
	msize
;

51 *
	mmagic
;

52 *
	mmask
;

53 *
	mš‹½»‹r
;

54 *
	mÇme
;

55 
d’Œy
 *
	md’Œy
;

56 } 
	tNode
;

58 
DEFINE_RWLOCK
(
’Œ›s_lock
);

59 
fe_sy¡em_ty³
 
	gbm_fs_ty³
;

60 
vfsmouÁ
 *
	gbm_mÁ
;

61 
	g’Œy_couÁ
;

68 
Node
 *
	$check_fe
(
lšux_bš´m
 *
b´m
)

70 *
p
 = 
	`¡¼chr
(
b´m
->
š‹½
, '.');

71 
li¡_h—d
 *
l
;

73 
	`li¡_fÜ_—ch
(
l
, &
’Œ›s
) {

74 
Node
 *
e
 = 
	`li¡_’Œy
(
l
, Node, 
li¡
);

75 *
s
;

76 
j
;

78 ià(!
	`‹¡_b™
(
EÇbËd
, &
e
->
æags
))

81 ià(!
	`‹¡_b™
(
Magic
, &
e
->
æags
)) {

82 ià(
p
 && !
	`¡rcmp
(
e
->
magic
,… + 1))

83  
e
;

87 
s
 = 
b´m
->
buf
 + 
e
->
off£t
;

88 ià(
e
->
mask
) {

89 
j
 = 0; j < 
e
->
size
; j++)

90 ià((*
s
++ ^ 
e
->
magic
[
j
]è&ƒ->
mask
[j])

93 
j
 = 0; j < 
e
->
size
; j++)

94 ià((*
s
++ ^ 
e
->
magic
[
j
]))

97 ià(
j
 =ğ
e
->
size
)

98  
e
;

100  
NULL
;

101 
	}
}

106 
	$lßd_misc_bš¬y
(
lšux_bš´m
 *
b´m
, 
±_»gs
 *
»gs
)

108 
Node
 *
fmt
;

109 
fe
 * 
š‹½_fe
 = 
NULL
;

110 
šame
[
BINPRM_BUF_SIZE
];

111 cÚ¡ *
šame_addr
 = 
šame
;

112 
»tv®
;

113 
fd_bš¬y
 = -1;

115 
»tv®
 = -
ENOEXEC
;

116 ià(!
’abËd
)

117 
_»t
;

119 
»tv®
 = -
ENOEXEC
;

120 ià(
b´m
->
»cursiÚ_d•th
 > 
BINPRM_MAX_RECURSION
)

121 
_»t
;

124 
	`»ad_lock
(&
’Œ›s_lock
);

125 
fmt
 = 
	`check_fe
(
b´m
);

126 ià(
fmt
)

127 
	`¡¾ıy
(
šame
, 
fmt
->
š‹½»‹r
, 
BINPRM_BUF_SIZE
);

128 
	`»ad_uÆock
(&
’Œ›s_lock
);

129 ià(!
fmt
)

130 
_»t
;

132 ià(!(
fmt
->
æags
 & 
MISC_FMT_PRESERVE_ARGV0
)) {

133 
»tv®
 = 
	`»move_¬g_z”o
(
b´m
);

134 ià(
»tv®
)

135 
_»t
;

138 ià(
fmt
->
æags
 & 
MISC_FMT_OPEN_BINARY
) {

143 
fd_bš¬y
 = 
	`g‘_unu£d_fd
();

144 ià(
fd_bš¬y
 < 0) {

145 
»tv®
 = 
fd_bš¬y
;

146 
_»t
;

148 
	`fd_š¡®l
(
fd_bš¬y
, 
b´m
->
fe
);

152 
	`would_dump
(
b´m
, b´m->
fe
);

154 
	`®low_wr™e_acûss
(
b´m
->
fe
);

155 
b´m
->
fe
 = 
NULL
;

158 
b´m
->
š‹½_æags
 |ğ
BINPRM_FLAGS_EXECFD
;

159 
b´m
->
š‹½_d©a
 = 
fd_bš¬y
;

162 
	`®low_wr™e_acûss
(
b´m
->
fe
);

163 
	`åut
(
b´m
->
fe
);

164 
b´m
->
fe
 = 
NULL
;

167 
»tv®
 = 
	`cİy_¡ršgs_k”Ãl
 (1, &
b´m
->
š‹½
, bprm);

168 ià(
»tv®
 < 0)

169 
_”rÜ
;

170 
b´m
->
¬gc
++;

173 
»tv®
 = 
	`cİy_¡ršgs_k”Ãl
 (1, &
šame_addr
, 
b´m
);

174 ià(
»tv®
 < 0)

175 
_”rÜ
;

176 
b´m
->
¬gc
 ++;

178 
b´m
->
š‹½
 = 
šame
;

180 
š‹½_fe
 = 
	`İ’_exec
 (
šame
);

181 
»tv®
 = 
	`PTR_ERR
 (
š‹½_fe
);

182 ià(
	`IS_ERR
 (
š‹½_fe
))

183 
_”rÜ
;

185 
b´m
->
fe
 = 
š‹½_fe
;

186 ià(
fmt
->
æags
 & 
MISC_FMT_CREDENTIALS
) {

191 
	`mem£t
(
b´m
->
buf
, 0, 
BINPRM_BUF_SIZE
);

192 
»tv®
 = 
	`k”Ãl_»ad
(
b´m
->
fe
, 0, b´m->
buf
, 
BINPRM_BUF_SIZE
);

194 
»tv®
 = 
	`´•¬e_bš´m
 (
b´m
);

196 ià(
»tv®
 < 0)

197 
_”rÜ
;

199 
b´m
->
»cursiÚ_d•th
++;

201 
»tv®
 = 
	`£¬ch_bš¬y_hªdËr
 (
b´m
, 
»gs
);

202 ià(
»tv®
 < 0)

203 
_”rÜ
;

205 
_»t
:

206  
»tv®
;

207 
_”rÜ
:

208 ià(
fd_bš¬y
 > 0)

209 
	`sys_şo£
(
fd_bš¬y
);

210 
b´m
->
š‹½_æags
 = 0;

211 
b´m
->
š‹½_d©a
 = 0;

212 
_»t
;

213 
	}
}

223 *
	$sÿÇrg
(*
s
, 
d–
)

225 
c
;

227 (
c
 = *
s
++è!ğ
d–
) {

228 ià(
c
 =ğ'\\' && *
s
 == 'x') {

229 
s
++;

230 ià(!
	`isxdig™
(*
s
++))

231  
NULL
;

232 ià(!
	`isxdig™
(*
s
++))

233  
NULL
;

236  
s
;

237 
	}
}

239 
	$unquÙe
(*
äom
)

241 
c
 = 0, *
s
 = 
äom
, *
p
 = from;

243 (
c
 = *
s
++) != '\0') {

244 ià(
c
 =ğ'\\' && *
s
 == 'x') {

245 
s
++;

246 
c
 = 
	`touµ”
(*
s
++);

247 *
p
 = (
c
 - (
	`isdig™
(c) ? '0' : 'A' - 10)) << 4;

248 
c
 = 
	`touµ”
(*
s
++);

249 *
p
++ |ğ
c
 - (
	`isdig™
(c) ? '0' : 'A' - 10);

252 *
p
++ = 
c
;

254  
p
 - 
äom
;

255 
	}
}

257 * 
	$check_¥ecŸl_æags
 (* 
sfs
, 
Node
 * 
e
)

259 * 
p
 = 
sfs
;

260 
cÚt
 = 1;

263 
cÚt
) {

264 *
p
) {

266 
p
++;

267 
e
->
æags
 |ğ
MISC_FMT_PRESERVE_ARGV0
;

270 
p
++;

271 
e
->
æags
 |ğ
MISC_FMT_OPEN_BINARY
;

274 
p
++;

277 
e
->
æags
 |ğ(
MISC_FMT_CREDENTIALS
 |

278 
MISC_FMT_OPEN_BINARY
);

281 
cÚt
 = 0;

285  
p
;

286 
	}
}

292 
Node
 *
	$ü—‹_’Œy
(cÚ¡ 
__u£r
 *
bufãr
, 
size_t
 
couÁ
)

294 
Node
 *
e
;

295 
memsize
, 
”r
;

296 *
buf
, *
p
;

297 
d–
;

300 
”r
 = -
EINVAL
;

301 ià((
couÁ
 < 11) || (count > 256))

302 
out
;

304 
”r
 = -
ENOMEM
;

305 
memsize
 = (
Node
è+ 
couÁ
 + 8;

306 
e
 = 
	`km®loc
(
memsize
, 
GFP_USER
);

307 ià(!
e
)

308 
out
;

310 
p
 = 
buf
 = (*)
e
 + (
Node
);

312 
	`mem£t
(
e
, 0, (
Node
));

313 ià(
	`cİy_äom_u£r
(
buf
, 
bufãr
, 
couÁ
))

314 
EçuÉ
;

316 
d–
 = *
p
++;

318 
	`mem£t
(
buf
+
couÁ
, 
d–
, 8);

320 
e
->
Çme
 = 
p
;

321 
p
 = 
	`¡rchr
Õ, 
d–
);

322 ià(!
p
)

323 
Ešv®
;

324 *
p
++ = '\0';

325 ià(!
e
->
Çme
[0] ||

326 !
	`¡rcmp
(
e
->
Çme
, ".") ||

327 !
	`¡rcmp
(
e
->
Çme
, "..") ||

328 
	`¡rchr
(
e
->
Çme
, '/'))

329 
Ešv®
;

330 *
p
++) {

331 'E': 
e
->
æags
 = 1<<
EÇbËd
; ;

332 'M': 
e
->
æags
 = (1<<
EÇbËd
è| (1<<
Magic
); ;

333 : 
Ešv®
;

335 ià(*
p
++ !ğ
d–
)

336 
Ešv®
;

337 ià(
	`‹¡_b™
(
Magic
, &
e
->
æags
)) {

338 *
s
 = 
	`¡rchr
(
p
, 
d–
);

339 ià(!
s
)

340 
Ešv®
;

341 *
s
++ = '\0';

342 
e
->
off£t
 = 
	`sim¶e_¡¹oul
(
p
, &p, 10);

343 ià(*
p
++)

344 
Ešv®
;

345 
e
->
magic
 = 
p
;

346 
p
 = 
	`sÿÇrg
Õ, 
d–
);

347 ià(!
p
)

348 
Ešv®
;

349 
p
[-1] = '\0';

350 ià(!
e
->
magic
[0])

351 
Ešv®
;

352 
e
->
mask
 = 
p
;

353 
p
 = 
	`sÿÇrg
Õ, 
d–
);

354 ià(!
p
)

355 
Ešv®
;

356 
p
[-1] = '\0';

357 ià(!
e
->
mask
[0])

358 
e
->
mask
 = 
NULL
;

359 
e
->
size
 = 
	`unquÙe
Ó->
magic
);

360 ià(
e
->
mask
 && 
	`unquÙe
Ó->maskè!ğe->
size
)

361 
Ešv®
;

362 ià(
e
->
size
 +ƒ->
off£t
 > 
BINPRM_BUF_SIZE
)

363 
Ešv®
;

365 
p
 = 
	`¡rchr
Õ, 
d–
);

366 ià(!
p
)

367 
Ešv®
;

368 *
p
++ = '\0';

369 
e
->
magic
 = 
p
;

370 
p
 = 
	`¡rchr
Õ, 
d–
);

371 ià(!
p
)

372 
Ešv®
;

373 *
p
++ = '\0';

374 ià(!
e
->
magic
[0] || 
	`¡rchr
(e->magic, '/'))

375 
Ešv®
;

376 
p
 = 
	`¡rchr
Õ, 
d–
);

377 ià(!
p
)

378 
Ešv®
;

379 *
p
++ = '\0';

381 
e
->
š‹½»‹r
 = 
p
;

382 
p
 = 
	`¡rchr
Õ, 
d–
);

383 ià(!
p
)

384 
Ešv®
;

385 *
p
++ = '\0';

386 ià(!
e
->
š‹½»‹r
[0])

387 
Ešv®
;

390 
p
 = 
	`check_¥ecŸl_æags
 (p, 
e
);

392 ià(*
p
 == '\n')

393 
p
++;

394 ià(
p
 !ğ
buf
 + 
couÁ
)

395 
Ešv®
;

396  
e
;

398 
out
:

399  
	`ERR_PTR
(
”r
);

401 
EçuÉ
:

402 
	`kä“
(
e
);

403  
	`ERR_PTR
(-
EFAULT
);

404 
Ešv®
:

405 
	`kä“
(
e
);

406  
	`ERR_PTR
(-
EINVAL
);

407 
	}
}

413 
	$·r£_commªd
(cÚ¡ 
__u£r
 *
bufãr
, 
size_t
 
couÁ
)

415 
s
[4];

417 ià(!
couÁ
)

419 ià(
couÁ
 > 3)

420  -
EINVAL
;

421 ià(
	`cİy_äom_u£r
(
s
, 
bufãr
, 
couÁ
))

422  -
EFAULT
;

423 ià(
s
[
couÁ
-1] == '\n')

424 
couÁ
--;

425 ià(
couÁ
 =ğ1 && 
s
[0] == '0')

427 ià(
couÁ
 =ğ1 && 
s
[0] == '1')

429 ià(
couÁ
 =ğ2 && 
s
[0] == '-' && s[1] == '1')

431  -
EINVAL
;

432 
	}
}

436 
	$’Œy_¡©us
(
Node
 *
e
, *
·ge
)

438 *
dp
;

439 *
¡©us
 = "disabled";

440 cÚ¡ * 
æags
 = "flags: ";

442 ià(
	`‹¡_b™
(
EÇbËd
, &
e
->
æags
))

443 
¡©us
 = "enabled";

445 ià(!
VERBOSE_STATUS
) {

446 
	`¥rštf
(
·ge
, "%s\n", 
¡©us
);

450 
	`¥rštf
(
·ge
, "%s\nš‹½»‹¸%s\n", 
¡©us
, 
e
->
š‹½»‹r
);

451 
dp
 = 
·ge
 + 
	`¡¾’
(page);

454 
	`¥rštf
 (
dp
, "%s", 
æags
);

455 
dp
 +ğ
	`¡¾’
 (
æags
);

456 ià(
e
->
æags
 & 
MISC_FMT_PRESERVE_ARGV0
) {

457 *
dp
 ++ = 'P';

459 ià(
e
->
æags
 & 
MISC_FMT_OPEN_BINARY
) {

460 *
dp
 ++ = 'O';

462 ià(
e
->
æags
 & 
MISC_FMT_CREDENTIALS
) {

463 *
dp
 ++ = 'C';

465 *
dp
 ++ = '\n';

468 ià(!
	`‹¡_b™
(
Magic
, &
e
->
æags
)) {

469 
	`¥rštf
(
dp
, "ex‹nsiÚ .%s\n", 
e
->
magic
);

471 
i
;

473 
	`¥rštf
(
dp
, "off£ˆ%i\nmagiø", 
e
->
off£t
);

474 
dp
 = 
·ge
 + 
	`¡¾’
(page);

475 
i
 = 0; i < 
e
->
size
; i++) {

476 
	`¥rštf
(
dp
, "%02x", 0xfà& (è(
e
->
magic
[
i
]));

477 
dp
 += 2;

479 ià(
e
->
mask
) {

480 
	`¥rštf
(
dp
, "\nmask ");

481 
dp
 += 6;

482 
i
 = 0; i < 
e
->
size
; i++) {

483 
	`¥rštf
(
dp
, "%02x", 0xfà& (è(
e
->
mask
[
i
]));

484 
dp
 += 2;

487 *
dp
++ = '\n';

488 *
dp
 = '\0';

490 
	}
}

492 
šode
 *
	$bm_g‘_šode
(
su³r_block
 *
sb
, 
mode
)

494 
šode
 * inodğ
	`Ãw_šode
(
sb
);

496 ià(
šode
) {

497 
šode
->
i_šo
 = 
	`g‘_Ãxt_šo
();

498 
šode
->
i_mode
 = 
mode
;

499 
šode
->
i_©ime
 = inode->
i_mtime
 = inode->
i_ùime
 =

500 
	`cu¼’t_fs_time
(
šode
->
i_sb
);

502  
šode
;

503 
	}
}

505 
	$bm_eviù_šode
(
šode
 *inode)

507 
	`’d_wr™eback
(
šode
);

508 
	`kä“
(
šode
->
i_´iv©e
);

509 
	}
}

511 
	$kl_node
(
Node
 *
e
)

513 
d’Œy
 *dentry;

515 
	`wr™e_lock
(&
’Œ›s_lock
);

516 
d’Œy
 = 
e
->dentry;

517 ià(
d’Œy
) {

518 
	`li¡_d–_š™
(&
e
->
li¡
);

519 
e
->
d’Œy
 = 
NULL
;

521 
	`wr™e_uÆock
(&
’Œ›s_lock
);

523 ià(
d’Œy
) {

524 
	`drİ_Æšk
(
d’Œy
->
d_šode
);

525 
	`d_drİ
(
d’Œy
);

526 
	`dput
(
d’Œy
);

527 
	`sim¶e_»Ëa£_fs
(&
bm_mÁ
, &
’Œy_couÁ
);

529 
	}
}

533 
ssize_t


534 
	$bm_’Œy_»ad
(
fe
 * fe, 
__u£r
 * 
buf
, 
size_t
 
nby‹s
, 
loff_t
 *
µos
)

536 
Node
 *
e
 = 
fe
->
f_·th
.
d’Œy
->
d_šode
->
i_´iv©e
;

537 
ssize_t
 
»s
;

538 *
·ge
;

540 ià(!(
·ge
 = (*è
	`__g‘_ä“_·ge
(
GFP_KERNEL
)))

541  -
ENOMEM
;

543 
	`’Œy_¡©us
(
e
, 
·ge
);

545 
»s
 = 
	`sim¶e_»ad_äom_bufãr
(
buf
, 
nby‹s
, 
µos
, 
·ge
, 
	`¡¾’
(page));

547 
	`ä“_·ge
((è
·ge
);

548  
»s
;

549 
	}
}

551 
ssize_t
 
	$bm_’Œy_wr™e
(
fe
 *fe, cÚ¡ 
__u£r
 *
bufãr
,

552 
size_t
 
couÁ
, 
loff_t
 *
µos
)

554 
d’Œy
 *
roÙ
;

555 
Node
 *
e
 = 
fe
->
f_·th
.
d’Œy
->
d_šode
->
i_´iv©e
;

556 
»s
 = 
	`·r£_commªd
(
bufãr
, 
couÁ
);

558 
»s
) {

559 1: 
	`ş—r_b™
(
EÇbËd
, &
e
->
æags
);

561 2: 
	`£t_b™
(
EÇbËd
, &
e
->
æags
);

563 3: 
roÙ
 = 
	`dg‘
(
fe
->
f_·th
.
mÁ
->
mÁ_sb
->
s_roÙ
);

564 
	`mu‹x_lock
(&
roÙ
->
d_šode
->
i_mu‹x
);

566 
	`kl_node
(
e
);

568 
	`mu‹x_uÆock
(&
roÙ
->
d_šode
->
i_mu‹x
);

569 
	`dput
(
roÙ
);

571 :  
»s
;

573  
couÁ
;

574 
	}
}

576 cÚ¡ 
fe_İ”©iÚs
 
	gbm_’Œy_İ”©iÚs
 = {

577 .
»ad
 = 
bm_’Œy_»ad
,

578 .
	gwr™e
 = 
bm_’Œy_wr™e
,

579 .
	gÎ£ek
 = 
deçuÉ_Î£ek
,

584 
ssize_t
 
	$bm_»gi¡”_wr™e
(
fe
 *fe, cÚ¡ 
__u£r
 *
bufãr
,

585 
size_t
 
couÁ
, 
loff_t
 *
µos
)

587 
Node
 *
e
;

588 
šode
 *inode;

589 
d’Œy
 *
roÙ
, *dentry;

590 
su³r_block
 *
sb
 = 
fe
->
f_·th
.
mÁ
->
mÁ_sb
;

591 
”r
 = 0;

593 
e
 = 
	`ü—‹_’Œy
(
bufãr
, 
couÁ
);

595 ià(
	`IS_ERR
(
e
))

596  
	`PTR_ERR
(
e
);

598 
roÙ
 = 
	`dg‘
(
sb
->
s_roÙ
);

599 
	`mu‹x_lock
(&
roÙ
->
d_šode
->
i_mu‹x
);

600 
d’Œy
 = 
	`lookup_Úe_Ën
(
e
->
Çme
, 
roÙ
, 
	`¡¾’
(e->name));

601 
”r
 = 
	`PTR_ERR
(
d’Œy
);

602 ià(
	`IS_ERR
(
d’Œy
))

603 
out
;

605 
”r
 = -
EEXIST
;

606 ià(
d’Œy
->
d_šode
)

607 
out2
;

609 
šode
 = 
	`bm_g‘_šode
(
sb
, 
S_IFREG
 | 0644);

611 
”r
 = -
ENOMEM
;

612 ià(!
šode
)

613 
out2
;

615 
”r
 = 
	`sim¶e_pš_fs
(&
bm_fs_ty³
, &
bm_mÁ
, &
’Œy_couÁ
);

616 ià(
”r
) {

617 
	`ut
(
šode
);

618 
šode
 = 
NULL
;

619 
out2
;

622 
e
->
d’Œy
 = 
	`dg‘
(dentry);

623 
šode
->
i_´iv©e
 = 
e
;

624 
šode
->
i_fİ
 = &
bm_’Œy_İ”©iÚs
;

626 
	`d_š¡ªtŸ‹
(
d’Œy
, 
šode
);

627 
	`wr™e_lock
(&
’Œ›s_lock
);

628 
	`li¡_add
(&
e
->
li¡
, &
’Œ›s
);

629 
	`wr™e_uÆock
(&
’Œ›s_lock
);

631 
”r
 = 0;

632 
out2
:

633 
	`dput
(
d’Œy
);

634 
out
:

635 
	`mu‹x_uÆock
(&
roÙ
->
d_šode
->
i_mu‹x
);

636 
	`dput
(
roÙ
);

638 ià(
”r
) {

639 
	`kä“
(
e
);

640  -
EINVAL
;

642  
couÁ
;

643 
	}
}

645 cÚ¡ 
fe_İ”©iÚs
 
	gbm_»gi¡”_İ”©iÚs
 = {

646 .
wr™e
 = 
bm_»gi¡”_wr™e
,

647 .
	gÎ£ek
 = 
noİ_Î£ek
,

652 
ssize_t


653 
	$bm_¡©us_»ad
(
fe
 *fe, 
__u£r
 *
buf
, 
size_t
 
nby‹s
, 
loff_t
 *
µos
)

655 *
s
 = 
’abËd
 ? "enabled\n" : "disabled\n";

657  
	`sim¶e_»ad_äom_bufãr
(
buf
, 
nby‹s
, 
µos
, 
s
, 
	`¡¾’
(s));

658 
	}
}

660 
ssize_t
 
	$bm_¡©us_wr™e
(
fe
 * fe, cÚ¡ 
__u£r
 * 
bufãr
,

661 
size_t
 
couÁ
, 
loff_t
 *
µos
)

663 
»s
 = 
	`·r£_commªd
(
bufãr
, 
couÁ
);

664 
d’Œy
 *
roÙ
;

666 
»s
) {

667 1: 
’abËd
 = 0; ;

668 2: 
’abËd
 = 1; ;

669 3: 
roÙ
 = 
	`dg‘
(
fe
->
f_·th
.
mÁ
->
mÁ_sb
->
s_roÙ
);

670 
	`mu‹x_lock
(&
roÙ
->
d_šode
->
i_mu‹x
);

672 !
	`li¡_em±y
(&
’Œ›s
))

673 
	`kl_node
(
	`li¡_’Œy
(
’Œ›s
.
Ãxt
, 
Node
, 
li¡
));

675 
	`mu‹x_uÆock
(&
roÙ
->
d_šode
->
i_mu‹x
);

676 
	`dput
(
roÙ
);

677 :  
»s
;

679  
couÁ
;

680 
	}
}

682 cÚ¡ 
fe_İ”©iÚs
 
	gbm_¡©us_İ”©iÚs
 = {

683 .
»ad
 = 
bm_¡©us_»ad
,

684 .
	gwr™e
 = 
bm_¡©us_wr™e
,

685 .
	gÎ£ek
 = 
deçuÉ_Î£ek
,

690 cÚ¡ 
su³r_İ”©iÚs
 
	gs_İs
 = {

691 .
¡©fs
 = 
sim¶e_¡©fs
,

692 .
	geviù_šode
 = 
bm_eviù_šode
,

695 
	$bm_fl_su³r
(
su³r_block
 * 
sb
, * 
d©a
, 
s’t
)

697 
Œ“_desü
 
bm_fes
[] = {

698 [2] = {"¡©us", &
bm_¡©us_İ”©iÚs
, 
S_IWUSR
|
S_IRUGO
},

699 [3] = {"»gi¡”", &
bm_»gi¡”_İ”©iÚs
, 
S_IWUSR
},

702 
”r
 = 
	`sim¶e_fl_su³r
(
sb
, 0x42494e4d, 
bm_fes
);

703 ià(!
”r
)

704 
sb
->
s_İ
 = &
s_İs
;

705  
”r
;

706 
	}
}

708 
d’Œy
 *
	$bm_mouÁ
(
fe_sy¡em_ty³
 *
fs_ty³
,

709 
æags
, cÚ¡ *
dev_Çme
, *
d©a
)

711  
	`mouÁ_sšgË
(
fs_ty³
, 
æags
, 
d©a
, 
bm_fl_su³r
);

712 
	}
}

714 
lšux_bšfmt
 
	gmisc_fÜm©
 = {

715 .
moduË
 = 
THIS_MODULE
,

716 .
	glßd_bš¬y
 = 
lßd_misc_bš¬y
,

719 
fe_sy¡em_ty³
 
	gbm_fs_ty³
 = {

720 .
owÃr
 = 
THIS_MODULE
,

721 .
	gÇme
 = "binfmt_misc",

722 .
	gmouÁ
 = 
bm_mouÁ
,

723 .
	gkl_sb
 = 
kl_l™‹r_su³r
,

726 
__š™
 
	$š™_misc_bšfmt
()

728 
”r
 = 
	`»gi¡”_fesy¡em
(&
bm_fs_ty³
);

729 ià(!
”r
) {

730 
”r
 = 
	`š£¹_bšfmt
(&
misc_fÜm©
);

731 ià(
”r
)

732 
	`uÄegi¡”_fesy¡em
(&
bm_fs_ty³
);

734  
”r
;

735 
	}
}

737 
__ex™
 
	$ex™_misc_bšfmt
()

739 
	`uÄegi¡”_bšfmt
(&
misc_fÜm©
);

740 
	`uÄegi¡”_fesy¡em
(&
bm_fs_ty³
);

741 
	}
}

743 
cÜe_š™ÿÎ
(
š™_misc_bšfmt
);

744 
moduË_ex™
(
ex™_misc_bšfmt
);

745 
MODULE_LICENSE
("GPL");

	@binfmt_pod.c

12 
	~<lšux/moduË.h
>

13 
	~<lšux/k”Ãl.h
>

14 
	~<lšux/fs.h
>

15 
	~<lšux/mm.h
>

16 
	~<lšux/mmª.h
>

17 
	~<lšux/”ºo.h
>

18 
	~<lšux/sigÇl.h
>

19 
	~<lšux/bšfmts.h
>

20 
	~<lšux/¡ršg.h
>

21 
	~<lšux/fe.h
>

22 
	~<lšux/¦ab.h
>

23 
	~<lšux/³rsÚ®™y.h
>

24 
	~<lšux/podcÜe.h
>

25 
	~<lšux/š™.h
>

26 
	~<lšux/highuid.h
>

27 
	~<lšux/comp”.h
>

28 
	~<lšux/highmem.h
>

29 
	~<lšux/·gem­.h
>

30 
	~<lšux/£cur™y.h
>

31 
	~<lšux/¿ndom.h
>

32 
	~<lšux/pod.h
>

33 
	~<lšux/ut¢ame.h
>

34 
	~<lšux/cÜedump.h
>

35 
	~<asm/uacûss.h
>

36 
	~<asm/·¿m.h
>

37 
	~<asm/·ge.h
>

38 
lßd_pod_bš¬y
(
lšux_bš´m
 *
b´m
, 
±_»gs
 *
»gs
);

39 
lßd_pod_lib¿ry
(
fe
 *);

40 
pod_m­
(
fe
 *, , 
pod_phdr
 *,

47 #ifdeà
CONFIG_POD_CORE


48 
pod_cÜe_dump
(
cÜedump_·¿ms
 *
ırm
);

50 
	#pod_cÜe_dump
 
NULL


	)

53 #ià
POD_EXEC_PAGESIZE
 > 
PAGE_SIZE


54 
	#POD_MIN_ALIGN
 
POD_EXEC_PAGESIZE


	)

56 
	#POD_MIN_ALIGN
 
PAGE_SIZE


	)

59 #iâdeà
POD_CORE_EFLAGS


60 
	#POD_CORE_EFLAGS
 0

	)

63 
	#POD_PAGESTART
(
_v
è((_vè& ~()(
POD_MIN_ALIGN
-1))

	)

64 
	#POD_PAGEOFFSET
(
_v
è((_vè& (
POD_MIN_ALIGN
-1))

	)

65 
	#POD_PAGEALIGN
(
_v
è(((_vè+ 
POD_MIN_ALIGN
 - 1è& ~(POD_MIN_ALIGN - 1))

	)

67 
lšux_bšfmt
 
	gpod_fÜm©
 = {

68 .
moduË
 = 
THIS_MODULE
,

69 .
	glßd_bš¬y
 = 
lßd_pod_bš¬y
,

70 .
	glßd_shlib
 = 
lßd_pod_lib¿ry
,

71 .
	gcÜe_dump
 = 
pod_cÜe_dump
,

72 .
	gmš_cÜedump
 = 
POD_EXEC_PAGESIZE
,

75 
	#BAD_ADDR
(
x
è(()(xè>ğ
TASK_SIZE
)

	)

77 
	$£t_brk
(
¡¬t
, 
’d
)

79 
¡¬t
 = 
	`POD_PAGEALIGN
(start);

80 
’d
 = 
	`POD_PAGEALIGN
(end);

81 ià(
’d
 > 
¡¬t
) {

82 
addr
;

83 
	`down_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

84 
addr
 = 
	`do_brk
(
¡¬t
, 
’d
 - start);

85 
	`up_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

86 ià(
	`BAD_ADDR
(
addr
))

87  
addr
;

89 
cu¼’t
->
mm
->
¡¬t_brk
 = cu¼’t->mm->
brk
 = 
’d
;

91 
	}
}

98 
	$·dz”o
(
pod_bss
)

100 
nby‹
;

102 
nby‹
 = 
	`POD_PAGEOFFSET
(
pod_bss
);

103 ià(
nby‹
) {

104 
nby‹
 = 
POD_MIN_ALIGN
 -‚byte;

105 ià(
	`ş—r_u£r
((
__u£r
 *è
pod_bss
, 
nby‹
))

106  -
EFAULT
;

109 
	}
}

112 #ifdeà
CONFIG_STACK_GROWSUP


113 
	#STACK_ADD
(
¥
, 
™ems
è((
pod_addr_t
 
__u£r
 *)(¥è+ (™ems))

	)

114 
	#STACK_ROUND
(
¥
, 
™ems
) \

115 ((15 + (è((
¥
è+ (
™ems
))è&~ 15UL)

	)

116 
	#STACK_ALLOC
(
¥
, 
Ën
) ({ \

117 
pod_addr_t
 
__u£r
 *
Şd_¥
 = (pod_addr_ˆ__u£¸*)
¥
; s°+ğ
Ën
; \

118 
Şd_¥
; })

	)

120 
	#STACK_ADD
(
¥
, 
™ems
è((
pod_addr_t
 
__u£r
 *)(¥è- (™ems))

	)

121 
	#STACK_ROUND
(
¥
, 
™ems
) \

122 (((è(
¥
 - 
™ems
)è&~ 15UL)

	)

123 
	#STACK_ALLOC
(
¥
, 
Ën
è({ s°-ğËÀ; sp; })

	)

126 #iâdeà
POD_BASE_PLATFORM


132 
	#POD_BASE_PLATFORM
 
NULL


	)

136 
	$ü—‹_pod_bËs
(
lšux_bš´m
 *
b´m
, 
podhdr
 *
exec
,

137 
lßd_addr
, 
š‹½_lßd_addr
)

139 
p
 = 
b´m
->p;

140 
¬gc
 = 
b´m
->argc;

141 
’vc
 = 
b´m
->envc;

142 
pod_addr_t
 
__u£r
 *
¬gv
;

143 
pod_addr_t
 
__u£r
 *
’vp
;

144 
pod_addr_t
 
__u£r
 *
¥
;

145 
pod_addr_t
 
__u£r
 *
u_¶©fÜm
;

146 
pod_addr_t
 
__u£r
 *
u_ba£_¶©fÜm
;

147 
pod_addr_t
 
__u£r
 *
u_¿nd_by‹s
;

148 cÚ¡ *
k_¶©fÜm
 = 
POD_PLATFORM
;

149 cÚ¡ *
k_ba£_¶©fÜm
 = 
POD_BASE_PLATFORM
;

150 
k_¿nd_by‹s
[16];

151 
™ems
;

152 
pod_addr_t
 *
pod_šfo
;

153 
ei_šdex
 = 0;

154 cÚ¡ 
üed
 *üed = 
	`cu¼’t_üed
();

155 
vm_¬—_¡ruù
 *
vma
;

163 
p
 = 
	`¬ch_®ign_¡ack
(p);

171 
u_¶©fÜm
 = 
NULL
;

172 ià(
k_¶©fÜm
) {

173 
size_t
 
Ën
 = 
	`¡¾’
(
k_¶©fÜm
) + 1;

175 
u_¶©fÜm
 = (
pod_addr_t
 
__u£r
 *)
	`STACK_ALLOC
(
p
, 
Ën
);

176 ià(
	`__cİy_to_u£r
(
u_¶©fÜm
, 
k_¶©fÜm
, 
Ën
))

177  -
EFAULT
;

184 
u_ba£_¶©fÜm
 = 
NULL
;

185 ià(
k_ba£_¶©fÜm
) {

186 
size_t
 
Ën
 = 
	`¡¾’
(
k_ba£_¶©fÜm
) + 1;

188 
u_ba£_¶©fÜm
 = (
pod_addr_t
 
__u£r
 *)
	`STACK_ALLOC
(
p
, 
Ën
);

189 ià(
	`__cİy_to_u£r
(
u_ba£_¶©fÜm
, 
k_ba£_¶©fÜm
, 
Ën
))

190  -
EFAULT
;

196 
	`g‘_¿ndom_by‹s
(
k_¿nd_by‹s
, (k_rand_bytes));

197 
u_¿nd_by‹s
 = (
pod_addr_t
 
__u£r
 *)

198 
	`STACK_ALLOC
(
p
, (
k_¿nd_by‹s
));

199 ià(
	`__cİy_to_u£r
(
u_¿nd_by‹s
, 
k_¿nd_by‹s
, (k_rand_bytes)))

200  -
EFAULT
;

203 
pod_šfo
 = (
pod_addr_t
 *)
cu¼’t
->
mm
->
§ved_auxv
;

205 
	#NEW_AUX_ENT
(
id
, 
v®
) \

207 
pod_šfo
[
ei_šdex
++] = 
id
; \

208 
pod_šfo
[
ei_šdex
++] = 
v®
; \

209 } 0)

	)

211 #ifdeà
ARCH_DLINFO


218 
ARCH_DLINFO
;

220 
	`NEW_AUX_ENT
(
AT_HWCAP
, 
POD_HWCAP
);

221 
	`NEW_AUX_ENT
(
AT_PAGESZ
, 
POD_EXEC_PAGESIZE
);

222 
	`NEW_AUX_ENT
(
AT_CLKTCK
, 
CLOCKS_PER_SEC
);

223 
	`NEW_AUX_ENT
(
AT_PHDR
, 
lßd_addr
 + 
exec
->
e_phoff
);

224 
	`NEW_AUX_ENT
(
AT_PHENT
, (
pod_phdr
));

225 
	`NEW_AUX_ENT
(
AT_PHNUM
, 
exec
->
e_phnum
);

226 
	`NEW_AUX_ENT
(
AT_BASE
, 
š‹½_lßd_addr
);

227 
	`NEW_AUX_ENT
(
AT_FLAGS
, 0);

228 
	`NEW_AUX_ENT
(
AT_ENTRY
, 
exec
->
e_’Œy
);

229 
	`NEW_AUX_ENT
(
AT_UID
, 
üed
->
uid
);

230 
	`NEW_AUX_ENT
(
AT_EUID
, 
üed
->
euid
);

231 
	`NEW_AUX_ENT
(
AT_GID
, 
üed
->
gid
);

232 
	`NEW_AUX_ENT
(
AT_EGID
, 
üed
->
egid
);

233 
	`NEW_AUX_ENT
(
AT_SECURE
, 
	`£cur™y_b´m_£cu»exec
(
b´m
));

234 
	`NEW_AUX_ENT
(
AT_RANDOM
, (
pod_addr_t
)()
u_¿nd_by‹s
);

235 
	`NEW_AUX_ENT
(
AT_EXECFN
, 
b´m
->
exec
);

236 ià(
k_¶©fÜm
) {

237 
	`NEW_AUX_ENT
(
AT_PLATFORM
,

238 (
pod_addr_t
)()
u_¶©fÜm
);

240 ià(
k_ba£_¶©fÜm
) {

241 
	`NEW_AUX_ENT
(
AT_BASE_PLATFORM
,

242 (
pod_addr_t
)()
u_ba£_¶©fÜm
);

244 ià(
b´m
->
š‹½_æags
 & 
BINPRM_FLAGS_EXECFD
) {

245 
	`NEW_AUX_ENT
(
AT_EXECFD
, 
b´m
->
š‹½_d©a
);

247 #undeà
NEW_AUX_ENT


249 
	`mem£t
(&
pod_šfo
[
ei_šdex
], 0,

250  
cu¼’t
->
mm
->
§ved_auxv
 - 
ei_šdex
 *  
pod_šfo
[0]);

253 
ei_šdex
 += 2;

255 
¥
 = 
	`STACK_ADD
(
p
, 
ei_šdex
);

257 
™ems
 = (
¬gc
 + 1è+ (
’vc
 + 1) + 1;

258 
b´m
->
p
 = 
	`STACK_ROUND
(
¥
, 
™ems
);

261 #ifdeà
CONFIG_STACK_GROWSUP


262 
¥
 = (
pod_addr_t
 
__u£r
 *)
b´m
->
p
 - 
™ems
 - 
ei_šdex
;

263 
b´m
->
exec
 = ()
¥
;

265 
¥
 = (
pod_addr_t
 
__u£r
 *)
b´m
->
p
;

273 
vma
 = 
	`fšd_ex‹nd_vma
(
cu¼’t
->
mm
, 
b´m
->
p
);

274 ià(!
vma
)

275  -
EFAULT
;

278 ià(
	`__put_u£r
(
¬gc
, 
¥
++))

279  -
EFAULT
;

280 
¬gv
 = 
¥
;

281 
’vp
 = 
¬gv
 + 
¬gc
 + 1;

284 
p
 = 
cu¼’t
->
mm
->
¬g_’d
 = cu¼’t->mm->
¬g_¡¬t
;

285 
¬gc
-- > 0) {

286 
size_t
 
Ën
;

287 ià(
	`__put_u£r
((
pod_addr_t
)
p
, 
¬gv
++))

288  -
EFAULT
;

289 
Ën
 = 
	`¡ºËn_u£r
((
__u£r
 *)
p
, 
MAX_ARG_STRLEN
);

290 ià(!
Ën
 ||†’ > 
MAX_ARG_STRLEN
)

291  -
EINVAL
;

292 
p
 +ğ
Ën
;

294 ià(
	`__put_u£r
(0, 
¬gv
))

295  -
EFAULT
;

296 
cu¼’t
->
mm
->
¬g_’d
 = cu¼’t->mm->
’v_¡¬t
 = 
p
;

297 
’vc
-- > 0) {

298 
size_t
 
Ën
;

299 ià(
	`__put_u£r
((
pod_addr_t
)
p
, 
’vp
++))

300  -
EFAULT
;

301 
Ën
 = 
	`¡ºËn_u£r
((
__u£r
 *)
p
, 
MAX_ARG_STRLEN
);

302 ià(!
Ën
 ||†’ > 
MAX_ARG_STRLEN
)

303  -
EINVAL
;

304 
p
 +ğ
Ën
;

306 ià(
	`__put_u£r
(0, 
’vp
))

307  -
EFAULT
;

308 
cu¼’t
->
mm
->
’v_’d
 = 
p
;

311 
¥
 = (
pod_addr_t
 
__u£r
 *)
’vp
 + 1;

312 ià(
	`cİy_to_u£r
(
¥
, 
pod_šfo
, 
ei_šdex
 * (
pod_addr_t
)))

313  -
EFAULT
;

315 
	}
}

317 
	$pod_m­
(
fe
 *
f•
, 
addr
,

318 
pod_phdr
 *
•²t
, 
´Ù
, 
ty³
,

319 
tÙ®_size
)

321 
m­_addr
;

322 
size
 = 
•²t
->
p_fesz
 + 
	`POD_PAGEOFFSET
ÓµÁ->
p_vaddr
);

323 
off
 = 
•²t
->
p_off£t
 - 
	`POD_PAGEOFFSET
ÓµÁ->
p_vaddr
);

324 
addr
 = 
	`POD_PAGESTART
(addr);

325 
size
 = 
	`POD_PAGEALIGN
(size);

329 ià(!
size
)

330  
addr
;

332 
	`down_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

341 ià(
tÙ®_size
) {

342 
tÙ®_size
 = 
	`POD_PAGEALIGN
(total_size);

343 
m­_addr
 = 
	`do_mm­
(
f•
, 
addr
, 
tÙ®_size
, 
´Ù
, 
ty³
, 
off
);

344 ià(!
	`BAD_ADDR
(
m­_addr
))

345 
	`do_munm­
(
cu¼’t
->
mm
, 
m­_addr
+
size
, 
tÙ®_size
-size);

347 
m­_addr
 = 
	`do_mm­
(
f•
, 
addr
, 
size
, 
´Ù
, 
ty³
, 
off
);

349 
	`up_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

350 (
m­_addr
);

351 
	}
}

353 
	$tÙ®_m­pšg_size
(
pod_phdr
 *
cmds
, 
Ä
)

355 
i
, 
fœ¡_idx
 = -1, 
Ï¡_idx
 = -1;

357 
i
 = 0; i < 
Ä
; i++) {

358 ià(
cmds
[
i
].
p_ty³
 =ğ
PT_LOAD
) {

359 
Ï¡_idx
 = 
i
;

360 ià(
fœ¡_idx
 == -1)

361 
fœ¡_idx
 = 
i
;

364 ià(
fœ¡_idx
 == -1)

367  
cmds
[
Ï¡_idx
].
p_vaddr
 + cmds[Ï¡_idx].
p_memsz
 -

368 
	`POD_PAGESTART
(
cmds
[
fœ¡_idx
].
p_vaddr
);

369 
	}
}

377 
	$lßd_pod_š‹½
(
podhdr
 *
š‹½_pod_ex
,

378 
fe
 *
š‹½»‹r
, *
š‹½_m­_addr
,

379 
no_ba£
)

381 
pod_phdr
 *
pod_phd©a
;

382 
pod_phdr
 *
•²t
;

383 
lßd_addr
 = 0;

384 
lßd_addr_£t
 = 0;

385 
Ï¡_bss
 = 0, 
pod_bss
 = 0;

386 
”rÜ
 = ~0UL;

387 
tÙ®_size
;

388 
»tv®
, 
i
, 
size
;

391 ià(
š‹½_pod_ex
->
e_ty³
 !ğ
ET_EXEC
 &&

392 
š‹½_pod_ex
->
e_ty³
 !ğ
ET_DYN
)

393 
out
;

394 ià(!
	`pod_check_¬ch
(
š‹½_pod_ex
))

395 
out
;

396 ià(!
š‹½»‹r
->
f_İ
 || !š‹½»‹r->f_İ->
mm­
)

397 
out
;

403 ià(
š‹½_pod_ex
->
e_ph’tsize
 !ğ(
pod_phdr
))

404 
out
;

405 ià(
š‹½_pod_ex
->
e_phnum
 < 1 ||

406 
š‹½_pod_ex
->
e_phnum
 > 65536U / (
pod_phdr
))

407 
out
;

410 
size
 = (
pod_phdr
è* 
š‹½_pod_ex
->
e_phnum
;

411 ià(
size
 > 
POD_MIN_ALIGN
)

412 
out
;

413 
pod_phd©a
 = 
	`km®loc
(
size
, 
GFP_KERNEL
);

414 ià(!
pod_phd©a
)

415 
out
;

417 
»tv®
 = 
	`k”Ãl_»ad
(
š‹½»‹r
, 
š‹½_pod_ex
->
e_phoff
,

418 (*)
pod_phd©a
, 
size
);

419 
”rÜ
 = -
EIO
;

420 ià(
»tv®
 !ğ
size
) {

421 ià(
»tv®
 < 0)

422 
”rÜ
 = 
»tv®
;

423 
out_şo£
;

426 
tÙ®_size
 = 
	`tÙ®_m­pšg_size
(
pod_phd©a
, 
š‹½_pod_ex
->
e_phnum
);

427 ià(!
tÙ®_size
) {

428 
”rÜ
 = -
EINVAL
;

429 
out_şo£
;

432 
•²t
 = 
pod_phd©a
;

433 
i
 = 0; i < 
š‹½_pod_ex
->
e_phnum
; i++, 
•²t
++) {

434 ià(
•²t
->
p_ty³
 =ğ
PT_LOAD
) {

435 
pod_ty³
 = 
MAP_PRIVATE
 | 
MAP_DENYWRITE
;

436 
pod_´Ù
 = 0;

437 
vaddr
 = 0;

438 
k
, 
m­_addr
;

440 ià(
•²t
->
p_æags
 & 
PF_R
)

441 
pod_´Ù
 = 
PROT_READ
;

442 ià(
•²t
->
p_æags
 & 
PF_W
)

443 
pod_´Ù
 |ğ
PROT_WRITE
;

444 ià(
•²t
->
p_æags
 & 
PF_X
)

445 
pod_´Ù
 |ğ
PROT_EXEC
;

446 
vaddr
 = 
•²t
->
p_vaddr
;

447 ià(
š‹½_pod_ex
->
e_ty³
 =ğ
ET_EXEC
 || 
lßd_addr_£t
)

448 
pod_ty³
 |ğ
MAP_FIXED
;

449 ià(
no_ba£
 && 
š‹½_pod_ex
->
e_ty³
 =ğ
ET_DYN
)

450 
lßd_addr
 = -
vaddr
;

452 
m­_addr
 = 
	`pod_m­
(
š‹½»‹r
, 
lßd_addr
 + 
vaddr
,

453 
•²t
, 
pod_´Ù
, 
pod_ty³
, 
tÙ®_size
);

459 
tÙ®_size
 = 0;

460 ià(!*
š‹½_m­_addr
)

461 *
š‹½_m­_addr
 = 
m­_addr
;

462 
”rÜ
 = 
m­_addr
;

463 ià(
	`BAD_ADDR
(
m­_addr
))

464 
out_şo£
;

466 ià(!
lßd_addr_£t
 &&

467 
š‹½_pod_ex
->
e_ty³
 =ğ
ET_DYN
) {

468 
lßd_addr
 = 
m­_addr
 - 
	`POD_PAGESTART
(
vaddr
);

469 
lßd_addr_£t
 = 1;

477 
k
 = 
lßd_addr
 + 
•²t
->
p_vaddr
;

478 ià(
	`BAD_ADDR
(
k
) ||

479 
•²t
->
p_fesz
 >ƒµÁ->
p_memsz
 ||

480 
•²t
->
p_memsz
 > 
TASK_SIZE
 ||

481 
TASK_SIZE
 - 
•²t
->
p_memsz
 < 
k
) {

482 
”rÜ
 = -
ENOMEM
;

483 
out_şo£
;

490 
k
 = 
lßd_addr
 + 
•²t
->
p_vaddr
 +ƒµÁ->
p_fesz
;

491 ià(
k
 > 
pod_bss
)

492 
pod_bss
 = 
k
;

498 
k
 = 
lßd_addr
 + 
•²t
->
p_memsz
 +ƒµÁ->
p_vaddr
;

499 ià(
k
 > 
Ï¡_bss
)

500 
Ï¡_bss
 = 
k
;

504 ià(
Ï¡_bss
 > 
pod_bss
) {

511 ià(
	`·dz”o
(
pod_bss
)) {

512 
”rÜ
 = -
EFAULT
;

513 
out_şo£
;

517 
pod_bss
 = 
	`POD_PAGESTART
Õod_bs + 
POD_MIN_ALIGN
 - 1);

520 
	`down_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

521 
”rÜ
 = 
	`do_brk
(
pod_bss
, 
Ï¡_bss
 -…od_bss);

522 
	`up_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

523 ià(
	`BAD_ADDR
(
”rÜ
))

524 
out_şo£
;

527 
”rÜ
 = 
lßd_addr
;

529 
out_şo£
:

530 
	`kä“
(
pod_phd©a
);

531 
out
:

532  
”rÜ
;

533 
	}
}

540 
	#INTERPRETER_NONE
 0

	)

541 
	#INTERPRETER_POD
 2

	)

543 #iâdeà
STACK_RND_MASK


544 
	#STACK_RND_MASK
 (0x7fà>> (
PAGE_SHIFT
 - 12)è

	)

547 
	$¿ndomize_¡ack_tİ
(
¡ack_tİ
)

549 
¿ndom_v¬ŸbË
 = 0;

551 ià((
cu¼’t
->
æags
 & 
PF_RANDOMIZE
) &&

552 !(
cu¼’t
->
³rsÚ®™y
 & 
ADDR_NO_RANDOMIZE
)) {

553 
¿ndom_v¬ŸbË
 = 
	`g‘_¿ndom_št
(è& 
STACK_RND_MASK
;

554 
¿ndom_v¬ŸbË
 <<ğ
PAGE_SHIFT
;

556 #ifdeà
CONFIG_STACK_GROWSUP


557  
	`PAGE_ALIGN
(
¡ack_tİ
è+ 
¿ndom_v¬ŸbË
;

559  
	`PAGE_ALIGN
(
¡ack_tİ
è- 
¿ndom_v¬ŸbË
;

561 
	}
}

563 
	$lßd_pod_bš¬y
(
lšux_bš´m
 *
b´m
, 
±_»gs
 *
»gs
)

566 
fe
 *
š‹½»‹r
 = 
NULL
;

567 
lßd_addr
 = 0, 
lßd_bŸs
 = 0;

568 
lßd_addr_£t
 = 0;

569 * 
pod_š‹½»‹r
 = 
NULL
;

570 
”rÜ
;

571 
pod_phdr
 *
pod_µÁ
, *
pod_phd©a
;

572 
pod_bss
, 
pod_brk
;

573 
»tv®
, 
i
;

574 
size
;

575 
pod_’Œy
;

576 
š‹½_lßd_addr
 = 0;

577 
¡¬t_code
, 
’d_code
, 
¡¬t_d©a
, 
’d_d©a
;

578 
»loc_func_desc
 
__maybe_unu£d
 = 0;

579 
execubË_¡ack
 = 
EXSTACK_DEFAULT
;

580 
def_æags
 = 0;

582 
podhdr
 
pod_ex
;

583 
podhdr
 
š‹½_pod_ex
;

584 } *
loc
;

587 
	`´štk
("PodArch-BINFMT_POD: Lßdšg fe: %s\n", 
b´m
->
f’ame
);

590 
loc
 = 
	`km®loc
((*loc), 
GFP_KERNEL
);

591 ià(!
loc
) {

592 
»tv®
 = -
ENOMEM
;

593 
out_»t
;

597 
loc
->
pod_ex
 = *((
podhdr
 *)
b´m
->
buf
);

599 
»tv®
 = -
ENOEXEC
;

601 ià(
	`memcmp
(
loc
->
pod_ex
.
e_id’t
, 
PODMAG
, 
SELFMAG
) != 0)

602 
out
;

604 ià(
loc
->
pod_ex
.
e_ty³
 !ğ
ET_EXEC
 &&†oc->pod_ex.e_ty³ !ğ
ET_DYN
)

605 
out
;

606 ià(!
	`pod_check_¬ch
(&
loc
->
pod_ex
))

607 
out
;

608 ià(!
b´m
->
fe
->
f_İ
 || !b´m->fe->f_İ->
mm­
)

609 
out
;

612 ià(
loc
->
pod_ex
.
e_ph’tsize
 !ğ(
pod_phdr
))

613 
out
;

614 ià(
loc
->
pod_ex
.
e_phnum
 < 1 ||

615 
loc
->
pod_ex
.
e_phnum
 > 65536U / (
pod_phdr
))

616 
out
;

617 
size
 = 
loc
->
pod_ex
.
e_phnum
 * (
pod_phdr
);

618 
»tv®
 = -
ENOMEM
;

619 
pod_phd©a
 = 
	`km®loc
(
size
, 
GFP_KERNEL
);

620 ià(!
pod_phd©a
)

621 
out
;

623 
»tv®
 = 
	`k”Ãl_»ad
(
b´m
->
fe
, 
loc
->
pod_ex
.
e_phoff
,

624 (*)
pod_phd©a
, 
size
);

625 ià(
»tv®
 !ğ
size
) {

626 ià(
»tv®
 >= 0)

627 
»tv®
 = -
EIO
;

628 
out_ä“_ph
;

631 
pod_µÁ
 = 
pod_phd©a
;

632 
pod_bss
 = 0;

633 
pod_brk
 = 0;

635 
¡¬t_code
 = ~0UL;

636 
’d_code
 = 0;

637 
¡¬t_d©a
 = 0;

638 
’d_d©a
 = 0;

640 
i
 = 0; i < 
loc
->
pod_ex
.
e_phnum
; i++) {

641 ià(
pod_µÁ
->
p_ty³
 =ğ
PT_INTERP
) {

646 
»tv®
 = -
ENOEXEC
;

647 ià(
pod_µÁ
->
p_fesz
 > 
PATH_MAX
 ||

648 
pod_µÁ
->
p_fesz
 < 2)

649 
out_ä“_ph
;

651 
»tv®
 = -
ENOMEM
;

652 
pod_š‹½»‹r
 = 
	`km®loc
(
pod_µÁ
->
p_fesz
,

653 
GFP_KERNEL
);

654 ià(!
pod_š‹½»‹r
)

655 
out_ä“_ph
;

657 
»tv®
 = 
	`k”Ãl_»ad
(
b´m
->
fe
, 
pod_µÁ
->
p_off£t
,

658 
pod_š‹½»‹r
,

659 
pod_µÁ
->
p_fesz
);

660 ià(
»tv®
 !ğ
pod_µÁ
->
p_fesz
) {

661 ià(
»tv®
 >= 0)

662 
»tv®
 = -
EIO
;

663 
out_ä“_š‹½
;

666 
»tv®
 = -
ENOEXEC
;

667 ià(
pod_š‹½»‹r
[
pod_µÁ
->
p_fesz
 - 1] != '\0')

668 
out_ä“_š‹½
;

670 
š‹½»‹r
 = 
	`İ’_exec
(
pod_š‹½»‹r
);

671 
»tv®
 = 
	`PTR_ERR
(
š‹½»‹r
);

672 ià(
	`IS_ERR
(
š‹½»‹r
))

673 
out_ä“_š‹½
;

680 
	`would_dump
(
b´m
, 
š‹½»‹r
);

682 
»tv®
 = 
	`k”Ãl_»ad
(
š‹½»‹r
, 0, 
b´m
->
buf
,

683 
BINPRM_BUF_SIZE
);

684 ià(
»tv®
 !ğ
BINPRM_BUF_SIZE
) {

685 ià(
»tv®
 >= 0)

686 
»tv®
 = -
EIO
;

687 
out_ä“_d’Œy
;

691 
loc
->
š‹½_pod_ex
 = *((
podhdr
 *)
b´m
->
buf
);

694 
pod_µÁ
++;

697 
pod_µÁ
 = 
pod_phd©a
;

698 
i
 = 0; i < 
loc
->
pod_ex
.
e_phnum
; i++, 
pod_µÁ
++)

699 ià(
pod_µÁ
->
p_ty³
 =ğ
PT_GNU_STACK
) {

700 ià(
pod_µÁ
->
p_æags
 & 
PF_X
)

701 
execubË_¡ack
 = 
EXSTACK_ENABLE_X
;

703 
execubË_¡ack
 = 
EXSTACK_DISABLE_X
;

707 
pod_µÁ
 = 
pod_phd©a
;

708 
i
 = 0; i < 
loc
->
pod_ex
.
e_phnum
; i++, 
pod_µÁ
++){

709 ià(
pod_µÁ
->
p_ty³
 =ğ
PT_LOAD
) {

710 if(
pod_µÁ
->
p_fesz
=õod_µÁ->
p_memsz
 &&…od_ppnt->p_filesz==256)

711 
	`´štk
("FOUND POD_IDENTITY\n");

713 
	`´štk
("Inside PT_LOAD, but POD_IDENTITY NOT FOUND\n");

724 ià(
pod_š‹½»‹r
) {

725 
»tv®
 = -
ELIBBAD
;

727 ià(
	`memcmp
(
loc
->
š‹½_pod_ex
.
e_id’t
, 
PODMAG
, 
SELFMAG
) != 0)

728 
out_ä“_d’Œy
;

730 ià(!
	`pod_check_¬ch
(&
loc
->
š‹½_pod_ex
))

731 
out_ä“_d’Œy
;

735 
»tv®
 = 
	`æush_Şd_exec
(
b´m
);

736 ià(
»tv®
)

737 
out_ä“_d’Œy
;

740 
cu¼’t
->
æags
 &ğ~
PF_FORKNOEXEC
;

741 
cu¼’t
->
mm
->
def_æags
 = def_flags;

745 
	`SET_PERSONALITY
(
loc
->
pod_ex
);

746 ià(
	`pod_»ad_im¶›s_exec
(
loc
->
pod_ex
, 
execubË_¡ack
))

747 
cu¼’t
->
³rsÚ®™y
 |ğ
READ_IMPLIES_EXEC
;

749 ià(!(
cu¼’t
->
³rsÚ®™y
 & 
ADDR_NO_RANDOMIZE
è&& 
¿ndomize_va_¥aû
)

750 
cu¼’t
->
æags
 |ğ
PF_RANDOMIZE
;

752 
	`£tup_Ãw_exec
(
b´m
);

756 
cu¼’t
->
mm
->
ä“_¬—_ÿche
 = cu¼’t->mm->
mm­_ba£
;

757 
cu¼’t
->
mm
->
ÿched_hŞe_size
 = 0;

758 
»tv®
 = 
	`£tup_¬g_·ges
(
b´m
, 
	`¿ndomize_¡ack_tİ
(
STACK_TOP
),

759 
execubË_¡ack
);

760 ià(
»tv®
 < 0) {

761 
	`£nd_sig
(
SIGKILL
, 
cu¼’t
, 0);

762 
out_ä“_d’Œy
;

765 
cu¼’t
->
mm
->
¡¬t_¡ack
 = 
b´m
->
p
;

773 
i
 = 0, 
pod_µÁ
 = 
pod_phd©a
;

774 
i
 < 
loc
->
pod_ex
.
e_phnum
; i++, 
pod_µÁ
++) {

775 
pod_´Ù
 = 0, 
pod_æags
;

776 
k
, 
vaddr
;

778 ià(
pod_µÁ
->
p_ty³
 !ğ
PT_LOAD
)

781 ià(
	`uÆik–y
 (
pod_brk
 > 
pod_bss
)) {

782 
nby‹
;

787 
»tv®
 = 
	`£t_brk
(
pod_bss
 + 
lßd_bŸs
,

788 
pod_brk
 + 
lßd_bŸs
);

789 ià(
»tv®
) {

790 
	`£nd_sig
(
SIGKILL
, 
cu¼’t
, 0);

791 
out_ä“_d’Œy
;

793 
nby‹
 = 
	`POD_PAGEOFFSET
(
pod_bss
);

794 ià(
nby‹
) {

795 
nby‹
 = 
POD_MIN_ALIGN
 -‚byte;

796 ià(
nby‹
 > 
pod_brk
 - 
pod_bss
)

797 
nby‹
 = 
pod_brk
 - 
pod_bss
;

798 ià(
	`ş—r_u£r
((
__u£r
 *)
pod_bss
 +

799 
lßd_bŸs
, 
nby‹
)) {

809 ià(
pod_µÁ
->
p_æags
 & 
PF_R
)

810 
pod_´Ù
 |ğ
PROT_READ
;

811 ià(
pod_µÁ
->
p_æags
 & 
PF_W
)

812 
pod_´Ù
 |ğ
PROT_WRITE
;

813 ià(
pod_µÁ
->
p_æags
 & 
PF_X
)

814 
pod_´Ù
 |ğ
PROT_EXEC
;

816 
pod_æags
 = 
MAP_PRIVATE
 | 
MAP_DENYWRITE
 | 
MAP_EXECUTABLE
;

818 
vaddr
 = 
pod_µÁ
->
p_vaddr
;

819 ià(
loc
->
pod_ex
.
e_ty³
 =ğ
ET_EXEC
 || 
lßd_addr_£t
) {

820 
pod_æags
 |ğ
MAP_FIXED
;

821 } ià(
loc
->
pod_ex
.
e_ty³
 =ğ
ET_DYN
) {

826 #ià
	`defšed
(
CONFIG_X86
è|| defšed(
CONFIG_ARM
)

833 ià(
cu¼’t
->
æags
 & 
PF_RANDOMIZE
)

834 
lßd_bŸs
 = 0;

836 
lßd_bŸs
 = 
	`POD_PAGESTART
(
POD_ET_DYN_BASE
 - 
vaddr
);

838 
lßd_bŸs
 = 
	`POD_PAGESTART
(
POD_ET_DYN_BASE
 - 
vaddr
);

842 
”rÜ
 = 
	`pod_m­
(
b´m
->
fe
, 
lßd_bŸs
 + 
vaddr
, 
pod_µÁ
,

843 
pod_´Ù
, 
pod_æags
, 0);

850 ià(
	`BAD_ADDR
(
”rÜ
)) {

851 
	`£nd_sig
(
SIGKILL
, 
cu¼’t
, 0);

852 
»tv®
 = 
	`IS_ERR
((*)
”rÜ
) ?

853 
	`PTR_ERR
((*)
”rÜ
è: -
EINVAL
;

854 
out_ä“_d’Œy
;

857 ià(!
lßd_addr_£t
) {

858 
lßd_addr_£t
 = 1;

859 
lßd_addr
 = (
pod_µÁ
->
p_vaddr
 -…od_µÁ->
p_off£t
);

860 ià(
loc
->
pod_ex
.
e_ty³
 =ğ
ET_DYN
) {

861 
lßd_bŸs
 +ğ
”rÜ
 -

862 
	`POD_PAGESTART
(
lßd_bŸs
 + 
vaddr
);

863 
lßd_addr
 +ğ
lßd_bŸs
;

864 
»loc_func_desc
 = 
lßd_bŸs
;

867 
k
 = 
pod_µÁ
->
p_vaddr
;

868 ià(
k
 < 
¡¬t_code
)

869 
¡¬t_code
 = 
k
;

870 ià(
¡¬t_d©a
 < 
k
)

871 
¡¬t_d©a
 = 
k
;

878 ià(
	`BAD_ADDR
(
k
è|| 
pod_µÁ
->
p_fesz
 >…od_µÁ->
p_memsz
 ||

879 
pod_µÁ
->
p_memsz
 > 
TASK_SIZE
 ||

880 
TASK_SIZE
 - 
pod_µÁ
->
p_memsz
 < 
k
) {

882 
	`£nd_sig
(
SIGKILL
, 
cu¼’t
, 0);

883 
»tv®
 = -
EINVAL
;

884 
out_ä“_d’Œy
;

887 
k
 = 
pod_µÁ
->
p_vaddr
 +…od_µÁ->
p_fesz
;

889 ià(
k
 > 
pod_bss
)

890 
pod_bss
 = 
k
;

891 ià((
pod_µÁ
->
p_æags
 & 
PF_X
è&& 
’d_code
 < 
k
)

892 
’d_code
 = 
k
;

893 ià(
’d_d©a
 < 
k
)

894 
’d_d©a
 = 
k
;

895 
k
 = 
pod_µÁ
->
p_vaddr
 +…od_µÁ->
p_memsz
;

896 ià(
k
 > 
pod_brk
)

897 
pod_brk
 = 
k
;

900 
loc
->
pod_ex
.
e_’Œy
 +ğ
lßd_bŸs
;

901 
pod_bss
 +ğ
lßd_bŸs
;

902 
pod_brk
 +ğ
lßd_bŸs
;

903 
¡¬t_code
 +ğ
lßd_bŸs
;

904 
’d_code
 +ğ
lßd_bŸs
;

905 
¡¬t_d©a
 +ğ
lßd_bŸs
;

906 
’d_d©a
 +ğ
lßd_bŸs
;

913 
»tv®
 = 
	`£t_brk
(
pod_bss
, 
pod_brk
);

914 ià(
»tv®
) {

915 
	`£nd_sig
(
SIGKILL
, 
cu¼’t
, 0);

916 
out_ä“_d’Œy
;

918 ià(
	`lik–y
(
pod_bss
 !ğ
pod_brk
è&& 
	`uÆik–y
(
	`·dz”o
(pod_bss))) {

919 
	`£nd_sig
(
SIGSEGV
, 
cu¼’t
, 0);

920 
»tv®
 = -
EFAULT
;

921 
out_ä“_d’Œy
;

924 ià(
pod_š‹½»‹r
) {

925 
	`unš™Ÿlized_v¬
(
š‹½_m­_addr
);

927 
pod_’Œy
 = 
	`lßd_pod_š‹½
(&
loc
->
š‹½_pod_ex
,

928 
š‹½»‹r
,

929 &
š‹½_m­_addr
,

930 
lßd_bŸs
);

932 ià(!
	`IS_ERR
((*)
pod_’Œy
)) {

937 
š‹½_lßd_addr
 = 
pod_’Œy
;

938 
pod_’Œy
 +ğ
loc
->
š‹½_pod_ex
.
e_’Œy
;

940 ià(
	`BAD_ADDR
(
pod_’Œy
)) {

941 
	`fÜû_sig
(
SIGSEGV
, 
cu¼’t
);

942 
»tv®
 = 
	`IS_ERR
((*)
pod_’Œy
) ?

943 ()
pod_’Œy
 : -
EINVAL
;

944 
out_ä“_d’Œy
;

946 
»loc_func_desc
 = 
š‹½_lßd_addr
;

948 
	`®low_wr™e_acûss
(
š‹½»‹r
);

949 
	`åut
(
š‹½»‹r
);

950 
	`kä“
(
pod_š‹½»‹r
);

952 
pod_’Œy
 = 
loc
->
pod_ex
.
e_’Œy
;

953 ià(
	`BAD_ADDR
(
pod_’Œy
)) {

954 
	`fÜû_sig
(
SIGSEGV
, 
cu¼’t
);

955 
»tv®
 = -
EINVAL
;

956 
out_ä“_d’Œy
;

964 
	`kä“
(
pod_phd©a
);

966 
	`£t_bšfmt
(&
pod_fÜm©
);

968 #ifdeà
ARCH_HAS_SETUP_ADDITIONAL_PAGES


969 
»tv®
 = 
	`¬ch_£tup_add™iÚ®_·ges
(
b´m
, !!
pod_š‹½»‹r
);

970 ià(
»tv®
 < 0) {

971 
	`£nd_sig
(
SIGKILL
, 
cu¼’t
, 0);

972 
out
;

976 
	`š¡®l_exec_üeds
(
b´m
);

977 
cu¼’t
->
æags
 &ğ~
PF_FORKNOEXEC
;

978 
»tv®
 = 
	`ü—‹_pod_bËs
(
b´m
, &
loc
->
pod_ex
,

979 
lßd_addr
, 
š‹½_lßd_addr
);

980 ià(
»tv®
 < 0) {

981 
	`£nd_sig
(
SIGKILL
, 
cu¼’t
, 0);

982 
out
;

985 
cu¼’t
->
mm
->
’d_code
 =ƒnd_code;

986 
cu¼’t
->
mm
->
¡¬t_code
 = start_code;

987 
cu¼’t
->
mm
->
¡¬t_d©a
 = start_data;

988 
cu¼’t
->
mm
->
’d_d©a
 =ƒnd_data;

989 
cu¼’t
->
mm
->
¡¬t_¡ack
 = 
b´m
->
p
;

991 #ifdeà
¬ch_¿ndomize_brk


992 ià((
cu¼’t
->
æags
 & 
PF_RANDOMIZE
è&& (
¿ndomize_va_¥aû
 > 1)) {

993 
cu¼’t
->
mm
->
brk
 = cu¼’t->mm->
¡¬t_brk
 =

994 
	`¬ch_¿ndomize_brk
(
cu¼’t
->
mm
);

995 #ifdeà
CONFIG_COMPAT_BRK


996 
cu¼’t
->
brk_¿ndomized
 = 1;

1001 ià(
cu¼’t
->
³rsÚ®™y
 & 
MMAP_PAGE_ZERO
) {

1006 
	`down_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

1007 
”rÜ
 = 
	`do_mm­
(
NULL
, 0, 
PAGE_SIZE
, 
PROT_READ
 | 
PROT_EXEC
,

1008 
MAP_FIXED
 | 
MAP_PRIVATE
, 0);

1009 
	`up_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

1012 #ifdeà
POD_PLAT_INIT


1023 
	`POD_PLAT_INIT
(
»gs
, 
»loc_func_desc
);

1026 
	`¡¬t_th»ad
(
»gs
, 
pod_’Œy
, 
b´m
->
p
);

1027 
»tv®
 = 0;

1028 
out
:

1029 
	`kä“
(
loc
);

1030 
out_»t
:

1031  
»tv®
;

1034 
out_ä“_d’Œy
:

1035 
	`®low_wr™e_acûss
(
š‹½»‹r
);

1036 ià(
š‹½»‹r
)

1037 
	`åut
(
š‹½»‹r
);

1038 
out_ä“_š‹½
:

1039 
	`kä“
(
pod_š‹½»‹r
);

1040 
out_ä“_ph
:

1041 
	`kä“
(
pod_phd©a
);

1042 
out
;

1043 
	}
}

1050 
	$lßd_pod_lib¿ry
(
fe
 *file)

1052 
pod_phdr
 *
pod_phd©a
;

1053 
pod_phdr
 *
•²t
;

1054 
pod_bss
, 
bss
, 
Ën
;

1055 
»tv®
, 
”rÜ
, 
i
, 
j
;

1056 
podhdr
 
pod_ex
;

1058 
”rÜ
 = -
ENOEXEC
;

1059 
»tv®
 = 
	`k”Ãl_»ad
(
fe
, 0, (*)&
pod_ex
, (pod_ex));

1060 ià(
»tv®
 !ğ(
pod_ex
))

1061 
out
;

1063 ià(
	`memcmp
(
pod_ex
.
e_id’t
, 
PODMAG
, 
SELFMAG
) != 0)

1064 
out
;

1067 ià(
pod_ex
.
e_ty³
 !ğ
ET_EXEC
 ||…od_ex.
e_phnum
 > 2 ||

1068 !
	`pod_check_¬ch
(&
pod_ex
è|| !
fe
->
f_İ
 || !fe->f_İ->
mm­
)

1069 
out
;

1073 
j
 = (
pod_phdr
è* 
pod_ex
.
e_phnum
;

1076 
”rÜ
 = -
ENOMEM
;

1077 
pod_phd©a
 = 
	`km®loc
(
j
, 
GFP_KERNEL
);

1078 ià(!
pod_phd©a
)

1079 
out
;

1081 
•²t
 = 
pod_phd©a
;

1082 
”rÜ
 = -
ENOEXEC
;

1083 
»tv®
 = 
	`k”Ãl_»ad
(
fe
, 
pod_ex
.
e_phoff
, (*)
•²t
, 
j
);

1084 ià(
»tv®
 !ğ
j
)

1085 
out_ä“_ph
;

1087 
j
 = 0, 
i
 = 0; i<
pod_ex
.
e_phnum
; i++)

1088 ià((
•²t
 + 
i
)->
p_ty³
 =ğ
PT_LOAD
)

1089 
j
++;

1090 ià(
j
 != 1)

1091 
out_ä“_ph
;

1093 
•²t
->
p_ty³
 !ğ
PT_LOAD
)

1094 
•²t
++;

1097 
	`down_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

1098 
”rÜ
 = 
	`do_mm­
(
fe
,

1099 
	`POD_PAGESTART
(
•²t
->
p_vaddr
),

1100 (
•²t
->
p_fesz
 +

1101 
	`POD_PAGEOFFSET
(
•²t
->
p_vaddr
)),

1102 
PROT_READ
 | 
PROT_WRITE
 | 
PROT_EXEC
,

1103 
MAP_FIXED
 | 
MAP_PRIVATE
 | 
MAP_DENYWRITE
,

1104 (
•²t
->
p_off£t
 -

1105 
	`POD_PAGEOFFSET
(
•²t
->
p_vaddr
)));

1106 
	`up_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

1107 ià(
”rÜ
 !ğ
	`POD_PAGESTART
(
•²t
->
p_vaddr
))

1108 
out_ä“_ph
;

1110 
pod_bss
 = 
•²t
->
p_vaddr
 +ƒµÁ->
p_fesz
;

1111 ià(
	`·dz”o
(
pod_bss
)) {

1112 
”rÜ
 = -
EFAULT
;

1113 
out_ä“_ph
;

1116 
Ën
 = 
	`POD_PAGESTART
(
•²t
->
p_fesz
 +ƒµÁ->
p_vaddr
 +

1117 
POD_MIN_ALIGN
 - 1);

1118 
bss
 = 
•²t
->
p_memsz
 +ƒµÁ->
p_vaddr
;

1119 ià(
bss
 > 
Ën
) {

1120 
	`down_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

1121 
	`do_brk
(
Ën
, 
bss
 -†en);

1122 
	`up_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

1124 
”rÜ
 = 0;

1126 
out_ä“_ph
:

1127 
	`kä“
(
pod_phd©a
);

1128 
out
:

1129  
”rÜ
;

1130 
	}
}

1132 #ifdeà
CONFIG_POD_CORE


1143 
	$vma_dump_size
(
vm_¬—_¡ruù
 *
vma
,

1144 
mm_æags
)

1146 
	#FILTER
(
ty³
è(
mm_æags
 & (1UL << 
MMF_DUMP_
##ty³))

	)

1149 ià(
vma
->
vm_æags
 & 
VM_ALWAYSDUMP
)

1150 
whŞe
;

1153 ià(
vma
->
vm_æags
 & 
VM_HUGETLB
) {

1154 ià((
vma
->
vm_æags
 & 
VM_SHARED
è&& 
	`FILTER
(
HUGETLB_SHARED
))

1155 
whŞe
;

1156 ià(!(
vma
->
vm_æags
 & 
VM_SHARED
è&& 
	`FILTER
(
HUGETLB_PRIVATE
))

1157 
whŞe
;

1161 ià(
vma
->
vm_æags
 & (
VM_IO
 | 
VM_RESERVED
))

1165 ià(
vma
->
vm_æags
 & 
VM_SHARED
) {

1166 ià(
vma
->
vm_fe
->
f_·th
.
d’Œy
->
d_šode
->
i_Æšk
 == 0 ?

1167 
	`FILTER
(
ANON_SHARED
è: FILTER(
MAPPED_SHARED
))

1168 
whŞe
;

1173 ià(
vma
->
ªÚ_vma
 && 
	`FILTER
(
ANON_PRIVATE
))

1174 
whŞe
;

1175 ià(
vma
->
vm_fe
 =ğ
NULL
)

1178 ià(
	`FILTER
(
MAPPED_PRIVATE
))

1179 
whŞe
;

1186 ià(
	`FILTER
(
POD_HEADERS
) &&

1187 
vma
->
vm_pgoff
 =ğ0 && (vma->
vm_æags
 & 
VM_READ
)) {

1188 
u32
 
__u£r
 *
h—d”
 = (u32 __u£¸*è
vma
->
vm_¡¬t
;

1189 
u32
 
wÜd
;

1190 
mm_£gm’t_t
 
fs
 = 
	`g‘_fs
();

1195 
u32
 
cmp
;

1196 
podmag
[
SPODMAG
];

1197 } 
magic
;

1198 
	`BUILD_BUG_ON
(
SPODMAG
 !ğ 
wÜd
);

1199 
magic
.
podmag
[
EI_MAG0
] = 
PODMAG0
;

1200 
magic
.
podmag
[
EI_MAG1
] = 
PODMAG1
;

1201 
magic
.
podmag
[
EI_MAG2
] = 
PODMAG2
;

1202 
magic
.
podmag
[
EI_MAG3
] = 
PODMAG3
;

1207 
	`£t_fs
(
USER_DS
);

1208 ià(
	`uÆik–y
(
	`g‘_u£r
(
wÜd
, 
h—d”
)))

1209 
wÜd
 = 0;

1210 
	`£t_fs
(
fs
);

1211 ià(
wÜd
 =ğ
magic
.
cmp
)

1212  
PAGE_SIZE
;

1215 #undeà
FILTER


1219 
whŞe
:

1220  
vma
->
vm_’d
 - vma->
vm_¡¬t
;

1221 
	}
}

1224 
	smempodnÙe


1226 cÚ¡ *
	mÇme
;

1227 
	mty³
;

1228 
	md©asz
;

1229 *
	md©a
;

1232 
	$nÙesize
(
mempodnÙe
 *
’
)

1234 
sz
;

1236 
sz
 = (
pod_nÙe
);

1237 
sz
 +ğ
	`roundup
(
	`¡¾’
(
’
->
Çme
) + 1, 4);

1238 
sz
 +ğ
	`roundup
(
’
->
d©asz
, 4);

1240  
sz
;

1241 
	}
}

1243 
	#DUMP_WRITE
(
addr
, 
Ä
, 
foff£t
) \

1244 dØ{ ià(!
	`dump_wr™e
(
fe
, (
addr
), (
Ä
))è 0; *
foff£t
 +ğÒr); } 0)

	)

1246 
	$®ignfe
(
fe
 *fe, 
loff_t
 *
foff£t
)

1248 cÚ¡ 
buf
[4] = { 0, };

1249 
	`DUMP_WRITE
(
buf
, 
	`roundup
(*
foff£t
, 4) - *foffset, foffset);

1251 
	}
}

1253 
	$wr™’Ùe
(
mempodnÙe
 *
m’
, 
fe
 *file,

1254 
loff_t
 *
foff£t
)

1256 
pod_nÙe
 
’
;

1257 
’
.
n_Çmesz
 = 
	`¡¾’
(
m’
->
Çme
) + 1;

1258 
’
.
n_descsz
 = 
m’
->
d©asz
;

1259 
’
.
n_ty³
 = 
m’
->
ty³
;

1261 
	`DUMP_WRITE
(&
’
, Ón), 
foff£t
);

1262 
	`DUMP_WRITE
(
m’
->
Çme
, 
’
.
n_Çmesz
, 
foff£t
);

1263 ià(!
	`®ignfe
(
fe
, 
foff£t
))

1265 
	`DUMP_WRITE
(
m’
->
d©a
, m’->
d©asz
, 
foff£t
);

1266 ià(!
	`®ignfe
(
fe
, 
foff£t
))

1270 
	}
}

1271 #undeà
DUMP_WRITE


1273 
	$fl_pod_h—d”
(
podhdr
 *
pod
, 
£gs
,

1274 
u16
 
machše
, 
u32
 
æags
, 
u8
 
o§bi
)

1276 
	`mem£t
(
pod
, 0, (*pod));

1278 
	`memıy
(
pod
->
e_id’t
, 
PODMAG
, 
SELFMAG
);

1279 
pod
->
e_id’t
[
EI_CLASS
] = 
POD_CLASS
;

1280 
pod
->
e_id’t
[
EI_DATA
] = 
POD_DATA
;

1281 
pod
->
e_id’t
[
EI_VERSION
] = 
EV_CURRENT
;

1282 
pod
->
e_id’t
[
EI_OSABI
] = 
POD_OSABI
;

1284 
pod
->
e_ty³
 = 
ET_CORE
;

1285 
pod
->
e_machše
 = 
machše
;

1286 
pod
->
e_v”siÚ
 = 
EV_CURRENT
;

1287 
pod
->
e_phoff
 = (
podhdr
);

1288 
pod
->
e_æags
 = 
æags
;

1289 
pod
->
e_ehsize
 = (
podhdr
);

1290 
pod
->
e_ph’tsize
 = (
pod_phdr
);

1291 
pod
->
e_phnum
 = 
£gs
;

1294 
	}
}

1296 
	$fl_pod_nÙe_phdr
(
pod_phdr
 *
phdr
, 
sz
, 
loff_t
 
off£t
)

1298 
phdr
->
p_ty³
 = 
PT_NOTE
;

1299 
phdr
->
p_off£t
 = 
off£t
;

1300 
phdr
->
p_vaddr
 = 0;

1301 
phdr
->
p_·ddr
 = 0;

1302 
phdr
->
p_fesz
 = 
sz
;

1303 
phdr
->
p_memsz
 = 0;

1304 
phdr
->
p_æags
 = 0;

1305 
phdr
->
p_®ign
 = 0;

1307 
	}
}

1309 
	$fl_nÙe
(
mempodnÙe
 *
nÙe
, cÚ¡ *
Çme
, 
ty³
,

1310 
sz
, *
d©a
)

1312 
nÙe
->
Çme
 =‚ame;

1313 
nÙe
->
ty³
 =ype;

1314 
nÙe
->
d©asz
 = 
sz
;

1315 
nÙe
->
d©a
 = data;

1317 
	}
}

1323 
	$fl_´¡©us
(
pod_´¡©us
 *
´¡©us
,

1324 
sk_¡ruù
 *
p
, 
sigÄ
)

1326 
´¡©us
->
´_šfo
.
si_signo
 =…r¡©us->
´_cursig
 = 
sigÄ
;

1327 
´¡©us
->
´_sig³nd
 = 
p
->
³ndšg
.
sigÇl
.
sig
[0];

1328 
´¡©us
->
´_sighŞd
 = 
p
->
blocked
.
sig
[0];

1329 
	`rcu_»ad_lock
();

1330 
´¡©us
->
´_µid
 = 
	`sk_pid_vÄ
(
	`rcu_d”eã»nû
(
p
->
»®_·»Á
));

1331 
	`rcu_»ad_uÆock
();

1332 
´¡©us
->
´_pid
 = 
	`sk_pid_vÄ
(
p
);

1333 
´¡©us
->
´_pg½
 = 
	`sk_pg½_vÄ
(
p
);

1334 
´¡©us
->
´_sid
 = 
	`sk_£ssiÚ_vÄ
(
p
);

1335 ià(
	`th»ad_group_Ëad”
(
p
)) {

1336 
sk_ıutime
 
ıutime
;

1342 
	`th»ad_group_ıutime
(
p
, &
ıutime
);

1343 
	`ıutime_to_timev®
(
ıutime
.
utime
, &
´¡©us
->
´_utime
);

1344 
	`ıutime_to_timev®
(
ıutime
.
¡ime
, &
´¡©us
->
´_¡ime
);

1346 
	`ıutime_to_timev®
(
p
->
utime
, &
´¡©us
->
´_utime
);

1347 
	`ıutime_to_timev®
(
p
->
¡ime
, &
´¡©us
->
´_¡ime
);

1349 
	`ıutime_to_timev®
(
p
->
sigÇl
->
cutime
, &
´¡©us
->
´_cutime
);

1350 
	`ıutime_to_timev®
(
p
->
sigÇl
->
c¡ime
, &
´¡©us
->
´_c¡ime
);

1351 
	}
}

1353 
	$fl_psšfo
(
pod_´psšfo
 *
psšfo
, 
sk_¡ruù
 *
p
,

1354 
mm_¡ruù
 *
mm
)

1356 cÚ¡ 
üed
 *cred;

1357 
i
, 
Ën
;

1360 
	`mem£t
(
psšfo
, 0, (
pod_´psšfo
));

1362 
Ën
 = 
mm
->
¬g_’d
 - mm->
¬g_¡¬t
;

1363 ià(
Ën
 >ğ
POD_PRARGSZ
)

1364 
Ën
 = 
POD_PRARGSZ
-1;

1365 ià(
	`cİy_äom_u£r
(&
psšfo
->
´_p§rgs
,

1366 (cÚ¡ 
__u£r
 *)
mm
->
¬g_¡¬t
, 
Ën
))

1367  -
EFAULT
;

1368 
i
 = 0; i < 
Ën
; i++)

1369 ià(
psšfo
->
´_p§rgs
[
i
] == 0)

1370 
psšfo
->
´_p§rgs
[
i
] = ' ';

1371 
psšfo
->
´_p§rgs
[
Ën
] = 0;

1373 
	`rcu_»ad_lock
();

1374 
psšfo
->
´_µid
 = 
	`sk_pid_vÄ
(
	`rcu_d”eã»nû
(
p
->
»®_·»Á
));

1375 
	`rcu_»ad_uÆock
();

1376 
psšfo
->
´_pid
 = 
	`sk_pid_vÄ
(
p
);

1377 
psšfo
->
´_pg½
 = 
	`sk_pg½_vÄ
(
p
);

1378 
psšfo
->
´_sid
 = 
	`sk_£ssiÚ_vÄ
(
p
);

1380 
i
 = 
p
->
¡©e
 ? 
	`ffz
(~p->state) + 1 : 0;

1381 
psšfo
->
´_¡©e
 = 
i
;

1382 
psšfo
->
´_¢ame
 = (
i
 > 5) ? '.' : "RSDTZW"[i];

1383 
psšfo
->
´_zomb
 =…sšfo->
´_¢ame
 == 'Z';

1384 
psšfo
->
´_niû
 = 
	`sk_niû
(
p
);

1385 
psšfo
->
´_æag
 = 
p
->
æags
;

1386 
	`rcu_»ad_lock
();

1387 
üed
 = 
	`__sk_üed
(
p
);

1388 
	`SET_UID
(
psšfo
->
´_uid
, 
üed
->
uid
);

1389 
	`SET_GID
(
psšfo
->
´_gid
, 
üed
->
gid
);

1390 
	`rcu_»ad_uÆock
();

1391 
	`¡ºıy
(
psšfo
->
´_âame
, 
p
->
comm
, (psinfo->pr_fname));

1394 
	}
}

1396 
	$fl_auxv_nÙe
(
mempodnÙe
 *
nÙe
, 
mm_¡ruù
 *
mm
)

1398 
pod_addr_t
 *
auxv
 = (pod_addr_ˆ*è
mm
->
§ved_auxv
;

1399 
i
 = 0;

1401 
i
 += 2;

1402 
auxv
[
i
 - 2] !ğ
AT_NULL
);

1403 
	`fl_nÙe
(
nÙe
, "CORE", 
NT_AUXV
, 
i
 * (
pod_addr_t
), 
auxv
);

1404 
	}
}

1406 #ifdeà
CORE_DUMP_USE_REGSET


1407 
	~<lšux/»g£t.h
>

1409 
	spod_th»ad_cÜe_šfo
 {

1410 
pod_th»ad_cÜe_šfo
 *
	mÃxt
;

1411 
sk_¡ruù
 *
	msk
;

1412 
pod_´¡©us
 
	m´¡©us
;

1413 
mempodnÙe
 
	mnÙes
[0];

1416 
	spod_nÙe_šfo
 {

1417 
pod_th»ad_cÜe_šfo
 *
	mth»ad
;

1418 
mempodnÙe
 
	mpsšfo
;

1419 
mempodnÙe
 
	mauxv
;

1420 
size_t
 
	msize
;

1421 
	mth»ad_nÙes
;

1429 
	$do_th»ad_»g£t_wr™eback
(
sk_¡ruù
 *
sk
,

1430 cÚ¡ 
u£r_»g£t
 *
»g£t
)

1432 ià(
»g£t
->
wr™eback
)

1433 
»g£t
->
	`wr™eback
(
sk
,„egset, 1);

1434 
	}
}

1436 
	$fl_th»ad_cÜe_šfo
(
pod_th»ad_cÜe_šfo
 *
t
,

1437 cÚ¡ 
u£r_»g£t_v›w
 *
v›w
,

1438 
sigÄ
, 
size_t
 *
tÙ®
)

1440 
i
;

1448 
	`fl_´¡©us
(&
t
->
´¡©us
,->
sk
, 
sigÄ
);

1449 (è
v›w
->
»g£ts
[0].
	`g‘
(
t
->
sk
, &view->regsets[0],

1450 0, (
t
->
´¡©us
.
´_»g
),

1451 &
t
->
´¡©us
.
´_»g
, 
NULL
);

1453 
	`fl_nÙe
(&
t
->
nÙes
[0], "CORE", 
NT_PRSTATUS
,

1454 (
t
->
´¡©us
), &t->prstatus);

1455 *
tÙ®
 +ğ
	`nÙesize
(&
t
->
nÙes
[0]);

1457 
	`do_th»ad_»g£t_wr™eback
(
t
->
sk
, &
v›w
->
»g£ts
[0]);

1464 
i
 = 1; i < 
v›w
->
n
; ++i) {

1465 cÚ¡ 
u£r_»g£t
 *
»g£t
 = &
v›w
->
»g£ts
[
i
];

1466 
	`do_th»ad_»g£t_wr™eback
(
t
->
sk
, 
»g£t
);

1467 ià(
»g£t
->
cÜe_nÙe_ty³
 &&

1468 (!
»g£t
->
aùive
 ||„eg£t->
	`aùive
(
t
->
sk
,„egset))) {

1469 
»t
;

1470 
size_t
 
size
 = 
»g£t
->
n
 *„egset->size;

1471 *
d©a
 = 
	`km®loc
(
size
, 
GFP_KERNEL
);

1472 ià(
	`uÆik–y
(!
d©a
))

1474 
»t
 = 
»g£t
->
	`g‘
(
t
->
sk
,„egset,

1475 0, 
size
, 
d©a
, 
NULL
);

1476 ià(
	`uÆik–y
(
»t
))

1477 
	`kä“
(
d©a
);

1479 ià(
»g£t
->
cÜe_nÙe_ty³
 !ğ
NT_PRFPREG
)

1480 
	`fl_nÙe
(&
t
->
nÙes
[
i
], "LINUX",

1481 
»g£t
->
cÜe_nÙe_ty³
,

1482 
size
, 
d©a
);

1484 
t
->
´¡©us
.
´_åv®id
 = 1;

1485 
	`fl_nÙe
(&
t
->
nÙes
[
i
], "CORE",

1486 
NT_PRFPREG
, 
size
, 
d©a
);

1488 *
tÙ®
 +ğ
	`nÙesize
(&
t
->
nÙes
[
i
]);

1494 
	}
}

1496 
	$fl_nÙe_šfo
(
podhdr
 *
pod
, 
phdrs
,

1497 
pod_nÙe_šfo
 *
šfo
,

1498 
sigÄ
, 
±_»gs
 *
»gs
)

1500 
sk_¡ruù
 *
dump_sk
 = 
cu¼’t
;

1501 cÚ¡ 
u£r_»g£t_v›w
 *
v›w
 = 
	`sk_u£r_»g£t_v›w
(
dump_sk
);

1502 
pod_th»ad_cÜe_šfo
 *
t
;

1503 
pod_´psšfo
 *
psšfo
;

1504 
cÜe_th»ad
 *
ù
;

1505 
i
;

1507 
šfo
->
size
 = 0;

1508 
šfo
->
th»ad
 = 
NULL
;

1510 
psšfo
 = 
	`km®loc
((*psšfo), 
GFP_KERNEL
);

1511 ià(
psšfo
 =ğ
NULL
)

1514 
	`fl_nÙe
(&
šfo
->
psšfo
, "CORE", 
NT_PRPSINFO
, (*psinfo),…sinfo);

1519 
šfo
->
th»ad_nÙes
 = 0;

1520 
i
 = 0; i < 
v›w
->
n
; ++i)

1521 ià(
v›w
->
»g£ts
[
i
].
cÜe_nÙe_ty³
 != 0)

1522 ++
šfo
->
th»ad_nÙes
;

1528 ià(
	`uÆik–y
(
šfo
->
th»ad_nÙes
 == 0) ||

1529 
	`uÆik–y
(
v›w
->
»g£ts
[0].
cÜe_nÙe_ty³
 !ğ
NT_PRSTATUS
)) {

1530 
	`WARN_ON
(1);

1537 
	`fl_pod_h—d”
(
pod
, 
phdrs
,

1538 
v›w
->
e_machše
, v›w->
e_æags
, v›w->
ei_o§bi
);

1543 
ù
 = &
dump_sk
->
mm
->
cÜe_¡©e
->
dum³r
; ct; cˆğù->
Ãxt
) {

1544 
t
 = 
	`kz®loc
(
	`off£tof
(
pod_th»ad_cÜe_šfo
,

1545 
nÙes
[
šfo
->
th»ad_nÙes
]),

1546 
GFP_KERNEL
);

1547 ià(
	`uÆik–y
(!
t
))

1550 
t
->
sk
 = 
ù
->task;

1551 ià(
ù
->
sk
 =ğ
dump_sk
 || !
šfo
->
th»ad
) {

1552 
t
->
Ãxt
 = 
šfo
->
th»ad
;

1553 
šfo
->
th»ad
 = 
t
;

1559 
t
->
Ãxt
 = 
šfo
->
th»ad
->next;

1560 
šfo
->
th»ad
->
Ãxt
 = 
t
;

1567 
t
 = 
šfo
->
th»ad
; !ğ
NULL
; =->
Ãxt
)

1568 ià(!
	`fl_th»ad_cÜe_šfo
(
t
, 
v›w
, 
sigÄ
, &
šfo
->
size
))

1574 
	`fl_psšfo
(
psšfo
, 
dump_sk
->
group_Ëad”
, dump_sk->
mm
);

1575 
šfo
->
size
 +ğ
	`nÙesize
(&šfo->
psšfo
);

1577 
	`fl_auxv_nÙe
(&
šfo
->
auxv
, 
cu¼’t
->
mm
);

1578 
šfo
->
size
 +ğ
	`nÙesize
(&šfo->
auxv
);

1581 
	}
}

1583 
size_t
 
	$g‘_nÙe_šfo_size
(
pod_nÙe_šfo
 *
šfo
)

1585  
šfo
->
size
;

1586 
	}
}

1592 
	$wr™e_nÙe_šfo
(
pod_nÙe_šfo
 *
šfo
,

1593 
fe
 *fe, 
loff_t
 *
foff£t
)

1595 
boŞ
 
fœ¡
 = 1;

1596 
pod_th»ad_cÜe_šfo
 *
t
 = 
šfo
->
th»ad
;

1599 
i
;

1601 ià(!
	`wr™’Ùe
(&
t
->
nÙes
[0], 
fe
, 
foff£t
))

1604 ià(
fœ¡
 && !
	`wr™’Ùe
(&
šfo
->
psšfo
, 
fe
, 
foff£t
))

1606 ià(
fœ¡
 && !
	`wr™’Ùe
(&
šfo
->
auxv
, 
fe
, 
foff£t
))

1609 
i
 = 1; i < 
šfo
->
th»ad_nÙes
; ++i)

1610 ià(
t
->
nÙes
[
i
].
d©a
 &&

1611 !
	`wr™’Ùe
(&
t
->
nÙes
[
i
], 
fe
, 
foff£t
))

1614 
fœ¡
 = 0;

1615 
t
 =->
Ãxt
;

1616 } 
t
);

1619 
	}
}

1621 
	$ä“_nÙe_šfo
(
pod_nÙe_šfo
 *
šfo
)

1623 
pod_th»ad_cÜe_šfo
 *
th»ads
 = 
šfo
->
th»ad
;

1624 
th»ads
) {

1625 
i
;

1626 
pod_th»ad_cÜe_šfo
 *
t
 = 
th»ads
;

1627 
th»ads
 = 
t
->
Ãxt
;

1628 
	`WARN_ON
(
t
->
nÙes
[0].
d©a
 &&->nÙes[0].d©¨!ğ&t->
´¡©us
);

1629 
i
 = 1; i < 
šfo
->
th»ad_nÙes
; ++i)

1630 
	`kä“
(
t
->
nÙes
[
i
].
d©a
);

1631 
	`kä“
(
t
);

1633 
	`kä“
(
šfo
->
psšfo
.
d©a
);

1634 
	}
}

1639 
	spod_th»ad_¡©us


1641 
li¡_h—d
 
	mli¡
;

1642 
pod_´¡©us
 
	m´¡©us
;

1643 
pod_å»g£t_t
 
	måu
;

1644 
sk_¡ruù
 *
	mth»ad
;

1645 #ifdeà
POD_CORE_COPY_XFPREGS


1646 
pod_åx»g£t_t
 
	mxåu
;

1648 
mempodnÙe
 
	mnÙes
[3];

1649 
	mnum_nÙes
;

1657 
	$pod_dump_th»ad_¡©us
(
sigÄ
, 
pod_th»ad_¡©us
 *
t
)

1659 
sz
 = 0;

1660 
sk_¡ruù
 *
p
 = 
t
->
th»ad
;

1661 
t
->
num_nÙes
 = 0;

1663 
	`fl_´¡©us
(&
t
->
´¡©us
, 
p
, 
sigÄ
);

1664 
	`pod_cÜe_cİy_sk_»gs
(
p
, &
t
->
´¡©us
.
´_»g
);

1666 
	`fl_nÙe
(&
t
->
nÙes
[0], "CORE", 
NT_PRSTATUS
, Ñ->
´¡©us
),

1667 &(
t
->
´¡©us
));

1668 
t
->
num_nÙes
++;

1669 
sz
 +ğ
	`nÙesize
(&
t
->
nÙes
[0]);

1671 ià((
t
->
´¡©us
.
´_åv®id
 = 
	`pod_cÜe_cİy_sk_å»gs
(
p
, 
NULL
,

1672 &
t
->
åu
))) {

1673 
	`fl_nÙe
(&
t
->
nÙes
[1], "CORE", 
NT_PRFPREG
, Ñ->
åu
),

1674 &(
t
->
åu
));

1675 
t
->
num_nÙes
++;

1676 
sz
 +ğ
	`nÙesize
(&
t
->
nÙes
[1]);

1679 #ifdeà
POD_CORE_COPY_XFPREGS


1680 ià(
	`pod_cÜe_cİy_sk_xå»gs
(
p
, &
t
->
xåu
)) {

1681 
	`fl_nÙe
(&
t
->
nÙes
[2], "LINUX", 
POD_CORE_XFPREG_TYPE
,

1682 (
t
->
xåu
), &t->xfpu);

1683 
t
->
num_nÙes
++;

1684 
sz
 +ğ
	`nÙesize
(&
t
->
nÙes
[2]);

1687  
sz
;

1688 
	}
}

1690 
	spod_nÙe_šfo
 {

1691 
mempodnÙe
 *
	mnÙes
;

1692 
pod_´¡©us
 *
	m´¡©us
;

1693 
pod_´psšfo
 *
	mpsšfo
;

1694 
li¡_h—d
 
	mth»ad_li¡
;

1695 
pod_å»g£t_t
 *
	måu
;

1696 #ifdeà
POD_CORE_COPY_XFPREGS


1697 
pod_åx»g£t_t
 *
	mxåu
;

1699 
	mth»ad_¡©us_size
;

1700 
	mnumnÙe
;

1703 
	$pod_nÙe_šfo_š™
(
pod_nÙe_šfo
 *
šfo
)

1705 
	`mem£t
(
šfo
, 0, (*info));

1706 
	`INIT_LIST_HEAD
(&
šfo
->
th»ad_li¡
);

1709 
šfo
->
nÙes
 = 
	`km®loc
(6 * (
mempodnÙe
), 
GFP_KERNEL
);

1710 ià(!
šfo
->
nÙes
)

1712 
šfo
->
psšfo
 = 
	`km®loc
((*šfo->psšfo), 
GFP_KERNEL
);

1713 ià(!
šfo
->
psšfo
)

1714 
nÙes_ä“
;

1715 
šfo
->
´¡©us
 = 
	`km®loc
((*šfo->´¡©us), 
GFP_KERNEL
);

1716 ià(!
šfo
->
´¡©us
)

1717 
psšfo_ä“
;

1718 
šfo
->
åu
 = 
	`km®loc
((*šfo->åu), 
GFP_KERNEL
);

1719 ià(!
šfo
->
åu
)

1720 
´¡©us_ä“
;

1721 #ifdeà
POD_CORE_COPY_XFPREGS


1722 
šfo
->
xåu
 = 
	`km®loc
((*šfo->xåu), 
GFP_KERNEL
);

1723 ià(!
šfo
->
xåu
)

1724 
åu_ä“
;

1727 #ifdeà
POD_CORE_COPY_XFPREGS


1728 
åu_ä“
:

1729 
	`kä“
(
šfo
->
åu
);

1731 
´¡©us_ä“
:

1732 
	`kä“
(
šfo
->
´¡©us
);

1733 
psšfo_ä“
:

1734 
	`kä“
(
šfo
->
psšfo
);

1735 
nÙes_ä“
:

1736 
	`kä“
(
šfo
->
nÙes
);

1738 
	}
}

1740 
	$fl_nÙe_šfo
(
podhdr
 *
pod
, 
phdrs
,

1741 
pod_nÙe_šfo
 *
šfo
,

1742 
sigÄ
, 
±_»gs
 *
»gs
)

1744 
li¡_h—d
 *
t
;

1746 ià(!
	`pod_nÙe_šfo_š™
(
šfo
))

1749 ià(
sigÄ
) {

1750 
cÜe_th»ad
 *
ù
;

1751 
pod_th»ad_¡©us
 *
‘s
;

1753 
ù
 = 
cu¼’t
->
mm
->
cÜe_¡©e
->
dum³r
.
Ãxt
;

1754 
ù
; cˆğù->
Ãxt
) {

1755 
‘s
 = 
	`kz®loc
((*‘s), 
GFP_KERNEL
);

1756 ià(!
‘s
)

1759 
‘s
->
th»ad
 = 
ù
->
sk
;

1760 
	`li¡_add
(&
‘s
->
li¡
, &
šfo
->
th»ad_li¡
);

1763 
	`li¡_fÜ_—ch
(
t
, &
šfo
->
th»ad_li¡
) {

1764 
sz
;

1766 
‘s
 = 
	`li¡_’Œy
(
t
, 
pod_th»ad_¡©us
, 
li¡
);

1767 
sz
 = 
	`pod_dump_th»ad_¡©us
(
sigÄ
, 
‘s
);

1768 
šfo
->
th»ad_¡©us_size
 +ğ
sz
;

1772 
	`mem£t
(
šfo
->
´¡©us
, 0, (*info->prstatus));

1773 
	`fl_´¡©us
(
šfo
->
´¡©us
, 
cu¼’t
, 
sigÄ
);

1774 
	`pod_cÜe_cİy_»gs
(&
šfo
->
´¡©us
->
´_»g
, 
»gs
);

1777 
	`fl_pod_h—d”
(
pod
, 
phdrs
, 
POD_ARCH
, 
POD_CORE_EFLAGS
, 
POD_OSABI
);

1784 
	`fl_nÙe
(
šfo
->
nÙes
 + 0, "CORE", 
NT_PRSTATUS
,

1785 (*
šfo
->
´¡©us
), info->prstatus);

1786 
	`fl_psšfo
(
šfo
->
psšfo
, 
cu¼’t
->
group_Ëad”
, cu¼’t->
mm
);

1787 
	`fl_nÙe
(
šfo
->
nÙes
 + 1, "CORE", 
NT_PRPSINFO
,

1788 (*
šfo
->
psšfo
), info->psinfo);

1790 
šfo
->
numnÙe
 = 2;

1792 
	`fl_auxv_nÙe
(&
šfo
->
nÙes
[šfo->
numnÙe
++], 
cu¼’t
->
mm
);

1795 
šfo
->
´¡©us
->
´_åv®id
 = 
	`pod_cÜe_cİy_sk_å»gs
(
cu¼’t
, 
»gs
,

1796 
šfo
->
åu
);

1797 ià(
šfo
->
´¡©us
->
´_åv®id
)

1798 
	`fl_nÙe
(
šfo
->
nÙes
 + info->
numnÙe
++,

1799 "CORE", 
NT_PRFPREG
, (*
šfo
->
åu
), info->fpu);

1800 #ifdeà
POD_CORE_COPY_XFPREGS


1801 ià(
	`pod_cÜe_cİy_sk_xå»gs
(
cu¼’t
, 
šfo
->
xåu
))

1802 
	`fl_nÙe
(
šfo
->
nÙes
 + info->
numnÙe
++,

1803 "LINUX", 
POD_CORE_XFPREG_TYPE
,

1804 (*
šfo
->
xåu
), info->xfpu);

1808 
	}
}

1810 
size_t
 
	$g‘_nÙe_šfo_size
(
pod_nÙe_šfo
 *
šfo
)

1812 
sz
 = 0;

1813 
i
;

1815 
i
 = 0; i < 
šfo
->
numnÙe
; i++)

1816 
sz
 +ğ
	`nÙesize
(
šfo
->
nÙes
 + 
i
);

1818 
sz
 +ğ
šfo
->
th»ad_¡©us_size
;

1820  
sz
;

1821 
	}
}

1823 
	$wr™e_nÙe_šfo
(
pod_nÙe_šfo
 *
šfo
,

1824 
fe
 *fe, 
loff_t
 *
foff£t
)

1826 
i
;

1827 
li¡_h—d
 *
t
;

1829 
i
 = 0; i < 
šfo
->
numnÙe
; i++)

1830 ià(!
	`wr™’Ùe
(
šfo
->
nÙes
 + 
i
, 
fe
, 
foff£t
))

1834 
	`li¡_fÜ_—ch
(
t
, &
šfo
->
th»ad_li¡
) {

1835 
pod_th»ad_¡©us
 *
tmp
 =

1836 
	`li¡_’Œy
(
t
, 
pod_th»ad_¡©us
, 
li¡
);

1838 
i
 = 0; i < 
tmp
->
num_nÙes
; i++)

1839 ià(!
	`wr™’Ùe
(&
tmp
->
nÙes
[
i
], 
fe
, 
foff£t
))

1844 
	}
}

1846 
	$ä“_nÙe_šfo
(
pod_nÙe_šfo
 *
šfo
)

1848 !
	`li¡_em±y
(&
šfo
->
th»ad_li¡
)) {

1849 
li¡_h—d
 *
tmp
 = 
šfo
->
th»ad_li¡
.
Ãxt
;

1850 
	`li¡_d–
(
tmp
);

1851 
	`kä“
(
	`li¡_’Œy
(
tmp
, 
pod_th»ad_¡©us
, 
li¡
));

1854 
	`kä“
(
šfo
->
´¡©us
);

1855 
	`kä“
(
šfo
->
psšfo
);

1856 
	`kä“
(
šfo
->
nÙes
);

1857 
	`kä“
(
šfo
->
åu
);

1858 #ifdeà
POD_CORE_COPY_XFPREGS


1859 
	`kä“
(
šfo
->
xåu
);

1861 
	}
}

1865 
vm_¬—_¡ruù
 *
	$fœ¡_vma
(
sk_¡ruù
 *
tsk
,

1866 
vm_¬—_¡ruù
 *
g©e_vma
)

1868 
vm_¬—_¡ruù
 *
»t
 = 
tsk
->
mm
->
mm­
;

1870 ià(
»t
)

1871  
»t
;

1872  
g©e_vma
;

1873 
	}
}

1878 
vm_¬—_¡ruù
 *
	$Ãxt_vma
(
vm_¬—_¡ruù
 *
this_vma
,

1879 
vm_¬—_¡ruù
 *
g©e_vma
)

1881 
vm_¬—_¡ruù
 *
»t
;

1883 
»t
 = 
this_vma
->
vm_Ãxt
;

1884 ià(
»t
)

1885  
»t
;

1886 ià(
this_vma
 =ğ
g©e_vma
)

1887  
NULL
;

1888  
g©e_vma
;

1889 
	}
}

1891 
	$fl_exŠum_šfo
(
podhdr
 *
pod
, 
pod_shdr
 *
shdr4exŠum
,

1892 
pod_addr_t
 
e_shoff
, 
£gs
)

1894 
pod
->
e_shoff
 =ƒ_shoff;

1895 
pod
->
e_sh’tsize
 = (*
shdr4exŠum
);

1896 
pod
->
e_shnum
 = 1;

1897 
pod
->
e_sh¡ºdx
 = 
SHN_UNDEF
;

1899 
	`mem£t
(
shdr4exŠum
, 0, (*shdr4extnum));

1901 
shdr4exŠum
->
sh_ty³
 = 
SHT_NULL
;

1902 
shdr4exŠum
->
sh_size
 = 
pod
->
e_shnum
;

1903 
shdr4exŠum
->
sh_lšk
 = 
pod
->
e_sh¡ºdx
;

1904 
shdr4exŠum
->
sh_šfo
 = 
£gs
;

1905 
	}
}

1907 
size_t
 
	$pod_cÜe_vma_d©a_size
(
vm_¬—_¡ruù
 *
g©e_vma
,

1908 
mm_æags
)

1910 
vm_¬—_¡ruù
 *
vma
;

1911 
size_t
 
size
 = 0;

1913 
vma
 = 
	`fœ¡_vma
(
cu¼’t
, 
g©e_vma
); vm¨!ğ
NULL
;

1914 
vma
 = 
	`Ãxt_vma
(vma, 
g©e_vma
))

1915 
size
 +ğ
	`vma_dump_size
(
vma
, 
mm_æags
);

1916  
size
;

1917 
	}
}

1926 
	$pod_cÜe_dump
(
cÜedump_·¿ms
 *
ırm
)

1928 
has_dum³d
 = 0;

1929 
mm_£gm’t_t
 
fs
;

1930 
£gs
;

1931 
size_t
 
size
 = 0;

1932 
vm_¬—_¡ruù
 *
vma
, *
g©e_vma
;

1933 
podhdr
 *
pod
 = 
NULL
;

1934 
loff_t
 
off£t
 = 0, 
d©aoff
, 
foff£t
;

1935 
pod_nÙe_šfo
 
šfo
;

1936 
pod_phdr
 *
phdr4nÙe
 = 
NULL
;

1937 
pod_shdr
 *
shdr4exŠum
 = 
NULL
;

1938 
Pod_H®f
 
e_phnum
;

1939 
pod_addr_t
 
e_shoff
;

1954 
pod
 = 
	`km®loc
((*pod), 
GFP_KERNEL
);

1960 ià(!
pod
)

1961 
out
;

1966 
£gs
 = 
cu¼’t
->
mm
->
m­_couÁ
;

1967 
£gs
 +ğ
	`pod_cÜe_exŒa_phdrs
();

1969 
g©e_vma
 = 
	`g‘_g©e_vma
(
cu¼’t
->
mm
);

1970 ià(
g©e_vma
 !ğ
NULL
)

1971 
£gs
++;

1974 
£gs
++;

1979 
e_phnum
 = 
£gs
 > 
PN_XNUM
 ? PN_XNUM : segs;

1985 ià(!
	`fl_nÙe_šfo
(
pod
, 
e_phnum
, &
šfo
, 
ırm
->
sigÄ
, c´m->
»gs
))

1986 
ş—nup
;

1988 
has_dum³d
 = 1;

1989 
cu¼’t
->
æags
 |ğ
PF_DUMPCORE
;

1991 
fs
 = 
	`g‘_fs
();

1992 
	`£t_fs
(
KERNEL_DS
);

1994 
off£t
 +ğ(*
pod
);

1995 
off£t
 +ğ
£gs
 * (
pod_phdr
);

1996 
foff£t
 = 
off£t
;

2000 
size_t
 
sz
 = 
	`g‘_nÙe_šfo_size
(&
šfo
);

2002 
sz
 +ğ
	`pod_cÜedump_exŒa_nÙes_size
();

2004 
phdr4nÙe
 = 
	`km®loc
((*phdr4nÙe), 
GFP_KERNEL
);

2005 ià(!
phdr4nÙe
)

2006 
’d_cÜedump
;

2008 
	`fl_pod_nÙe_phdr
(
phdr4nÙe
, 
sz
, 
off£t
);

2009 
off£t
 +ğ
sz
;

2012 
d©aoff
 = 
off£t
 = 
	`roundup
(off£t, 
POD_EXEC_PAGESIZE
);

2014 
off£t
 +ğ
	`pod_cÜe_vma_d©a_size
(
g©e_vma
, 
ırm
->
mm_æags
);

2015 
off£t
 +ğ
	`pod_cÜe_exŒa_d©a_size
();

2016 
e_shoff
 = 
off£t
;

2018 ià(
e_phnum
 =ğ
PN_XNUM
) {

2019 
shdr4exŠum
 = 
	`km®loc
((*shdr4exŠum), 
GFP_KERNEL
);

2020 ià(!
shdr4exŠum
)

2021 
’d_cÜedump
;

2022 
	`fl_exŠum_šfo
(
pod
, 
shdr4exŠum
, 
e_shoff
, 
£gs
);

2025 
off£t
 = 
d©aoff
;

2027 
size
 +ğ(*
pod
);

2028 ià(
size
 > 
ırm
->
lim™
 || !
	`dump_wr™e
(ırm->
fe
, 
pod
, (*pod)))

2029 
’d_cÜedump
;

2031 
size
 +ğ(*
phdr4nÙe
);

2032 ià(
size
 > 
ırm
->
lim™


2033 || !
	`dump_wr™e
(
ırm
->
fe
, 
phdr4nÙe
, (*phdr4note)))

2034 
’d_cÜedump
;

2037 
vma
 = 
	`fœ¡_vma
(
cu¼’t
, 
g©e_vma
); vm¨!ğ
NULL
;

2038 
vma
 = 
	`Ãxt_vma
(vma, 
g©e_vma
)) {

2039 
pod_phdr
 
phdr
;

2041 
phdr
.
p_ty³
 = 
PT_LOAD
;

2042 
phdr
.
p_off£t
 = 
off£t
;

2043 
phdr
.
p_vaddr
 = 
vma
->
vm_¡¬t
;

2044 
phdr
.
p_·ddr
 = 0;

2045 
phdr
.
p_fesz
 = 
	`vma_dump_size
(
vma
, 
ırm
->
mm_æags
);

2046 
phdr
.
p_memsz
 = 
vma
->
vm_’d
 - vma->
vm_¡¬t
;

2047 
off£t
 +ğ
phdr
.
p_fesz
;

2048 
phdr
.
p_æags
 = 
vma
->
vm_æags
 & 
VM_READ
 ? 
PF_R
 : 0;

2049 ià(
vma
->
vm_æags
 & 
VM_WRITE
)

2050 
phdr
.
p_æags
 |ğ
PF_W
;

2051 ià(
vma
->
vm_æags
 & 
VM_EXEC
)

2052 
phdr
.
p_æags
 |ğ
PF_X
;

2053 
phdr
.
p_®ign
 = 
POD_EXEC_PAGESIZE
;

2055 
size
 +ğ(
phdr
);

2056 ià(
size
 > 
ırm
->
lim™


2057 || !
	`dump_wr™e
(
ırm
->
fe
, &
phdr
, (phdr)))

2058 
’d_cÜedump
;

2061 ià(!
	`pod_cÜe_wr™e_exŒa_phdrs
(
ırm
->
fe
, 
off£t
, &
size
, c´m->
lim™
))

2062 
’d_cÜedump
;

2065 ià(!
	`wr™e_nÙe_šfo
(&
šfo
, 
ırm
->
fe
, &
foff£t
))

2066 
’d_cÜedump
;

2068 ià(
	`pod_cÜedump_exŒa_nÙes_wr™e
(
ırm
->
fe
, &
foff£t
))

2069 
’d_cÜedump
;

2072 ià(!
	`dump_£ek
(
ırm
->
fe
, 
d©aoff
 - 
foff£t
))

2073 
’d_cÜedump
;

2075 
vma
 = 
	`fœ¡_vma
(
cu¼’t
, 
g©e_vma
); vm¨!ğ
NULL
;

2076 
vma
 = 
	`Ãxt_vma
(vma, 
g©e_vma
)) {

2077 
addr
;

2078 
’d
;

2080 
’d
 = 
vma
->
vm_¡¬t
 + 
	`vma_dump_size
(vma, 
ırm
->
mm_æags
);

2082 
addr
 = 
vma
->
vm_¡¬t
;‡dd¸< 
’d
;‡dd¸+ğ
PAGE_SIZE
) {

2083 
·ge
 *page;

2084 
¡İ
;

2086 
·ge
 = 
	`g‘_dump_·ge
(
addr
);

2087 ià(
·ge
) {

2088 *
kaddr
 = 
	`km­
(
·ge
);

2089 
¡İ
 = ((
size
 +ğ
PAGE_SIZE
è> 
ırm
->
lim™
) ||

2090 !
	`dump_wr™e
(
ırm
->
fe
, 
kaddr
,

2091 
PAGE_SIZE
);

2092 
	`kunm­
(
·ge
);

2093 
	`·ge_ÿche_»Ëa£
(
·ge
);

2095 
¡İ
 = !
	`dump_£ek
(
ırm
->
fe
, 
PAGE_SIZE
);

2096 ià(
¡İ
)

2097 
’d_cÜedump
;

2101 ià(!
	`pod_cÜe_wr™e_exŒa_d©a
(
ırm
->
fe
, &
size
, c´m->
lim™
))

2102 
’d_cÜedump
;

2104 ià(
e_phnum
 =ğ
PN_XNUM
) {

2105 
size
 +ğ(*
shdr4exŠum
);

2106 ià(
size
 > 
ırm
->
lim™


2107 || !
	`dump_wr™e
(
ırm
->
fe
, 
shdr4exŠum
,

2108 (*
shdr4exŠum
)))

2109 
’d_cÜedump
;

2112 
’d_cÜedump
:

2113 
	`£t_fs
(
fs
);

2115 
ş—nup
:

2116 
	`ä“_nÙe_šfo
(&
šfo
);

2117 
	`kä“
(
shdr4exŠum
);

2118 
	`kä“
(
phdr4nÙe
);

2119 
	`kä“
(
pod
);

2120 
out
:

2121  
has_dum³d
;

2122 
	}
}

2126 
__š™
 
	$š™_pod_bšfmt
()

2128 
	`´štk
("PodArch:„egistering/init…od binaryype \n");

2129  
	`»gi¡”_bšfmt
(&
pod_fÜm©
);

2130 
	}
}

2132 
__ex™
 
	$ex™_pod_bšfmt
()

2134 
	`´štk
("PodArch:ƒxiting…od binary†oader \n");

2136 
	`uÄegi¡”_bšfmt
(&
pod_fÜm©
);

2137 
	}
}

2139 
cÜe_š™ÿÎ
(
š™_pod_bšfmt
);

2140 
moduË_ex™
(
ex™_pod_bšfmt
);

2141 
MODULE_LICENSE
("GPL");

	@binfmt_pod_1.c

12 
	~<lšux/moduË.h
>

14 
	~<lšux/fs.h
>

15 
	~<lšux/¡©.h
>

16 
	~<lšux/sched.h
>

17 
	~<lšux/mm.h
>

18 
	~<lšux/mmª.h
>

19 
	~<lšux/”ºo.h
>

20 
	~<lšux/sigÇl.h
>

21 
	~<lšux/bšfmts.h
>

22 
	~<lšux/pod.h
>

23 
	~<lšux/¡ršg.h
>

24 
	~<lšux/fe.h
>

25 
	~<lšux/fú.h
>

26 
	~<lšux/±¿û.h
>

27 
	~<lšux/¦ab.h
>

28 
	~<lšux/shm.h
>

29 
	~<lšux/³rsÚ®™y.h
>

30 
	~<lšux/š™.h
>

32 
	~<asm/uacûss.h
>

33 
	~<asm/pgbË.h
>

36 
	~<lšux/–f.h
>

38 
lßd_pod_bš¬y
(
lšux_bš´m
 * 
b´m
, 
±_»gs
 * 
»gs
);

39 
lßd_pod_lib¿ry
(
fe
 *);

46 
pod_cÜe_dump
(
cÜedump_·¿ms
 *
ırm
);

48 
	#pod_cÜe_dump
 
NULL


	)

51 
	#POD_PAGESTART
(
_v
è((_vè& ~()(
POD_PAGESIZE
-1))

	)

52 
	#POD_PAGEOFFSET
(
_v
è((_vè& (
POD_PAGESIZE
-1))

	)

53 
	#POD_PAGEALIGN
(
_v
è(((_vè+ 
POD_PAGESIZE
 - 1è& ~(POD_PAGESIZE - 1))

	)

55 
lšux_bšfmt
 
	gpod_fÜm©
 = {

56 .
moduË
 = 
THIS_MODULE
,

57 .
	glßd_bš¬y
 = 
lßd_pod_bš¬y
,

58 .
	glßd_shlib
 = 
lßd_pod_lib¿ry
,

59 .
	gcÜe_dump
 = 
pod_cÜe_dump
,

60 .
	gmš_cÜedump
 = 
POD_PAGESIZE


68 
	$ü—‹_pod_bËs
(
lšux_bš´m
 *
b´m
)

70 **
¬gv
, **
’vp
;

71 
¬gc
 = 
b´m
->argc;

72 
’vc
 = 
b´m
->envc;

73 
p
;

74 *
¥
;

77 
¥
 = (*)((
b´m
->
p
 + 3) & ~3);

79 
’vp
 = (**è
¥
;

80 
¥
 +ğ
’vc
 + 1;

81 
¬gv
 = (**è
¥
;

82 
¥
 +ğ
¬gc
 + 1;

84 
	`__put_u£r
((è
’vp
,++
¥
);

85 
	`__put_u£r
((è
¬gv
,++
¥
);

87 
	`__put_u£r
(
¬gc
, ++
¥
);

89 
b´m
->
p
 = (è
¥
;

91 
p
 = 
cu¼’t
->
mm
->
¬g_¡¬t
;

92 
¬gc
-- > 0) {

93 
	`__put_u£r
((*)
p
,
¬gv
++);

94 
p
 +ğ
	`¡¾’_u£r
((*)p);

96 
	`__put_u£r
(
NULL
, 
¬gv
);

97 
cu¼’t
->
mm
->
¬g_’d
 = cu¼’t->mm->
’v_¡¬t
 = 
p
;

98 
’vc
-- > 0) {

99 
	`__put_u£r
((*)
p
,
’vp
++);

100 
p
 +ğ
	`¡¾’_u£r
((*)p);

102 
	`__put_u£r
(
NULL
, 
’vp
);

103 
cu¼’t
->
mm
->
’v_’d
 = 
p
;

104 
	}
}

106 
	$check_pod_h—d”
(
pod_hdr
 *
pod_ex
)

108 *
buf
 = (*)
pod_ex
;

109 
i
, 
ck
;

111 ià(
pod_ex
->
sy¡em_id
 !ğ
POD_SID_PARISC_1_0
 &&

112 
pod_ex
->
sy¡em_id
 !ğ
POD_SID_PARISC_1_1
 &&

113 
pod_ex
->
sy¡em_id
 !ğ
POD_SID_PARISC_2_0
)

114  -
ENOEXEC
;

116 ià(
pod_ex
->
a_magic
 !ğ
POD_EXEC_NONSHARE
 &&

117 
pod_ex
->
a_magic
 !ğ
POD_EXEC_SHARE
 &&

118 
pod_ex
->
a_magic
 !ğ
POD_EXEC_DEMAND
)

119  -
ENOEXEC
;

121 ià(
pod_ex
->
v”siÚ_id
 !ğ
POD_ID_OLD
 &&

122 
pod_ex
->
v”siÚ_id
 !ğ
POD_ID_NEW
)

123  -
ENOEXEC
;

125 
ck
 = 0;

126 
i
=0; i<32; i++)

127 
ck
 ^ğ
buf
[
i
];

128 ià(
ck
 != 0)

129  -
ENOEXEC
;

132 
	}
}

134 
	$m­_pod_bš¬y
(
fe
 *file,

135 cÚ¡ 
pod_exec_auxhdr
 *
hpuxhdr
)

137 
code_¡¬t
, 
code_size
, 
d©a_¡¬t
, 
d©a_size
;

138 
bss_¡¬t
, 
pod_brk
;

139 
»tv®
;

140 
´Ù
 = 
PROT_READ
 | 
PROT_EXEC
;

141 
æags
 = 
MAP_FIXED
|
MAP_PRIVATE
|
MAP_DENYWRITE
|
MAP_EXECUTABLE
;

143 
mm_£gm’t_t
 
Şd_fs
 = 
	`g‘_fs
();

144 
	`£t_fs
(
	`g‘_ds
());

146 
code_¡¬t
 = 
	`POD_PAGESTART
(
hpuxhdr
->
exec_tmem
);

147 
code_size
 = 
	`POD_PAGEALIGN
(
hpuxhdr
->
exec_tsize
);

148 
cu¼’t
->
mm
->
¡¬t_code
 = 
code_¡¬t
;

149 
cu¼’t
->
mm
->
’d_code
 = 
code_¡¬t
 + 
code_size
;

150 
	`down_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

151 
»tv®
 = 
	`do_mm­
(
fe
, 
code_¡¬t
, 
code_size
, 
´Ù
,

152 
æags
, 
	`POD_PAGESTART
(
hpuxhdr
->
exec_tfe
));

153 
	`up_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

154 ià(
»tv®
 < 0 &&„etval > -1024)

155 
out
;

157 
d©a_¡¬t
 = 
	`POD_PAGESTART
(
hpuxhdr
->
exec_dmem
);

158 
d©a_size
 = 
	`POD_PAGEALIGN
(
hpuxhdr
->
exec_dsize
);

159 
cu¼’t
->
mm
->
¡¬t_d©a
 = 
d©a_¡¬t
;

160 
cu¼’t
->
mm
->
’d_d©a
 = 
bss_¡¬t
 = 
d©a_¡¬t
 + 
d©a_size
;

161 
	`down_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

162 
»tv®
 = 
	`do_mm­
(
fe
, 
d©a_¡¬t
, 
d©a_size
,

163 
´Ù
 | 
PROT_WRITE
, 
æags
,

164 
	`POD_PAGESTART
(
hpuxhdr
->
exec_dfe
));

165 
	`up_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

166 ià(
»tv®
 < 0 &&„etval > -1024)

167 
out
;

169 
pod_brk
 = 
bss_¡¬t
 + 
	`POD_PAGEALIGN
(
hpuxhdr
->
exec_bsize
);

170 
cu¼’t
->
mm
->
¡¬t_brk
 = cu¼’t->mm->
brk
 = 
pod_brk
;

171 
	`down_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

172 
»tv®
 = 
	`do_mm­
(
NULL
, 
bss_¡¬t
, 
pod_brk
 - bss_start,

173 
´Ù
 | 
PROT_WRITE
, 
MAP_FIXED
 | 
MAP_PRIVATE
, 0);

174 
	`up_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

175 ià(
»tv®
 > 0 ||„etval < -1024)

176 
»tv®
 = 0;

177 
out
:

178 
	`£t_fs
(
Şd_fs
);

179  
»tv®
;

180 
	}
}

189 
	$lßd_pod_bš¬y
(
lšux_bš´m
 * 
b´m
, 
±_»gs
 * 
»gs
)

191 
»tv®
;

192 
size
;

193 
pod_’Œy
;

194 
pod_hdr
 *
pod_ex
;

195 
pod_exec_auxhdr
 *
hpuxhdr
;

198 
pod_ex
 = (
pod_hdr
 *è
b´m
->
buf
;

200 
»tv®
 = 
	`check_pod_h—d”
(
pod_ex
);

201 ià(
»tv®
 != 0)

202 
out
;

206 
»tv®
 = -
ENOMEM
;

207 
size
 = 
pod_ex
->
aux_h—d”_size
;

208 ià(
size
 > 
POD_PAGESIZE
)

209 
out
;

210 
hpuxhdr
 = 
	`km®loc
(
size
, 
GFP_KERNEL
);

211 ià(!
hpuxhdr
)

212 
out
;

214 
»tv®
 = 
	`k”Ãl_»ad
(
b´m
->
fe
, 
pod_ex
->
aux_h—d”_loÿtiÚ
,

215 (*è
hpuxhdr
, 
size
);

216 ià(
»tv®
 !ğ
size
) {

217 ià(
»tv®
 >= 0)

218 
»tv®
 = -
EIO
;

219 
out_ä“
;

223 
»tv®
 = 
	`æush_Şd_exec
(
b´m
);

224 ià(
»tv®
)

225 
out_ä“
;

228 
cu¼’t
->
æags
 &ğ~
PF_FORKNOEXEC
;

229 
cu¼’t
->
³rsÚ®™y
 = 
PER_HPUX
;

230 
	`£tup_Ãw_exec
(
b´m
);

238 
cu¼’t
->
th»ad
.
sk_size
 = 0xc0000000;

242 
cu¼’t
->
th»ad
.
m­_ba£
 = 0x80000000;

244 
»tv®
 = 
	`m­_pod_bš¬y
(
b´m
->
fe
, 
hpuxhdr
);

245 ià(
»tv®
 < 0)

246 
out_ä“
;

248 
pod_’Œy
 = 
hpuxhdr
->
exec_’Œy
;

249 
	`kä“
(
hpuxhdr
);

251 
	`£t_bšfmt
(&
pod_fÜm©
);

252 
	`š¡®l_exec_üeds
(
b´m
);

253 
	`£tup_¬g_·ges
(
b´m
, 
STACK_TOP
, 
EXSTACK_DEFAULT
);

255 
	`ü—‹_pod_bËs
(
b´m
);

257 
cu¼’t
->
mm
->
¡¬t_¡ack
 = 
b´m
->
p
;

260 
	`´štk
("(¡¬t_brkè%08lx\n" , (è
cu¼’t
->
mm
->
¡¬t_brk
);

261 
	`´štk
("Ónd_codeè%08lx\n" , (è
cu¼’t
->
mm
->
’d_code
);

262 
	`´štk
("(¡¬t_codeè%08lx\n" , (è
cu¼’t
->
mm
->
¡¬t_code
);

263 
	`´štk
("Ónd_d©aè%08lx\n" , (è
cu¼’t
->
mm
->
’d_d©a
);

264 
	`´štk
("(¡¬t_¡ackè%08lx\n" , (è
cu¼’t
->
mm
->
¡¬t_¡ack
);

265 
	`´štk
("(brkè%08lx\n" , (è
cu¼’t
->
mm
->
brk
);

268 
	`m­_hpux_g©eway_·ge
(
cu¼’t
,cu¼’t->
mm
);

270 
	`¡¬t_th»ad_pod
(
»gs
, 
pod_’Œy
, 
b´m
->
p
);

274 
out_ä“
:

275 
	`kä“
(
hpuxhdr
);

276 
out
:

277  
»tv®
;

278 
	}
}

280 
	$lßd_pod_lib¿ry
(
fe
 *
f
)

283  -
ENOEXEC
;

284 
	}
}

290 
__š™
 
	$š™_pod_bšfmt
()

292  
	`»gi¡”_bšfmt
(&
pod_fÜm©
);

293 
	}
}

295 
__ex™
 
	$ex™_pod_bšfmt
()

298 
	`uÄegi¡”_bšfmt
(&
pod_fÜm©
);

299 
	}
}

301 
cÜe_š™ÿÎ
(
š™_pod_bšfmt
);

302 
moduË_ex™
(
ex™_pod_bšfmt
);

304 
MODULE_LICENSE
("GPL");

	@binfmt_pod_fdpic.c

	@binfmt_script.c

8 
	~<lšux/moduË.h
>

9 
	~<lšux/¡ršg.h
>

10 
	~<lšux/¡©.h
>

11 
	~<lšux/bšfmts.h
>

12 
	~<lšux/š™.h
>

13 
	~<lšux/fe.h
>

14 
	~<lšux/”r.h
>

15 
	~<lšux/fs.h
>

17 
	$lßd_süt
(
lšux_bš´m
 *
b´m
,
±_»gs
 *
»gs
)

19 cÚ¡ *
i_¬g
, *
i_Çme
;

20 *
ı
;

21 
fe
 *file;

22 
š‹½
[
BINPRM_BUF_SIZE
];

23 
»tv®
;

25 ià((
b´m
->
buf
[0] != '#') || (bprm->buf[1] != '!') ||

26 (
b´m
->
»cursiÚ_d•th
 > 
BINPRM_MAX_RECURSION
))

27  -
ENOEXEC
;

33 
b´m
->
»cursiÚ_d•th
++;

34 
	`®low_wr™e_acûss
(
b´m
->
fe
);

35 
	`åut
(
b´m
->
fe
);

36 
b´m
->
fe
 = 
NULL
;

38 
b´m
->
buf
[
BINPRM_BUF_SIZE
 - 1] = '\0';

39 ià((
ı
 = 
	`¡rchr
(
b´m
->
buf
, '\n')è=ğ
NULL
)

40 
ı
 = 
b´m
->
buf
+
BINPRM_BUF_SIZE
-1;

41 *
ı
 = '\0';

42 
ı
 > 
b´m
->
buf
) {

43 
ı
--;

44 ià((*
ı
 == ' ') || (*cp == '\t'))

45 *
ı
 = '\0';

49 
ı
 = 
b´m
->
buf
+2; (*cp == ' ') || (*cp == '\t'); cp++);

50 ià(*
ı
 == '\0')

51  -
ENOEXEC
;

52 
i_Çme
 = 
ı
;

53 
i_¬g
 = 
NULL
;

54  ; *
ı
 && (*cp != ' ') && (*cp != '\t'); cp++)

56 (*
ı
 == ' ') || (*cp == '\t'))

57 *
ı
++ = '\0';

58 ià(*
ı
)

59 
i_¬g
 = 
ı
;

60 
	`¡rıy
 (
š‹½
, 
i_Çme
);

71 
»tv®
 = 
	`»move_¬g_z”o
(
b´m
);

72 ià(
»tv®
)

73  
»tv®
;

74 
»tv®
 = 
	`cİy_¡ršgs_k”Ãl
(1, &
b´m
->
š‹½
, bprm);

75 ià(
»tv®
 < 0) „etval;

76 
b´m
->
¬gc
++;

77 ià(
i_¬g
) {

78 
»tv®
 = 
	`cİy_¡ršgs_k”Ãl
(1, &
i_¬g
, 
b´m
);

79 ià(
»tv®
 < 0) „etval;

80 
b´m
->
¬gc
++;

82 
»tv®
 = 
	`cİy_¡ršgs_k”Ãl
(1, &
i_Çme
, 
b´m
);

83 ià(
»tv®
) „etval;

84 
b´m
->
¬gc
++;

85 
b´m
->
š‹½
 = interp;

90 
fe
 = 
	`İ’_exec
(
š‹½
);

91 ià(
	`IS_ERR
(
fe
))

92  
	`PTR_ERR
(
fe
);

94 
b´m
->
fe
 = file;

95 
»tv®
 = 
	`´•¬e_bš´m
(
b´m
);

96 ià(
»tv®
 < 0)

97  
»tv®
;

98  
	`£¬ch_bš¬y_hªdËr
(
b´m
,
»gs
);

99 
	}
}

101 
lšux_bšfmt
 
	gsüt_fÜm©
 = {

102 .
moduË
 = 
THIS_MODULE
,

103 .
	glßd_bš¬y
 = 
lßd_süt
,

106 
__š™
 
	$š™_süt_bšfmt
()

108  
	`»gi¡”_bšfmt
(&
süt_fÜm©
);

109 
	}
}

111 
__ex™
 
	$ex™_süt_bšfmt
()

113 
	`uÄegi¡”_bšfmt
(&
süt_fÜm©
);

114 
	}
}

116 
cÜe_š™ÿÎ
(
š™_süt_bšfmt
);

117 
moduË_ex™
(
ex™_süt_bšfmt
);

118 
MODULE_LICENSE
("GPL");

	@binfmt_som.c

12 
	~<lšux/moduË.h
>

14 
	~<lšux/fs.h
>

15 
	~<lšux/¡©.h
>

16 
	~<lšux/sched.h
>

17 
	~<lšux/mm.h
>

18 
	~<lšux/mmª.h
>

19 
	~<lšux/”ºo.h
>

20 
	~<lšux/sigÇl.h
>

21 
	~<lšux/bšfmts.h
>

22 
	~<lšux/som.h
>

23 
	~<lšux/¡ršg.h
>

24 
	~<lšux/fe.h
>

25 
	~<lšux/fú.h
>

26 
	~<lšux/±¿û.h
>

27 
	~<lšux/¦ab.h
>

28 
	~<lšux/shm.h
>

29 
	~<lšux/³rsÚ®™y.h
>

30 
	~<lšux/š™.h
>

32 
	~<asm/uacûss.h
>

33 
	~<asm/pgbË.h
>

36 
	~<lšux/–f.h
>

38 
lßd_som_bš¬y
(
lšux_bš´m
 * 
b´m
, 
±_»gs
 * 
»gs
);

39 
lßd_som_lib¿ry
(
fe
 *);

46 
som_cÜe_dump
(
cÜedump_·¿ms
 *
ırm
);

48 
	#som_cÜe_dump
 
NULL


	)

51 
	#SOM_PAGESTART
(
_v
è((_vè& ~()(
SOM_PAGESIZE
-1))

	)

52 
	#SOM_PAGEOFFSET
(
_v
è((_vè& (
SOM_PAGESIZE
-1))

	)

53 
	#SOM_PAGEALIGN
(
_v
è(((_vè+ 
SOM_PAGESIZE
 - 1è& ~(SOM_PAGESIZE - 1))

	)

55 
lšux_bšfmt
 
	gsom_fÜm©
 = {

56 .
moduË
 = 
THIS_MODULE
,

57 .
	glßd_bš¬y
 = 
lßd_som_bš¬y
,

58 .
	glßd_shlib
 = 
lßd_som_lib¿ry
,

59 .
	gcÜe_dump
 = 
som_cÜe_dump
,

60 .
	gmš_cÜedump
 = 
SOM_PAGESIZE


68 
	$ü—‹_som_bËs
(
lšux_bš´m
 *
b´m
)

70 **
¬gv
, **
’vp
;

71 
¬gc
 = 
b´m
->argc;

72 
’vc
 = 
b´m
->envc;

73 
p
;

74 *
¥
;

77 
¥
 = (*)((
b´m
->
p
 + 3) & ~3);

79 
’vp
 = (**è
¥
;

80 
¥
 +ğ
’vc
 + 1;

81 
¬gv
 = (**è
¥
;

82 
¥
 +ğ
¬gc
 + 1;

84 
	`__put_u£r
((è
’vp
,++
¥
);

85 
	`__put_u£r
((è
¬gv
,++
¥
);

87 
	`__put_u£r
(
¬gc
, ++
¥
);

89 
b´m
->
p
 = (è
¥
;

91 
p
 = 
cu¼’t
->
mm
->
¬g_¡¬t
;

92 
¬gc
-- > 0) {

93 
	`__put_u£r
((*)
p
,
¬gv
++);

94 
p
 +ğ
	`¡¾’_u£r
((*)p);

96 
	`__put_u£r
(
NULL
, 
¬gv
);

97 
cu¼’t
->
mm
->
¬g_’d
 = cu¼’t->mm->
’v_¡¬t
 = 
p
;

98 
’vc
-- > 0) {

99 
	`__put_u£r
((*)
p
,
’vp
++);

100 
p
 +ğ
	`¡¾’_u£r
((*)p);

102 
	`__put_u£r
(
NULL
, 
’vp
);

103 
cu¼’t
->
mm
->
’v_’d
 = 
p
;

104 
	}
}

106 
	$check_som_h—d”
(
som_hdr
 *
som_ex
)

108 *
buf
 = (*)
som_ex
;

109 
i
, 
ck
;

111 ià(
som_ex
->
sy¡em_id
 !ğ
SOM_SID_PARISC_1_0
 &&

112 
som_ex
->
sy¡em_id
 !ğ
SOM_SID_PARISC_1_1
 &&

113 
som_ex
->
sy¡em_id
 !ğ
SOM_SID_PARISC_2_0
)

114  -
ENOEXEC
;

116 ià(
som_ex
->
a_magic
 !ğ
SOM_EXEC_NONSHARE
 &&

117 
som_ex
->
a_magic
 !ğ
SOM_EXEC_SHARE
 &&

118 
som_ex
->
a_magic
 !ğ
SOM_EXEC_DEMAND
)

119  -
ENOEXEC
;

121 ià(
som_ex
->
v”siÚ_id
 !ğ
SOM_ID_OLD
 &&

122 
som_ex
->
v”siÚ_id
 !ğ
SOM_ID_NEW
)

123  -
ENOEXEC
;

125 
ck
 = 0;

126 
i
=0; i<32; i++)

127 
ck
 ^ğ
buf
[
i
];

128 ià(
ck
 != 0)

129  -
ENOEXEC
;

132 
	}
}

134 
	$m­_som_bš¬y
(
fe
 *file,

135 cÚ¡ 
som_exec_auxhdr
 *
hpuxhdr
)

137 
code_¡¬t
, 
code_size
, 
d©a_¡¬t
, 
d©a_size
;

138 
bss_¡¬t
, 
som_brk
;

139 
»tv®
;

140 
´Ù
 = 
PROT_READ
 | 
PROT_EXEC
;

141 
æags
 = 
MAP_FIXED
|
MAP_PRIVATE
|
MAP_DENYWRITE
|
MAP_EXECUTABLE
;

143 
mm_£gm’t_t
 
Şd_fs
 = 
	`g‘_fs
();

144 
	`£t_fs
(
	`g‘_ds
());

146 
code_¡¬t
 = 
	`SOM_PAGESTART
(
hpuxhdr
->
exec_tmem
);

147 
code_size
 = 
	`SOM_PAGEALIGN
(
hpuxhdr
->
exec_tsize
);

148 
cu¼’t
->
mm
->
¡¬t_code
 = 
code_¡¬t
;

149 
cu¼’t
->
mm
->
’d_code
 = 
code_¡¬t
 + 
code_size
;

150 
	`down_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

151 
»tv®
 = 
	`do_mm­
(
fe
, 
code_¡¬t
, 
code_size
, 
´Ù
,

152 
æags
, 
	`SOM_PAGESTART
(
hpuxhdr
->
exec_tfe
));

153 
	`up_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

154 ià(
»tv®
 < 0 &&„etval > -1024)

155 
out
;

157 
d©a_¡¬t
 = 
	`SOM_PAGESTART
(
hpuxhdr
->
exec_dmem
);

158 
d©a_size
 = 
	`SOM_PAGEALIGN
(
hpuxhdr
->
exec_dsize
);

159 
cu¼’t
->
mm
->
¡¬t_d©a
 = 
d©a_¡¬t
;

160 
cu¼’t
->
mm
->
’d_d©a
 = 
bss_¡¬t
 = 
d©a_¡¬t
 + 
d©a_size
;

161 
	`down_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

162 
»tv®
 = 
	`do_mm­
(
fe
, 
d©a_¡¬t
, 
d©a_size
,

163 
´Ù
 | 
PROT_WRITE
, 
æags
,

164 
	`SOM_PAGESTART
(
hpuxhdr
->
exec_dfe
));

165 
	`up_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

166 ià(
»tv®
 < 0 &&„etval > -1024)

167 
out
;

169 
som_brk
 = 
bss_¡¬t
 + 
	`SOM_PAGEALIGN
(
hpuxhdr
->
exec_bsize
);

170 
cu¼’t
->
mm
->
¡¬t_brk
 = cu¼’t->mm->
brk
 = 
som_brk
;

171 
	`down_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

172 
»tv®
 = 
	`do_mm­
(
NULL
, 
bss_¡¬t
, 
som_brk
 - bss_start,

173 
´Ù
 | 
PROT_WRITE
, 
MAP_FIXED
 | 
MAP_PRIVATE
, 0);

174 
	`up_wr™e
(&
cu¼’t
->
mm
->
mm­_£m
);

175 ià(
»tv®
 > 0 ||„etval < -1024)

176 
»tv®
 = 0;

177 
out
:

178 
	`£t_fs
(
Şd_fs
);

179  
»tv®
;

180 
	}
}

189 
	$lßd_som_bš¬y
(
lšux_bš´m
 * 
b´m
, 
±_»gs
 * 
»gs
)

191 
»tv®
;

192 
size
;

193 
som_’Œy
;

194 
som_hdr
 *
som_ex
;

195 
som_exec_auxhdr
 *
hpuxhdr
;

198 
som_ex
 = (
som_hdr
 *è
b´m
->
buf
;

200 
»tv®
 = 
	`check_som_h—d”
(
som_ex
);

201 ià(
»tv®
 != 0)

202 
out
;

206 
»tv®
 = -
ENOMEM
;

207 
size
 = 
som_ex
->
aux_h—d”_size
;

208 ià(
size
 > 
SOM_PAGESIZE
)

209 
out
;

210 
hpuxhdr
 = 
	`km®loc
(
size
, 
GFP_KERNEL
);

211 ià(!
hpuxhdr
)

212 
out
;

214 
»tv®
 = 
	`k”Ãl_»ad
(
b´m
->
fe
, 
som_ex
->
aux_h—d”_loÿtiÚ
,

215 (*è
hpuxhdr
, 
size
);

216 ià(
»tv®
 !ğ
size
) {

217 ià(
»tv®
 >= 0)

218 
»tv®
 = -
EIO
;

219 
out_ä“
;

223 
»tv®
 = 
	`æush_Şd_exec
(
b´m
);

224 ià(
»tv®
)

225 
out_ä“
;

228 
cu¼’t
->
æags
 &ğ~
PF_FORKNOEXEC
;

229 
cu¼’t
->
³rsÚ®™y
 = 
PER_HPUX
;

230 
	`£tup_Ãw_exec
(
b´m
);

238 
cu¼’t
->
th»ad
.
sk_size
 = 0xc0000000;

242 
cu¼’t
->
th»ad
.
m­_ba£
 = 0x80000000;

244 
»tv®
 = 
	`m­_som_bš¬y
(
b´m
->
fe
, 
hpuxhdr
);

245 ià(
»tv®
 < 0)

246 
out_ä“
;

248 
som_’Œy
 = 
hpuxhdr
->
exec_’Œy
;

249 
	`kä“
(
hpuxhdr
);

251 
	`£t_bšfmt
(&
som_fÜm©
);

252 
	`š¡®l_exec_üeds
(
b´m
);

253 
	`£tup_¬g_·ges
(
b´m
, 
STACK_TOP
, 
EXSTACK_DEFAULT
);

255 
	`ü—‹_som_bËs
(
b´m
);

257 
cu¼’t
->
mm
->
¡¬t_¡ack
 = 
b´m
->
p
;

260 
	`´štk
("(¡¬t_brkè%08lx\n" , (è
cu¼’t
->
mm
->
¡¬t_brk
);

261 
	`´štk
("Ónd_codeè%08lx\n" , (è
cu¼’t
->
mm
->
’d_code
);

262 
	`´štk
("(¡¬t_codeè%08lx\n" , (è
cu¼’t
->
mm
->
¡¬t_code
);

263 
	`´štk
("Ónd_d©aè%08lx\n" , (è
cu¼’t
->
mm
->
’d_d©a
);

264 
	`´štk
("(¡¬t_¡ackè%08lx\n" , (è
cu¼’t
->
mm
->
¡¬t_¡ack
);

265 
	`´štk
("(brkè%08lx\n" , (è
cu¼’t
->
mm
->
brk
);

268 
	`m­_hpux_g©eway_·ge
(
cu¼’t
,cu¼’t->
mm
);

270 
	`¡¬t_th»ad_som
(
»gs
, 
som_’Œy
, 
b´m
->
p
);

274 
out_ä“
:

275 
	`kä“
(
hpuxhdr
);

276 
out
:

277  
»tv®
;

278 
	}
}

280 
	$lßd_som_lib¿ry
(
fe
 *
f
)

283  -
ENOEXEC
;

284 
	}
}

290 
__š™
 
	$š™_som_bšfmt
()

292  
	`»gi¡”_bšfmt
(&
som_fÜm©
);

293 
	}
}

295 
__ex™
 
	$ex™_som_bšfmt
()

298 
	`uÄegi¡”_bšfmt
(&
som_fÜm©
);

299 
	}
}

301 
cÜe_š™ÿÎ
(
š™_som_bšfmt
);

302 
moduË_ex™
(
ex™_som_bšfmt
);

304 
MODULE_LICENSE
("GPL");

	@bio-integrity.c

23 
	~<lšux/blkdev.h
>

24 
	~<lšux/mempoŞ.h
>

25 
	~<lšux/expÜt.h
>

26 
	~<lšux/bio.h
>

27 
	~<lšux/wÜkqueue.h
>

28 
	~<lšux/¦ab.h
>

30 
	sš‹gr™y_¦ab
 {

31 
kmem_ÿche
 *
	m¦ab
;

32 
	mÄ_vecs
;

33 
	mÇme
[8];

36 
	#IS
(
x
è{ .
Ä_vecs
 = x, .
Çme
 = "b-"
	`__¡ršgify
(xè}

	)

37 
š‹gr™y_¦ab
 
	gb_¦ab
[
BIOVEC_NR_POOLS
] 
	g__»ad_mo¡ly
 = {

38 
IS
(1), IS(4), IS(16), IS(64), IS(128), IS(
BIO_MAX_PAGES
),

40 #undeà
IS


42 
wÜkqueue_¡ruù
 *
	gkš‹gr™yd_wq
;

44 
šlše
 
	$vecs_to_idx
(
Ä
)

46 
Ä
) {

57 129 ... 
BIO_MAX_PAGES
:

60 
	`BUG
();

62 
	}
}

64 
šlše
 
	$u£_b_poŞ
(
idx
)

66 ià(
idx
 =ğ
BIOVEC_MAX_IDX
)

70 
	}
}

83 
bio_š‹gr™y_·ylßd
 *
	$bio_š‹gr™y_®loc_bio£t
(
bio
 *bio,

84 
gå_t
 
gå_mask
,

85 
Ä_vecs
,

86 
bio_£t
 *
bs
)

88 
bio_š‹gr™y_·ylßd
 *
b
;

89 
idx
 = 
	`vecs_to_idx
(
Ä_vecs
);

91 
	`BUG_ON
(
bio
 =ğ
NULL
);

92 
b
 = 
NULL
;

95 ià(!
	`u£_b_poŞ
(
idx
))

96 
b
 = 
	`kmem_ÿche_®loc
(
b_¦ab
[
idx
].
¦ab
, 
gå_mask
);

99 ià(
b
 =ğ
NULL
) {

100 
idx
 = 
BIOVEC_MAX_IDX
;

101 
b
 = 
	`mempoŞ_®loc
(
bs
->
bio_š‹gr™y_poŞ
, 
gå_mask
);

103 ià(
	`uÆik–y
(
b
 =ğ
NULL
)) {

104 
	`´štk
(
KERN_ERR
 "%s: could‚Ù‡Îoøb\n", 
__func__
);

105  
NULL
;

109 
	`mem£t
(
b
, 0, (*bip));

111 
b
->
b_¦ab
 = 
idx
;

112 
b
->
b_bio
 = 
bio
;

113 
bio
->
bi_š‹gr™y
 = 
b
;

115  
b
;

116 
	}
}

117 
EXPORT_SYMBOL
(
bio_š‹gr™y_®loc_bio£t
);

129 
bio_š‹gr™y_·ylßd
 *
	$bio_š‹gr™y_®loc
(
bio
 *bio,

130 
gå_t
 
gå_mask
,

131 
Ä_vecs
)

133  
	`bio_š‹gr™y_®loc_bio£t
(
bio
, 
gå_mask
, 
Ä_vecs
, 
fs_bio_£t
);

134 
	}
}

135 
EXPORT_SYMBOL
(
bio_š‹gr™y_®loc
);

145 
	$bio_š‹gr™y_ä“
(
bio
 *bio, 
bio_£t
 *
bs
)

147 
bio_š‹gr™y_·ylßd
 *
b
 = 
bio
->
bi_š‹gr™y
;

149 
	`BUG_ON
(
b
 =ğ
NULL
);

152 ià(!
	`bio_æagged
(
bio
, 
BIO_CLONED
è&& !bio_æagged(bio, 
BIO_FS_INTEGRITY
)

153 && 
b
->
b_buf
 !ğ
NULL
)

154 
	`kä“
(
b
->
b_buf
);

156 ià(
	`u£_b_poŞ
(
b
->
b_¦ab
))

157 
	`mempoŞ_ä“
(
b
, 
bs
->
bio_š‹gr™y_poŞ
);

159 
	`kmem_ÿche_ä“
(
b_¦ab
[
b
->b_¦ab].
¦ab
, bip);

161 
bio
->
bi_š‹gr™y
 = 
NULL
;

162 
	}
}

163 
EXPORT_SYMBOL
(
bio_š‹gr™y_ä“
);

174 
	$bio_š‹gr™y_add_·ge
(
bio
 *bio, 
·ge
 *page,

175 
Ën
, 
off£t
)

177 
bio_š‹gr™y_·ylßd
 *
b
 = 
bio
->
bi_š‹gr™y
;

178 
bio_vec
 *
iv
;

180 ià(
b
->
b_vút
 >ğ
	`bvec_Ä_vecs
(b->
b_¦ab
)) {

181 
	`´štk
(
KERN_ERR
 "%s: b_veøfuÎ\n", 
__func__
);

185 
iv
 = 
	`b_vec_idx
(
b
, b->
b_vút
);

186 
	`BUG_ON
(
iv
 =ğ
NULL
);

188 
iv
->
bv_·ge
 = 
·ge
;

189 
iv
->
bv_Ën
 = 
Ën
;

190 
iv
->
bv_off£t
 = 
off£t
;

191 
b
->
b_vút
++;

193  
Ën
;

194 
	}
}

195 
EXPORT_SYMBOL
(
bio_š‹gr™y_add_·ge
);

197 
	$bdev_š‹gr™y_’abËd
(
block_deviû
 *
bdev
, 
rw
)

199 
blk_š‹gr™y
 *
bi
 = 
	`bdev_g‘_š‹gr™y
(
bdev
);

201 ià(
bi
 =ğ
NULL
)

204 ià(
rw
 =ğ
READ
 && 
bi
->
v”ify_â
 !ğ
NULL
 &&

205 (
bi
->
æags
 & 
INTEGRITY_FLAG_READ
))

208 ià(
rw
 =ğ
WRITE
 && 
bi
->
g’”©e_â
 !ğ
NULL
 &&

209 (
bi
->
æags
 & 
INTEGRITY_FLAG_WRITE
))

213 
	}
}

224 
	$bio_š‹gr™y_’abËd
(
bio
 *bio)

227 ià(
	`bio_š‹gr™y
(
bio
))

230  
	`bdev_š‹gr™y_’abËd
(
bio
->
bi_bdev
, 
	`bio_d©a_dœ
(bio));

231 
	}
}

232 
EXPORT_SYMBOL
(
bio_š‹gr™y_’abËd
);

244 
šlše
 
	$bio_š‹gr™y_hw_£ùÜs
(
blk_š‹gr™y
 *
bi
,

245 
£ùÜs
)

248 ià(
bi
->
£ùÜ_size
 == 4096)

249  
£ùÜs
 >>= 3;

251  
£ùÜs
;

252 
	}
}

262 
	$bio_š‹gr™y_g_size
(
bio
 *bio)

264 
blk_š‹gr™y
 *
bi
 = 
	`bdev_g‘_š‹gr™y
(
bio
->
bi_bdev
);

266 
	`BUG_ON
(
bio
->
bi_size
 == 0);

268  
bi
->
g_size
 * (
bio
->
bi_size
 / bi->
£ùÜ_size
);

269 
	}
}

270 
EXPORT_SYMBOL
(
bio_š‹gr™y_g_size
);

272 
	$bio_š‹gr™y_g
(
bio
 *bio, *
g_buf
, 
Ën
, 
£t
)

274 
bio_š‹gr™y_·ylßd
 *
b
 = 
bio
->
bi_š‹gr™y
;

275 
blk_š‹gr™y
 *
bi
 = 
	`bdev_g‘_š‹gr™y
(
bio
->
bi_bdev
);

276 
Ä_£ùÜs
;

278 
	`BUG_ON
(
b
->
b_buf
 =ğ
NULL
);

280 ià(
bi
->
g_size
 == 0)

283 
Ä_£ùÜs
 = 
	`bio_š‹gr™y_hw_£ùÜs
(
bi
,

284 
	`DIV_ROUND_UP
(
Ën
, 
bi
->
g_size
));

286 ià(
Ä_£ùÜs
 * 
bi
->
tu¶e_size
 > 
b
->
b_size
) {

287 
	`´štk
(
KERN_ERR
 "%s:agoo big for bio: %u > %u\n",

288 
__func__
, 
Ä_£ùÜs
 * 
bi
->
tu¶e_size
, 
b
->
b_size
);

292 ià(
£t
)

293 
bi
->
	`£t_g_â
(
b
->
b_buf
, 
g_buf
, 
Ä_£ùÜs
);

295 
bi
->
	`g‘_g_â
(
b
->
b_buf
, 
g_buf
, 
Ä_£ùÜs
);

298 
	}
}

311 
	$bio_š‹gr™y_£t_g
(
bio
 *bio, *
g_buf
, 
Ën
)

313 
	`BUG_ON
(
	`bio_d©a_dœ
(
bio
è!ğ
WRITE
);

315  
	`bio_š‹gr™y_g
(
bio
, 
g_buf
, 
Ën
, 1);

316 
	}
}

317 
EXPORT_SYMBOL
(
bio_š‹gr™y_£t_g
);

329 
	$bio_š‹gr™y_g‘_g
(
bio
 *bio, *
g_buf
, 
Ën
)

331 
	`BUG_ON
(
	`bio_d©a_dœ
(
bio
è!ğ
READ
);

333  
	`bio_š‹gr™y_g
(
bio
, 
g_buf
, 
Ën
, 0);

334 
	}
}

335 
EXPORT_SYMBOL
(
bio_š‹gr™y_g‘_g
);

346 
	$bio_š‹gr™y_g’”©e
(
bio
 *bio)

348 
blk_š‹gr™y
 *
bi
 = 
	`bdev_g‘_š‹gr™y
(
bio
->
bi_bdev
);

349 
blk_š‹gr™y_exchg
 
bix
;

350 
bio_vec
 *
bv
;

351 
£ùÜ_t
 
£ùÜ
 = 
bio
->
bi_£ùÜ
;

352 
i
, 
£ùÜs
, 
tÙ®
;

353 *
´Ù_buf
 = 
bio
->
bi_š‹gr™y
->
b_buf
;

355 
tÙ®
 = 0;

356 
bix
.
disk_Çme
 = 
bio
->
bi_bdev
->
bd_disk
->disk_name;

357 
bix
.
£ùÜ_size
 = 
bi
->sector_size;

359 
	`bio_fÜ_—ch_£gm’t
(
bv
, 
bio
, 
i
) {

360 *
kaddr
 = 
	`km­_©omic
(
bv
->
bv_·ge
, 
KM_USER0
);

361 
bix
.
d©a_buf
 = 
kaddr
 + 
bv
->
bv_off£t
;

362 
bix
.
d©a_size
 = 
bv
->
bv_Ën
;

363 
bix
.
´Ù_buf
 =…rot_buf;

364 
bix
.
£ùÜ
 = sector;

366 
bi
->
	`g’”©e_â
(&
bix
);

368 
£ùÜs
 = 
bv
->
bv_Ën
 / 
bi
->
£ùÜ_size
;

369 
£ùÜ
 +ğ
£ùÜs
;

370 
´Ù_buf
 +ğ
£ùÜs
 * 
bi
->
tu¶e_size
;

371 
tÙ®
 +ğ
£ùÜs
 * 
bi
->
tu¶e_size
;

372 
	`BUG_ON
(
tÙ®
 > 
bio
->
bi_š‹gr™y
->
b_size
);

374 
	`kunm­_©omic
(
kaddr
, 
KM_USER0
);

376 
	}
}

378 
šlše
 
	$blk_š‹gr™y_tu¶e_size
(
blk_š‹gr™y
 *
bi
)

380 ià(
bi
)

381  
bi
->
tu¶e_size
;

384 
	}
}

397 
	$bio_š‹gr™y_´•
(
bio
 *bio)

399 
bio_š‹gr™y_·ylßd
 *
b
;

400 
blk_š‹gr™y
 *
bi
;

401 
»que¡_queue
 *
q
;

402 *
buf
;

403 
¡¬t
, 
’d
;

404 
Ën
, 
Ä_·ges
;

405 
by‹s
, 
off£t
, 
i
;

406 
£ùÜs
;

408 
bi
 = 
	`bdev_g‘_š‹gr™y
(
bio
->
bi_bdev
);

409 
q
 = 
	`bdev_g‘_queue
(
bio
->
bi_bdev
);

410 
	`BUG_ON
(
bi
 =ğ
NULL
);

411 
	`BUG_ON
(
	`bio_š‹gr™y
(
bio
));

413 
£ùÜs
 = 
	`bio_š‹gr™y_hw_£ùÜs
(
bi
, 
	`bio_£ùÜs
(
bio
));

416 
Ën
 = 
£ùÜs
 * 
	`blk_š‹gr™y_tu¶e_size
(
bi
);

417 
buf
 = 
	`km®loc
(
Ën
, 
GFP_NOIO
 | 
q
->
bounû_gå
);

418 ià(
	`uÆik–y
(
buf
 =ğ
NULL
)) {

419 
	`´štk
(
KERN_ERR
 "could‚ot‡llocate integrity buffer\n");

420  -
ENOMEM
;

423 
’d
 = (((è
buf
è+ 
Ën
 + 
PAGE_SIZE
 - 1è>> 
PAGE_SHIFT
;

424 
¡¬t
 = ((è
buf
è>> 
PAGE_SHIFT
;

425 
Ä_·ges
 = 
’d
 - 
¡¬t
;

428 
b
 = 
	`bio_š‹gr™y_®loc
(
bio
, 
GFP_NOIO
, 
Ä_·ges
);

429 ià(
	`uÆik–y
(
b
 =ğ
NULL
)) {

430 
	`´štk
(
KERN_ERR
 "could‚ot‡llocate data integrity bioset\n");

431 
	`kä“
(
buf
);

432  -
EIO
;

435 
b
->
b_buf
 = 
buf
;

436 
b
->
b_size
 = 
Ën
;

437 
b
->
b_£ùÜ
 = 
bio
->
bi_£ùÜ
;

440 
off£t
 = 
	`off£t_š_·ge
(
buf
);

441 
i
 = 0 ; i < 
Ä_·ges
 ; i++) {

442 
»t
;

443 
by‹s
 = 
PAGE_SIZE
 - 
off£t
;

445 ià(
Ën
 <= 0)

448 ià(
by‹s
 > 
Ën
)

449 
by‹s
 = 
Ën
;

451 
»t
 = 
	`bio_š‹gr™y_add_·ge
(
bio
, 
	`vœt_to_·ge
(
buf
),

452 
by‹s
, 
off£t
);

454 ià(
»t
 == 0)

457 ià(
»t
 < 
by‹s
)

460 
buf
 +ğ
by‹s
;

461 
Ën
 -ğ
by‹s
;

462 
off£t
 = 0;

466 ià(
	`bio_d©a_dœ
(
bio
è=ğ
READ
) {

467 
b
->
b_’d_io
 = 
bio
->
bi_’d_io
;

468 
bio
->
bi_’d_io
 = 
bio_š‹gr™y_’dio
;

472 ià(
	`bio_d©a_dœ
(
bio
è=ğ
WRITE
)

473 
	`bio_š‹gr™y_g’”©e
(
bio
);

476 
	}
}

477 
EXPORT_SYMBOL
(
bio_š‹gr™y_´•
);

487 
	$bio_š‹gr™y_v”ify
(
bio
 *bio)

489 
blk_š‹gr™y
 *
bi
 = 
	`bdev_g‘_š‹gr™y
(
bio
->
bi_bdev
);

490 
blk_š‹gr™y_exchg
 
bix
;

491 
bio_vec
 *
bv
;

492 
£ùÜ_t
 
£ùÜ
 = 
bio
->
bi_š‹gr™y
->
b_£ùÜ
;

493 
i
, 
£ùÜs
, 
tÙ®
, 
»t
;

494 *
´Ù_buf
 = 
bio
->
bi_š‹gr™y
->
b_buf
;

496 
»t
 = 
tÙ®
 = 0;

497 
bix
.
disk_Çme
 = 
bio
->
bi_bdev
->
bd_disk
->disk_name;

498 
bix
.
£ùÜ_size
 = 
bi
->sector_size;

500 
	`bio_fÜ_—ch_£gm’t
(
bv
, 
bio
, 
i
) {

501 *
kaddr
 = 
	`km­_©omic
(
bv
->
bv_·ge
, 
KM_USER0
);

502 
bix
.
d©a_buf
 = 
kaddr
 + 
bv
->
bv_off£t
;

503 
bix
.
d©a_size
 = 
bv
->
bv_Ën
;

504 
bix
.
´Ù_buf
 =…rot_buf;

505 
bix
.
£ùÜ
 = sector;

507 
»t
 = 
bi
->
	`v”ify_â
(&
bix
);

509 ià(
»t
) {

510 
	`kunm­_©omic
(
kaddr
, 
KM_USER0
);

511  
»t
;

514 
£ùÜs
 = 
bv
->
bv_Ën
 / 
bi
->
£ùÜ_size
;

515 
£ùÜ
 +ğ
£ùÜs
;

516 
´Ù_buf
 +ğ
£ùÜs
 * 
bi
->
tu¶e_size
;

517 
tÙ®
 +ğ
£ùÜs
 * 
bi
->
tu¶e_size
;

518 
	`BUG_ON
(
tÙ®
 > 
bio
->
bi_š‹gr™y
->
b_size
);

520 
	`kunm­_©omic
(
kaddr
, 
KM_USER0
);

523  
»t
;

524 
	}
}

534 
	$bio_š‹gr™y_v”ify_â
(
wÜk_¡ruù
 *
wÜk
)

536 
bio_š‹gr™y_·ylßd
 *
b
 =

537 
	`cÚš”_of
(
wÜk
, 
bio_š‹gr™y_·ylßd
, 
b_wÜk
);

538 
bio
 *biØğ
b
->
b_bio
;

539 
”rÜ
;

541 
”rÜ
 = 
	`bio_š‹gr™y_v”ify
(
bio
);

544 
bio
->
bi_’d_io
 = 
b
->
b_’d_io
;

545 
	`bio_’dio
(
bio
, 
”rÜ
);

546 
	}
}

560 
	$bio_š‹gr™y_’dio
(
bio
 *bio, 
”rÜ
)

562 
bio_š‹gr™y_·ylßd
 *
b
 = 
bio
->
bi_š‹gr™y
;

564 
	`BUG_ON
(
b
->
b_bio
 !ğ
bio
);

570 ià(
”rÜ
) {

571 
bio
->
bi_’d_io
 = 
b
->
b_’d_io
;

572 
	`bio_’dio
(
bio
, 
”rÜ
);

577 
	`INIT_WORK
(&
b
->
b_wÜk
, 
bio_š‹gr™y_v”ify_â
);

578 
	`queue_wÜk
(
kš‹gr™yd_wq
, &
b
->
b_wÜk
);

579 
	}
}

580 
EXPORT_SYMBOL
(
bio_š‹gr™y_’dio
);

587 
	$bio_š‹gr™y_m¬k_h—d
(
bio_š‹gr™y_·ylßd
 *
b
,

588 
sk
)

590 
bio_vec
 *
iv
;

591 
i
;

593 
	`b_fÜ_—ch_vec
(
iv
, 
b
, 
i
) {

594 ià(
sk
 == 0) {

595 
b
->
b_idx
 = 
i
;

597 } ià(
sk
 >ğ
iv
->
bv_Ën
) {

598 
sk
 -ğ
iv
->
bv_Ën
;

600 
iv
->
bv_off£t
 +ğ
sk
;

601 
iv
->
bv_Ën
 -ğ
sk
;

602 
b
->
b_idx
 = 
i
;

606 
	}
}

613 
	$bio_š‹gr™y_m¬k_
(
bio_š‹gr™y_·ylßd
 *
b
,

614 
Ën
)

616 
bio_vec
 *
iv
;

617 
i
;

619 
	`b_fÜ_—ch_vec
(
iv
, 
b
, 
i
) {

620 ià(
Ën
 == 0) {

621 
b
->
b_vút
 = 
i
;

623 } ià(
Ën
 >ğ
iv
->
bv_Ën
) {

624 
Ën
 -ğ
iv
->
bv_Ën
;

626 
iv
->
bv_Ën
 = 
Ën
;

627 
Ën
 = 0;

630 
	}
}

641 
	$bio_š‹gr™y_advªû
(
bio
 *bio, 
by‹s_dÚe
)

643 
bio_š‹gr™y_·ylßd
 *
b
 = 
bio
->
bi_š‹gr™y
;

644 
blk_š‹gr™y
 *
bi
 = 
	`bdev_g‘_š‹gr™y
(
bio
->
bi_bdev
);

645 
Ä_£ùÜs
;

647 
	`BUG_ON
(
b
 =ğ
NULL
);

648 
	`BUG_ON
(
bi
 =ğ
NULL
);

650 
Ä_£ùÜs
 = 
	`bio_š‹gr™y_hw_£ùÜs
(
bi
, 
by‹s_dÚe
 >> 9);

651 
	`bio_š‹gr™y_m¬k_h—d
(
b
, 
Ä_£ùÜs
 * 
bi
->
tu¶e_size
);

652 
	}
}

653 
EXPORT_SYMBOL
(
bio_š‹gr™y_advªû
);

666 
	$bio_š‹gr™y_Œim
(
bio
 *bio, 
off£t
,

667 
£ùÜs
)

669 
bio_š‹gr™y_·ylßd
 *
b
 = 
bio
->
bi_š‹gr™y
;

670 
blk_š‹gr™y
 *
bi
 = 
	`bdev_g‘_š‹gr™y
(
bio
->
bi_bdev
);

671 
Ä_£ùÜs
;

673 
	`BUG_ON
(
b
 =ğ
NULL
);

674 
	`BUG_ON
(
bi
 =ğ
NULL
);

675 
	`BUG_ON
(!
	`bio_æagged
(
bio
, 
BIO_CLONED
));

677 
Ä_£ùÜs
 = 
	`bio_š‹gr™y_hw_£ùÜs
(
bi
, 
£ùÜs
);

678 
b
->
b_£ùÜ
 = b->b_£ùÜ + 
off£t
;

679 
	`bio_š‹gr™y_m¬k_h—d
(
b
, 
off£t
 * 
bi
->
tu¶e_size
);

680 
	`bio_š‹gr™y_m¬k_
(
b
, 
£ùÜs
 * 
bi
->
tu¶e_size
);

681 
	}
}

682 
EXPORT_SYMBOL
(
bio_š‹gr™y_Œim
);

692 
	$bio_š‹gr™y_¥l™
(
bio
 *bio, 
bio_·œ
 *
bp
, 
£ùÜs
)

694 
blk_š‹gr™y
 *
bi
;

695 
bio_š‹gr™y_·ylßd
 *
b
 = 
bio
->
bi_š‹gr™y
;

696 
Ä_£ùÜs
;

698 ià(
	`bio_š‹gr™y
(
bio
) == 0)

701 
bi
 = 
	`bdev_g‘_š‹gr™y
(
bio
->
bi_bdev
);

702 
	`BUG_ON
(
bi
 =ğ
NULL
);

703 
	`BUG_ON
(
b
->
b_vút
 != 1);

705 
Ä_£ùÜs
 = 
	`bio_š‹gr™y_hw_£ùÜs
(
bi
, 
£ùÜs
);

707 
bp
->
bio1
.
bi_š‹gr™y
 = &bp->
b1
;

708 
bp
->
bio2
.
bi_š‹gr™y
 = &bp->
b2
;

710 
bp
->
iv1
 = 
b
->
b_vec
[0];

711 
bp
->
iv2
 = 
b
->
b_vec
[0];

713 
bp
->
b1
.
b_vec
[0] = bp->
iv1
;

714 
bp
->
b2
.
b_vec
[0] = bp->
iv2
;

716 
bp
->
iv1
.
bv_Ën
 = 
£ùÜs
 * 
bi
->
tu¶e_size
;

717 
bp
->
iv2
.
bv_off£t
 +ğ
£ùÜs
 * 
bi
->
tu¶e_size
;

718 
bp
->
iv2
.
bv_Ën
 -ğ
£ùÜs
 * 
bi
->
tu¶e_size
;

720 
bp
->
b1
.
b_£ùÜ
 = 
bio
->
bi_š‹gr™y
->bip_sector;

721 
bp
->
b2
.
b_£ùÜ
 = 
bio
->
bi_š‹gr™y
->b_£ùÜ + 
Ä_£ùÜs
;

723 
bp
->
b1
.
b_vút
 = bp->
b2
.bip_vcnt = 1;

724 
bp
->
b1
.
b_idx
 = bp->
b2
.bip_idx = 0;

725 
	}
}

726 
EXPORT_SYMBOL
(
bio_š‹gr™y_¥l™
);

737 
	$bio_š‹gr™y_şÚe
(
bio
 *bio, biØ*
bio_¤c
,

738 
gå_t
 
gå_mask
, 
bio_£t
 *
bs
)

740 
bio_š‹gr™y_·ylßd
 *
b_¤c
 = 
bio_¤c
->
bi_š‹gr™y
;

741 
bio_š‹gr™y_·ylßd
 *
b
;

743 
	`BUG_ON
(
b_¤c
 =ğ
NULL
);

745 
b
 = 
	`bio_š‹gr™y_®loc_bio£t
(
bio
, 
gå_mask
, 
b_¤c
->
b_vút
, 
bs
);

747 ià(
b
 =ğ
NULL
)

748  -
EIO
;

750 
	`memıy
(
b
->
b_vec
, 
b_¤c
->bip_vec,

751 
b_¤c
->
b_vút
 * (
bio_vec
));

753 
b
->
b_£ùÜ
 = 
b_¤c
->bip_sector;

754 
b
->
b_vút
 = 
b_¤c
->bip_vcnt;

755 
b
->
b_idx
 = 
b_¤c
->bip_idx;

758 
	}
}

759 
EXPORT_SYMBOL
(
bio_š‹gr™y_şÚe
);

761 
	$bio£t_š‹gr™y_ü—‹
(
bio_£t
 *
bs
, 
poŞ_size
)

763 
max_¦ab
 = 
	`vecs_to_idx
(
BIO_MAX_PAGES
);

765 ià(
bs
->
bio_š‹gr™y_poŞ
)

768 
bs
->
bio_š‹gr™y_poŞ
 =

769 
	`mempoŞ_ü—‹_¦ab_poŞ
(
poŞ_size
, 
b_¦ab
[
max_¦ab
].
¦ab
);

771 ià(!
bs
->
bio_š‹gr™y_poŞ
)

775 
	}
}

776 
EXPORT_SYMBOL
(
bio£t_š‹gr™y_ü—‹
);

778 
	$bio£t_š‹gr™y_ä“
(
bio_£t
 *
bs
)

780 ià(
bs
->
bio_š‹gr™y_poŞ
)

781 
	`mempoŞ_de¡roy
(
bs
->
bio_š‹gr™y_poŞ
);

782 
	}
}

783 
EXPORT_SYMBOL
(
bio£t_š‹gr™y_ä“
);

785 
__š™
 
	$bio_š‹gr™y_š™
()

787 
i
;

793 
kš‹gr™yd_wq
 = 
	`®loc_wÜkqueue
("kš‹gr™yd", 
WQ_MEM_RECLAIM
 |

794 
WQ_HIGHPRI
 | 
WQ_CPU_INTENSIVE
, 1);

795 ià(!
kš‹gr™yd_wq
)

796 
	`·nic
("Failedo create kintegrityd\n");

798 
i
 = 0 ; i < 
BIOVEC_NR_POOLS
 ; i++) {

799 
size
;

801 
size
 = (
bio_š‹gr™y_·ylßd
)

802 + 
b_¦ab
[
i
].
Ä_vecs
 * (
bio_vec
);

804 
b_¦ab
[
i
].
¦ab
 =

805 
	`kmem_ÿche_ü—‹
(
b_¦ab
[
i
].
Çme
, 
size
, 0,

806 
SLAB_HWCACHE_ALIGN
|
SLAB_PANIC
, 
NULL
);

808 
	}
}

	@bio.c

18 
	~<lšux/mm.h
>

19 
	~<lšux/sw­.h
>

20 
	~<lšux/bio.h
>

21 
	~<lšux/blkdev.h
>

22 
	~<lšux/¦ab.h
>

23 
	~<lšux/š™.h
>

24 
	~<lšux/k”Ãl.h
>

25 
	~<lšux/moduË.h
>

26 
	~<lšux/mempoŞ.h
>

27 
	~<lšux/wÜkqueue.h
>

28 
	~<scsi/sg.h
>

30 
	~<Œaû/ev’ts/block.h
>

36 
	#BIO_INLINE_VECS
 4

	)

38 
mempoŞ_t
 *
bio_¥l™_poŞ
 
	g__»ad_mo¡ly
;

45 
	#BV
(
x
è{ .
Ä_vecs
 = x, .
Çme
 = "biovec-"
	`__¡ršgify
(xè}

	)

46 
biovec_¦ab
 
	gbvec_¦abs
[
BIOVEC_NR_POOLS
] 
	g__»ad_mo¡ly
 = {

47 
BV
(1), BV(4), BV(16), BV(64), BV(128), BV(
BIO_MAX_PAGES
),

49 #undeà
BV


55 
bio_£t
 *
	gfs_bio_£t
;

60 
	sbio_¦ab
 {

61 
kmem_ÿche
 *
	m¦ab
;

62 
	m¦ab_»f
;

63 
	m¦ab_size
;

64 
	mÇme
[8];

66 
DEFINE_MUTEX
(
bio_¦ab_lock
);

67 
bio_¦ab
 *
	gbio_¦abs
;

68 
	gbio_¦ab_Ä
, 
	gbio_¦ab_max
;

70 
kmem_ÿche
 *
	$bio_fšd_Ü_ü—‹_¦ab
(
exŒa_size
)

72 
sz
 = (
bio
è+ 
exŒa_size
;

73 
kmem_ÿche
 *
¦ab
 = 
NULL
;

74 
bio_¦ab
 *
b¦ab
;

75 
i
, 
’Œy
 = -1;

77 
	`mu‹x_lock
(&
bio_¦ab_lock
);

79 
i
 = 0;

80 
i
 < 
bio_¦ab_Ä
) {

81 
b¦ab
 = &
bio_¦abs
[
i
];

83 ià(!
b¦ab
->
¦ab
 && 
’Œy
 == -1)

84 
’Œy
 = 
i
;

85 ià(
b¦ab
->
¦ab_size
 =ğ
sz
) {

86 
¦ab
 = 
b¦ab
->slab;

87 
b¦ab
->
¦ab_»f
++;

90 
i
++;

93 ià(
¦ab
)

94 
out_uÆock
;

96 ià(
bio_¦ab_Ä
 =ğ
bio_¦ab_max
 && 
’Œy
 == -1) {

97 
bio_¦ab_max
 <<= 1;

98 
bio_¦abs
 = 
	`k»®loc
(bio_slabs,

99 
bio_¦ab_max
 * (
bio_¦ab
),

100 
GFP_KERNEL
);

101 ià(!
bio_¦abs
)

102 
out_uÆock
;

104 ià(
’Œy
 == -1)

105 
’Œy
 = 
bio_¦ab_Ä
++;

107 
b¦ab
 = &
bio_¦abs
[
’Œy
];

109 
	`¢´štf
(
b¦ab
->
Çme
, (b¦ab->Çme), "bio-%d", 
’Œy
);

110 
¦ab
 = 
	`kmem_ÿche_ü—‹
(
b¦ab
->
Çme
, 
sz
, 0, 
SLAB_HWCACHE_ALIGN
, 
NULL
);

111 ià(!
¦ab
)

112 
out_uÆock
;

114 
	`´štk
(
KERN_INFO
 "bio: c»©¦ab <%s>‡ˆ%d\n", 
b¦ab
->
Çme
, 
’Œy
);

115 
b¦ab
->
¦ab
 = slab;

116 
b¦ab
->
¦ab_»f
 = 1;

117 
b¦ab
->
¦ab_size
 = 
sz
;

118 
out_uÆock
:

119 
	`mu‹x_uÆock
(&
bio_¦ab_lock
);

120  
¦ab
;

121 
	}
}

123 
	$bio_put_¦ab
(
bio_£t
 *
bs
)

125 
bio_¦ab
 *
b¦ab
 = 
NULL
;

126 
i
;

128 
	`mu‹x_lock
(&
bio_¦ab_lock
);

130 
i
 = 0; i < 
bio_¦ab_Ä
; i++) {

131 ià(
bs
->
bio_¦ab
 =ğ
bio_¦abs
[
i
].
¦ab
) {

132 
b¦ab
 = &
bio_¦abs
[
i
];

137 ià(
	`WARN
(!
b¦ab
, 
KERN_ERR
 "bio: unableo find slab!\n"))

138 
out
;

140 
	`WARN_ON
(!
b¦ab
->
¦ab_»f
);

142 ià(--
b¦ab
->
¦ab_»f
)

143 
out
;

145 
	`kmem_ÿche_de¡roy
(
b¦ab
->
¦ab
);

146 
b¦ab
->
¦ab
 = 
NULL
;

148 
out
:

149 
	`mu‹x_uÆock
(&
bio_¦ab_lock
);

150 
	}
}

152 
	$bvec_Ä_vecs
(
idx
)

154  
bvec_¦abs
[
idx
].
Ä_vecs
;

155 
	}
}

157 
	$bvec_ä“_bs
(
bio_£t
 *
bs
, 
bio_vec
 *
bv
, 
idx
)

159 
	`BIO_BUG_ON
(
idx
 >ğ
BIOVEC_NR_POOLS
);

161 ià(
idx
 =ğ
BIOVEC_MAX_IDX
)

162 
	`mempoŞ_ä“
(
bv
, 
bs
->
bvec_poŞ
);

164 
biovec_¦ab
 *
bvs
 = 
bvec_¦abs
 + 
idx
;

166 
	`kmem_ÿche_ä“
(
bvs
->
¦ab
, 
bv
);

168 
	}
}

170 
bio_vec
 *
	$bvec_®loc_bs
(
gå_t
 
gå_mask
, 
Ä
, *
idx
,

171 
bio_£t
 *
bs
)

173 
bio_vec
 *
bvl
;

178 
Ä
) {

180 *
idx
 = 0;

183 *
idx
 = 1;

186 *
idx
 = 2;

189 *
idx
 = 3;

192 *
idx
 = 4;

194 129 ... 
BIO_MAX_PAGES
:

195 *
idx
 = 5;

198  
NULL
;

205 ià(*
idx
 =ğ
BIOVEC_MAX_IDX
) {

206 
çÎback
:

207 
bvl
 = 
	`mempoŞ_®loc
(
bs
->
bvec_poŞ
, 
gå_mask
);

209 
biovec_¦ab
 *
bvs
 = 
bvec_¦abs
 + *
idx
;

210 
gå_t
 
__gå_mask
 = 
gå_mask
 & ~(
__GFP_WAIT
 | 
__GFP_IO
);

217 
__gå_mask
 |ğ
__GFP_NOMEMALLOC
 | 
__GFP_NORETRY
 | 
__GFP_NOWARN
;

223 
bvl
 = 
	`kmem_ÿche_®loc
(
bvs
->
¦ab
, 
__gå_mask
);

224 ià(
	`uÆik–y
(!
bvl
 && (
gå_mask
 & 
__GFP_WAIT
))) {

225 *
idx
 = 
BIOVEC_MAX_IDX
;

226 
çÎback
;

230  
bvl
;

231 
	}
}

233 
	$bio_ä“
(
bio
 *bio, 
bio_£t
 *
bs
)

235 *
p
;

237 ià(
	`bio_has_®loÿ‹d_vec
(
bio
))

238 
	`bvec_ä“_bs
(
bs
, 
bio
->
bi_io_vec
, 
	`BIO_POOL_IDX
(bio));

240 ià(
	`bio_š‹gr™y
(
bio
))

241 
	`bio_š‹gr™y_ä“
(
bio
, 
bs
);

246 
p
 = 
bio
;

247 ià(
bs
->
äÚt_·d
)

248 
p
 -ğ
bs
->
äÚt_·d
;

250 
	`mempoŞ_ä“
(
p
, 
bs
->
bio_poŞ
);

251 
	}
}

252 
EXPORT_SYMBOL
(
bio_ä“
);

254 
	$bio_š™
(
bio
 *bio)

256 
	`mem£t
(
bio
, 0, (*bio));

257 
bio
->
bi_æags
 = 1 << 
BIO_UPTODATE
;

258 
	`©omic_£t
(&
bio
->
bi_út
, 1);

259 
	}
}

260 
EXPORT_SYMBOL
(
bio_š™
);

277 
bio
 *
	$bio_®loc_bio£t
(
gå_t
 
gå_mask
, 
Ä_iovecs
, 
bio_£t
 *
bs
)

279 
idx
 = 
BIO_POOL_NONE
;

280 
bio_vec
 *
bvl
 = 
NULL
;

281 
bio
 *bio;

282 *
p
;

284 
p
 = 
	`mempoŞ_®loc
(
bs
->
bio_poŞ
, 
gå_mask
);

285 ià(
	`uÆik–y
(!
p
))

286  
NULL
;

287 
bio
 = 
p
 + 
bs
->
äÚt_·d
;

289 
	`bio_š™
(
bio
);

291 ià(
	`uÆik–y
(!
Ä_iovecs
))

292 
out_£t
;

294 ià(
Ä_iovecs
 <ğ
BIO_INLINE_VECS
) {

295 
bvl
 = 
bio
->
bi_šlše_vecs
;

296 
Ä_iovecs
 = 
BIO_INLINE_VECS
;

298 
bvl
 = 
	`bvec_®loc_bs
(
gå_mask
, 
Ä_iovecs
, &
idx
, 
bs
);

299 ià(
	`uÆik–y
(!
bvl
))

300 
”r_ä“
;

302 
Ä_iovecs
 = 
	`bvec_Ä_vecs
(
idx
);

304 
out_£t
:

305 
bio
->
bi_æags
 |ğ
idx
 << 
BIO_POOL_OFFSET
;

306 
bio
->
bi_max_vecs
 = 
Ä_iovecs
;

307 
bio
->
bi_io_vec
 = 
bvl
;

308  
bio
;

310 
”r_ä“
:

311 
	`mempoŞ_ä“
(
p
, 
bs
->
bio_poŞ
);

312  
NULL
;

313 
	}
}

314 
EXPORT_SYMBOL
(
bio_®loc_bio£t
);

316 
	$bio_fs_de¡ruùÜ
(
bio
 *bio)

318 
	`bio_ä“
(
bio
, 
fs_bio_£t
);

319 
	}
}

340 
bio
 *
	$bio_®loc
(
gå_t
 
gå_mask
, 
Ä_iovecs
)

342 
bio
 *biØğ
	`bio_®loc_bio£t
(
gå_mask
, 
Ä_iovecs
, 
fs_bio_£t
);

344 ià(
bio
)

345 
bio
->
bi_de¡ruùÜ
 = 
bio_fs_de¡ruùÜ
;

347  
bio
;

348 
	}
}

349 
EXPORT_SYMBOL
(
bio_®loc
);

351 
	$bio_km®loc_de¡ruùÜ
(
bio
 *bio)

353 ià(
	`bio_š‹gr™y
(
bio
))

354 
	`bio_š‹gr™y_ä“
(
bio
, 
fs_bio_£t
);

355 
	`kä“
(
bio
);

356 
	}
}

368 
bio
 *
	$bio_km®loc
(
gå_t
 
gå_mask
, 
Ä_iovecs
)

370 
bio
 *bio;

372 ià(
Ä_iovecs
 > 
UIO_MAXIOV
)

373  
NULL
;

375 
bio
 = 
	`km®loc
((bioè+ 
Ä_iovecs
 * (
bio_vec
),

376 
gå_mask
);

377 ià(
	`uÆik–y
(!
bio
))

378  
NULL
;

380 
	`bio_š™
(
bio
);

381 
bio
->
bi_æags
 |ğ
BIO_POOL_NONE
 << 
BIO_POOL_OFFSET
;

382 
bio
->
bi_max_vecs
 = 
Ä_iovecs
;

383 
bio
->
bi_io_vec
 = bio->
bi_šlše_vecs
;

384 
bio
->
bi_de¡ruùÜ
 = 
bio_km®loc_de¡ruùÜ
;

386  
bio
;

387 
	}
}

388 
EXPORT_SYMBOL
(
bio_km®loc
);

390 
	$z”o_fl_bio
(
bio
 *bio)

392 
æags
;

393 
bio_vec
 *
bv
;

394 
i
;

396 
	`bio_fÜ_—ch_£gm’t
(
bv
, 
bio
, 
i
) {

397 *
d©a
 = 
	`bvec_km­_œq
(
bv
, &
æags
);

398 
	`mem£t
(
d©a
, 0, 
bv
->
bv_Ën
);

399 
	`æush_dÿche_·ge
(
bv
->
bv_·ge
);

400 
	`bvec_kunm­_œq
(
d©a
, &
æags
);

402 
	}
}

403 
EXPORT_SYMBOL
(
z”o_fl_bio
);

413 
	$bio_put
(
bio
 *bio)

415 
	`BIO_BUG_ON
(!
	`©omic_»ad
(&
bio
->
bi_út
));

420 ià(
	`©omic_dec_ªd_‹¡
(&
bio
->
bi_út
)) {

421 
bio
->
bi_Ãxt
 = 
NULL
;

422 
bio
->
	`bi_de¡ruùÜ
(bio);

424 
	}
}

425 
EXPORT_SYMBOL
(
bio_put
);

427 
šlše
 
	$bio_phys_£gm’ts
(
»que¡_queue
 *
q
, 
bio
 *bio)

429 ià(
	`uÆik–y
(!
	`bio_æagged
(
bio
, 
BIO_SEG_VALID
)))

430 
	`blk_»couÁ_£gm’ts
(
q
, 
bio
);

432  
bio
->
bi_phys_£gm’ts
;

433 
	}
}

434 
EXPORT_SYMBOL
(
bio_phys_£gm’ts
);

445 
	$__bio_şÚe
(
bio
 *bio, biØ*
bio_¤c
)

447 
	`memıy
(
bio
->
bi_io_vec
, 
bio_¤c
->bi_io_vec,

448 
bio_¤c
->
bi_max_vecs
 * (
bio_vec
));

454 
bio
->
bi_£ùÜ
 = 
bio_¤c
->bi_sector;

455 
bio
->
bi_bdev
 = 
bio_¤c
->bi_bdev;

456 
bio
->
bi_æags
 |ğ1 << 
BIO_CLONED
;

457 
bio
->
bi_rw
 = 
bio_¤c
->bi_rw;

458 
bio
->
bi_vút
 = 
bio_¤c
->bi_vcnt;

459 
bio
->
bi_size
 = 
bio_¤c
->bi_size;

460 
bio
->
bi_idx
 = 
bio_¤c
->bi_idx;

461 
	}
}

462 
EXPORT_SYMBOL
(
__bio_şÚe
);

471 
bio
 *
	$bio_şÚe
(
bio
 *bio, 
gå_t
 
gå_mask
)

473 
bio
 *
b
 = 
	`bio_®loc_bio£t
(
gå_mask
, bio->
bi_max_vecs
, 
fs_bio_£t
);

475 ià(!
b
)

476  
NULL
;

478 
b
->
bi_de¡ruùÜ
 = 
bio_fs_de¡ruùÜ
;

479 
	`__bio_şÚe
(
b
, 
bio
);

481 ià(
	`bio_š‹gr™y
(
bio
)) {

482 
»t
;

484 
»t
 = 
	`bio_š‹gr™y_şÚe
(
b
, 
bio
, 
gå_mask
, 
fs_bio_£t
);

486 ià(
»t
 < 0) {

487 
	`bio_put
(
b
);

488  
NULL
;

492  
b
;

493 
	}
}

494 
EXPORT_SYMBOL
(
bio_şÚe
);

505 
	$bio_g‘_Ä_vecs
(
block_deviû
 *
bdev
)

507 
»que¡_queue
 *
q
 = 
	`bdev_g‘_queue
(
bdev
);

508 
Ä_·ges
;

510 
Ä_·ges
 = ((
	`queue_max_£ùÜs
(
q
è<< 9è+ 
PAGE_SIZE
 - 1è>> 
PAGE_SHIFT
;

511 ià(
Ä_·ges
 > 
	`queue_max_£gm’ts
(
q
))

512 
Ä_·ges
 = 
	`queue_max_£gm’ts
(
q
);

514  
Ä_·ges
;

515 
	}
}

516 
EXPORT_SYMBOL
(
bio_g‘_Ä_vecs
);

518 
	$__bio_add_·ge
(
»que¡_queue
 *
q
, 
bio
 *bio, 
·ge


519 *
·ge
, 
Ën
, 
off£t
,

520 
max_£ùÜs
)

522 
»Œ›d_£gm’ts
 = 0;

523 
bio_vec
 *
bvec
;

528 ià(
	`uÆik–y
(
	`bio_æagged
(
bio
, 
BIO_CLONED
)))

531 ià(((
bio
->
bi_size
 + 
Ën
è>> 9è> 
max_£ùÜs
)

539 ià(
bio
->
bi_vút
 > 0) {

540 
bio_vec
 *
´ev
 = &
bio
->
bi_io_vec
[bio->
bi_vút
 - 1];

542 ià(
·ge
 =ğ
´ev
->
bv_·ge
 &&

543 
off£t
 =ğ
´ev
->
bv_off£t
 +…»v->
bv_Ën
) {

544 
´ev_bv_Ën
 = 
´ev
->
bv_Ën
;

545 
´ev
->
bv_Ën
 +ğ
Ën
;

547 ià(
q
->
m”ge_bvec_â
) {

548 
bvec_m”ge_d©a
 
bvm
 = {

553 .
bi_bdev
 = 
bio
->bi_bdev,

554 .
bi_£ùÜ
 = 
bio
->bi_sector,

555 .
bi_size
 = 
bio
->bi_siz- 
´ev_bv_Ën
,

556 .
bi_rw
 = 
bio
->bi_rw,

559 ià(
q
->
	`m”ge_bvec_â
(q, &
bvm
, 
´ev
è<…»v->
bv_Ën
) {

560 
´ev
->
bv_Ën
 -ğ
Ën
;

565 
dÚe
;

569 ià(
bio
->
bi_vút
 >ğbio->
bi_max_vecs
)

577 
bio
->
bi_phys_£gm’ts
 >ğ
	`queue_max_£gm’ts
(
q
)) {

579 ià(
»Œ›d_£gm’ts
)

582 
»Œ›d_£gm’ts
 = 1;

583 
	`blk_»couÁ_£gm’ts
(
q
, 
bio
);

590 
bvec
 = &
bio
->
bi_io_vec
[bio->
bi_vút
];

591 
bvec
->
bv_·ge
 = 
·ge
;

592 
bvec
->
bv_Ën
 = 
Ën
;

593 
bvec
->
bv_off£t
 = 
off£t
;

600 ià(
q
->
m”ge_bvec_â
) {

601 
bvec_m”ge_d©a
 
bvm
 = {

602 .
bi_bdev
 = 
bio
->bi_bdev,

603 .
bi_£ùÜ
 = 
bio
->bi_sector,

604 .
bi_size
 = 
bio
->bi_size,

605 .
bi_rw
 = 
bio
->bi_rw,

612 ià(
q
->
	`m”ge_bvec_â
(q, &
bvm
, 
bvec
è< bvec->
bv_Ën
) {

613 
bvec
->
bv_·ge
 = 
NULL
;

614 
bvec
->
bv_Ën
 = 0;

615 
bvec
->
bv_off£t
 = 0;

621 ià(
bio
->
bi_vút
 && (
	`BIOVEC_PHYS_MERGEABLE
(
bvec
-1, bvec)))

622 
bio
->
bi_æags
 &ğ~(1 << 
BIO_SEG_VALID
);

624 
bio
->
bi_vút
++;

625 
bio
->
bi_phys_£gm’ts
++;

626 
dÚe
:

627 
bio
->
bi_size
 +ğ
Ën
;

628  
Ën
;

629 
	}
}

646 
	$bio_add_pc_·ge
(
»que¡_queue
 *
q
, 
bio
 *bio, 
·ge
 *page,

647 
Ën
, 
off£t
)

649  
	`__bio_add_·ge
(
q
, 
bio
, 
·ge
, 
Ën
, 
off£t
,

650 
	`queue_max_hw_£ùÜs
(
q
));

651 
	}
}

652 
EXPORT_SYMBOL
(
bio_add_pc_·ge
);

666 
	$bio_add_·ge
(
bio
 *bio, 
·ge
 *·ge, 
Ën
,

667 
off£t
)

669 
»que¡_queue
 *
q
 = 
	`bdev_g‘_queue
(
bio
->
bi_bdev
);

670  
	`__bio_add_·ge
(
q
, 
bio
, 
·ge
, 
Ën
, 
off£t
, 
	`queue_max_£ùÜs
(q));

671 
	}
}

672 
EXPORT_SYMBOL
(
bio_add_·ge
);

674 
	sbio_m­_d©a
 {

675 
bio_vec
 *
	miovecs
;

676 
sg_iovec
 *
	msgvecs
;

677 
	mÄ_sgvecs
;

678 
	mis_our_·ges
;

681 
	$bio_£t_m­_d©a
(
bio_m­_d©a
 *
bmd
, 
bio
 *bio,

682 
sg_iovec
 *
iov
, 
iov_couÁ
,

683 
is_our_·ges
)

685 
	`memıy
(
bmd
->
iovecs
, 
bio
->
bi_io_vec
, (
bio_vec
è* bio->
bi_vút
);

686 
	`memıy
(
bmd
->
sgvecs
, 
iov
, (
sg_iovec
è* 
iov_couÁ
);

687 
bmd
->
Ä_sgvecs
 = 
iov_couÁ
;

688 
bmd
->
is_our_·ges
 = is_our_pages;

689 
bio
->
bi_´iv©e
 = 
bmd
;

690 
	}
}

692 
	$bio_ä“_m­_d©a
(
bio_m­_d©a
 *
bmd
)

694 
	`kä“
(
bmd
->
iovecs
);

695 
	`kä“
(
bmd
->
sgvecs
);

696 
	`kä“
(
bmd
);

697 
	}
}

699 
bio_m­_d©a
 *
	$bio_®loc_m­_d©a
(
Ä_£gs
,

700 
iov_couÁ
,

701 
gå_t
 
gå_mask
)

703 
bio_m­_d©a
 *
bmd
;

705 ià(
iov_couÁ
 > 
UIO_MAXIOV
)

706  
NULL
;

708 
bmd
 = 
	`km®loc
((*bmd), 
gå_mask
);

709 ià(!
bmd
)

710  
NULL
;

712 
bmd
->
iovecs
 = 
	`km®loc
((
bio_vec
è* 
Ä_£gs
, 
gå_mask
);

713 ià(!
bmd
->
iovecs
) {

714 
	`kä“
(
bmd
);

715  
NULL
;

718 
bmd
->
sgvecs
 = 
	`km®loc
((
sg_iovec
è* 
iov_couÁ
, 
gå_mask
);

719 ià(
bmd
->
sgvecs
)

720  
bmd
;

722 
	`kä“
(
bmd
->
iovecs
);

723 
	`kä“
(
bmd
);

724  
NULL
;

725 
	}
}

727 
	$__bio_cİy_iov
(
bio
 *bio, 
bio_vec
 *
iovecs
,

728 
sg_iovec
 *
iov
, 
iov_couÁ
,

729 
to_u£r
, 
äom_u£r
, 
do_ä“_·ge
)

731 
»t
 = 0, 
i
;

732 
bio_vec
 *
bvec
;

733 
iov_idx
 = 0;

734 
iov_off
 = 0;

736 
	`__bio_fÜ_—ch_£gm’t
(
bvec
, 
bio
, 
i
, 0) {

737 *
bv_addr
 = 
	`·ge_add»ss
(
bvec
->
bv_·ge
);

738 
bv_Ën
 = 
iovecs
[
i
].bv_len;

740 
bv_Ën
 && 
iov_idx
 < 
iov_couÁ
) {

741 
by‹s
;

742 
__u£r
 *
iov_addr
;

744 
by‹s
 = 
	`mš_t
(,

745 
iov
[
iov_idx
].
iov_Ën
 - 
iov_off
, 
bv_Ën
);

746 
iov_addr
 = 
iov
[
iov_idx
].
iov_ba£
 + 
iov_off
;

748 ià(!
»t
) {

749 ià(
to_u£r
)

750 
»t
 = 
	`cİy_to_u£r
(
iov_addr
, 
bv_addr
,

751 
by‹s
);

753 ià(
äom_u£r
)

754 
»t
 = 
	`cİy_äom_u£r
(
bv_addr
, 
iov_addr
,

755 
by‹s
);

757 ià(
»t
)

758 
»t
 = -
EFAULT
;

761 
bv_Ën
 -ğ
by‹s
;

762 
bv_addr
 +ğ
by‹s
;

763 
iov_addr
 +ğ
by‹s
;

764 
iov_off
 +ğ
by‹s
;

766 ià(
iov
[
iov_idx
].
iov_Ën
 =ğ
iov_off
) {

767 
iov_idx
++;

768 
iov_off
 = 0;

772 ià(
do_ä“_·ge
)

773 
	`__ä“_·ge
(
bvec
->
bv_·ge
);

776  
»t
;

777 
	}
}

786 
	$bio_uncİy_u£r
(
bio
 *bio)

788 
bio_m­_d©a
 *
bmd
 = 
bio
->
bi_´iv©e
;

789 
»t
 = 0;

791 ià(!
	`bio_æagged
(
bio
, 
BIO_NULL_MAPPED
))

792 
»t
 = 
	`__bio_cİy_iov
(
bio
, 
bmd
->
iovecs
, bmd->
sgvecs
,

793 
bmd
->
Ä_sgvecs
, 
	`bio_d©a_dœ
(
bio
è=ğ
READ
,

794 0, 
bmd
->
is_our_·ges
);

795 
	`bio_ä“_m­_d©a
(
bmd
);

796 
	`bio_put
(
bio
);

797  
»t
;

798 
	}
}

799 
EXPORT_SYMBOL
(
bio_uncİy_u£r
);

814 
bio
 *
	$bio_cİy_u£r_iov
(
»que¡_queue
 *
q
,

815 
rq_m­_d©a
 *
m­_d©a
,

816 
sg_iovec
 *
iov
, 
iov_couÁ
,

817 
wr™e_to_vm
, 
gå_t
 
gå_mask
)

819 
bio_m­_d©a
 *
bmd
;

820 
bio_vec
 *
bvec
;

821 
·ge
 *page;

822 
bio
 *bio;

823 
i
, 
»t
;

824 
Ä_·ges
 = 0;

825 
Ën
 = 0;

826 
off£t
 = 
m­_d©a
 ? m­_d©a->off£ˆ& ~
PAGE_MASK
 : 0;

828 
i
 = 0; i < 
iov_couÁ
; i++) {

829 
uaddr
;

830 
’d
;

831 
¡¬t
;

833 
uaddr
 = ()
iov
[
i
].
iov_ba£
;

834 
’d
 = (
uaddr
 + 
iov
[
i
].
iov_Ën
 + 
PAGE_SIZE
 - 1è>> 
PAGE_SHIFT
;

835 
¡¬t
 = 
uaddr
 >> 
PAGE_SHIFT
;

840 ià(
’d
 < 
¡¬t
)

841  
	`ERR_PTR
(-
EINVAL
);

843 
Ä_·ges
 +ğ
’d
 - 
¡¬t
;

844 
Ën
 +ğ
iov
[
i
].
iov_Ën
;

847 ià(
off£t
)

848 
Ä_·ges
++;

850 
bmd
 = 
	`bio_®loc_m­_d©a
(
Ä_·ges
, 
iov_couÁ
, 
gå_mask
);

851 ià(!
bmd
)

852  
	`ERR_PTR
(-
ENOMEM
);

854 
»t
 = -
ENOMEM
;

855 
bio
 = 
	`bio_km®loc
(
gå_mask
, 
Ä_·ges
);

856 ià(!
bio
)

857 
out_bmd
;

859 ià(!
wr™e_to_vm
)

860 
bio
->
bi_rw
 |ğ
REQ_WRITE
;

862 
»t
 = 0;

864 ià(
m­_d©a
) {

865 
Ä_·ges
 = 1 << 
m­_d©a
->
·ge_Üd”
;

866 
i
 = 
m­_d©a
->
off£t
 / 
PAGE_SIZE
;

868 
Ën
) {

869 
by‹s
 = 
PAGE_SIZE
;

871 
by‹s
 -ğ
off£t
;

873 ià(
by‹s
 > 
Ën
)

874 
by‹s
 = 
Ën
;

876 ià(
m­_d©a
) {

877 ià(
i
 =ğ
m­_d©a
->
Ä_’Œ›s
 * 
Ä_·ges
) {

878 
»t
 = -
ENOMEM
;

882 
·ge
 = 
m­_d©a
->
·ges
[
i
 / 
Ä_·ges
];

883 
·ge
 +ğ(
i
 % 
Ä_·ges
);

885 
i
++;

887 
·ge
 = 
	`®loc_·ge
(
q
->
bounû_gå
 | 
gå_mask
);

888 ià(!
·ge
) {

889 
»t
 = -
ENOMEM
;

894 ià(
	`bio_add_pc_·ge
(
q
, 
bio
, 
·ge
, 
by‹s
, 
off£t
) < bytes)

897 
Ën
 -ğ
by‹s
;

898 
off£t
 = 0;

901 ià(
»t
)

902 
ş—nup
;

907 ià((!
wr™e_to_vm
 && (!
m­_d©a
 || !m­_d©a->
nuÎ_m­³d
)) ||

908 (
m­_d©a
 && m­_d©a->
äom_u£r
)) {

909 
»t
 = 
	`__bio_cİy_iov
(
bio
, bio->
bi_io_vec
, 
iov
, 
iov_couÁ
, 0, 1, 0);

910 ià(
»t
)

911 
ş—nup
;

914 
	`bio_£t_m­_d©a
(
bmd
, 
bio
, 
iov
, 
iov_couÁ
, 
m­_d©a
 ? 0 : 1);

915  
bio
;

916 
ş—nup
:

917 ià(!
m­_d©a
)

918 
	`bio_fÜ_—ch_£gm’t
(
bvec
, 
bio
, 
i
)

919 
	`__ä“_·ge
(
bvec
->
bv_·ge
);

921 
	`bio_put
(
bio
);

922 
out_bmd
:

923 
	`bio_ä“_m­_d©a
(
bmd
);

924  
	`ERR_PTR
(
»t
);

925 
	}
}

940 
bio
 *
	$bio_cİy_u£r
(
»que¡_queue
 *
q
, 
rq_m­_d©a
 *
m­_d©a
,

941 
uaddr
, 
Ën
,

942 
wr™e_to_vm
, 
gå_t
 
gå_mask
)

944 
sg_iovec
 
iov
;

946 
iov
.
iov_ba£
 = (
__u£r
 *)
uaddr
;

947 
iov
.
iov_Ën
 = 
Ën
;

949  
	`bio_cİy_u£r_iov
(
q
, 
m­_d©a
, &
iov
, 1, 
wr™e_to_vm
, 
gå_mask
);

950 
	}
}

951 
EXPORT_SYMBOL
(
bio_cİy_u£r
);

953 
bio
 *
	$__bio_m­_u£r_iov
(
»que¡_queue
 *
q
,

954 
block_deviû
 *
bdev
,

955 
sg_iovec
 *
iov
, 
iov_couÁ
,

956 
wr™e_to_vm
, 
gå_t
 
gå_mask
)

958 
i
, 
j
;

959 
Ä_·ges
 = 0;

960 
·ge
 **
·ges
;

961 
bio
 *bio;

962 
cur_·ge
 = 0;

963 
»t
, 
off£t
;

965 
i
 = 0; i < 
iov_couÁ
; i++) {

966 
uaddr
 = ()
iov
[
i
].
iov_ba£
;

967 
Ën
 = 
iov
[
i
].
iov_Ën
;

968 
’d
 = (
uaddr
 + 
Ën
 + 
PAGE_SIZE
 - 1è>> 
PAGE_SHIFT
;

969 
¡¬t
 = 
uaddr
 >> 
PAGE_SHIFT
;

974 ià(
’d
 < 
¡¬t
)

975  
	`ERR_PTR
(-
EINVAL
);

977 
Ä_·ges
 +ğ
’d
 - 
¡¬t
;

981 ià(
uaddr
 & 
	`queue_dma_®ignm’t
(
q
))

982  
	`ERR_PTR
(-
EINVAL
);

985 ià(!
Ä_·ges
)

986  
	`ERR_PTR
(-
EINVAL
);

988 
bio
 = 
	`bio_km®loc
(
gå_mask
, 
Ä_·ges
);

989 ià(!
bio
)

990  
	`ERR_PTR
(-
ENOMEM
);

992 
»t
 = -
ENOMEM
;

993 
·ges
 = 
	`kÿÎoc
(
Ä_·ges
, (
·ge
 *), 
gå_mask
);

994 ià(!
·ges
)

995 
out
;

997 
i
 = 0; i < 
iov_couÁ
; i++) {

998 
uaddr
 = ()
iov
[
i
].
iov_ba£
;

999 
Ën
 = 
iov
[
i
].
iov_Ën
;

1000 
’d
 = (
uaddr
 + 
Ën
 + 
PAGE_SIZE
 - 1è>> 
PAGE_SHIFT
;

1001 
¡¬t
 = 
uaddr
 >> 
PAGE_SHIFT
;

1002 cÚ¡ 
loÿl_Ä_·ges
 = 
’d
 - 
¡¬t
;

1003 cÚ¡ 
·ge_lim™
 = 
cur_·ge
 + 
loÿl_Ä_·ges
;

1005 
»t
 = 
	`g‘_u£r_·ges_ç¡
(
uaddr
, 
loÿl_Ä_·ges
,

1006 
wr™e_to_vm
, &
·ges
[
cur_·ge
]);

1007 ià(
»t
 < 
loÿl_Ä_·ges
) {

1008 
»t
 = -
EFAULT
;

1009 
out_unm­
;

1012 
off£t
 = 
uaddr
 & ~
PAGE_MASK
;

1013 
j
 = 
cur_·ge
; j < 
·ge_lim™
; j++) {

1014 
by‹s
 = 
PAGE_SIZE
 - 
off£t
;

1016 ià(
Ën
 <= 0)

1019 ià(
by‹s
 > 
Ën
)

1020 
by‹s
 = 
Ën
;

1025 ià(
	`bio_add_pc_·ge
(
q
, 
bio
, 
·ges
[
j
], 
by‹s
, 
off£t
) <

1026 
by‹s
)

1029 
Ën
 -ğ
by‹s
;

1030 
off£t
 = 0;

1033 
cur_·ge
 = 
j
;

1037 
j
 < 
·ge_lim™
)

1038 
	`·ge_ÿche_»Ëa£
(
·ges
[
j
++]);

1041 
	`kä“
(
·ges
);

1046 ià(!
wr™e_to_vm
)

1047 
bio
->
bi_rw
 |ğ
REQ_WRITE
;

1049 
bio
->
bi_bdev
 = 
bdev
;

1050 
bio
->
bi_æags
 |ğ(1 << 
BIO_USER_MAPPED
);

1051  
bio
;

1053 
out_unm­
:

1054 
i
 = 0; i < 
Ä_·ges
; i++) {

1055 if(!
·ges
[
i
])

1057 
	`·ge_ÿche_»Ëa£
(
·ges
[
i
]);

1059 
out
:

1060 
	`kä“
(
·ges
);

1061 
	`bio_put
(
bio
);

1062  
	`ERR_PTR
(
»t
);

1063 
	}
}

1077 
bio
 *
	$bio_m­_u£r
(
»que¡_queue
 *
q
, 
block_deviû
 *
bdev
,

1078 
uaddr
, 
Ën
, 
wr™e_to_vm
,

1079 
gå_t
 
gå_mask
)

1081 
sg_iovec
 
iov
;

1083 
iov
.
iov_ba£
 = (
__u£r
 *)
uaddr
;

1084 
iov
.
iov_Ën
 = 
Ën
;

1086  
	`bio_m­_u£r_iov
(
q
, 
bdev
, &
iov
, 1, 
wr™e_to_vm
, 
gå_mask
);

1087 
	}
}

1088 
EXPORT_SYMBOL
(
bio_m­_u£r
);

1102 
bio
 *
	$bio_m­_u£r_iov
(
»que¡_queue
 *
q
, 
block_deviû
 *
bdev
,

1103 
sg_iovec
 *
iov
, 
iov_couÁ
,

1104 
wr™e_to_vm
, 
gå_t
 
gå_mask
)

1106 
bio
 *bio;

1108 
bio
 = 
	`__bio_m­_u£r_iov
(
q
, 
bdev
, 
iov
, 
iov_couÁ
, 
wr™e_to_vm
,

1109 
gå_mask
);

1110 ià(
	`IS_ERR
(
bio
))

1111  
bio
;

1119 
	`bio_g‘
(
bio
);

1121  
bio
;

1122 
	}
}

1124 
	$__bio_unm­_u£r
(
bio
 *bio)

1126 
bio_vec
 *
bvec
;

1127 
i
;

1132 
	`__bio_fÜ_—ch_£gm’t
(
bvec
, 
bio
, 
i
, 0) {

1133 ià(
	`bio_d©a_dœ
(
bio
è=ğ
READ
)

1134 
	`£t_·ge_dœty_lock
(
bvec
->
bv_·ge
);

1136 
	`·ge_ÿche_»Ëa£
(
bvec
->
bv_·ge
);

1139 
	`bio_put
(
bio
);

1140 
	}
}

1151 
	$bio_unm­_u£r
(
bio
 *bio)

1153 
	`__bio_unm­_u£r
(
bio
);

1154 
	`bio_put
(
bio
);

1155 
	}
}

1156 
EXPORT_SYMBOL
(
bio_unm­_u£r
);

1158 
	$bio_m­_k”n_’dio
(
bio
 *bio, 
”r
)

1160 
	`bio_put
(
bio
);

1161 
	}
}

1163 
bio
 *
	$__bio_m­_k”n
(
»que¡_queue
 *
q
, *
d©a
,

1164 
Ën
, 
gå_t
 
gå_mask
)

1166 
kaddr
 = ()
d©a
;

1167 
’d
 = (
kaddr
 + 
Ën
 + 
PAGE_SIZE
 - 1è>> 
PAGE_SHIFT
;

1168 
¡¬t
 = 
kaddr
 >> 
PAGE_SHIFT
;

1169 cÚ¡ 
Ä_·ges
 = 
’d
 - 
¡¬t
;

1170 
off£t
, 
i
;

1171 
bio
 *bio;

1173 
bio
 = 
	`bio_km®loc
(
gå_mask
, 
Ä_·ges
);

1174 ià(!
bio
)

1175  
	`ERR_PTR
(-
ENOMEM
);

1177 
off£t
 = 
	`off£t_š_·ge
(
kaddr
);

1178 
i
 = 0; i < 
Ä_·ges
; i++) {

1179 
by‹s
 = 
PAGE_SIZE
 - 
off£t
;

1181 ià(
Ën
 <= 0)

1184 ià(
by‹s
 > 
Ën
)

1185 
by‹s
 = 
Ën
;

1187 ià(
	`bio_add_pc_·ge
(
q
, 
bio
, 
	`vœt_to_·ge
(
d©a
), 
by‹s
,

1188 
off£t
è< 
by‹s
)

1191 
d©a
 +ğ
by‹s
;

1192 
Ën
 -ğ
by‹s
;

1193 
off£t
 = 0;

1196 
bio
->
bi_’d_io
 = 
bio_m­_k”n_’dio
;

1197  
bio
;

1198 
	}
}

1210 
bio
 *
	$bio_m­_k”n
(
»que¡_queue
 *
q
, *
d©a
, 
Ën
,

1211 
gå_t
 
gå_mask
)

1213 
bio
 *bio;

1215 
bio
 = 
	`__bio_m­_k”n
(
q
, 
d©a
, 
Ën
, 
gå_mask
);

1216 ià(
	`IS_ERR
(
bio
))

1217  
bio
;

1219 ià(
bio
->
bi_size
 =ğ
Ën
)

1220  
bio
;

1225 
	`bio_put
(
bio
);

1226  
	`ERR_PTR
(-
EINVAL
);

1227 
	}
}

1228 
EXPORT_SYMBOL
(
bio_m­_k”n
);

1230 
	$bio_cİy_k”n_’dio
(
bio
 *bio, 
”r
)

1232 
bio_vec
 *
bvec
;

1233 cÚ¡ 
»ad
 = 
	`bio_d©a_dœ
(
bio
è=ğ
READ
;

1234 
bio_m­_d©a
 *
bmd
 = 
bio
->
bi_´iv©e
;

1235 
i
;

1236 *
p
 = 
bmd
->
sgvecs
[0].
iov_ba£
;

1238 
	`__bio_fÜ_—ch_£gm’t
(
bvec
, 
bio
, 
i
, 0) {

1239 *
addr
 = 
	`·ge_add»ss
(
bvec
->
bv_·ge
);

1240 
Ën
 = 
bmd
->
iovecs
[
i
].
bv_Ën
;

1242 ià(
»ad
)

1243 
	`memıy
(
p
, 
addr
, 
Ën
);

1245 
	`__ä“_·ge
(
bvec
->
bv_·ge
);

1246 
p
 +ğ
Ën
;

1249 
	`bio_ä“_m­_d©a
(
bmd
);

1250 
	`bio_put
(
bio
);

1251 
	}
}

1264 
bio
 *
	$bio_cİy_k”n
(
»que¡_queue
 *
q
, *
d©a
, 
Ën
,

1265 
gå_t
 
gå_mask
, 
»adšg
)

1267 
bio
 *bio;

1268 
bio_vec
 *
bvec
;

1269 
i
;

1271 
bio
 = 
	`bio_cİy_u£r
(
q
, 
NULL
, ()
d©a
, 
Ën
, 1, 
gå_mask
);

1272 ià(
	`IS_ERR
(
bio
))

1273  
bio
;

1275 ià(!
»adšg
) {

1276 *
p
 = 
d©a
;

1278 
	`bio_fÜ_—ch_£gm’t
(
bvec
, 
bio
, 
i
) {

1279 *
addr
 = 
	`·ge_add»ss
(
bvec
->
bv_·ge
);

1281 
	`memıy
(
addr
, 
p
, 
bvec
->
bv_Ën
);

1282 
p
 +ğ
bvec
->
bv_Ën
;

1286 
bio
->
bi_’d_io
 = 
bio_cİy_k”n_’dio
;

1288  
bio
;

1289 
	}
}

1290 
EXPORT_SYMBOL
(
bio_cİy_k”n
);

1321 
	$bio_£t_·ges_dœty
(
bio
 *bio)

1323 
bio_vec
 *
bvec
 = 
bio
->
bi_io_vec
;

1324 
i
;

1326 
i
 = 0; i < 
bio
->
bi_vút
; i++) {

1327 
·ge
 *·gğ
bvec
[
i
].
bv_·ge
;

1329 ià(
·ge
 && !
	`PageCompound
(page))

1330 
	`£t_·ge_dœty_lock
(
·ge
);

1332 
	}
}

1334 
	$bio_»Ëa£_·ges
(
bio
 *bio)

1336 
bio_vec
 *
bvec
 = 
bio
->
bi_io_vec
;

1337 
i
;

1339 
i
 = 0; i < 
bio
->
bi_vút
; i++) {

1340 
·ge
 *·gğ
bvec
[
i
].
bv_·ge
;

1342 ià(
·ge
)

1343 
	`put_·ge
(
·ge
);

1345 
	}
}

1358 
bio_dœty_â
(
wÜk_¡ruù
 *
wÜk
);

1360 
DECLARE_WORK
(
bio_dœty_wÜk
, 
bio_dœty_â
);

1361 
DEFINE_SPINLOCK
(
bio_dœty_lock
);

1362 
bio
 *
	gbio_dœty_li¡
;

1367 
	$bio_dœty_â
(
wÜk_¡ruù
 *
wÜk
)

1369 
æags
;

1370 
bio
 *bio;

1372 
	`¥š_lock_œq§ve
(&
bio_dœty_lock
, 
æags
);

1373 
bio
 = 
bio_dœty_li¡
;

1374 
bio_dœty_li¡
 = 
NULL
;

1375 
	`¥š_uÆock_œq»¡Üe
(&
bio_dœty_lock
, 
æags
);

1377 
bio
) {

1378 
bio
 *
Ãxt
 = bio->
bi_´iv©e
;

1380 
	`bio_£t_·ges_dœty
(
bio
);

1381 
	`bio_»Ëa£_·ges
(
bio
);

1382 
	`bio_put
(
bio
);

1383 
bio
 = 
Ãxt
;

1385 
	}
}

1387 
	$bio_check_·ges_dœty
(
bio
 *bio)

1389 
bio_vec
 *
bvec
 = 
bio
->
bi_io_vec
;

1390 
Ä_ş—n_·ges
 = 0;

1391 
i
;

1393 
i
 = 0; i < 
bio
->
bi_vút
; i++) {

1394 
·ge
 *·gğ
bvec
[
i
].
bv_·ge
;

1396 ià(
	`PageDœty
(
·ge
è|| 
	`PageCompound
(page)) {

1397 
	`·ge_ÿche_»Ëa£
(
·ge
);

1398 
bvec
[
i
].
bv_·ge
 = 
NULL
;

1400 
Ä_ş—n_·ges
++;

1404 ià(
Ä_ş—n_·ges
) {

1405 
æags
;

1407 
	`¥š_lock_œq§ve
(&
bio_dœty_lock
, 
æags
);

1408 
bio
->
bi_´iv©e
 = 
bio_dœty_li¡
;

1409 
bio_dœty_li¡
 = 
bio
;

1410 
	`¥š_uÆock_œq»¡Üe
(&
bio_dœty_lock
, 
æags
);

1411 
	`scheduË_wÜk
(&
bio_dœty_wÜk
);

1413 
	`bio_put
(
bio
);

1415 
	}
}

1417 #ià
ARCH_IMPLEMENTS_FLUSH_DCACHE_PAGE


1418 
	$bio_æush_dÿche_·ges
(
bio
 *
bi
)

1420 
i
;

1421 
bio_vec
 *
bvec
;

1423 
	`bio_fÜ_—ch_£gm’t
(
bvec
, 
bi
, 
i
)

1424 
	`æush_dÿche_·ge
(
bvec
->
bv_·ge
);

1425 
	}
}

1426 
EXPORT_SYMBOL
(
bio_æush_dÿche_·ges
);

1443 
	$bio_’dio
(
bio
 *bio, 
”rÜ
)

1445 ià(
”rÜ
)

1446 
	`ş—r_b™
(
BIO_UPTODATE
, &
bio
->
bi_æags
);

1447 ià(!
	`‹¡_b™
(
BIO_UPTODATE
, &
bio
->
bi_æags
))

1448 
”rÜ
 = -
EIO
;

1450 ià(
bio
->
bi_’d_io
)

1451 
bio
->
	`bi_’d_io
(bio, 
”rÜ
);

1452 
	}
}

1453 
EXPORT_SYMBOL
(
bio_’dio
);

1455 
	$bio_·œ_»Ëa£
(
bio_·œ
 *
bp
)

1457 ià(
	`©omic_dec_ªd_‹¡
(&
bp
->
út
)) {

1458 
bio
 *
ma¡”
 = 
bp
->
bio1
.
bi_´iv©e
;

1460 
	`bio_’dio
(
ma¡”
, 
bp
->
”rÜ
);

1461 
	`mempoŞ_ä“
(
bp
, bp->
bio2
.
bi_´iv©e
);

1463 
	}
}

1464 
EXPORT_SYMBOL
(
bio_·œ_»Ëa£
);

1466 
	$bio_·œ_’d_1
(
bio
 *
bi
, 
”r
)

1468 
bio_·œ
 *
bp
 = 
	`cÚš”_of
(
bi
, bio_·œ, 
bio1
);

1470 ià(
”r
)

1471 
bp
->
”rÜ
 = 
”r
;

1473 
	`bio_·œ_»Ëa£
(
bp
);

1474 
	}
}

1476 
	$bio_·œ_’d_2
(
bio
 *
bi
, 
”r
)

1478 
bio_·œ
 *
bp
 = 
	`cÚš”_of
(
bi
, bio_·œ, 
bio2
);

1480 ià(
”r
)

1481 
bp
->
”rÜ
 = 
”r
;

1483 
	`bio_·œ_»Ëa£
(
bp
);

1484 
	}
}

1489 
bio_·œ
 *
	$bio_¥l™
(
bio
 *
bi
, 
fœ¡_£ùÜs
)

1491 
bio_·œ
 *
bp
 = 
	`mempoŞ_®loc
(
bio_¥l™_poŞ
, 
GFP_NOIO
);

1493 ià(!
bp
)

1494  
bp
;

1496 
	`Œaû_block_¥l™
(
	`bdev_g‘_queue
(
bi
->
bi_bdev
), bi,

1497 
bi
->
bi_£ùÜ
 + 
fœ¡_£ùÜs
);

1499 
	`BUG_ON
(
bi
->
bi_vút
 != 1);

1500 
	`BUG_ON
(
bi
->
bi_idx
 != 0);

1501 
	`©omic_£t
(&
bp
->
út
, 3);

1502 
bp
->
”rÜ
 = 0;

1503 
bp
->
bio1
 = *
bi
;

1504 
bp
->
bio2
 = *
bi
;

1505 
bp
->
bio2
.
bi_£ùÜ
 +ğ
fœ¡_£ùÜs
;

1506 
bp
->
bio2
.
bi_size
 -ğ
fœ¡_£ùÜs
 << 9;

1507 
bp
->
bio1
.
bi_size
 = 
fœ¡_£ùÜs
 << 9;

1509 
bp
->
bv1
 = 
bi
->
bi_io_vec
[0];

1510 
bp
->
bv2
 = 
bi
->
bi_io_vec
[0];

1511 
bp
->
bv2
.
bv_off£t
 +ğ
fœ¡_£ùÜs
 << 9;

1512 
bp
->
bv2
.
bv_Ën
 -ğ
fœ¡_£ùÜs
 << 9;

1513 
bp
->
bv1
.
bv_Ën
 = 
fœ¡_£ùÜs
 << 9;

1515 
bp
->
bio1
.
bi_io_vec
 = &bp->
bv1
;

1516 
bp
->
bio2
.
bi_io_vec
 = &bp->
bv2
;

1518 
bp
->
bio1
.
bi_max_vecs
 = 1;

1519 
bp
->
bio2
.
bi_max_vecs
 = 1;

1521 
bp
->
bio1
.
bi_’d_io
 = 
bio_·œ_’d_1
;

1522 
bp
->
bio2
.
bi_’d_io
 = 
bio_·œ_’d_2
;

1524 
bp
->
bio1
.
bi_´iv©e
 = 
bi
;

1525 
bp
->
bio2
.
bi_´iv©e
 = 
bio_¥l™_poŞ
;

1527 ià(
	`bio_š‹gr™y
(
bi
))

1528 
	`bio_š‹gr™y_¥l™
(
bi
, 
bp
, 
fœ¡_£ùÜs
);

1530  
bp
;

1531 
	}
}

1532 
EXPORT_SYMBOL
(
bio_¥l™
);

1544 
£ùÜ_t
 
	$bio_£ùÜ_off£t
(
bio
 *bio, 
šdex
,

1545 
off£t
)

1547 
£ùÜ_sz
;

1548 
bio_vec
 *
bv
;

1549 
£ùÜ_t
 
£ùÜs
;

1550 
i
;

1552 
£ùÜ_sz
 = 
	`queue_logiÿl_block_size
(
bio
->
bi_bdev
->
bd_disk
->
queue
);

1553 
£ùÜs
 = 0;

1555 ià(
šdex
 >ğ
bio
->
bi_idx
)

1556 
šdex
 = 
bio
->
bi_vút
 - 1;

1558 
	`__bio_fÜ_—ch_£gm’t
(
bv
, 
bio
, 
i
, 0) {

1559 ià(
i
 =ğ
šdex
) {

1560 ià(
off£t
 > 
bv
->
bv_off£t
)

1561 
£ùÜs
 +ğ(
off£t
 - 
bv
->
bv_off£t
è/ 
£ùÜ_sz
;

1565 
£ùÜs
 +ğ
bv
->
bv_Ën
 / 
£ùÜ_sz
;

1568  
£ùÜs
;

1569 
	}
}

1570 
EXPORT_SYMBOL
(
bio_£ùÜ_off£t
);

1576 
	$biovec_ü—‹_poŞs
(
bio_£t
 *
bs
, 
poŞ_’Œ›s
)

1578 
biovec_¦ab
 *
bp
 = 
bvec_¦abs
 + 
BIOVEC_MAX_IDX
;

1580 
bs
->
bvec_poŞ
 = 
	`mempoŞ_ü—‹_¦ab_poŞ
(
poŞ_’Œ›s
, 
bp
->
¦ab
);

1581 ià(!
bs
->
bvec_poŞ
)

1582  -
ENOMEM
;

1585 
	}
}

1587 
	$biovec_ä“_poŞs
(
bio_£t
 *
bs
)

1589 
	`mempoŞ_de¡roy
(
bs
->
bvec_poŞ
);

1590 
	}
}

1592 
	$bio£t_ä“
(
bio_£t
 *
bs
)

1594 ià(
bs
->
bio_poŞ
)

1595 
	`mempoŞ_de¡roy
(
bs
->
bio_poŞ
);

1597 
	`bio£t_š‹gr™y_ä“
(
bs
);

1598 
	`biovec_ä“_poŞs
(
bs
);

1599 
	`bio_put_¦ab
(
bs
);

1601 
	`kä“
(
bs
);

1602 
	}
}

1603 
EXPORT_SYMBOL
(
bio£t_ä“
);

1618 
bio_£t
 *
	$bio£t_ü—‹
(
poŞ_size
, 
äÚt_·d
)

1620 
back_·d
 = 
BIO_INLINE_VECS
 * (
bio_vec
);

1621 
bio_£t
 *
bs
;

1623 
bs
 = 
	`kz®loc
((*bs), 
GFP_KERNEL
);

1624 ià(!
bs
)

1625  
NULL
;

1627 
bs
->
äÚt_·d
 = front_pad;

1629 
bs
->
bio_¦ab
 = 
	`bio_fšd_Ü_ü—‹_¦ab
(
äÚt_·d
 + 
back_·d
);

1630 ià(!
bs
->
bio_¦ab
) {

1631 
	`kä“
(
bs
);

1632  
NULL
;

1635 
bs
->
bio_poŞ
 = 
	`mempoŞ_ü—‹_¦ab_poŞ
(
poŞ_size
, bs->
bio_¦ab
);

1636 ià(!
bs
->
bio_poŞ
)

1637 
bad
;

1639 ià(!
	`biovec_ü—‹_poŞs
(
bs
, 
poŞ_size
))

1640  
bs
;

1642 
bad
:

1643 
	`bio£t_ä“
(
bs
);

1644  
NULL
;

1645 
	}
}

1646 
EXPORT_SYMBOL
(
bio£t_ü—‹
);

1648 
__š™
 
	$biovec_š™_¦abs
()

1650 
i
;

1652 
i
 = 0; i < 
BIOVEC_NR_POOLS
; i++) {

1653 
size
;

1654 
biovec_¦ab
 *
bvs
 = 
bvec_¦abs
 + 
i
;

1656 ià(
bvs
->
Ä_vecs
 <ğ
BIO_INLINE_VECS
) {

1657 
bvs
->
¦ab
 = 
NULL
;

1661 
size
 = 
bvs
->
Ä_vecs
 * (
bio_vec
);

1662 
bvs
->
¦ab
 = 
	`kmem_ÿche_ü—‹
(bvs->
Çme
, 
size
, 0,

1663 
SLAB_HWCACHE_ALIGN
|
SLAB_PANIC
, 
NULL
);

1665 
	}
}

1667 
__š™
 
	$š™_bio
()

1669 
bio_¦ab_max
 = 2;

1670 
bio_¦ab_Ä
 = 0;

1671 
bio_¦abs
 = 
	`kz®loc
(
bio_¦ab_max
 * (
bio_¦ab
), 
GFP_KERNEL
);

1672 ià(!
bio_¦abs
)

1673 
	`·nic
("bio: can't‡llocate bios\n");

1675 
	`bio_š‹gr™y_š™
();

1676 
	`biovec_š™_¦abs
();

1678 
fs_bio_£t
 = 
	`bio£t_ü—‹
(
BIO_POOL_SIZE
, 0);

1679 ià(!
fs_bio_£t
)

1680 
	`·nic
("bio: can't‡llocate bios\n");

1682 ià(
	`bio£t_š‹gr™y_ü—‹
(
fs_bio_£t
, 
BIO_POOL_SIZE
))

1683 
	`·nic
("bio: can't create integrity…ool\n");

1685 
bio_¥l™_poŞ
 = 
	`mempoŞ_ü—‹_km®loc_poŞ
(
BIO_SPLIT_ENTRIES
,

1686 (
bio_·œ
));

1687 ià(!
bio_¥l™_poŞ
)

1688 
	`·nic
("bio: can't create split…ool\n");

1691 
	}
}

1692 
subsys_š™ÿÎ
(
š™_bio
);

	@block_dev.c

8 
	~<lšux/š™.h
>

9 
	~<lšux/mm.h
>

10 
	~<lšux/fú.h
>

11 
	~<lšux/¦ab.h
>

12 
	~<lšux/kmod.h
>

13 
	~<lšux/majÜ.h
>

14 
	~<lšux/deviû_cgroup.h
>

15 
	~<lšux/highmem.h
>

16 
	~<lšux/blkdev.h
>

17 
	~<lšux/moduË.h
>

18 
	~<lšux/blkpg.h
>

19 
	~<lšux/bufãr_h—d.h
>

20 
	~<lšux/·gevec.h
>

21 
	~<lšux/wr™eback.h
>

22 
	~<lšux/m·ge.h
>

23 
	~<lšux/mouÁ.h
>

24 
	~<lšux/uio.h
>

25 
	~<lšux/Çmei.h
>

26 
	~<lšux/log2.h
>

27 
	~<lšux/kmemËak.h
>

28 
	~<asm/uacûss.h
>

29 
	~"š‹º®.h
"

31 
	sbdev_šode
 {

32 
block_deviû
 
	mbdev
;

33 
šode
 
	mvfs_šode
;

36 cÚ¡ 
add»ss_¥aû_İ”©iÚs
 
	gdef_blk_aİs
;

38 
šlše
 
bdev_šode
 *
	$BDEV_I
(
šode
 *inode)

40  
	`cÚš”_of
(
šode
, 
bdev_šode
, 
vfs_šode
);

41 
	}
}

43 
šlše
 
block_deviû
 *
	$I_BDEV
(
šode
 *inode)

45  &
	`BDEV_I
(
šode
)->
bdev
;

46 
	}
}

47 
EXPORT_SYMBOL
(
I_BDEV
);

54 
	$bdev_šode_sw™ch_bdi
(
šode
 *inode,

55 
backšg_dev_šfo
 *
d¡
)

57 
backšg_dev_šfo
 *
Şd
 = 
šode
->
i_d©a
.backing_dev_info;

59 ià(
	`uÆik–y
(
d¡
 =ğ
Şd
))

61 
	`bdi_lock_two
(&
Şd
->
wb
, &
d¡
->wb);

62 
	`¥š_lock
(&
šode
->
i_lock
);

63 
šode
->
i_d©a
.
backšg_dev_šfo
 = 
d¡
;

64 ià(
šode
->
i_¡©e
 & 
I_DIRTY
)

65 
	`li¡_move
(&
šode
->
i_wb_li¡
, &
d¡
->
wb
.
b_dœty
);

66 
	`¥š_uÆock
(&
šode
->
i_lock
);

67 
	`¥š_uÆock
(&
Şd
->
wb
.
li¡_lock
);

68 
	`¥š_uÆock
(&
d¡
->
wb
.
li¡_lock
);

69 
	}
}

71 
£ùÜ_t
 
	$max_block
(
block_deviû
 *
bdev
)

73 
£ùÜ_t
 
»tv®
 = ~((sector_t)0);

74 
loff_t
 
sz
 = 
	`i_size_»ad
(
bdev
->
bd_šode
);

76 ià(
sz
) {

77 
size
 = 
	`block_size
(
bdev
);

78 
sizeb™s
 = 
	`blksize_b™s
(
size
);

79 
»tv®
 = (
sz
 >> 
sizeb™s
);

81  
»tv®
;

82 
	}
}

85 
	$kl_bdev
(
block_deviû
 *
bdev
)

87 ià(
bdev
->
bd_šode
->
i_m­pšg
->
Ä·ges
 == 0)

89 
	`šv®id©e_bh_Ìus
();

90 
	`Œunÿ‹_šode_·ges
(
bdev
->
bd_šode
->
i_m­pšg
, 0);

91 
	}
}

93 
	$£t_blocksize
(
block_deviû
 *
bdev
, 
size
)

96 ià(
size
 > 
PAGE_SIZE
 || siz< 512 || !
	`is_pow”_of_2
(size))

97  -
EINVAL
;

100 ià(
size
 < 
	`bdev_logiÿl_block_size
(
bdev
))

101  -
EINVAL
;

104 ià(
bdev
->
bd_block_size
 !ğ
size
) {

105 
	`sync_blockdev
(
bdev
);

106 
bdev
->
bd_block_size
 = 
size
;

107 
bdev
->
bd_šode
->
i_blkb™s
 = 
	`blksize_b™s
(
size
);

108 
	`kl_bdev
(
bdev
);

111 
	}
}

113 
EXPORT_SYMBOL
(
£t_blocksize
);

115 
	$sb_£t_blocksize
(
su³r_block
 *
sb
, 
size
)

117 ià(
	`£t_blocksize
(
sb
->
s_bdev
, 
size
))

121 
sb
->
s_blocksize
 = 
size
;

122 
sb
->
s_blocksize_b™s
 = 
	`blksize_b™s
(
size
);

123  
sb
->
s_blocksize
;

124 
	}
}

126 
EXPORT_SYMBOL
(
sb_£t_blocksize
);

128 
	$sb_mš_blocksize
(
su³r_block
 *
sb
, 
size
)

130 
mšsize
 = 
	`bdev_logiÿl_block_size
(
sb
->
s_bdev
);

131 ià(
size
 < 
mšsize
)

132 
size
 = 
mšsize
;

133  
	`sb_£t_blocksize
(
sb
, 
size
);

134 
	}
}

136 
EXPORT_SYMBOL
(
sb_mš_blocksize
);

139 
	$blkdev_g‘_block
(
šode
 *šode, 
£ùÜ_t
 
iblock
,

140 
bufãr_h—d
 *
bh
, 
ü—‹
)

142 ià(
iblock
 >ğ
	`max_block
(
	`I_BDEV
(
šode
))) {

143 ià(
ü—‹
)

144  -
EIO
;

154 
bh
->
b_bdev
 = 
	`I_BDEV
(
šode
);

155 
bh
->
b_blockÄ
 = 
iblock
;

156 
	`£t_bufãr_m­³d
(
bh
);

158 
	}
}

161 
	$blkdev_g‘_blocks
(
šode
 *šode, 
£ùÜ_t
 
iblock
,

162 
bufãr_h—d
 *
bh
, 
ü—‹
)

164 
£ùÜ_t
 
’d_block
 = 
	`max_block
(
	`I_BDEV
(
šode
));

165 
max_blocks
 = 
bh
->
b_size
 >> 
šode
->
i_blkb™s
;

167 ià((
iblock
 + 
max_blocks
è> 
’d_block
) {

168 
max_blocks
 = 
’d_block
 - 
iblock
;

169 ià(()
max_blocks
 <= 0) {

170 ià(
ü—‹
)

171  -
EIO
;

176 
max_blocks
 = 0;

180 
bh
->
b_bdev
 = 
	`I_BDEV
(
šode
);

181 
bh
->
b_blockÄ
 = 
iblock
;

182 
bh
->
b_size
 = 
max_blocks
 << 
šode
->
i_blkb™s
;

183 ià(
max_blocks
)

184 
	`£t_bufãr_m­³d
(
bh
);

186 
	}
}

188 
ssize_t


189 
	$blkdev_dœeù_IO
(
rw
, 
kiocb
 *
iocb
, cÚ¡ 
iovec
 *
iov
,

190 
loff_t
 
off£t
, 
Ä_£gs
)

192 
fe
 *fğ
iocb
->
ki_fp
;

193 
šode
 *šodğ
fe
->
f_m­pšg
->
ho¡
;

195  
	`__blockdev_dœeù_IO
(
rw
, 
iocb
, 
šode
, 
	`I_BDEV
(šode), 
iov
, 
off£t
,

196 
Ä_£gs
, 
blkdev_g‘_blocks
, 
NULL
, NULL, 0);

197 
	}
}

199 
	$__sync_blockdev
(
block_deviû
 *
bdev
, 
wa™
)

201 ià(!
bdev
)

203 ià(!
wa™
)

204  
	`fem­_æush
(
bdev
->
bd_šode
->
i_m­pšg
);

205  
	`fem­_wr™e_ªd_wa™
(
bdev
->
bd_šode
->
i_m­pšg
);

206 
	}
}

212 
	$sync_blockdev
(
block_deviû
 *
bdev
)

214  
	`__sync_blockdev
(
bdev
, 1);

215 
	}
}

216 
EXPORT_SYMBOL
(
sync_blockdev
);

223 
	$fsync_bdev
(
block_deviû
 *
bdev
)

225 
su³r_block
 *
sb
 = 
	`g‘_su³r
(
bdev
);

226 ià(
sb
) {

227 
»s
 = 
	`sync_fesy¡em
(
sb
);

228 
	`drİ_su³r
(
sb
);

229  
»s
;

231  
	`sync_blockdev
(
bdev
);

232 
	}
}

233 
EXPORT_SYMBOL
(
fsync_bdev
);

247 
su³r_block
 *
	$ä“ze_bdev
(
block_deviû
 *
bdev
)

249 
su³r_block
 *
sb
;

250 
”rÜ
 = 0;

252 
	`mu‹x_lock
(&
bdev
->
bd_fsä“ze_mu‹x
);

253 ià(++
bdev
->
bd_fsä“ze_couÁ
 > 1) {

259 
sb
 = 
	`g‘_su³r
(
bdev
);

260 
	`drİ_su³r
(
sb
);

261 
	`mu‹x_uÆock
(&
bdev
->
bd_fsä“ze_mu‹x
);

262  
sb
;

265 
sb
 = 
	`g‘_aùive_su³r
(
bdev
);

266 ià(!
sb
)

267 
out
;

268 
”rÜ
 = 
	`ä“ze_su³r
(
sb
);

269 ià(
”rÜ
) {

270 
	`d—ùiv©e_su³r
(
sb
);

271 
bdev
->
bd_fsä“ze_couÁ
--;

272 
	`mu‹x_uÆock
(&
bdev
->
bd_fsä“ze_mu‹x
);

273  
	`ERR_PTR
(
”rÜ
);

275 
	`d—ùiv©e_su³r
(
sb
);

276 
out
:

277 
	`sync_blockdev
(
bdev
);

278 
	`mu‹x_uÆock
(&
bdev
->
bd_fsä“ze_mu‹x
);

279  
sb
;

280 
	}
}

281 
EXPORT_SYMBOL
(
ä“ze_bdev
);

290 
	$thaw_bdev
(
block_deviû
 *
bdev
, 
su³r_block
 *
sb
)

292 
”rÜ
 = -
EINVAL
;

294 
	`mu‹x_lock
(&
bdev
->
bd_fsä“ze_mu‹x
);

295 ià(!
bdev
->
bd_fsä“ze_couÁ
)

296 
out
;

298 
”rÜ
 = 0;

299 ià(--
bdev
->
bd_fsä“ze_couÁ
 > 0)

300 
out
;

302 ià(!
sb
)

303 
out
;

305 
”rÜ
 = 
	`thaw_su³r
(
sb
);

306 ià(
”rÜ
) {

307 
bdev
->
bd_fsä“ze_couÁ
++;

308 
	`mu‹x_uÆock
(&
bdev
->
bd_fsä“ze_mu‹x
);

309  
”rÜ
;

311 
out
:

312 
	`mu‹x_uÆock
(&
bdev
->
bd_fsä“ze_mu‹x
);

314 
	}
}

315 
EXPORT_SYMBOL
(
thaw_bdev
);

317 
	$blkdev_wr™•age
(
·ge
 *·ge, 
wr™eback_cÚŒŞ
 *
wbc
)

319  
	`block_wr™e_fuÎ_·ge
(
·ge
, 
blkdev_g‘_block
, 
wbc
);

320 
	}
}

322 
	$blkdev_»ad·ge
(
fe
 * fe, 
·ge
 *…age)

324  
	`block_»ad_fuÎ_·ge
(
·ge
, 
blkdev_g‘_block
);

325 
	}
}

327 
	$blkdev_wr™e_begš
(
fe
 *fe, 
add»ss_¥aû
 *
m­pšg
,

328 
loff_t
 
pos
, 
Ën
, 
æags
,

329 
·ge
 **
·g•
, **
fsd©a
)

331  
	`block_wr™e_begš
(
m­pšg
, 
pos
, 
Ën
, 
æags
, 
·g•
,

332 
blkdev_g‘_block
);

333 
	}
}

335 
	$blkdev_wr™e_’d
(
fe
 *fe, 
add»ss_¥aû
 *
m­pšg
,

336 
loff_t
 
pos
, 
Ën
, 
cİ›d
,

337 
·ge
 *·ge, *
fsd©a
)

339 
»t
;

340 
»t
 = 
	`block_wr™e_’d
(
fe
, 
m­pšg
, 
pos
, 
Ën
, 
cİ›d
, 
·ge
, 
fsd©a
);

342 
	`uÆock_·ge
(
·ge
);

343 
	`·ge_ÿche_»Ëa£
(
·ge
);

345  
»t
;

346 
	}
}

353 
loff_t
 
	$block_Î£ek
(
fe
 *fe, 
loff_t
 
off£t
, 
Üigš
)

355 
šode
 *
bd_šode
 = 
fe
->
f_m­pšg
->
ho¡
;

356 
loff_t
 
size
;

357 
loff_t
 
»tv®
;

359 
	`mu‹x_lock
(&
bd_šode
->
i_mu‹x
);

360 
size
 = 
	`i_size_»ad
(
bd_šode
);

362 
»tv®
 = -
EINVAL
;

363 
Üigš
) {

364 
SEEK_END
:

365 
off£t
 +ğ
size
;

367 
SEEK_CUR
:

368 
off£t
 +ğ
fe
->
f_pos
;

369 
SEEK_SET
:

372 
out
;

374 ià(
off£t
 >ğ0 && off£ˆ<ğ
size
) {

375 ià(
off£t
 !ğ
fe
->
f_pos
) {

376 
fe
->
f_pos
 = 
off£t
;

378 
»tv®
 = 
off£t
;

380 
out
:

381 
	`mu‹x_uÆock
(&
bd_šode
->
i_mu‹x
);

382  
»tv®
;

383 
	}
}

385 
	$blkdev_fsync
(
fe
 *
fp
, 
loff_t
 
¡¬t
,†off_ˆ
’d
, 
d©async
)

387 
šode
 *
bd_šode
 = 
fp
->
f_m­pšg
->
ho¡
;

388 
block_deviû
 *
bdev
 = 
	`I_BDEV
(
bd_šode
);

389 
”rÜ
;

391 
”rÜ
 = 
	`fem­_wr™e_ªd_wa™_¿nge
(
fp
->
f_m­pšg
, 
¡¬t
, 
’d
);

392 ià(
”rÜ
)

393  
”rÜ
;

400 
”rÜ
 = 
	`blkdev_issue_æush
(
bdev
, 
GFP_KERNEL
, 
NULL
);

401 ià(
”rÜ
 =ğ-
EOPNOTSUPP
)

402 
”rÜ
 = 0;

404  
”rÜ
;

405 
	}
}

406 
EXPORT_SYMBOL
(
blkdev_fsync
);

412 
__ÿch–še_®igÃd_š_smp
 
DEFINE_SPINLOCK
(
bdev_lock
);

413 
kmem_ÿche
 * 
bdev_ÿch•
 
	g__»ad_mo¡ly
;

415 
šode
 *
	$bdev_®loc_šode
(
su³r_block
 *
sb
)

417 
bdev_šode
 *
ei
 = 
	`kmem_ÿche_®loc
(
bdev_ÿch•
, 
GFP_KERNEL
);

418 ià(!
ei
)

419  
NULL
;

420  &
ei
->
vfs_šode
;

421 
	}
}

423 
	$bdev_i_ÿÎback
(
rcu_h—d
 *
h—d
)

425 
šode
 *šodğ
	`cÚš”_of
(
h—d
, šode, 
i_rcu
);

426 
bdev_šode
 *
bdi
 = 
	`BDEV_I
(
šode
);

428 
	`INIT_LIST_HEAD
(&
šode
->
i_d’Œy
);

429 
	`kmem_ÿche_ä“
(
bdev_ÿch•
, 
bdi
);

430 
	}
}

432 
	$bdev_de¡roy_šode
(
šode
 *inode)

434 
	`ÿÎ_rcu
(&
šode
->
i_rcu
, 
bdev_i_ÿÎback
);

435 
	}
}

437 
	$š™_Úû
(*
foo
)

439 
bdev_šode
 *
ei
 = (bdev_šod*è
foo
;

440 
block_deviû
 *
bdev
 = &
ei
->bdev;

442 
	`mem£t
(
bdev
, 0, (*bdev));

443 
	`mu‹x_š™
(&
bdev
->
bd_mu‹x
);

444 
	`INIT_LIST_HEAD
(&
bdev
->
bd_šodes
);

445 
	`INIT_LIST_HEAD
(&
bdev
->
bd_li¡
);

446 #ifdeà
CONFIG_SYSFS


447 
	`INIT_LIST_HEAD
(&
bdev
->
bd_hŞd”_disks
);

449 
	`šode_š™_Úû
(&
ei
->
vfs_šode
);

451 
	`mu‹x_š™
(&
bdev
->
bd_fsä“ze_mu‹x
);

452 
	}
}

454 
šlše
 
	$__bd_fÜg‘
(
šode
 *inode)

456 
	`li¡_d–_š™
(&
šode
->
i_deviûs
);

457 
šode
->
i_bdev
 = 
NULL
;

458 
šode
->
i_m­pšg
 = &šode->
i_d©a
;

459 
	}
}

461 
	$bdev_eviù_šode
(
šode
 *inode)

463 
block_deviû
 *
bdev
 = &
	`BDEV_I
(
šode
)->bdev;

464 
li¡_h—d
 *
p
;

465 
	`Œunÿ‹_šode_·ges
(&
šode
->
i_d©a
, 0);

466 
	`šv®id©e_šode_bufãrs
(
šode
);

467 
	`’d_wr™eback
(
šode
);

468 
	`¥š_lock
(&
bdev_lock
);

469  (
p
 = 
bdev
->
bd_šodes
.
Ãxt
) != &bdev->bd_inodes ) {

470 
	`__bd_fÜg‘
(
	`li¡_’Œy
(
p
, 
šode
, 
i_deviûs
));

472 
	`li¡_d–_š™
(&
bdev
->
bd_li¡
);

473 
	`¥š_uÆock
(&
bdev_lock
);

474 
	}
}

476 cÚ¡ 
su³r_İ”©iÚs
 
	gbdev_sİs
 = {

477 .
¡©fs
 = 
sim¶e_¡©fs
,

478 .
	g®loc_šode
 = 
bdev_®loc_šode
,

479 .
	gde¡roy_šode
 = 
bdev_de¡roy_šode
,

480 .
	gdrİ_šode
 = 
g’”ic_d–‘e_šode
,

481 .
	geviù_šode
 = 
bdev_eviù_šode
,

484 
d’Œy
 *
	$bd_mouÁ
(
fe_sy¡em_ty³
 *
fs_ty³
,

485 
æags
, cÚ¡ *
dev_Çme
, *
d©a
)

487  
	`mouÁ_p£udo
(
fs_ty³
, "bdev:", &
bdev_sİs
, 
NULL
, 0x62646576);

488 
	}
}

490 
fe_sy¡em_ty³
 
	gbd_ty³
 = {

491 .
Çme
 = "bdev",

492 .
	gmouÁ
 = 
bd_mouÁ
,

493 .
	gkl_sb
 = 
kl_ªÚ_su³r
,

496 
su³r_block
 *
blockdev_su³rblock
 
	g__»ad_mo¡ly
;

498 
__š™
 
	$bdev_ÿche_š™
()

500 
”r
;

501 
vfsmouÁ
 *
bd_mÁ
;

503 
bdev_ÿch•
 = 
	`kmem_ÿche_ü—‹
("bdev_ÿche", (
bdev_šode
),

504 0, (
SLAB_HWCACHE_ALIGN
|
SLAB_RECLAIM_ACCOUNT
|

505 
SLAB_MEM_SPREAD
|
SLAB_PANIC
),

506 
š™_Úû
);

507 
”r
 = 
	`»gi¡”_fesy¡em
(&
bd_ty³
);

508 ià(
”r
)

509 
	`·nic
("Cannot„egister bdev…seudo-fs");

510 
bd_mÁ
 = 
	`k”n_mouÁ
(&
bd_ty³
);

511 ià(
	`IS_ERR
(
bd_mÁ
))

512 
	`·nic
("Cannot create bdev…seudo-fs");

517 
	`kmemËak_nÙ_Ëak
(
bd_mÁ
);

518 
blockdev_su³rblock
 = 
bd_mÁ
->
mÁ_sb
;

519 
	}
}

526 
šlše
 
	$hash
(
dev_t
 
dev
)

528  
	`MAJOR
(
dev
)+
	`MINOR
(dev);

529 
	}
}

531 
	$bdev_‹¡
(
šode
 *šode, *
d©a
)

533  
	`BDEV_I
(
šode
)->
bdev
.
bd_dev
 =ğ*(
dev_t
 *)
d©a
;

534 
	}
}

536 
	$bdev_£t
(
šode
 *šode, *
d©a
)

538 
	`BDEV_I
(
šode
)->
bdev
.
bd_dev
 = *(
dev_t
 *)
d©a
;

540 
	}
}

542 
LIST_HEAD
(
®l_bdevs
);

544 
block_deviû
 *
	$bdg‘
(
dev_t
 
dev
)

546 
block_deviû
 *
bdev
;

547 
šode
 *inode;

549 
šode
 = 
	`ig‘5_locked
(
blockdev_su³rblock
, 
	`hash
(
dev
),

550 
bdev_‹¡
, 
bdev_£t
, &
dev
);

552 ià(!
šode
)

553  
NULL
;

555 
bdev
 = &
	`BDEV_I
(
šode
)->bdev;

557 ià(
šode
->
i_¡©e
 & 
I_NEW
) {

558 
bdev
->
bd_cÚšs
 = 
NULL
;

559 
bdev
->
bd_su³r
 = 
NULL
;

560 
bdev
->
bd_šode
 = 
šode
;

561 
bdev
->
bd_block_size
 = (1 << 
šode
->
i_blkb™s
);

562 
bdev
->
bd_·¹_couÁ
 = 0;

563 
bdev
->
bd_šv®id©ed
 = 0;

564 
šode
->
i_mode
 = 
S_IFBLK
;

565 
šode
->
i_rdev
 = 
dev
;

566 
šode
->
i_bdev
 = 
bdev
;

567 
šode
->
i_d©a
.
a_İs
 = &
def_blk_aİs
;

568 
	`m­pšg_£t_gå_mask
(&
šode
->
i_d©a
, 
GFP_USER
);

569 
šode
->
i_d©a
.
backšg_dev_šfo
 = &
deçuÉ_backšg_dev_šfo
;

570 
	`¥š_lock
(&
bdev_lock
);

571 
	`li¡_add
(&
bdev
->
bd_li¡
, &
®l_bdevs
);

572 
	`¥š_uÆock
(&
bdev_lock
);

573 
	`uÆock_Ãw_šode
(
šode
);

575  
bdev
;

576 
	}
}

578 
EXPORT_SYMBOL
(
bdg‘
);

584 
block_deviû
 *
	$bdg¿b
(
block_deviû
 *
bdev
)

586 
	`ihŞd
(
bdev
->
bd_šode
);

587  
bdev
;

588 
	}
}

590 
	$Ä_blockdev_·ges
()

592 
block_deviû
 *
bdev
;

593 
»t
 = 0;

594 
	`¥š_lock
(&
bdev_lock
);

595 
	`li¡_fÜ_—ch_’Œy
(
bdev
, &
®l_bdevs
, 
bd_li¡
) {

596 
»t
 +ğ
bdev
->
bd_šode
->
i_m­pšg
->
Ä·ges
;

598 
	`¥š_uÆock
(&
bdev_lock
);

599  
»t
;

600 
	}
}

602 
	$bdput
(
block_deviû
 *
bdev
)

604 
	`ut
(
bdev
->
bd_šode
);

605 
	}
}

607 
EXPORT_SYMBOL
(
bdput
);

609 
block_deviû
 *
	$bd_acquœe
(
šode
 *inode)

611 
block_deviû
 *
bdev
;

613 
	`¥š_lock
(&
bdev_lock
);

614 
bdev
 = 
šode
->
i_bdev
;

615 ià(
bdev
) {

616 
	`ihŞd
(
bdev
->
bd_šode
);

617 
	`¥š_uÆock
(&
bdev_lock
);

618  
bdev
;

620 
	`¥š_uÆock
(&
bdev_lock
);

622 
bdev
 = 
	`bdg‘
(
šode
->
i_rdev
);

623 ià(
bdev
) {

624 
	`¥š_lock
(&
bdev_lock
);

625 ià(!
šode
->
i_bdev
) {

632 
	`ihŞd
(
bdev
->
bd_šode
);

633 
šode
->
i_bdev
 = 
bdev
;

634 
šode
->
i_m­pšg
 = 
bdev
->
bd_šode
->i_mapping;

635 
	`li¡_add
(&
šode
->
i_deviûs
, &
bdev
->
bd_šodes
);

637 
	`¥š_uÆock
(&
bdev_lock
);

639  
bdev
;

640 
	}
}

644 
	$bd_fÜg‘
(
šode
 *inode)

646 
block_deviû
 *
bdev
 = 
NULL
;

648 
	`¥š_lock
(&
bdev_lock
);

649 ià(
šode
->
i_bdev
) {

650 ià(!
	`sb_is_blkdev_sb
(
šode
->
i_sb
))

651 
bdev
 = 
šode
->
i_bdev
;

652 
	`__bd_fÜg‘
(
šode
);

654 
	`¥š_uÆock
(&
bdev_lock
);

656 ià(
bdev
)

657 
	`ut
(
bdev
->
bd_šode
);

658 
	}
}

674 
boŞ
 
	$bd_may_şaim
(
block_deviû
 *
bdev
, block_deviû *
whŞe
,

675 *
hŞd”
)

677 ià(
bdev
->
bd_hŞd”
 =ğ
hŞd”
)

678  
Œue
;

679 ià(
bdev
->
bd_hŞd”
 !ğ
NULL
)

680  
çl£
;

681 ià(
bdev
->
bd_cÚšs
 == bdev)

682  
Œue
;

684 ià(
whŞe
->
bd_hŞd”
 =ğ
bd_may_şaim
)

685  
Œue
;

686 ià(
whŞe
->
bd_hŞd”
 !ğ
NULL
)

687  
çl£
;

689  
Œue
;

690 
	}
}

710 
	$bd_´•¬e_to_şaim
(
block_deviû
 *
bdev
,

711 
block_deviû
 *
whŞe
, *
hŞd”
)

713 
»Œy
:

715 ià(!
	`bd_may_şaim
(
bdev
, 
whŞe
, 
hŞd”
))

716  -
EBUSY
;

719 ià(
whŞe
->
bd_şaimšg
) {

720 
wa™_queue_h—d_t
 *
wq
 = 
	`b™_wa™queue
(&
whŞe
->
bd_şaimšg
, 0);

721 
	`DEFINE_WAIT
(
wa™
);

723 
	`´•¬e_to_wa™
(
wq
, &
wa™
, 
TASK_UNINTERRUPTIBLE
);

724 
	`¥š_uÆock
(&
bdev_lock
);

725 
	`scheduË
();

726 
	`fšish_wa™
(
wq
, &
wa™
);

727 
	`¥š_lock
(&
bdev_lock
);

728 
»Œy
;

733 
	}
}

758 
block_deviû
 *
	$bd_¡¬t_şaimšg
(
block_deviû
 *
bdev
,

759 *
hŞd”
)

761 
g’disk
 *
disk
;

762 
block_deviû
 *
whŞe
;

763 
·¹no
, 
”r
;

765 
	`might_¦“p
();

771 
disk
 = 
	`g‘_g’disk
(
bdev
->
bd_dev
, &
·¹no
);

772 ià(!
disk
)

773  
	`ERR_PTR
(-
ENXIO
);

783 ià(
·¹no
)

784 
whŞe
 = 
	`bdg‘_disk
(
disk
, 0);

786 
whŞe
 = 
	`bdg¿b
(
bdev
);

788 
	`moduË_put
(
disk
->
fİs
->
owÃr
);

789 
	`put_disk
(
disk
);

790 ià(!
whŞe
)

791  
	`ERR_PTR
(-
ENOMEM
);

794 
	`¥š_lock
(&
bdev_lock
);

796 
”r
 = 
	`bd_´•¬e_to_şaim
(
bdev
, 
whŞe
, 
hŞd”
);

797 ià(
”r
 == 0) {

798 
whŞe
->
bd_şaimšg
 = 
hŞd”
;

799 
	`¥š_uÆock
(&
bdev_lock
);

800  
whŞe
;

802 
	`¥š_uÆock
(&
bdev_lock
);

803 
	`bdput
(
whŞe
);

804  
	`ERR_PTR
(
”r
);

806 
	}
}

808 #ifdeà
CONFIG_SYSFS


809 
	sbd_hŞd”_disk
 {

810 
li¡_h—d
 
	mli¡
;

811 
g’disk
 *
	mdisk
;

812 
	m»fút
;

815 
bd_hŞd”_disk
 *
	$bd_fšd_hŞd”_disk
(
block_deviû
 *
bdev
,

816 
g’disk
 *
disk
)

818 
bd_hŞd”_disk
 *
hŞd”
;

820 
	`li¡_fÜ_—ch_’Œy
(
hŞd”
, &
bdev
->
bd_hŞd”_disks
, 
li¡
)

821 ià(
hŞd”
->
disk
 == disk)

822  
hŞd”
;

823  
NULL
;

824 
	}
}

826 
	$add_symlšk
(
kobjeù
 *
äom
, kobjeù *
to
)

828  
	`sysfs_ü—‹_lšk
(
äom
, 
to
, 
	`kobjeù_Çme
(to));

829 
	}
}

831 
	$d–_symlšk
(
kobjeù
 *
äom
, kobjeù *
to
)

833 
	`sysfs_»move_lšk
(
äom
, 
	`kobjeù_Çme
(
to
));

834 
	}
}

864 
	$bd_lšk_disk_hŞd”
(
block_deviû
 *
bdev
, 
g’disk
 *
disk
)

866 
bd_hŞd”_disk
 *
hŞd”
;

867 
»t
 = 0;

869 
	`mu‹x_lock
(&
bdev
->
bd_mu‹x
);

871 
	`WARN_ON_ONCE
(!
bdev
->
bd_hŞd”
);

874 ià(
	`WARN_ON
(!
disk
->
¦ave_dœ
 || !
bdev
->
bd_·¹
->
hŞd”_dœ
))

875 
out_uÆock
;

877 
hŞd”
 = 
	`bd_fšd_hŞd”_disk
(
bdev
, 
disk
);

878 ià(
hŞd”
) {

879 
hŞd”
->
»fút
++;

880 
out_uÆock
;

883 
hŞd”
 = 
	`kz®loc
((*hŞd”), 
GFP_KERNEL
);

884 ià(!
hŞd”
) {

885 
»t
 = -
ENOMEM
;

886 
out_uÆock
;

889 
	`INIT_LIST_HEAD
(&
hŞd”
->
li¡
);

890 
hŞd”
->
disk
 = disk;

891 
hŞd”
->
»fút
 = 1;

893 
»t
 = 
	`add_symlšk
(
disk
->
¦ave_dœ
, &
	`·¹_to_dev
(
bdev
->
bd_·¹
)->
kobj
);

894 ià(
»t
)

895 
out_ä“
;

897 
»t
 = 
	`add_symlšk
(
bdev
->
bd_·¹
->
hŞd”_dœ
, &
	`disk_to_dev
(
disk
)->
kobj
);

898 ià(
»t
)

899 
out_d–
;

904 
	`kobjeù_g‘
(
bdev
->
bd_·¹
->
hŞd”_dœ
);

906 
	`li¡_add
(&
hŞd”
->
li¡
, &
bdev
->
bd_hŞd”_disks
);

907 
out_uÆock
;

909 
out_d–
:

910 
	`d–_symlšk
(
disk
->
¦ave_dœ
, &
	`·¹_to_dev
(
bdev
->
bd_·¹
)->
kobj
);

911 
out_ä“
:

912 
	`kä“
(
hŞd”
);

913 
out_uÆock
:

914 
	`mu‹x_uÆock
(&
bdev
->
bd_mu‹x
);

915  
»t
;

916 
	}
}

917 
EXPORT_SYMBOL_GPL
(
bd_lšk_disk_hŞd”
);

929 
	$bd_uÆšk_disk_hŞd”
(
block_deviû
 *
bdev
, 
g’disk
 *
disk
)

931 
bd_hŞd”_disk
 *
hŞd”
;

933 
	`mu‹x_lock
(&
bdev
->
bd_mu‹x
);

935 
hŞd”
 = 
	`bd_fšd_hŞd”_disk
(
bdev
, 
disk
);

937 ià(!
	`WARN_ON_ONCE
(
hŞd”
 =ğ
NULL
è&& !--hŞd”->
»fút
) {

938 
	`d–_symlšk
(
disk
->
¦ave_dœ
, &
	`·¹_to_dev
(
bdev
->
bd_·¹
)->
kobj
);

939 
	`d–_symlšk
(
bdev
->
bd_·¹
->
hŞd”_dœ
,

940 &
	`disk_to_dev
(
disk
)->
kobj
);

941 
	`kobjeù_put
(
bdev
->
bd_·¹
->
hŞd”_dœ
);

942 
	`li¡_d–_š™
(&
hŞd”
->
li¡
);

943 
	`kä“
(
hŞd”
);

946 
	`mu‹x_uÆock
(&
bdev
->
bd_mu‹x
);

947 
	}
}

948 
EXPORT_SYMBOL_GPL
(
bd_uÆšk_disk_hŞd”
);

961 
	$æush_disk
(
block_deviû
 *
bdev
, 
boŞ
 
kl_dœty
)

963 ià(
	`__šv®id©e_deviû
(
bdev
, 
kl_dœty
)) {

964 
Çme
[
BDEVNAME_SIZE
] = "";

966 ià(
bdev
->
bd_disk
)

967 
	`disk_Çme
(
bdev
->
bd_disk
, 0, 
Çme
);

968 
	`´štk
(
KERN_WARNING
 "VFS: busy inodes on changed media or "

969 "»sized disk %s\n", 
Çme
);

972 ià(!
bdev
->
bd_disk
)

974 ià(
	`disk_·¹_sÿn_’abËd
(
bdev
->
bd_disk
))

975 
bdev
->
bd_šv®id©ed
 = 1;

976 
	}
}

986 
	$check_disk_size_chªge
(
g’disk
 *
disk
, 
block_deviû
 *
bdev
)

988 
loff_t
 
disk_size
, 
bdev_size
;

990 
disk_size
 = (
loff_t
)
	`g‘_ÿ·c™y
(
disk
) << 9;

991 
bdev_size
 = 
	`i_size_»ad
(
bdev
->
bd_šode
);

992 ià(
disk_size
 !ğ
bdev_size
) {

993 
Çme
[
BDEVNAME_SIZE
];

995 
	`disk_Çme
(
disk
, 0, 
Çme
);

996 
	`´štk
(
KERN_INFO


998 
Çme
, 
bdev_size
, 
disk_size
);

999 
	`i_size_wr™e
(
bdev
->
bd_šode
, 
disk_size
);

1000 
	`æush_disk
(
bdev
, 
çl£
);

1002 
	}
}

1003 
EXPORT_SYMBOL
(
check_disk_size_chªge
);

1013 
	$»v®id©e_disk
(
g’disk
 *
disk
)

1015 
block_deviû
 *
bdev
;

1016 
»t
 = 0;

1018 ià(
disk
->
fİs
->
»v®id©e_disk
)

1019 
»t
 = 
disk
->
fİs
->
	`»v®id©e_disk
(disk);

1021 
bdev
 = 
	`bdg‘_disk
(
disk
, 0);

1022 ià(!
bdev
)

1023  
»t
;

1025 
	`mu‹x_lock
(&
bdev
->
bd_mu‹x
);

1026 
	`check_disk_size_chªge
(
disk
, 
bdev
);

1027 
	`mu‹x_uÆock
(&
bdev
->
bd_mu‹x
);

1028 
	`bdput
(
bdev
);

1029  
»t
;

1030 
	}
}

1031 
EXPORT_SYMBOL
(
»v®id©e_disk
);

1042 
	$check_disk_chªge
(
block_deviû
 *
bdev
)

1044 
g’disk
 *
disk
 = 
bdev
->
bd_disk
;

1045 cÚ¡ 
block_deviû_İ”©iÚs
 *
bdİs
 = 
disk
->
fİs
;

1046 
ev’ts
;

1048 
ev’ts
 = 
	`disk_ş—r_ev’ts
(
disk
, 
DISK_EVENT_MEDIA_CHANGE
 |

1049 
DISK_EVENT_EJECT_REQUEST
);

1050 ià(!(
ev’ts
 & 
DISK_EVENT_MEDIA_CHANGE
))

1053 
	`æush_disk
(
bdev
, 
Œue
);

1054 ià(
bdİs
->
»v®id©e_disk
)

1055 
bdİs
->
	`»v®id©e_disk
(
bdev
->
bd_disk
);

1057 
	}
}

1059 
EXPORT_SYMBOL
(
check_disk_chªge
);

1061 
	$bd_£t_size
(
block_deviû
 *
bdev
, 
loff_t
 
size
)

1063 
bsize
 = 
	`bdev_logiÿl_block_size
(
bdev
);

1065 
bdev
->
bd_šode
->
i_size
 = 
size
;

1066 
bsize
 < 
PAGE_CACHE_SIZE
) {

1067 ià(
size
 & 
bsize
)

1069 
bsize
 <<= 1;

1071 
bdev
->
bd_block_size
 = 
bsize
;

1072 
bdev
->
bd_šode
->
i_blkb™s
 = 
	`blksize_b™s
(
bsize
);

1073 
	}
}

1074 
EXPORT_SYMBOL
(
bd_£t_size
);

1076 
__blkdev_put
(
block_deviû
 *
bdev
, 
fmode_t
 
mode
, 
fÜ_·¹
);

1085 
	$__blkdev_g‘
(
block_deviû
 *
bdev
, 
fmode_t
 
mode
, 
fÜ_·¹
)

1087 
g’disk
 *
disk
;

1088 
moduË
 *
owÃr
;

1089 
»t
;

1090 
·¹no
;

1091 
³rm
 = 0;

1093 ià(
mode
 & 
FMODE_READ
)

1094 
³rm
 |ğ
MAY_READ
;

1095 ià(
mode
 & 
FMODE_WRITE
)

1096 
³rm
 |ğ
MAY_WRITE
;

1100 ià(!
fÜ_·¹
) {

1101 
»t
 = 
	`devcgroup_šode_³rmissiÚ
(
bdev
->
bd_šode
, 
³rm
);

1102 ià(
»t
 != 0) {

1103 
	`bdput
(
bdev
);

1104  
»t
;

1108 
»¡¬t
:

1110 
»t
 = -
ENXIO
;

1111 
disk
 = 
	`g‘_g’disk
(
bdev
->
bd_dev
, &
·¹no
);

1112 ià(!
disk
)

1113 
out
;

1114 
owÃr
 = 
disk
->
fİs
->owner;

1116 
	`disk_block_ev’ts
(
disk
);

1117 
	`mu‹x_lock_Ã¡ed
(&
bdev
->
bd_mu‹x
, 
fÜ_·¹
);

1118 ià(!
bdev
->
bd_İ’”s
) {

1119 
bdev
->
bd_disk
 = 
disk
;

1120 
bdev
->
bd_cÚšs
 = bdev;

1121 ià(!
·¹no
) {

1122 
backšg_dev_šfo
 *
bdi
;

1124 
»t
 = -
ENXIO
;

1125 
bdev
->
bd_·¹
 = 
	`disk_g‘_·¹
(
disk
, 
·¹no
);

1126 ià(!
bdev
->
bd_·¹
)

1127 
out_ş—r
;

1129 
»t
 = 0;

1130 ià(
disk
->
fİs
->
İ’
) {

1131 
»t
 = 
disk
->
fİs
->
	`İ’
(
bdev
, 
mode
);

1132 ià(
»t
 =ğ-
ERESTARTSYS
) {

1137 
	`disk_put_·¹
(
bdev
->
bd_·¹
);

1138 
bdev
->
bd_·¹
 = 
NULL
;

1139 
bdev
->
bd_disk
 = 
NULL
;

1140 
	`mu‹x_uÆock
(&
bdev
->
bd_mu‹x
);

1141 
	`disk_unblock_ev’ts
(
disk
);

1142 
	`put_disk
(
disk
);

1143 
	`moduË_put
(
owÃr
);

1144 
»¡¬t
;

1148 ià(!
»t
 && !
bdev
->
bd_İ’”s
) {

1149 
	`bd_£t_size
(
bdev
,(
loff_t
)
	`g‘_ÿ·c™y
(
disk
)<<9);

1150 
bdi
 = 
	`blk_g‘_backšg_dev_šfo
(
bdev
);

1151 ià(
bdi
 =ğ
NULL
)

1152 
bdi
 = &
deçuÉ_backšg_dev_šfo
;

1153 
	`bdev_šode_sw™ch_bdi
(
bdev
->
bd_šode
, 
bdi
);

1162 ià(
bdev
->
bd_šv®id©ed
 && (!
»t
 ||„‘ =ğ-
ENOMEDIUM
))

1163 
	`»sÿn_·¹™iÚs
(
disk
, 
bdev
);

1164 ià(
»t
)

1165 
out_ş—r
;

1167 
block_deviû
 *
whŞe
;

1168 
whŞe
 = 
	`bdg‘_disk
(
disk
, 0);

1169 
»t
 = -
ENOMEM
;

1170 ià(!
whŞe
)

1171 
out_ş—r
;

1172 
	`BUG_ON
(
fÜ_·¹
);

1173 
»t
 = 
	`__blkdev_g‘
(
whŞe
, 
mode
, 1);

1174 ià(
»t
)

1175 
out_ş—r
;

1176 
bdev
->
bd_cÚšs
 = 
whŞe
;

1177 
	`bdev_šode_sw™ch_bdi
(
bdev
->
bd_šode
,

1178 
whŞe
->
bd_šode
->
i_d©a
.
backšg_dev_šfo
);

1179 
bdev
->
bd_·¹
 = 
	`disk_g‘_·¹
(
disk
, 
·¹no
);

1180 ià(!(
disk
->
æags
 & 
GENHD_FL_UP
) ||

1181 !
bdev
->
bd_·¹
 || !bdev->bd_·¹->
Ä_£ùs
) {

1182 
»t
 = -
ENXIO
;

1183 
out_ş—r
;

1185 
	`bd_£t_size
(
bdev
, (
loff_t
)bdev->
bd_·¹
->
Ä_£ùs
 << 9);

1188 ià(
bdev
->
bd_cÚšs
 == bdev) {

1189 
»t
 = 0;

1190 ià(
bdev
->
bd_disk
->
fİs
->
İ’
)

1191 
»t
 = 
bdev
->
bd_disk
->
fİs
->
	`İ’
(bdev, 
mode
);

1193 ià(
bdev
->
bd_šv®id©ed
 && (!
»t
 ||„‘ =ğ-
ENOMEDIUM
))

1194 
	`»sÿn_·¹™iÚs
(
bdev
->
bd_disk
, bdev);

1195 ià(
»t
)

1196 
out_uÆock_bdev
;

1199 
	`put_disk
(
disk
);

1200 
	`moduË_put
(
owÃr
);

1202 
bdev
->
bd_İ’”s
++;

1203 ià(
fÜ_·¹
)

1204 
bdev
->
bd_·¹_couÁ
++;

1205 
	`mu‹x_uÆock
(&
bdev
->
bd_mu‹x
);

1206 
	`disk_unblock_ev’ts
(
disk
);

1209 
out_ş—r
:

1210 
	`disk_put_·¹
(
bdev
->
bd_·¹
);

1211 
bdev
->
bd_disk
 = 
NULL
;

1212 
bdev
->
bd_·¹
 = 
NULL
;

1213 
	`bdev_šode_sw™ch_bdi
(
bdev
->
bd_šode
, &
deçuÉ_backšg_dev_šfo
);

1214 ià(
bdev
 !ğbdev->
bd_cÚšs
)

1215 
	`__blkdev_put
(
bdev
->
bd_cÚšs
, 
mode
, 1);

1216 
bdev
->
bd_cÚšs
 = 
NULL
;

1217 
out_uÆock_bdev
:

1218 
	`mu‹x_uÆock
(&
bdev
->
bd_mu‹x
);

1219 
	`disk_unblock_ev’ts
(
disk
);

1220 
	`put_disk
(
disk
);

1221 
	`moduË_put
(
owÃr
);

1222 
out
:

1223 
	`bdput
(
bdev
);

1225  
»t
;

1226 
	}
}

1247 
	$blkdev_g‘
(
block_deviû
 *
bdev
, 
fmode_t
 
mode
, *
hŞd”
)

1249 
block_deviû
 *
whŞe
 = 
NULL
;

1250 
»s
;

1252 
	`WARN_ON_ONCE
((
mode
 & 
FMODE_EXCL
è&& !
hŞd”
);

1254 ià((
mode
 & 
FMODE_EXCL
è&& 
hŞd”
) {

1255 
whŞe
 = 
	`bd_¡¬t_şaimšg
(
bdev
, 
hŞd”
);

1256 ià(
	`IS_ERR
(
whŞe
)) {

1257 
	`bdput
(
bdev
);

1258  
	`PTR_ERR
(
whŞe
);

1262 
»s
 = 
	`__blkdev_g‘
(
bdev
, 
mode
, 0);

1264 ià(
whŞe
) {

1265 
g’disk
 *
disk
 = 
whŞe
->
bd_disk
;

1268 
	`mu‹x_lock
(&
bdev
->
bd_mu‹x
);

1269 
	`¥š_lock
(&
bdev_lock
);

1271 ià(!
»s
) {

1272 
	`BUG_ON
(!
	`bd_may_şaim
(
bdev
, 
whŞe
, 
hŞd”
));

1279 
whŞe
->
bd_hŞd”s
++;

1280 
whŞe
->
bd_hŞd”
 = 
bd_may_şaim
;

1281 
bdev
->
bd_hŞd”s
++;

1282 
bdev
->
bd_hŞd”
 = 
hŞd”
;

1286 
	`BUG_ON
(
whŞe
->
bd_şaimšg
 !ğ
hŞd”
);

1287 
whŞe
->
bd_şaimšg
 = 
NULL
;

1288 
	`wake_up_b™
(&
whŞe
->
bd_şaimšg
, 0);

1290 
	`¥š_uÆock
(&
bdev_lock
);

1299 ià(!
»s
 && (
mode
 & 
FMODE_WRITE
è&& !
bdev
->
bd_wr™e_hŞd”
 &&

1300 (
disk
->
æags
 & 
GENHD_FL_BLOCK_EVENTS_ON_EXCL_WRITE
)) {

1301 
bdev
->
bd_wr™e_hŞd”
 = 
Œue
;

1302 
	`disk_block_ev’ts
(
disk
);

1305 
	`mu‹x_uÆock
(&
bdev
->
bd_mu‹x
);

1306 
	`bdput
(
whŞe
);

1309  
»s
;

1310 
	}
}

1311 
EXPORT_SYMBOL
(
blkdev_g‘
);

1330 
block_deviû
 *
	$blkdev_g‘_by_·th
(cÚ¡ *
·th
, 
fmode_t
 
mode
,

1331 *
hŞd”
)

1333 
block_deviû
 *
bdev
;

1334 
”r
;

1336 
bdev
 = 
	`lookup_bdev
(
·th
);

1337 ià(
	`IS_ERR
(
bdev
))

1338  
bdev
;

1340 
”r
 = 
	`blkdev_g‘
(
bdev
, 
mode
, 
hŞd”
);

1341 ià(
”r
)

1342  
	`ERR_PTR
(
”r
);

1344 ià((
mode
 & 
FMODE_WRITE
è&& 
	`bdev_»ad_Úly
(
bdev
)) {

1345 
	`blkdev_put
(
bdev
, 
mode
);

1346  
	`ERR_PTR
(-
EACCES
);

1349  
bdev
;

1350 
	}
}

1351 
EXPORT_SYMBOL
(
blkdev_g‘_by_·th
);

1375 
block_deviû
 *
	$blkdev_g‘_by_dev
(
dev_t
 
dev
, 
fmode_t
 
mode
, *
hŞd”
)

1377 
block_deviû
 *
bdev
;

1378 
”r
;

1380 
bdev
 = 
	`bdg‘
(
dev
);

1381 ià(!
bdev
)

1382  
	`ERR_PTR
(-
ENOMEM
);

1384 
”r
 = 
	`blkdev_g‘
(
bdev
, 
mode
, 
hŞd”
);

1385 ià(
”r
)

1386  
	`ERR_PTR
(
”r
);

1388  
bdev
;

1389 
	}
}

1390 
EXPORT_SYMBOL
(
blkdev_g‘_by_dev
);

1392 
	$blkdev_İ’
(
šode
 * inode, 
fe
 * 
fp
)

1394 
block_deviû
 *
bdev
;

1402 
fp
->
f_æags
 |ğ
O_LARGEFILE
;

1404 ià(
fp
->
f_æags
 & 
O_NDELAY
)

1405 
fp
->
f_mode
 |ğ
FMODE_NDELAY
;

1406 ià(
fp
->
f_æags
 & 
O_EXCL
)

1407 
fp
->
f_mode
 |ğ
FMODE_EXCL
;

1408 ià((
fp
->
f_æags
 & 
O_ACCMODE
) == 3)

1409 
fp
->
f_mode
 |ğ
FMODE_WRITE_IOCTL
;

1411 
bdev
 = 
	`bd_acquœe
(
šode
);

1412 ià(
bdev
 =ğ
NULL
)

1413  -
ENOMEM
;

1415 
fp
->
f_m­pšg
 = 
bdev
->
bd_šode
->
i_m­pšg
;

1417  
	`blkdev_g‘
(
bdev
, 
fp
->
f_mode
, filp);

1418 
	}
}

1420 
	$__blkdev_put
(
block_deviû
 *
bdev
, 
fmode_t
 
mode
, 
fÜ_·¹
)

1422 
»t
 = 0;

1423 
g’disk
 *
disk
 = 
bdev
->
bd_disk
;

1424 
block_deviû
 *
viùim
 = 
NULL
;

1426 
	`mu‹x_lock_Ã¡ed
(&
bdev
->
bd_mu‹x
, 
fÜ_·¹
);

1427 ià(
fÜ_·¹
)

1428 
bdev
->
bd_·¹_couÁ
--;

1430 ià(!--
bdev
->
bd_İ’”s
) {

1431 
	`WARN_ON_ONCE
(
bdev
->
bd_hŞd”s
);

1432 
	`sync_blockdev
(
bdev
);

1433 
	`kl_bdev
(
bdev
);

1437 
	`bdev_šode_sw™ch_bdi
(
bdev
->
bd_šode
,

1438 &
deçuÉ_backšg_dev_šfo
);

1440 ià(
bdev
->
bd_cÚšs
 == bdev) {

1441 ià(
disk
->
fİs
->
»Ëa£
)

1442 
»t
 = 
disk
->
fİs
->
	`»Ëa£
(disk, 
mode
);

1444 ià(!
bdev
->
bd_İ’”s
) {

1445 
moduË
 *
owÃr
 = 
disk
->
fİs
->owner;

1447 
	`disk_put_·¹
(
bdev
->
bd_·¹
);

1448 
bdev
->
bd_·¹
 = 
NULL
;

1449 
bdev
->
bd_disk
 = 
NULL
;

1450 ià(
bdev
 !ğbdev->
bd_cÚšs
)

1451 
viùim
 = 
bdev
->
bd_cÚšs
;

1452 
bdev
->
bd_cÚšs
 = 
NULL
;

1454 
	`put_disk
(
disk
);

1455 
	`moduË_put
(
owÃr
);

1457 
	`mu‹x_uÆock
(&
bdev
->
bd_mu‹x
);

1458 
	`bdput
(
bdev
);

1459 ià(
viùim
)

1460 
	`__blkdev_put
(
viùim
, 
mode
, 1);

1461  
»t
;

1462 
	}
}

1464 
	$blkdev_put
(
block_deviû
 *
bdev
, 
fmode_t
 
mode
)

1466 
	`mu‹x_lock
(&
bdev
->
bd_mu‹x
);

1468 ià(
mode
 & 
FMODE_EXCL
) {

1469 
boŞ
 
bdev_ä“
;

1476 
	`¥š_lock
(&
bdev_lock
);

1478 
	`WARN_ON_ONCE
(--
bdev
->
bd_hŞd”s
 < 0);

1479 
	`WARN_ON_ONCE
(--
bdev
->
bd_cÚšs
->
bd_hŞd”s
 < 0);

1482 ià((
bdev_ä“
 = !
bdev
->
bd_hŞd”s
))

1483 
bdev
->
bd_hŞd”
 = 
NULL
;

1484 ià(!
bdev
->
bd_cÚšs
->
bd_hŞd”s
)

1485 
bdev
->
bd_cÚšs
->
bd_hŞd”
 = 
NULL
;

1487 
	`¥š_uÆock
(&
bdev_lock
);

1493 ià(
bdev_ä“
 && 
bdev
->
bd_wr™e_hŞd”
) {

1494 
	`disk_unblock_ev’ts
(
bdev
->
bd_disk
);

1495 
bdev
->
bd_wr™e_hŞd”
 = 
çl£
;

1504 
	`disk_æush_ev’ts
(
bdev
->
bd_disk
, 
DISK_EVENT_MEDIA_CHANGE
);

1506 
	`mu‹x_uÆock
(&
bdev
->
bd_mu‹x
);

1508  
	`__blkdev_put
(
bdev
, 
mode
, 0);

1509 
	}
}

1510 
EXPORT_SYMBOL
(
blkdev_put
);

1512 
	$blkdev_şo£
(
šode
 * inode, 
fe
 * 
fp
)

1514 
block_deviû
 *
bdev
 = 
	`I_BDEV
(
fp
->
f_m­pšg
->
ho¡
);

1516  
	`blkdev_put
(
bdev
, 
fp
->
f_mode
);

1517 
	}
}

1519 
	$block_ioùl
(
fe
 *fe, 
cmd
, 
¬g
)

1521 
block_deviû
 *
bdev
 = 
	`I_BDEV
(
fe
->
f_m­pšg
->
ho¡
);

1522 
fmode_t
 
mode
 = 
fe
->
f_mode
;

1528 ià(
fe
->
f_æags
 & 
O_NDELAY
)

1529 
mode
 |ğ
FMODE_NDELAY
;

1531 
mode
 &ğ~
FMODE_NDELAY
;

1533  
	`blkdev_ioùl
(
bdev
, 
mode
, 
cmd
, 
¬g
);

1534 
	}
}

1543 
ssize_t
 
	$blkdev_aio_wr™e
(
kiocb
 *
iocb
, cÚ¡ 
iovec
 *
iov
,

1544 
Ä_£gs
, 
loff_t
 
pos
)

1546 
fe
 *fğ
iocb
->
ki_fp
;

1547 
ssize_t
 
»t
;

1549 
	`BUG_ON
(
iocb
->
ki_pos
 !ğ
pos
);

1551 
»t
 = 
	`__g’”ic_fe_aio_wr™e
(
iocb
, 
iov
, 
Ä_£gs
, &iocb->
ki_pos
);

1552 ià(
»t
 > 0 ||„‘ =ğ-
EIOCBQUEUED
) {

1553 
ssize_t
 
”r
;

1555 
”r
 = 
	`g’”ic_wr™e_sync
(
fe
, 
pos
, 
»t
);

1556 ià(
”r
 < 0 && 
»t
 > 0)

1557 
»t
 = 
”r
;

1559  
»t
;

1560 
	}
}

1561 
EXPORT_SYMBOL_GPL
(
blkdev_aio_wr™e
);

1567 
	$blkdev_»Ëa£·ge
(
·ge
 *·ge, 
gå_t
 
wa™
)

1569 
su³r_block
 *
su³r
 = 
	`BDEV_I
(
·ge
->
m­pšg
->
ho¡
)->
bdev
.
bd_su³r
;

1571 ià(
su³r
 && su³r->
s_İ
->
bdev_Œy_to_ä“_·ge
)

1572  
su³r
->
s_İ
->
	`bdev_Œy_to_ä“_·ge
(su³r, 
·ge
, 
wa™
);

1574  
	`Œy_to_ä“_bufãrs
(
·ge
);

1575 
	}
}

1577 cÚ¡ 
add»ss_¥aû_İ”©iÚs
 
	gdef_blk_aİs
 = {

1578 .
»ad·ge
 = 
blkdev_»ad·ge
,

1579 .
	gwr™•age
 = 
blkdev_wr™•age
,

1580 .
	gwr™e_begš
 = 
blkdev_wr™e_begš
,

1581 .
	gwr™e_’d
 = 
blkdev_wr™e_’d
,

1582 .
	gwr™•ages
 = 
g’”ic_wr™•ages
,

1583 .
	g»Ëa£·ge
 = 
blkdev_»Ëa£·ge
,

1584 .
	gdœeù_IO
 = 
blkdev_dœeù_IO
,

1587 cÚ¡ 
fe_İ”©iÚs
 
	gdef_blk_fİs
 = {

1588 .
İ’
 = 
blkdev_İ’
,

1589 .
	g»Ëa£
 = 
blkdev_şo£
,

1590 .
	gÎ£ek
 = 
block_Î£ek
,

1591 .
	g»ad
 = 
do_sync_»ad
,

1592 .
	gwr™e
 = 
do_sync_wr™e
,

1593 .
	gaio_»ad
 = 
g’”ic_fe_aio_»ad
,

1594 .
	gaio_wr™e
 = 
blkdev_aio_wr™e
,

1595 .
	gmm­
 = 
g’”ic_fe_mm­
,

1596 .
	gfsync
 = 
blkdev_fsync
,

1597 .
	guÆocked_ioùl
 = 
block_ioùl
,

1598 #ifdeà
CONFIG_COMPAT


1599 .
	gcom·t_ioùl
 = 
com·t_blkdev_ioùl
,

1601 .
	g¥liû_»ad
 = 
g’”ic_fe_¥liû_»ad
,

1602 .
	g¥liû_wr™e
 = 
g’”ic_fe_¥liû_wr™e
,

1605 
	$ioùl_by_bdev
(
block_deviû
 *
bdev
, 
cmd
, 
¬g
)

1607 
»s
;

1608 
mm_£gm’t_t
 
Şd_fs
 = 
	`g‘_fs
();

1609 
	`£t_fs
(
KERNEL_DS
);

1610 
»s
 = 
	`blkdev_ioùl
(
bdev
, 0, 
cmd
, 
¬g
);

1611 
	`£t_fs
(
Şd_fs
);

1612  
»s
;

1613 
	}
}

1615 
EXPORT_SYMBOL
(
ioùl_by_bdev
);

1625 
block_deviû
 *
	$lookup_bdev
(cÚ¡ *
·thÇme
)

1627 
block_deviû
 *
bdev
;

1628 
šode
 *inode;

1629 
·th
…ath;

1630 
”rÜ
;

1632 ià(!
·thÇme
 || !*pathname)

1633  
	`ERR_PTR
(-
EINVAL
);

1635 
”rÜ
 = 
	`k”n_·th
(
·thÇme
, 
LOOKUP_FOLLOW
, &
·th
);

1636 ià(
”rÜ
)

1637  
	`ERR_PTR
(
”rÜ
);

1639 
šode
 = 
·th
.
d’Œy
->
d_šode
;

1640 
”rÜ
 = -
ENOTBLK
;

1641 ià(!
	`S_ISBLK
(
šode
->
i_mode
))

1642 
ç
;

1643 
”rÜ
 = -
EACCES
;

1644 ià(
·th
.
mÁ
->
mÁ_æags
 & 
MNT_NODEV
)

1645 
ç
;

1646 
”rÜ
 = -
ENOMEM
;

1647 
bdev
 = 
	`bd_acquœe
(
šode
);

1648 ià(!
bdev
)

1649 
ç
;

1650 
out
:

1651 
	`·th_put
(&
·th
);

1652  
bdev
;

1653 
ç
:

1654 
bdev
 = 
	`ERR_PTR
(
”rÜ
);

1655 
out
;

1656 
	}
}

1657 
EXPORT_SYMBOL
(
lookup_bdev
);

1659 
	$__šv®id©e_deviû
(
block_deviû
 *
bdev
, 
boŞ
 
kl_dœty
)

1661 
su³r_block
 *
sb
 = 
	`g‘_su³r
(
bdev
);

1662 
»s
 = 0;

1664 ià(
sb
) {

1671 
	`shršk_dÿche_sb
(
sb
);

1672 
»s
 = 
	`šv®id©e_šodes
(
sb
, 
kl_dœty
);

1673 
	`drİ_su³r
(
sb
);

1675 
	`šv®id©e_bdev
(
bdev
);

1676  
»s
;

1677 
	}
}

1678 
EXPORT_SYMBOL
(
__šv®id©e_deviû
);

	@buffer.c

21 
	~<lšux/k”Ãl.h
>

22 
	~<lšux/sysÿÎs.h
>

23 
	~<lšux/fs.h
>

24 
	~<lšux/mm.h
>

25 
	~<lšux/³rıu.h
>

26 
	~<lšux/¦ab.h
>

27 
	~<lšux/ÿ·b™y.h
>

28 
	~<lšux/blkdev.h
>

29 
	~<lšux/fe.h
>

30 
	~<lšux/quÙaİs.h
>

31 
	~<lšux/highmem.h
>

32 
	~<lšux/moduË.h
>

33 
	~<lšux/wr™eback.h
>

34 
	~<lšux/hash.h
>

35 
	~<lšux/su¥’d.h
>

36 
	~<lšux/bufãr_h—d.h
>

37 
	~<lšux/sk_io_accouÁšg_İs.h
>

38 
	~<lšux/bio.h
>

39 
	~<lšux/nÙif›r.h
>

40 
	~<lšux/ıu.h
>

41 
	~<lšux/b™İs.h
>

42 
	~<lšux/m·ge.h
>

43 
	~<lšux/b™_¥šlock.h
>

44 
	~<lšux/ş—nÿche.h
>

46 
fsync_bufãrs_li¡
(
¥šlock_t
 *
lock
, 
li¡_h—d
 *
li¡
);

48 
	#BH_ENTRY
(
li¡
è
	`li¡_’Œy
(Öi¡), 
bufãr_h—d
, 
b_assoc_bufãrs
)

	)

50 
šlše
 

51 
	$š™_bufãr
(
bufãr_h—d
 *
bh
, 
bh_’d_io_t
 *
hªdËr
, *
´iv©e
)

53 
bh
->
b_’d_io
 = 
hªdËr
;

54 
bh
->
b_´iv©e
 = 
´iv©e
;

55 
	}
}

56 
EXPORT_SYMBOL
(
š™_bufãr
);

58 
	$¦“p_Ú_bufãr
(*
wÜd
)

60 
	`io_scheduË
();

62 
	}
}

64 
	$__lock_bufãr
(
bufãr_h—d
 *
bh
)

66 
	`wa™_Ú_b™_lock
(&
bh
->
b_¡©e
, 
BH_Lock
, 
¦“p_Ú_bufãr
,

67 
TASK_UNINTERRUPTIBLE
);

68 
	}
}

69 
EXPORT_SYMBOL
(
__lock_bufãr
);

71 
	$uÆock_bufãr
(
bufãr_h—d
 *
bh
)

73 
	`ş—r_b™_uÆock
(
BH_Lock
, &
bh
->
b_¡©e
);

74 
	`smp_mb__aá”_ş—r_b™
();

75 
	`wake_up_b™
(&
bh
->
b_¡©e
, 
BH_Lock
);

76 
	}
}

77 
EXPORT_SYMBOL
(
uÆock_bufãr
);

84 
	$__wa™_Ú_bufãr
(
bufãr_h—d
 * 
bh
)

86 
	`wa™_Ú_b™
(&
bh
->
b_¡©e
, 
BH_Lock
, 
¦“p_Ú_bufãr
, 
TASK_UNINTERRUPTIBLE
);

87 
	}
}

88 
EXPORT_SYMBOL
(
__wa™_Ú_bufãr
);

91 
	$__ş—r_·ge_bufãrs
(
·ge
 *page)

93 
	`CË¬PagePriv©e
(
·ge
);

94 
	`£t_·ge_´iv©e
(
·ge
, 0);

95 
	`·ge_ÿche_»Ëa£
(
·ge
);

96 
	}
}

99 
	$qu›t_”rÜ
(
bufãr_h—d
 *
bh
)

101 ià(!
	`‹¡_b™
(
BH_Qu›t
, &
bh
->
b_¡©e
è&& 
	`´štk_¿‹lim™
())

104 
	}
}

107 
	$bufãr_io_”rÜ
(
bufãr_h—d
 *
bh
)

109 
b
[
BDEVNAME_SIZE
];

110 
	`´štk
(
KERN_ERR
 "Buffer I/Oƒrror on device %s,†ogical block %Lu\n",

111 
	`bdevÇme
(
bh
->
b_bdev
, 
b
),

112 ()
bh
->
b_blockÄ
);

113 
	}
}

123 
	$__’d_bufãr_»ad_nÙouch
(
bufãr_h—d
 *
bh
, 
u±od©e
)

125 ià(
u±od©e
) {

126 
	`£t_bufãr_u±od©e
(
bh
);

129 
	`ş—r_bufãr_u±od©e
(
bh
);

131 
	`uÆock_bufãr
(
bh
);

132 
	}
}

138 
	$’d_bufãr_»ad_sync
(
bufãr_h—d
 *
bh
, 
u±od©e
)

140 
	`__’d_bufãr_»ad_nÙouch
(
bh
, 
u±od©e
);

141 
	`put_bh
(
bh
);

142 
	}
}

143 
EXPORT_SYMBOL
(
’d_bufãr_»ad_sync
);

145 
	$’d_bufãr_wr™e_sync
(
bufãr_h—d
 *
bh
, 
u±od©e
)

147 
b
[
BDEVNAME_SIZE
];

149 ià(
u±od©e
) {

150 
	`£t_bufãr_u±od©e
(
bh
);

152 ià(!
	`qu›t_”rÜ
(
bh
)) {

153 
	`bufãr_io_”rÜ
(
bh
);

154 
	`´štk
(
KERN_WARNING
 "lost…age write dueo "

156 
	`bdevÇme
(
bh
->
b_bdev
, 
b
));

158 
	`£t_bufãr_wr™e_io_”rÜ
(
bh
);

159 
	`ş—r_bufãr_u±od©e
(
bh
);

161 
	`uÆock_bufãr
(
bh
);

162 
	`put_bh
(
bh
);

163 
	}
}

164 
EXPORT_SYMBOL
(
’d_bufãr_wr™e_sync
);

177 
bufãr_h—d
 *

178 
	$__fšd_g‘_block_¦ow
(
block_deviû
 *
bdev
, 
£ùÜ_t
 
block
)

180 
šode
 *
bd_šode
 = 
bdev
->bd_inode;

181 
add»ss_¥aû
 *
bd_m­pšg
 = 
bd_šode
->
i_m­pšg
;

182 
bufãr_h—d
 *
»t
 = 
NULL
;

183 
pgoff_t
 
šdex
;

184 
bufãr_h—d
 *
bh
;

185 
bufãr_h—d
 *
h—d
;

186 
·ge
 *page;

187 
®l_m­³d
 = 1;

189 
šdex
 = 
block
 >> (
PAGE_CACHE_SHIFT
 - 
bd_šode
->
i_blkb™s
);

190 
·ge
 = 
	`fšd_g‘_·ge
(
bd_m­pšg
, 
šdex
);

191 ià(!
·ge
)

192 
out
;

194 
	`¥š_lock
(&
bd_m­pšg
->
´iv©e_lock
);

195 ià(!
	`·ge_has_bufãrs
(
·ge
))

196 
out_uÆock
;

197 
h—d
 = 
	`·ge_bufãrs
(
·ge
);

198 
bh
 = 
h—d
;

200 ià(!
	`bufãr_m­³d
(
bh
))

201 
®l_m­³d
 = 0;

202 ià(
bh
->
b_blockÄ
 =ğ
block
) {

203 
»t
 = 
bh
;

204 
	`g‘_bh
(
bh
);

205 
out_uÆock
;

207 
bh
 = bh->
b_this_·ge
;

208 } 
bh
 !ğ
h—d
);

215 ià(
®l_m­³d
) {

216 
b
[
BDEVNAME_SIZE
];

218 
	`´štk
("__find_get_block_slow() failed. "

220 ()
block
,

221 ()
bh
->
b_blockÄ
);

222 
	`´štk
("b_state=0x%08lx, b_size=%zu\n",

223 
bh
->
b_¡©e
, bh->
b_size
);

224 
	`´štk
("deviû % blocksize: %d\n", 
	`bdevÇme
(
bdev
, 
b
),

225 1 << 
bd_šode
->
i_blkb™s
);

227 
out_uÆock
:

228 
	`¥š_uÆock
(&
bd_m­pšg
->
´iv©e_lock
);

229 
	`·ge_ÿche_»Ëa£
(
·ge
);

230 
out
:

231  
»t
;

232 
	}
}

266 
	$šv®id©e_bdev
(
block_deviû
 *
bdev
)

268 
add»ss_¥aû
 *
m­pšg
 = 
bdev
->
bd_šode
->
i_m­pšg
;

270 ià(
m­pšg
->
Ä·ges
 == 0)

273 
	`šv®id©e_bh_Ìus
();

274 
	`Ìu_add_d¿š_®l
();

275 
	`šv®id©e_m­pšg_·ges
(
m­pšg
, 0, -1);

279 
	`ş—nÿche_æush_šode
(
m­pšg
);

280 
	}
}

281 
EXPORT_SYMBOL
(
šv®id©e_bdev
);

286 
	$ä“_mÜe_memÜy
()

288 
zÚe
 *zone;

289 
nid
;

291 
	`wakeup_æush”_th»ads
(1024, 
WB_REASON_FREE_MORE_MEM
);

292 
	`y›ld
();

294 
	`fÜ_—ch_Úlše_node
(
nid
) {

295 ()
	`fœ¡_zÚes_zÚ–i¡
(
	`node_zÚ–i¡
(
nid
, 
GFP_NOFS
),

296 
	`gå_zÚe
(
GFP_NOFS
), 
NULL
,

297 &
zÚe
);

298 ià(
zÚe
)

299 
	`Œy_to_ä“_·ges
(
	`node_zÚ–i¡
(
nid
, 
GFP_NOFS
), 0,

300 
GFP_NOFS
, 
NULL
);

302 
	}
}

308 
	$’d_bufãr_async_»ad
(
bufãr_h—d
 *
bh
, 
u±od©e
)

310 
æags
;

311 
bufãr_h—d
 *
fœ¡
;

312 
bufãr_h—d
 *
tmp
;

313 
·ge
 *page;

314 
·ge_u±od©e
 = 1;

316 
	`BUG_ON
(!
	`bufãr_async_»ad
(
bh
));

318 
·ge
 = 
bh
->
b_·ge
;

319 ià(
u±od©e
) {

320 
	`£t_bufãr_u±od©e
(
bh
);

322 
	`ş—r_bufãr_u±od©e
(
bh
);

323 ià(!
	`qu›t_”rÜ
(
bh
))

324 
	`bufãr_io_”rÜ
(
bh
);

325 
	`S‘PageE¼Ü
(
·ge
);

333 
fœ¡
 = 
	`·ge_bufãrs
(
·ge
);

334 
	`loÿl_œq_§ve
(
æags
);

335 
	`b™_¥š_lock
(
BH_U±od©e_Lock
, &
fœ¡
->
b_¡©e
);

336 
	`ş—r_bufãr_async_»ad
(
bh
);

337 
	`uÆock_bufãr
(
bh
);

338 
tmp
 = 
bh
;

340 ià(!
	`bufãr_u±od©e
(
tmp
))

341 
·ge_u±od©e
 = 0;

342 ià(
	`bufãr_async_»ad
(
tmp
)) {

343 
	`BUG_ON
(!
	`bufãr_locked
(
tmp
));

344 
¡l_busy
;

346 
tmp
 =mp->
b_this_·ge
;

347 } 
tmp
 !ğ
bh
);

348 
	`b™_¥š_uÆock
(
BH_U±od©e_Lock
, &
fœ¡
->
b_¡©e
);

349 
	`loÿl_œq_»¡Üe
(
æags
);

355 ià(
·ge_u±od©e
 && !
	`PageE¼Ü
(
·ge
))

356 
	`S‘PageU±od©e
(
·ge
);

357 
	`uÆock_·ge
(
·ge
);

360 
¡l_busy
:

361 
	`b™_¥š_uÆock
(
BH_U±od©e_Lock
, &
fœ¡
->
b_¡©e
);

362 
	`loÿl_œq_»¡Üe
(
æags
);

364 
	}
}

370 
	$’d_bufãr_async_wr™e
(
bufãr_h—d
 *
bh
, 
u±od©e
)

372 
b
[
BDEVNAME_SIZE
];

373 
æags
;

374 
bufãr_h—d
 *
fœ¡
;

375 
bufãr_h—d
 *
tmp
;

376 
·ge
 *page;

378 
	`BUG_ON
(!
	`bufãr_async_wr™e
(
bh
));

380 
·ge
 = 
bh
->
b_·ge
;

381 ià(
u±od©e
) {

382 
	`£t_bufãr_u±od©e
(
bh
);

384 ià(!
	`qu›t_”rÜ
(
bh
)) {

385 
	`bufãr_io_”rÜ
(
bh
);

386 
	`´štk
(
KERN_WARNING
 "lost…age write dueo "

388 
	`bdevÇme
(
bh
->
b_bdev
, 
b
));

390 
	`£t_b™
(
AS_EIO
, &
·ge
->
m­pšg
->
æags
);

391 
	`£t_bufãr_wr™e_io_”rÜ
(
bh
);

392 
	`ş—r_bufãr_u±od©e
(
bh
);

393 
	`S‘PageE¼Ü
(
·ge
);

396 
fœ¡
 = 
	`·ge_bufãrs
(
·ge
);

397 
	`loÿl_œq_§ve
(
æags
);

398 
	`b™_¥š_lock
(
BH_U±od©e_Lock
, &
fœ¡
->
b_¡©e
);

400 
	`ş—r_bufãr_async_wr™e
(
bh
);

401 
	`uÆock_bufãr
(
bh
);

402 
tmp
 = 
bh
->
b_this_·ge
;

403 
tmp
 !ğ
bh
) {

404 ià(
	`bufãr_async_wr™e
(
tmp
)) {

405 
	`BUG_ON
(!
	`bufãr_locked
(
tmp
));

406 
¡l_busy
;

408 
tmp
 =mp->
b_this_·ge
;

410 
	`b™_¥š_uÆock
(
BH_U±od©e_Lock
, &
fœ¡
->
b_¡©e
);

411 
	`loÿl_œq_»¡Üe
(
æags
);

412 
	`’d_·ge_wr™eback
(
·ge
);

415 
¡l_busy
:

416 
	`b™_¥š_uÆock
(
BH_U±od©e_Lock
, &
fœ¡
->
b_¡©e
);

417 
	`loÿl_œq_»¡Üe
(
æags
);

419 
	}
}

420 
EXPORT_SYMBOL
(
’d_bufãr_async_wr™e
);

443 
	$m¬k_bufãr_async_»ad
(
bufãr_h—d
 *
bh
)

445 
bh
->
b_’d_io
 = 
’d_bufãr_async_»ad
;

446 
	`£t_bufãr_async_»ad
(
bh
);

447 
	}
}

449 
	$m¬k_bufãr_async_wr™e_’dio
(
bufãr_h—d
 *
bh
,

450 
bh_’d_io_t
 *
hªdËr
)

452 
bh
->
b_’d_io
 = 
hªdËr
;

453 
	`£t_bufãr_async_wr™e
(
bh
);

454 
	}
}

456 
	$m¬k_bufãr_async_wr™e
(
bufãr_h—d
 *
bh
)

458 
	`m¬k_bufãr_async_wr™e_’dio
(
bh
, 
’d_bufãr_async_wr™e
);

459 
	}
}

460 
EXPORT_SYMBOL
(
m¬k_bufãr_async_wr™e
);

515 
	$__»move_assoc_queue
(
bufãr_h—d
 *
bh
)

517 
	`li¡_d–_š™
(&
bh
->
b_assoc_bufãrs
);

518 
	`WARN_ON
(!
bh
->
b_assoc_m­
);

519 ià(
	`bufãr_wr™e_io_”rÜ
(
bh
))

520 
	`£t_b™
(
AS_EIO
, &
bh
->
b_assoc_m­
->
æags
);

521 
bh
->
b_assoc_m­
 = 
NULL
;

522 
	}
}

524 
	$šode_has_bufãrs
(
šode
 *inode)

526  !
	`li¡_em±y
(&
šode
->
i_d©a
.
´iv©e_li¡
);

527 
	}
}

539 
	$osync_bufãrs_li¡
(
¥šlock_t
 *
lock
, 
li¡_h—d
 *
li¡
)

541 
bufãr_h—d
 *
bh
;

542 
li¡_h—d
 *
p
;

543 
”r
 = 0;

545 
	`¥š_lock
(
lock
);

546 
»³©
:

547 
	`li¡_fÜ_—ch_´ev
(
p
, 
li¡
) {

548 
bh
 = 
	`BH_ENTRY
(
p
);

549 ià(
	`bufãr_locked
(
bh
)) {

550 
	`g‘_bh
(
bh
);

551 
	`¥š_uÆock
(
lock
);

552 
	`wa™_Ú_bufãr
(
bh
);

553 ià(!
	`bufãr_u±od©e
(
bh
))

554 
”r
 = -
EIO
;

555 
	`b»l£
(
bh
);

556 
	`¥š_lock
(
lock
);

557 
»³©
;

560 
	`¥š_uÆock
(
lock
);

561  
”r
;

562 
	}
}

564 
	$do_thaw_Úe
(
su³r_block
 *
sb
, *
unu£d
)

566 
b
[
BDEVNAME_SIZE
];

567 
sb
->
s_bdev
 && !
	`thaw_bdev
(sb->s_bdev, sb))

568 
	`´štk
(
KERN_WARNING
 "Emergency Thaw on %s\n",

569 
	`bdevÇme
(
sb
->
s_bdev
, 
b
));

570 
	}
}

572 
	$do_thaw_®l
(
wÜk_¡ruù
 *
wÜk
)

574 
	`™”©e_su³rs
(
do_thaw_Úe
, 
NULL
);

575 
	`kä“
(
wÜk
);

576 
	`´štk
(
KERN_WARNING
 "Emergency Thaw complete\n");

577 
	}
}

584 
	$em”g’cy_thaw_®l
()

586 
wÜk_¡ruù
 *
wÜk
;

588 
wÜk
 = 
	`km®loc
((*wÜk), 
GFP_ATOMIC
);

589 ià(
wÜk
) {

590 
	`INIT_WORK
(
wÜk
, 
do_thaw_®l
);

591 
	`scheduË_wÜk
(
wÜk
);

593 
	}
}

606 
	$sync_m­pšg_bufãrs
(
add»ss_¥aû
 *
m­pšg
)

608 
add»ss_¥aû
 *
bufãr_m­pšg
 = 
m­pšg
->
assoc_m­pšg
;

610 ià(
bufãr_m­pšg
 =ğ
NULL
 || 
	`li¡_em±y
(&
m­pšg
->
´iv©e_li¡
))

613  
	`fsync_bufãrs_li¡
(&
bufãr_m­pšg
->
´iv©e_lock
,

614 &
m­pšg
->
´iv©e_li¡
);

615 
	}
}

616 
EXPORT_SYMBOL
(
sync_m­pšg_bufãrs
);

624 
	$wr™e_bound¬y_block
(
block_deviû
 *
bdev
,

625 
£ùÜ_t
 
bblock
, 
blocksize
)

627 
bufãr_h—d
 *
bh
 = 
	`__fšd_g‘_block
(
bdev
, 
bblock
 + 1, 
blocksize
);

628 ià(
bh
) {

629 ià(
	`bufãr_dœty
(
bh
))

630 
	`Î_rw_block
(
WRITE
, 1, &
bh
);

631 
	`put_bh
(
bh
);

633 
	}
}

635 
	$m¬k_bufãr_dœty_šode
(
bufãr_h—d
 *
bh
, 
šode
 *inode)

637 
add»ss_¥aû
 *
m­pšg
 = 
šode
->
i_m­pšg
;

638 
add»ss_¥aû
 *
bufãr_m­pšg
 = 
bh
->
b_·ge
->
m­pšg
;

640 
	`m¬k_bufãr_dœty
(
bh
);

641 ià(!
m­pšg
->
assoc_m­pšg
) {

642 
m­pšg
->
assoc_m­pšg
 = 
bufãr_m­pšg
;

644 
	`BUG_ON
(
m­pšg
->
assoc_m­pšg
 !ğ
bufãr_m­pšg
);

646 ià(!
bh
->
b_assoc_m­
) {

647 
	`¥š_lock
(&
bufãr_m­pšg
->
´iv©e_lock
);

648 
	`li¡_move_
(&
bh
->
b_assoc_bufãrs
,

649 &
m­pšg
->
´iv©e_li¡
);

650 
bh
->
b_assoc_m­
 = 
m­pšg
;

651 
	`¥š_uÆock
(&
bufãr_m­pšg
->
´iv©e_lock
);

653 
	}
}

654 
EXPORT_SYMBOL
(
m¬k_bufãr_dœty_šode
);

663 
	$__£t_·ge_dœty
(
·ge
 *page,

664 
add»ss_¥aû
 *
m­pšg
, 
w¬n
)

666 
	`¥š_lock_œq
(&
m­pšg
->
Œ“_lock
);

667 ià(
·ge
->
m­pšg
) {

668 
	`WARN_ON_ONCE
(
w¬n
 && !
	`PageU±od©e
(
·ge
));

669 
	`accouÁ_·ge_dœt›d
(
·ge
, 
m­pšg
);

670 
	`¿dix_Œ“_g_£t
(&
m­pšg
->
·ge_Œ“
,

671 
	`·ge_šdex
(
·ge
), 
PAGECACHE_TAG_DIRTY
);

673 
	`¥š_uÆock_œq
(&
m­pšg
->
Œ“_lock
);

674 
	`__m¬k_šode_dœty
(
m­pšg
->
ho¡
, 
I_DIRTY_PAGES
);

675 
	}
}

702 
	$__£t_·ge_dœty_bufãrs
(
·ge
 *page)

704 
Ãwly_dœty
;

705 
add»ss_¥aû
 *
m­pšg
 = 
	`·ge_m­pšg
(
·ge
);

707 ià(
	`uÆik–y
(!
m­pšg
))

708  !
	`Te¡S‘PageDœty
(
·ge
);

710 
	`¥š_lock
(&
m­pšg
->
´iv©e_lock
);

711 ià(
	`·ge_has_bufãrs
(
·ge
)) {

712 
bufãr_h—d
 *
h—d
 = 
	`·ge_bufãrs
(
·ge
);

713 
bufãr_h—d
 *
bh
 = 
h—d
;

716 
	`£t_bufãr_dœty
(
bh
);

717 
bh
 = bh->
b_this_·ge
;

718 } 
bh
 !ğ
h—d
);

720 
Ãwly_dœty
 = !
	`Te¡S‘PageDœty
(
·ge
);

721 
	`¥š_uÆock
(&
m­pšg
->
´iv©e_lock
);

723 ià(
Ãwly_dœty
)

724 
	`__£t_·ge_dœty
(
·ge
, 
m­pšg
, 1);

725  
Ãwly_dœty
;

726 
	}
}

727 
EXPORT_SYMBOL
(
__£t_·ge_dœty_bufãrs
);

748 
	$fsync_bufãrs_li¡
(
¥šlock_t
 *
lock
, 
li¡_h—d
 *
li¡
)

750 
bufãr_h—d
 *
bh
;

751 
li¡_h—d
 
tmp
;

752 
add»ss_¥aû
 *
m­pšg
;

753 
”r
 = 0, 
”r2
;

754 
blk_¶ug
 
¶ug
;

756 
	`INIT_LIST_HEAD
(&
tmp
);

757 
	`blk_¡¬t_¶ug
(&
¶ug
);

759 
	`¥š_lock
(
lock
);

760 !
	`li¡_em±y
(
li¡
)) {

761 
bh
 = 
	`BH_ENTRY
(
li¡
->
Ãxt
);

762 
m­pšg
 = 
bh
->
b_assoc_m­
;

763 
	`__»move_assoc_queue
(
bh
);

766 
	`smp_mb
();

767 ià(
	`bufãr_dœty
(
bh
è|| 
	`bufãr_locked
(bh)) {

768 
	`li¡_add
(&
bh
->
b_assoc_bufãrs
, &
tmp
);

769 
bh
->
b_assoc_m­
 = 
m­pšg
;

770 ià(
	`bufãr_dœty
(
bh
)) {

771 
	`g‘_bh
(
bh
);

772 
	`¥š_uÆock
(
lock
);

780 
	`wr™e_dœty_bufãr
(
bh
, 
WRITE_SYNC
);

788 
	`b»l£
(
bh
);

789 
	`¥š_lock
(
lock
);

794 
	`¥š_uÆock
(
lock
);

795 
	`blk_fšish_¶ug
(&
¶ug
);

796 
	`¥š_lock
(
lock
);

798 !
	`li¡_em±y
(&
tmp
)) {

799 
bh
 = 
	`BH_ENTRY
(
tmp
.
´ev
);

800 
	`g‘_bh
(
bh
);

801 
m­pšg
 = 
bh
->
b_assoc_m­
;

802 
	`__»move_assoc_queue
(
bh
);

805 
	`smp_mb
();

806 ià(
	`bufãr_dœty
(
bh
)) {

807 
	`li¡_add
(&
bh
->
b_assoc_bufãrs
,

808 &
m­pšg
->
´iv©e_li¡
);

809 
bh
->
b_assoc_m­
 = 
m­pšg
;

811 
	`¥š_uÆock
(
lock
);

812 
	`wa™_Ú_bufãr
(
bh
);

813 ià(!
	`bufãr_u±od©e
(
bh
))

814 
”r
 = -
EIO
;

815 
	`b»l£
(
bh
);

816 
	`¥š_lock
(
lock
);

819 
	`¥š_uÆock
(
lock
);

820 
”r2
 = 
	`osync_bufãrs_li¡
(
lock
, 
li¡
);

821 ià(
”r
)

822  
”r
;

824  
”r2
;

825 
	}
}

836 
	$šv®id©e_šode_bufãrs
(
šode
 *inode)

838 ià(
	`šode_has_bufãrs
(
šode
)) {

839 
add»ss_¥aû
 *
m­pšg
 = &
šode
->
i_d©a
;

840 
li¡_h—d
 *
li¡
 = &
m­pšg
->
´iv©e_li¡
;

841 
add»ss_¥aû
 *
bufãr_m­pšg
 = 
m­pšg
->
assoc_m­pšg
;

843 
	`¥š_lock
(&
bufãr_m­pšg
->
´iv©e_lock
);

844 !
	`li¡_em±y
(
li¡
))

845 
	`__»move_assoc_queue
(
	`BH_ENTRY
(
li¡
->
Ãxt
));

846 
	`¥š_uÆock
(&
bufãr_m­pšg
->
´iv©e_lock
);

848 
	}
}

849 
EXPORT_SYMBOL
(
šv®id©e_šode_bufãrs
);

857 
	$»move_šode_bufãrs
(
šode
 *inode)

859 
»t
 = 1;

861 ià(
	`šode_has_bufãrs
(
šode
)) {

862 
add»ss_¥aû
 *
m­pšg
 = &
šode
->
i_d©a
;

863 
li¡_h—d
 *
li¡
 = &
m­pšg
->
´iv©e_li¡
;

864 
add»ss_¥aû
 *
bufãr_m­pšg
 = 
m­pšg
->
assoc_m­pšg
;

866 
	`¥š_lock
(&
bufãr_m­pšg
->
´iv©e_lock
);

867 !
	`li¡_em±y
(
li¡
)) {

868 
bufãr_h—d
 *
bh
 = 
	`BH_ENTRY
(
li¡
->
Ãxt
);

869 ià(
	`bufãr_dœty
(
bh
)) {

870 
»t
 = 0;

873 
	`__»move_assoc_queue
(
bh
);

875 
	`¥š_uÆock
(&
bufãr_m­pšg
->
´iv©e_lock
);

877  
»t
;

878 
	}
}

889 
bufãr_h—d
 *
	$®loc_·ge_bufãrs
(
·ge
 *·ge, 
size
,

890 
»Œy
)

892 
bufãr_h—d
 *
bh
, *
h—d
;

893 
off£t
;

895 
Œy_agaš
:

896 
h—d
 = 
NULL
;

897 
off£t
 = 
PAGE_SIZE
;

898 (
off£t
 -ğ
size
) >= 0) {

899 
bh
 = 
	`®loc_bufãr_h—d
(
GFP_NOFS
);

900 ià(!
bh
)

901 
no_grow
;

903 
bh
->
b_bdev
 = 
NULL
;

904 
bh
->
b_this_·ge
 = 
h—d
;

905 
bh
->
b_blockÄ
 = -1;

906 
h—d
 = 
bh
;

908 
bh
->
b_¡©e
 = 0;

909 
	`©omic_£t
(&
bh
->
b_couÁ
, 0);

910 
bh
->
b_size
 = 
size
;

913 
	`£t_bh_·ge
(
bh
, 
·ge
, 
off£t
);

915 
	`š™_bufãr
(
bh
, 
NULL
, NULL);

917  
h—d
;

921 
no_grow
:

922 ià(
h—d
) {

924 
bh
 = 
h—d
;

925 
h—d
 = h—d->
b_this_·ge
;

926 
	`ä“_bufãr_h—d
(
bh
);

927 } 
h—d
);

936 ià(!
»Œy
)

937  
NULL
;

945 
	`ä“_mÜe_memÜy
();

946 
Œy_agaš
;

947 
	}
}

948 
EXPORT_SYMBOL_GPL
(
®loc_·ge_bufãrs
);

950 
šlše
 

951 
	$lšk_dev_bufãrs
(
·ge
 *·ge, 
bufãr_h—d
 *
h—d
)

953 
bufãr_h—d
 *
bh
, *

;

955 
bh
 = 
h—d
;

957 

 = 
bh
;

958 
bh
 = bh->
b_this_·ge
;

959 } 
bh
);

960 

->
b_this_·ge
 = 
h—d
;

961 
	`©ch_·ge_bufãrs
(
·ge
, 
h—d
);

962 
	}
}

968 
	$š™_·ge_bufãrs
(
·ge
 *·ge, 
block_deviû
 *
bdev
,

969 
£ùÜ_t
 
block
, 
size
)

971 
bufãr_h—d
 *
h—d
 = 
	`·ge_bufãrs
(
·ge
);

972 
bufãr_h—d
 *
bh
 = 
h—d
;

973 
u±od©e
 = 
	`PageU±od©e
(
·ge
);

976 ià(!
	`bufãr_m­³d
(
bh
)) {

977 
	`š™_bufãr
(
bh
, 
NULL
, NULL);

978 
bh
->
b_bdev
 = 
bdev
;

979 
bh
->
b_blockÄ
 = 
block
;

980 ià(
u±od©e
)

981 
	`£t_bufãr_u±od©e
(
bh
);

982 
	`£t_bufãr_m­³d
(
bh
);

984 
block
++;

985 
bh
 = bh->
b_this_·ge
;

986 } 
bh
 !ğ
h—d
);

987 
	}
}

994 
·ge
 *

995 
	$grow_dev_·ge
(
block_deviû
 *
bdev
, 
£ùÜ_t
 
block
,

996 
pgoff_t
 
šdex
, 
size
)

998 
šode
 *šodğ
bdev
->
bd_šode
;

999 
·ge
 *page;

1000 
bufãr_h—d
 *
bh
;

1002 
·ge
 = 
	`fšd_Ü_ü—‹_·ge
(
šode
->
i_m­pšg
, 
šdex
,

1003 (
	`m­pšg_gå_mask
(
šode
->
i_m­pšg
è& ~
__GFP_FS
)|
__GFP_MOVABLE
);

1004 ià(!
·ge
)

1005  
NULL
;

1007 
	`BUG_ON
(!
	`PageLocked
(
·ge
));

1009 ià(
	`·ge_has_bufãrs
(
·ge
)) {

1010 
bh
 = 
	`·ge_bufãrs
(
·ge
);

1011 ià(
bh
->
b_size
 =ğ
size
) {

1012 
	`š™_·ge_bufãrs
(
·ge
, 
bdev
, 
block
, 
size
);

1013  
·ge
;

1015 ià(!
	`Œy_to_ä“_bufãrs
(
·ge
))

1016 
çed
;

1022 
bh
 = 
	`®loc_·ge_bufãrs
(
·ge
, 
size
, 0);

1023 ià(!
bh
)

1024 
çed
;

1031 
	`¥š_lock
(&
šode
->
i_m­pšg
->
´iv©e_lock
);

1032 
	`lšk_dev_bufãrs
(
·ge
, 
bh
);

1033 
	`š™_·ge_bufãrs
(
·ge
, 
bdev
, 
block
, 
size
);

1034 
	`¥š_uÆock
(&
šode
->
i_m­pšg
->
´iv©e_lock
);

1035  
·ge
;

1037 
çed
:

1038 
	`BUG
();

1039 
	`uÆock_·ge
(
·ge
);

1040 
	`·ge_ÿche_»Ëa£
(
·ge
);

1041  
NULL
;

1042 
	}
}

1049 
	$grow_bufãrs
(
block_deviû
 *
bdev
, 
£ùÜ_t
 
block
, 
size
)

1051 
·ge
 *page;

1052 
pgoff_t
 
šdex
;

1053 
sizeb™s
;

1055 
sizeb™s
 = -1;

1057 
sizeb™s
++;

1058 } (
size
 << 
sizeb™s
è< 
PAGE_SIZE
);

1060 
šdex
 = 
block
 >> 
sizeb™s
;

1066 ià(
	`uÆik–y
(
šdex
 !ğ
block
 >> 
sizeb™s
)) {

1067 
b
[
BDEVNAME_SIZE
];

1069 
	`´štk
(
KERN_ERR
 "%s:„equested out-of-range block %llu for "

1071 
__func__
, ()
block
,

1072 
	`bdevÇme
(
bdev
, 
b
));

1073  -
EIO
;

1075 
block
 = 
šdex
 << 
sizeb™s
;

1077 
·ge
 = 
	`grow_dev_·ge
(
bdev
, 
block
, 
šdex
, 
size
);

1078 ià(!
·ge
)

1080 
	`uÆock_·ge
(
·ge
);

1081 
	`·ge_ÿche_»Ëa£
(
·ge
);

1083 
	}
}

1085 
bufãr_h—d
 *

1086 
	$__g‘blk_¦ow
(
block_deviû
 *
bdev
, 
£ùÜ_t
 
block
, 
size
)

1089 ià(
	`uÆik–y
(
size
 & (
	`bdev_logiÿl_block_size
(
bdev
)-1) ||

1090 (
size
 < 512 || siz> 
PAGE_SIZE
))) {

1091 
	`´štk
(
KERN_ERR
 "getblk(): invalid block size %d„equested\n",

1092 
size
);

1093 
	`´štk
(
KERN_ERR
 "logical block size: %d\n",

1094 
	`bdev_logiÿl_block_size
(
bdev
));

1096 
	`dump_¡ack
();

1097  
NULL
;

1101 
bufãr_h—d
 * 
bh
;

1102 
»t
;

1104 
bh
 = 
	`__fšd_g‘_block
(
bdev
, 
block
, 
size
);

1105 ià(
bh
)

1106  
bh
;

1108 
»t
 = 
	`grow_bufãrs
(
bdev
, 
block
, 
size
);

1109 ià(
»t
 < 0)

1110  
NULL
;

1111 ià(
»t
 == 0)

1112 
	`ä“_mÜe_memÜy
();

1114 
	}
}

1151 
	$m¬k_bufãr_dœty
(
bufãr_h—d
 *
bh
)

1153 
	`WARN_ON_ONCE
(!
	`bufãr_u±od©e
(
bh
));

1161 ià(
	`bufãr_dœty
(
bh
)) {

1162 
	`smp_mb
();

1163 ià(
	`bufãr_dœty
(
bh
))

1167 ià(!
	`‹¡_£t_bufãr_dœty
(
bh
)) {

1168 
·ge
 *·gğ
bh
->
b_·ge
;

1169 ià(!
	`Te¡S‘PageDœty
(
·ge
)) {

1170 
add»ss_¥aû
 *
m­pšg
 = 
	`·ge_m­pšg
(
·ge
);

1171 ià(
m­pšg
)

1172 
	`__£t_·ge_dœty
(
·ge
, 
m­pšg
, 0);

1175 
	}
}

1176 
EXPORT_SYMBOL
(
m¬k_bufãr_dœty
);

1185 
	$__b»l£
(
bufãr_h—d
 * 
buf
)

1187 ià(
	`©omic_»ad
(&
buf
->
b_couÁ
)) {

1188 
	`put_bh
(
buf
);

1191 
	`WARN
(1, 
KERN_ERR
 "VFS: brelse: Tryingo free free buffer\n");

1192 
	}
}

1193 
EXPORT_SYMBOL
(
__b»l£
);

1199 
	$__bfÜg‘
(
bufãr_h—d
 *
bh
)

1201 
	`ş—r_bufãr_dœty
(
bh
);

1202 ià(
bh
->
b_assoc_m­
) {

1203 
add»ss_¥aû
 *
bufãr_m­pšg
 = 
bh
->
b_·ge
->
m­pšg
;

1205 
	`¥š_lock
(&
bufãr_m­pšg
->
´iv©e_lock
);

1206 
	`li¡_d–_š™
(&
bh
->
b_assoc_bufãrs
);

1207 
bh
->
b_assoc_m­
 = 
NULL
;

1208 
	`¥š_uÆock
(&
bufãr_m­pšg
->
´iv©e_lock
);

1210 
	`__b»l£
(
bh
);

1211 
	}
}

1212 
EXPORT_SYMBOL
(
__bfÜg‘
);

1214 
bufãr_h—d
 *
	$__b»ad_¦ow
(
bufãr_h—d
 *
bh
)

1216 
	`lock_bufãr
(
bh
);

1217 ià(
	`bufãr_u±od©e
(
bh
)) {

1218 
	`uÆock_bufãr
(
bh
);

1219  
bh
;

1221 
	`g‘_bh
(
bh
);

1222 
bh
->
b_’d_io
 = 
’d_bufãr_»ad_sync
;

1223 
	`subm™_bh
(
READ
, 
bh
);

1224 
	`wa™_Ú_bufãr
(
bh
);

1225 ià(
	`bufãr_u±od©e
(
bh
))

1226  
bh
;

1228 
	`b»l£
(
bh
);

1229  
NULL
;

1230 
	}
}

1246 
	#BH_LRU_SIZE
 8

	)

1248 
	sbh_Ìu
 {

1249 
bufãr_h—d
 *
	mbhs
[
BH_LRU_SIZE
];

1252 
DEFINE_PER_CPU
(
bh_Ìu
, 
bh_Ìus
èğ{{ 
NULL
 }};

1254 #ifdeà
CONFIG_SMP


1255 
	#bh_Ìu_lock
(è
	`loÿl_œq_di§bË
()

	)

1256 
	#bh_Ìu_uÆock
(è
	`loÿl_œq_’abË
()

	)

1258 
	#bh_Ìu_lock
(è
	`´“m±_di§bË
()

	)

1259 
	#bh_Ìu_uÆock
(è
	`´“m±_’abË
()

	)

1262 
šlše
 
	$check_œqs_Ú
()

1264 #ifdeà
œqs_di§bËd


1265 
	`BUG_ON
(
	`œqs_di§bËd
());

1267 
	}
}

1272 
	$bh_Ìu_š¡®l
(
bufãr_h—d
 *
bh
)

1274 
bufãr_h—d
 *
eviù“
 = 
NULL
;

1276 
	`check_œqs_Ú
();

1277 
	`bh_Ìu_lock
();

1278 ià(
	`__this_ıu_»ad
(
bh_Ìus
.
bhs
[0]è!ğ
bh
) {

1279 
bufãr_h—d
 *
bhs
[
BH_LRU_SIZE
];

1280 
š
;

1281 
out
 = 0;

1283 
	`g‘_bh
(
bh
);

1284 
bhs
[
out
++] = 
bh
;

1285 
š
 = 0; iÀ< 
BH_LRU_SIZE
; in++) {

1286 
bufãr_h—d
 *
bh2
 =

1287 
	`__this_ıu_»ad
(
bh_Ìus
.
bhs
[
š
]);

1289 ià(
bh2
 =ğ
bh
) {

1290 
	`__b»l£
(
bh2
);

1292 ià(
out
 >ğ
BH_LRU_SIZE
) {

1293 
	`BUG_ON
(
eviù“
 !ğ
NULL
);

1294 
eviù“
 = 
bh2
;

1296 
bhs
[
out
++] = 
bh2
;

1300 
out
 < 
BH_LRU_SIZE
)

1301 
bhs
[
out
++] = 
NULL
;

1302 
	`memıy
(
	`__this_ıu_±r
(&
bh_Ìus
.
bhs
), bhs, (bhs));

1304 
	`bh_Ìu_uÆock
();

1306 ià(
eviù“
)

1307 
	`__b»l£
(
eviù“
);

1308 
	}
}

1313 
bufãr_h—d
 *

1314 
	$lookup_bh_Ìu
(
block_deviû
 *
bdev
, 
£ùÜ_t
 
block
, 
size
)

1316 
bufãr_h—d
 *
»t
 = 
NULL
;

1317 
i
;

1319 
	`check_œqs_Ú
();

1320 
	`bh_Ìu_lock
();

1321 
i
 = 0; i < 
BH_LRU_SIZE
; i++) {

1322 
bufãr_h—d
 *
bh
 = 
	`__this_ıu_»ad
(
bh_Ìus
.
bhs
[
i
]);

1324 ià(
bh
 && bh->
b_bdev
 =ğ
bdev
 &&

1325 
bh
->
b_blockÄ
 =ğ
block
 && bh->
b_size
 =ğ
size
) {

1326 ià(
i
) {

1327 
i
) {

1328 
	`__this_ıu_wr™e
(
bh_Ìus
.
bhs
[
i
],

1329 
	`__this_ıu_»ad
(
bh_Ìus
.
bhs
[
i
 - 1]));

1330 
i
--;

1332 
	`__this_ıu_wr™e
(
bh_Ìus
.
bhs
[0], 
bh
);

1334 
	`g‘_bh
(
bh
);

1335 
»t
 = 
bh
;

1339 
	`bh_Ìu_uÆock
();

1340  
»t
;

1341 
	}
}

1348 
bufãr_h—d
 *

1349 
	$__fšd_g‘_block
(
block_deviû
 *
bdev
, 
£ùÜ_t
 
block
, 
size
)

1351 
bufãr_h—d
 *
bh
 = 
	`lookup_bh_Ìu
(
bdev
, 
block
, 
size
);

1353 ià(
bh
 =ğ
NULL
) {

1354 
bh
 = 
	`__fšd_g‘_block_¦ow
(
bdev
, 
block
);

1355 ià(
bh
)

1356 
	`bh_Ìu_š¡®l
(
bh
);

1358 ià(
bh
)

1359 
	`touch_bufãr
(
bh
);

1360  
bh
;

1361 
	}
}

1362 
EXPORT_SYMBOL
(
__fšd_g‘_block
);

1376 
bufãr_h—d
 *

1377 
	$__g‘blk
(
block_deviû
 *
bdev
, 
£ùÜ_t
 
block
, 
size
)

1379 
bufãr_h—d
 *
bh
 = 
	`__fšd_g‘_block
(
bdev
, 
block
, 
size
);

1381 
	`might_¦“p
();

1382 ià(
bh
 =ğ
NULL
)

1383 
bh
 = 
	`__g‘blk_¦ow
(
bdev
, 
block
, 
size
);

1384  
bh
;

1385 
	}
}

1386 
EXPORT_SYMBOL
(
__g‘blk
);

1391 
	$__b»adah—d
(
block_deviû
 *
bdev
, 
£ùÜ_t
 
block
, 
size
)

1393 
bufãr_h—d
 *
bh
 = 
	`__g‘blk
(
bdev
, 
block
, 
size
);

1394 ià(
	`lik–y
(
bh
)) {

1395 
	`Î_rw_block
(
READA
, 1, &
bh
);

1396 
	`b»l£
(
bh
);

1398 
	}
}

1399 
EXPORT_SYMBOL
(
__b»adah—d
);

1410 
bufãr_h—d
 *

1411 
	$__b»ad
(
block_deviû
 *
bdev
, 
£ùÜ_t
 
block
, 
size
)

1413 
bufãr_h—d
 *
bh
 = 
	`__g‘blk
(
bdev
, 
block
, 
size
);

1415 ià(
	`lik–y
(
bh
è&& !
	`bufãr_u±od©e
(bh))

1416 
bh
 = 
	`__b»ad_¦ow
(bh);

1417  
bh
;

1418 
	}
}

1419 
EXPORT_SYMBOL
(
__b»ad
);

1426 
	$šv®id©e_bh_Ìu
(*
¬g
)

1428 
bh_Ìu
 *
b
 = &
	`g‘_ıu_v¬
(
bh_Ìus
);

1429 
i
;

1431 
i
 = 0; i < 
BH_LRU_SIZE
; i++) {

1432 
	`b»l£
(
b
->
bhs
[
i
]);

1433 
b
->
bhs
[
i
] = 
NULL
;

1435 
	`put_ıu_v¬
(
bh_Ìus
);

1436 
	}
}

1438 
	$šv®id©e_bh_Ìus
()

1440 
	`Ú_—ch_ıu
(
šv®id©e_bh_Ìu
, 
NULL
, 1);

1441 
	}
}

1442 
EXPORT_SYMBOL_GPL
(
šv®id©e_bh_Ìus
);

1444 
	$£t_bh_·ge
(
bufãr_h—d
 *
bh
,

1445 
·ge
 *·ge, 
off£t
)

1447 
bh
->
b_·ge
 = 
·ge
;

1448 
	`BUG_ON
(
off£t
 >ğ
PAGE_SIZE
);

1449 ià(
	`PageHighMem
(
·ge
))

1453 
bh
->
b_d©a
 = (*)(0 + 
off£t
);

1455 
bh
->
b_d©a
 = 
	`·ge_add»ss
(
·ge
è+ 
off£t
;

1456 
	}
}

1457 
EXPORT_SYMBOL
(
£t_bh_·ge
);

1462 
	$disÿrd_bufãr
(
bufãr_h—d
 * 
bh
)

1464 
	`lock_bufãr
(
bh
);

1465 
	`ş—r_bufãr_dœty
(
bh
);

1466 
bh
->
b_bdev
 = 
NULL
;

1467 
	`ş—r_bufãr_m­³d
(
bh
);

1468 
	`ş—r_bufãr_»q
(
bh
);

1469 
	`ş—r_bufãr_Ãw
(
bh
);

1470 
	`ş—r_bufãr_d–ay
(
bh
);

1471 
	`ş—r_bufãr_unwr™‹n
(
bh
);

1472 
	`uÆock_bufãr
(
bh
);

1473 
	}
}

1490 
	$block_šv®id©•age
(
·ge
 *·ge, 
off£t
)

1492 
bufãr_h—d
 *
h—d
, *
bh
, *
Ãxt
;

1493 
cu¼_off
 = 0;

1495 
	`BUG_ON
(!
	`PageLocked
(
·ge
));

1496 ià(!
	`·ge_has_bufãrs
(
·ge
))

1497 
out
;

1499 
h—d
 = 
	`·ge_bufãrs
(
·ge
);

1500 
bh
 = 
h—d
;

1502 
Ãxt_off
 = 
cu¼_off
 + 
bh
->
b_size
;

1503 
Ãxt
 = 
bh
->
b_this_·ge
;

1508 ià(
off£t
 <ğ
cu¼_off
)

1509 
	`disÿrd_bufãr
(
bh
);

1510 
cu¼_off
 = 
Ãxt_off
;

1511 
bh
 = 
Ãxt
;

1512 } 
bh
 !ğ
h—d
);

1519 ià(
off£t
 == 0)

1520 
	`Œy_to_»Ëa£_·ge
(
·ge
, 0);

1521 
out
:

1523 
	}
}

1524 
EXPORT_SYMBOL
(
block_šv®id©•age
);

1531 
	$ü—‹_em±y_bufãrs
(
·ge
 *page,

1532 
blocksize
, 
b_¡©e
)

1534 
bufãr_h—d
 *
bh
, *
h—d
, *

;

1536 
h—d
 = 
	`®loc_·ge_bufãrs
(
·ge
, 
blocksize
, 1);

1537 
bh
 = 
h—d
;

1539 
bh
->
b_¡©e
 |= b_state;

1540 

 = 
bh
;

1541 
bh
 = bh->
b_this_·ge
;

1542 } 
bh
);

1543 

->
b_this_·ge
 = 
h—d
;

1545 
	`¥š_lock
(&
·ge
->
m­pšg
->
´iv©e_lock
);

1546 ià(
	`PageU±od©e
(
·ge
è|| 
	`PageDœty
(page)) {

1547 
bh
 = 
h—d
;

1549 ià(
	`PageDœty
(
·ge
))

1550 
	`£t_bufãr_dœty
(
bh
);

1551 ià(
	`PageU±od©e
(
·ge
))

1552 
	`£t_bufãr_u±od©e
(
bh
);

1553 
bh
 = bh->
b_this_·ge
;

1554 } 
bh
 !ğ
h—d
);

1556 
	`©ch_·ge_bufãrs
(
·ge
, 
h—d
);

1557 
	`¥š_uÆock
(&
·ge
->
m­pšg
->
´iv©e_lock
);

1558 
	}
}

1559 
EXPORT_SYMBOL
(
ü—‹_em±y_bufãrs
);

1577 
	$unm­_und”lyšg_m‘ad©a
(
block_deviû
 *
bdev
, 
£ùÜ_t
 
block
)

1579 
bufãr_h—d
 *
Şd_bh
;

1581 
	`might_¦“p
();

1583 
Şd_bh
 = 
	`__fšd_g‘_block_¦ow
(
bdev
, 
block
);

1584 ià(
Şd_bh
) {

1585 
	`ş—r_bufãr_dœty
(
Şd_bh
);

1586 
	`wa™_Ú_bufãr
(
Şd_bh
);

1587 
	`ş—r_bufãr_»q
(
Şd_bh
);

1588 
	`__b»l£
(
Şd_bh
);

1590 
	}
}

1591 
EXPORT_SYMBOL
(
unm­_und”lyšg_m‘ad©a
);

1622 
	$__block_wr™e_fuÎ_·ge
(
šode
 *šode, 
·ge
 *page,

1623 
g‘_block_t
 *
g‘_block
, 
wr™eback_cÚŒŞ
 *
wbc
,

1624 
bh_’d_io_t
 *
hªdËr
)

1626 
”r
;

1627 
£ùÜ_t
 
block
;

1628 
£ùÜ_t
 
Ï¡_block
;

1629 
bufãr_h—d
 *
bh
, *
h—d
;

1630 cÚ¡ 
blocksize
 = 1 << 
šode
->
i_blkb™s
;

1631 
Ä_und”way
 = 0;

1632 
wr™e_İ
 = (
wbc
->
sync_mode
 =ğ
WB_SYNC_ALL
 ?

1633 
WRITE_SYNC
 : 
WRITE
);

1635 
	`BUG_ON
(!
	`PageLocked
(
·ge
));

1637 
Ï¡_block
 = (
	`i_size_»ad
(
šode
è- 1è>> inode->
i_blkb™s
;

1639 ià(!
	`·ge_has_bufãrs
(
·ge
)) {

1640 
	`ü—‹_em±y_bufãrs
(
·ge
, 
blocksize
,

1641 (1 << 
BH_Dœty
)|(1 << 
BH_U±od©e
));

1654 
block
 = (
£ùÜ_t
)
·ge
->
šdex
 << (
PAGE_CACHE_SHIFT
 - 
šode
->
i_blkb™s
);

1655 
h—d
 = 
	`·ge_bufãrs
(
·ge
);

1656 
bh
 = 
h—d
;

1663 ià(
block
 > 
Ï¡_block
) {

1672 
	`ş—r_bufãr_dœty
(
bh
);

1673 
	`£t_bufãr_u±od©e
(
bh
);

1674 } ià((!
	`bufãr_m­³d
(
bh
è|| 
	`bufãr_d–ay
(bh)) &&

1675 
	`bufãr_dœty
(
bh
)) {

1676 
	`WARN_ON
(
bh
->
b_size
 !ğ
blocksize
);

1677 
”r
 = 
	`g‘_block
(
šode
, 
block
, 
bh
, 1);

1678 ià(
”r
)

1679 
»cov”
;

1680 
	`ş—r_bufãr_d–ay
(
bh
);

1681 ià(
	`bufãr_Ãw
(
bh
)) {

1683 
	`ş—r_bufãr_Ãw
(
bh
);

1684 
	`unm­_und”lyšg_m‘ad©a
(
bh
->
b_bdev
,

1685 
bh
->
b_blockÄ
);

1688 
bh
 = bh->
b_this_·ge
;

1689 
block
++;

1690 } 
bh
 !ğ
h—d
);

1693 ià(!
	`bufãr_m­³d
(
bh
))

1702 ià(
wbc
->
sync_mode
 !ğ
WB_SYNC_NONE
) {

1703 
	`lock_bufãr
(
bh
);

1704 } ià(!
	`Œylock_bufãr
(
bh
)) {

1705 
	`»dœty_·ge_fÜ_wr™•age
(
wbc
, 
·ge
);

1708 ià(
	`‹¡_ş—r_bufãr_dœty
(
bh
)) {

1709 
	`m¬k_bufãr_async_wr™e_’dio
(
bh
, 
hªdËr
);

1711 
	`uÆock_bufãr
(
bh
);

1713 } (
bh
 = bh->
b_this_·ge
è!ğ
h—d
);

1719 
	`BUG_ON
(
	`PageWr™eback
(
·ge
));

1720 
	`£t_·ge_wr™eback
(
·ge
);

1723 
bufãr_h—d
 *
Ãxt
 = 
bh
->
b_this_·ge
;

1724 ià(
	`bufãr_async_wr™e
(
bh
)) {

1725 
	`subm™_bh
(
wr™e_İ
, 
bh
);

1726 
Ä_und”way
++;

1728 
bh
 = 
Ãxt
;

1729 } 
bh
 !ğ
h—d
);

1730 
	`uÆock_·ge
(
·ge
);

1732 
”r
 = 0;

1733 
dÚe
:

1734 ià(
Ä_und”way
 == 0) {

1740 
	`’d_·ge_wr™eback
(
·ge
);

1747  
”r
;

1749 
»cov”
:

1756 
bh
 = 
h—d
;

1759 ià(
	`bufãr_m­³d
(
bh
è&& 
	`bufãr_dœty
(bh) &&

1760 !
	`bufãr_d–ay
(
bh
)) {

1761 
	`lock_bufãr
(
bh
);

1762 
	`m¬k_bufãr_async_wr™e_’dio
(
bh
, 
hªdËr
);

1768 
	`ş—r_bufãr_dœty
(
bh
);

1770 } (
bh
 = bh->
b_this_·ge
è!ğ
h—d
);

1771 
	`S‘PageE¼Ü
(
·ge
);

1772 
	`BUG_ON
(
	`PageWr™eback
(
·ge
));

1773 
	`m­pšg_£t_”rÜ
(
·ge
->
m­pšg
, 
”r
);

1774 
	`£t_·ge_wr™eback
(
·ge
);

1776 
bufãr_h—d
 *
Ãxt
 = 
bh
->
b_this_·ge
;

1777 ià(
	`bufãr_async_wr™e
(
bh
)) {

1778 
	`ş—r_bufãr_dœty
(
bh
);

1779 
	`subm™_bh
(
wr™e_İ
, 
bh
);

1780 
Ä_und”way
++;

1782 
bh
 = 
Ãxt
;

1783 } 
bh
 !ğ
h—d
);

1784 
	`uÆock_·ge
(
·ge
);

1785 
dÚe
;

1786 
	}
}

1793 
	$·ge_z”o_Ãw_bufãrs
(
·ge
 *·ge, 
äom
, 
to
)

1795 
block_¡¬t
, 
block_’d
;

1796 
bufãr_h—d
 *
h—d
, *
bh
;

1798 
	`BUG_ON
(!
	`PageLocked
(
·ge
));

1799 ià(!
	`·ge_has_bufãrs
(
·ge
))

1802 
bh
 = 
h—d
 = 
	`·ge_bufãrs
(
·ge
);

1803 
block_¡¬t
 = 0;

1805 
block_’d
 = 
block_¡¬t
 + 
bh
->
b_size
;

1807 ià(
	`bufãr_Ãw
(
bh
)) {

1808 ià(
block_’d
 > 
äom
 && 
block_¡¬t
 < 
to
) {

1809 ià(!
	`PageU±od©e
(
·ge
)) {

1810 
¡¬t
, 
size
;

1812 
¡¬t
 = 
	`max
(
äom
, 
block_¡¬t
);

1813 
size
 = 
	`mš
(
to
, 
block_’d
è- 
¡¬t
;

1815 
	`z”o_u£r
(
·ge
, 
¡¬t
, 
size
);

1816 
	`£t_bufãr_u±od©e
(
bh
);

1819 
	`ş—r_bufãr_Ãw
(
bh
);

1820 
	`m¬k_bufãr_dœty
(
bh
);

1824 
block_¡¬t
 = 
block_’d
;

1825 
bh
 = bh->
b_this_·ge
;

1826 } 
bh
 !ğ
h—d
);

1827 
	}
}

1828 
EXPORT_SYMBOL
(
·ge_z”o_Ãw_bufãrs
);

1830 
	$__block_wr™e_begš
(
·ge
 *·ge, 
loff_t
 
pos
, 
Ën
,

1831 
g‘_block_t
 *
g‘_block
)

1833 
äom
 = 
pos
 & (
PAGE_CACHE_SIZE
 - 1);

1834 
to
 = 
äom
 + 
Ën
;

1835 
šode
 *šodğ
·ge
->
m­pšg
->
ho¡
;

1836 
block_¡¬t
, 
block_’d
;

1837 
£ùÜ_t
 
block
;

1838 
”r
 = 0;

1839 
blocksize
, 
bb™s
;

1840 
bufãr_h—d
 *
bh
, *
h—d
, *
wa™
[2], **
wa™_bh
=wait;

1842 
	`BUG_ON
(!
	`PageLocked
(
·ge
));

1843 
	`BUG_ON
(
äom
 > 
PAGE_CACHE_SIZE
);

1844 
	`BUG_ON
(
to
 > 
PAGE_CACHE_SIZE
);

1845 
	`BUG_ON
(
äom
 > 
to
);

1847 
blocksize
 = 1 << 
šode
->
i_blkb™s
;

1848 ià(!
	`·ge_has_bufãrs
(
·ge
))

1849 
	`ü—‹_em±y_bufãrs
(
·ge
, 
blocksize
, 0);

1850 
h—d
 = 
	`·ge_bufãrs
(
·ge
);

1852 
bb™s
 = 
šode
->
i_blkb™s
;

1853 
block
 = (
£ùÜ_t
)
·ge
->
šdex
 << (
PAGE_CACHE_SHIFT
 - 
bb™s
);

1855 
bh
 = 
h—d
, 
block_¡¬t
 = 0; bh != head || !block_start;

1856 
block
++, 
block_¡¬t
=
block_’d
, 
bh
 = bh->
b_this_·ge
) {

1857 
block_’d
 = 
block_¡¬t
 + 
blocksize
;

1858 ià(
block_’d
 <ğ
äom
 || 
block_¡¬t
 >ğ
to
) {

1859 ià(
	`PageU±od©e
(
·ge
)) {

1860 ià(!
	`bufãr_u±od©e
(
bh
))

1861 
	`£t_bufãr_u±od©e
(
bh
);

1865 ià(
	`bufãr_Ãw
(
bh
))

1866 
	`ş—r_bufãr_Ãw
(
bh
);

1867 ià(!
	`bufãr_m­³d
(
bh
)) {

1868 
	`WARN_ON
(
bh
->
b_size
 !ğ
blocksize
);

1869 
”r
 = 
	`g‘_block
(
šode
, 
block
, 
bh
, 1);

1870 ià(
”r
)

1872 ià(
	`bufãr_Ãw
(
bh
)) {

1873 
	`unm­_und”lyšg_m‘ad©a
(
bh
->
b_bdev
,

1874 
bh
->
b_blockÄ
);

1875 ià(
	`PageU±od©e
(
·ge
)) {

1876 
	`ş—r_bufãr_Ãw
(
bh
);

1877 
	`£t_bufãr_u±od©e
(
bh
);

1878 
	`m¬k_bufãr_dœty
(
bh
);

1881 ià(
block_’d
 > 
to
 || 
block_¡¬t
 < 
äom
)

1882 
	`z”o_u£r_£gm’ts
(
·ge
,

1883 
to
, 
block_’d
,

1884 
block_¡¬t
, 
äom
);

1888 ià(
	`PageU±od©e
(
·ge
)) {

1889 ià(!
	`bufãr_u±od©e
(
bh
))

1890 
	`£t_bufãr_u±od©e
(
bh
);

1893 ià(!
	`bufãr_u±od©e
(
bh
è&& !
	`bufãr_d–ay
(bh) &&

1894 !
	`bufãr_unwr™‹n
(
bh
) &&

1895 (
block_¡¬t
 < 
äom
 || 
block_’d
 > 
to
)) {

1896 
	`Î_rw_block
(
READ
, 1, &
bh
);

1897 *
wa™_bh
++=
bh
;

1903 
wa™_bh
 > 
wa™
) {

1904 
	`wa™_Ú_bufãr
(*--
wa™_bh
);

1905 ià(!
	`bufãr_u±od©e
(*
wa™_bh
))

1906 
”r
 = -
EIO
;

1908 ià(
	`uÆik–y
(
”r
))

1909 
	`·ge_z”o_Ãw_bufãrs
(
·ge
, 
äom
, 
to
);

1910  
”r
;

1911 
	}
}

1912 
EXPORT_SYMBOL
(
__block_wr™e_begš
);

1914 
	$__block_comm™_wr™e
(
šode
 *šode, 
·ge
 *page,

1915 
äom
, 
to
)

1917 
block_¡¬t
, 
block_’d
;

1918 
·¹Ÿl
 = 0;

1919 
blocksize
;

1920 
bufãr_h—d
 *
bh
, *
h—d
;

1922 
blocksize
 = 1 << 
šode
->
i_blkb™s
;

1924 
bh
 = 
h—d
 = 
	`·ge_bufãrs
(
·ge
), 
block_¡¬t
 = 0;

1925 
bh
 !ğ
h—d
 || !
block_¡¬t
;

1926 
block_¡¬t
=
block_’d
, 
bh
 = bh->
b_this_·ge
) {

1927 
block_’d
 = 
block_¡¬t
 + 
blocksize
;

1928 ià(
block_’d
 <ğ
äom
 || 
block_¡¬t
 >ğ
to
) {

1929 ià(!
	`bufãr_u±od©e
(
bh
))

1930 
·¹Ÿl
 = 1;

1932 
	`£t_bufãr_u±od©e
(
bh
);

1933 
	`m¬k_bufãr_dœty
(
bh
);

1935 
	`ş—r_bufãr_Ãw
(
bh
);

1944 ià(!
·¹Ÿl
)

1945 
	`S‘PageU±od©e
(
·ge
);

1947 
	}
}

1955 
	$block_wr™e_begš
(
add»ss_¥aû
 *
m­pšg
, 
loff_t
 
pos
, 
Ën
,

1956 
æags
, 
·ge
 **
·g•
, 
g‘_block_t
 *
g‘_block
)

1958 
pgoff_t
 
šdex
 = 
pos
 >> 
PAGE_CACHE_SHIFT
;

1959 
·ge
 *page;

1960 
¡©us
;

1962 
·ge
 = 
	`g¿b_ÿche_·ge_wr™e_begš
(
m­pšg
, 
šdex
, 
æags
);

1963 ià(!
·ge
)

1964  -
ENOMEM
;

1966 
¡©us
 = 
	`__block_wr™e_begš
(
·ge
, 
pos
, 
Ën
, 
g‘_block
);

1967 ià(
	`uÆik–y
(
¡©us
)) {

1968 
	`uÆock_·ge
(
·ge
);

1969 
	`·ge_ÿche_»Ëa£
(
·ge
);

1970 
·ge
 = 
NULL
;

1973 *
·g•
 = 
·ge
;

1974  
¡©us
;

1975 
	}
}

1976 
EXPORT_SYMBOL
(
block_wr™e_begš
);

1978 
	$block_wr™e_’d
(
fe
 *fe, 
add»ss_¥aû
 *
m­pšg
,

1979 
loff_t
 
pos
, 
Ën
, 
cİ›d
,

1980 
·ge
 *·ge, *
fsd©a
)

1982 
šode
 *šodğ
m­pšg
->
ho¡
;

1983 
¡¬t
;

1985 
¡¬t
 = 
pos
 & (
PAGE_CACHE_SIZE
 - 1);

1987 ià(
	`uÆik–y
(
cİ›d
 < 
Ën
)) {

2000 ià(!
	`PageU±od©e
(
·ge
))

2001 
cİ›d
 = 0;

2003 
	`·ge_z”o_Ãw_bufãrs
(
·ge
, 
¡¬t
+
cİ›d
, s¹+
Ën
);

2005 
	`æush_dÿche_·ge
(
·ge
);

2008 
	`__block_comm™_wr™e
(
šode
, 
·ge
, 
¡¬t
, s¹+
cİ›d
);

2010  
cİ›d
;

2011 
	}
}

2012 
EXPORT_SYMBOL
(
block_wr™e_’d
);

2014 
	$g’”ic_wr™e_’d
(
fe
 *fe, 
add»ss_¥aû
 *
m­pšg
,

2015 
loff_t
 
pos
, 
Ën
, 
cİ›d
,

2016 
·ge
 *·ge, *
fsd©a
)

2018 
šode
 *šodğ
m­pšg
->
ho¡
;

2019 
i_size_chªged
 = 0;

2021 
cİ›d
 = 
	`block_wr™e_’d
(
fe
, 
m­pšg
, 
pos
, 
Ën
, cİ›d, 
·ge
, 
fsd©a
);

2030 ià(
pos
+
cİ›d
 > 
šode
->
i_size
) {

2031 
	`i_size_wr™e
(
šode
, 
pos
+
cİ›d
);

2032 
i_size_chªged
 = 1;

2035 
	`uÆock_·ge
(
·ge
);

2036 
	`·ge_ÿche_»Ëa£
(
·ge
);

2044 ià(
i_size_chªged
)

2045 
	`m¬k_šode_dœty
(
šode
);

2047  
cİ›d
;

2048 
	}
}

2049 
EXPORT_SYMBOL
(
g’”ic_wr™e_’d
);

2058 
	$block_is_·¹ŸÎy_u±od©e
(
·ge
 *·ge, 
»ad_desütÜ_t
 *
desc
,

2059 
äom
)

2061 
šode
 *šodğ
·ge
->
m­pšg
->
ho¡
;

2062 
block_¡¬t
, 
block_’d
, 
blocksize
;

2063 
to
;

2064 
bufãr_h—d
 *
bh
, *
h—d
;

2065 
»t
 = 1;

2067 ià(!
	`·ge_has_bufãrs
(
·ge
))

2070 
blocksize
 = 1 << 
šode
->
i_blkb™s
;

2071 
to
 = 
	`mš_t
(, 
PAGE_CACHE_SIZE
 - 
äom
, 
desc
->
couÁ
);

2072 
to
 = 
äom
 +o;

2073 ià(
äom
 < 
blocksize
 && 
to
 > 
PAGE_CACHE_SIZE
 - blocksize)

2076 
h—d
 = 
	`·ge_bufãrs
(
·ge
);

2077 
bh
 = 
h—d
;

2078 
block_¡¬t
 = 0;

2080 
block_’d
 = 
block_¡¬t
 + 
blocksize
;

2081 ià(
block_’d
 > 
äom
 && 
block_¡¬t
 < 
to
) {

2082 ià(!
	`bufãr_u±od©e
(
bh
)) {

2083 
»t
 = 0;

2086 ià(
block_’d
 >ğ
to
)

2089 
block_¡¬t
 = 
block_’d
;

2090 
bh
 = bh->
b_this_·ge
;

2091 } 
bh
 !ğ
h—d
);

2093  
»t
;

2094 
	}
}

2095 
EXPORT_SYMBOL
(
block_is_·¹ŸÎy_u±od©e
);

2104 
	$block_»ad_fuÎ_·ge
(
·ge
 *·ge, 
g‘_block_t
 *
g‘_block
)

2106 
šode
 *šodğ
·ge
->
m­pšg
->
ho¡
;

2107 
£ùÜ_t
 
iblock
, 
lblock
;

2108 
bufãr_h—d
 *
bh
, *
h—d
, *
¬r
[
MAX_BUF_PER_PAGE
];

2109 
blocksize
;

2110 
Ä
, 
i
;

2111 
fuÎy_m­³d
 = 1;

2113 
	`BUG_ON
(!
	`PageLocked
(
·ge
));

2114 
blocksize
 = 1 << 
šode
->
i_blkb™s
;

2115 ià(!
	`·ge_has_bufãrs
(
·ge
))

2116 
	`ü—‹_em±y_bufãrs
(
·ge
, 
blocksize
, 0);

2117 
h—d
 = 
	`·ge_bufãrs
(
·ge
);

2119 
iblock
 = (
£ùÜ_t
)
·ge
->
šdex
 << (
PAGE_CACHE_SHIFT
 - 
šode
->
i_blkb™s
);

2120 
lblock
 = (
	`i_size_»ad
(
šode
)+
blocksize
-1è>> inode->
i_blkb™s
;

2121 
bh
 = 
h—d
;

2122 
Ä
 = 0;

2123 
i
 = 0;

2126 ià(
	`bufãr_u±od©e
(
bh
))

2129 ià(!
	`bufãr_m­³d
(
bh
)) {

2130 
”r
 = 0;

2132 
fuÎy_m­³d
 = 0;

2133 ià(
iblock
 < 
lblock
) {

2134 
	`WARN_ON
(
bh
->
b_size
 !ğ
blocksize
);

2135 
”r
 = 
	`g‘_block
(
šode
, 
iblock
, 
bh
, 0);

2136 ià(
”r
)

2137 
	`S‘PageE¼Ü
(
·ge
);

2139 ià(!
	`bufãr_m­³d
(
bh
)) {

2140 
	`z”o_u£r
(
·ge
, 
i
 * 
blocksize
, blocksize);

2141 ià(!
”r
)

2142 
	`£t_bufãr_u±od©e
(
bh
);

2149 ià(
	`bufãr_u±od©e
(
bh
))

2152 
¬r
[
Ä
++] = 
bh
;

2153 } 
i
++, 
iblock
++, (
bh
 = bh->
b_this_·ge
è!ğ
h—d
);

2155 ià(
fuÎy_m­³d
)

2156 
	`S‘PageM­³dToDisk
(
·ge
);

2158 ià(!
Ä
) {

2163 ià(!
	`PageE¼Ü
(
·ge
))

2164 
	`S‘PageU±od©e
(
·ge
);

2165 
	`uÆock_·ge
(
·ge
);

2170 
i
 = 0; i < 
Ä
; i++) {

2171 
bh
 = 
¬r
[
i
];

2172 
	`lock_bufãr
(
bh
);

2173 
	`m¬k_bufãr_async_»ad
(
bh
);

2181 
i
 = 0; i < 
Ä
; i++) {

2182 
bh
 = 
¬r
[
i
];

2183 ià(
	`bufãr_u±od©e
(
bh
))

2184 
	`’d_bufãr_async_»ad
(
bh
, 1);

2186 
	`subm™_bh
(
READ
, 
bh
);

2189 
	}
}

2190 
EXPORT_SYMBOL
(
block_»ad_fuÎ_·ge
);

2196 
	$g’”ic_cÚt_ex·nd_sim¶e
(
šode
 *šode, 
loff_t
 
size
)

2198 
add»ss_¥aû
 *
m­pšg
 = 
šode
->
i_m­pšg
;

2199 
·ge
 *page;

2200 *
fsd©a
;

2201 
”r
;

2203 
”r
 = 
	`šode_Ãwsize_ok
(
šode
, 
size
);

2204 ià(
”r
)

2205 
out
;

2207 
”r
 = 
	`·geÿche_wr™e_begš
(
NULL
, 
m­pšg
, 
size
, 0,

2208 
AOP_FLAG_UNINTERRUPTIBLE
|
AOP_FLAG_CONT_EXPAND
,

2209 &
·ge
, &
fsd©a
);

2210 ià(
”r
)

2211 
out
;

2213 
”r
 = 
	`·geÿche_wr™e_’d
(
NULL
, 
m­pšg
, 
size
, 0, 0, 
·ge
, 
fsd©a
);

2214 
	`BUG_ON
(
”r
 > 0);

2216 
out
:

2217  
”r
;

2218 
	}
}

2219 
EXPORT_SYMBOL
(
g’”ic_cÚt_ex·nd_sim¶e
);

2221 
	$cÚt_ex·nd_z”o
(
fe
 *fe, 
add»ss_¥aû
 *
m­pšg
,

2222 
loff_t
 
pos
,†off_ˆ*
by‹s
)

2224 
šode
 *šodğ
m­pšg
->
ho¡
;

2225 
blocksize
 = 1 << 
šode
->
i_blkb™s
;

2226 
·ge
 *page;

2227 *
fsd©a
;

2228 
pgoff_t
 
šdex
, 
curidx
;

2229 
loff_t
 
cu½os
;

2230 
z”oäom
, 
off£t
, 
Ën
;

2231 
”r
 = 0;

2233 
šdex
 = 
pos
 >> 
PAGE_CACHE_SHIFT
;

2234 
off£t
 = 
pos
 & ~
PAGE_CACHE_MASK
;

2236 
šdex
 > (
curidx
 = (
cu½os
 = *
by‹s
)>>
PAGE_CACHE_SHIFT
)) {

2237 
z”oäom
 = 
cu½os
 & ~
PAGE_CACHE_MASK
;

2238 ià(
z”oäom
 & (
blocksize
-1)) {

2239 *
by‹s
 |ğ(
blocksize
-1);

2240 (*
by‹s
)++;

2242 
Ën
 = 
PAGE_CACHE_SIZE
 - 
z”oäom
;

2244 
”r
 = 
	`·geÿche_wr™e_begš
(
fe
, 
m­pšg
, 
cu½os
, 
Ën
,

2245 
AOP_FLAG_UNINTERRUPTIBLE
,

2246 &
·ge
, &
fsd©a
);

2247 ià(
”r
)

2248 
out
;

2249 
	`z”o_u£r
(
·ge
, 
z”oäom
, 
Ën
);

2250 
”r
 = 
	`·geÿche_wr™e_’d
(
fe
, 
m­pšg
, 
cu½os
, 
Ën
,†en,

2251 
·ge
, 
fsd©a
);

2252 ià(
”r
 < 0)

2253 
out
;

2254 
	`BUG_ON
(
”r
 !ğ
Ën
);

2255 
”r
 = 0;

2257 
	`b®ªû_dœty_·ges_¿‹lim™ed
(
m­pšg
);

2261 ià(
šdex
 =ğ
curidx
) {

2262 
z”oäom
 = 
cu½os
 & ~
PAGE_CACHE_MASK
;

2264 ià(
off£t
 <ğ
z”oäom
) {

2265 
out
;

2267 ià(
z”oäom
 & (
blocksize
-1)) {

2268 *
by‹s
 |ğ(
blocksize
-1);

2269 (*
by‹s
)++;

2271 
Ën
 = 
off£t
 - 
z”oäom
;

2273 
”r
 = 
	`·geÿche_wr™e_begš
(
fe
, 
m­pšg
, 
cu½os
, 
Ën
,

2274 
AOP_FLAG_UNINTERRUPTIBLE
,

2275 &
·ge
, &
fsd©a
);

2276 ià(
”r
)

2277 
out
;

2278 
	`z”o_u£r
(
·ge
, 
z”oäom
, 
Ën
);

2279 
”r
 = 
	`·geÿche_wr™e_’d
(
fe
, 
m­pšg
, 
cu½os
, 
Ën
,†en,

2280 
·ge
, 
fsd©a
);

2281 ià(
”r
 < 0)

2282 
out
;

2283 
	`BUG_ON
(
”r
 !ğ
Ën
);

2284 
”r
 = 0;

2286 
out
:

2287  
”r
;

2288 
	}
}

2294 
	$cÚt_wr™e_begš
(
fe
 *fe, 
add»ss_¥aû
 *
m­pšg
,

2295 
loff_t
 
pos
, 
Ën
, 
æags
,

2296 
·ge
 **
·g•
, **
fsd©a
,

2297 
g‘_block_t
 *
g‘_block
, 
loff_t
 *
by‹s
)

2299 
šode
 *šodğ
m­pšg
->
ho¡
;

2300 
blocksize
 = 1 << 
šode
->
i_blkb™s
;

2301 
z”oäom
;

2302 
”r
;

2304 
”r
 = 
	`cÚt_ex·nd_z”o
(
fe
, 
m­pšg
, 
pos
, 
by‹s
);

2305 ià(
”r
)

2306  
”r
;

2308 
z”oäom
 = *
by‹s
 & ~
PAGE_CACHE_MASK
;

2309 ià(
pos
+
Ën
 > *
by‹s
 && 
z”oäom
 & (
blocksize
-1)) {

2310 *
by‹s
 |ğ(
blocksize
-1);

2311 (*
by‹s
)++;

2314  
	`block_wr™e_begš
(
m­pšg
, 
pos
, 
Ën
, 
æags
, 
·g•
, 
g‘_block
);

2315 
	}
}

2316 
EXPORT_SYMBOL
(
cÚt_wr™e_begš
);

2318 
	$block_comm™_wr™e
(
·ge
 *·ge, 
äom
, 
to
)

2320 
šode
 *šodğ
·ge
->
m­pšg
->
ho¡
;

2321 
	`__block_comm™_wr™e
(
šode
,
·ge
,
äom
,
to
);

2323 
	}
}

2324 
EXPORT_SYMBOL
(
block_comm™_wr™e
);

2344 
	$__block_·ge_mkwr™e
(
vm_¬—_¡ruù
 *
vma
, 
vm_çuÉ
 *
vmf
,

2345 
g‘_block_t
 
g‘_block
)

2347 
·ge
 *·gğ
vmf
->page;

2348 
šode
 *šodğ
vma
->
vm_fe
->
f_·th
.
d’Œy
->
d_šode
;

2349 
’d
;

2350 
loff_t
 
size
;

2351 
»t
;

2353 
	`lock_·ge
(
·ge
);

2354 
size
 = 
	`i_size_»ad
(
šode
);

2355 ià((
·ge
->
m­pšg
 !ğ
šode
->
i_m­pšg
) ||

2356 (
	`·ge_off£t
(
·ge
è> 
size
)) {

2358 
»t
 = -
EFAULT
;

2359 
out_uÆock
;

2363 ià(((
·ge
->
šdex
 + 1è<< 
PAGE_CACHE_SHIFT
è> 
size
)

2364 
’d
 = 
size
 & ~
PAGE_CACHE_MASK
;

2366 
’d
 = 
PAGE_CACHE_SIZE
;

2368 
»t
 = 
	`__block_wr™e_begš
(
·ge
, 0, 
’d
, 
g‘_block
);

2369 ià(!
»t
)

2370 
»t
 = 
	`block_comm™_wr™e
(
·ge
, 0, 
’d
);

2372 ià(
	`uÆik–y
(
»t
 < 0))

2373 
out_uÆock
;

2381 
	`£t_·ge_dœty
(
·ge
);

2382 ià(
šode
->
i_sb
->
s_äoz’
 !ğ
SB_UNFROZEN
) {

2383 
»t
 = -
EAGAIN
;

2384 
out_uÆock
;

2386 
	`wa™_Ú_·ge_wr™eback
(
·ge
);

2388 
out_uÆock
:

2389 
	`uÆock_·ge
(
·ge
);

2390  
»t
;

2391 
	}
}

2392 
EXPORT_SYMBOL
(
__block_·ge_mkwr™e
);

2394 
	$block_·ge_mkwr™e
(
vm_¬—_¡ruù
 *
vma
, 
vm_çuÉ
 *
vmf
,

2395 
g‘_block_t
 
g‘_block
)

2397 
»t
;

2398 
su³r_block
 *
sb
 = 
vma
->
vm_fe
->
f_·th
.
d’Œy
->
d_šode
->
i_sb
;

2404 
	`vfs_check_äoz’
(
sb
, 
SB_FREEZE_WRITE
);

2405 
»t
 = 
	`__block_·ge_mkwr™e
(
vma
, 
vmf
, 
g‘_block
);

2406  
	`block_·ge_mkwr™e_»tuº
(
»t
);

2407 
	}
}

2408 
EXPORT_SYMBOL
(
block_·ge_mkwr™e
);

2415 
	$’d_bufãr_»ad_nobh
(
bufãr_h—d
 *
bh
, 
u±od©e
)

2417 
	`__’d_bufãr_»ad_nÙouch
(
bh
, 
u±od©e
);

2418 
	}
}

2425 
	$©ch_nobh_bufãrs
(
·ge
 *·ge, 
bufãr_h—d
 *
h—d
)

2427 
bufãr_h—d
 *
bh
;

2429 
	`BUG_ON
(!
	`PageLocked
(
·ge
));

2431 
	`¥š_lock
(&
·ge
->
m­pšg
->
´iv©e_lock
);

2432 
bh
 = 
h—d
;

2434 ià(
	`PageDœty
(
·ge
))

2435 
	`£t_bufãr_dœty
(
bh
);

2436 ià(!
bh
->
b_this_·ge
)

2437 
bh
->
b_this_·ge
 = 
h—d
;

2438 
bh
 = bh->
b_this_·ge
;

2439 } 
bh
 !ğ
h—d
);

2440 
	`©ch_·ge_bufãrs
(
·ge
, 
h—d
);

2441 
	`¥š_uÆock
(&
·ge
->
m­pšg
->
´iv©e_lock
);

2442 
	}
}

2449 
	$nobh_wr™e_begš
(
add»ss_¥aû
 *
m­pšg
,

2450 
loff_t
 
pos
, 
Ën
, 
æags
,

2451 
·ge
 **
·g•
, **
fsd©a
,

2452 
g‘_block_t
 *
g‘_block
)

2454 
šode
 *šodğ
m­pšg
->
ho¡
;

2455 cÚ¡ 
blkb™s
 = 
šode
->
i_blkb™s
;

2456 cÚ¡ 
blocksize
 = 1 << 
blkb™s
;

2457 
bufãr_h—d
 *
h—d
, *
bh
;

2458 
·ge
 *page;

2459 
pgoff_t
 
šdex
;

2460 
äom
, 
to
;

2461 
block_š_·ge
;

2462 
block_¡¬t
, 
block_’d
;

2463 
£ùÜ_t
 
block_š_fe
;

2464 
Ä_»ads
 = 0;

2465 
»t
 = 0;

2466 
is_m­³d_to_disk
 = 1;

2468 
šdex
 = 
pos
 >> 
PAGE_CACHE_SHIFT
;

2469 
äom
 = 
pos
 & (
PAGE_CACHE_SIZE
 - 1);

2470 
to
 = 
äom
 + 
Ën
;

2472 
·ge
 = 
	`g¿b_ÿche_·ge_wr™e_begš
(
m­pšg
, 
šdex
, 
æags
);

2473 ià(!
·ge
)

2474  -
ENOMEM
;

2475 *
·g•
 = 
·ge
;

2476 *
fsd©a
 = 
NULL
;

2478 ià(
	`·ge_has_bufãrs
(
·ge
)) {

2479 
»t
 = 
	`__block_wr™e_begš
(
·ge
, 
pos
, 
Ën
, 
g‘_block
);

2480 ià(
	`uÆik–y
(
»t
))

2481 
out_»Ëa£
;

2482  
»t
;

2485 ià(
	`PageM­³dToDisk
(
·ge
))

2497 
h—d
 = 
	`®loc_·ge_bufãrs
(
·ge
, 
blocksize
, 0);

2498 ià(!
h—d
) {

2499 
»t
 = -
ENOMEM
;

2500 
out_»Ëa£
;

2503 
block_š_fe
 = (
£ùÜ_t
)
·ge
->
šdex
 << (
PAGE_CACHE_SHIFT
 - 
blkb™s
);

2510 
block_¡¬t
 = 0, 
block_š_·ge
 = 0, 
bh
 = 
h—d
;

2511 
block_¡¬t
 < 
PAGE_CACHE_SIZE
;

2512 
block_š_·ge
++, 
block_¡¬t
 +ğ
blocksize
, 
bh
 = bh->
b_this_·ge
) {

2513 
ü—‹
;

2515 
block_’d
 = 
block_¡¬t
 + 
blocksize
;

2516 
bh
->
b_¡©e
 = 0;

2517 
ü—‹
 = 1;

2518 ià(
block_¡¬t
 >ğ
to
)

2519 
ü—‹
 = 0;

2520 
»t
 = 
	`g‘_block
(
šode
, 
block_š_fe
 + 
block_š_·ge
,

2521 
bh
, 
ü—‹
);

2522 ià(
»t
)

2523 
çed
;

2524 ià(!
	`bufãr_m­³d
(
bh
))

2525 
is_m­³d_to_disk
 = 0;

2526 ià(
	`bufãr_Ãw
(
bh
))

2527 
	`unm­_und”lyšg_m‘ad©a
(
bh
->
b_bdev
, bh->
b_blockÄ
);

2528 ià(
	`PageU±od©e
(
·ge
)) {

2529 
	`£t_bufãr_u±od©e
(
bh
);

2532 ià(
	`bufãr_Ãw
(
bh
è|| !
	`bufãr_m­³d
(bh)) {

2533 
	`z”o_u£r_£gm’ts
(
·ge
, 
block_¡¬t
, 
äom
,

2534 
to
, 
block_’d
);

2537 ià(
	`bufãr_u±od©e
(
bh
))

2539 ià(
block_¡¬t
 < 
äom
 || 
block_’d
 > 
to
) {

2540 
	`lock_bufãr
(
bh
);

2541 
bh
->
b_’d_io
 = 
’d_bufãr_»ad_nobh
;

2542 
	`subm™_bh
(
READ
, 
bh
);

2543 
Ä_»ads
++;

2547 ià(
Ä_»ads
) {

2553 
bh
 = 
h—d
; bh; bh = bh->
b_this_·ge
) {

2554 
	`wa™_Ú_bufãr
(
bh
);

2555 ià(!
	`bufãr_u±od©e
(
bh
))

2556 
»t
 = -
EIO
;

2558 ià(
»t
)

2559 
çed
;

2562 ià(
is_m­³d_to_disk
)

2563 
	`S‘PageM­³dToDisk
(
·ge
);

2565 *
fsd©a
 = 
h—d
;

2569 
çed
:

2570 
	`BUG_ON
(!
»t
);

2578 
	`©ch_nobh_bufãrs
(
·ge
, 
h—d
);

2579 
	`·ge_z”o_Ãw_bufãrs
(
·ge
, 
äom
, 
to
);

2581 
out_»Ëa£
:

2582 
	`uÆock_·ge
(
·ge
);

2583 
	`·ge_ÿche_»Ëa£
(
·ge
);

2584 *
·g•
 = 
NULL
;

2586  
»t
;

2587 
	}
}

2588 
EXPORT_SYMBOL
(
nobh_wr™e_begš
);

2590 
	$nobh_wr™e_’d
(
fe
 *fe, 
add»ss_¥aû
 *
m­pšg
,

2591 
loff_t
 
pos
, 
Ën
, 
cİ›d
,

2592 
·ge
 *·ge, *
fsd©a
)

2594 
šode
 *šodğ
·ge
->
m­pšg
->
ho¡
;

2595 
bufãr_h—d
 *
h—d
 = 
fsd©a
;

2596 
bufãr_h—d
 *
bh
;

2597 
	`BUG_ON
(
fsd©a
 !ğ
NULL
 && 
	`·ge_has_bufãrs
(
·ge
));

2599 ià(
	`uÆik–y
(
cİ›d
 < 
Ën
è&& 
h—d
)

2600 
	`©ch_nobh_bufãrs
(
·ge
, 
h—d
);

2601 ià(
	`·ge_has_bufãrs
(
·ge
))

2602  
	`g’”ic_wr™e_’d
(
fe
, 
m­pšg
, 
pos
, 
Ën
,

2603 
cİ›d
, 
·ge
, 
fsd©a
);

2605 
	`S‘PageU±od©e
(
·ge
);

2606 
	`£t_·ge_dœty
(
·ge
);

2607 ià(
pos
+
cİ›d
 > 
šode
->
i_size
) {

2608 
	`i_size_wr™e
(
šode
, 
pos
+
cİ›d
);

2609 
	`m¬k_šode_dœty
(
šode
);

2612 
	`uÆock_·ge
(
·ge
);

2613 
	`·ge_ÿche_»Ëa£
(
·ge
);

2615 
h—d
) {

2616 
bh
 = 
h—d
;

2617 
h—d
 = h—d->
b_this_·ge
;

2618 
	`ä“_bufãr_h—d
(
bh
);

2621  
cİ›d
;

2622 
	}
}

2623 
EXPORT_SYMBOL
(
nobh_wr™e_’d
);

2630 
	$nobh_wr™•age
(
·ge
 *·ge, 
g‘_block_t
 *
g‘_block
,

2631 
wr™eback_cÚŒŞ
 *
wbc
)

2633 
šode
 * cÚ¡ inodğ
·ge
->
m­pšg
->
ho¡
;

2634 
loff_t
 
i_size
 = 
	`i_size_»ad
(
šode
);

2635 cÚ¡ 
pgoff_t
 
’d_šdex
 = 
i_size
 >> 
PAGE_CACHE_SHIFT
;

2636 
off£t
;

2637 
»t
;

2640 ià(
·ge
->
šdex
 < 
’d_šdex
)

2641 
out
;

2644 
off£t
 = 
i_size
 & (
PAGE_CACHE_SIZE
-1);

2645 ià(
·ge
->
šdex
 >ğ
’d_šdex
+1 || !
off£t
) {

2653 ià(
·ge
->
m­pšg
->
a_İs
->
šv®id©•age
)

2654 
·ge
->
m­pšg
->
a_İs
->
	`šv®id©•age
Õage, 
off£t
);

2656 
	`uÆock_·ge
(
·ge
);

2667 
	`z”o_u£r_£gm’t
(
·ge
, 
off£t
, 
PAGE_CACHE_SIZE
);

2668 
out
:

2669 
»t
 = 
	`m·ge_wr™•age
(
·ge
, 
g‘_block
, 
wbc
);

2670 ià(
»t
 =ğ-
EAGAIN
)

2671 
»t
 = 
	`__block_wr™e_fuÎ_·ge
(
šode
, 
·ge
, 
g‘_block
, 
wbc
,

2672 
’d_bufãr_async_wr™e
);

2673  
»t
;

2674 
	}
}

2675 
EXPORT_SYMBOL
(
nobh_wr™•age
);

2677 
	$nobh_Œunÿ‹_·ge
(
add»ss_¥aû
 *
m­pšg
,

2678 
loff_t
 
äom
, 
g‘_block_t
 *
g‘_block
)

2680 
pgoff_t
 
šdex
 = 
äom
 >> 
PAGE_CACHE_SHIFT
;

2681 
off£t
 = 
äom
 & (
PAGE_CACHE_SIZE
-1);

2682 
blocksize
;

2683 
£ùÜ_t
 
iblock
;

2684 
Ëngth
, 
pos
;

2685 
šode
 *šodğ
m­pšg
->
ho¡
;

2686 
·ge
 *page;

2687 
bufãr_h—d
 
m­_bh
;

2688 
”r
;

2690 
blocksize
 = 1 << 
šode
->
i_blkb™s
;

2691 
Ëngth
 = 
off£t
 & (
blocksize
 - 1);

2694 ià(!
Ëngth
)

2697 
Ëngth
 = 
blocksize
 -†ength;

2698 
iblock
 = (
£ùÜ_t
)
šdex
 << (
PAGE_CACHE_SHIFT
 - 
šode
->
i_blkb™s
);

2700 
·ge
 = 
	`g¿b_ÿche_·ge
(
m­pšg
, 
šdex
);

2701 
”r
 = -
ENOMEM
;

2702 ià(!
·ge
)

2703 
out
;

2705 ià(
	`·ge_has_bufãrs
(
·ge
)) {

2706 
has_bufãrs
:

2707 
	`uÆock_·ge
(
·ge
);

2708 
	`·ge_ÿche_»Ëa£
(
·ge
);

2709  
	`block_Œunÿ‹_·ge
(
m­pšg
, 
äom
, 
g‘_block
);

2713 
pos
 = 
blocksize
;

2714 
off£t
 >ğ
pos
) {

2715 
iblock
++;

2716 
pos
 +ğ
blocksize
;

2719 
m­_bh
.
b_size
 = 
blocksize
;

2720 
m­_bh
.
b_¡©e
 = 0;

2721 
”r
 = 
	`g‘_block
(
šode
, 
iblock
, &
m­_bh
, 0);

2722 ià(
”r
)

2723 
uÆock
;

2725 ià(!
	`bufãr_m­³d
(&
m­_bh
))

2726 
uÆock
;

2729 ià(!
	`PageU±od©e
(
·ge
)) {

2730 
”r
 = 
m­pšg
->
a_İs
->
	`»ad·ge
(
NULL
, 
·ge
);

2731 ià(
”r
) {

2732 
	`·ge_ÿche_»Ëa£
(
·ge
);

2733 
out
;

2735 
	`lock_·ge
(
·ge
);

2736 ià(!
	`PageU±od©e
(
·ge
)) {

2737 
”r
 = -
EIO
;

2738 
uÆock
;

2740 ià(
	`·ge_has_bufãrs
(
·ge
))

2741 
has_bufãrs
;

2743 
	`z”o_u£r
(
·ge
, 
off£t
, 
Ëngth
);

2744 
	`£t_·ge_dœty
(
·ge
);

2745 
”r
 = 0;

2747 
uÆock
:

2748 
	`uÆock_·ge
(
·ge
);

2749 
	`·ge_ÿche_»Ëa£
(
·ge
);

2750 
out
:

2751  
”r
;

2752 
	}
}

2753 
EXPORT_SYMBOL
(
nobh_Œunÿ‹_·ge
);

2755 
	$block_Œunÿ‹_·ge
(
add»ss_¥aû
 *
m­pšg
,

2756 
loff_t
 
äom
, 
g‘_block_t
 *
g‘_block
)

2758 
pgoff_t
 
šdex
 = 
äom
 >> 
PAGE_CACHE_SHIFT
;

2759 
off£t
 = 
äom
 & (
PAGE_CACHE_SIZE
-1);

2760 
blocksize
;

2761 
£ùÜ_t
 
iblock
;

2762 
Ëngth
, 
pos
;

2763 
šode
 *šodğ
m­pšg
->
ho¡
;

2764 
·ge
 *page;

2765 
bufãr_h—d
 *
bh
;

2766 
”r
;

2768 
blocksize
 = 1 << 
šode
->
i_blkb™s
;

2769 
Ëngth
 = 
off£t
 & (
blocksize
 - 1);

2772 ià(!
Ëngth
)

2775 
Ëngth
 = 
blocksize
 -†ength;

2776 
iblock
 = (
£ùÜ_t
)
šdex
 << (
PAGE_CACHE_SHIFT
 - 
šode
->
i_blkb™s
);

2778 
·ge
 = 
	`g¿b_ÿche_·ge
(
m­pšg
, 
šdex
);

2779 
”r
 = -
ENOMEM
;

2780 ià(!
·ge
)

2781 
out
;

2783 ià(!
	`·ge_has_bufãrs
(
·ge
))

2784 
	`ü—‹_em±y_bufãrs
(
·ge
, 
blocksize
, 0);

2787 
bh
 = 
	`·ge_bufãrs
(
·ge
);

2788 
pos
 = 
blocksize
;

2789 
off£t
 >ğ
pos
) {

2790 
bh
 = bh->
b_this_·ge
;

2791 
iblock
++;

2792 
pos
 +ğ
blocksize
;

2795 
”r
 = 0;

2796 ià(!
	`bufãr_m­³d
(
bh
)) {

2797 
	`WARN_ON
(
bh
->
b_size
 !ğ
blocksize
);

2798 
”r
 = 
	`g‘_block
(
šode
, 
iblock
, 
bh
, 0);

2799 ià(
”r
)

2800 
uÆock
;

2802 ià(!
	`bufãr_m­³d
(
bh
))

2803 
uÆock
;

2807 ià(
	`PageU±od©e
(
·ge
))

2808 
	`£t_bufãr_u±od©e
(
bh
);

2810 ià(!
	`bufãr_u±od©e
(
bh
è&& !
	`bufãr_d–ay
(bhè&& !
	`bufãr_unwr™‹n
(bh)) {

2811 
”r
 = -
EIO
;

2812 
	`Î_rw_block
(
READ
, 1, &
bh
);

2813 
	`wa™_Ú_bufãr
(
bh
);

2815 ià(!
	`bufãr_u±od©e
(
bh
))

2816 
uÆock
;

2819 
	`z”o_u£r
(
·ge
, 
off£t
, 
Ëngth
);

2820 
	`m¬k_bufãr_dœty
(
bh
);

2821 
”r
 = 0;

2823 
uÆock
:

2824 
	`uÆock_·ge
(
·ge
);

2825 
	`·ge_ÿche_»Ëa£
(
·ge
);

2826 
out
:

2827  
”r
;

2828 
	}
}

2829 
EXPORT_SYMBOL
(
block_Œunÿ‹_·ge
);

2835 
	$block_wr™e_fuÎ_·ge_’dio
(
·ge
 *·ge, 
g‘_block_t
 *
g‘_block
,

2836 
wr™eback_cÚŒŞ
 *
wbc
, 
bh_’d_io_t
 *
hªdËr
)

2838 
šode
 * cÚ¡ inodğ
·ge
->
m­pšg
->
ho¡
;

2839 
loff_t
 
i_size
 = 
	`i_size_»ad
(
šode
);

2840 cÚ¡ 
pgoff_t
 
’d_šdex
 = 
i_size
 >> 
PAGE_CACHE_SHIFT
;

2841 
off£t
;

2844 ià(
·ge
->
šdex
 < 
’d_šdex
)

2845  
	`__block_wr™e_fuÎ_·ge
(
šode
, 
·ge
, 
g‘_block
, 
wbc
,

2846 
hªdËr
);

2849 
off£t
 = 
i_size
 & (
PAGE_CACHE_SIZE
-1);

2850 ià(
·ge
->
šdex
 >ğ
’d_šdex
+1 || !
off£t
) {

2856 
	`do_šv®id©•age
(
·ge
, 0);

2857 
	`uÆock_·ge
(
·ge
);

2868 
	`z”o_u£r_£gm’t
(
·ge
, 
off£t
, 
PAGE_CACHE_SIZE
);

2869  
	`__block_wr™e_fuÎ_·ge
(
šode
, 
·ge
, 
g‘_block
, 
wbc
, 
hªdËr
);

2870 
	}
}

2871 
EXPORT_SYMBOL
(
block_wr™e_fuÎ_·ge_’dio
);

2876 
	$block_wr™e_fuÎ_·ge
(
·ge
 *·ge, 
g‘_block_t
 *
g‘_block
,

2877 
wr™eback_cÚŒŞ
 *
wbc
)

2879  
	`block_wr™e_fuÎ_·ge_’dio
(
·ge
, 
g‘_block
, 
wbc
,

2880 
’d_bufãr_async_wr™e
);

2881 
	}
}

2882 
EXPORT_SYMBOL
(
block_wr™e_fuÎ_·ge
);

2884 
£ùÜ_t
 
	$g’”ic_block_bm­
(
add»ss_¥aû
 *
m­pšg
, 
£ùÜ_t
 
block
,

2885 
g‘_block_t
 *
g‘_block
)

2887 
bufãr_h—d
 
tmp
;

2888 
šode
 *šodğ
m­pšg
->
ho¡
;

2889 
tmp
.
b_¡©e
 = 0;

2890 
tmp
.
b_blockÄ
 = 0;

2891 
tmp
.
b_size
 = 1 << 
šode
->
i_blkb™s
;

2892 
	`g‘_block
(
šode
, 
block
, &
tmp
, 0);

2893  
tmp
.
b_blockÄ
;

2894 
	}
}

2895 
EXPORT_SYMBOL
(
g’”ic_block_bm­
);

2897 
	$’d_bio_bh_io_sync
(
bio
 *bio, 
”r
)

2899 
bufãr_h—d
 *
bh
 = 
bio
->
bi_´iv©e
;

2901 ià(
”r
 =ğ-
EOPNOTSUPP
) {

2902 
	`£t_b™
(
BIO_EOPNOTSUPP
, &
bio
->
bi_æags
);

2905 ià(
	`uÆik–y
 (
	`‹¡_b™
(
BIO_QUIET
,&
bio
->
bi_æags
)))

2906 
	`£t_b™
(
BH_Qu›t
, &
bh
->
b_¡©e
);

2908 
bh
->
	`b_’d_io
(bh, 
	`‹¡_b™
(
BIO_UPTODATE
, &
bio
->
bi_æags
));

2909 
	`bio_put
(
bio
);

2910 
	}
}

2912 
	$subm™_bh
(
rw
, 
bufãr_h—d
 * 
bh
)

2914 
bio
 *bio;

2915 
»t
 = 0;

2917 
	`BUG_ON
(!
	`bufãr_locked
(
bh
));

2918 
	`BUG_ON
(!
	`bufãr_m­³d
(
bh
));

2919 
	`BUG_ON
(!
bh
->
b_’d_io
);

2920 
	`BUG_ON
(
	`bufãr_d–ay
(
bh
));

2921 
	`BUG_ON
(
	`bufãr_unwr™‹n
(
bh
));

2926 ià(
	`‹¡_£t_bufãr_»q
(
bh
è&& (
rw
 & 
WRITE
))

2927 
	`ş—r_bufãr_wr™e_io_”rÜ
(
bh
);

2933 
bio
 = 
	`bio_®loc
(
GFP_NOIO
, 1);

2935 
bio
->
bi_£ùÜ
 = 
bh
->
b_blockÄ
 * (bh->
b_size
 >> 9);

2936 
bio
->
bi_bdev
 = 
bh
->
b_bdev
;

2937 
bio
->
bi_io_vec
[0].
bv_·ge
 = 
bh
->
b_·ge
;

2938 
bio
->
bi_io_vec
[0].
bv_Ën
 = 
bh
->
b_size
;

2939 
bio
->
bi_io_vec
[0].
bv_off£t
 = 
	`bh_off£t
(
bh
);

2941 
bio
->
bi_vút
 = 1;

2942 
bio
->
bi_idx
 = 0;

2943 
bio
->
bi_size
 = 
bh
->
b_size
;

2945 
bio
->
bi_’d_io
 = 
’d_bio_bh_io_sync
;

2946 
bio
->
bi_´iv©e
 = 
bh
;

2948 
	`bio_g‘
(
bio
);

2949 
	`subm™_bio
(
rw
, 
bio
);

2951 ià(
	`bio_æagged
(
bio
, 
BIO_EOPNOTSUPP
))

2952 
»t
 = -
EOPNOTSUPP
;

2954 
	`bio_put
(
bio
);

2955  
»t
;

2956 
	}
}

2957 
EXPORT_SYMBOL
(
subm™_bh
);

2984 
	$Î_rw_block
(
rw
, 
Ä
, 
bufãr_h—d
 *
bhs
[])

2986 
i
;

2988 
i
 = 0; i < 
Ä
; i++) {

2989 
bufãr_h—d
 *
bh
 = 
bhs
[
i
];

2991 ià(!
	`Œylock_bufãr
(
bh
))

2993 ià(
rw
 =ğ
WRITE
) {

2994 ià(
	`‹¡_ş—r_bufãr_dœty
(
bh
)) {

2995 
bh
->
b_’d_io
 = 
’d_bufãr_wr™e_sync
;

2996 
	`g‘_bh
(
bh
);

2997 
	`subm™_bh
(
WRITE
, 
bh
);

3001 ià(!
	`bufãr_u±od©e
(
bh
)) {

3002 
bh
->
b_’d_io
 = 
’d_bufãr_»ad_sync
;

3003 
	`g‘_bh
(
bh
);

3004 
	`subm™_bh
(
rw
, 
bh
);

3008 
	`uÆock_bufãr
(
bh
);

3010 
	}
}

3011 
EXPORT_SYMBOL
(
Î_rw_block
);

3013 
	$wr™e_dœty_bufãr
(
bufãr_h—d
 *
bh
, 
rw
)

3015 
	`lock_bufãr
(
bh
);

3016 ià(!
	`‹¡_ş—r_bufãr_dœty
(
bh
)) {

3017 
	`uÆock_bufãr
(
bh
);

3020 
bh
->
b_’d_io
 = 
’d_bufãr_wr™e_sync
;

3021 
	`g‘_bh
(
bh
);

3022 
	`subm™_bh
(
rw
, 
bh
);

3023 
	}
}

3024 
EXPORT_SYMBOL
(
wr™e_dœty_bufãr
);

3031 
	$__sync_dœty_bufãr
(
bufãr_h—d
 *
bh
, 
rw
)

3033 
»t
 = 0;

3035 
	`WARN_ON
(
	`©omic_»ad
(&
bh
->
b_couÁ
) < 1);

3036 
	`lock_bufãr
(
bh
);

3037 ià(
	`‹¡_ş—r_bufãr_dœty
(
bh
)) {

3038 
	`g‘_bh
(
bh
);

3039 
bh
->
b_’d_io
 = 
’d_bufãr_wr™e_sync
;

3040 
»t
 = 
	`subm™_bh
(
rw
, 
bh
);

3041 
	`wa™_Ú_bufãr
(
bh
);

3042 ià(!
»t
 && !
	`bufãr_u±od©e
(
bh
))

3043 
»t
 = -
EIO
;

3045 
	`uÆock_bufãr
(
bh
);

3047  
»t
;

3048 
	}
}

3049 
EXPORT_SYMBOL
(
__sync_dœty_bufãr
);

3051 
	$sync_dœty_bufãr
(
bufãr_h—d
 *
bh
)

3053  
	`__sync_dœty_bufãr
(
bh
, 
WRITE_SYNC
);

3054 
	}
}

3055 
EXPORT_SYMBOL
(
sync_dœty_bufãr
);

3077 
šlše
 
	$bufãr_busy
(
bufãr_h—d
 *
bh
)

3079  
	`©omic_»ad
(&
bh
->
b_couÁ
) |

3080 (
bh
->
b_¡©e
 & ((1 << 
BH_Dœty
è| (1 << 
BH_Lock
)));

3081 
	}
}

3084 
	$drİ_bufãrs
(
·ge
 *·ge, 
bufãr_h—d
 **
bufãrs_to_ä“
)

3086 
bufãr_h—d
 *
h—d
 = 
	`·ge_bufãrs
(
·ge
);

3087 
bufãr_h—d
 *
bh
;

3089 
bh
 = 
h—d
;

3091 ià(
	`bufãr_wr™e_io_”rÜ
(
bh
è&& 
·ge
->
m­pšg
)

3092 
	`£t_b™
(
AS_EIO
, &
·ge
->
m­pšg
->
æags
);

3093 ià(
	`bufãr_busy
(
bh
))

3094 
çed
;

3095 
bh
 = bh->
b_this_·ge
;

3096 } 
bh
 !ğ
h—d
);

3099 
bufãr_h—d
 *
Ãxt
 = 
bh
->
b_this_·ge
;

3101 ià(
bh
->
b_assoc_m­
)

3102 
	`__»move_assoc_queue
(
bh
);

3103 
bh
 = 
Ãxt
;

3104 } 
bh
 !ğ
h—d
);

3105 *
bufãrs_to_ä“
 = 
h—d
;

3106 
	`__ş—r_·ge_bufãrs
(
·ge
);

3108 
çed
:

3110 
	}
}

3112 
	$Œy_to_ä“_bufãrs
(
·ge
 *page)

3114 
add»ss_¥aû
 * cÚ¡ 
m­pšg
 = 
·ge
->mapping;

3115 
bufãr_h—d
 *
bufãrs_to_ä“
 = 
NULL
;

3116 
»t
 = 0;

3118 
	`BUG_ON
(!
	`PageLocked
(
·ge
));

3119 ià(
	`PageWr™eback
(
·ge
))

3122 ià(
m­pšg
 =ğ
NULL
) {

3123 
»t
 = 
	`drİ_bufãrs
(
·ge
, &
bufãrs_to_ä“
);

3124 
out
;

3127 
	`¥š_lock
(&
m­pšg
->
´iv©e_lock
);

3128 
»t
 = 
	`drİ_bufãrs
(
·ge
, &
bufãrs_to_ä“
);

3144 ià(
»t
)

3145 
	`ÿnûl_dœty_·ge
(
·ge
, 
PAGE_CACHE_SIZE
);

3146 
	`¥š_uÆock
(&
m­pšg
->
´iv©e_lock
);

3147 
out
:

3148 ià(
bufãrs_to_ä“
) {

3149 
bufãr_h—d
 *
bh
 = 
bufãrs_to_ä“
;

3152 
bufãr_h—d
 *
Ãxt
 = 
bh
->
b_this_·ge
;

3153 
	`ä“_bufãr_h—d
(
bh
);

3154 
bh
 = 
Ãxt
;

3155 } 
bh
 !ğ
bufãrs_to_ä“
);

3157  
»t
;

3158 
	}
}

3159 
EXPORT_SYMBOL
(
Œy_to_ä“_bufãrs
);

3168 
	$SYSCALL_DEFINE2
(
bdæush
, , 
func
, , 
d©a
)

3170 
msg_couÁ
;

3172 ià(!
	`ÿ·bË
(
CAP_SYS_ADMIN
))

3173  -
EPERM
;

3175 ià(
msg_couÁ
 < 5) {

3176 
msg_couÁ
++;

3177 
	`´štk
(
KERN_INFO


3179 " sy¡em c®l\n", 
cu¼’t
->
comm
);

3180 
	`´štk
(
KERN_INFO
 "Fix your initscripts?\n");

3183 ià(
func
 == 1)

3184 
	`do_ex™
(0);

3186 
	}
}

3191 
kmem_ÿche
 *
	gbh_ÿch•
;

3197 
	gmax_bufãr_h—ds
;

3199 
	gbufãr_h—ds_ov”_lim™
;

3201 
	sbh_accouÁšg
 {

3202 
	mÄ
;

3203 
	m¿‹lim™
;

3206 
DEFINE_PER_CPU
(
bh_accouÁšg
, bh_accounting) = {0, 0};

3208 
	$»ÿlc_bh_¡©e
()

3210 
i
;

3211 
tÙ
 = 0;

3213 ià(
	`__this_ıu_šc_»tuº
(
bh_accouÁšg
.
¿‹lim™
) - 1 < 4096)

3215 
	`__this_ıu_wr™e
(
bh_accouÁšg
.
¿‹lim™
, 0);

3216 
	`fÜ_—ch_Úlše_ıu
(
i
)

3217 
tÙ
 +ğ
	`³r_ıu
(
bh_accouÁšg
, 
i
).
Ä
;

3218 
bufãr_h—ds_ov”_lim™
 = (
tÙ
 > 
max_bufãr_h—ds
);

3219 
	}
}

3221 
bufãr_h—d
 *
	$®loc_bufãr_h—d
(
gå_t
 
gå_æags
)

3223 
bufãr_h—d
 *
»t
 = 
	`kmem_ÿche_z®loc
(
bh_ÿch•
, 
gå_æags
);

3224 ià(
»t
) {

3225 
	`INIT_LIST_HEAD
(&
»t
->
b_assoc_bufãrs
);

3226 
	`´“m±_di§bË
();

3227 
	`__this_ıu_šc
(
bh_accouÁšg
.
Ä
);

3228 
	`»ÿlc_bh_¡©e
();

3229 
	`´“m±_’abË
();

3231  
»t
;

3232 
	}
}

3233 
EXPORT_SYMBOL
(
®loc_bufãr_h—d
);

3235 
	$ä“_bufãr_h—d
(
bufãr_h—d
 *
bh
)

3237 
	`BUG_ON
(!
	`li¡_em±y
(&
bh
->
b_assoc_bufãrs
));

3238 
	`kmem_ÿche_ä“
(
bh_ÿch•
, 
bh
);

3239 
	`´“m±_di§bË
();

3240 
	`__this_ıu_dec
(
bh_accouÁšg
.
Ä
);

3241 
	`»ÿlc_bh_¡©e
();

3242 
	`´“m±_’abË
();

3243 
	}
}

3244 
EXPORT_SYMBOL
(
ä“_bufãr_h—d
);

3246 
	$bufãr_ex™_ıu
(
ıu
)

3248 
i
;

3249 
bh_Ìu
 *
b
 = &
	`³r_ıu
(
bh_Ìus
, 
ıu
);

3251 
i
 = 0; i < 
BH_LRU_SIZE
; i++) {

3252 
	`b»l£
(
b
->
bhs
[
i
]);

3253 
b
->
bhs
[
i
] = 
NULL
;

3255 
	`this_ıu_add
(
bh_accouÁšg
.
Ä
, 
	`³r_ıu
(bh_accouÁšg, 
ıu
).nr);

3256 
	`³r_ıu
(
bh_accouÁšg
, 
ıu
).
Ä
 = 0;

3257 
	}
}

3259 
	$bufãr_ıu_nÙify
(
nÙif›r_block
 *
£lf
,

3260 
aùiÚ
, *
hıu
)

3262 ià(
aùiÚ
 =ğ
CPU_DEAD
 ||‡ùiÚ =ğ
CPU_DEAD_FROZEN
)

3263 
	`bufãr_ex™_ıu
(()
hıu
);

3264  
NOTIFY_OK
;

3265 
	}
}

3274 
	$bh_u±od©e_Ü_lock
(
bufãr_h—d
 *
bh
)

3276 ià(!
	`bufãr_u±od©e
(
bh
)) {

3277 
	`lock_bufãr
(
bh
);

3278 ià(!
	`bufãr_u±od©e
(
bh
))

3280 
	`uÆock_bufãr
(
bh
);

3283 
	}
}

3284 
EXPORT_SYMBOL
(
bh_u±od©e_Ü_lock
);

3292 
	$bh_subm™_»ad
(
bufãr_h—d
 *
bh
)

3294 
	`BUG_ON
(!
	`bufãr_locked
(
bh
));

3296 ià(
	`bufãr_u±od©e
(
bh
)) {

3297 
	`uÆock_bufãr
(
bh
);

3301 
	`g‘_bh
(
bh
);

3302 
bh
->
b_’d_io
 = 
’d_bufãr_»ad_sync
;

3303 
	`subm™_bh
(
READ
, 
bh
);

3304 
	`wa™_Ú_bufãr
(
bh
);

3305 ià(
	`bufãr_u±od©e
(
bh
))

3307  -
EIO
;

3308 
	}
}

3309 
EXPORT_SYMBOL
(
bh_subm™_»ad
);

3311 
__š™
 
	$bufãr_š™
()

3313 
Ä·ges
;

3315 
bh_ÿch•
 = 
	`kmem_ÿche_ü—‹
("buffer_head",

3316 (
bufãr_h—d
), 0,

3317 (
SLAB_RECLAIM_ACCOUNT
|
SLAB_PANIC
|

3318 
SLAB_MEM_SPREAD
),

3319 
NULL
);

3324 
Ä·ges
 = (
	`Ä_ä“_bufãr_·ges
() * 10) / 100;

3325 
max_bufãr_h—ds
 = 
Ä·ges
 * (
PAGE_SIZE
 / (
bufãr_h—d
));

3326 
	`hÙıu_nÙif›r
(
bufãr_ıu_nÙify
, 0);

3327 
	}
}

	@char_dev.c

7 
	~<lšux/š™.h
>

8 
	~<lšux/fs.h
>

9 
	~<lšux/kdev_t.h
>

10 
	~<lšux/¦ab.h
>

11 
	~<lšux/¡ršg.h
>

13 
	~<lšux/majÜ.h
>

14 
	~<lšux/”ºo.h
>

15 
	~<lšux/moduË.h
>

16 
	~<lšux/£q_fe.h
>

18 
	~<lšux/kobjeù.h
>

19 
	~<lšux/kobj_m­.h
>

20 
	~<lšux/cdev.h
>

21 
	~<lšux/mu‹x.h
>

22 
	~<lšux/backšg-dev.h
>

23 
	~<lšux/‰y.h
>

25 
	~"š‹º®.h
"

34 
backšg_dev_šfo
 
	gdœeùly_m­·bË_cdev_bdi
 = {

35 .
Çme
 = "char",

36 .
	gÿ·b™›s
 = (

37 #ifdeà
CONFIG_MMU


39 
BDI_CAP_MAP_COPY
 |

42 
BDI_CAP_MAP_DIRECT
 |

43 
BDI_CAP_READ_MAP
 | 
BDI_CAP_WRITE_MAP
 | 
BDI_CAP_EXEC_MAP
 |

45 
BDI_CAP_NO_ACCT_AND_WRITEBACK
),

48 
kobj_m­
 *
	gcdev_m­
;

50 
DEFINE_MUTEX
(
chrdevs_lock
);

52 
	sch¬_deviû_¡ruù
 {

53 
ch¬_deviû_¡ruù
 *
	mÃxt
;

54 
	mmajÜ
;

55 
	mba£mšÜ
;

56 
	mmšÜù
;

57 
	mÇme
[64];

58 
cdev
 *
	mcdev
;

59 } *
	gchrdevs
[
CHRDEV_MAJOR_HASH_SIZE
];

62 
šlše
 
	$majÜ_to_šdex
(
majÜ
)

64  
majÜ
 % 
CHRDEV_MAJOR_HASH_SIZE
;

65 
	}
}

67 #ifdeà
CONFIG_PROC_FS


69 
	$chrdev_show
(
£q_fe
 *
f
, 
off_t
 
off£t
)

71 
ch¬_deviû_¡ruù
 *
cd
;

73 ià(
off£t
 < 
CHRDEV_MAJOR_HASH_SIZE
) {

74 
	`mu‹x_lock
(&
chrdevs_lock
);

75 
cd
 = 
chrdevs
[
off£t
]; cd; cd = cd->
Ãxt
)

76 
	`£q_´štf
(
f
, "%3d %s\n", 
cd
->
majÜ
, cd->
Çme
);

77 
	`mu‹x_uÆock
(&
chrdevs_lock
);

79 
	}
}

94 
ch¬_deviû_¡ruù
 *

95 
	$__»gi¡”_chrdev_»giÚ
(
majÜ
, 
ba£mšÜ
,

96 
mšÜù
, cÚ¡ *
Çme
)

98 
ch¬_deviû_¡ruù
 *
cd
, **
ı
;

99 
»t
 = 0;

100 
i
;

102 
cd
 = 
	`kz®loc
((
ch¬_deviû_¡ruù
), 
GFP_KERNEL
);

103 ià(
cd
 =ğ
NULL
)

104  
	`ERR_PTR
(-
ENOMEM
);

106 
	`mu‹x_lock
(&
chrdevs_lock
);

109 ià(
majÜ
 == 0) {

110 
i
 = 
	`ARRAY_SIZE
(
chrdevs
)-1; i > 0; i--) {

111 ià(
chrdevs
[
i
] =ğ
NULL
)

115 ià(
i
 == 0) {

116 
»t
 = -
EBUSY
;

117 
out
;

119 
majÜ
 = 
i
;

120 
»t
 = 
majÜ
;

123 
cd
->
majÜ
 = major;

124 
cd
->
ba£mšÜ
 = baseminor;

125 
cd
->
mšÜù
 = minorct;

126 
	`¡¾ıy
(
cd
->
Çme
,‚ame, (cd->name));

128 
i
 = 
	`majÜ_to_šdex
(
majÜ
);

130 
ı
 = &
chrdevs
[
i
]; *ı; c°ğ&(*ı)->
Ãxt
)

131 ià((*
ı
)->
majÜ
 > major ||

132 ((*
ı
)->
majÜ
 == major &&

133 (((*
ı
)->
ba£mšÜ
 >= baseminor) ||

134 ((*
ı
)->
ba£mšÜ
 + (*ı)->
mšÜù
 > baseminor))))

138 ià(*
ı
 && (*ı)->
majÜ
 == major) {

139 
Şd_mš
 = (*
ı
)->
ba£mšÜ
;

140 
Şd_max
 = (*
ı
)->
ba£mšÜ
 + (*ı)->
mšÜù
 - 1;

141 
Ãw_mš
 = 
ba£mšÜ
;

142 
Ãw_max
 = 
ba£mšÜ
 + 
mšÜù
 - 1;

145 ià(
Ãw_max
 >ğ
Şd_mš
 &&‚ew_max <ğ
Şd_max
) {

146 
»t
 = -
EBUSY
;

147 
out
;

151 ià(
Ãw_mš
 <ğ
Şd_max
 &&‚ew_mš >ğ
Şd_mš
) {

152 
»t
 = -
EBUSY
;

153 
out
;

157 
cd
->
Ãxt
 = *
ı
;

158 *
ı
 = 
cd
;

159 
	`mu‹x_uÆock
(&
chrdevs_lock
);

160  
cd
;

161 
out
:

162 
	`mu‹x_uÆock
(&
chrdevs_lock
);

163 
	`kä“
(
cd
);

164  
	`ERR_PTR
(
»t
);

165 
	}
}

167 
ch¬_deviû_¡ruù
 *

168 
	$__uÄegi¡”_chrdev_»giÚ
(
majÜ
, 
ba£mšÜ
, 
mšÜù
)

170 
ch¬_deviû_¡ruù
 *
cd
 = 
NULL
, **
ı
;

171 
i
 = 
	`majÜ_to_šdex
(
majÜ
);

173 
	`mu‹x_lock
(&
chrdevs_lock
);

174 
ı
 = &
chrdevs
[
i
]; *ı; c°ğ&(*ı)->
Ãxt
)

175 ià((*
ı
)->
majÜ
 == major &&

176 (*
ı
)->
ba£mšÜ
 == baseminor &&

177 (*
ı
)->
mšÜù
 == minorct)

179 ià(*
ı
) {

180 
cd
 = *
ı
;

181 *
ı
 = 
cd
->
Ãxt
;

183 
	`mu‹x_uÆock
(&
chrdevs_lock
);

184  
cd
;

185 
	}
}

196 
	$»gi¡”_chrdev_»giÚ
(
dev_t
 
äom
, 
couÁ
, cÚ¡ *
Çme
)

198 
ch¬_deviû_¡ruù
 *
cd
;

199 
dev_t
 
to
 = 
äom
 + 
couÁ
;

200 
dev_t
 
n
, 
Ãxt
;

202 
n
 = 
äom
;‚ < 
to
;‚ = 
Ãxt
) {

203 
Ãxt
 = 
	`MKDEV
(
	`MAJOR
(
n
)+1, 0);

204 ià(
Ãxt
 > 
to
)

205 
Ãxt
 = 
to
;

206 
cd
 = 
	`__»gi¡”_chrdev_»giÚ
(
	`MAJOR
(
n
), 
	`MINOR
(n),

207 
Ãxt
 - 
n
, 
Çme
);

208 ià(
	`IS_ERR
(
cd
))

209 
ç
;

212 
ç
:

213 
to
 = 
n
;

214 
n
 = 
äom
;‚ < 
to
;‚ = 
Ãxt
) {

215 
Ãxt
 = 
	`MKDEV
(
	`MAJOR
(
n
)+1, 0);

216 
	`kä“
(
	`__uÄegi¡”_chrdev_»giÚ
(
	`MAJOR
(
n
), 
	`MINOR
Ò), 
Ãxt
 -‚));

218  
	`PTR_ERR
(
cd
);

219 
	}
}

232 
	$®loc_chrdev_»giÚ
(
dev_t
 *
dev
, 
ba£mšÜ
, 
couÁ
,

233 cÚ¡ *
Çme
)

235 
ch¬_deviû_¡ruù
 *
cd
;

236 
cd
 = 
	`__»gi¡”_chrdev_»giÚ
(0, 
ba£mšÜ
, 
couÁ
, 
Çme
);

237 ià(
	`IS_ERR
(
cd
))

238  
	`PTR_ERR
(
cd
);

239 *
dev
 = 
	`MKDEV
(
cd
->
majÜ
, cd->
ba£mšÜ
);

241 
	}
}

264 
	$__»gi¡”_chrdev
(
majÜ
, 
ba£mšÜ
,

265 
couÁ
, cÚ¡ *
Çme
,

266 cÚ¡ 
fe_İ”©iÚs
 *
fİs
)

268 
ch¬_deviû_¡ruù
 *
cd
;

269 
cdev
 *cdev;

270 
”r
 = -
ENOMEM
;

272 
cd
 = 
	`__»gi¡”_chrdev_»giÚ
(
majÜ
, 
ba£mšÜ
, 
couÁ
, 
Çme
);

273 ià(
	`IS_ERR
(
cd
))

274  
	`PTR_ERR
(
cd
);

276 
cdev
 = 
	`cdev_®loc
();

277 ià(!
cdev
)

278 
out2
;

280 
cdev
->
owÃr
 = 
fİs
->owner;

281 
cdev
->
İs
 = 
fİs
;

282 
	`kobjeù_£t_Çme
(&
cdev
->
kobj
, "%s", 
Çme
);

284 
”r
 = 
	`cdev_add
(
cdev
, 
	`MKDEV
(
cd
->
majÜ
, 
ba£mšÜ
), 
couÁ
);

285 ià(
”r
)

286 
out
;

288 
cd
->
cdev
 = cdev;

290  
majÜ
 ? 0 : 
cd
->major;

291 
out
:

292 
	`kobjeù_put
(&
cdev
->
kobj
);

293 
out2
:

294 
	`kä“
(
	`__uÄegi¡”_chrdev_»giÚ
(
cd
->
majÜ
, 
ba£mšÜ
, 
couÁ
));

295  
”r
;

296 
	}
}

307 
	$uÄegi¡”_chrdev_»giÚ
(
dev_t
 
äom
, 
couÁ
)

309 
dev_t
 
to
 = 
äom
 + 
couÁ
;

310 
dev_t
 
n
, 
Ãxt
;

312 
n
 = 
äom
;‚ < 
to
;‚ = 
Ãxt
) {

313 
Ãxt
 = 
	`MKDEV
(
	`MAJOR
(
n
)+1, 0);

314 ià(
Ãxt
 > 
to
)

315 
Ãxt
 = 
to
;

316 
	`kä“
(
	`__uÄegi¡”_chrdev_»giÚ
(
	`MAJOR
(
n
), 
	`MINOR
Ò), 
Ãxt
 -‚));

318 
	}
}

331 
	$__uÄegi¡”_chrdev
(
majÜ
, 
ba£mšÜ
,

332 
couÁ
, cÚ¡ *
Çme
)

334 
ch¬_deviû_¡ruù
 *
cd
;

336 
cd
 = 
	`__uÄegi¡”_chrdev_»giÚ
(
majÜ
, 
ba£mšÜ
, 
couÁ
);

337 ià(
cd
 && cd->
cdev
)

338 
	`cdev_d–
(
cd
->
cdev
);

339 
	`kä“
(
cd
);

340 
	}
}

342 
DEFINE_SPINLOCK
(
cdev_lock
);

344 
kobjeù
 *
	$cdev_g‘
(
cdev
 *
p
)

346 
moduË
 *
owÃr
 = 
p
->owner;

347 
kobjeù
 *
kobj
;

349 ià(
owÃr
 && !
	`Œy_moduË_g‘
(owner))

350  
NULL
;

351 
kobj
 = 
	`kobjeù_g‘
(&
p
->kobj);

352 ià(!
kobj
)

353 
	`moduË_put
(
owÃr
);

354  
kobj
;

355 
	}
}

357 
	$cdev_put
(
cdev
 *
p
)

359 ià(
p
) {

360 
moduË
 *
owÃr
 = 
p
->owner;

361 
	`kobjeù_put
(&
p
->
kobj
);

362 
	`moduË_put
(
owÃr
);

364 
	}
}

369 
	$chrdev_İ’
(
šode
 *šode, 
fe
 *
fp
)

371 
cdev
 *
p
;

372 
cdev
 *
Ãw
 = 
NULL
;

373 
»t
 = 0;

375 
	`¥š_lock
(&
cdev_lock
);

376 
p
 = 
šode
->
i_cdev
;

377 ià(!
p
) {

378 
kobjeù
 *
kobj
;

379 
idx
;

380 
	`¥š_uÆock
(&
cdev_lock
);

381 
kobj
 = 
	`kobj_lookup
(
cdev_m­
, 
šode
->
i_rdev
, &
idx
);

382 ià(!
kobj
)

383  -
ENXIO
;

384 
Ãw
 = 
	`cÚš”_of
(
kobj
, 
cdev
, kobj);

385 
	`¥š_lock
(&
cdev_lock
);

388 
p
 = 
šode
->
i_cdev
;

389 ià(!
p
) {

390 
šode
->
i_cdev
 = 
p
 = 
Ãw
;

391 
	`li¡_add
(&
šode
->
i_deviûs
, &
p
->
li¡
);

392 
Ãw
 = 
NULL
;

393 } ià(!
	`cdev_g‘
(
p
))

394 
»t
 = -
ENXIO
;

395 } ià(!
	`cdev_g‘
(
p
))

396 
»t
 = -
ENXIO
;

397 
	`¥š_uÆock
(&
cdev_lock
);

398 
	`cdev_put
(
Ãw
);

399 ià(
»t
)

400  
»t
;

402 
»t
 = -
ENXIO
;

403 
fp
->
f_İ
 = 
	`fİs_g‘
(
p
->
İs
);

404 ià(!
fp
->
f_İ
)

405 
out_cdev_put
;

407 ià(
fp
->
f_İ
->
İ’
) {

408 
»t
 = 
fp
->
f_İ
->
	`İ’
(
šode
,filp);

409 ià(
»t
)

410 
out_cdev_put
;

415 
out_cdev_put
:

416 
	`cdev_put
(
p
);

417  
»t
;

418 
	}
}

420 
	$cd_fÜg‘
(
šode
 *inode)

422 
	`¥š_lock
(&
cdev_lock
);

423 
	`li¡_d–_š™
(&
šode
->
i_deviûs
);

424 
šode
->
i_cdev
 = 
NULL
;

425 
	`¥š_uÆock
(&
cdev_lock
);

426 
	}
}

428 
	$cdev_purge
(
cdev
 *cdev)

430 
	`¥š_lock
(&
cdev_lock
);

431 !
	`li¡_em±y
(&
cdev
->
li¡
)) {

432 
šode
 *inode;

433 
šode
 = 
	`cÚš”_of
(
cdev
->
li¡
.
Ãxt
, šode, 
i_deviûs
);

434 
	`li¡_d–_š™
(&
šode
->
i_deviûs
);

435 
šode
->
i_cdev
 = 
NULL
;

437 
	`¥š_uÆock
(&
cdev_lock
);

438 
	}
}

445 cÚ¡ 
fe_İ”©iÚs
 
	gdef_chr_fİs
 = {

446 .
İ’
 = 
chrdev_İ’
,

447 .
	gÎ£ek
 = 
noİ_Î£ek
,

450 
kobjeù
 *
	$exaù_m©ch
(
dev_t
 
dev
, *
·¹
, *
d©a
)

452 
cdev
 *
p
 = 
d©a
;

453  &
p
->
kobj
;

454 
	}
}

456 
	$exaù_lock
(
dev_t
 
dev
, *
d©a
)

458 
cdev
 *
p
 = 
d©a
;

459  
	`cdev_g‘
(
p
) ? 0 : -1;

460 
	}
}

472 
	$cdev_add
(
cdev
 *
p
, 
dev_t
 
dev
, 
couÁ
)

474 
p
->
dev
 = dev;

475 
p
->
couÁ
 = count;

476  
	`kobj_m­
(
cdev_m­
, 
dev
, 
couÁ
, 
NULL
, 
exaù_m©ch
, 
exaù_lock
, 
p
);

477 
	}
}

479 
	$cdev_unm­
(
dev_t
 
dev
, 
couÁ
)

481 
	`kobj_unm­
(
cdev_m­
, 
dev
, 
couÁ
);

482 
	}
}

491 
	$cdev_d–
(
cdev
 *
p
)

493 
	`cdev_unm­
(
p
->
dev
,…->
couÁ
);

494 
	`kobjeù_put
(&
p
->
kobj
);

495 
	}
}

498 
	$cdev_deçuÉ_»Ëa£
(
kobjeù
 *
kobj
)

500 
cdev
 *
p
 = 
	`cÚš”_of
(
kobj
, cdev, kobj);

501 
	`cdev_purge
(
p
);

502 
	}
}

504 
	$cdev_dyÇmic_»Ëa£
(
kobjeù
 *
kobj
)

506 
cdev
 *
p
 = 
	`cÚš”_of
(
kobj
, cdev, kobj);

507 
	`cdev_purge
(
p
);

508 
	`kä“
(
p
);

509 
	}
}

511 
kobj_ty³
 
	gkty³_cdev_deçuÉ
 = {

512 .
»Ëa£
 = 
cdev_deçuÉ_»Ëa£
,

515 
kobj_ty³
 
	gkty³_cdev_dyÇmic
 = {

516 .
»Ëa£
 = 
cdev_dyÇmic_»Ëa£
,

524 
cdev
 *
	$cdev_®loc
()

526 
cdev
 *
p
 = 
	`kz®loc
((cdev), 
GFP_KERNEL
);

527 ià(
p
) {

528 
	`INIT_LIST_HEAD
(&
p
->
li¡
);

529 
	`kobjeù_š™
(&
p
->
kobj
, &
kty³_cdev_dyÇmic
);

531  
p
;

532 
	}
}

542 
	$cdev_š™
(
cdev
 *cdev, cÚ¡ 
fe_İ”©iÚs
 *
fİs
)

544 
	`mem£t
(
cdev
, 0,  *cdev);

545 
	`INIT_LIST_HEAD
(&
cdev
->
li¡
);

546 
	`kobjeù_š™
(&
cdev
->
kobj
, &
kty³_cdev_deçuÉ
);

547 
cdev
->
İs
 = 
fİs
;

548 
	}
}

550 
kobjeù
 *
	$ba£_´obe
(
dev_t
 
dev
, *
·¹
, *
d©a
)

552 ià(
	`»que¡_moduË
("ch¬-majÜ-%d-%d", 
	`MAJOR
(
dev
), 
	`MINOR
(dev)) > 0)

554 
	`»que¡_moduË
("ch¬-majÜ-%d", 
	`MAJOR
(
dev
));

555  
NULL
;

556 
	}
}

558 
__š™
 
	$chrdev_š™
()

560 
cdev_m­
 = 
	`kobj_m­_š™
(
ba£_´obe
, &
chrdevs_lock
);

561 
	`bdi_š™
(&
dœeùly_m­·bË_cdev_bdi
);

562 
	}
}

566 
EXPORT_SYMBOL
(
»gi¡”_chrdev_»giÚ
);

567 
EXPORT_SYMBOL
(
uÄegi¡”_chrdev_»giÚ
);

568 
EXPORT_SYMBOL
(
®loc_chrdev_»giÚ
);

569 
EXPORT_SYMBOL
(
cdev_š™
);

570 
EXPORT_SYMBOL
(
cdev_®loc
);

571 
EXPORT_SYMBOL
(
cdev_d–
);

572 
EXPORT_SYMBOL
(
cdev_add
);

573 
EXPORT_SYMBOL
(
__»gi¡”_chrdev
);

574 
EXPORT_SYMBOL
(
__uÄegi¡”_chrdev
);

575 
EXPORT_SYMBOL
(
dœeùly_m­·bË_cdev_bdi
);

	@compat.c

18 
	~<lšux/¡ddef.h
>

19 
	~<lšux/k”Ãl.h
>

20 
	~<lšux/lškage.h
>

21 
	~<lšux/com·t.h
>

22 
	~<lšux/”ºo.h
>

23 
	~<lšux/time.h
>

24 
	~<lšux/fs.h
>

25 
	~<lšux/fú.h
>

26 
	~<lšux/Çmei.h
>

27 
	~<lšux/fe.h
>

28 
	~<lšux/fdbË.h
>

29 
	~<lšux/vfs.h
>

30 
	~<lšux/ioùl.h
>

31 
	~<lšux/š™.h
>

32 
	~<lšux/nı_mouÁ.h
>

33 
	~<lšux/nfs4_mouÁ.h
>

34 
	~<lšux/sysÿÎs.h
>

35 
	~<lšux/ùy³.h
>

36 
	~<lšux/moduË.h
>

37 
	~<lšux/dœ’t.h
>

38 
	~<lšux/f¢Ùify.h
>

39 
	~<lšux/highuid.h
>

40 
	~<lšux/³rsÚ®™y.h
>

41 
	~<lšux/rw£m.h
>

42 
	~<lšux/t§cù_k”n.h
>

43 
	~<lšux/£cur™y.h
>

44 
	~<lšux/highmem.h
>

45 
	~<lšux/sigÇl.h
>

46 
	~<lšux/pŞl.h
>

47 
	~<lšux/mm.h
>

48 
	~<lšux/ev’Şl.h
>

49 
	~<lšux/fs_¡ruù.h
>

50 
	~<lšux/¦ab.h
>

51 
	~<lšux/·gem­.h
>

53 
	~<asm/uacûss.h
>

54 
	~<asm/mmu_cÚ‹xt.h
>

55 
	~<asm/ioùls.h
>

56 
	~"š‹º®.h
"

58 
	gcom·t_log
 = 1;

60 
	$com·t_´štk
(cÚ¡ *
fmt
, ...)

62 
va_li¡
 
­
;

63 
»t
;

64 ià(!
com·t_log
)

66 
	`va_¡¬t
(
­
, 
fmt
);

67 
»t
 = 
	`v´štk
(
fmt
, 
­
);

68 
	`va_’d
(
­
);

69  
»t
;

70 
	}
}

72 
	~"»ad_wr™e.h
"

78 
asmlškage
 
	$com·t_sys_utime
(cÚ¡ 
__u£r
 *
f’ame
,

79 
com·t_utimbuf
 
__u£r
 *
t
)

81 
time¥ec
 
tv
[2];

83 ià(
t
) {

84 ià(
	`g‘_u£r
(
tv
[0].
tv_£c
, &
t
->
aùime
) ||

85 
	`g‘_u£r
(
tv
[1].
tv_£c
, &
t
->
modtime
))

86  -
EFAULT
;

87 
tv
[0].
tv_n£c
 = 0;

88 
tv
[1].
tv_n£c
 = 0;

90  
	`do_utimes
(
AT_FDCWD
, 
f’ame
, 
t
 ? 
tv
 : 
NULL
, 0);

91 
	}
}

93 
asmlškage
 
	$com·t_sys_utim’§t
(
dfd
, cÚ¡ 
__u£r
 *
f’ame
, 
com·t_time¥ec
 __u£¸*
t
, 
æags
)

95 
time¥ec
 
tv
[2];

97 ià(
t
) {

98 ià(
	`g‘_com·t_time¥ec
(&
tv
[0], &
t
[0]) ||

99 
	`g‘_com·t_time¥ec
(&
tv
[1], &
t
[1]))

100  -
EFAULT
;

102 ià(
tv
[0].
tv_n£c
 =ğ
UTIME_OMIT
 &&v[1].tv_nsec == UTIME_OMIT)

105  
	`do_utimes
(
dfd
, 
f’ame
, 
t
 ? 
tv
 : 
NULL
, 
æags
);

106 
	}
}

108 
asmlškage
 
	$com·t_sys_futime§t
(
dfd
, cÚ¡ 
__u£r
 *
f’ame
, 
com·t_timev®
 __u£¸*
t
)

110 
time¥ec
 
tv
[2];

112 ià(
t
) {

113 ià(
	`g‘_u£r
(
tv
[0].
tv_£c
, &
t
[0].tv_sec) ||

114 
	`g‘_u£r
(
tv
[0].
tv_n£c
, &
t
[0].
tv_u£c
) ||

115 
	`g‘_u£r
(
tv
[1].
tv_£c
, &
t
[1].tv_sec) ||

116 
	`g‘_u£r
(
tv
[1].
tv_n£c
, &
t
[1].
tv_u£c
))

117  -
EFAULT
;

118 ià(
tv
[0].
tv_n£c
 >= 1000000 ||v[0].tv_nsec < 0 ||

119 
tv
[1].
tv_n£c
 >= 1000000 ||v[1].tv_nsec < 0)

120  -
EINVAL
;

121 
tv
[0].
tv_n£c
 *= 1000;

122 
tv
[1].
tv_n£c
 *= 1000;

124  
	`do_utimes
(
dfd
, 
f’ame
, 
t
 ? 
tv
 : 
NULL
, 0);

125 
	}
}

127 
asmlškage
 
	$com·t_sys_utimes
(cÚ¡ 
__u£r
 *
f’ame
, 
com·t_timev®
 __u£¸*
t
)

129  
	`com·t_sys_futime§t
(
AT_FDCWD
, 
f’ame
, 
t
);

130 
	}
}

132 
	$ı_com·t_¡©
(
k¡©
 *
¡©
, 
com·t_¡©
 
__u£r
 *
ubuf
)

134 
com·t_šo_t
 
šo
 = 
¡©
->ino;

135 
	`ty³of
(
ubuf
->
¡_uid
è
uid
 = 0;

136 
	`ty³of
(
ubuf
->
¡_gid
è
gid
 = 0;

137 
”r
;

139 
	`SET_UID
(
uid
, 
¡©
->uid);

140 
	`SET_GID
(
gid
, 
¡©
->gid);

142 ià((
u64
è
¡©
->
size
 > 
MAX_NON_LFS
 ||

143 !
	`Şd_v®id_dev
(
¡©
->
dev
) ||

144 !
	`Şd_v®id_dev
(
¡©
->
rdev
))

145  -
EOVERFLOW
;

146 ià((
šo
è< (
¡©
->ino) && ino != stat->ino)

147  -
EOVERFLOW
;

149 ià(
	`ş—r_u£r
(
ubuf
, (*ubuf)))

150  -
EFAULT
;

152 
”r
 = 
	`__put_u£r
(
	`Şd_’code_dev
(
¡©
->
dev
), &
ubuf
->
¡_dev
);

153 
”r
 |ğ
	`__put_u£r
(
šo
, &
ubuf
->
¡_šo
);

154 
”r
 |ğ
	`__put_u£r
(
¡©
->
mode
, &
ubuf
->
¡_mode
);

155 
”r
 |ğ
	`__put_u£r
(
¡©
->
Æšk
, &
ubuf
->
¡_Æšk
);

156 
”r
 |ğ
	`__put_u£r
(
uid
, &
ubuf
->
¡_uid
);

157 
”r
 |ğ
	`__put_u£r
(
gid
, &
ubuf
->
¡_gid
);

158 
”r
 |ğ
	`__put_u£r
(
	`Şd_’code_dev
(
¡©
->
rdev
), &
ubuf
->
¡_rdev
);

159 
”r
 |ğ
	`__put_u£r
(
¡©
->
size
, &
ubuf
->
¡_size
);

160 
”r
 |ğ
	`__put_u£r
(
¡©
->
©ime
.
tv_£c
, &
ubuf
->
¡_©ime
);

161 
”r
 |ğ
	`__put_u£r
(
¡©
->
©ime
.
tv_n£c
, &
ubuf
->
¡_©ime_n£c
);

162 
”r
 |ğ
	`__put_u£r
(
¡©
->
mtime
.
tv_£c
, &
ubuf
->
¡_mtime
);

163 
”r
 |ğ
	`__put_u£r
(
¡©
->
mtime
.
tv_n£c
, &
ubuf
->
¡_mtime_n£c
);

164 
”r
 |ğ
	`__put_u£r
(
¡©
->
ùime
.
tv_£c
, &
ubuf
->
¡_ùime
);

165 
”r
 |ğ
	`__put_u£r
(
¡©
->
ùime
.
tv_n£c
, &
ubuf
->
¡_ùime_n£c
);

166 
”r
 |ğ
	`__put_u£r
(
¡©
->
blksize
, &
ubuf
->
¡_blksize
);

167 
”r
 |ğ
	`__put_u£r
(
¡©
->
blocks
, &
ubuf
->
¡_blocks
);

168  
”r
;

169 
	}
}

171 
asmlškage
 
	$com·t_sys_Ãw¡©
(cÚ¡ 
__u£r
 * 
f’ame
,

172 
com·t_¡©
 
__u£r
 *
¡©buf
)

174 
k¡©
 
¡©
;

175 
”rÜ
;

177 
”rÜ
 = 
	`vfs_¡©
(
f’ame
, &
¡©
);

178 ià(
”rÜ
)

179  
”rÜ
;

180  
	`ı_com·t_¡©
(&
¡©
, 
¡©buf
);

181 
	}
}

183 
asmlškage
 
	$com·t_sys_Ãwl¡©
(cÚ¡ 
__u£r
 * 
f’ame
,

184 
com·t_¡©
 
__u£r
 *
¡©buf
)

186 
k¡©
 
¡©
;

187 
”rÜ
;

189 
”rÜ
 = 
	`vfs_l¡©
(
f’ame
, &
¡©
);

190 ià(
”rÜ
)

191  
”rÜ
;

192  
	`ı_com·t_¡©
(&
¡©
, 
¡©buf
);

193 
	}
}

195 #iâdeà
__ARCH_WANT_STAT64


196 
asmlškage
 
	$com·t_sys_Ãwf¡©©
(
dfd
,

197 cÚ¡ 
__u£r
 *
f’ame
,

198 
com·t_¡©
 
__u£r
 *
¡©buf
, 
æag
)

200 
k¡©
 
¡©
;

201 
”rÜ
;

203 
”rÜ
 = 
	`vfs_f¡©©
(
dfd
, 
f’ame
, &
¡©
, 
æag
);

204 ià(
”rÜ
)

205  
”rÜ
;

206  
	`ı_com·t_¡©
(&
¡©
, 
¡©buf
);

207 
	}
}

210 
asmlškage
 
	$com·t_sys_Ãwf¡©
(
fd
,

211 
com·t_¡©
 
__u£r
 * 
¡©buf
)

213 
k¡©
 
¡©
;

214 
”rÜ
 = 
	`vfs_f¡©
(
fd
, &
¡©
);

216 ià(!
”rÜ
)

217 
”rÜ
 = 
	`ı_com·t_¡©
(&
¡©
, 
¡©buf
);

218  
”rÜ
;

219 
	}
}

221 
	$put_com·t_¡©fs
(
com·t_¡©fs
 
__u£r
 *
ubuf
, 
k¡©fs
 *
kbuf
)

224 ià( 
ubuf
->
f_blocks
 == 4) {

225 ià((
kbuf
->
f_blocks
 | kbuf->
f_bä“
 | kbuf->
f_bava
 |

226 
kbuf
->
f_bsize
 | kbuf->
f_äsize
) & 0xffffffff00000000ULL)

227  -
EOVERFLOW
;

230 ià(
kbuf
->
f_fes
 != 0xffffffffffffffffULL

231 && (
kbuf
->
f_fes
 & 0xffffffff00000000ULL))

232  -
EOVERFLOW
;

233 ià(
kbuf
->
f_fä“
 != 0xffffffffffffffffULL

234 && (
kbuf
->
f_fä“
 & 0xffffffff00000000ULL))

235  -
EOVERFLOW
;

237 ià(!
	`acûss_ok
(
VERIFY_WRITE
, 
ubuf
, (*ubuf)) ||

238 
	`__put_u£r
(
kbuf
->
f_ty³
, &
ubuf
->f_type) ||

239 
	`__put_u£r
(
kbuf
->
f_bsize
, &
ubuf
->f_bsize) ||

240 
	`__put_u£r
(
kbuf
->
f_blocks
, &
ubuf
->f_blocks) ||

241 
	`__put_u£r
(
kbuf
->
f_bä“
, &
ubuf
->f_bfree) ||

242 
	`__put_u£r
(
kbuf
->
f_bava
, &
ubuf
->f_bavail) ||

243 
	`__put_u£r
(
kbuf
->
f_fes
, &
ubuf
->f_files) ||

244 
	`__put_u£r
(
kbuf
->
f_fä“
, &
ubuf
->f_ffree) ||

245 
	`__put_u£r
(
kbuf
->
f_Çm–’
, &
ubuf
->f_namelen) ||

246 
	`__put_u£r
(
kbuf
->
f_fsid
.
v®
[0], &
ubuf
->f_fsid.val[0]) ||

247 
	`__put_u£r
(
kbuf
->
f_fsid
.
v®
[1], &
ubuf
->f_fsid.val[1]) ||

248 
	`__put_u£r
(
kbuf
->
f_äsize
, &
ubuf
->f_frsize) ||

249 
	`__put_u£r
(
kbuf
->
f_æags
, &
ubuf
->f_flags) ||

250 
	`__ş—r_u£r
(
ubuf
->
f_¥¬e
, (ubuf->f_spare)))

251  -
EFAULT
;

253 
	}
}

259 
asmlškage
 
	$com·t_sys_¡©fs
(cÚ¡ 
__u£r
 *
·thÇme
, 
com·t_¡©fs
 __u£¸*
buf
)

261 
k¡©fs
 
tmp
;

262 
”rÜ
 = 
	`u£r_¡©fs
(
·thÇme
, &
tmp
);

263 ià(!
”rÜ
)

264 
”rÜ
 = 
	`put_com·t_¡©fs
(
buf
, &
tmp
);

265  
”rÜ
;

266 
	}
}

268 
asmlškage
 
	$com·t_sys_f¡©fs
(
fd
, 
com·t_¡©fs
 
__u£r
 *
buf
)

270 
k¡©fs
 
tmp
;

271 
”rÜ
 = 
	`fd_¡©fs
(
fd
, &
tmp
);

272 ià(!
”rÜ
)

273 
”rÜ
 = 
	`put_com·t_¡©fs
(
buf
, &
tmp
);

274  
”rÜ
;

275 
	}
}

277 
	$put_com·t_¡©fs64
(
com·t_¡©fs64
 
__u£r
 *
ubuf
, 
k¡©fs
 *
kbuf
)

279 ià( 
ubuf
->
f_blocks
 == 4) {

280 ià((
kbuf
->
f_blocks
 | kbuf->
f_bä“
 | kbuf->
f_bava
 |

281 
kbuf
->
f_bsize
 | kbuf->
f_äsize
) & 0xffffffff00000000ULL)

282  -
EOVERFLOW
;

285 ià(
kbuf
->
f_fes
 != 0xffffffffffffffffULL

286 && (
kbuf
->
f_fes
 & 0xffffffff00000000ULL))

287  -
EOVERFLOW
;

288 ià(
kbuf
->
f_fä“
 != 0xffffffffffffffffULL

289 && (
kbuf
->
f_fä“
 & 0xffffffff00000000ULL))

290  -
EOVERFLOW
;

292 ià(!
	`acûss_ok
(
VERIFY_WRITE
, 
ubuf
, (*ubuf)) ||

293 
	`__put_u£r
(
kbuf
->
f_ty³
, &
ubuf
->f_type) ||

294 
	`__put_u£r
(
kbuf
->
f_bsize
, &
ubuf
->f_bsize) ||

295 
	`__put_u£r
(
kbuf
->
f_blocks
, &
ubuf
->f_blocks) ||

296 
	`__put_u£r
(
kbuf
->
f_bä“
, &
ubuf
->f_bfree) ||

297 
	`__put_u£r
(
kbuf
->
f_bava
, &
ubuf
->f_bavail) ||

298 
	`__put_u£r
(
kbuf
->
f_fes
, &
ubuf
->f_files) ||

299 
	`__put_u£r
(
kbuf
->
f_fä“
, &
ubuf
->f_ffree) ||

300 
	`__put_u£r
(
kbuf
->
f_Çm–’
, &
ubuf
->f_namelen) ||

301 
	`__put_u£r
(
kbuf
->
f_fsid
.
v®
[0], &
ubuf
->f_fsid.val[0]) ||

302 
	`__put_u£r
(
kbuf
->
f_fsid
.
v®
[1], &
ubuf
->f_fsid.val[1]) ||

303 
	`__put_u£r
(
kbuf
->
f_äsize
, &
ubuf
->f_frsize) ||

304 
	`__put_u£r
(
kbuf
->
f_æags
, &
ubuf
->f_flags) ||

305 
	`__ş—r_u£r
(
ubuf
->
f_¥¬e
, (ubuf->f_spare)))

306  -
EFAULT
;

308 
	}
}

310 
asmlškage
 
	$com·t_sys_¡©fs64
(cÚ¡ 
__u£r
 *
·thÇme
, 
com·t_size_t
 
sz
, 
com·t_¡©fs64
 __u£¸*
buf
)

312 
k¡©fs
 
tmp
;

313 
”rÜ
;

315 ià(
sz
 !ğ(*
buf
))

316  -
EINVAL
;

318 
”rÜ
 = 
	`u£r_¡©fs
(
·thÇme
, &
tmp
);

319 ià(!
”rÜ
)

320 
”rÜ
 = 
	`put_com·t_¡©fs64
(
buf
, &
tmp
);

321  
”rÜ
;

322 
	}
}

324 
asmlškage
 
	$com·t_sys_f¡©fs64
(
fd
, 
com·t_size_t
 
sz
, 
com·t_¡©fs64
 
__u£r
 *
buf
)

326 
k¡©fs
 
tmp
;

327 
”rÜ
;

329 ià(
sz
 !ğ(*
buf
))

330  -
EINVAL
;

332 
”rÜ
 = 
	`fd_¡©fs
(
fd
, &
tmp
);

333 ià(!
”rÜ
)

334 
”rÜ
 = 
	`put_com·t_¡©fs64
(
buf
, &
tmp
);

335  
”rÜ
;

336 
	}
}

343 
asmlškage
 
	$com·t_sys_u¡©
(
dev
, 
com·t_u¡©
 
__u£r
 *
u
)

345 
su³r_block
 *
sb
;

346 
com·t_u¡©
 
tmp
;

347 
k¡©fs
 
sbuf
;

348 
”r
;

350 
sb
 = 
	`u£r_g‘_su³r
(
	`Ãw_decode_dev
(
dev
));

351 ià(!
sb
)

352  -
EINVAL
;

353 
”r
 = 
	`¡©fs_by_d’Œy
(
sb
->
s_roÙ
, &
sbuf
);

354 
	`drİ_su³r
(
sb
);

355 ià(
”r
)

356  
”r
;

358 
	`mem£t
(&
tmp
, 0, (
com·t_u¡©
));

359 
tmp
.
f_tä“
 = 
sbuf
.
f_bä“
;

360 
tmp
.
f_tšode
 = 
sbuf
.
f_fä“
;

361 ià(
	`cİy_to_u£r
(
u
, &
tmp
, (
com·t_u¡©
)))

362  -
EFAULT
;

364 
	}
}

366 
	$g‘_com·t_æock
(
æock
 *
kæ
, 
com·t_æock
 
__u£r
 *
uæ
)

368 ià(!
	`acûss_ok
(
VERIFY_READ
, 
uæ
, (*ufl)) ||

369 
	`__g‘_u£r
(
kæ
->
l_ty³
, &
uæ
->l_type) ||

370 
	`__g‘_u£r
(
kæ
->
l_wh’û
, &
uæ
->l_whence) ||

371 
	`__g‘_u£r
(
kæ
->
l_¡¬t
, &
uæ
->l_start) ||

372 
	`__g‘_u£r
(
kæ
->
l_Ën
, &
uæ
->l_len) ||

373 
	`__g‘_u£r
(
kæ
->
l_pid
, &
uæ
->l_pid))

374  -
EFAULT
;

376 
	}
}

378 
	$put_com·t_æock
(
æock
 *
kæ
, 
com·t_æock
 
__u£r
 *
uæ
)

380 ià(!
	`acûss_ok
(
VERIFY_WRITE
, 
uæ
, (*ufl)) ||

381 
	`__put_u£r
(
kæ
->
l_ty³
, &
uæ
->l_type) ||

382 
	`__put_u£r
(
kæ
->
l_wh’û
, &
uæ
->l_whence) ||

383 
	`__put_u£r
(
kæ
->
l_¡¬t
, &
uæ
->l_start) ||

384 
	`__put_u£r
(
kæ
->
l_Ën
, &
uæ
->l_len) ||

385 
	`__put_u£r
(
kæ
->
l_pid
, &
uæ
->l_pid))

386  -
EFAULT
;

388 
	}
}

390 #iâdeà
HAVE_ARCH_GET_COMPAT_FLOCK64


391 
	$g‘_com·t_æock64
(
æock
 *
kæ
, 
com·t_æock64
 
__u£r
 *
uæ
)

393 ià(!
	`acûss_ok
(
VERIFY_READ
, 
uæ
, (*ufl)) ||

394 
	`__g‘_u£r
(
kæ
->
l_ty³
, &
uæ
->l_type) ||

395 
	`__g‘_u£r
(
kæ
->
l_wh’û
, &
uæ
->l_whence) ||

396 
	`__g‘_u£r
(
kæ
->
l_¡¬t
, &
uæ
->l_start) ||

397 
	`__g‘_u£r
(
kæ
->
l_Ën
, &
uæ
->l_len) ||

398 
	`__g‘_u£r
(
kæ
->
l_pid
, &
uæ
->l_pid))

399  -
EFAULT
;

401 
	}
}

404 #iâdeà
HAVE_ARCH_PUT_COMPAT_FLOCK64


405 
	$put_com·t_æock64
(
æock
 *
kæ
, 
com·t_æock64
 
__u£r
 *
uæ
)

407 ià(!
	`acûss_ok
(
VERIFY_WRITE
, 
uæ
, (*ufl)) ||

408 
	`__put_u£r
(
kæ
->
l_ty³
, &
uæ
->l_type) ||

409 
	`__put_u£r
(
kæ
->
l_wh’û
, &
uæ
->l_whence) ||

410 
	`__put_u£r
(
kæ
->
l_¡¬t
, &
uæ
->l_start) ||

411 
	`__put_u£r
(
kæ
->
l_Ën
, &
uæ
->l_len) ||

412 
	`__put_u£r
(
kæ
->
l_pid
, &
uæ
->l_pid))

413  -
EFAULT
;

415 
	}
}

418 
asmlškage
 
	$com·t_sys_fú64
(
fd
, 
cmd
,

419 
¬g
)

421 
mm_£gm’t_t
 
Şd_fs
;

422 
æock
 
f
;

423 
»t
;

425 
cmd
) {

426 
F_GETLK
:

427 
F_SETLK
:

428 
F_SETLKW
:

429 
»t
 = 
	`g‘_com·t_æock
(&
f
, 
	`com·t_±r
(
¬g
));

430 ià(
»t
 != 0)

432 
Şd_fs
 = 
	`g‘_fs
();

433 
	`£t_fs
(
KERNEL_DS
);

434 
»t
 = 
	`sys_fú
(
fd
, 
cmd
, ()&
f
);

435 
	`£t_fs
(
Şd_fs
);

436 ià(
cmd
 =ğ
F_GETLK
 && 
»t
 == 0) {

448 ià(
f
.
l_¡¬t
 > 
COMPAT_OFF_T_MAX
)

449 
»t
 = -
EOVERFLOW
;

450 ià(
f
.
l_Ën
 > 
COMPAT_OFF_T_MAX
)

451 
f
.
l_Ën
 = 
COMPAT_OFF_T_MAX
;

452 ià(
»t
 == 0)

453 
»t
 = 
	`put_com·t_æock
(&
f
, 
	`com·t_±r
(
¬g
));

457 
F_GETLK64
:

458 
F_SETLK64
:

459 
F_SETLKW64
:

460 
»t
 = 
	`g‘_com·t_æock64
(&
f
, 
	`com·t_±r
(
¬g
));

461 ià(
»t
 != 0)

463 
Şd_fs
 = 
	`g‘_fs
();

464 
	`£t_fs
(
KERNEL_DS
);

465 
»t
 = 
	`sys_fú
(
fd
, (
cmd
 =ğ
F_GETLK64
è? 
F_GETLK
 :

466 ((
cmd
 =ğ
F_SETLK64
è? 
F_SETLK
 : 
F_SETLKW
),

467 ()&
f
);

468 
	`£t_fs
(
Şd_fs
);

469 ià(
cmd
 =ğ
F_GETLK64
 && 
»t
 == 0) {

471 ià(
f
.
l_¡¬t
 > 
COMPAT_LOFF_T_MAX
)

472 
»t
 = -
EOVERFLOW
;

473 ià(
f
.
l_Ën
 > 
COMPAT_LOFF_T_MAX
)

474 
f
.
l_Ën
 = 
COMPAT_LOFF_T_MAX
;

475 ià(
»t
 == 0)

476 
»t
 = 
	`put_com·t_æock64
(&
f
, 
	`com·t_±r
(
¬g
));

481 
»t
 = 
	`sys_fú
(
fd
, 
cmd
, 
¬g
);

484  
»t
;

485 
	}
}

487 
asmlškage
 
	$com·t_sys_fú
(
fd
, 
cmd
,

488 
¬g
)

490 ià((
cmd
 =ğ
F_GETLK64
è|| (cmd =ğ
F_SETLK64
è|| (cmd =ğ
F_SETLKW64
))

491  -
EINVAL
;

492  
	`com·t_sys_fú64
(
fd
, 
cmd
, 
¬g
);

493 
	}
}

495 
asmlškage
 

496 
	$com·t_sys_io_£tup
(
Ä_»qs
, 
u32
 
__u£r
 *
ùx32p
)

498 
»t
;

499 
aio_cÚ‹xt_t
 
ùx64
;

501 
mm_£gm’t_t
 
Şdfs
 = 
	`g‘_fs
();

502 ià(
	`uÆik–y
(
	`g‘_u£r
(
ùx64
, 
ùx32p
)))

503  -
EFAULT
;

505 
	`£t_fs
(
KERNEL_DS
);

507 
»t
 = 
	`sys_io_£tup
(
Ä_»qs
, (
aio_cÚ‹xt_t
 
__u£r
 *è&
ùx64
);

508 
	`£t_fs
(
Şdfs
);

510 ià(!
»t
)

511 
»t
 = 
	`put_u£r
((
u32
è
ùx64
, 
ùx32p
);

512  
»t
;

513 
	}
}

515 
asmlškage
 

516 
	$com·t_sys_io_g‘ev’ts
(
aio_cÚ‹xt_t
 
ùx_id
,

517 
mš_Ä
,

518 
Ä
,

519 
io_ev’t
 
__u£r
 *
ev’ts
,

520 
com·t_time¥ec
 
__u£r
 *
timeout
)

522 
»t
;

523 
time¥ec
 
t
;

524 
time¥ec
 
__u£r
 *
ut
 = 
NULL
;

526 
»t
 = -
EFAULT
;

527 ià(
	`uÆik–y
(!
	`acûss_ok
(
VERIFY_WRITE
, 
ev’ts
,

528 
Ä
 * (
io_ev’t
))))

529 
out
;

530 ià(
timeout
) {

531 ià(
	`g‘_com·t_time¥ec
(&
t
, 
timeout
))

532 
out
;

534 
ut
 = 
	`com·t_®loc_u£r_¥aû
((*ut));

535 ià(
	`cİy_to_u£r
(
ut
, &
t
, (t)) )

536 
out
;

538 
»t
 = 
	`sys_io_g‘ev’ts
(
ùx_id
, 
mš_Ä
, 
Ä
, 
ev’ts
, 
ut
);

539 
out
:

540  
»t
;

541 
	}
}

544 
	#vrfy_dœ
(
ty³
è(Ñy³è=ğ
READ
 ? 
VERIFY_WRITE
 : 
VERIFY_READ
)

	)

546 
ssize_t
 
	$com·t_rw_cİy_check_uveùÜ
(
ty³
,

547 cÚ¡ 
com·t_iovec
 
__u£r
 *
uveùÜ
, 
Ä_£gs
,

548 
ç¡_£gs
, 
iovec
 *
ç¡_poš‹r
,

549 
iovec
 **
»t_poš‹r
, 
check_acûss
)

551 
com·t_ssize_t
 
tÙ_Ën
;

552 
iovec
 *
iov
 = *
»t_poš‹r
 = 
ç¡_poš‹r
;

553 
ssize_t
 
»t
 = 0;

554 
£g
;

561 ià(
Ä_£gs
 == 0)

562 
out
;

564 
»t
 = -
EINVAL
;

565 ià(
Ä_£gs
 > 
UIO_MAXIOV
 ||‚r_segs < 0)

566 
out
;

567 ià(
Ä_£gs
 > 
ç¡_£gs
) {

568 
»t
 = -
ENOMEM
;

569 
iov
 = 
	`km®loc
(
Ä_£gs
*(
iovec
), 
GFP_KERNEL
);

570 ià(
iov
 =ğ
NULL
)

571 
out
;

573 *
»t_poš‹r
 = 
iov
;

583 
tÙ_Ën
 = 0;

584 
»t
 = -
EINVAL
;

585 
£g
 = 0; seg < 
Ä_£gs
; seg++) {

586 
com·t_u±r_t
 
buf
;

587 
com·t_ssize_t
 
Ën
;

589 ià(
	`__g‘_u£r
(
Ën
, &
uveùÜ
->
iov_Ën
) ||

590 
	`__g‘_u£r
(
buf
, &
uveùÜ
->
iov_ba£
)) {

591 
»t
 = -
EFAULT
;

592 
out
;

594 ià(
Ën
 < 0)

595 
out
;

596 ià(
check_acûss
 &&

597 !
	`acûss_ok
(
	`vrfy_dœ
(
ty³
), 
	`com·t_±r
(
buf
), 
Ën
)) {

598 
»t
 = -
EFAULT
;

599 
out
;

601 ià(
Ën
 > 
MAX_RW_COUNT
 - 
tÙ_Ën
)

602 
Ën
 = 
MAX_RW_COUNT
 - 
tÙ_Ën
;

603 
tÙ_Ën
 +ğ
Ën
;

604 
iov
->
iov_ba£
 = 
	`com·t_±r
(
buf
);

605 
iov
->
iov_Ën
 = (
com·t_size_t
è
Ën
;

606 
uveùÜ
++;

607 
iov
++;

609 
»t
 = 
tÙ_Ën
;

611 
out
:

612  
»t
;

613 
	}
}

615 
šlše
 

616 
	$cİy_iocb
(
Ä
, 
u32
 
__u£r
 *
±r32
, 
iocb
 __u£¸* __u£¸*
±r64
)

618 
com·t_u±r_t
 
u±r
;

619 
i
;

621 
i
 = 0; i < 
Ä
; ++i) {

622 ià(
	`g‘_u£r
(
u±r
, 
±r32
 + 
i
))

623  -
EFAULT
;

624 ià(
	`put_u£r
(
	`com·t_±r
(
u±r
), 
±r64
 + 
i
))

625  -
EFAULT
;

628 
	}
}

630 
	#MAX_AIO_SUBMITS
 (
PAGE_SIZE
/(
iocb
 *))

	)

632 
asmlškage
 

633 
	$com·t_sys_io_subm™
(
aio_cÚ‹xt_t
 
ùx_id
, 
Ä
, 
u32
 
__u£r
 *
iocb
)

635 
iocb
 
__u£r
 * __u£¸*
iocb64
;

636 
»t
;

638 ià(
	`uÆik–y
(
Ä
 < 0))

639  -
EINVAL
;

641 ià(
Ä
 > 
MAX_AIO_SUBMITS
)

642 
Ä
 = 
MAX_AIO_SUBMITS
;

644 
iocb64
 = 
	`com·t_®loc_u£r_¥aû
(
Ä
 * (*iocb64));

645 
»t
 = 
	`cİy_iocb
(
Ä
, 
iocb
, 
iocb64
);

646 ià(!
»t
)

647 
»t
 = 
	`do_io_subm™
(
ùx_id
, 
Ä
, 
iocb64
, 1);

648  
»t
;

649 
	}
}

651 
	scom·t_nı_mouÁ_d©a
 {

652 
com·t_št_t
 
	mv”siÚ
;

653 
com·t_ušt_t
 
	mnı_fd
;

654 
__com·t_uid_t
 
	mmouÁed_uid
;

655 
com·t_pid_t
 
	mwdog_pid
;

656 
	mmouÁed_vŞ
[
NCP_VOLNAME_LEN
 + 1];

657 
com·t_ušt_t
 
	mtime_out
;

658 
com·t_ušt_t
 
	m»Œy_couÁ
;

659 
com·t_ušt_t
 
	mæags
;

660 
__com·t_uid_t
 
	muid
;

661 
__com·t_gid_t
 
	mgid
;

662 
com·t_mode_t
 
	mfe_mode
;

663 
com·t_mode_t
 
	mdœ_mode
;

666 
	scom·t_nı_mouÁ_d©a_v4
 {

667 
com·t_št_t
 
	mv”siÚ
;

668 
com·t_ulÚg_t
 
	mæags
;

669 
com·t_ulÚg_t
 
	mmouÁed_uid
;

670 
com·t_lÚg_t
 
	mwdog_pid
;

671 
com·t_ušt_t
 
	mnı_fd
;

672 
com·t_ušt_t
 
	mtime_out
;

673 
com·t_ušt_t
 
	m»Œy_couÁ
;

674 
com·t_ulÚg_t
 
	muid
;

675 
com·t_ulÚg_t
 
	mgid
;

676 
com·t_ulÚg_t
 
	mfe_mode
;

677 
com·t_ulÚg_t
 
	mdœ_mode
;

680 *
	$do_nı_su³r_d©a_cÚv
(*
¿w_d©a
)

682 
v”siÚ
 = *(*)
¿w_d©a
;

684 ià(
v”siÚ
 == 3) {

685 
com·t_nı_mouÁ_d©a
 *
c_n
 = 
¿w_d©a
;

686 
nı_mouÁ_d©a
 *
n
 = 
¿w_d©a
;

688 
n
->
dœ_mode
 = 
c_n
->dir_mode;

689 
n
->
fe_mode
 = 
c_n
->file_mode;

690 
n
->
gid
 = 
c_n
->gid;

691 
n
->
uid
 = 
c_n
->uid;

692 
	`memmove
 (
n
->
mouÁed_vŞ
, 
c_n
->mounted_vol, ( (c_n->mounted_vol) + 3 *  ()));

693 
n
->
wdog_pid
 = 
c_n
->wdog_pid;

694 
n
->
mouÁed_uid
 = 
c_n
->mounted_uid;

695 } ià(
v”siÚ
 == 4) {

696 
com·t_nı_mouÁ_d©a_v4
 *
c_n
 = 
¿w_d©a
;

697 
nı_mouÁ_d©a_v4
 *
n
 = 
¿w_d©a
;

699 
n
->
dœ_mode
 = 
c_n
->dir_mode;

700 
n
->
fe_mode
 = 
c_n
->file_mode;

701 
n
->
gid
 = 
c_n
->gid;

702 
n
->
uid
 = 
c_n
->uid;

703 
n
->
»Œy_couÁ
 = 
c_n
->retry_count;

704 
n
->
time_out
 = 
c_n
->time_out;

705 
n
->
nı_fd
 = 
c_n
->ncp_fd;

706 
n
->
wdog_pid
 = 
c_n
->wdog_pid;

707 
n
->
mouÁed_uid
 = 
c_n
->mounted_uid;

708 
n
->
æags
 = 
c_n
->flags;

709 } ià(
v”siÚ
 != 5) {

710  
NULL
;

713  
¿w_d©a
;

714 
	}
}

717 
	scom·t_nfs_¡ršg
 {

718 
com·t_ušt_t
 
	mËn
;

719 
com·t_u±r_t
 
	md©a
;

722 
šlše
 
	$com·t_nfs_¡ršg
(
nfs_¡ršg
 *
d¡
,

723 
com·t_nfs_¡ršg
 *
¤c
)

725 
d¡
->
d©a
 = 
	`com·t_±r
(
¤c
->data);

726 
d¡
->
Ën
 = 
¤c
->len;

727 
	}
}

729 
	scom·t_nfs4_mouÁ_d©a_v1
 {

730 
com·t_št_t
 
	mv”siÚ
;

731 
com·t_št_t
 
	mæags
;

732 
com·t_št_t
 
	mrsize
;

733 
com·t_št_t
 
	mwsize
;

734 
com·t_št_t
 
	mtimeo
;

735 
com·t_št_t
 
	m»Œªs
;

736 
com·t_št_t
 
	maüegmš
;

737 
com·t_št_t
 
	maüegmax
;

738 
com·t_št_t
 
	macdœmš
;

739 
com·t_št_t
 
	macdœmax
;

740 
com·t_nfs_¡ršg
 
	mş›Á_addr
;

741 
com·t_nfs_¡ršg
 
	mmÁ_·th
;

742 
com·t_nfs_¡ršg
 
	mho¡Çme
;

743 
com·t_ušt_t
 
	mho¡_add¾’
;

744 
com·t_u±r_t
 
	mho¡_addr
;

745 
com·t_št_t
 
	m´Ùo
;

746 
com·t_št_t
 
	mauth_æavou¾’
;

747 
com·t_u±r_t
 
	mauth_æavours
;

750 
	$do_nfs4_su³r_d©a_cÚv
(*
¿w_d©a
)

752 
v”siÚ
 = *(
com·t_ušt_t
 *è
¿w_d©a
;

754 ià(
v”siÚ
 == 1) {

755 
com·t_nfs4_mouÁ_d©a_v1
 *
¿w
 = 
¿w_d©a
;

756 
nfs4_mouÁ_d©a
 *
»®
 = 
¿w_d©a
;

759 
»®
->
auth_æavours
 = 
	`com·t_±r
(
¿w
->auth_flavours);

760 
»®
->
auth_æavou¾’
 = 
¿w
->auth_flavourlen;

761 
»®
->
´Ùo
 = 
¿w
->proto;

762 
»®
->
ho¡_addr
 = 
	`com·t_±r
(
¿w
->host_addr);

763 
»®
->
ho¡_add¾’
 = 
¿w
->host_addrlen;

764 
	`com·t_nfs_¡ršg
(&
»®
->
ho¡Çme
, &
¿w
->hostname);

765 
	`com·t_nfs_¡ršg
(&
»®
->
mÁ_·th
, &
¿w
->mnt_path);

766 
	`com·t_nfs_¡ršg
(&
»®
->
ş›Á_addr
, &
¿w
->client_addr);

767 
»®
->
acdœmax
 = 
¿w
->acdirmax;

768 
»®
->
acdœmš
 = 
¿w
->acdirmin;

769 
»®
->
aüegmax
 = 
¿w
->acregmax;

770 
»®
->
aüegmš
 = 
¿w
->acregmin;

771 
»®
->
»Œªs
 = 
¿w
->retrans;

772 
»®
->
timeo
 = 
¿w
->timeo;

773 
»®
->
wsize
 = 
¿w
->wsize;

774 
»®
->
rsize
 = 
¿w
->rsize;

775 
»®
->
æags
 = 
¿w
->flags;

776 
»®
->
v”siÚ
 = 
¿w
->version;

780 
	}
}

782 
	#NCPFS_NAME
 "nıfs"

	)

783 
	#NFS4_NAME
 "nfs4"

	)

785 
asmlškage
 
	$com·t_sys_mouÁ
(cÚ¡ 
__u£r
 * 
dev_Çme
,

786 cÚ¡ 
__u£r
 * 
dœ_Çme
,

787 cÚ¡ 
__u£r
 * 
ty³
, 
æags
,

788 cÚ¡ 
__u£r
 * 
d©a
)

790 *
k”Ãl_ty³
;

791 
d©a_·ge
;

792 *
k”Ãl_dev
;

793 *
dœ_·ge
;

794 
»tv®
;

796 
»tv®
 = 
	`cİy_mouÁ_¡ršg
(
ty³
, &
k”Ãl_ty³
);

797 ià(
»tv®
 < 0)

798 
out
;

800 
dœ_·ge
 = 
	`g‘Çme
(
dœ_Çme
);

801 
»tv®
 = 
	`PTR_ERR
(
dœ_·ge
);

802 ià(
	`IS_ERR
(
dœ_·ge
))

803 
out1
;

805 
»tv®
 = 
	`cİy_mouÁ_¡ršg
(
dev_Çme
, &
k”Ãl_dev
);

806 ià(
»tv®
 < 0)

807 
out2
;

809 
»tv®
 = 
	`cİy_mouÁ_İtiÚs
(
d©a
, &
d©a_·ge
);

810 ià(
»tv®
 < 0)

811 
out3
;

813 
»tv®
 = -
EINVAL
;

815 ià(
k”Ãl_ty³
 && 
d©a_·ge
) {

816 ià(!
	`¡rcmp
(
k”Ãl_ty³
, 
NCPFS_NAME
)) {

817 
	`do_nı_su³r_d©a_cÚv
((*)
d©a_·ge
);

818 } ià(!
	`¡rcmp
(
k”Ãl_ty³
, 
NFS4_NAME
)) {

819 ià(
	`do_nfs4_su³r_d©a_cÚv
((*è
d©a_·ge
))

820 
out4
;

824 
»tv®
 = 
	`do_mouÁ
(
k”Ãl_dev
, 
dœ_·ge
, 
k”Ãl_ty³
,

825 
æags
, (*)
d©a_·ge
);

827 
out4
:

828 
	`ä“_·ge
(
d©a_·ge
);

829 
out3
:

830 
	`kä“
(
k”Ãl_dev
);

831 
out2
:

832 
	`puŠame
(
dœ_·ge
);

833 
out1
:

834 
	`kä“
(
k”Ãl_ty³
);

835 
out
:

836  
»tv®
;

837 
	}
}

839 
	scom·t_Şd_lšux_dœ’t
 {

840 
com·t_ulÚg_t
 
	md_šo
;

841 
com·t_ulÚg_t
 
	md_off£t
;

842 
	md_ÇmËn
;

843 
	md_Çme
[1];

846 
	scom·t_»addœ_ÿÎback
 {

847 
com·t_Şd_lšux_dœ’t
 
__u£r
 *
	mdœ’t
;

848 
	m»suÉ
;

851 
	$com·t_flÚedœ
(*
__buf
, cÚ¡ *
Çme
, 
ÇmËn
,

852 
loff_t
 
off£t
, 
u64
 
šo
, 
d_ty³
)

854 
com·t_»addœ_ÿÎback
 *
buf
 = 
__buf
;

855 
com·t_Şd_lšux_dœ’t
 
__u£r
 *
dœ’t
;

856 
com·t_ulÚg_t
 
d_šo
;

858 ià(
buf
->
»suÉ
)

859  -
EINVAL
;

860 
d_šo
 = 
šo
;

861 ià((
d_šo
è< (
šo
) && d_ino != ino) {

862 
buf
->
»suÉ
 = -
EOVERFLOW
;

863  -
EOVERFLOW
;

865 
buf
->
»suÉ
++;

866 
dœ’t
 = 
buf
->dirent;

867 ià(!
	`acûss_ok
(
VERIFY_WRITE
, 
dœ’t
,

868 ()(
dœ’t
->
d_Çme
 + 
ÇmËn
 + 1) -

869 ()
dœ’t
))

870 
eçuÉ
;

871 iàĞ
	`__put_u£r
(
d_šo
, &
dœ’t
->d_ino) ||

872 
	`__put_u£r
(
off£t
, &
dœ’t
->
d_off£t
) ||

873 
	`__put_u£r
(
ÇmËn
, &
dœ’t
->
d_ÇmËn
) ||

874 
	`__cİy_to_u£r
(
dœ’t
->
d_Çme
, 
Çme
, 
ÇmËn
) ||

875 
	`__put_u£r
(0, 
dœ’t
->
d_Çme
 + 
ÇmËn
))

876 
eçuÉ
;

878 
eçuÉ
:

879 
buf
->
»suÉ
 = -
EFAULT
;

880  -
EFAULT
;

881 
	}
}

883 
asmlškage
 
	$com·t_sys_Şd_»addœ
(
fd
,

884 
com·t_Şd_lšux_dœ’t
 
__u£r
 *
dœ’t
, 
couÁ
)

886 
”rÜ
;

887 
fe
 *file;

888 
com·t_»addœ_ÿÎback
 
buf
;

890 
”rÜ
 = -
EBADF
;

891 
fe
 = 
	`fg‘
(
fd
);

892 ià(!
fe
)

893 
out
;

895 
buf
.
»suÉ
 = 0;

896 
buf
.
dœ’t
 = dirent;

898 
”rÜ
 = 
	`vfs_»addœ
(
fe
, 
com·t_flÚedœ
, &
buf
);

899 ià(
buf
.
»suÉ
)

900 
”rÜ
 = 
buf
.
»suÉ
;

902 
	`åut
(
fe
);

903 
out
:

904  
”rÜ
;

905 
	}
}

907 
	scom·t_lšux_dœ’t
 {

908 
com·t_ulÚg_t
 
	md_šo
;

909 
com·t_ulÚg_t
 
	md_off
;

910 
	md_»ş’
;

911 
	md_Çme
[1];

914 
	scom·t_g‘d’ts_ÿÎback
 {

915 
com·t_lšux_dœ’t
 
__u£r
 *
	mcu¼’t_dœ
;

916 
com·t_lšux_dœ’t
 
__u£r
 *
	m´evious
;

917 
	mcouÁ
;

918 
	m”rÜ
;

921 
	$com·t_fldœ
(*
__buf
, cÚ¡ *
Çme
, 
ÇmËn
,

922 
loff_t
 
off£t
, 
u64
 
šo
, 
d_ty³
)

924 
com·t_lšux_dœ’t
 
__u£r
 * 
dœ’t
;

925 
com·t_g‘d’ts_ÿÎback
 *
buf
 = 
__buf
;

926 
com·t_ulÚg_t
 
d_šo
;

927 
»ş’
 = 
	`ALIGN
(
	`off£tof
(
com·t_lšux_dœ’t
, 
d_Çme
) +

928 
ÇmËn
 + 2, (
com·t_lÚg_t
));

930 
buf
->
”rÜ
 = -
EINVAL
;

931 ià(
»ş’
 > 
buf
->
couÁ
)

932  -
EINVAL
;

933 
d_šo
 = 
šo
;

934 ià((
d_šo
è< (
šo
) && d_ino != ino) {

935 
buf
->
”rÜ
 = -
EOVERFLOW
;

936  -
EOVERFLOW
;

938 
dœ’t
 = 
buf
->
´evious
;

939 ià(
dœ’t
) {

940 ià(
	`__put_u£r
(
off£t
, &
dœ’t
->
d_off
))

941 
eçuÉ
;

943 
dœ’t
 = 
buf
->
cu¼’t_dœ
;

944 ià(
	`__put_u£r
(
d_šo
, &
dœ’t
->d_ino))

945 
eçuÉ
;

946 ià(
	`__put_u£r
(
»ş’
, &
dœ’t
->
d_»ş’
))

947 
eçuÉ
;

948 ià(
	`cİy_to_u£r
(
dœ’t
->
d_Çme
, 
Çme
, 
ÇmËn
))

949 
eçuÉ
;

950 ià(
	`__put_u£r
(0, 
dœ’t
->
d_Çme
 + 
ÇmËn
))

951 
eçuÉ
;

952 ià(
	`__put_u£r
(
d_ty³
, (
__u£r
 *è
dœ’t
 + 
»ş’
 - 1))

953 
eçuÉ
;

954 
buf
->
´evious
 = 
dœ’t
;

955 
dœ’t
 = (
__u£r
 *)dœ’ˆ+ 
»ş’
;

956 
buf
->
cu¼’t_dœ
 = 
dœ’t
;

957 
buf
->
couÁ
 -ğ
»ş’
;

959 
eçuÉ
:

960 
buf
->
”rÜ
 = -
EFAULT
;

961  -
EFAULT
;

962 
	}
}

964 
asmlškage
 
	$com·t_sys_g‘d’ts
(
fd
,

965 
com·t_lšux_dœ’t
 
__u£r
 *
dœ’t
, 
couÁ
)

967 
fe
 * file;

968 
com·t_lšux_dœ’t
 
__u£r
 * 
Ï¡dœ’t
;

969 
com·t_g‘d’ts_ÿÎback
 
buf
;

970 
”rÜ
;

972 
”rÜ
 = -
EFAULT
;

973 ià(!
	`acûss_ok
(
VERIFY_WRITE
, 
dœ’t
, 
couÁ
))

974 
out
;

976 
”rÜ
 = -
EBADF
;

977 
fe
 = 
	`fg‘
(
fd
);

978 ià(!
fe
)

979 
out
;

981 
buf
.
cu¼’t_dœ
 = 
dœ’t
;

982 
buf
.
´evious
 = 
NULL
;

983 
buf
.
couÁ
 = count;

984 
buf
.
”rÜ
 = 0;

986 
”rÜ
 = 
	`vfs_»addœ
(
fe
, 
com·t_fldœ
, &
buf
);

987 ià(
”rÜ
 >= 0)

988 
”rÜ
 = 
buf
.error;

989 
Ï¡dœ’t
 = 
buf
.
´evious
;

990 ià(
Ï¡dœ’t
) {

991 ià(
	`put_u£r
(
fe
->
f_pos
, &
Ï¡dœ’t
->
d_off
))

992 
”rÜ
 = -
EFAULT
;

994 
”rÜ
 = 
couÁ
 - 
buf
.count;

996 
	`åut
(
fe
);

997 
out
:

998  
”rÜ
;

999 
	}
}

1001 #iâdeà
__ARCH_OMIT_COMPAT_SYS_GETDENTS64


1003 
	scom·t_g‘d’ts_ÿÎback64
 {

1004 
lšux_dœ’t64
 
__u£r
 *
	mcu¼’t_dœ
;

1005 
lšux_dœ’t64
 
__u£r
 *
	m´evious
;

1006 
	mcouÁ
;

1007 
	m”rÜ
;

1010 
	$com·t_fldœ64
(* 
__buf
, cÚ¡ * 
Çme
, 
ÇmËn
, 
loff_t
 
off£t
,

1011 
u64
 
šo
, 
d_ty³
)

1013 
lšux_dœ’t64
 
__u£r
 *
dœ’t
;

1014 
com·t_g‘d’ts_ÿÎback64
 *
buf
 = 
__buf
;

1015 
»ş’
 = 
	`ALIGN
(
	`off£tof
(
lšux_dœ’t64
, 
d_Çme
è+ 
ÇmËn
 + 1,

1016 (
u64
));

1017 
u64
 
off
;

1019 
buf
->
”rÜ
 = -
EINVAL
;

1020 ià(
»ş’
 > 
buf
->
couÁ
)

1021  -
EINVAL
;

1022 
dœ’t
 = 
buf
->
´evious
;

1024 ià(
dœ’t
) {

1025 ià(
	`__put_u£r_uÇligÃd
(
off£t
, &
dœ’t
->
d_off
))

1026 
eçuÉ
;

1028 
dœ’t
 = 
buf
->
cu¼’t_dœ
;

1029 ià(
	`__put_u£r_uÇligÃd
(
šo
, &
dœ’t
->
d_šo
))

1030 
eçuÉ
;

1031 
off
 = 0;

1032 ià(
	`__put_u£r_uÇligÃd
(
off
, &
dœ’t
->
d_off
))

1033 
eçuÉ
;

1034 ià(
	`__put_u£r
(
»ş’
, &
dœ’t
->
d_»ş’
))

1035 
eçuÉ
;

1036 ià(
	`__put_u£r
(
d_ty³
, &
dœ’t
->d_type))

1037 
eçuÉ
;

1038 ià(
	`cİy_to_u£r
(
dœ’t
->
d_Çme
, 
Çme
, 
ÇmËn
))

1039 
eçuÉ
;

1040 ià(
	`__put_u£r
(0, 
dœ’t
->
d_Çme
 + 
ÇmËn
))

1041 
eçuÉ
;

1042 
buf
->
´evious
 = 
dœ’t
;

1043 
dœ’t
 = (
__u£r
 *)dœ’ˆ+ 
»ş’
;

1044 
buf
->
cu¼’t_dœ
 = 
dœ’t
;

1045 
buf
->
couÁ
 -ğ
»ş’
;

1047 
eçuÉ
:

1048 
buf
->
”rÜ
 = -
EFAULT
;

1049  -
EFAULT
;

1050 
	}
}

1052 
asmlškage
 
	$com·t_sys_g‘d’ts64
(
fd
,

1053 
lšux_dœ’t64
 
__u£r
 * 
dœ’t
, 
couÁ
)

1055 
fe
 * file;

1056 
lšux_dœ’t64
 
__u£r
 * 
Ï¡dœ’t
;

1057 
com·t_g‘d’ts_ÿÎback64
 
buf
;

1058 
”rÜ
;

1060 
”rÜ
 = -
EFAULT
;

1061 ià(!
	`acûss_ok
(
VERIFY_WRITE
, 
dœ’t
, 
couÁ
))

1062 
out
;

1064 
”rÜ
 = -
EBADF
;

1065 
fe
 = 
	`fg‘
(
fd
);

1066 ià(!
fe
)

1067 
out
;

1069 
buf
.
cu¼’t_dœ
 = 
dœ’t
;

1070 
buf
.
´evious
 = 
NULL
;

1071 
buf
.
couÁ
 = count;

1072 
buf
.
”rÜ
 = 0;

1074 
”rÜ
 = 
	`vfs_»addœ
(
fe
, 
com·t_fldœ64
, &
buf
);

1075 ià(
”rÜ
 >= 0)

1076 
”rÜ
 = 
buf
.error;

1077 
Ï¡dœ’t
 = 
buf
.
´evious
;

1078 ià(
Ï¡dœ’t
) {

1079 
	`ty³of
(
Ï¡dœ’t
->
d_off
èd_ofàğ
fe
->
f_pos
;

1080 ià(
	`__put_u£r_uÇligÃd
(
d_off
, &
Ï¡dœ’t
->d_off))

1081 
”rÜ
 = -
EFAULT
;

1083 
”rÜ
 = 
couÁ
 - 
buf
.count;

1085 
	`åut
(
fe
);

1086 
out
:

1087  
”rÜ
;

1088 
	}
}

1091 
ssize_t
 
	$com·t_do_»adv_wr™ev
(
ty³
, 
fe
 *file,

1092 cÚ¡ 
com·t_iovec
 
__u£r
 *
uveùÜ
,

1093 
Ä_£gs
, 
loff_t
 *
pos
)

1095 
com·t_ssize_t
 
tÙ_Ën
;

1096 
iovec
 
iov¡ack
[
UIO_FASTIOV
];

1097 
iovec
 *
iov
 = 
iov¡ack
;

1098 
ssize_t
 
»t
;

1099 
io_â_t
 
â
;

1100 
iov_â_t
 
âv
;

1102 
»t
 = -
EINVAL
;

1103 ià(!
fe
->
f_İ
)

1104 
out
;

1106 
»t
 = -
EFAULT
;

1107 ià(!
	`acûss_ok
(
VERIFY_READ
, 
uveùÜ
, 
Ä_£gs
*(*uvector)))

1108 
out
;

1110 
tÙ_Ën
 = 
	`com·t_rw_cİy_check_uveùÜ
(
ty³
, 
uveùÜ
, 
Ä_£gs
,

1111 
UIO_FASTIOV
, 
iov¡ack
, &
iov
, 1);

1112 ià(
tÙ_Ën
 == 0) {

1113 
»t
 = 0;

1114 
out
;

1117 
»t
 = 
	`rw_v”ify_¬—
(
ty³
, 
fe
, 
pos
, 
tÙ_Ën
);

1118 ià(
»t
 < 0)

1119 
out
;

1121 
âv
 = 
NULL
;

1122 ià(
ty³
 =ğ
READ
) {

1123 
â
 = 
fe
->
f_İ
->
»ad
;

1124 
âv
 = 
fe
->
f_İ
->
aio_»ad
;

1126 
â
 = (
io_â_t
)
fe
->
f_İ
->
wr™e
;

1127 
âv
 = 
fe
->
f_İ
->
aio_wr™e
;

1130 ià(
âv
)

1131 
»t
 = 
	`do_sync_»adv_wr™ev
(
fe
, 
iov
, 
Ä_£gs
, 
tÙ_Ën
,

1132 
pos
, 
âv
);

1134 
»t
 = 
	`do_loİ_»adv_wr™ev
(
fe
, 
iov
, 
Ä_£gs
, 
pos
, 
â
);

1136 
out
:

1137 ià(
iov
 !ğ
iov¡ack
)

1138 
	`kä“
(
iov
);

1139 ià((
»t
 + (
ty³
 =ğ
READ
)) > 0) {

1140 ià(
ty³
 =ğ
READ
)

1141 
	`f¢Ùify_acûss
(
fe
);

1143 
	`f¢Ùify_modify
(
fe
);

1145  
»t
;

1146 
	}
}

1148 
size_t
 
	$com·t_»adv
(
fe
 *file,

1149 cÚ¡ 
com·t_iovec
 
__u£r
 *
vec
,

1150 
vËn
, 
loff_t
 *
pos
)

1152 
ssize_t
 
»t
 = -
EBADF
;

1154 ià(!(
fe
->
f_mode
 & 
FMODE_READ
))

1155 
out
;

1157 
»t
 = -
EINVAL
;

1158 ià(!
fe
->
f_İ
 || (!fe->f_İ->
aio_»ad
 && !fe->f_İ->
»ad
))

1159 
out
;

1161 
»t
 = 
	`com·t_do_»adv_wr™ev
(
READ
, 
fe
, 
vec
, 
vËn
, 
pos
);

1163 
out
:

1164 ià(
»t
 > 0)

1165 
	`add_rch¬
(
cu¼’t
, 
»t
);

1166 
	`šc_sysü
(
cu¼’t
);

1167  
»t
;

1168 
	}
}

1170 
asmlškage
 
ssize_t


1171 
	$com·t_sys_»adv
(
fd
, cÚ¡ 
com·t_iovec
 
__u£r
 *
vec
,

1172 
vËn
)

1174 
fe
 *file;

1175 
åut_Ãeded
;

1176 
ssize_t
 
»t
;

1178 
fe
 = 
	`fg‘_light
(
fd
, &
åut_Ãeded
);

1179 ià(!
fe
)

1180  -
EBADF
;

1181 
»t
 = 
	`com·t_»adv
(
fe
, 
vec
, 
vËn
, &fe->
f_pos
);

1182 
	`åut_light
(
fe
, 
åut_Ãeded
);

1183  
»t
;

1184 
	}
}

1186 
asmlškage
 
ssize_t


1187 
	$com·t_sys_´—dv
(
fd
, cÚ¡ 
com·t_iovec
 
__u£r
 *
vec
,

1188 
vËn
, 
u32
 
pos_low
, u32 
pos_high
)

1190 
loff_t
 
pos
 = (Öoff_t)
pos_high
 << 32è| 
pos_low
;

1191 
fe
 *file;

1192 
åut_Ãeded
;

1193 
ssize_t
 
»t
;

1195 ià(
pos
 < 0)

1196  -
EINVAL
;

1197 
fe
 = 
	`fg‘_light
(
fd
, &
åut_Ãeded
);

1198 ià(!
fe
)

1199  -
EBADF
;

1200 
»t
 = -
ESPIPE
;

1201 ià(
fe
->
f_mode
 & 
FMODE_PREAD
)

1202 
»t
 = 
	`com·t_»adv
(
fe
, 
vec
, 
vËn
, &
pos
);

1203 
	`åut_light
(
fe
, 
åut_Ãeded
);

1204  
»t
;

1205 
	}
}

1207 
size_t
 
	$com·t_wr™ev
(
fe
 *file,

1208 cÚ¡ 
com·t_iovec
 
__u£r
 *
vec
,

1209 
vËn
, 
loff_t
 *
pos
)

1211 
ssize_t
 
»t
 = -
EBADF
;

1213 ià(!(
fe
->
f_mode
 & 
FMODE_WRITE
))

1214 
out
;

1216 
»t
 = -
EINVAL
;

1217 ià(!
fe
->
f_İ
 || (!fe->f_İ->
aio_wr™e
 && !fe->f_İ->
wr™e
))

1218 
out
;

1220 
»t
 = 
	`com·t_do_»adv_wr™ev
(
WRITE
, 
fe
, 
vec
, 
vËn
, 
pos
);

1222 
out
:

1223 ià(
»t
 > 0)

1224 
	`add_wch¬
(
cu¼’t
, 
»t
);

1225 
	`šc_syscw
(
cu¼’t
);

1226  
»t
;

1227 
	}
}

1229 
asmlškage
 
ssize_t


1230 
	$com·t_sys_wr™ev
(
fd
, cÚ¡ 
com·t_iovec
 
__u£r
 *
vec
,

1231 
vËn
)

1233 
fe
 *file;

1234 
åut_Ãeded
;

1235 
ssize_t
 
»t
;

1237 
fe
 = 
	`fg‘_light
(
fd
, &
åut_Ãeded
);

1238 ià(!
fe
)

1239  -
EBADF
;

1240 
»t
 = 
	`com·t_wr™ev
(
fe
, 
vec
, 
vËn
, &fe->
f_pos
);

1241 
	`åut_light
(
fe
, 
åut_Ãeded
);

1242  
»t
;

1243 
	}
}

1245 
asmlškage
 
ssize_t


1246 
	$com·t_sys_pwr™ev
(
fd
, cÚ¡ 
com·t_iovec
 
__u£r
 *
vec
,

1247 
vËn
, 
u32
 
pos_low
, u32 
pos_high
)

1249 
loff_t
 
pos
 = (Öoff_t)
pos_high
 << 32è| 
pos_low
;

1250 
fe
 *file;

1251 
åut_Ãeded
;

1252 
ssize_t
 
»t
;

1254 ià(
pos
 < 0)

1255  -
EINVAL
;

1256 
fe
 = 
	`fg‘_light
(
fd
, &
åut_Ãeded
);

1257 ià(!
fe
)

1258  -
EBADF
;

1259 
»t
 = -
ESPIPE
;

1260 ià(
fe
->
f_mode
 & 
FMODE_PWRITE
)

1261 
»t
 = 
	`com·t_wr™ev
(
fe
, 
vec
, 
vËn
, &
pos
);

1262 
	`åut_light
(
fe
, 
åut_Ãeded
);

1263  
»t
;

1264 
	}
}

1266 
asmlškage
 

1267 
	$com·t_sys_vm¥liû
(
fd
, cÚ¡ 
com·t_iovec
 
__u£r
 *
iov32
,

1268 
Ä_£gs
, 
æags
)

1270 
i
;

1271 
iovec
 
__u£r
 *
iov
;

1272 ià(
Ä_£gs
 > 
UIO_MAXIOV
)

1273  -
EINVAL
;

1274 
iov
 = 
	`com·t_®loc_u£r_¥aû
(
Ä_£gs
 * (
iovec
));

1275 
i
 = 0; i < 
Ä_£gs
; i++) {

1276 
com·t_iovec
 
v
;

1277 ià(
	`g‘_u£r
(
v
.
iov_ba£
, &
iov32
[
i
].iov_base) ||

1278 
	`g‘_u£r
(
v
.
iov_Ën
, &
iov32
[
i
].iov_len) ||

1279 
	`put_u£r
(
	`com·t_±r
(
v
.
iov_ba£
), &
iov
[
i
].iov_base) ||

1280 
	`put_u£r
(
v
.
iov_Ën
, &
iov
[
i
].iov_len))

1281  -
EFAULT
;

1283  
	`sys_vm¥liû
(
fd
, 
iov
, 
Ä_£gs
, 
æags
);

1284 
	}
}

1290 
asmlškage
 

1291 
	$com·t_sys_İ’
(cÚ¡ 
__u£r
 *
f’ame
, 
æags
, 
mode
)

1293  
	`do_sys_İ’
(
AT_FDCWD
, 
f’ame
, 
æags
, 
mode
);

1294 
	}
}

1300 
asmlškage
 

1301 
	$com·t_sys_İ’©
(
dfd
, cÚ¡ 
__u£r
 *
f’ame
, 
æags
, 
mode
)

1303  
	`do_sys_İ’
(
dfd
, 
f’ame
, 
æags
, 
mode
);

1304 
	}
}

1306 
	#__COMPAT_NFDBITS
 (8 * (
com·t_ulÚg_t
))

	)

1308 
	$pŞl_£Ëù_cİy_»maššg
(
time¥ec
 *
’d_time
, 
__u£r
 *
p
,

1309 
timev®
, 
»t
)

1311 
time¥ec
 
ts
;

1313 ià(!
p
)

1314  
»t
;

1316 ià(
cu¼’t
->
³rsÚ®™y
 & 
STICKY_TIMEOUTS
)

1317 
¡icky
;

1320 ià(!
’d_time
->
tv_£c
 && !’d_time->
tv_n£c
)

1321  
»t
;

1323 
	`ktime_g‘_ts
(&
ts
);

1324 
ts
 = 
	`time¥ec_sub
(*
’d_time
,s);

1325 ià(
ts
.
tv_£c
 < 0)

1326 
ts
.
tv_£c
 =s.
tv_n£c
 = 0;

1328 ià(
timev®
) {

1329 
com·t_timev®
 
¹v
;

1331 
¹v
.
tv_£c
 = 
ts
.tv_sec;

1332 
¹v
.
tv_u£c
 = 
ts
.
tv_n£c
 / 
NSEC_PER_USEC
;

1334 ià(!
	`cİy_to_u£r
(
p
, &
¹v
, (rtv)))

1335  
»t
;

1337 
com·t_time¥ec
 
¹s
;

1339 
¹s
.
tv_£c
 = 
ts
.tv_sec;

1340 
¹s
.
tv_n£c
 = 
ts
.tv_nsec;

1342 ià(!
	`cİy_to_u£r
(
p
, &
¹s
, (rts)))

1343  
»t
;

1353 
¡icky
:

1354 ià(
»t
 =ğ-
ERESTARTNOHAND
)

1355 
»t
 = -
EINTR
;

1356  
»t
;

1357 
	}
}

1364 
	$com·t_g‘_fd_£t
(
Ä
, 
com·t_ulÚg_t
 
__u£r
 *
ufd£t
,

1365 *
fd£t
)

1367 
Ä
 = 
	`DIV_ROUND_UP
Òr, 
__COMPAT_NFDBITS
);

1368 ià(
ufd£t
) {

1369 
odd
;

1371 ià(!
	`acûss_ok
(
VERIFY_WRITE
, 
ufd£t
, 
Ä
*(
com·t_ulÚg_t
)))

1372  -
EFAULT
;

1374 
odd
 = 
Ä
 & 1UL;

1375 
Ä
 &= ~1UL;

1376 
Ä
) {

1377 
h
, 
l
;

1378 ià(
	`__g‘_u£r
(
l
, 
ufd£t
è|| __g‘_u£r(
h
, ufdset+1))

1379  -
EFAULT
;

1380 
ufd£t
 += 2;

1381 *
fd£t
++ = 
h
 << 32 | 
l
;

1382 
Ä
 -= 2;

1384 ià(
odd
 && 
	`__g‘_u£r
(*
fd£t
, 
ufd£t
))

1385  -
EFAULT
;

1391 
	`mem£t
(
fd£t
, 0, ((
Ä
 + 1è& ~1)*(
com·t_ulÚg_t
));

1394 
	}
}

1397 
	$com·t_£t_fd_£t
(
Ä
, 
com·t_ulÚg_t
 
__u£r
 *
ufd£t
,

1398 *
fd£t
)

1400 
odd
;

1401 
Ä
 = 
	`DIV_ROUND_UP
Òr, 
__COMPAT_NFDBITS
);

1403 ià(!
ufd£t
)

1406 
odd
 = 
Ä
 & 1UL;

1407 
Ä
 &= ~1UL;

1408 
Ä
) {

1409 
h
, 
l
;

1410 
l
 = *
fd£t
++;

1411 
h
 = 
l
 >> 32;

1412 ià(
	`__put_u£r
(
l
, 
ufd£t
è|| __put_u£r(
h
, ufdset+1))

1413  -
EFAULT
;

1414 
ufd£t
 += 2;

1415 
Ä
 -= 2;

1417 ià(
odd
 && 
	`__put_u£r
(*
fd£t
, 
ufd£t
))

1418  -
EFAULT
;

1420 
	}
}

1436 
	$com·t_cÜe_sys_£Ëù
(
n
, 
com·t_ulÚg_t
 
__u£r
 *
šp
,

1437 
com·t_ulÚg_t
 
__u£r
 *
ou
, com·t_ulÚg_ˆ__u£¸*
exp
,

1438 
time¥ec
 *
’d_time
)

1440 
fd_£t_b™s
 
fds
;

1441 *
b™s
;

1442 
size
, 
max_fds
, 
»t
 = -
EINVAL
;

1443 
fdbË
 *
fdt
;

1444 
¡ack_fds
[
SELECT_STACK_ALLOC
/()];

1446 ià(
n
 < 0)

1447 
out_nofds
;

1450 
	`rcu_»ad_lock
();

1451 
fdt
 = 
	`fes_fdbË
(
cu¼’t
->
fes
);

1452 
max_fds
 = 
fdt
->max_fds;

1453 
	`rcu_»ad_uÆock
();

1454 ià(
n
 > 
max_fds
)

1455 
n
 = 
max_fds
;

1462 
size
 = 
	`FDS_BYTES
(
n
);

1463 
b™s
 = 
¡ack_fds
;

1464 ià(
size
 > (
¡ack_fds
) / 6) {

1465 
b™s
 = 
	`km®loc
(6 * 
size
, 
GFP_KERNEL
);

1466 
»t
 = -
ENOMEM
;

1467 ià(!
b™s
)

1468 
out_nofds
;

1470 
fds
.
š
 = (*è
b™s
;

1471 
fds
.
out
 = (*è(
b™s
 + 
size
);

1472 
fds
.
ex
 = (*è(
b™s
 + 2*
size
);

1473 
fds
.
»s_š
 = (*è(
b™s
 + 3*
size
);

1474 
fds
.
»s_out
 = (*è(
b™s
 + 4*
size
);

1475 
fds
.
»s_ex
 = (*è(
b™s
 + 5*
size
);

1477 ià((
»t
 = 
	`com·t_g‘_fd_£t
(
n
, 
šp
, 
fds
.
š
)) ||

1478 (
»t
 = 
	`com·t_g‘_fd_£t
(
n
, 
ou
, 
fds
.
out
)) ||

1479 (
»t
 = 
	`com·t_g‘_fd_£t
(
n
, 
exp
, 
fds
.
ex
)))

1480 
out
;

1481 
	`z”o_fd_£t
(
n
, 
fds
.
»s_š
);

1482 
	`z”o_fd_£t
(
n
, 
fds
.
»s_out
);

1483 
	`z”o_fd_£t
(
n
, 
fds
.
»s_ex
);

1485 
»t
 = 
	`do_£Ëù
(
n
, &
fds
, 
’d_time
);

1487 ià(
»t
 < 0)

1488 
out
;

1489 ià(!
»t
) {

1490 
»t
 = -
ERESTARTNOHAND
;

1491 ià(
	`sigÇl_³ndšg
(
cu¼’t
))

1492 
out
;

1493 
»t
 = 0;

1496 ià(
	`com·t_£t_fd_£t
(
n
, 
šp
, 
fds
.
»s_š
) ||

1497 
	`com·t_£t_fd_£t
(
n
, 
ou
, 
fds
.
»s_out
) ||

1498 
	`com·t_£t_fd_£t
(
n
, 
exp
, 
fds
.
»s_ex
))

1499 
»t
 = -
EFAULT
;

1500 
out
:

1501 ià(
b™s
 !ğ
¡ack_fds
)

1502 
	`kä“
(
b™s
);

1503 
out_nofds
:

1504  
»t
;

1505 
	}
}

1507 
asmlškage
 
	$com·t_sys_£Ëù
(
n
, 
com·t_ulÚg_t
 
__u£r
 *
šp
,

1508 
com·t_ulÚg_t
 
__u£r
 *
ou
, com·t_ulÚg_ˆ__u£¸*
exp
,

1509 
com·t_timev®
 
__u£r
 *
tvp
)

1511 
time¥ec
 
’d_time
, *
to
 = 
NULL
;

1512 
com·t_timev®
 
tv
;

1513 
»t
;

1515 ià(
tvp
) {

1516 ià(
	`cİy_äom_u£r
(&
tv
, 
tvp
, (tv)))

1517  -
EFAULT
;

1519 
to
 = &
’d_time
;

1520 ià(
	`pŞl_£Ëù_£t_timeout
(
to
,

1521 
tv
.
tv_£c
 + (tv.
tv_u£c
 / 
USEC_PER_SEC
),

1522 (
tv
.
tv_u£c
 % 
USEC_PER_SEC
è* 
NSEC_PER_USEC
))

1523  -
EINVAL
;

1526 
»t
 = 
	`com·t_cÜe_sys_£Ëù
(
n
, 
šp
, 
ou
, 
exp
, 
to
);

1527 
»t
 = 
	`pŞl_£Ëù_cİy_»maššg
(&
’d_time
, 
tvp
, 1,„et);

1529  
»t
;

1530 
	}
}

1532 
	scom·t_£l_¬g_¡ruù
 {

1533 
com·t_ulÚg_t
 
	mn
;

1534 
com·t_u±r_t
 
	mšp
;

1535 
com·t_u±r_t
 
	mou
;

1536 
com·t_u±r_t
 
	mexp
;

1537 
com·t_u±r_t
 
	mtvp
;

1540 
asmlškage
 
	$com·t_sys_Şd_£Ëù
(
com·t_£l_¬g_¡ruù
 
__u£r
 *
¬g
)

1542 
com·t_£l_¬g_¡ruù
 
a
;

1544 ià(
	`cİy_äom_u£r
(&
a
, 
¬g
, (a)))

1545  -
EFAULT
;

1546  
	`com·t_sys_£Ëù
(
a
.
n
, 
	`com·t_±r
×.
šp
), com·t_±r×.
ou
),

1547 
	`com·t_±r
(
a
.
exp
), com·t_±r×.
tvp
));

1548 
	}
}

1550 #ifdeà
HAVE_SET_RESTORE_SIGMASK


1551 
	$do_com·t_p£Ëù
(
n
, 
com·t_ulÚg_t
 
__u£r
 *
šp
,

1552 
com·t_ulÚg_t
 
__u£r
 *
ou
, com·t_ulÚg_ˆ__u£¸*
exp
,

1553 
com·t_time¥ec
 
__u£r
 *
t¥
, 
com·t_sig£t_t
 __u£¸*
sigmask
,

1554 
com·t_size_t
 
sig£tsize
)

1556 
com·t_sig£t_t
 
ss32
;

1557 
sig£t_t
 
ksigmask
, 
sig§ved
;

1558 
com·t_time¥ec
 
ts
;

1559 
time¥ec
 
’d_time
, *
to
 = 
NULL
;

1560 
»t
;

1562 ià(
t¥
) {

1563 ià(
	`cİy_äom_u£r
(&
ts
, 
t¥
, (ts)))

1564  -
EFAULT
;

1566 
to
 = &
’d_time
;

1567 ià(
	`pŞl_£Ëù_£t_timeout
(
to
, 
ts
.
tv_£c
,s.
tv_n£c
))

1568  -
EINVAL
;

1571 ià(
sigmask
) {

1572 ià(
sig£tsize
 !ğ(
com·t_sig£t_t
))

1573  -
EINVAL
;

1574 ià(
	`cİy_äom_u£r
(&
ss32
, 
sigmask
, (ss32)))

1575  -
EFAULT
;

1576 
	`sig£t_äom_com·t
(&
ksigmask
, &
ss32
);

1578 
	`sigd–£tmask
(&
ksigmask
, 
	`sigmask
(
SIGKILL
)|sigmask(
SIGSTOP
));

1579 
	`sig´ocmask
(
SIG_SETMASK
, &
ksigmask
, &
sig§ved
);

1582 
»t
 = 
	`com·t_cÜe_sys_£Ëù
(
n
, 
šp
, 
ou
, 
exp
, 
to
);

1583 
»t
 = 
	`pŞl_£Ëù_cİy_»maššg
(&
’d_time
, 
t¥
, 0,„et);

1585 ià(
»t
 =ğ-
ERESTARTNOHAND
) {

1591 ià(
sigmask
) {

1592 
	`memıy
(&
cu¼’t
->
§ved_sigmask
, &
sig§ved
,

1593 (
sig§ved
));

1594 
	`£t_»¡Üe_sigmask
();

1596 } ià(
sigmask
)

1597 
	`sig´ocmask
(
SIG_SETMASK
, &
sig§ved
, 
NULL
);

1599  
»t
;

1600 
	}
}

1602 
asmlškage
 
	$com·t_sys_p£Ëù6
(
n
, 
com·t_ulÚg_t
 
__u£r
 *
šp
,

1603 
com·t_ulÚg_t
 
__u£r
 *
ou
, com·t_ulÚg_ˆ__u£¸*
exp
,

1604 
com·t_time¥ec
 
__u£r
 *
t¥
, __u£¸*
sig
)

1606 
com·t_size_t
 
sig£tsize
 = 0;

1607 
com·t_u±r_t
 
up
 = 0;

1609 ià(
sig
) {

1610 ià(!
	`acûss_ok
(
VERIFY_READ
, 
sig
,

1611 (
com·t_u±r_t
)+(
com·t_size_t
)) ||

1612 
	`__g‘_u£r
(
up
, (
com·t_u±r_t
 
__u£r
 *)
sig
) ||

1613 
	`__g‘_u£r
(
sig£tsize
,

1614 (
com·t_size_t
 
__u£r
 *)(
sig
+(
up
))))

1615  -
EFAULT
;

1617  
	`do_com·t_p£Ëù
(
n
, 
šp
, 
ou
, 
exp
, 
t¥
, 
	`com·t_±r
(
up
),

1618 
sig£tsize
);

1619 
	}
}

1621 
asmlškage
 
	$com·t_sys_µŞl
(
pŞlfd
 
__u£r
 *
ufds
,

1622 
nfds
, 
com·t_time¥ec
 
__u£r
 *
t¥
,

1623 cÚ¡ 
com·t_sig£t_t
 
__u£r
 *
sigmask
, 
com·t_size_t
 
sig£tsize
)

1625 
com·t_sig£t_t
 
ss32
;

1626 
sig£t_t
 
ksigmask
, 
sig§ved
;

1627 
com·t_time¥ec
 
ts
;

1628 
time¥ec
 
’d_time
, *
to
 = 
NULL
;

1629 
»t
;

1631 ià(
t¥
) {

1632 ià(
	`cİy_äom_u£r
(&
ts
, 
t¥
, (ts)))

1633  -
EFAULT
;

1635 
to
 = &
’d_time
;

1636 ià(
	`pŞl_£Ëù_£t_timeout
(
to
, 
ts
.
tv_£c
,s.
tv_n£c
))

1637  -
EINVAL
;

1640 ià(
sigmask
) {

1641 ià(
sig£tsize
 !ğ(
com·t_sig£t_t
))

1642  -
EINVAL
;

1643 ià(
	`cİy_äom_u£r
(&
ss32
, 
sigmask
, (ss32)))

1644  -
EFAULT
;

1645 
	`sig£t_äom_com·t
(&
ksigmask
, &
ss32
);

1647 
	`sigd–£tmask
(&
ksigmask
, 
	`sigmask
(
SIGKILL
)|sigmask(
SIGSTOP
));

1648 
	`sig´ocmask
(
SIG_SETMASK
, &
ksigmask
, &
sig§ved
);

1651 
»t
 = 
	`do_sys_pŞl
(
ufds
, 
nfds
, 
to
);

1654 ià(
»t
 =ğ-
EINTR
) {

1660 ià(
sigmask
) {

1661 
	`memıy
(&
cu¼’t
->
§ved_sigmask
, &
sig§ved
,

1662 (
sig§ved
));

1663 
	`£t_»¡Üe_sigmask
();

1665 
»t
 = -
ERESTARTNOHAND
;

1666 } ià(
sigmask
)

1667 
	`sig´ocmask
(
SIG_SETMASK
, &
sig§ved
, 
NULL
);

1669 
»t
 = 
	`pŞl_£Ëù_cİy_»maššg
(&
’d_time
, 
t¥
, 0,„et);

1671  
»t
;

1672 
	}
}

1675 #ifdeà
CONFIG_EPOLL


1677 #ifdeà
HAVE_SET_RESTORE_SIGMASK


1678 
asmlškage
 
	$com·t_sys_•Şl_pwa™
(
•fd
,

1679 
com·t_•Şl_ev’t
 
__u£r
 *
ev’ts
,

1680 
maxev’ts
, 
timeout
,

1681 cÚ¡ 
com·t_sig£t_t
 
__u£r
 *
sigmask
,

1682 
com·t_size_t
 
sig£tsize
)

1684 
”r
;

1685 
com·t_sig£t_t
 
csigmask
;

1686 
sig£t_t
 
ksigmask
, 
sig§ved
;

1692 ià(
sigmask
) {

1693 ià(
sig£tsize
 !ğ(
com·t_sig£t_t
))

1694  -
EINVAL
;

1695 ià(
	`cİy_äom_u£r
(&
csigmask
, 
sigmask
, (csigmask)))

1696  -
EFAULT
;

1697 
	`sig£t_äom_com·t
(&
ksigmask
, &
csigmask
);

1698 
	`sigd–£tmask
(&
ksigmask
, 
	`sigmask
(
SIGKILL
è| sigmask(
SIGSTOP
));

1699 
	`sig´ocmask
(
SIG_SETMASK
, &
ksigmask
, &
sig§ved
);

1702 
”r
 = 
	`sys_•Şl_wa™
(
•fd
, 
ev’ts
, 
maxev’ts
, 
timeout
);

1710 ià(
sigmask
) {

1711 ià(
”r
 =ğ-
EINTR
) {

1712 
	`memıy
(&
cu¼’t
->
§ved_sigmask
, &
sig§ved
,

1713 (
sig§ved
));

1714 
	`£t_»¡Üe_sigmask
();

1716 
	`sig´ocmask
(
SIG_SETMASK
, &
sig§ved
, 
NULL
);

1719  
”r
;

1720 
	}
}

1725 #ifdeà
CONFIG_SIGNALFD


1727 
asmlškage
 
	$com·t_sys_sigÇlfd4
(
ufd
,

1728 cÚ¡ 
com·t_sig£t_t
 
__u£r
 *
sigmask
,

1729 
com·t_size_t
 
sig£tsize
, 
æags
)

1731 
com·t_sig£t_t
 
ss32
;

1732 
sig£t_t
 
tmp
;

1733 
sig£t_t
 
__u£r
 *
ksigmask
;

1735 ià(
sig£tsize
 !ğ(
com·t_sig£t_t
))

1736  -
EINVAL
;

1737 ià(
	`cİy_äom_u£r
(&
ss32
, 
sigmask
, (ss32)))

1738  -
EFAULT
;

1739 
	`sig£t_äom_com·t
(&
tmp
, &
ss32
);

1740 
ksigmask
 = 
	`com·t_®loc_u£r_¥aû
((
sig£t_t
));

1741 ià(
	`cİy_to_u£r
(
ksigmask
, &
tmp
, (
sig£t_t
)))

1742  -
EFAULT
;

1744  
	`sys_sigÇlfd4
(
ufd
, 
ksigmask
, (
sig£t_t
), 
æags
);

1745 
	}
}

1747 
asmlškage
 
	$com·t_sys_sigÇlfd
(
ufd
,

1748 cÚ¡ 
com·t_sig£t_t
 
__u£r
 *
sigmask
,

1749 
com·t_size_t
 
sig£tsize
)

1751  
	`com·t_sys_sigÇlfd4
(
ufd
, 
sigmask
, 
sig£tsize
, 0);

1752 
	}
}

1755 #ifdeà
CONFIG_TIMERFD


1757 
asmlškage
 
	$com·t_sys_tim”fd_£‰ime
(
ufd
, 
æags
,

1758 cÚ¡ 
com·t_™im”¥ec
 
__u£r
 *
utmr
,

1759 
com·t_™im”¥ec
 
__u£r
 *
Ùmr
)

1761 
”rÜ
;

1762 
™im”¥ec
 
t
;

1763 
™im”¥ec
 
__u£r
 *
ut
;

1765 ià(
	`g‘_com·t_™im”¥ec
(&
t
, 
utmr
))

1766  -
EFAULT
;

1767 
ut
 = 
	`com·t_®loc_u£r_¥aû
(2 * (
™im”¥ec
));

1768 ià(
	`cİy_to_u£r
(&
ut
[0], &
t
, (t)))

1769  -
EFAULT
;

1770 
”rÜ
 = 
	`sys_tim”fd_£‰ime
(
ufd
, 
æags
, &
ut
[0], &ut[1]);

1771 ià(!
”rÜ
 && 
Ùmr
)

1772 
”rÜ
 = (
	`cİy_äom_u£r
(&
t
, &
ut
[1], (
™im”¥ec
)) ||

1773 
	`put_com·t_™im”¥ec
(
Ùmr
, &
t
)è? -
EFAULT
: 0;

1775  
”rÜ
;

1776 
	}
}

1778 
asmlškage
 
	$com·t_sys_tim”fd_g‘time
(
ufd
,

1779 
com·t_™im”¥ec
 
__u£r
 *
Ùmr
)

1781 
”rÜ
;

1782 
™im”¥ec
 
t
;

1783 
™im”¥ec
 
__u£r
 *
ut
;

1785 
ut
 = 
	`com·t_®loc_u£r_¥aû
((
™im”¥ec
));

1786 
”rÜ
 = 
	`sys_tim”fd_g‘time
(
ufd
, 
ut
);

1787 ià(!
”rÜ
)

1788 
”rÜ
 = (
	`cİy_äom_u£r
(&
t
, 
ut
, (
™im”¥ec
)) ||

1789 
	`put_com·t_™im”¥ec
(
Ùmr
, &
t
)è? -
EFAULT
: 0;

1791  
”rÜ
;

1792 
	}
}

1796 #ifdeà
CONFIG_FHANDLE


1801 
asmlškage
 

1802 
	$com·t_sys_İ’_by_hªdË_©
(
mouÁdœfd
,

1803 
fe_hªdË
 
__u£r
 *
hªdË
, 
æags
)

1805  
	`do_hªdË_İ’
(
mouÁdœfd
, 
hªdË
, 
æags
);

1806 
	}
}

	@compat_binfmt_elf.c

20 
	~<lšux/–fcÜe-com·t.h
>

21 
	~<lšux/time.h
>

26 #undeà
ELF_CLASS


27 
	#ELF_CLASS
 
ELFCLASS32


	)

29 #undeà
–fhdr


30 #undeà
–f_phdr


31 #undeà
–f_shdr


32 #undeà
–f_nÙe


33 #undeà
–f_addr_t


34 
	#–fhdr
 
–f32_hdr


	)

35 
	#–f_phdr
 
–f32_phdr


	)

36 
	#–f_shdr
 
–f32_shdr


	)

37 
	#–f_nÙe
 
–f32_nÙe


	)

38 
	#–f_addr_t
 
Elf32_Addr


	)

44 
	#–f_´¡©us
 
com·t_–f_´¡©us


	)

45 
	#–f_´psšfo
 
com·t_–f_´psšfo


	)

51 
	$ıutime_to_com·t_timev®
(cÚ¡ 
ıutime_t
 
ıutime
,

52 
com·t_timev®
 *
v®ue
)

54 
timev®
 
tv
;

55 
	`ıutime_to_timev®
(
ıutime
, &
tv
);

56 
v®ue
->
tv_£c
 = 
tv
.tv_sec;

57 
v®ue
->
tv_u£c
 = 
tv
.tv_usec;

58 
	}
}

60 #undeà
ıutime_to_timev®


61 
	#ıutime_to_timev®
 
ıutime_to_com·t_timev®


	)

70 #undeà
ELF_ARCH


71 #undeà
–f_check_¬ch


72 
	#–f_check_¬ch
 
com·t_–f_check_¬ch


	)

74 #ifdef 
COMPAT_ELF_PLATFORM


75 #undeà
ELF_PLATFORM


76 
	#ELF_PLATFORM
 
COMPAT_ELF_PLATFORM


	)

79 #ifdef 
COMPAT_ELF_HWCAP


80 #undeà
ELF_HWCAP


81 
	#ELF_HWCAP
 
COMPAT_ELF_HWCAP


	)

84 #ifdef 
COMPAT_ARCH_DLINFO


85 #undeà
ARCH_DLINFO


86 
	#ARCH_DLINFO
 
COMPAT_ARCH_DLINFO


	)

89 #ifdef 
COMPAT_ELF_ET_DYN_BASE


90 #undeà
ELF_ET_DYN_BASE


91 
	#ELF_ET_DYN_BASE
 
COMPAT_ELF_ET_DYN_BASE


	)

94 #ifdeà
COMPAT_ELF_EXEC_PAGESIZE


95 #undeà
ELF_EXEC_PAGESIZE


96 
	#ELF_EXEC_PAGESIZE
 
COMPAT_ELF_EXEC_PAGESIZE


	)

99 #ifdef 
COMPAT_ELF_PLAT_INIT


100 #undeà
ELF_PLAT_INIT


101 
	#ELF_PLAT_INIT
 
COMPAT_ELF_PLAT_INIT


	)

104 #ifdef 
COMPAT_SET_PERSONALITY


105 #undeà
SET_PERSONALITY


106 
	#SET_PERSONALITY
 
COMPAT_SET_PERSONALITY


	)

109 #ifdef 
com·t_¡¬t_th»ad


110 #undeà
¡¬t_th»ad


111 
	#¡¬t_th»ad
 
com·t_¡¬t_th»ad


	)

114 #ifdef 
com·t_¬ch_£tup_add™iÚ®_·ges


115 #undeà
ARCH_HAS_SETUP_ADDITIONAL_PAGES


116 
	#ARCH_HAS_SETUP_ADDITIONAL_PAGES
 1

	)

117 #undeà
¬ch_£tup_add™iÚ®_·ges


118 
	#¬ch_£tup_add™iÚ®_·ges
 
com·t_¬ch_£tup_add™iÚ®_·ges


	)

126 
	#–f_fÜm©
 
com·t_–f_fÜm©


	)

127 
	#š™_–f_bšfmt
 
š™_com·t_–f_bšfmt


	)

128 
	#ex™_–f_bšfmt
 
ex™_com·t_–f_bšfmt


	)

133 
	gMY_POD_ZERO
 = 0;

134 
	~"bšfmt_–f.c
"

	@compat_binfmt_pod.c

12 
	~<lšux/podcÜe-com·t.h
>

13 
	~<lšux/time.h
>

18 #undeà
POD_CLASS


19 
	#POD_CLASS
 
PODCLASS32


	)

21 #undeà
podhdr


22 #undeà
pod_phdr


23 #undeà
pod_shdr


24 #undeà
pod_nÙe


25 #undeà
pod_addr_t


26 
	#podhdr
 
pod32_hdr


	)

27 
	#pod_phdr
 
pod32_phdr


	)

28 
	#pod_shdr
 
pod32_shdr


	)

29 
	#pod_nÙe
 
pod32_nÙe


	)

30 
	#pod_addr_t
 
Pod32_Addr


	)

36 
	#pod_´¡©us
 
com·t_pod_´¡©us


	)

37 
	#pod_´psšfo
 
com·t_pod_´psšfo


	)

43 
	$ıutime_to_com·t_timev®
(cÚ¡ 
ıutime_t
 
ıutime
,

44 
com·t_timev®
 *
v®ue
)

46 
timev®
 
tv
;

47 
	`ıutime_to_timev®
(
ıutime
, &
tv
);

48 
v®ue
->
tv_£c
 = 
tv
.tv_sec;

49 
v®ue
->
tv_u£c
 = 
tv
.tv_usec;

50 
	}
}

52 #undeà
ıutime_to_timev®


53 
	#ıutime_to_timev®
 
ıutime_to_com·t_timev®


	)

62 #undeà
POD_ARCH


63 #undeà
pod_check_¬ch


64 
	#pod_check_¬ch
 
com·t_pod_check_¬ch


	)

66 #ifdef 
COMPAT_POD_PLATFORM


67 #undeà
POD_PLATFORM


68 
	#POD_PLATFORM
 
COMPAT_POD_PLATFORM


	)

71 #ifdef 
COMPAT_POD_HWCAP


72 #undeà
POD_HWCAP


73 
	#POD_HWCAP
 
COMPAT_POD_HWCAP


	)

83 #ifdef 
COMPAT_POD_ET_DYN_BASE


84 #undeà
POD_ET_DYN_BASE


85 
	#POD_ET_DYN_BASE
 
COMPAT_POD_ET_DYN_BASE


	)

88 #ifdeà
COMPAT_POD_EXEC_PAGESIZE


89 #undeà
POD_EXEC_PAGESIZE


90 
	#POD_EXEC_PAGESIZE
 
COMPAT_POD_EXEC_PAGESIZE


	)

93 #ifdef 
COMPAT_POD_PLAT_INIT


94 #undeà
POD_PLAT_INIT


95 
	#POD_PLAT_INIT
 
COMPAT_POD_PLAT_INIT


	)

105 #ifdef 
com·t_¡¬t_th»ad


106 #undeà
¡¬t_th»ad


107 
	#¡¬t_th»ad
 
com·t_¡¬t_th»ad


	)

110 #ifdef 
com·t_¬ch_£tup_add™iÚ®_·ges


111 #undeà
ARCH_HAS_SETUP_ADDITIONAL_PAGES


112 
	#ARCH_HAS_SETUP_ADDITIONAL_PAGES
 1

	)

113 #undeà
¬ch_£tup_add™iÚ®_·ges


114 
	#¬ch_£tup_add™iÚ®_·ges
 
com·t_¬ch_£tup_add™iÚ®_·ges


	)

122 
	#pod_fÜm©
 
com·t_pod_fÜm©


	)

123 
	#š™_pod_bšfmt
 
š™_com·t_pod_bšfmt


	)

124 
	#ex™_pod_bšfmt
 
ex™_com·t_pod_bšfmt


	)

129 
	~"bšfmt_pod.c
"

	@compat_ioctl.c

13 
	~<lšux/joy¡ick.h
>

15 
	~<lšux/ty³s.h
>

16 
	~<lšux/com·t.h
>

17 
	~<lšux/k”Ãl.h
>

18 
	~<lšux/ÿ·b™y.h
>

19 
	~<lšux/comp”.h
>

20 
	~<lšux/sched.h
>

21 
	~<lšux/smp.h
>

22 
	~<lšux/ioùl.h
>

23 
	~<lšux/if.h
>

24 
	~<lšux/if_bridge.h
>

25 
	~<lšux/¿id/md_u.h
>

26 
	~<lšux/kd.h
>

27 
	~<lšux/rou‹.h
>

28 
	~<lšux/š6.h
>

29 
	~<lšux/v6_rou‹.h
>

30 
	~<lšux/skbuff.h
>

31 
	~<lšux/Ãšk.h
>

32 
	~<lšux/vt.h
>

33 
	~<lšux/çÎoc.h
>

34 
	~<lšux/fs.h
>

35 
	~<lšux/fe.h
>

36 
	~<lšux/µp_defs.h
>

37 
	~<lšux/if_µp.h
>

38 
	~<lšux/if_µpox.h
>

39 
	~<lšux/mtio.h
>

40 
	~<lšux/auto_fs.h
>

41 
	~<lšux/auto_fs4.h
>

42 
	~<lšux/‰y.h
>

43 
	~<lšux/vt_k”n.h
>

44 
	~<lšux/fb.h
>

45 
	~<lšux/videodev2.h
>

46 
	~<lšux/Ãtdeviû.h
>

47 
	~<lšux/¿w.h
>

48 
	~<lšux/blkdev.h
>

49 
	~<lšux/–ev©Ü.h
>

50 
	~<lšux/¹c.h
>

51 
	~<lšux/pci.h
>

52 
	~<lšux/moduË.h
>

53 
	~<lšux/£rŸl.h
>

54 
	~<lšux/if_tun.h
>

55 
	~<lšux/ùy³.h
>

56 
	~<lšux/sysÿÎs.h
>

57 
	~<lšux/i2c.h
>

58 
	~<lšux/i2c-dev.h
>

59 
	~<lšux/©®k.h
>

60 
	~<lšux/gå.h
>

62 
	~<Ãt/blu‘oÙh/blu‘oÙh.h
>

63 
	~<Ãt/blu‘oÙh/hci.h
>

64 
	~<Ãt/blu‘oÙh/rfcomm.h
>

66 
	~<lšux/ÿpi.h
>

67 
	~<lšux/giga£t_dev.h
>

69 #ifdeà
CONFIG_BLOCK


70 
	~<lšux/loİ.h
>

71 
	~<lšux/cdrom.h
>

72 
	~<lšux/fd.h
>

73 
	~<scsi/scsi.h
>

74 
	~<scsi/scsi_ioùl.h
>

75 
	~<scsi/sg.h
>

78 
	~<asm/uacûss.h
>

79 
	~<lšux/‘htoŞ.h
>

80 
	~<lšux/mii.h
>

81 
	~<lšux/if_bÚdšg.h
>

82 
	~<lšux/w©chdog.h
>

84 
	~<lšux/soundÿrd.h
>

85 
	~<lšux/Í.h
>

86 
	~<lšux/µdev.h
>

88 
	~<lšux/©m.h
>

89 
	~<lšux/©m¬p.h
>

90 
	~<lšux/©mş.h
>

91 
	~<lšux/©mdev.h
>

92 
	~<lšux/©mioc.h
>

93 
	~<lšux/©mËc.h
>

94 
	~<lšux/©mmpc.h
>

95 
	~<lšux/©msvc.h
>

96 
	~<lšux/©m_tı.h
>

97 
	~<lšux/sÚ‘.h
>

98 
	~<lšux/©m_suni.h
>

100 
	~<lšux/usb.h
>

101 
	~<lšux/usbdeviû_fs.h
>

102 
	~<lšux/nbd.h
>

103 
	~<lšux/¿ndom.h
>

104 
	~<lšux/f‹r.h
>

106 
	~<lšux/hiddev.h
>

108 
	~<lšux/dvb/audio.h
>

109 
	~<lšux/dvb/dmx.h
>

110 
	~<lšux/dvb/äÚ‹nd.h
>

111 
	~<lšux/dvb/video.h
>

113 
	~<lšux/sÜt.h
>

115 #ifdeà
CONFIG_SPARC


116 
	~<asm/fbio.h
>

119 
	$w_lÚg
(
fd
, 
cmd
,

120 
com·t_ulÚg_t
 
__u£r
 *
¬gp
)

122 
mm_£gm’t_t
 
Şd_fs
 = 
	`g‘_fs
();

123 
”r
;

124 
v®
;

126 
	`£t_fs
 (
KERNEL_DS
);

127 
”r
 = 
	`sys_ioùl
(
fd
, 
cmd
, ()&
v®
);

128 
	`£t_fs
 (
Şd_fs
);

129 ià(!
”r
 && 
	`put_u£r
(
v®
, 
¬gp
))

130  -
EFAULT
;

131  
”r
;

132 
	}
}

134 
	scom·t_video_ev’t
 {

135 
št32_t
 
	mty³
;

136 
com·t_time_t
 
	mtime¡amp
;

138 
video_size_t
 
	msize
;

139 
	mäame_¿‹
;

140 } 
	mu
;

143 
	$do_video_g‘_ev’t
(
fd
, 
cmd
,

144 
com·t_video_ev’t
 
__u£r
 *
up
)

146 
video_ev’t
 
kev’t
;

147 
mm_£gm’t_t
 
Şd_fs
 = 
	`g‘_fs
();

148 
”r
;

150 
	`£t_fs
(
KERNEL_DS
);

151 
”r
 = 
	`sys_ioùl
(
fd
, 
cmd
, (è&
kev’t
);

152 
	`£t_fs
(
Şd_fs
);

154 ià(!
”r
) {

155 
”r
 = 
	`put_u£r
(
kev’t
.
ty³
, &
up
->type);

156 
”r
 |ğ
	`put_u£r
(
kev’t
.
time¡amp
, &
up
->timestamp);

157 
”r
 |ğ
	`put_u£r
(
kev’t
.
u
.
size
.
w
, &
up
->u.size.w);

158 
”r
 |ğ
	`put_u£r
(
kev’t
.
u
.
size
.
h
, &
up
->u.size.h);

159 
”r
 |ğ
	`put_u£r
(
kev’t
.
u
.
size
.
a¥eù_¿tio
,

160 &
up
->
u
.
size
.
a¥eù_¿tio
);

161 ià(
”r
)

162 
”r
 = -
EFAULT
;

165  
”r
;

166 
	}
}

168 
	scom·t_video_¡l_piùu»
 {

169 
com·t_u±r_t
 
	miF¿me
;

170 
št32_t
 
	msize
;

173 
	$do_video_¡Íiùu»
(
fd
, 
cmd
,

174 
com·t_video_¡l_piùu»
 
__u£r
 *
up
)

176 
video_¡l_piùu»
 
__u£r
 *
up_Çtive
;

177 
com·t_u±r_t
 
å
;

178 
št32_t
 
size
;

179 
”r
;

181 
”r
 = 
	`g‘_u£r
(
å
, &
up
->
iF¿me
);

182 
”r
 |ğ
	`g‘_u£r
(
size
, &
up
->size);

183 ià(
”r
)

184  -
EFAULT
;

186 
up_Çtive
 =

187 
	`com·t_®loc_u£r_¥aû
((
video_¡l_piùu»
));

189 
”r
 = 
	`put_u£r
(
	`com·t_±r
(
å
), &
up_Çtive
->
iF¿me
);

190 
”r
 |ğ
	`put_u£r
(
size
, &
up_Çtive
->size);

191 ià(
”r
)

192  -
EFAULT
;

194 
”r
 = 
	`sys_ioùl
(
fd
, 
cmd
, (è
up_Çtive
);

196  
”r
;

197 
	}
}

199 
	scom·t_video_¥u_·Ë‰e
 {

200 
	mËngth
;

201 
com·t_u±r_t
 
	m·Ë‰e
;

204 
	$do_video_£t_¥u_·Ë‰e
(
fd
, 
cmd
,

205 
com·t_video_¥u_·Ë‰e
 
__u£r
 *
up
)

207 
video_¥u_·Ë‰e
 
__u£r
 *
up_Çtive
;

208 
com·t_u±r_t
 
·Í
;

209 
Ëngth
, 
”r
;

211 
”r
 = 
	`g‘_u£r
(
·Í
, &
up
->
·Ë‰e
);

212 
”r
 |ğ
	`g‘_u£r
(
Ëngth
, &
up
->length);

214 
up_Çtive
 = 
	`com·t_®loc_u£r_¥aû
((
video_¥u_·Ë‰e
));

215 
”r
 = 
	`put_u£r
(
	`com·t_±r
(
·Í
), &
up_Çtive
->
·Ë‰e
);

216 
”r
 |ğ
	`put_u£r
(
Ëngth
, &
up_Çtive
->length);

217 ià(
”r
)

218  -
EFAULT
;

220 
”r
 = 
	`sys_ioùl
(
fd
, 
cmd
, (è
up_Çtive
);

222  
”r
;

223 
	}
}

225 #ifdeà
CONFIG_BLOCK


226 
	ssg_io_hdr32
 {

227 
com·t_št_t
 
	mš‹rçû_id
;

228 
com·t_št_t
 
	mdxãr_dœeùiÚ
;

229 
	mcmd_Ën
;

230 
	mmx_sb_Ën
;

231 
	miovec_couÁ
;

232 
com·t_ušt_t
 
	mdxãr_Ën
;

233 
com·t_ušt_t
 
	mdxã½
;

235 
com·t_u±r_t
 
	mcmdp
;

236 
com·t_u±r_t
 
	msbp
;

237 
com·t_ušt_t
 
	mtimeout
;

238 
com·t_ušt_t
 
	mæags
;

239 
com·t_št_t
 
	m·ck_id
;

240 
com·t_u±r_t
 
	mu¤_±r
;

241 
	m¡©us
;

242 
	mmasked_¡©us
;

243 
	mmsg_¡©us
;

244 
	msb_Ën_wr
;

245 
	mho¡_¡©us
;

246 
	mdriv”_¡©us
;

247 
com·t_št_t
 
	m»sid
;

248 
com·t_ušt_t
 
	mdu¿tiÚ
;

249 
com·t_ušt_t
 
	mšfo
;

250 } 
	tsg_io_hdr32_t
;

252 
	ssg_iovec32
 {

253 
com·t_ušt_t
 
	miov_ba£
;

254 
com·t_ušt_t
 
	miov_Ën
;

255 } 
	tsg_iovec32_t
;

257 
	$sg_bud_iovec
(
sg_io_hdr_t
 
__u£r
 *
sgio
, __u£¸*
dxã½
, 
u16
 
iovec_couÁ
)

259 
sg_iovec_t
 
__u£r
 *
iov
 = (sg_iovec_ˆ__u£¸*è(
sgio
 + 1);

260 
sg_iovec32_t
 
__u£r
 *
iov32
 = 
dxã½
;

261 
i
;

263 
i
 = 0; i < 
iovec_couÁ
; i++) {

264 
u32
 
ba£
, 
Ën
;

266 ià(
	`g‘_u£r
(
ba£
, &
iov32
[
i
].
iov_ba£
) ||

267 
	`g‘_u£r
(
Ën
, &
iov32
[
i
].
iov_Ën
) ||

268 
	`put_u£r
(
	`com·t_±r
(
ba£
), &
iov
[
i
].
iov_ba£
) ||

269 
	`put_u£r
(
Ën
, &
iov
[
i
].
iov_Ën
))

270  -
EFAULT
;

273 ià(
	`put_u£r
(
iov
, &
sgio
->
dxã½
))

274  -
EFAULT
;

276 
	}
}

278 
	$sg_ioùl_Œªs
(
fd
, 
cmd
,

279 
sg_io_hdr32_t
 
__u£r
 *
sgio32
)

281 
sg_io_hdr_t
 
__u£r
 *
sgio
;

282 
u16
 
iovec_couÁ
;

283 
u32
 
d©a
;

284 
__u£r
 *
dxã½
;

285 
”r
;

286 
š‹rçû_id
;

288 ià(
	`g‘_u£r
(
š‹rçû_id
, &
sgio32
->interface_id))

289  -
EFAULT
;

290 ià(
š‹rçû_id
 != 'S')

291  
	`sys_ioùl
(
fd
, 
cmd
, ()
sgio32
);

293 ià(
	`g‘_u£r
(
iovec_couÁ
, &
sgio32
->iovec_count))

294  -
EFAULT
;

297 
__u£r
 *
tİ
 = 
	`com·t_®loc_u£r_¥aû
(0);

298 
__u£r
 *
Ãw
 = 
	`com·t_®loc_u£r_¥aû
((
sg_io_hdr_t
) +

299 (
iovec_couÁ
 * (
sg_iovec_t
)));

300 ià(
Ãw
 > 
tİ
)

301  -
EINVAL
;

303 
sgio
 = 
Ãw
;

307 ià(
	`cİy_š_u£r
(&
sgio
->
š‹rçû_id
, &
sgio32
->interface_id,

312  -
EFAULT
;

314 ià(
	`g‘_u£r
(
d©a
, &
sgio32
->
dxã½
))

315  -
EFAULT
;

316 
dxã½
 = 
	`com·t_±r
(
d©a
);

317 ià(
iovec_couÁ
) {

318 ià(
	`sg_bud_iovec
(
sgio
, 
dxã½
, 
iovec_couÁ
))

319  -
EFAULT
;

321 ià(
	`put_u£r
(
dxã½
, &
sgio
->dxferp))

322  -
EFAULT
;

326 
__u£r
 *
cmdp
;

327 
__u£r
 *
sbp
;

329 ià(
	`g‘_u£r
(
d©a
, &
sgio32
->
cmdp
))

330  -
EFAULT
;

331 
cmdp
 = 
	`com·t_±r
(
d©a
);

333 ià(
	`g‘_u£r
(
d©a
, &
sgio32
->
sbp
))

334  -
EFAULT
;

335 
sbp
 = 
	`com·t_±r
(
d©a
);

337 ià(
	`put_u£r
(
cmdp
, &
sgio
->cmdp) ||

338 
	`put_u£r
(
sbp
, &
sgio
->sbp))

339  -
EFAULT
;

342 ià(
	`cİy_š_u£r
(&
sgio
->
timeout
, &
sgio32
->timeout,

344  -
EFAULT
;

346 ià(
	`g‘_u£r
(
d©a
, &
sgio32
->
u¤_±r
))

347  -
EFAULT
;

348 ià(
	`put_u£r
(
	`com·t_±r
(
d©a
), &
sgio
->
u¤_±r
))

349  -
EFAULT
;

351 
”r
 = 
	`sys_ioùl
(
fd
, 
cmd
, (è
sgio
);

353 ià(
”r
 >= 0) {

354 
__u£r
 *
d©­
;

356 ià(
	`cİy_š_u£r
(&
sgio32
->
·ck_id
, &
sgio
->pack_id,

358 
	`g‘_u£r
(
d©­
, &
sgio
->
u¤_±r
) ||

359 
	`put_u£r
((
u32
)()
d©­
,

360 &
sgio32
->
u¤_±r
) ||

361 
	`cİy_š_u£r
(&
sgio32
->
¡©us
, &
sgio
->status,

365 
”r
 = -
EFAULT
;

368  
”r
;

369 
	}
}

371 
	scom·t_sg_»q_šfo
 {

372 
	m»q_¡©e
;

373 
	mÜphª
;

374 
	msg_io_owÃd
;

375 
	m´obËm
;

376 
	m·ck_id
;

377 
com·t_u±r_t
 
	mu¤_±r
;

378 
	mdu¿tiÚ
;

379 
	munu£d
;

382 
	$sg_g¹_Œªs
(
fd
, 
cmd
, 

383 
com·t_sg_»q_šfo
 
__u£r
 *
o
)

385 
”r
, 
i
;

386 
sg_»q_šfo_t
 
__u£r
 *
r
;

387 
r
 = 
	`com·t_®loc_u£r_¥aû
((
sg_»q_šfo_t
)*
SG_MAX_QUEUE
);

388 
”r
 = 
	`sys_ioùl
(
fd
,
cmd
,()
r
);

389 ià(
”r
 < 0)

390  
”r
;

391 
i
 = 0; i < 
SG_MAX_QUEUE
; i++) {

392 
__u£r
 *
±r
;

393 
d
;

395 ià(
	`cİy_š_u£r
(
o
 + 
i
, 
r
 + i, 
	`off£tof
(
sg_»q_šfo_t
, 
u¤_±r
)) ||

396 
	`g‘_u£r
(
±r
, &
r
[
i
].
u¤_±r
) ||

397 
	`g‘_u£r
(
d
, &
r
[
i
].
du¿tiÚ
) ||

398 
	`put_u£r
((
u32
)()(
±r
), &
o
[
i
].
u¤_±r
) ||

399 
	`put_u£r
(
d
, &
o
[
i
].
du¿tiÚ
))

400  -
EFAULT
;

402  
”r
;

403 
	}
}

406 
	ssock_årog32
 {

407 
	mËn
;

408 
com·t_ÿddr_t
 
	mf‹r
;

411 
	#PPPIOCSPASS32
 
	`_IOW
('t', 71, 
sock_årog32
)

	)

412 
	#PPPIOCSACTIVE32
 
	`_IOW
('t', 70, 
sock_årog32
)

	)

414 
	$µp_sock_årog_ioùl_Œªs
(
fd
, 
cmd
,

415 
sock_årog32
 
__u£r
 *
u_årog32
)

417 
sock_årog
 
__u£r
 *
u_årog64
 = 
	`com·t_®loc_u£r_¥aû
((sock_fprog));

418 
__u£r
 *
åŒ64
;

419 
u32
 
åŒ32
;

420 
u16
 
æ’
;

422 ià(
	`g‘_u£r
(
æ’
, &
u_årog32
->
Ën
) ||

423 
	`g‘_u£r
(
åŒ32
, &
u_årog32
->
f‹r
))

424  -
EFAULT
;

426 
åŒ64
 = 
	`com·t_±r
(
åŒ32
);

428 ià(
	`put_u£r
(
æ’
, &
u_årog64
->
Ën
) ||

429 
	`put_u£r
(
åŒ64
, &
u_årog64
->
f‹r
))

430  -
EFAULT
;

432 ià(
cmd
 =ğ
PPPIOCSPASS32
)

433 
cmd
 = 
PPPIOCSPASS
;

435 
cmd
 = 
PPPIOCSACTIVE
;

437  
	`sys_ioùl
(
fd
, 
cmd
, (è
u_årog64
);

438 
	}
}

440 
	sµp_İtiÚ_d©a32
 {

441 
com·t_ÿddr_t
 
	m±r
;

442 
u32
 
	mËngth
;

443 
com·t_št_t
 
	mŒªsm™
;

445 
	#PPPIOCSCOMPRESS32
 
	`_IOW
('t', 77, 
µp_İtiÚ_d©a32
)

	)

447 
	sµp_idË32
 {

448 
com·t_time_t
 
	mxm™_idË
;

449 
com·t_time_t
 
	m»cv_idË
;

451 
	#PPPIOCGIDLE32
 
	`_IOR
('t', 63, 
µp_idË32
)

	)

453 
	$µp_gidË
(
fd
, 
cmd
,

454 
µp_idË32
 
__u£r
 *
idË32
)

456 
µp_idË
 
__u£r
 *
idË
;

457 
__k”Ãl_time_t
 
xm™
, 
»cv
;

458 
”r
;

460 
idË
 = 
	`com·t_®loc_u£r_¥aû
((*idle));

462 
”r
 = 
	`sys_ioùl
(
fd
, 
PPPIOCGIDLE
, (è
idË
);

464 ià(!
”r
) {

465 ià(
	`g‘_u£r
(
xm™
, &
idË
->
xm™_idË
) ||

466 
	`g‘_u£r
(
»cv
, &
idË
->
»cv_idË
) ||

467 
	`put_u£r
(
xm™
, &
idË32
->
xm™_idË
) ||

468 
	`put_u£r
(
»cv
, &
idË32
->
»cv_idË
))

469 
”r
 = -
EFAULT
;

471  
”r
;

472 
	}
}

474 
	$µp_scom´ess
(
fd
, 
cmd
,

475 
µp_İtiÚ_d©a32
 
__u£r
 *
od©a32
)

477 
µp_İtiÚ_d©a
 
__u£r
 *
od©a
;

478 
__u32
 
d©a
;

479 
__u£r
 *
d©­
;

481 
od©a
 = 
	`com·t_®loc_u£r_¥aû
((*odata));

483 ià(
	`g‘_u£r
(
d©a
, &
od©a32
->
±r
))

484  -
EFAULT
;

486 
d©­
 = 
	`com·t_±r
(
d©a
);

487 ià(
	`put_u£r
(
d©­
, &
od©a
->
±r
))

488  -
EFAULT
;

490 ià(
	`cİy_š_u£r
(&
od©a
->
Ëngth
, &
od©a32
->length,

491 (
__u32
) + ()))

492  -
EFAULT
;

494  
	`sys_ioùl
(
fd
, 
PPPIOCSCOMPRESS
, (è
od©a
);

495 
	}
}

497 #ifdeà
CONFIG_BLOCK


498 
	smtg‘32
 {

499 
com·t_lÚg_t
 
	mmt_ty³
;

500 
com·t_lÚg_t
 
	mmt_»sid
;

501 
com·t_lÚg_t
 
	mmt_d¤eg
;

502 
com·t_lÚg_t
 
	mmt_g¡©
;

503 
com·t_lÚg_t
 
	mmt_”»g
;

504 
com·t_daddr_t
 
	mmt_f’o
;

505 
com·t_daddr_t
 
	mmt_blkno
;

507 
	#MTIOCGET32
 
	`_IOR
('m', 2, 
mtg‘32
)

	)

509 
	smos32
 {

510 
com·t_lÚg_t
 
	mmt_blkno
;

512 
	#MTIOCPOS32
 
	`_IOR
('m', 3, 
mos32
)

	)

514 
	$mt_ioùl_Œªs
(
fd
, 
cmd
, 
__u£r
 *
¬gp
)

516 
mm_£gm’t_t
 
Şd_fs
 = 
	`g‘_fs
();

517 
mtg‘
 
g‘
;

518 
mtg‘32
 
__u£r
 *
umg‘32
;

519 
mos
 
pos
;

520 
mos32
 
__u£r
 *
upos32
;

521 
kcmd
;

522 *
k¬g
;

523 
”r
 = 0;

525 
cmd
) {

526 
MTIOCPOS32
:

527 
kcmd
 = 
MTIOCPOS
;

528 
k¬g
 = &
pos
;

531 
kcmd
 = 
MTIOCGET
;

532 
k¬g
 = &
g‘
;

535 
	`£t_fs
 (
KERNEL_DS
);

536 
”r
 = 
	`sys_ioùl
 (
fd
, 
kcmd
, ()
k¬g
);

537 
	`£t_fs
 (
Şd_fs
);

538 ià(
”r
)

539  
”r
;

540 
cmd
) {

541 
MTIOCPOS32
:

542 
upos32
 = 
¬gp
;

543 
”r
 = 
	`__put_u£r
(
pos
.
mt_blkno
, &
upos32
->mt_blkno);

545 
MTIOCGET32
:

546 
umg‘32
 = 
¬gp
;

547 
”r
 = 
	`__put_u£r
(
g‘
.
mt_ty³
, &
umg‘32
->mt_type);

548 
”r
 |ğ
	`__put_u£r
(
g‘
.
mt_»sid
, &
umg‘32
->mt_resid);

549 
”r
 |ğ
	`__put_u£r
(
g‘
.
mt_d¤eg
, &
umg‘32
->mt_dsreg);

550 
”r
 |ğ
	`__put_u£r
(
g‘
.
mt_g¡©
, &
umg‘32
->mt_gstat);

551 
”r
 |ğ
	`__put_u£r
(
g‘
.
mt_”»g
, &
umg‘32
->mt_erreg);

552 
”r
 |ğ
	`__put_u£r
(
g‘
.
mt_f’o
, &
umg‘32
->mt_fileno);

553 
”r
 |ğ
	`__put_u£r
(
g‘
.
mt_blkno
, &
umg‘32
->mt_blkno);

556  
”r
 ? -
EFAULT
: 0;

557 
	}
}

562 
	#HCIUARTSETPROTO
 
	`_IOW
('U', 200, )

	)

563 
	#HCIUARTGETPROTO
 
	`_IOR
('U', 201, )

	)

564 
	#HCIUARTGETDEVICE
 
	`_IOR
('U', 202, )

	)

565 
	#HCIUARTSETFLAGS
 
	`_IOW
('U', 203, )

	)

566 
	#HCIUARTGETFLAGS
 
	`_IOR
('U', 204, )

	)

568 
	#BNEPCONNADD
 
	`_IOW
('B', 200, )

	)

569 
	#BNEPCONNDEL
 
	`_IOW
('B', 201, )

	)

570 
	#BNEPGETCONNLIST
 
	`_IOR
('B', 210, )

	)

571 
	#BNEPGETCONNINFO
 
	`_IOR
('B', 211, )

	)

573 
	#CMTPCONNADD
 
	`_IOW
('C', 200, )

	)

574 
	#CMTPCONNDEL
 
	`_IOW
('C', 201, )

	)

575 
	#CMTPGETCONNLIST
 
	`_IOR
('C', 210, )

	)

576 
	#CMTPGETCONNINFO
 
	`_IOR
('C', 211, )

	)

578 
	#HIDPCONNADD
 
	`_IOW
('H', 200, )

	)

579 
	#HIDPCONNDEL
 
	`_IOW
('H', 201, )

	)

580 
	#HIDPGETCONNLIST
 
	`_IOR
('H', 210, )

	)

581 
	#HIDPGETCONNINFO
 
	`_IOR
('H', 211, )

	)

584 
	s£rŸl_¡ruù32
 {

585 
com·t_št_t
 
	mty³
;

586 
com·t_št_t
 
	mlše
;

587 
com·t_ušt_t
 
	mpÜt
;

588 
com·t_št_t
 
	mœq
;

589 
com·t_št_t
 
	mæags
;

590 
com·t_št_t
 
	mxm™_fifo_size
;

591 
com·t_št_t
 
	mcu¡om_divisÜ
;

592 
com·t_št_t
 
	mbaud_ba£
;

593 
	mşo£_d–ay
;

594 
	mio_ty³
;

595 
	m»£rved_ch¬
[1];

596 
com·t_št_t
 
	mhub6
;

597 
	mşosšg_wa™
;

598 
	mşosšg_wa™2
;

599 
com·t_ušt_t
 
	miomem_ba£
;

600 
	miomem_»g_shiá
;

601 
	mpÜt_high
;

603 
com·t_št_t
 
	m»£rved
[1];

606 
	$£rŸl_¡ruù_ioùl
(
fd
, 
cmd
,

607 
£rŸl_¡ruù32
 
__u£r
 *
ss32
)

609 
£rŸl_¡ruù
 
	tSS
;

610 
£rŸl_¡ruù32
 
	tSS32
;

611 
”r
;

612 
£rŸl_¡ruù
 
ss
;

613 
mm_£gm’t_t
 
Şd£g
 = 
	`g‘_fs
();

614 
__u32
 
ud©a
;

615 
ba£
;

617 ià(
cmd
 =ğ
TIOCSSERIAL
) {

618 ià(!
	`acûss_ok
(
VERIFY_READ
, 
ss32
, (
SS32
)))

619  -
EFAULT
;

620 ià(
	`__cİy_äom_u£r
(&
ss
, 
ss32
, 
	`off£tof
(
SS32
, 
iomem_ba£
)))

621  -
EFAULT
;

622 ià(
	`__g‘_u£r
(
ud©a
, &
ss32
->
iomem_ba£
))

623  -
EFAULT
;

624 
ss
.
iomem_ba£
 = 
	`com·t_±r
(
ud©a
);

625 ià(
	`__g‘_u£r
(
ss
.
iomem_»g_shiá
, &
ss32
->iomem_reg_shift) ||

626 
	`__g‘_u£r
(
ss
.
pÜt_high
, &
ss32
->port_high))

627  -
EFAULT
;

628 
ss
.
iom­_ba£
 = 0UL;

630 
	`£t_fs
(
KERNEL_DS
);

631 
”r
 = 
	`sys_ioùl
(
fd
,
cmd
,()(&
ss
));

632 
	`£t_fs
(
Şd£g
);

633 ià(
cmd
 =ğ
TIOCGSERIAL
 && 
”r
 >= 0) {

634 ià(!
	`acûss_ok
(
VERIFY_WRITE
, 
ss32
, (
SS32
)))

635  -
EFAULT
;

636 ià(
	`__cİy_to_u£r
(
ss32
,&
ss
,
	`off£tof
(
SS32
,
iomem_ba£
)))

637  -
EFAULT
;

638 
ba£
 = ()
ss
.
iomem_ba£
 >> 32 ?

639 0xfffffffà: ()()
ss
.
iomem_ba£
;

640 ià(
	`__put_u£r
(
ba£
, &
ss32
->
iomem_ba£
) ||

641 
	`__put_u£r
(
ss
.
iomem_»g_shiá
, &
ss32
->iomem_reg_shift) ||

642 
	`__put_u£r
(
ss
.
pÜt_high
, &
ss32
->port_high))

643  -
EFAULT
;

645  
”r
;

646 
	}
}

652 
	si2c_msg32
 {

653 
u16
 
	maddr
;

654 
u16
 
	mæags
;

655 
u16
 
	mËn
;

656 
com·t_ÿddr_t
 
	mbuf
;

659 
	si2c_rdwr_ioùl_d©a32
 {

660 
com·t_ÿddr_t
 
	mmsgs
;

661 
u32
 
	mnmsgs
;

664 
	si2c_smbus_ioùl_d©a32
 {

665 
u8
 
	m»ad_wr™e
;

666 
u8
 
	mcommªd
;

667 
u32
 
	msize
;

668 
com·t_ÿddr_t
 
	md©a
;

671 
	si2c_rdwr_®igÃd
 {

672 
i2c_rdwr_ioùl_d©a
 
	mcmd
;

673 
i2c_msg
 
	mmsgs
[0];

676 
	$do_i2c_rdwr_ioùl
(
fd
, 
cmd
,

677 
i2c_rdwr_ioùl_d©a32
 
__u£r
 *
ud©a
)

679 
i2c_rdwr_®igÃd
 
__u£r
 *
td©a
;

680 
i2c_msg
 
__u£r
 *
tmsgs
;

681 
i2c_msg32
 
__u£r
 *
umsgs
;

682 
com·t_ÿddr_t
 
d©­
;

683 
nmsgs
, 
i
;

685 ià(
	`g‘_u£r
(
nmsgs
, &
ud©a
->nmsgs))

686  -
EFAULT
;

687 ià(
nmsgs
 > 
I2C_RDRW_IOCTL_MAX_MSGS
)

688  -
EINVAL
;

690 ià(
	`g‘_u£r
(
d©­
, &
ud©a
->
msgs
))

691  -
EFAULT
;

692 
umsgs
 = 
	`com·t_±r
(
d©­
);

694 
td©a
 = 
	`com·t_®loc_u£r_¥aû
((*tdata) +

695 
nmsgs
 * (
i2c_msg
));

696 
tmsgs
 = &
td©a
->
msgs
[0];

698 ià(
	`put_u£r
(
nmsgs
, &
td©a
->
cmd
.nmsgs) ||

699 
	`put_u£r
(
tmsgs
, &
td©a
->
cmd
.
msgs
))

700  -
EFAULT
;

702 
i
 = 0; i < 
nmsgs
; i++) {

703 ià(
	`cİy_š_u£r
(&
tmsgs
[
i
].
addr
, &
umsgs
[i].addr, 3*(
u16
)))

704  -
EFAULT
;

705 ià(
	`g‘_u£r
(
d©­
, &
umsgs
[
i
].
buf
) ||

706 
	`put_u£r
(
	`com·t_±r
(
d©­
), &
tmsgs
[
i
].
buf
))

707  -
EFAULT
;

709  
	`sys_ioùl
(
fd
, 
cmd
, ()
td©a
);

710 
	}
}

712 
	$do_i2c_smbus_ioùl
(
fd
, 
cmd
,

713 
i2c_smbus_ioùl_d©a32
 
__u£r
 *
ud©a
)

715 
i2c_smbus_ioùl_d©a
 
__u£r
 *
td©a
;

716 
com·t_ÿddr_t
 
d©­
;

718 
td©a
 = 
	`com·t_®loc_u£r_¥aû
((*tdata));

719 ià(
td©a
 =ğ
NULL
)

720  -
ENOMEM
;

721 ià(!
	`acûss_ok
(
VERIFY_WRITE
, 
td©a
, (*tdata)))

722  -
EFAULT
;

724 ià(!
	`acûss_ok
(
VERIFY_READ
, 
ud©a
, (*udata)))

725  -
EFAULT
;

727 ià(
	`__cİy_š_u£r
(&
td©a
->
»ad_wr™e
, &
ud©a
->»ad_wr™e, 2 * (
u8
)))

728  -
EFAULT
;

729 ià(
	`__cİy_š_u£r
(&
td©a
->
size
, &
ud©a
->size, 2 * (
u32
)))

730  -
EFAULT
;

731 ià(
	`__g‘_u£r
(
d©­
, &
ud©a
->
d©a
) ||

732 
	`__put_u£r
(
	`com·t_±r
(
d©­
), &
td©a
->
d©a
))

733  -
EFAULT
;

735  
	`sys_ioùl
(
fd
, 
cmd
, ()
td©a
);

736 
	}
}

738 
	#RTC_IRQP_READ32
 
	`_IOR
('p', 0x0b, 
com·t_ulÚg_t
)

	)

739 
	#RTC_IRQP_SET32
 
	`_IOW
('p', 0x0c, 
com·t_ulÚg_t
)

	)

740 
	#RTC_EPOCH_READ32
 
	`_IOR
('p', 0x0d, 
com·t_ulÚg_t
)

	)

741 
	#RTC_EPOCH_SET32
 
	`_IOW
('p', 0x0e, 
com·t_ulÚg_t
)

	)

743 
	$¹c_ioùl
(
fd
, 
cmd
, 
__u£r
 *
¬gp
)

745 
mm_£gm’t_t
 
Şdfs
 = 
	`g‘_fs
();

746 
com·t_ulÚg_t
 
v®32
;

747 
kv®
;

748 
»t
;

750 
cmd
) {

751 
RTC_IRQP_READ32
:

752 
RTC_EPOCH_READ32
:

753 
	`£t_fs
(
KERNEL_DS
);

754 
»t
 = 
	`sys_ioùl
(
fd
, (
cmd
 =ğ
RTC_IRQP_READ32
) ?

755 
RTC_IRQP_READ
 : 
RTC_EPOCH_READ
,

756 ()&
kv®
);

757 
	`£t_fs
(
Şdfs
);

758 ià(
»t
)

759  
»t
;

760 
v®32
 = 
kv®
;

761  
	`put_u£r
(
v®32
, (
__u£r
 *)
¬gp
);

762 
RTC_IRQP_SET32
:

763  
	`sys_ioùl
(
fd
, 
RTC_IRQP_SET
, ()
¬gp
);

764 
RTC_EPOCH_SET32
:

765  
	`sys_ioùl
(
fd
, 
RTC_EPOCH_SET
, ()
¬gp
);

768  -
ENOIOCTLCMD
;

769 
	}
}

772 #ià
defšed
(
CONFIG_IA64
è|| defšed(
CONFIG_X86_64
)

773 
	s¥aû_»sv_32
 {

774 
__s16
 
	ml_ty³
;

775 
__s16
 
	ml_wh’û
;

776 
__s64
 
l_¡¬t
 
__©Œibu‹__
((
·cked
));

778 
__s64
 
l_Ën
 
__©Œibu‹__
((
·cked
));

779 
__s32
 
	ml_sysid
;

780 
__u32
 
	ml_pid
;

781 
__s32
 
	ml_·d
[4];

784 
	#FS_IOC_RESVSP_32
 
	`_IOW
 ('X', 40, 
¥aû_»sv_32
)

	)

785 
	#FS_IOC_RESVSP64_32
 
	`_IOW
 ('X', 42, 
¥aû_»sv_32
)

	)

788 
	$com·t_ioùl_´—Îoÿ‹
(
fe
 *file,

789 
¥aû_»sv_32
 
__u£r
 *
p32
)

791 
¥aû_»sv
 
__u£r
 *
p
 = 
	`com·t_®loc_u£r_¥aû
((*p));

793 ià(
	`cİy_š_u£r
(&
p
->
l_ty³
, &
p32
->l_ty³, (
s16
)) ||

794 
	`cİy_š_u£r
(&
p
->
l_wh’û
, &
p32
->l_wh’û, (
s16
)) ||

795 
	`cİy_š_u£r
(&
p
->
l_¡¬t
, &
p32
->l_¡¬t, (
s64
)) ||

796 
	`cİy_š_u£r
(&
p
->
l_Ën
, &
p32
->l_Ën, (
s64
)) ||

797 
	`cİy_š_u£r
(&
p
->
l_sysid
, &
p32
->l_sysid, (
s32
)) ||

798 
	`cİy_š_u£r
(&
p
->
l_pid
, &
p32
->l_pid, (
u32
)) ||

799 
	`cİy_š_u£r
(&
p
->
l_·d
, &
p32
->l_·d, 4*(
u32
)))

800  -
EFAULT
;

802  
	`ioùl_´—Îoÿ‹
(
fe
, 
p
);

803 
	}
}

810 
	#XFORM
(
i
è(((iè^ ((iè<< 27è^ ((iè<< 17)è& 0xffffffff)

	)

812 
	#COMPATIBLE_IOCTL
(
cmd
è
	`XFORM
(cmd),

	)

820 
	#IGNORE_IOCTL
(
cmd
è
	`COMPATIBLE_IOCTL
(cmd)

	)

822 
	gioùl_poš‹r
[] = {

824 
COMPATIBLE_IOCTL
(0x4B50)

825 
COMPATIBLE_IOCTL
(0x4B51)

828 
COMPATIBLE_IOCTL
(
TCGETA
)

829 
COMPATIBLE_IOCTL
(
TCSETA
)

830 
COMPATIBLE_IOCTL
(
TCSETAW
)

831 
COMPATIBLE_IOCTL
(
TCSETAF
)

832 
COMPATIBLE_IOCTL
(
TCSBRK
)

833 
COMPATIBLE_IOCTL
(
TCXONC
)

834 
COMPATIBLE_IOCTL
(
TCFLSH
)

835 
COMPATIBLE_IOCTL
(
TCGETS
)

836 
COMPATIBLE_IOCTL
(
TCSETS
)

837 
COMPATIBLE_IOCTL
(
TCSETSW
)

838 
COMPATIBLE_IOCTL
(
TCSETSF
)

839 
COMPATIBLE_IOCTL
(
TIOCLINUX
)

840 
COMPATIBLE_IOCTL
(
TIOCSBRK
)

841 
COMPATIBLE_IOCTL
(
TIOCGDEV
)

842 
COMPATIBLE_IOCTL
(
TIOCCBRK
)

843 
COMPATIBLE_IOCTL
(
TIOCGSID
)

844 
COMPATIBLE_IOCTL
(
TIOCGICOUNT
)

846 
COMPATIBLE_IOCTL
(
TIOCGETD
)

847 
COMPATIBLE_IOCTL
(
TIOCSETD
)

848 
COMPATIBLE_IOCTL
(
TIOCEXCL
)

849 
COMPATIBLE_IOCTL
(
TIOCNXCL
)

850 
COMPATIBLE_IOCTL
(
TIOCCONS
)

851 
COMPATIBLE_IOCTL
(
TIOCGSOFTCAR
)

852 
COMPATIBLE_IOCTL
(
TIOCSSOFTCAR
)

853 
COMPATIBLE_IOCTL
(
TIOCSWINSZ
)

854 
COMPATIBLE_IOCTL
(
TIOCGWINSZ
)

855 
COMPATIBLE_IOCTL
(
TIOCMGET
)

856 
COMPATIBLE_IOCTL
(
TIOCMBIC
)

857 
COMPATIBLE_IOCTL
(
TIOCMBIS
)

858 
COMPATIBLE_IOCTL
(
TIOCMSET
)

859 
COMPATIBLE_IOCTL
(
TIOCPKT
)

860 
COMPATIBLE_IOCTL
(
TIOCNOTTY
)

861 
COMPATIBLE_IOCTL
(
TIOCSTI
)

862 
COMPATIBLE_IOCTL
(
TIOCOUTQ
)

863 
COMPATIBLE_IOCTL
(
TIOCSPGRP
)

864 
COMPATIBLE_IOCTL
(
TIOCGPGRP
)

865 
COMPATIBLE_IOCTL
(
TIOCGPTN
)

866 
COMPATIBLE_IOCTL
(
TIOCSPTLCK
)

867 
COMPATIBLE_IOCTL
(
TIOCSERGETLSR
)

868 
COMPATIBLE_IOCTL
(
TIOCSIG
)

869 #ifdeà
TCGETS2


870 
COMPATIBLE_IOCTL
(
TCGETS2
)

871 
COMPATIBLE_IOCTL
(
TCSETS2
)

872 
COMPATIBLE_IOCTL
(
TCSETSW2
)

873 
COMPATIBLE_IOCTL
(
TCSETSF2
)

876 
COMPATIBLE_IOCTL
(
FIOCLEX
)

877 
COMPATIBLE_IOCTL
(
FIONCLEX
)

878 
COMPATIBLE_IOCTL
(
FIOASYNC
)

879 
COMPATIBLE_IOCTL
(
FIONBIO
)

880 
COMPATIBLE_IOCTL
(
FIONREAD
)

881 
COMPATIBLE_IOCTL
(
FS_IOC_FIEMAP
)

883 
COMPATIBLE_IOCTL
(
FIBMAP
)

884 
COMPATIBLE_IOCTL
(
FIGETBSZ
)

886 
COMPATIBLE_IOCTL
(
FIFREEZE
)

887 
COMPATIBLE_IOCTL
(
FITHAW
)

888 
COMPATIBLE_IOCTL
(
KDGETKEYCODE
)

889 
COMPATIBLE_IOCTL
(
KDSETKEYCODE
)

890 
COMPATIBLE_IOCTL
(
KDGKBTYPE
)

891 
COMPATIBLE_IOCTL
(
KDGETMODE
)

892 
COMPATIBLE_IOCTL
(
KDGKBMODE
)

893 
COMPATIBLE_IOCTL
(
KDGKBMETA
)

894 
COMPATIBLE_IOCTL
(
KDGKBENT
)

895 
COMPATIBLE_IOCTL
(
KDSKBENT
)

896 
COMPATIBLE_IOCTL
(
KDGKBSENT
)

897 
COMPATIBLE_IOCTL
(
KDSKBSENT
)

898 
COMPATIBLE_IOCTL
(
KDGKBDIACR
)

899 
COMPATIBLE_IOCTL
(
KDSKBDIACR
)

900 
COMPATIBLE_IOCTL
(
KDKBDREP
)

901 
COMPATIBLE_IOCTL
(
KDGKBLED
)

902 
COMPATIBLE_IOCTL
(
KDGETLED
)

903 #ifdeà
CONFIG_BLOCK


905 
COMPATIBLE_IOCTL
(
SCSI_IOCTL_GET_IDLUN
)

906 
COMPATIBLE_IOCTL
(
SCSI_IOCTL_DOORLOCK
)

907 
COMPATIBLE_IOCTL
(
SCSI_IOCTL_DOORUNLOCK
)

908 
COMPATIBLE_IOCTL
(
SCSI_IOCTL_TEST_UNIT_READY
)

909 
COMPATIBLE_IOCTL
(
SCSI_IOCTL_GET_BUS_NUMBER
)

910 
COMPATIBLE_IOCTL
(
SCSI_IOCTL_SEND_COMMAND
)

911 
COMPATIBLE_IOCTL
(
SCSI_IOCTL_PROBE_HOST
)

912 
COMPATIBLE_IOCTL
(
SCSI_IOCTL_GET_PCI
)

915 
IGNORE_IOCTL
(
VT_OPENQRY
)

916 
IGNORE_IOCTL
(
VT_GETMODE
)

918 
COMPATIBLE_IOCTL
(
RTC_AIE_ON
)

919 
COMPATIBLE_IOCTL
(
RTC_AIE_OFF
)

920 
COMPATIBLE_IOCTL
(
RTC_UIE_ON
)

921 
COMPATIBLE_IOCTL
(
RTC_UIE_OFF
)

922 
COMPATIBLE_IOCTL
(
RTC_PIE_ON
)

923 
COMPATIBLE_IOCTL
(
RTC_PIE_OFF
)

924 
COMPATIBLE_IOCTL
(
RTC_WIE_ON
)

925 
COMPATIBLE_IOCTL
(
RTC_WIE_OFF
)

926 
COMPATIBLE_IOCTL
(
RTC_ALM_SET
)

927 
COMPATIBLE_IOCTL
(
RTC_ALM_READ
)

928 
COMPATIBLE_IOCTL
(
RTC_RD_TIME
)

929 
COMPATIBLE_IOCTL
(
RTC_SET_TIME
)

930 
COMPATIBLE_IOCTL
(
RTC_WKALM_SET
)

931 
COMPATIBLE_IOCTL
(
RTC_WKALM_RD
)

938 
COMPATIBLE_IOCTL
(
_IOR
('p', 20, [7]))

939 
COMPATIBLE_IOCTL
(
_IOW
('p', 21, [7]))

941 
COMPATIBLE_IOCTL
(
MTIOCTOP
)

943 
COMPATIBLE_IOCTL
(
FIOQSIZE
)

944 #ifdeà
CONFIG_BLOCK


946 
IGNORE_IOCTL
(
LOOP_CLR_FD
)

948 
IGNORE_IOCTL
(
RAID_VERSION
)

950 
IGNORE_IOCTL
(
CDROM_DRIVE_STATUS
)

951 
IGNORE_IOCTL
(
FDGETPRM32
)

953 
COMPATIBLE_IOCTL
(
SG_SET_TIMEOUT
)

954 
COMPATIBLE_IOCTL
(
SG_GET_TIMEOUT
)

955 
COMPATIBLE_IOCTL
(
SG_EMULATED_HOST
)

956 
COMPATIBLE_IOCTL
(
SG_GET_TRANSFORM
)

957 
COMPATIBLE_IOCTL
(
SG_SET_RESERVED_SIZE
)

958 
COMPATIBLE_IOCTL
(
SG_GET_RESERVED_SIZE
)

959 
COMPATIBLE_IOCTL
(
SG_GET_SCSI_ID
)

960 
COMPATIBLE_IOCTL
(
SG_SET_FORCE_LOW_DMA
)

961 
COMPATIBLE_IOCTL
(
SG_GET_LOW_DMA
)

962 
COMPATIBLE_IOCTL
(
SG_SET_FORCE_PACK_ID
)

963 
COMPATIBLE_IOCTL
(
SG_GET_PACK_ID
)

964 
COMPATIBLE_IOCTL
(
SG_GET_NUM_WAITING
)

965 
COMPATIBLE_IOCTL
(
SG_SET_DEBUG
)

966 
COMPATIBLE_IOCTL
(
SG_GET_SG_TABLESIZE
)

967 
COMPATIBLE_IOCTL
(
SG_GET_COMMAND_Q
)

968 
COMPATIBLE_IOCTL
(
SG_SET_COMMAND_Q
)

969 
COMPATIBLE_IOCTL
(
SG_GET_VERSION_NUM
)

970 
COMPATIBLE_IOCTL
(
SG_NEXT_CMD_LEN
)

971 
COMPATIBLE_IOCTL
(
SG_SCSI_RESET
)

972 
COMPATIBLE_IOCTL
(
SG_GET_REQUEST_TABLE
)

973 
COMPATIBLE_IOCTL
(
SG_SET_KEEP_ORPHAN
)

974 
COMPATIBLE_IOCTL
(
SG_GET_KEEP_ORPHAN
)

977 
COMPATIBLE_IOCTL
(
PPPIOCGFLAGS
)

978 
COMPATIBLE_IOCTL
(
PPPIOCSFLAGS
)

979 
COMPATIBLE_IOCTL
(
PPPIOCGASYNCMAP
)

980 
COMPATIBLE_IOCTL
(
PPPIOCSASYNCMAP
)

981 
COMPATIBLE_IOCTL
(
PPPIOCGUNIT
)

982 
COMPATIBLE_IOCTL
(
PPPIOCGRASYNCMAP
)

983 
COMPATIBLE_IOCTL
(
PPPIOCSRASYNCMAP
)

984 
COMPATIBLE_IOCTL
(
PPPIOCGMRU
)

985 
COMPATIBLE_IOCTL
(
PPPIOCSMRU
)

986 
COMPATIBLE_IOCTL
(
PPPIOCSMAXCID
)

987 
COMPATIBLE_IOCTL
(
PPPIOCGXASYNCMAP
)

988 
COMPATIBLE_IOCTL
(
PPPIOCSXASYNCMAP
)

989 
COMPATIBLE_IOCTL
(
PPPIOCXFERUNIT
)

991 
COMPATIBLE_IOCTL
(
PPPIOCGNPMODE
)

992 
COMPATIBLE_IOCTL
(
PPPIOCSNPMODE
)

993 
COMPATIBLE_IOCTL
(
PPPIOCGDEBUG
)

994 
COMPATIBLE_IOCTL
(
PPPIOCSDEBUG
)

998 
COMPATIBLE_IOCTL
(
PPPIOCNEWUNIT
)

999 
COMPATIBLE_IOCTL
(
PPPIOCATTACH
)

1000 
COMPATIBLE_IOCTL
(
PPPIOCDETACH
)

1001 
COMPATIBLE_IOCTL
(
PPPIOCSMRRU
)

1002 
COMPATIBLE_IOCTL
(
PPPIOCCONNECT
)

1003 
COMPATIBLE_IOCTL
(
PPPIOCDISCONN
)

1004 
COMPATIBLE_IOCTL
(
PPPIOCATTCHAN
)

1005 
COMPATIBLE_IOCTL
(
PPPIOCGCHAN
)

1006 
COMPATIBLE_IOCTL
(
PPPIOCGL2TPSTATS
)

1008 
COMPATIBLE_IOCTL
(
PPPOEIOCSFWD
)

1009 
COMPATIBLE_IOCTL
(
PPPOEIOCDFWD
)

1011 
COMPATIBLE_IOCTL
(
PPSETMODE
)

1012 
COMPATIBLE_IOCTL
(
PPRSTATUS
)

1013 
COMPATIBLE_IOCTL
(
PPRCONTROL
)

1014 
COMPATIBLE_IOCTL
(
PPWCONTROL
)

1015 
COMPATIBLE_IOCTL
(
PPFCONTROL
)

1016 
COMPATIBLE_IOCTL
(
PPRDATA
)

1017 
COMPATIBLE_IOCTL
(
PPWDATA
)

1018 
COMPATIBLE_IOCTL
(
PPCLAIM
)

1019 
COMPATIBLE_IOCTL
(
PPRELEASE
)

1020 
COMPATIBLE_IOCTL
(
PPYIELD
)

1021 
COMPATIBLE_IOCTL
(
PPEXCL
)

1022 
COMPATIBLE_IOCTL
(
PPDATADIR
)

1023 
COMPATIBLE_IOCTL
(
PPNEGOT
)

1024 
COMPATIBLE_IOCTL
(
PPWCTLONIRQ
)

1025 
COMPATIBLE_IOCTL
(
PPCLRIRQ
)

1026 
COMPATIBLE_IOCTL
(
PPSETPHASE
)

1027 
COMPATIBLE_IOCTL
(
PPGETMODES
)

1028 
COMPATIBLE_IOCTL
(
PPGETMODE
)

1029 
COMPATIBLE_IOCTL
(
PPGETPHASE
)

1030 
COMPATIBLE_IOCTL
(
PPGETFLAGS
)

1031 
COMPATIBLE_IOCTL
(
PPSETFLAGS
)

1035 
COMPATIBLE_IOCTL
(
SNDCTL_SEQ_RESET
)

1036 
COMPATIBLE_IOCTL
(
SNDCTL_SEQ_SYNC
)

1037 
COMPATIBLE_IOCTL
(
SNDCTL_SYNTH_INFO
)

1038 
COMPATIBLE_IOCTL
(
SNDCTL_SEQ_CTRLRATE
)

1039 
COMPATIBLE_IOCTL
(
SNDCTL_SEQ_GETOUTCOUNT
)

1040 
COMPATIBLE_IOCTL
(
SNDCTL_SEQ_GETINCOUNT
)

1041 
COMPATIBLE_IOCTL
(
SNDCTL_SEQ_PERCMODE
)

1042 
COMPATIBLE_IOCTL
(
SNDCTL_FM_LOAD_INSTR
)

1043 
COMPATIBLE_IOCTL
(
SNDCTL_SEQ_TESTMIDI
)

1044 
COMPATIBLE_IOCTL
(
SNDCTL_SEQ_RESETSAMPLES
)

1045 
COMPATIBLE_IOCTL
(
SNDCTL_SEQ_NRSYNTHS
)

1046 
COMPATIBLE_IOCTL
(
SNDCTL_SEQ_NRMIDIS
)

1047 
COMPATIBLE_IOCTL
(
SNDCTL_MIDI_INFO
)

1048 
COMPATIBLE_IOCTL
(
SNDCTL_SEQ_THRESHOLD
)

1049 
COMPATIBLE_IOCTL
(
SNDCTL_SYNTH_MEMAVL
)

1050 
COMPATIBLE_IOCTL
(
SNDCTL_FM_4OP_ENABLE
)

1051 
COMPATIBLE_IOCTL
(
SNDCTL_SEQ_PANIC
)

1052 
COMPATIBLE_IOCTL
(
SNDCTL_SEQ_OUTOFBAND
)

1053 
COMPATIBLE_IOCTL
(
SNDCTL_SEQ_GETTIME
)

1054 
COMPATIBLE_IOCTL
(
SNDCTL_SYNTH_ID
)

1055 
COMPATIBLE_IOCTL
(
SNDCTL_SYNTH_CONTROL
)

1056 
COMPATIBLE_IOCTL
(
SNDCTL_SYNTH_REMOVESAMPLE
)

1058 
COMPATIBLE_IOCTL
(
SNDCTL_TMR_TIMEBASE
)

1059 
COMPATIBLE_IOCTL
(
SNDCTL_TMR_START
)

1060 
COMPATIBLE_IOCTL
(
SNDCTL_TMR_STOP
)

1061 
COMPATIBLE_IOCTL
(
SNDCTL_TMR_CONTINUE
)

1062 
COMPATIBLE_IOCTL
(
SNDCTL_TMR_TEMPO
)

1063 
COMPATIBLE_IOCTL
(
SNDCTL_TMR_SOURCE
)

1064 
COMPATIBLE_IOCTL
(
SNDCTL_TMR_METRONOME
)

1065 
COMPATIBLE_IOCTL
(
SNDCTL_TMR_SELECT
)

1067 
COMPATIBLE_IOCTL
(
SNDCTL_MIDI_PRETIME
)

1068 
COMPATIBLE_IOCTL
(
SNDCTL_MIDI_MPUMODE
)

1069 
COMPATIBLE_IOCTL
(
SNDCTL_MIDI_MPUCMD
)

1071 
COMPATIBLE_IOCTL
(
SNDCTL_DSP_RESET
)

1072 
COMPATIBLE_IOCTL
(
SNDCTL_DSP_SYNC
)

1073 
COMPATIBLE_IOCTL
(
SNDCTL_DSP_SPEED
)

1074 
COMPATIBLE_IOCTL
(
SNDCTL_DSP_STEREO
)

1075 
COMPATIBLE_IOCTL
(
SNDCTL_DSP_GETBLKSIZE
)

1076 
COMPATIBLE_IOCTL
(
SNDCTL_DSP_CHANNELS
)

1077 
COMPATIBLE_IOCTL
(
SOUND_PCM_WRITE_FILTER
)

1078 
COMPATIBLE_IOCTL
(
SNDCTL_DSP_POST
)

1079 
COMPATIBLE_IOCTL
(
SNDCTL_DSP_SUBDIVIDE
)

1080 
COMPATIBLE_IOCTL
(
SNDCTL_DSP_SETFRAGMENT
)

1081 
COMPATIBLE_IOCTL
(
SNDCTL_DSP_GETFMTS
)

1082 
COMPATIBLE_IOCTL
(
SNDCTL_DSP_SETFMT
)

1083 
COMPATIBLE_IOCTL
(
SNDCTL_DSP_GETOSPACE
)

1084 
COMPATIBLE_IOCTL
(
SNDCTL_DSP_GETISPACE
)

1085 
COMPATIBLE_IOCTL
(
SNDCTL_DSP_NONBLOCK
)

1086 
COMPATIBLE_IOCTL
(
SNDCTL_DSP_GETCAPS
)

1087 
COMPATIBLE_IOCTL
(
SNDCTL_DSP_GETTRIGGER
)

1088 
COMPATIBLE_IOCTL
(
SNDCTL_DSP_SETTRIGGER
)

1089 
COMPATIBLE_IOCTL
(
SNDCTL_DSP_GETIPTR
)

1090 
COMPATIBLE_IOCTL
(
SNDCTL_DSP_GETOPTR
)

1093 
COMPATIBLE_IOCTL
(
SNDCTL_DSP_SETSYNCRO
)

1094 
COMPATIBLE_IOCTL
(
SNDCTL_DSP_SETDUPLEX
)

1095 
COMPATIBLE_IOCTL
(
SNDCTL_DSP_GETODELAY
)

1096 
COMPATIBLE_IOCTL
(
SNDCTL_DSP_PROFILE
)

1097 
COMPATIBLE_IOCTL
(
SOUND_PCM_READ_RATE
)

1098 
COMPATIBLE_IOCTL
(
SOUND_PCM_READ_CHANNELS
)

1099 
COMPATIBLE_IOCTL
(
SOUND_PCM_READ_BITS
)

1100 
COMPATIBLE_IOCTL
(
SOUND_PCM_READ_FILTER
)

1102 
COMPATIBLE_IOCTL
(
SNDCTL_COPR_RESET
)

1103 
COMPATIBLE_IOCTL
(
SNDCTL_COPR_LOAD
)

1104 
COMPATIBLE_IOCTL
(
SNDCTL_COPR_RDATA
)

1105 
COMPATIBLE_IOCTL
(
SNDCTL_COPR_RCODE
)

1106 
COMPATIBLE_IOCTL
(
SNDCTL_COPR_WDATA
)

1107 
COMPATIBLE_IOCTL
(
SNDCTL_COPR_WCODE
)

1108 
COMPATIBLE_IOCTL
(
SNDCTL_COPR_RUN
)

1109 
COMPATIBLE_IOCTL
(
SNDCTL_COPR_HALT
)

1110 
COMPATIBLE_IOCTL
(
SNDCTL_COPR_SENDMSG
)

1111 
COMPATIBLE_IOCTL
(
SNDCTL_COPR_RCVMSG
)

1113 
COMPATIBLE_IOCTL
(
SOUND_MIXER_READ_VOLUME
)

1114 
COMPATIBLE_IOCTL
(
SOUND_MIXER_READ_BASS
)

1115 
COMPATIBLE_IOCTL
(
SOUND_MIXER_READ_TREBLE
)

1116 
COMPATIBLE_IOCTL
(
SOUND_MIXER_READ_SYNTH
)

1117 
COMPATIBLE_IOCTL
(
SOUND_MIXER_READ_PCM
)

1118 
COMPATIBLE_IOCTL
(
SOUND_MIXER_READ_SPEAKER
)

1119 
COMPATIBLE_IOCTL
(
SOUND_MIXER_READ_LINE
)

1120 
COMPATIBLE_IOCTL
(
SOUND_MIXER_READ_MIC
)

1121 
COMPATIBLE_IOCTL
(
SOUND_MIXER_READ_CD
)

1122 
COMPATIBLE_IOCTL
(
SOUND_MIXER_READ_IMIX
)

1123 
COMPATIBLE_IOCTL
(
SOUND_MIXER_READ_ALTPCM
)

1124 
COMPATIBLE_IOCTL
(
SOUND_MIXER_READ_RECLEV
)

1125 
COMPATIBLE_IOCTL
(
SOUND_MIXER_READ_IGAIN
)

1126 
COMPATIBLE_IOCTL
(
SOUND_MIXER_READ_OGAIN
)

1127 
COMPATIBLE_IOCTL
(
SOUND_MIXER_READ_LINE1
)

1128 
COMPATIBLE_IOCTL
(
SOUND_MIXER_READ_LINE2
)

1129 
COMPATIBLE_IOCTL
(
SOUND_MIXER_READ_LINE3
)

1130 
COMPATIBLE_IOCTL
(
MIXER_READ
(
SOUND_MIXER_DIGITAL1
))

1131 
COMPATIBLE_IOCTL
(
MIXER_READ
(
SOUND_MIXER_DIGITAL2
))

1132 
COMPATIBLE_IOCTL
(
MIXER_READ
(
SOUND_MIXER_DIGITAL3
))

1133 
COMPATIBLE_IOCTL
(
MIXER_READ
(
SOUND_MIXER_PHONEIN
))

1134 
COMPATIBLE_IOCTL
(
MIXER_READ
(
SOUND_MIXER_PHONEOUT
))

1135 
COMPATIBLE_IOCTL
(
MIXER_READ
(
SOUND_MIXER_VIDEO
))

1136 
COMPATIBLE_IOCTL
(
MIXER_READ
(
SOUND_MIXER_RADIO
))

1137 
COMPATIBLE_IOCTL
(
MIXER_READ
(
SOUND_MIXER_MONITOR
))

1138 
COMPATIBLE_IOCTL
(
SOUND_MIXER_READ_MUTE
)

1141 
COMPATIBLE_IOCTL
(
SOUND_MIXER_READ_RECSRC
)

1142 
COMPATIBLE_IOCTL
(
SOUND_MIXER_READ_DEVMASK
)

1143 
COMPATIBLE_IOCTL
(
SOUND_MIXER_READ_RECMASK
)

1144 
COMPATIBLE_IOCTL
(
SOUND_MIXER_READ_STEREODEVS
)

1145 
COMPATIBLE_IOCTL
(
SOUND_MIXER_READ_CAPS
)

1146 
COMPATIBLE_IOCTL
(
SOUND_MIXER_WRITE_VOLUME
)

1147 
COMPATIBLE_IOCTL
(
SOUND_MIXER_WRITE_BASS
)

1148 
COMPATIBLE_IOCTL
(
SOUND_MIXER_WRITE_TREBLE
)

1149 
COMPATIBLE_IOCTL
(
SOUND_MIXER_WRITE_SYNTH
)

1150 
COMPATIBLE_IOCTL
(
SOUND_MIXER_WRITE_PCM
)

1151 
COMPATIBLE_IOCTL
(
SOUND_MIXER_WRITE_SPEAKER
)

1152 
COMPATIBLE_IOCTL
(
SOUND_MIXER_WRITE_LINE
)

1153 
COMPATIBLE_IOCTL
(
SOUND_MIXER_WRITE_MIC
)

1154 
COMPATIBLE_IOCTL
(
SOUND_MIXER_WRITE_CD
)

1155 
COMPATIBLE_IOCTL
(
SOUND_MIXER_WRITE_IMIX
)

1156 
COMPATIBLE_IOCTL
(
SOUND_MIXER_WRITE_ALTPCM
)

1157 
COMPATIBLE_IOCTL
(
SOUND_MIXER_WRITE_RECLEV
)

1158 
COMPATIBLE_IOCTL
(
SOUND_MIXER_WRITE_IGAIN
)

1159 
COMPATIBLE_IOCTL
(
SOUND_MIXER_WRITE_OGAIN
)

1160 
COMPATIBLE_IOCTL
(
SOUND_MIXER_WRITE_LINE1
)

1161 
COMPATIBLE_IOCTL
(
SOUND_MIXER_WRITE_LINE2
)

1162 
COMPATIBLE_IOCTL
(
SOUND_MIXER_WRITE_LINE3
)

1163 
COMPATIBLE_IOCTL
(
MIXER_WRITE
(
SOUND_MIXER_DIGITAL1
))

1164 
COMPATIBLE_IOCTL
(
MIXER_WRITE
(
SOUND_MIXER_DIGITAL2
))

1165 
COMPATIBLE_IOCTL
(
MIXER_WRITE
(
SOUND_MIXER_DIGITAL3
))

1166 
COMPATIBLE_IOCTL
(
MIXER_WRITE
(
SOUND_MIXER_PHONEIN
))

1167 
COMPATIBLE_IOCTL
(
MIXER_WRITE
(
SOUND_MIXER_PHONEOUT
))

1168 
COMPATIBLE_IOCTL
(
MIXER_WRITE
(
SOUND_MIXER_VIDEO
))

1169 
COMPATIBLE_IOCTL
(
MIXER_WRITE
(
SOUND_MIXER_RADIO
))

1170 
COMPATIBLE_IOCTL
(
MIXER_WRITE
(
SOUND_MIXER_MONITOR
))

1171 
COMPATIBLE_IOCTL
(
SOUND_MIXER_WRITE_MUTE
)

1174 
COMPATIBLE_IOCTL
(
SOUND_MIXER_WRITE_RECSRC
)

1175 
COMPATIBLE_IOCTL
(
SOUND_MIXER_INFO
)

1176 
COMPATIBLE_IOCTL
(
SOUND_OLD_MIXER_INFO
)

1177 
COMPATIBLE_IOCTL
(
SOUND_MIXER_ACCESS
)

1178 
COMPATIBLE_IOCTL
(
SOUND_MIXER_AGC
)

1179 
COMPATIBLE_IOCTL
(
SOUND_MIXER_3DSE
)

1180 
COMPATIBLE_IOCTL
(
SOUND_MIXER_PRIVATE1
)

1181 
COMPATIBLE_IOCTL
(
SOUND_MIXER_PRIVATE2
)

1182 
COMPATIBLE_IOCTL
(
SOUND_MIXER_PRIVATE3
)

1183 
COMPATIBLE_IOCTL
(
SOUND_MIXER_PRIVATE4
)

1184 
COMPATIBLE_IOCTL
(
SOUND_MIXER_PRIVATE5
)

1185 
COMPATIBLE_IOCTL
(
SOUND_MIXER_GETLEVELS
)

1186 
COMPATIBLE_IOCTL
(
SOUND_MIXER_SETLEVELS
)

1187 
COMPATIBLE_IOCTL
(
OSS_GETVERSION
)

1189 
COMPATIBLE_IOCTL
(
RAW_SETBIND
)

1190 
COMPATIBLE_IOCTL
(
RAW_GETBIND
)

1192 
COMPATIBLE_IOCTL
(
WDIOC_GETSUPPORT
)

1193 
COMPATIBLE_IOCTL
(
WDIOC_GETSTATUS
)

1194 
COMPATIBLE_IOCTL
(
WDIOC_GETBOOTSTATUS
)

1195 
COMPATIBLE_IOCTL
(
WDIOC_GETTEMP
)

1196 
COMPATIBLE_IOCTL
(
WDIOC_SETOPTIONS
)

1197 
COMPATIBLE_IOCTL
(
WDIOC_KEEPALIVE
)

1198 
COMPATIBLE_IOCTL
(
WDIOC_SETTIMEOUT
)

1199 
COMPATIBLE_IOCTL
(
WDIOC_GETTIMEOUT
)

1201 
COMPATIBLE_IOCTL
(
RNDGETENTCNT
)

1202 
COMPATIBLE_IOCTL
(
RNDADDTOENTCNT
)

1203 
COMPATIBLE_IOCTL
(
RNDGETPOOL
)

1204 
COMPATIBLE_IOCTL
(
RNDADDENTROPY
)

1205 
COMPATIBLE_IOCTL
(
RNDZAPENTCNT
)

1206 
COMPATIBLE_IOCTL
(
RNDCLEARPOOL
)

1208 
COMPATIBLE_IOCTL
(
HCIDEVUP
)

1209 
COMPATIBLE_IOCTL
(
HCIDEVDOWN
)

1210 
COMPATIBLE_IOCTL
(
HCIDEVRESET
)

1211 
COMPATIBLE_IOCTL
(
HCIDEVRESTAT
)

1212 
COMPATIBLE_IOCTL
(
HCIGETDEVLIST
)

1213 
COMPATIBLE_IOCTL
(
HCIGETDEVINFO
)

1214 
COMPATIBLE_IOCTL
(
HCIGETCONNLIST
)

1215 
COMPATIBLE_IOCTL
(
HCIGETCONNINFO
)

1216 
COMPATIBLE_IOCTL
(
HCIGETAUTHINFO
)

1217 
COMPATIBLE_IOCTL
(
HCISETRAW
)

1218 
COMPATIBLE_IOCTL
(
HCISETSCAN
)

1219 
COMPATIBLE_IOCTL
(
HCISETAUTH
)

1220 
COMPATIBLE_IOCTL
(
HCISETENCRYPT
)

1221 
COMPATIBLE_IOCTL
(
HCISETPTYPE
)

1222 
COMPATIBLE_IOCTL
(
HCISETLINKPOL
)

1223 
COMPATIBLE_IOCTL
(
HCISETLINKMODE
)

1224 
COMPATIBLE_IOCTL
(
HCISETACLMTU
)

1225 
COMPATIBLE_IOCTL
(
HCISETSCOMTU
)

1226 
COMPATIBLE_IOCTL
(
HCIBLOCKADDR
)

1227 
COMPATIBLE_IOCTL
(
HCIUNBLOCKADDR
)

1228 
COMPATIBLE_IOCTL
(
HCIINQUIRY
)

1229 
COMPATIBLE_IOCTL
(
HCIUARTSETPROTO
)

1230 
COMPATIBLE_IOCTL
(
HCIUARTGETPROTO
)

1231 
COMPATIBLE_IOCTL
(
RFCOMMCREATEDEV
)

1232 
COMPATIBLE_IOCTL
(
RFCOMMRELEASEDEV
)

1233 
COMPATIBLE_IOCTL
(
RFCOMMGETDEVLIST
)

1234 
COMPATIBLE_IOCTL
(
RFCOMMGETDEVINFO
)

1235 
COMPATIBLE_IOCTL
(
RFCOMMSTEALDLC
)

1236 
COMPATIBLE_IOCTL
(
BNEPCONNADD
)

1237 
COMPATIBLE_IOCTL
(
BNEPCONNDEL
)

1238 
COMPATIBLE_IOCTL
(
BNEPGETCONNLIST
)

1239 
COMPATIBLE_IOCTL
(
BNEPGETCONNINFO
)

1240 
COMPATIBLE_IOCTL
(
CMTPCONNADD
)

1241 
COMPATIBLE_IOCTL
(
CMTPCONNDEL
)

1242 
COMPATIBLE_IOCTL
(
CMTPGETCONNLIST
)

1243 
COMPATIBLE_IOCTL
(
CMTPGETCONNINFO
)

1244 
COMPATIBLE_IOCTL
(
HIDPCONNADD
)

1245 
COMPATIBLE_IOCTL
(
HIDPCONNDEL
)

1246 
COMPATIBLE_IOCTL
(
HIDPGETCONNLIST
)

1247 
COMPATIBLE_IOCTL
(
HIDPGETCONNINFO
)

1249 
COMPATIBLE_IOCTL
(
CAPI_REGISTER
)

1250 
COMPATIBLE_IOCTL
(
CAPI_GET_MANUFACTURER
)

1251 
COMPATIBLE_IOCTL
(
CAPI_GET_VERSION
)

1252 
COMPATIBLE_IOCTL
(
CAPI_GET_SERIAL
)

1253 
COMPATIBLE_IOCTL
(
CAPI_GET_PROFILE
)

1254 
COMPATIBLE_IOCTL
(
CAPI_MANUFACTURER_CMD
)

1255 
COMPATIBLE_IOCTL
(
CAPI_GET_ERRCODE
)

1256 
COMPATIBLE_IOCTL
(
CAPI_INSTALLED
)

1257 
COMPATIBLE_IOCTL
(
CAPI_GET_FLAGS
)

1258 
COMPATIBLE_IOCTL
(
CAPI_SET_FLAGS
)

1259 
COMPATIBLE_IOCTL
(
CAPI_CLR_FLAGS
)

1260 
COMPATIBLE_IOCTL
(
CAPI_NCCI_OPENCOUNT
)

1261 
COMPATIBLE_IOCTL
(
CAPI_NCCI_GETUNIT
)

1263 
COMPATIBLE_IOCTL
(
GIGASET_REDIR
)

1264 
COMPATIBLE_IOCTL
(
GIGASET_CONFIG
)

1265 
COMPATIBLE_IOCTL
(
GIGASET_BRKCHARS
)

1266 
COMPATIBLE_IOCTL
(
GIGASET_VERSION
)

1268 
COMPATIBLE_IOCTL
(0x41545900)

1269 
COMPATIBLE_IOCTL
(0x41545901)

1270 
COMPATIBLE_IOCTL
(
PCIIOC_CONTROLLER
)

1271 
COMPATIBLE_IOCTL
(
PCIIOC_MMAP_IS_IO
)

1272 
COMPATIBLE_IOCTL
(
PCIIOC_MMAP_IS_MEM
)

1273 
COMPATIBLE_IOCTL
(
PCIIOC_WRITE_COMBINE
)

1275 
COMPATIBLE_IOCTL
(
NBD_DO_IT
)

1276 
COMPATIBLE_IOCTL
(
NBD_CLEAR_SOCK
)

1277 
COMPATIBLE_IOCTL
(
NBD_CLEAR_QUE
)

1278 
COMPATIBLE_IOCTL
(
NBD_PRINT_DEBUG
)

1279 
COMPATIBLE_IOCTL
(
NBD_DISCONNECT
)

1281 
COMPATIBLE_IOCTL
(
I2C_SLAVE
)

1282 
COMPATIBLE_IOCTL
(
I2C_SLAVE_FORCE
)

1283 
COMPATIBLE_IOCTL
(
I2C_TENBIT
)

1284 
COMPATIBLE_IOCTL
(
I2C_PEC
)

1285 
COMPATIBLE_IOCTL
(
I2C_RETRIES
)

1286 
COMPATIBLE_IOCTL
(
I2C_TIMEOUT
)

1288 
COMPATIBLE_IOCTL
(
HIDIOCGVERSION
)

1289 
COMPATIBLE_IOCTL
(
HIDIOCAPPLICATION
)

1290 
COMPATIBLE_IOCTL
(
HIDIOCGDEVINFO
)

1291 
COMPATIBLE_IOCTL
(
HIDIOCGSTRING
)

1292 
COMPATIBLE_IOCTL
(
HIDIOCINITREPORT
)

1293 
COMPATIBLE_IOCTL
(
HIDIOCGREPORT
)

1294 
COMPATIBLE_IOCTL
(
HIDIOCSREPORT
)

1295 
COMPATIBLE_IOCTL
(
HIDIOCGREPORTINFO
)

1296 
COMPATIBLE_IOCTL
(
HIDIOCGFIELDINFO
)

1297 
COMPATIBLE_IOCTL
(
HIDIOCGUSAGE
)

1298 
COMPATIBLE_IOCTL
(
HIDIOCSUSAGE
)

1299 
COMPATIBLE_IOCTL
(
HIDIOCGUCODE
)

1300 
COMPATIBLE_IOCTL
(
HIDIOCGFLAG
)

1301 
COMPATIBLE_IOCTL
(
HIDIOCSFLAG
)

1302 
COMPATIBLE_IOCTL
(
HIDIOCGCOLLECTIONINDEX
)

1303 
COMPATIBLE_IOCTL
(
HIDIOCGCOLLECTIONINFO
)

1305 
COMPATIBLE_IOCTL
(
AUDIO_STOP
)

1306 
COMPATIBLE_IOCTL
(
AUDIO_PLAY
)

1307 
COMPATIBLE_IOCTL
(
AUDIO_PAUSE
)

1308 
COMPATIBLE_IOCTL
(
AUDIO_CONTINUE
)

1309 
COMPATIBLE_IOCTL
(
AUDIO_SELECT_SOURCE
)

1310 
COMPATIBLE_IOCTL
(
AUDIO_SET_MUTE
)

1311 
COMPATIBLE_IOCTL
(
AUDIO_SET_AV_SYNC
)

1312 
COMPATIBLE_IOCTL
(
AUDIO_SET_BYPASS_MODE
)

1313 
COMPATIBLE_IOCTL
(
AUDIO_CHANNEL_SELECT
)

1314 
COMPATIBLE_IOCTL
(
AUDIO_GET_STATUS
)

1315 
COMPATIBLE_IOCTL
(
AUDIO_GET_CAPABILITIES
)

1316 
COMPATIBLE_IOCTL
(
AUDIO_CLEAR_BUFFER
)

1317 
COMPATIBLE_IOCTL
(
AUDIO_SET_ID
)

1318 
COMPATIBLE_IOCTL
(
AUDIO_SET_MIXER
)

1319 
COMPATIBLE_IOCTL
(
AUDIO_SET_STREAMTYPE
)

1320 
COMPATIBLE_IOCTL
(
AUDIO_SET_EXT_ID
)

1321 
COMPATIBLE_IOCTL
(
AUDIO_SET_ATTRIBUTES
)

1322 
COMPATIBLE_IOCTL
(
AUDIO_SET_KARAOKE
)

1323 
COMPATIBLE_IOCTL
(
DMX_START
)

1324 
COMPATIBLE_IOCTL
(
DMX_STOP
)

1325 
COMPATIBLE_IOCTL
(
DMX_SET_FILTER
)

1326 
COMPATIBLE_IOCTL
(
DMX_SET_PES_FILTER
)

1327 
COMPATIBLE_IOCTL
(
DMX_SET_BUFFER_SIZE
)

1328 
COMPATIBLE_IOCTL
(
DMX_GET_PES_PIDS
)

1329 
COMPATIBLE_IOCTL
(
DMX_GET_CAPS
)

1330 
COMPATIBLE_IOCTL
(
DMX_SET_SOURCE
)

1331 
COMPATIBLE_IOCTL
(
DMX_GET_STC
)

1332 
COMPATIBLE_IOCTL
(
FE_GET_INFO
)

1333 
COMPATIBLE_IOCTL
(
FE_DISEQC_RESET_OVERLOAD
)

1334 
COMPATIBLE_IOCTL
(
FE_DISEQC_SEND_MASTER_CMD
)

1335 
COMPATIBLE_IOCTL
(
FE_DISEQC_RECV_SLAVE_REPLY
)

1336 
COMPATIBLE_IOCTL
(
FE_DISEQC_SEND_BURST
)

1337 
COMPATIBLE_IOCTL
(
FE_SET_TONE
)

1338 
COMPATIBLE_IOCTL
(
FE_SET_VOLTAGE
)

1339 
COMPATIBLE_IOCTL
(
FE_ENABLE_HIGH_LNB_VOLTAGE
)

1340 
COMPATIBLE_IOCTL
(
FE_READ_STATUS
)

1341 
COMPATIBLE_IOCTL
(
FE_READ_BER
)

1342 
COMPATIBLE_IOCTL
(
FE_READ_SIGNAL_STRENGTH
)

1343 
COMPATIBLE_IOCTL
(
FE_READ_SNR
)

1344 
COMPATIBLE_IOCTL
(
FE_READ_UNCORRECTED_BLOCKS
)

1345 
COMPATIBLE_IOCTL
(
FE_SET_FRONTEND
)

1346 
COMPATIBLE_IOCTL
(
FE_GET_FRONTEND
)

1347 
COMPATIBLE_IOCTL
(
FE_GET_EVENT
)

1348 
COMPATIBLE_IOCTL
(
FE_DISHNETWORK_SEND_LEGACY_CMD
)

1349 
COMPATIBLE_IOCTL
(
VIDEO_STOP
)

1350 
COMPATIBLE_IOCTL
(
VIDEO_PLAY
)

1351 
COMPATIBLE_IOCTL
(
VIDEO_FREEZE
)

1352 
COMPATIBLE_IOCTL
(
VIDEO_CONTINUE
)

1353 
COMPATIBLE_IOCTL
(
VIDEO_SELECT_SOURCE
)

1354 
COMPATIBLE_IOCTL
(
VIDEO_SET_BLANK
)

1355 
COMPATIBLE_IOCTL
(
VIDEO_GET_STATUS
)

1356 
COMPATIBLE_IOCTL
(
VIDEO_SET_DISPLAY_FORMAT
)

1357 
COMPATIBLE_IOCTL
(
VIDEO_FAST_FORWARD
)

1358 
COMPATIBLE_IOCTL
(
VIDEO_SLOWMOTION
)

1359 
COMPATIBLE_IOCTL
(
VIDEO_GET_CAPABILITIES
)

1360 
COMPATIBLE_IOCTL
(
VIDEO_CLEAR_BUFFER
)

1361 
COMPATIBLE_IOCTL
(
VIDEO_SET_ID
)

1362 
COMPATIBLE_IOCTL
(
VIDEO_SET_STREAMTYPE
)

1363 
COMPATIBLE_IOCTL
(
VIDEO_SET_FORMAT
)

1364 
COMPATIBLE_IOCTL
(
VIDEO_SET_SYSTEM
)

1365 
COMPATIBLE_IOCTL
(
VIDEO_SET_HIGHLIGHT
)

1366 
COMPATIBLE_IOCTL
(
VIDEO_SET_SPU
)

1367 
COMPATIBLE_IOCTL
(
VIDEO_GET_NAVI
)

1368 
COMPATIBLE_IOCTL
(
VIDEO_SET_ATTRIBUTES
)

1369 
COMPATIBLE_IOCTL
(
VIDEO_GET_SIZE
)

1370 
COMPATIBLE_IOCTL
(
VIDEO_GET_FRAME_RATE
)

1373 
COMPATIBLE_IOCTL
(
JSIOCGVERSION
)

1374 
COMPATIBLE_IOCTL
(
JSIOCGAXES
)

1375 
COMPATIBLE_IOCTL
(
JSIOCGBUTTONS
)

1376 
COMPATIBLE_IOCTL
(
JSIOCGNAME
(0))

1378 #ifdeà
TIOCGLTC


1379 
COMPATIBLE_IOCTL
(
TIOCGLTC
)

1380 
COMPATIBLE_IOCTL
(
TIOCSLTC
)

1382 #ifdeà
TIOCSTART


1389 
COMPATIBLE_IOCTL
(
TIOCSTART
)

1390 
COMPATIBLE_IOCTL
(
TIOCSTOP
)

1396 
	#VFAT_IOCTL_READDIR_BOTH32
 
	`_IOR
('r', 1, 
com·t_dœ’t
[2])

	)

1397 
	#VFAT_IOCTL_READDIR_SHORT32
 
	`_IOR
('r', 2, 
com·t_dœ’t
[2])

	)

1399 
IGNORE_IOCTL
(
VFAT_IOCTL_READDIR_BOTH32
)

1400 
IGNORE_IOCTL
(
VFAT_IOCTL_READDIR_SHORT32
)

1402 #ifdeà
CONFIG_SPARC


1404 
IGNORE_IOCTL
(
FBIOGTYPE
)

1405 
IGNORE_IOCTL
(
FBIOSATTR
)

1406 
IGNORE_IOCTL
(
FBIOGATTR
)

1407 
IGNORE_IOCTL
(
FBIOSVIDEO
)

1408 
IGNORE_IOCTL
(
FBIOGVIDEO
)

1409 
IGNORE_IOCTL
(
FBIOSCURPOS
)

1410 
IGNORE_IOCTL
(
FBIOGCURPOS
)

1411 
IGNORE_IOCTL
(
FBIOGCURMAX
)

1412 
IGNORE_IOCTL
(
FBIOPUTCMAP32
)

1413 
IGNORE_IOCTL
(
FBIOGETCMAP32
)

1414 
IGNORE_IOCTL
(
FBIOSCURSOR32
)

1415 
IGNORE_IOCTL
(
FBIOGCURSOR32
)

1426 
	$do_ioùl_Œªs
(
fd
, 
cmd
,

1427 
¬g
, 
fe
 *file)

1429 
__u£r
 *
¬gp
 = 
	`com·t_±r
(
¬g
);

1431 
cmd
) {

1432 
PPPIOCGIDLE32
:

1433  
	`µp_gidË
(
fd
, 
cmd
, 
¬gp
);

1434 
PPPIOCSCOMPRESS32
:

1435  
	`µp_scom´ess
(
fd
, 
cmd
, 
¬gp
);

1436 
PPPIOCSPASS32
:

1437 
PPPIOCSACTIVE32
:

1438  
	`µp_sock_årog_ioùl_Œªs
(
fd
, 
cmd
, 
¬gp
);

1439 #ifdeà
CONFIG_BLOCK


1440 
SG_IO
:

1441  
	`sg_ioùl_Œªs
(
fd
, 
cmd
, 
¬gp
);

1442 
SG_GET_REQUEST_TABLE
:

1443  
	`sg_g¹_Œªs
(
fd
, 
cmd
, 
¬gp
);

1444 
MTIOCGET32
:

1445 
MTIOCPOS32
:

1446  
	`mt_ioùl_Œªs
(
fd
, 
cmd
, 
¬gp
);

1449 
TIOCGSERIAL
:

1450 
TIOCSSERIAL
:

1451  
	`£rŸl_¡ruù_ioùl
(
fd
, 
cmd
, 
¬gp
);

1453 
I2C_FUNCS
:

1454  
	`w_lÚg
(
fd
, 
cmd
, 
¬gp
);

1455 
I2C_RDWR
:

1456  
	`do_i2c_rdwr_ioùl
(
fd
, 
cmd
, 
¬gp
);

1457 
I2C_SMBUS
:

1458  
	`do_i2c_smbus_ioùl
(
fd
, 
cmd
, 
¬gp
);

1460 
RTC_IRQP_READ32
:

1461 
RTC_IRQP_SET32
:

1462 
RTC_EPOCH_READ32
:

1463 
RTC_EPOCH_SET32
:

1464  
	`¹c_ioùl
(
fd
, 
cmd
, 
¬gp
);

1467 
VIDEO_GET_EVENT
:

1468  
	`do_video_g‘_ev’t
(
fd
, 
cmd
, 
¬gp
);

1469 
VIDEO_STILLPICTURE
:

1470  
	`do_video_¡Íiùu»
(
fd
, 
cmd
, 
¬gp
);

1471 
VIDEO_SET_SPU_PALETTE
:

1472  
	`do_video_£t_¥u_·Ë‰e
(
fd
, 
cmd
, 
¬gp
);

1479 
cmd
) {

1481 
TCSBRKP
:

1482 
TIOCMIWAIT
:

1483 
TIOCSCTTY
:

1485 
HOT_REMOVE_DISK
:

1486 
HOT_ADD_DISK
:

1487 
SET_DISK_FAULTY
:

1488 
SET_BITMAP_FILE
:

1490 
KDSIGACCEPT
:

1491 
KIOCSOUND
:

1492 
KDMKTONE
:

1493 
KDSETMODE
:

1494 
KDSKBMODE
:

1495 
KDSKBMETA
:

1496 
KDSKBLED
:

1497 
KDSETLED
:

1499 
NBD_SET_SOCK
:

1500 
NBD_SET_BLKSIZE
:

1501 
NBD_SET_SIZE
:

1502 
NBD_SET_SIZE_BLOCKS
:

1503  
	`do_vfs_ioùl
(
fe
, 
fd
, 
cmd
, 
¬g
);

1506  -
ENOIOCTLCMD
;

1507 
	}
}

1509 
	$com·t_ioùl_”rÜ
(
fe
 *
fp
, 
fd
,

1510 
cmd
, 
¬g
)

1512 
buf
[10];

1513 *
â
 = "?";

1514 *
·th
;

1517 
·th
 = (*)
	`__g‘_ä“_·ge
(
GFP_KERNEL
);

1518 ià(
·th
) {

1519 
â
 = 
	`d_·th
(&
fp
->
f_·th
, 
·th
, 
PAGE_SIZE
);

1520 ià(
	`IS_ERR
(
â
))

1521 
â
 = "?";

1524 
	`¥rštf
(
buf
,"'%c'", (
cmd
>>
_IOC_TYPESHIFT
è& 
_IOC_TYPEMASK
);

1525 ià(!
	`i¥ršt
(
buf
[1]))

1526 
	`¥rštf
(
buf
, "%02x", buf[1]);

1527 
	`com·t_´štk
("ioctl32(%s:%d): Unknown cmd fd(%d) "

1529 
cu¼’t
->
comm
, cu¼’t->
pid
,

1530 ()
fd
, ()
cmd
, 
buf
,

1531 (
cmd
 >> 
_IOC_SIZESHIFT
è& 
_IOC_SIZEMASK
,

1532 ()
¬g
, 
â
);

1534 ià(
·th
)

1535 
	`ä“_·ge
(()
·th
);

1536 
	}
}

1538 
	$com·t_ioùl_check_bË
(
xcmd
)

1540 
i
;

1541 cÚ¡ 
max
 = 
	`ARRAY_SIZE
(
ioùl_poš‹r
) - 1;

1543 
	`BUILD_BUG_ON
(
max
 >= (1 << 16));

1547 
i
 = ((
xcmd
 >> 16è* 
max
) >> 16;

1550 
ioùl_poš‹r
[
i
] < 
xcmd
 && i < 
max
)

1551 
i
++;

1554 
ioùl_poš‹r
[
i
] > 
xcmd
 && i > 0)

1555 
i
--;

1557  
ioùl_poš‹r
[
i
] =ğ
xcmd
;

1558 
	}
}

1560 
asmlškage
 
	$com·t_sys_ioùl
(
fd
, 
cmd
,

1561 
¬g
)

1563 
fe
 *
fp
;

1564 
”rÜ
 = -
EBADF
;

1565 
åut_Ãeded
;

1567 
fp
 = 
	`fg‘_light
(
fd
, &
åut_Ãeded
);

1568 ià(!
fp
)

1569 
out
;

1572 
”rÜ
 = 
	`£cur™y_fe_ioùl
(
fp
, 
cmd
, 
¬g
);

1573 ià(
”rÜ
)

1574 
out_åut
;

1581 
cmd
) {

1582 
FIOCLEX
:

1583 
FIONCLEX
:

1584 
FIONBIO
:

1585 
FIOASYNC
:

1586 
FIOQSIZE
:

1589 #ià
	`defšed
(
CONFIG_IA64
è|| defšed(
CONFIG_X86_64
)

1590 
FS_IOC_RESVSP_32
:

1591 
FS_IOC_RESVSP64_32
:

1592 
”rÜ
 = 
	`com·t_ioùl_´—Îoÿ‹
(
fp
, 
	`com·t_±r
(
¬g
));

1593 
out_åut
;

1595 
FS_IOC_RESVSP
:

1596 
FS_IOC_RESVSP64
:

1597 
”rÜ
 = 
	`ioùl_´—Îoÿ‹
(
fp
, 
	`com·t_±r
(
¬g
));

1598 
out_åut
;

1601 
FIBMAP
:

1602 
FIGETBSZ
:

1603 
FIONREAD
:

1604 ià(
	`S_ISREG
(
fp
->
f_·th
.
d’Œy
->
d_šode
->
i_mode
))

1609 ià(
fp
->
f_İ
 && fp->f_İ->
com·t_ioùl
) {

1610 
”rÜ
 = 
fp
->
f_İ
->
	`com·t_ioùl
(fp, 
cmd
, 
¬g
);

1611 ià(
”rÜ
 !ğ-
ENOIOCTLCMD
)

1612 
out_åut
;

1615 ià(!
fp
->
f_İ
 || !fp->f_İ->
uÆocked_ioùl
)

1616 
do_ioùl
;

1620 ià(
	`com·t_ioùl_check_bË
(
	`XFORM
(
cmd
)))

1621 
found_hªdËr
;

1623 
”rÜ
 = 
	`do_ioùl_Œªs
(
fd
, 
cmd
, 
¬g
, 
fp
);

1624 ià(
”rÜ
 =ğ-
ENOIOCTLCMD
) {

1625 
couÁ
;

1627 ià(++
couÁ
 <= 50)

1628 
	`com·t_ioùl_”rÜ
(
fp
, 
fd
, 
cmd
, 
¬g
);

1629 
”rÜ
 = -
EINVAL
;

1632 
out_åut
;

1634 
found_hªdËr
:

1635 
¬g
 = ()
	`com·t_±r
(arg);

1636 
do_ioùl
:

1637 
”rÜ
 = 
	`do_vfs_ioùl
(
fp
, 
fd
, 
cmd
, 
¬g
);

1638 
out_åut
:

1639 
	`åut_light
(
fp
, 
åut_Ãeded
);

1640 
out
:

1641  
”rÜ
;

1642 
	}
}

1644 
__š™
 
	$š™_sys32_ioùl_cmp
(cÚ¡ *
p
, cÚ¡ *
q
)

1646 
a
, 
b
;

1647 
a
 = *(*)
p
;

1648 
b
 = *(*)
q
;

1649 ià(
a
 > 
b
)

1651 ià(
a
 < 
b
)

1654 
	}
}

1656 
__š™
 
	$š™_sys32_ioùl
()

1658 
	`sÜt
(
ioùl_poš‹r
, 
	`ARRAY_SIZE
(ioctl_pointer), (*ioctl_pointer),

1659 
š™_sys32_ioùl_cmp
, 
NULL
);

1661 
	}
}

1662 
__š™ÿÎ
(
š™_sys32_ioùl
);

	@dcache.c

17 
	~<lšux/sysÿÎs.h
>

18 
	~<lšux/¡ršg.h
>

19 
	~<lšux/mm.h
>

20 
	~<lšux/fs.h
>

21 
	~<lšux/f¢Ùify.h
>

22 
	~<lšux/¦ab.h
>

23 
	~<lšux/š™.h
>

24 
	~<lšux/hash.h
>

25 
	~<lšux/ÿche.h
>

26 
	~<lšux/moduË.h
>

27 
	~<lšux/mouÁ.h
>

28 
	~<lšux/fe.h
>

29 
	~<asm/uacûss.h
>

30 
	~<lšux/£cur™y.h
>

31 
	~<lšux/£qlock.h
>

32 
	~<lšux/sw­.h
>

33 
	~<lšux/boÙmem.h
>

34 
	~<lšux/fs_¡ruù.h
>

35 
	~<lšux/h¬dœq.h
>

36 
	~<lšux/b™_¥šlock.h
>

37 
	~<lšux/rculi¡_bl.h
>

38 
	~<lšux/´eãtch.h
>

39 
	~<lšux/¿‹lim™.h
>

40 
	~"š‹º®.h
"

80 
sysùl_vfs_ÿche_´essu»
 
	g__»ad_mo¡ly
 = 100;

81 
EXPORT_SYMBOL_GPL
(
sysùl_vfs_ÿche_´essu»
);

83 
__ÿch–še_®igÃd_š_smp
 
DEFINE_SPINLOCK
(
dÿche_Ìu_lock
);

84 
__ÿch–še_®igÃd_š_smp
 
DEFINE_SEQLOCK
(
»Çme_lock
);

86 
EXPORT_SYMBOL
(
»Çme_lock
);

88 
kmem_ÿche
 *
d’Œy_ÿche
 
	g__»ad_mo¡ly
;

98 
	#D_HASHBITS
 
d_hash_shiá


	)

99 
	#D_HASHMASK
 
d_hash_mask


	)

101 
d_hash_mask
 
	g__»ad_mo¡ly
;

102 
d_hash_shiá
 
	g__»ad_mo¡ly
;

104 
hli¡_bl_h—d
 *
d’Œy_hashbË
 
	g__»ad_mo¡ly
;

106 
šlše
 
hli¡_bl_h—d
 *
	$d_hash
(
d’Œy
 *
·»Á
,

107 
hash
)

109 
hash
 +ğ((è
·»Á
 ^ 
GOLDEN_RATIO_PRIME
è/ 
L1_CACHE_BYTES
;

110 
hash
 = hash ^ ((hash ^ 
GOLDEN_RATIO_PRIME
è>> 
D_HASHBITS
);

111  
d’Œy_hashbË
 + (
hash
 & 
D_HASHMASK
);

112 
	}
}

115 
d’Œy_¡©_t
 
	gd’Œy_¡©
 = {

116 .
age_lim™
 = 45,

119 
DEFINE_PER_CPU
(, 
Ä_d’Œy
);

121 #ià
defšed
(
CONFIG_SYSCTL
è&& defšed(
CONFIG_PROC_FS
)

122 
	$g‘_Ä_d’Œy
()

124 
i
;

125 
sum
 = 0;

126 
	`fÜ_—ch_possibË_ıu
(
i
)

127 
sum
 +ğ
	`³r_ıu
(
Ä_d’Œy
, 
i
);

128  
sum
 < 0 ? 0 : sum;

129 
	}
}

131 
	$´oc_Ä_d’Œy
(
ùl_bË
 *
bË
, 
wr™e
, 
__u£r
 *
bufãr
,

132 
size_t
 *
ËÅ
, 
loff_t
 *
µos
)

134 
d’Œy_¡©
.
Ä_d’Œy
 = 
	`g‘_Ä_d’Œy
();

135  
	`´oc_doštvec
(
bË
, 
wr™e
, 
bufãr
, 
ËÅ
, 
µos
);

136 
	}
}

139 
	$__d_ä“
(
rcu_h—d
 *
h—d
)

141 
d’Œy
 *d’Œy = 
	`cÚš”_of
(
h—d
, d’Œy, 
d_u
.
d_rcu
);

143 
	`WARN_ON
(!
	`li¡_em±y
(&
d’Œy
->
d_®Ÿs
));

144 ià(
	`dÇme_ex‹º®
(
d’Œy
))

145 
	`kä“
(
d’Œy
->
d_Çme
.
Çme
);

146 
	`kmem_ÿche_ä“
(
d’Œy_ÿche
, 
d’Œy
);

147 
	}
}

152 
	$d_ä“
(
d’Œy
 *dentry)

154 
	`BUG_ON
(
d’Œy
->
d_couÁ
);

155 
	`this_ıu_dec
(
Ä_d’Œy
);

156 ià(
d’Œy
->
d_İ
 && d’Œy->d_İ->
d_»Ëa£
)

157 
d’Œy
->
d_İ
->
	`d_»Ëa£
(dentry);

160 ià(!(
d’Œy
->
d_æags
 & 
DCACHE_RCUACCESS
))

161 
	`__d_ä“
(&
d’Œy
->
d_u
.
d_rcu
);

163 
	`ÿÎ_rcu
(&
d’Œy
->
d_u
.
d_rcu
, 
__d_ä“
);

164 
	}
}

173 
šlše
 
	$d’Œy_rcuw®k_b¬r›r
(
d’Œy
 *dentry)

175 
	`as£¹_¥š_locked
(&
d’Œy
->
d_lock
);

177 
	`wr™e_£qcouÁ_b¬r›r
(&
d’Œy
->
d_£q
);

178 
	}
}

185 
	$d’Œy_ut
(
d’Œy
 * dentry)

186 
	`__»Ëa£s
(
d’Œy
->
d_lock
)

187 
	`__»Ëa£s
(
d’Œy
->
d_šode
->
i_lock
)

189 
šode
 *šodğ
d’Œy
->
d_šode
;

190 ià(
šode
) {

191 
d’Œy
->
d_šode
 = 
NULL
;

192 
	`li¡_d–_š™
(&
d’Œy
->
d_®Ÿs
);

193 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

194 
	`¥š_uÆock
(&
šode
->
i_lock
);

195 ià(!
šode
->
i_Æšk
)

196 
	`f¢Ùify_šod”emove
(
šode
);

197 ià(
d’Œy
->
d_İ
 && d’Œy->d_İ->
d_ut
)

198 
d’Œy
->
d_İ
->
	`d_ut
(d’Œy, 
šode
);

200 
	`ut
(
šode
);

202 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

204 
	}
}

210 
	$d’Œy_uÆšk_šode
(
d’Œy
 * dentry)

211 
	`__»Ëa£s
(
d’Œy
->
d_lock
)

212 
	`__»Ëa£s
(
d’Œy
->
d_šode
->
i_lock
)

214 
šode
 *šodğ
d’Œy
->
d_šode
;

215 
d’Œy
->
d_šode
 = 
NULL
;

216 
	`li¡_d–_š™
(&
d’Œy
->
d_®Ÿs
);

217 
	`d’Œy_rcuw®k_b¬r›r
(
d’Œy
);

218 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

219 
	`¥š_uÆock
(&
šode
->
i_lock
);

220 ià(!
šode
->
i_Æšk
)

221 
	`f¢Ùify_šod”emove
(
šode
);

222 ià(
d’Œy
->
d_İ
 && d’Œy->d_İ->
d_ut
)

223 
d’Œy
->
d_İ
->
	`d_ut
(d’Œy, 
šode
);

225 
	`ut
(
šode
);

226 
	}
}

231 
	$d’Œy_Ìu_add
(
d’Œy
 *dentry)

233 ià(
	`li¡_em±y
(&
d’Œy
->
d_Ìu
)) {

234 
	`¥š_lock
(&
dÿche_Ìu_lock
);

235 
	`li¡_add
(&
d’Œy
->
d_Ìu
, &d’Œy->
d_sb
->
s_d’Œy_Ìu
);

236 
d’Œy
->
d_sb
->
s_Ä_d’Œy_unu£d
++;

237 
d’Œy_¡©
.
Ä_unu£d
++;

238 
	`¥š_uÆock
(&
dÿche_Ìu_lock
);

240 
	}
}

242 
	$__d’Œy_Ìu_d–
(
d’Œy
 *dentry)

244 
	`li¡_d–_š™
(&
d’Œy
->
d_Ìu
);

245 
d’Œy
->
d_sb
->
s_Ä_d’Œy_unu£d
--;

246 
d’Œy_¡©
.
Ä_unu£d
--;

247 
	}
}

252 
	$d’Œy_Ìu_d–
(
d’Œy
 *dentry)

254 ià(!
	`li¡_em±y
(&
d’Œy
->
d_Ìu
)) {

255 
	`¥š_lock
(&
dÿche_Ìu_lock
);

256 
	`__d’Œy_Ìu_d–
(
d’Œy
);

257 
	`¥š_uÆock
(&
dÿche_Ìu_lock
);

259 
	}
}

266 
	$d’Œy_Ìu_´uÃ
(
d’Œy
 *dentry)

268 ià(!
	`li¡_em±y
(&
d’Œy
->
d_Ìu
)) {

269 ià(
d’Œy
->
d_æags
 & 
DCACHE_OP_PRUNE
)

270 
d’Œy
->
d_İ
->
	`d_´uÃ
(dentry);

272 
	`¥š_lock
(&
dÿche_Ìu_lock
);

273 
	`__d’Œy_Ìu_d–
(
d’Œy
);

274 
	`¥š_uÆock
(&
dÿche_Ìu_lock
);

276 
	}
}

278 
	$d’Œy_Ìu_move_
(
d’Œy
 *dentry)

280 
	`¥š_lock
(&
dÿche_Ìu_lock
);

281 ià(
	`li¡_em±y
(&
d’Œy
->
d_Ìu
)) {

282 
	`li¡_add_
(&
d’Œy
->
d_Ìu
, &d’Œy->
d_sb
->
s_d’Œy_Ìu
);

283 
d’Œy
->
d_sb
->
s_Ä_d’Œy_unu£d
++;

284 
d’Œy_¡©
.
Ä_unu£d
++;

286 
	`li¡_move_
(&
d’Œy
->
d_Ìu
, &d’Œy->
d_sb
->
s_d’Œy_Ìu
);

288 
	`¥š_uÆock
(&
dÿche_Ìu_lock
);

289 
	}
}

303 
d’Œy
 *
	$d_kl
(
d’Œy
 *d’Œy, d’Œy *
·»Á
)

304 
	`__»Ëa£s
(
d’Œy
->
d_lock
)

305 
	`__»Ëa£s
(
·»Á
->
d_lock
)

306 
	`__»Ëa£s
(
d’Œy
->
d_šode
->
i_lock
)

308 
	`li¡_d–
(&
d’Œy
->
d_u
.
d_chd
);

313 
d’Œy
->
d_æags
 |ğ
DCACHE_DISCONNECTED
;

314 ià(
·»Á
)

315 
	`¥š_uÆock
(&
·»Á
->
d_lock
);

316 
	`d’Œy_ut
(
d’Œy
);

321 
	`d_ä“
(
d’Œy
);

322  
·»Á
;

323 
	}
}

330 
	$__d_shršk
(
d’Œy
 *dentry)

332 ià(!
	`d_unhashed
(
d’Œy
)) {

333 
hli¡_bl_h—d
 *
b
;

334 ià(
	`uÆik–y
(
d’Œy
->
d_æags
 & 
DCACHE_DISCONNECTED
))

335 
b
 = &
d’Œy
->
d_sb
->
s_ªÚ
;

337 
b
 = 
	`d_hash
(
d’Œy
->
d_·»Á
, d’Œy->
d_Çme
.
hash
);

339 
	`hli¡_bl_lock
(
b
);

340 
	`__hli¡_bl_d–
(&
d’Œy
->
d_hash
);

341 
d’Œy
->
d_hash
.
µ»v
 = 
NULL
;

342 
	`hli¡_bl_uÆock
(
b
);

344 
	}
}

361 
	$__d_drİ
(
d’Œy
 *dentry)

363 ià(!
	`d_unhashed
(
d’Œy
)) {

364 
	`__d_shršk
(
d’Œy
);

365 
	`d’Œy_rcuw®k_b¬r›r
(
d’Œy
);

367 
	}
}

368 
EXPORT_SYMBOL
(
__d_drİ
);

370 
	$d_drİ
(
d’Œy
 *dentry)

372 
	`¥š_lock
(&
d’Œy
->
d_lock
);

373 
	`__d_drİ
(
d’Œy
);

374 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

375 
	}
}

376 
EXPORT_SYMBOL
(
d_drİ
);

387 
	$d_ş—r_Ãed_lookup
(
d’Œy
 *dentry)

389 
	`¥š_lock
(&
d’Œy
->
d_lock
);

390 
	`__d_drİ
(
d’Œy
);

391 
d’Œy
->
d_æags
 &ğ~
DCACHE_NEED_LOOKUP
;

392 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

393 
	}
}

394 
EXPORT_SYMBOL
(
d_ş—r_Ãed_lookup
);

402 
šlše
 
d’Œy
 *
	$d’Œy_kl
(
d’Œy
 *d’Œy, 
»f
)

403 
	`__»Ëa£s
(
d’Œy
->
d_lock
)

405 
šode
 *inode;

406 
d’Œy
 *
·»Á
;

408 
šode
 = 
d’Œy
->
d_šode
;

409 ià(
šode
 && !
	`¥š_Œylock
(&šode->
i_lock
)) {

410 
»lock
:

411 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

412 
	`ıu_»Ïx
();

413  
d’Œy
;

415 ià(
	`IS_ROOT
(
d’Œy
))

416 
·»Á
 = 
NULL
;

418 
·»Á
 = 
d’Œy
->
d_·»Á
;

419 ià(
·»Á
 && !
	`¥š_Œylock
(&·»Á->
d_lock
)) {

420 ià(
šode
)

421 
	`¥š_uÆock
(&
šode
->
i_lock
);

422 
»lock
;

425 ià(
»f
)

426 
d’Œy
->
d_couÁ
--;

432 
	`d’Œy_Ìu_´uÃ
(
d’Œy
);

434 
	`__d_drİ
(
d’Œy
);

435  
	`d_kl
(
d’Œy
, 
·»Á
);

436 
	}
}

464 
	$dput
(
d’Œy
 *dentry)

466 ià(!
d’Œy
)

469 
»³©
:

470 ià(
d’Œy
->
d_couÁ
 == 1)

471 
	`might_¦“p
();

472 
	`¥š_lock
(&
d’Œy
->
d_lock
);

473 
	`BUG_ON
(!
d’Œy
->
d_couÁ
);

474 ià(
d’Œy
->
d_couÁ
 > 1) {

475 
d’Œy
->
d_couÁ
--;

476 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

480 ià(
d’Œy
->
d_æags
 & 
DCACHE_OP_DELETE
) {

481 ià(
d’Œy
->
d_İ
->
	`d_d–‘e
(dentry))

482 
kl_™
;

486 ià(
	`d_unhashed
(
d’Œy
))

487 
kl_™
;

494 ià(!
	`d_Ãed_lookup
(
d’Œy
))

495 
d’Œy
->
d_æags
 |ğ
DCACHE_REFERENCED
;

496 
	`d’Œy_Ìu_add
(
d’Œy
);

498 
d’Œy
->
d_couÁ
--;

499 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

502 
kl_™
:

503 
d’Œy
 = 
	`d’Œy_kl
(dentry, 1);

504 ià(
d’Œy
)

505 
»³©
;

506 
	}
}

507 
EXPORT_SYMBOL
(
dput
);

521 
	$d_šv®id©e
(
d’Œy
 * dentry)

526 
	`¥š_lock
(&
d’Œy
->
d_lock
);

527 ià(
	`d_unhashed
(
d’Œy
)) {

528 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

535 ià(!
	`li¡_em±y
(&
d’Œy
->
d_subdœs
)) {

536 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

537 
	`shršk_dÿche_·»Á
(
d’Œy
);

538 
	`¥š_lock
(&
d’Œy
->
d_lock
);

553 ià(
d’Œy
->
d_couÁ
 > 1 && d’Œy->
d_šode
) {

554 ià(
	`S_ISDIR
(
d’Œy
->
d_šode
->
i_mode
è|| 
	`d_mouÁpošt
(dentry)) {

555 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

556  -
EBUSY
;

560 
	`__d_drİ
(
d’Œy
);

561 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

563 
	}
}

564 
EXPORT_SYMBOL
(
d_šv®id©e
);

567 
šlše
 
	$__dg‘_dlock
(
d’Œy
 *dentry)

569 
d’Œy
->
d_couÁ
++;

570 
	}
}

572 
šlše
 
	$__dg‘
(
d’Œy
 *dentry)

574 
	`¥š_lock
(&
d’Œy
->
d_lock
);

575 
	`__dg‘_dlock
(
d’Œy
);

576 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

577 
	}
}

579 
d’Œy
 *
	$dg‘_·»Á
(
d’Œy
 *dentry)

581 
d’Œy
 *
»t
;

583 
»³©
:

588 
	`rcu_»ad_lock
();

589 
»t
 = 
d’Œy
->
d_·»Á
;

590 
	`¥š_lock
(&
»t
->
d_lock
);

591 ià(
	`uÆik–y
(
»t
 !ğ
d’Œy
->
d_·»Á
)) {

592 
	`¥š_uÆock
(&
»t
->
d_lock
);

593 
	`rcu_»ad_uÆock
();

594 
»³©
;

596 
	`rcu_»ad_uÆock
();

597 
	`BUG_ON
(!
»t
->
d_couÁ
);

598 
»t
->
d_couÁ
++;

599 
	`¥š_uÆock
(&
»t
->
d_lock
);

600  
»t
;

601 
	}
}

602 
EXPORT_SYMBOL
(
dg‘_·»Á
);

620 
d’Œy
 *
	$__d_fšd_®Ÿs
(
šode
 *šode, 
wªt_discÚ
)

622 
d’Œy
 *
®Ÿs
, *
discÚ_®Ÿs
;

624 
agaš
:

625 
discÚ_®Ÿs
 = 
NULL
;

626 
	`li¡_fÜ_—ch_’Œy
(
®Ÿs
, &
šode
->
i_d’Œy
, 
d_®Ÿs
) {

627 
	`¥š_lock
(&
®Ÿs
->
d_lock
);

628 ià(
	`S_ISDIR
(
šode
->
i_mode
è|| !
	`d_unhashed
(
®Ÿs
)) {

629 ià(
	`IS_ROOT
(
®Ÿs
) &&

630 (
®Ÿs
->
d_æags
 & 
DCACHE_DISCONNECTED
)) {

631 
discÚ_®Ÿs
 = 
®Ÿs
;

632 } ià(!
wªt_discÚ
) {

633 
	`__dg‘_dlock
(
®Ÿs
);

634 
	`¥š_uÆock
(&
®Ÿs
->
d_lock
);

635  
®Ÿs
;

638 
	`¥š_uÆock
(&
®Ÿs
->
d_lock
);

640 ià(
discÚ_®Ÿs
) {

641 
®Ÿs
 = 
discÚ_®Ÿs
;

642 
	`¥š_lock
(&
®Ÿs
->
d_lock
);

643 ià(
	`S_ISDIR
(
šode
->
i_mode
è|| !
	`d_unhashed
(
®Ÿs
)) {

644 ià(
	`IS_ROOT
(
®Ÿs
) &&

645 (
®Ÿs
->
d_æags
 & 
DCACHE_DISCONNECTED
)) {

646 
	`__dg‘_dlock
(
®Ÿs
);

647 
	`¥š_uÆock
(&
®Ÿs
->
d_lock
);

648  
®Ÿs
;

651 
	`¥š_uÆock
(&
®Ÿs
->
d_lock
);

652 
agaš
;

654  
NULL
;

655 
	}
}

657 
d’Œy
 *
	$d_fšd_®Ÿs
(
šode
 *inode)

659 
d’Œy
 *
de
 = 
NULL
;

661 ià(!
	`li¡_em±y
(&
šode
->
i_d’Œy
)) {

662 
	`¥š_lock
(&
šode
->
i_lock
);

663 
de
 = 
	`__d_fšd_®Ÿs
(
šode
, 0);

664 
	`¥š_uÆock
(&
šode
->
i_lock
);

666  
de
;

667 
	}
}

668 
EXPORT_SYMBOL
(
d_fšd_®Ÿs
);

674 
	$d_´uÃ_®Ÿ£s
(
šode
 *inode)

676 
d’Œy
 *dentry;

677 
»¡¬t
:

678 
	`¥š_lock
(&
šode
->
i_lock
);

679 
	`li¡_fÜ_—ch_’Œy
(
d’Œy
, &
šode
->
i_d’Œy
, 
d_®Ÿs
) {

680 
	`¥š_lock
(&
d’Œy
->
d_lock
);

681 ià(!
d’Œy
->
d_couÁ
) {

682 
	`__dg‘_dlock
(
d’Œy
);

683 
	`__d_drİ
(
d’Œy
);

684 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

685 
	`¥š_uÆock
(&
šode
->
i_lock
);

686 
	`dput
(
d’Œy
);

687 
»¡¬t
;

689 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

691 
	`¥š_uÆock
(&
šode
->
i_lock
);

692 
	}
}

693 
EXPORT_SYMBOL
(
d_´uÃ_®Ÿ£s
);

702 
	$Œy_´uÃ_Úe_d’Œy
(
d’Œy
 *dentry)

703 
	`__»Ëa£s
(
d’Œy
->
d_lock
)

705 
d’Œy
 *
·»Á
;

707 
·»Á
 = 
	`d’Œy_kl
(
d’Œy
, 0);

718 ià(!
·»Á
)

720 ià(
·»Á
 =ğ
d’Œy
)

724 
d’Œy
 = 
·»Á
;

725 
d’Œy
) {

726 
	`¥š_lock
(&
d’Œy
->
d_lock
);

727 ià(
d’Œy
->
d_couÁ
 > 1) {

728 
d’Œy
->
d_couÁ
--;

729 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

732 
d’Œy
 = 
	`d’Œy_kl
(dentry, 1);

734 
	}
}

736 
	$shršk_d’Œy_li¡
(
li¡_h—d
 *
li¡
)

738 
d’Œy
 *dentry;

740 
	`rcu_»ad_lock
();

742 
d’Œy
 = 
	`li¡_’Œy_rcu
(
li¡
->
´ev
, d’Œy, 
d_Ìu
);

743 ià(&
d’Œy
->
d_Ìu
 =ğ
li¡
)

745 
	`¥š_lock
(&
d’Œy
->
d_lock
);

746 ià(
d’Œy
 !ğ
	`li¡_’Œy
(
li¡
->
´ev
, d’Œy, 
d_Ìu
)) {

747 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

756 ià(
d’Œy
->
d_couÁ
) {

757 
	`d’Œy_Ìu_d–
(
d’Œy
);

758 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

762 
	`rcu_»ad_uÆock
();

764 
	`Œy_´uÃ_Úe_d’Œy
(
d’Œy
);

766 
	`rcu_»ad_lock
();

768 
	`rcu_»ad_uÆock
();

769 
	}
}

779 
	$__shršk_dÿche_sb
(
su³r_block
 *
sb
, 
couÁ
, 
æags
)

781 
d’Œy
 *dentry;

782 
	`LIST_HEAD
(
»ã»nûd
);

783 
	`LIST_HEAD
(
tmp
);

785 
»lock
:

786 
	`¥š_lock
(&
dÿche_Ìu_lock
);

787 !
	`li¡_em±y
(&
sb
->
s_d’Œy_Ìu
)) {

788 
d’Œy
 = 
	`li¡_’Œy
(
sb
->
s_d’Œy_Ìu
.
´ev
,

789 
d’Œy
, 
d_Ìu
);

790 
	`BUG_ON
(
d’Œy
->
d_sb
 !ğ
sb
);

792 ià(!
	`¥š_Œylock
(&
d’Œy
->
d_lock
)) {

793 
	`¥š_uÆock
(&
dÿche_Ìu_lock
);

794 
	`ıu_»Ïx
();

795 
»lock
;

803 ià(
æags
 & 
DCACHE_REFERENCED
 &&

804 
d’Œy
->
d_æags
 & 
DCACHE_REFERENCED
) {

805 
d’Œy
->
d_æags
 &ğ~
DCACHE_REFERENCED
;

806 
	`li¡_move
(&
d’Œy
->
d_Ìu
, &
»ã»nûd
);

807 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

809 
	`li¡_move_
(&
d’Œy
->
d_Ìu
, &
tmp
);

810 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

811 ià(!--
couÁ
)

814 
	`cÚd_»sched_lock
(&
dÿche_Ìu_lock
);

816 ià(!
	`li¡_em±y
(&
»ã»nûd
))

817 
	`li¡_¥liû
(&
»ã»nûd
, &
sb
->
s_d’Œy_Ìu
);

818 
	`¥š_uÆock
(&
dÿche_Ìu_lock
);

820 
	`shršk_d’Œy_li¡
(&
tmp
);

821 
	}
}

835 
	$´uÃ_dÿche_sb
(
su³r_block
 *
sb
, 
Ä_to_sÿn
)

837 
	`__shršk_dÿche_sb
(
sb
, 
Ä_to_sÿn
, 
DCACHE_REFERENCED
);

838 
	}
}

847 
	$shršk_dÿche_sb
(
su³r_block
 *
sb
)

849 
	`LIST_HEAD
(
tmp
);

851 
	`¥š_lock
(&
dÿche_Ìu_lock
);

852 !
	`li¡_em±y
(&
sb
->
s_d’Œy_Ìu
)) {

853 
	`li¡_¥liû_š™
(&
sb
->
s_d’Œy_Ìu
, &
tmp
);

854 
	`¥š_uÆock
(&
dÿche_Ìu_lock
);

855 
	`shršk_d’Œy_li¡
(&
tmp
);

856 
	`¥š_lock
(&
dÿche_Ìu_lock
);

858 
	`¥š_uÆock
(&
dÿche_Ìu_lock
);

859 
	}
}

860 
EXPORT_SYMBOL
(
shršk_dÿche_sb
);

867 
	$shršk_dÿche_fÜ_umouÁ_subŒ“
(
d’Œy
 *dentry)

869 
d’Œy
 *
·»Á
;

871 
	`BUG_ON
(!
	`IS_ROOT
(
d’Œy
));

875 !
	`li¡_em±y
(&
d’Œy
->
d_subdœs
))

876 
d’Œy
 = 
	`li¡_’Œy
(d’Œy->
d_subdœs
.
Ãxt
,

877 
d’Œy
, 
d_u
.
d_chd
);

882 
šode
 *inode;

889 
	`d’Œy_Ìu_´uÃ
(
d’Œy
);

890 
	`__d_shršk
(
d’Œy
);

892 ià(
d’Œy
->
d_couÁ
 != 0) {

893 
	`´štk
(
KERN_ERR


897 
d’Œy
,

898 
d’Œy
->
d_šode
 ?

899 
d’Œy
->
d_šode
->
i_šo
 : 0UL,

900 
d’Œy
->
d_Çme
.
Çme
,

901 
d’Œy
->
d_couÁ
,

902 
d’Œy
->
d_sb
->
s_ty³
->
Çme
,

903 
d’Œy
->
d_sb
->
s_id
);

904 
	`BUG
();

907 ià(
	`IS_ROOT
(
d’Œy
)) {

908 
·»Á
 = 
NULL
;

909 
	`li¡_d–
(&
d’Œy
->
d_u
.
d_chd
);

911 
·»Á
 = 
d’Œy
->
d_·»Á
;

912 
·»Á
->
d_couÁ
--;

913 
	`li¡_d–
(&
d’Œy
->
d_u
.
d_chd
);

916 
šode
 = 
d’Œy
->
d_šode
;

917 ià(
šode
) {

918 
d’Œy
->
d_šode
 = 
NULL
;

919 
	`li¡_d–_š™
(&
d’Œy
->
d_®Ÿs
);

920 ià(
d’Œy
->
d_İ
 && d’Œy->d_İ->
d_ut
)

921 
d’Œy
->
d_İ
->
	`d_ut
(d’Œy, 
šode
);

923 
	`ut
(
šode
);

926 
	`d_ä“
(
d’Œy
);

931 ià(!
·»Á
)

933 
d’Œy
 = 
·»Á
;

934 } 
	`li¡_em±y
(&
d’Œy
->
d_subdœs
));

936 
d’Œy
 = 
	`li¡_’Œy
(d’Œy->
d_subdœs
.
Ãxt
,

937 
d’Œy
, 
d_u
.
d_chd
);

939 
	}
}

951 
	$shršk_dÿche_fÜ_umouÁ
(
su³r_block
 *
sb
)

953 
d’Œy
 *dentry;

955 ià(
	`down_»ad_Œylock
(&
sb
->
s_umouÁ
))

956 
	`BUG
();

958 
d’Œy
 = 
sb
->
s_roÙ
;

959 
sb
->
s_roÙ
 = 
NULL
;

960 
d’Œy
->
d_couÁ
--;

961 
	`shršk_dÿche_fÜ_umouÁ_subŒ“
(
d’Œy
);

963 !
	`hli¡_bl_em±y
(&
sb
->
s_ªÚ
)) {

964 
d’Œy
 = 
	`hli¡_bl_’Œy
(
	`hli¡_bl_fœ¡
(&
sb
->
s_ªÚ
), d’Œy, 
d_hash
);

965 
	`shršk_dÿche_fÜ_umouÁ_subŒ“
(
d’Œy
);

967 
	}
}

975 
d’Œy
 *
	$Œy_to_asûnd
(
d’Œy
 *
Şd
, 
locked
, 
£q
)

977 
d’Œy
 *
Ãw
 = 
Şd
->
d_·»Á
;

979 
	`rcu_»ad_lock
();

980 
	`¥š_uÆock
(&
Şd
->
d_lock
);

981 
	`¥š_lock
(&
Ãw
->
d_lock
);

987 ià(
Ãw
 !ğ
Şd
->
d_·»Á
 ||

988 (
Şd
->
d_æags
 & 
DCACHE_DISCONNECTED
) ||

989 (!
locked
 && 
	`»ad_£q»Œy
(&
»Çme_lock
, 
£q
))) {

990 
	`¥š_uÆock
(&
Ãw
->
d_lock
);

991 
Ãw
 = 
NULL
;

993 
	`rcu_»ad_uÆock
();

994  
Ãw
;

995 
	}
}

1011 
	$have_submouÁs
(
d’Œy
 *
·»Á
)

1013 
d’Œy
 *
this_·»Á
;

1014 
li¡_h—d
 *
Ãxt
;

1015 
£q
;

1016 
locked
 = 0;

1018 
£q
 = 
	`»ad_£qbegš
(&
»Çme_lock
);

1019 
agaš
:

1020 
this_·»Á
 = 
·»Á
;

1022 ià(
	`d_mouÁpošt
(
·»Á
))

1023 
pos™ive
;

1024 
	`¥š_lock
(&
this_·»Á
->
d_lock
);

1025 
»³©
:

1026 
Ãxt
 = 
this_·»Á
->
d_subdœs
.next;

1027 
»sume
:

1028 
Ãxt
 !ğ&
this_·»Á
->
d_subdœs
) {

1029 
li¡_h—d
 *
tmp
 = 
Ãxt
;

1030 
d’Œy
 *d’Œy = 
	`li¡_’Œy
(
tmp
, d’Œy, 
d_u
.
d_chd
);

1031 
Ãxt
 = 
tmp
->next;

1033 
	`¥š_lock_Ã¡ed
(&
d’Œy
->
d_lock
, 
DENTRY_D_LOCK_NESTED
);

1035 ià(
	`d_mouÁpošt
(
d’Œy
)) {

1036 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

1037 
	`¥š_uÆock
(&
this_·»Á
->
d_lock
);

1038 
pos™ive
;

1040 ià(!
	`li¡_em±y
(&
d’Œy
->
d_subdœs
)) {

1041 
	`¥š_uÆock
(&
this_·»Á
->
d_lock
);

1042 
	`¥š_»Ëa£
(&
d’Œy
->
d_lock
.
d•_m­
, 1, 
_RET_IP_
);

1043 
this_·»Á
 = 
d’Œy
;

1044 
	`¥š_acquœe
(&
this_·»Á
->
d_lock
.
d•_m­
, 0, 1, 
_RET_IP_
);

1045 
»³©
;

1047 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

1052 ià(
this_·»Á
 !ğ
·»Á
) {

1053 
d’Œy
 *
chd
 = 
this_·»Á
;

1054 
this_·»Á
 = 
	`Œy_to_asûnd
Ñhis_·»Á, 
locked
, 
£q
);

1055 ià(!
this_·»Á
)

1056 
»Çme_»Œy
;

1057 
Ãxt
 = 
chd
->
d_u
.
d_chd
.next;

1058 
»sume
;

1060 
	`¥š_uÆock
(&
this_·»Á
->
d_lock
);

1061 ià(!
locked
 && 
	`»ad_£q»Œy
(&
»Çme_lock
, 
£q
))

1062 
»Çme_»Œy
;

1063 ià(
locked
)

1064 
	`wr™e_£quÆock
(&
»Çme_lock
);

1066 
pos™ive
:

1067 ià(!
locked
 && 
	`»ad_£q»Œy
(&
»Çme_lock
, 
£q
))

1068 
»Çme_»Œy
;

1069 ià(
locked
)

1070 
	`wr™e_£quÆock
(&
»Çme_lock
);

1073 
»Çme_»Œy
:

1074 
locked
 = 1;

1075 
	`wr™e_£qlock
(&
»Çme_lock
);

1076 
agaš
;

1077 
	}
}

1078 
EXPORT_SYMBOL
(
have_submouÁs
);

1094 
	$£Ëù_·»Á
(
d’Œy
 * 
·»Á
)

1096 
d’Œy
 *
this_·»Á
;

1097 
li¡_h—d
 *
Ãxt
;

1098 
£q
;

1099 
found
 = 0;

1100 
locked
 = 0;

1102 
£q
 = 
	`»ad_£qbegš
(&
»Çme_lock
);

1103 
agaš
:

1104 
this_·»Á
 = 
·»Á
;

1105 
	`¥š_lock
(&
this_·»Á
->
d_lock
);

1106 
»³©
:

1107 
Ãxt
 = 
this_·»Á
->
d_subdœs
.next;

1108 
»sume
:

1109 
Ãxt
 !ğ&
this_·»Á
->
d_subdœs
) {

1110 
li¡_h—d
 *
tmp
 = 
Ãxt
;

1111 
d’Œy
 *d’Œy = 
	`li¡_’Œy
(
tmp
, d’Œy, 
d_u
.
d_chd
);

1112 
Ãxt
 = 
tmp
->next;

1114 
	`¥š_lock_Ã¡ed
(&
d’Œy
->
d_lock
, 
DENTRY_D_LOCK_NESTED
);

1120 ià(!
d’Œy
->
d_couÁ
) {

1121 
	`d’Œy_Ìu_move_
(
d’Œy
);

1122 
found
++;

1124 
	`d’Œy_Ìu_d–
(
d’Œy
);

1132 ià(
found
 && 
	`Ãed_»sched
()) {

1133 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

1134 
out
;

1140 ià(!
	`li¡_em±y
(&
d’Œy
->
d_subdœs
)) {

1141 
	`¥š_uÆock
(&
this_·»Á
->
d_lock
);

1142 
	`¥š_»Ëa£
(&
d’Œy
->
d_lock
.
d•_m­
, 1, 
_RET_IP_
);

1143 
this_·»Á
 = 
d’Œy
;

1144 
	`¥š_acquœe
(&
this_·»Á
->
d_lock
.
d•_m­
, 0, 1, 
_RET_IP_
);

1145 
»³©
;

1148 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

1153 ià(
this_·»Á
 !ğ
·»Á
) {

1154 
d’Œy
 *
chd
 = 
this_·»Á
;

1155 
this_·»Á
 = 
	`Œy_to_asûnd
Ñhis_·»Á, 
locked
, 
£q
);

1156 ià(!
this_·»Á
)

1157 
»Çme_»Œy
;

1158 
Ãxt
 = 
chd
->
d_u
.
d_chd
.next;

1159 
»sume
;

1161 
out
:

1162 
	`¥š_uÆock
(&
this_·»Á
->
d_lock
);

1163 ià(!
locked
 && 
	`»ad_£q»Œy
(&
»Çme_lock
, 
£q
))

1164 
»Çme_»Œy
;

1165 ià(
locked
)

1166 
	`wr™e_£quÆock
(&
»Çme_lock
);

1167  
found
;

1169 
»Çme_»Œy
:

1170 ià(
found
)

1171  
found
;

1172 
locked
 = 1;

1173 
	`wr™e_£qlock
(&
»Çme_lock
);

1174 
agaš
;

1175 
	}
}

1184 
	$shršk_dÿche_·»Á
(
d’Œy
 * 
·»Á
)

1186 
su³r_block
 *
sb
 = 
·»Á
->
d_sb
;

1187 
found
;

1189 (
found
 = 
	`£Ëù_·»Á
(
·»Á
)) != 0)

1190 
	`__shršk_dÿche_sb
(
sb
, 
found
, 0);

1191 
	}
}

1192 
EXPORT_SYMBOL
(
shršk_dÿche_·»Á
);

1204 
d’Œy
 *
	$__d_®loc
(
su³r_block
 *
sb
, cÚ¡ 
q¡r
 *
Çme
)

1206 
d’Œy
 *dentry;

1207 *
dÇme
;

1209 
d’Œy
 = 
	`kmem_ÿche_®loc
(
d’Œy_ÿche
, 
GFP_KERNEL
);

1210 ià(!
d’Œy
)

1211  
NULL
;

1213 ià(
Çme
->
Ën
 > 
DNAME_INLINE_LEN
-1) {

1214 
dÇme
 = 
	`km®loc
(
Çme
->
Ën
 + 1, 
GFP_KERNEL
);

1215 ià(!
dÇme
) {

1216 
	`kmem_ÿche_ä“
(
d’Œy_ÿche
, 
d’Œy
);

1217  
NULL
;

1220 
dÇme
 = 
d’Œy
->
d_šame
;

1222 
d’Œy
->
d_Çme
.
Çme
 = 
dÇme
;

1224 
d’Œy
->
d_Çme
.
Ën
 = 
Çme
->len;

1225 
d’Œy
->
d_Çme
.
hash
 = 
Çme
->hash;

1226 
	`memıy
(
dÇme
, 
Çme
->Çme,‚ame->
Ën
);

1227 
dÇme
[
Çme
->
Ën
] = 0;

1229 
d’Œy
->
d_couÁ
 = 1;

1230 
d’Œy
->
d_æags
 = 0;

1231 
	`¥š_lock_š™
(&
d’Œy
->
d_lock
);

1232 
	`£qcouÁ_š™
(&
d’Œy
->
d_£q
);

1233 
d’Œy
->
d_šode
 = 
NULL
;

1234 
d’Œy
->
d_·»Á
 = dentry;

1235 
d’Œy
->
d_sb
 = 
sb
;

1236 
d’Œy
->
d_İ
 = 
NULL
;

1237 
d’Œy
->
d_fsd©a
 = 
NULL
;

1238 
	`INIT_HLIST_BL_NODE
(&
d’Œy
->
d_hash
);

1239 
	`INIT_LIST_HEAD
(&
d’Œy
->
d_Ìu
);

1240 
	`INIT_LIST_HEAD
(&
d’Œy
->
d_subdœs
);

1241 
	`INIT_LIST_HEAD
(&
d’Œy
->
d_®Ÿs
);

1242 
	`INIT_LIST_HEAD
(&
d’Œy
->
d_u
.
d_chd
);

1243 
	`d_£t_d_İ
(
d’Œy
, d’Œy->
d_sb
->
s_d_İ
);

1245 
	`this_ıu_šc
(
Ä_d’Œy
);

1247  
d’Œy
;

1248 
	}
}

1259 
d’Œy
 *
	$d_®loc
(
d’Œy
 * 
·»Á
, cÚ¡ 
q¡r
 *
Çme
)

1261 
d’Œy
 *d’Œy = 
	`__d_®loc
(
·»Á
->
d_sb
, 
Çme
);

1262 ià(!
d’Œy
)

1263  
NULL
;

1265 
	`¥š_lock
(&
·»Á
->
d_lock
);

1270 
	`__dg‘_dlock
(
·»Á
);

1271 
d’Œy
->
d_·»Á
 = 
·»Á
;

1272 
	`li¡_add
(&
d’Œy
->
d_u
.
d_chd
, &
·»Á
->
d_subdœs
);

1273 
	`¥š_uÆock
(&
·»Á
->
d_lock
);

1275  
d’Œy
;

1276 
	}
}

1277 
EXPORT_SYMBOL
(
d_®loc
);

1279 
d’Œy
 *
	$d_®loc_p£udo
(
su³r_block
 *
sb
, cÚ¡ 
q¡r
 *
Çme
)

1281 
d’Œy
 *d’Œy = 
	`__d_®loc
(
sb
, 
Çme
);

1282 ià(
d’Œy
)

1283 
d’Œy
->
d_æags
 |ğ
DCACHE_DISCONNECTED
;

1284  
d’Œy
;

1285 
	}
}

1286 
EXPORT_SYMBOL
(
d_®loc_p£udo
);

1288 
d’Œy
 *
	$d_®loc_Çme
(
d’Œy
 *
·»Á
, cÚ¡ *
Çme
)

1290 
q¡r
 
q
;

1292 
q
.
Çme
 =‚ame;

1293 
q
.
Ën
 = 
	`¡¾’
(
Çme
);

1294 
q
.
hash
 = 
	`fuÎ_Çme_hash
(q.
Çme
, q.
Ën
);

1295  
	`d_®loc
(
·»Á
, &
q
);

1296 
	}
}

1297 
EXPORT_SYMBOL
(
d_®loc_Çme
);

1299 
	$d_£t_d_İ
(
d’Œy
 *d’Œy, cÚ¡ 
d’Œy_İ”©iÚs
 *
İ
)

1301 
	`WARN_ON_ONCE
(
d’Œy
->
d_İ
);

1302 
	`WARN_ON_ONCE
(
d’Œy
->
d_æags
 & (
DCACHE_OP_HASH
 |

1303 
DCACHE_OP_COMPARE
 |

1304 
DCACHE_OP_REVALIDATE
 |

1305 
DCACHE_OP_DELETE
 ));

1306 
d’Œy
->
d_İ
 = 
İ
;

1307 ià(!
İ
)

1309 ià(
İ
->
d_hash
)

1310 
d’Œy
->
d_æags
 |ğ
DCACHE_OP_HASH
;

1311 ià(
İ
->
d_com·»
)

1312 
d’Œy
->
d_æags
 |ğ
DCACHE_OP_COMPARE
;

1313 ià(
İ
->
d_»v®id©e
)

1314 
d’Œy
->
d_æags
 |ğ
DCACHE_OP_REVALIDATE
;

1315 ià(
İ
->
d_d–‘e
)

1316 
d’Œy
->
d_æags
 |ğ
DCACHE_OP_DELETE
;

1317 ià(
İ
->
d_´uÃ
)

1318 
d’Œy
->
d_æags
 |ğ
DCACHE_OP_PRUNE
;

1320 
	}
}

1321 
EXPORT_SYMBOL
(
d_£t_d_İ
);

1323 
	$__d_š¡ªtŸ‹
(
d’Œy
 *d’Œy, 
šode
 *inode)

1325 
	`¥š_lock
(&
d’Œy
->
d_lock
);

1326 ià(
šode
) {

1327 ià(
	`uÆik–y
(
	`IS_AUTOMOUNT
(
šode
)))

1328 
d’Œy
->
d_æags
 |ğ
DCACHE_NEED_AUTOMOUNT
;

1329 
	`li¡_add
(&
d’Œy
->
d_®Ÿs
, &
šode
->
i_d’Œy
);

1331 
d’Œy
->
d_šode
 = 
šode
;

1332 
	`d’Œy_rcuw®k_b¬r›r
(
d’Œy
);

1333 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

1334 
	`f¢Ùify_d_š¡ªtŸ‹
(
d’Œy
, 
šode
);

1335 
	}
}

1352 
	$d_š¡ªtŸ‹
(
d’Œy
 *
’Œy
, 
šode
 * inode)

1354 
	`BUG_ON
(!
	`li¡_em±y
(&
’Œy
->
d_®Ÿs
));

1355 ià(
šode
)

1356 
	`¥š_lock
(&
šode
->
i_lock
);

1357 
	`__d_š¡ªtŸ‹
(
’Œy
, 
šode
);

1358 ià(
šode
)

1359 
	`¥š_uÆock
(&
šode
->
i_lock
);

1360 
	`£cur™y_d_š¡ªtŸ‹
(
’Œy
, 
šode
);

1361 
	}
}

1362 
EXPORT_SYMBOL
(
d_š¡ªtŸ‹
);

1380 
d’Œy
 *
	$__d_š¡ªtŸ‹_unique
(
d’Œy
 *
’Œy
,

1381 
šode
 *inode)

1383 
d’Œy
 *
®Ÿs
;

1384 
Ën
 = 
’Œy
->
d_Çme
.len;

1385 cÚ¡ *
Çme
 = 
’Œy
->
d_Çme
.name;

1386 
hash
 = 
’Œy
->
d_Çme
.hash;

1388 ià(!
šode
) {

1389 
	`__d_š¡ªtŸ‹
(
’Œy
, 
NULL
);

1390  
NULL
;

1393 
	`li¡_fÜ_—ch_’Œy
(
®Ÿs
, &
šode
->
i_d’Œy
, 
d_®Ÿs
) {

1394 
q¡r
 *q¡¸ğ&
®Ÿs
->
d_Çme
;

1401 ià(
q¡r
->
hash
 != hash)

1403 ià(
®Ÿs
->
d_·»Á
 !ğ
’Œy
->d_parent)

1405 ià(
	`d’Œy_cmp
(
q¡r
->
Çme
, q¡r->
Ën
,‚ame,†en))

1407 
	`__dg‘
(
®Ÿs
);

1408  
®Ÿs
;

1411 
	`__d_š¡ªtŸ‹
(
’Œy
, 
šode
);

1412  
NULL
;

1413 
	}
}

1415 
d’Œy
 *
	$d_š¡ªtŸ‹_unique
(
d’Œy
 *
’Œy
, 
šode
 *inode)

1417 
d’Œy
 *
»suÉ
;

1419 
	`BUG_ON
(!
	`li¡_em±y
(&
’Œy
->
d_®Ÿs
));

1421 ià(
šode
)

1422 
	`¥š_lock
(&
šode
->
i_lock
);

1423 
»suÉ
 = 
	`__d_š¡ªtŸ‹_unique
(
’Œy
, 
šode
);

1424 ià(
šode
)

1425 
	`¥š_uÆock
(&
šode
->
i_lock
);

1427 ià(!
»suÉ
) {

1428 
	`£cur™y_d_š¡ªtŸ‹
(
’Œy
, 
šode
);

1429  
NULL
;

1432 
	`BUG_ON
(!
	`d_unhashed
(
»suÉ
));

1433 
	`ut
(
šode
);

1434  
»suÉ
;

1435 
	}
}

1437 
EXPORT_SYMBOL
(
d_š¡ªtŸ‹_unique
);

1448 
d’Œy
 * 
	$d_®loc_roÙ
(
šode
 * 
roÙ_šode
)

1450 
d’Œy
 *
»s
 = 
NULL
;

1452 ià(
roÙ_šode
) {

1453 cÚ¡ 
q¡r
 
Çme
 = { .Çmğ"/", .
Ën
 = 1 };

1455 
»s
 = 
	`__d_®loc
(
roÙ_šode
->
i_sb
, &
Çme
);

1456 ià(
»s
)

1457 
	`d_š¡ªtŸ‹
(
»s
, 
roÙ_šode
);

1459  
»s
;

1460 
	}
}

1461 
EXPORT_SYMBOL
(
d_®loc_roÙ
);

1463 
d’Œy
 * 
	$__d_fšd_ªy_®Ÿs
(
šode
 *inode)

1465 
d’Œy
 *
®Ÿs
;

1467 ià(
	`li¡_em±y
(&
šode
->
i_d’Œy
))

1468  
NULL
;

1469 
®Ÿs
 = 
	`li¡_fœ¡_’Œy
(&
šode
->
i_d’Œy
, 
d’Œy
, 
d_®Ÿs
);

1470 
	`__dg‘
(
®Ÿs
);

1471  
®Ÿs
;

1472 
	}
}

1474 
d’Œy
 * 
	$d_fšd_ªy_®Ÿs
(
šode
 *inode)

1476 
d’Œy
 *
de
;

1478 
	`¥š_lock
(&
šode
->
i_lock
);

1479 
de
 = 
	`__d_fšd_ªy_®Ÿs
(
šode
);

1480 
	`¥š_uÆock
(&
šode
->
i_lock
);

1481  
de
;

1482 
	}
}

1503 
d’Œy
 *
	$d_obš_®Ÿs
(
šode
 *inode)

1505 cÚ¡ 
q¡r
 
ªÚ¡ršg
 = { .
Çme
 = "" };

1506 
d’Œy
 *
tmp
;

1507 
d’Œy
 *
»s
;

1509 ià(!
šode
)

1510  
	`ERR_PTR
(-
ESTALE
);

1511 ià(
	`IS_ERR
(
šode
))

1512  
	`ERR_CAST
(
šode
);

1514 
»s
 = 
	`d_fšd_ªy_®Ÿs
(
šode
);

1515 ià(
»s
)

1516 
out_ut
;

1518 
tmp
 = 
	`__d_®loc
(
šode
->
i_sb
, &
ªÚ¡ršg
);

1519 ià(!
tmp
) {

1520 
»s
 = 
	`ERR_PTR
(-
ENOMEM
);

1521 
out_ut
;

1524 
	`¥š_lock
(&
šode
->
i_lock
);

1525 
»s
 = 
	`__d_fšd_ªy_®Ÿs
(
šode
);

1526 ià(
»s
) {

1527 
	`¥š_uÆock
(&
šode
->
i_lock
);

1528 
	`dput
(
tmp
);

1529 
out_ut
;

1533 
	`¥š_lock
(&
tmp
->
d_lock
);

1534 
tmp
->
d_šode
 = 
šode
;

1535 
tmp
->
d_æags
 |ğ
DCACHE_DISCONNECTED
;

1536 
	`li¡_add
(&
tmp
->
d_®Ÿs
, &
šode
->
i_d’Œy
);

1537 
	`hli¡_bl_lock
(&
tmp
->
d_sb
->
s_ªÚ
);

1538 
	`hli¡_bl_add_h—d
(&
tmp
->
d_hash
, &tmp->
d_sb
->
s_ªÚ
);

1539 
	`hli¡_bl_uÆock
(&
tmp
->
d_sb
->
s_ªÚ
);

1540 
	`¥š_uÆock
(&
tmp
->
d_lock
);

1541 
	`¥š_uÆock
(&
šode
->
i_lock
);

1542 
	`£cur™y_d_š¡ªtŸ‹
(
tmp
, 
šode
);

1544  
tmp
;

1546 
out_ut
:

1547 ià(
»s
 && !
	`IS_ERR
(res))

1548 
	`£cur™y_d_š¡ªtŸ‹
(
»s
, 
šode
);

1549 
	`ut
(
šode
);

1550  
»s
;

1551 
	}
}

1552 
EXPORT_SYMBOL
(
d_obš_®Ÿs
);

1570 
d’Œy
 *
	$d_¥liû_®Ÿs
(
šode
 *šode, 
d’Œy
 *dentry)

1572 
d’Œy
 *
Ãw
 = 
NULL
;

1574 ià(
	`IS_ERR
(
šode
))

1575  
	`ERR_CAST
(
šode
);

1577 ià(
šode
 && 
	`S_ISDIR
(šode->
i_mode
)) {

1578 
	`¥š_lock
(&
šode
->
i_lock
);

1579 
Ãw
 = 
	`__d_fšd_®Ÿs
(
šode
, 1);

1580 ià(
Ãw
) {

1581 
	`BUG_ON
(!(
Ãw
->
d_æags
 & 
DCACHE_DISCONNECTED
));

1582 
	`¥š_uÆock
(&
šode
->
i_lock
);

1583 
	`£cur™y_d_š¡ªtŸ‹
(
Ãw
, 
šode
);

1584 
	`d_move
(
Ãw
, 
d’Œy
);

1585 
	`ut
(
šode
);

1588 
	`__d_š¡ªtŸ‹
(
d’Œy
, 
šode
);

1589 
	`¥š_uÆock
(&
šode
->
i_lock
);

1590 
	`£cur™y_d_š¡ªtŸ‹
(
d’Œy
, 
šode
);

1591 
	`d_»hash
(
d’Œy
);

1594 
	`d_add
(
d’Œy
, 
šode
);

1595  
Ãw
;

1596 
	}
}

1597 
EXPORT_SYMBOL
(
d_¥liû_®Ÿs
);

1615 
d’Œy
 *
	$d_add_ci
(
d’Œy
 *d’Œy, 
šode
 *inode,

1616 
q¡r
 *
Çme
)

1618 
”rÜ
;

1619 
d’Œy
 *
found
;

1620 
d’Œy
 *
Ãw
;

1626 
found
 = 
	`d_hash_ªd_lookup
(
d’Œy
->
d_·»Á
, 
Çme
);

1627 ià(!
found
) {

1628 
Ãw
 = 
	`d_®loc
(
d’Œy
->
d_·»Á
, 
Çme
);

1629 ià(!
Ãw
) {

1630 
”rÜ
 = -
ENOMEM
;

1631 
”r_out
;

1634 
found
 = 
	`d_¥liû_®Ÿs
(
šode
, 
Ãw
);

1635 ià(
found
) {

1636 
	`dput
(
Ãw
);

1637  
found
;

1639  
Ãw
;

1648 ià(
found
->
d_šode
) {

1649 ià(
	`uÆik–y
(
found
->
d_šode
 !ğ
šode
)) {

1651 
	`BUG_ON
(!
	`is_bad_šode
(
šode
));

1652 
	`BUG_ON
(!
	`is_bad_šode
(
found
->
d_šode
));

1654 
	`ut
(
šode
);

1655  
found
;

1662 ià(
	`uÆik–y
(
	`d_Ãed_lookup
(
found
)))

1663 
	`d_ş—r_Ãed_lookup
(
found
);

1669 
Ãw
 = 
	`d_¥liû_®Ÿs
(
šode
, 
found
);

1670 ià(
Ãw
) {

1671 
	`dput
(
found
);

1672 
found
 = 
Ãw
;

1674  
found
;

1676 
”r_out
:

1677 
	`ut
(
šode
);

1678  
	`ERR_PTR
(
”rÜ
);

1679 
	}
}

1680 
EXPORT_SYMBOL
(
d_add_ci
);

1709 
d’Œy
 *
	$__d_lookup_rcu
(
d’Œy
 *
·»Á
, 
q¡r
 *
Çme
,

1710 *
£q
, 
šode
 **inode)

1712 
Ën
 = 
Çme
->len;

1713 
hash
 = 
Çme
->hash;

1714 cÚ¡ *
¡r
 = 
Çme
->name;

1715 
hli¡_bl_h—d
 *
b
 = 
	`d_hash
(
·»Á
, 
hash
);

1716 
hli¡_bl_node
 *
node
;

1717 
d’Œy
 *dentry;

1739 
	`hli¡_bl_fÜ_—ch_’Œy_rcu
(
d’Œy
, 
node
, 
b
, 
d_hash
) {

1740 
šode
 *
i
;

1741 cÚ¡ *
Šame
;

1742 
’
;

1744 ià(
d’Œy
->
d_Çme
.
hash
 != hash)

1747 
£q»Œy
:

1748 *
£q
 = 
	`»ad_£qcouÁ_begš
(&
d’Œy
->
d_£q
);

1749 ià(
d’Œy
->
d_·»Á
 !ğ
·»Á
)

1751 ià(
	`d_unhashed
(
d’Œy
))

1753 
’
 = 
d’Œy
->
d_Çme
.
Ën
;

1754 
Šame
 = 
d’Œy
->
d_Çme
.
Çme
;

1755 
i
 = 
d’Œy
->
d_šode
;

1756 
	`´eãtch
(
Šame
);

1763 ià(
	`»ad_£qcouÁ_»Œy
(&
d’Œy
->
d_£q
, *
£q
))

1764 
£q»Œy
;

1765 ià(
	`uÆik–y
(
·»Á
->
d_æags
 & 
DCACHE_OP_COMPARE
)) {

1766 ià(
·»Á
->
d_İ
->
	`d_com·»
Õ¬’t, *
šode
,

1767 
d’Œy
, 
i
,

1768 
’
, 
Šame
, 
Çme
))

1771 ià(
	`d’Œy_cmp
(
Šame
, 
’
, 
¡r
, 
Ën
))

1780 *
šode
 = 
i
;

1781  
d’Œy
;

1783  
NULL
;

1784 
	}
}

1797 
d’Œy
 *
	$d_lookup
(
d’Œy
 *
·»Á
, 
q¡r
 *
Çme
)

1799 
d’Œy
 *dentry;

1800 
£q
;

1803 
£q
 = 
	`»ad_£qbegš
(&
»Çme_lock
);

1804 
d’Œy
 = 
	`__d_lookup
(
·»Á
, 
Çme
);

1805 ià(
d’Œy
)

1807 } 
	`»ad_£q»Œy
(&
»Çme_lock
, 
£q
));

1808  
d’Œy
;

1809 
	}
}

1810 
EXPORT_SYMBOL
(
d_lookup
);

1827 
d’Œy
 *
	$__d_lookup
(
d’Œy
 *
·»Á
, 
q¡r
 *
Çme
)

1829 
Ën
 = 
Çme
->len;

1830 
hash
 = 
Çme
->hash;

1831 cÚ¡ *
¡r
 = 
Çme
->name;

1832 
hli¡_bl_h—d
 *
b
 = 
	`d_hash
(
·»Á
, 
hash
);

1833 
hli¡_bl_node
 *
node
;

1834 
d’Œy
 *
found
 = 
NULL
;

1835 
d’Œy
 *dentry;

1857 
	`rcu_»ad_lock
();

1859 
	`hli¡_bl_fÜ_—ch_’Œy_rcu
(
d’Œy
, 
node
, 
b
, 
d_hash
) {

1860 cÚ¡ *
Šame
;

1861 
’
;

1863 ià(
d’Œy
->
d_Çme
.
hash
 != hash)

1866 
	`¥š_lock
(&
d’Œy
->
d_lock
);

1867 ià(
d’Œy
->
d_·»Á
 !ğ
·»Á
)

1868 
Ãxt
;

1869 ià(
	`d_unhashed
(
d’Œy
))

1870 
Ãxt
;

1876 
’
 = 
d’Œy
->
d_Çme
.
Ën
;

1877 
Šame
 = 
d’Œy
->
d_Çme
.
Çme
;

1878 ià(
·»Á
->
d_æags
 & 
DCACHE_OP_COMPARE
) {

1879 ià(
·»Á
->
d_İ
->
	`d_com·»
Õ¬’t,…¬’t->
d_šode
,

1880 
d’Œy
, d’Œy->
d_šode
,

1881 
’
, 
Šame
, 
Çme
))

1882 
Ãxt
;

1884 ià(
	`d’Œy_cmp
(
Šame
, 
’
, 
¡r
, 
Ën
))

1885 
Ãxt
;

1888 
d’Œy
->
d_couÁ
++;

1889 
found
 = 
d’Œy
;

1890 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

1892 
Ãxt
:

1893 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

1895 
	`rcu_»ad_uÆock
();

1897  
found
;

1898 
	}
}

1907 
d’Œy
 *
	$d_hash_ªd_lookup
(
d’Œy
 *
dœ
, 
q¡r
 *
Çme
)

1909 
d’Œy
 *d’Œy = 
NULL
;

1916 
Çme
->
hash
 = 
	`fuÎ_Çme_hash
Òame->Çme,‚ame->
Ën
);

1917 ià(
dœ
->
d_æags
 & 
DCACHE_OP_HASH
) {

1918 ià(
dœ
->
d_İ
->
	`d_hash
(dœ, dœ->
d_šode
, 
Çme
) < 0)

1919 
out
;

1921 
d’Œy
 = 
	`d_lookup
(
dœ
, 
Çme
);

1922 
out
:

1923  
d’Œy
;

1924 
	}
}

1937 
	$d_v®id©e
(
d’Œy
 *d’Œy, d’Œy *
d·»Á
)

1939 
d’Œy
 *
chd
;

1941 
	`¥š_lock
(&
d·»Á
->
d_lock
);

1942 
	`li¡_fÜ_—ch_’Œy
(
chd
, &
d·»Á
->
d_subdœs
, 
d_u
.
d_chd
) {

1943 ià(
d’Œy
 =ğ
chd
) {

1944 
	`¥š_lock_Ã¡ed
(&
d’Œy
->
d_lock
, 
DENTRY_D_LOCK_NESTED
);

1945 
	`__dg‘_dlock
(
d’Œy
);

1946 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

1947 
	`¥š_uÆock
(&
d·»Á
->
d_lock
);

1951 
	`¥š_uÆock
(&
d·»Á
->
d_lock
);

1954 
	}
}

1955 
EXPORT_SYMBOL
(
d_v®id©e
);

1978 
	$d_d–‘e
(
d’Œy
 * dentry)

1980 
šode
 *inode;

1981 
isdœ
 = 0;

1985 
agaš
:

1986 
	`¥š_lock
(&
d’Œy
->
d_lock
);

1987 
šode
 = 
d’Œy
->
d_šode
;

1988 
isdœ
 = 
	`S_ISDIR
(
šode
->
i_mode
);

1989 ià(
d’Œy
->
d_couÁ
 == 1) {

1990 ià(
šode
 && !
	`¥š_Œylock
(&šode->
i_lock
)) {

1991 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

1992 
	`ıu_»Ïx
();

1993 
agaš
;

1995 
d’Œy
->
d_æags
 &ğ~
DCACHE_CANT_MOUNT
;

1996 
	`d’Œy_uÆšk_šode
(
d’Œy
);

1997 
	`f¢Ùify_Çm”emove
(
d’Œy
, 
isdœ
);

2001 ià(!
	`d_unhashed
(
d’Œy
))

2002 
	`__d_drİ
(
d’Œy
);

2004 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

2006 
	`f¢Ùify_Çm”emove
(
d’Œy
, 
isdœ
);

2007 
	}
}

2008 
EXPORT_SYMBOL
(
d_d–‘e
);

2010 
	$__d_»hash
(
d’Œy
 * 
’Œy
, 
hli¡_bl_h—d
 *
b
)

2012 
	`BUG_ON
(!
	`d_unhashed
(
’Œy
));

2013 
	`hli¡_bl_lock
(
b
);

2014 
’Œy
->
d_æags
 |ğ
DCACHE_RCUACCESS
;

2015 
	`hli¡_bl_add_h—d_rcu
(&
’Œy
->
d_hash
, 
b
);

2016 
	`hli¡_bl_uÆock
(
b
);

2017 
	}
}

2019 
	$_d_»hash
(
d’Œy
 * 
’Œy
)

2021 
	`__d_»hash
(
’Œy
, 
	`d_hash
ÓÁry->
d_·»Á
,ƒÁry->
d_Çme
.
hash
));

2022 
	}
}

2031 
	$d_»hash
(
d’Œy
 * 
’Œy
)

2033 
	`¥š_lock
(&
’Œy
->
d_lock
);

2034 
	`_d_»hash
(
’Œy
);

2035 
	`¥š_uÆock
(&
’Œy
->
d_lock
);

2036 
	}
}

2037 
EXPORT_SYMBOL
(
d_»hash
);

2053 
	$d’Œy_upd©e_Çme_ÿ£
(
d’Œy
 *d’Œy, 
q¡r
 *
Çme
)

2055 
	`BUG_ON
(!
	`mu‹x_is_locked
(&
d’Œy
->
d_·»Á
->
d_šode
->
i_mu‹x
));

2056 
	`BUG_ON
(
d’Œy
->
d_Çme
.
Ën
 !ğ
Çme
->len);

2058 
	`¥š_lock
(&
d’Œy
->
d_lock
);

2059 
	`wr™e_£qcouÁ_begš
(&
d’Œy
->
d_£q
);

2060 
	`memıy
((*)
d’Œy
->
d_Çme
.
Çme
,‚ame->Çme,‚ame->
Ën
);

2061 
	`wr™e_£qcouÁ_’d
(&
d’Œy
->
d_£q
);

2062 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

2063 
	}
}

2064 
EXPORT_SYMBOL
(
d’Œy_upd©e_Çme_ÿ£
);

2066 
	$sw™ch_Çmes
(
d’Œy
 *d’Œy, d’Œy *
rg‘
)

2068 ià(
	`dÇme_ex‹º®
(
rg‘
)) {

2069 ià(
	`dÇme_ex‹º®
(
d’Œy
)) {

2073 
	`sw­
(
rg‘
->
d_Çme
.
Çme
, 
d’Œy
->d_name.name);

2079 
	`memıy
(
rg‘
->
d_šame
, 
d’Œy
->
d_Çme
.
Çme
,

2080 
d’Œy
->
d_Çme
.
Ën
 + 1);

2081 
d’Œy
->
d_Çme
.
Çme
 = 
rg‘
->d_name.name;

2082 
rg‘
->
d_Çme
.
Çme
 =¬g‘->
d_šame
;

2085 ià(
	`dÇme_ex‹º®
(
d’Œy
)) {

2090 
	`memıy
(
d’Œy
->
d_šame
, 
rg‘
->
d_Çme
.
Çme
,

2091 
rg‘
->
d_Çme
.
Ën
 + 1);

2092 
rg‘
->
d_Çme
.
Çme
 = 
d’Œy
->d_name.name;

2093 
d’Œy
->
d_Çme
.
Çme
 = d’Œy->
d_šame
;

2098 
	`memıy
(
d’Œy
->
d_šame
, 
rg‘
->
d_Çme
.
Çme
,

2099 
rg‘
->
d_Çme
.
Ën
 + 1);

2100 
d’Œy
->
d_Çme
.
Ën
 = 
rg‘
->d_name.len;

2104 
	`sw­
(
d’Œy
->
d_Çme
.
Ën
, 
rg‘
->d_name.len);

2105 
	}
}

2107 
	$d’Œy_lock_fÜ_move
(
d’Œy
 *d’Œy, d’Œy *
rg‘
)

2112 ià(
	`IS_ROOT
(
d’Œy
è|| d’Œy->
d_·»Á
 =ğ
rg‘
->d_parent)

2113 
	`¥š_lock
(&
rg‘
->
d_·»Á
->
d_lock
);

2115 ià(
	`d_ªû¡Ü
(
d’Œy
->
d_·»Á
, 
rg‘
->d_parent)) {

2116 
	`¥š_lock
(&
d’Œy
->
d_·»Á
->
d_lock
);

2117 
	`¥š_lock_Ã¡ed
(&
rg‘
->
d_·»Á
->
d_lock
,

2118 
DENTRY_D_LOCK_NESTED
);

2120 
	`¥š_lock
(&
rg‘
->
d_·»Á
->
d_lock
);

2121 
	`¥š_lock_Ã¡ed
(&
d’Œy
->
d_·»Á
->
d_lock
,

2122 
DENTRY_D_LOCK_NESTED
);

2125 ià(
rg‘
 < 
d’Œy
) {

2126 
	`¥š_lock_Ã¡ed
(&
rg‘
->
d_lock
, 2);

2127 
	`¥š_lock_Ã¡ed
(&
d’Œy
->
d_lock
, 3);

2129 
	`¥š_lock_Ã¡ed
(&
d’Œy
->
d_lock
, 2);

2130 
	`¥š_lock_Ã¡ed
(&
rg‘
->
d_lock
, 3);

2132 
	}
}

2134 
	$d’Œy_uÆock_·»Ás_fÜ_move
(
d’Œy
 *dentry,

2135 
d’Œy
 *
rg‘
)

2137 ià(
rg‘
->
d_·»Á
 !ğ
d’Œy
->d_parent)

2138 
	`¥š_uÆock
(&
d’Œy
->
d_·»Á
->
d_lock
);

2139 ià(
rg‘
->
d_·»Á
 !=arget)

2140 
	`¥š_uÆock
(&
rg‘
->
d_·»Á
->
d_lock
);

2141 
	}
}

2164 
	$__d_move
(
d’Œy
 * d’Œy, d’Œy * 
rg‘
)

2166 ià(!
d’Œy
->
d_šode
)

2167 
	`´štk
(
KERN_WARNING
 "VFS: moving‚egative dcacheƒntry\n");

2169 
	`BUG_ON
(
	`d_ªû¡Ü
(
d’Œy
, 
rg‘
));

2170 
	`BUG_ON
(
	`d_ªû¡Ü
(
rg‘
, 
d’Œy
));

2172 
	`d’Œy_lock_fÜ_move
(
d’Œy
, 
rg‘
);

2174 
	`wr™e_£qcouÁ_begš
(&
d’Œy
->
d_£q
);

2175 
	`wr™e_£qcouÁ_begš
(&
rg‘
->
d_£q
);

2183 
	`__d_drİ
(
d’Œy
);

2184 
	`__d_»hash
(
d’Œy
, 
	`d_hash
(
rg‘
->
d_·»Á
,¬g‘->
d_Çme
.
hash
));

2187 
	`__d_drİ
(
rg‘
);

2189 
	`li¡_d–
(&
d’Œy
->
d_u
.
d_chd
);

2190 
	`li¡_d–
(&
rg‘
->
d_u
.
d_chd
);

2193 
	`sw™ch_Çmes
(
d’Œy
, 
rg‘
);

2194 
	`sw­
(
d’Œy
->
d_Çme
.
hash
, 
rg‘
->d_name.hash);

2197 ià(
	`IS_ROOT
(
d’Œy
)) {

2198 
d’Œy
->
d_·»Á
 = 
rg‘
->d_parent;

2199 
rg‘
->
d_·»Á
 =arget;

2200 
	`INIT_LIST_HEAD
(&
rg‘
->
d_u
.
d_chd
);

2202 
	`sw­
(
d’Œy
->
d_·»Á
, 
rg‘
->d_parent);

2205 
	`li¡_add
(&
rg‘
->
d_u
.
d_chd
, &rg‘->
d_·»Á
->
d_subdœs
);

2208 
	`li¡_add
(&
d’Œy
->
d_u
.
d_chd
, &d’Œy->
d_·»Á
->
d_subdœs
);

2210 
	`wr™e_£qcouÁ_’d
(&
rg‘
->
d_£q
);

2211 
	`wr™e_£qcouÁ_’d
(&
d’Œy
->
d_£q
);

2213 
	`d’Œy_uÆock_·»Ás_fÜ_move
(
d’Œy
, 
rg‘
);

2214 
	`¥š_uÆock
(&
rg‘
->
d_lock
);

2215 
	`f¢Ùify_d_move
(
d’Œy
);

2216 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

2217 
	}
}

2228 
	$d_move
(
d’Œy
 *d’Œy, d’Œy *
rg‘
)

2230 
	`wr™e_£qlock
(&
»Çme_lock
);

2231 
	`__d_move
(
d’Œy
, 
rg‘
);

2232 
	`wr™e_£quÆock
(&
»Çme_lock
);

2233 
	}
}

2234 
EXPORT_SYMBOL
(
d_move
);

2244 
d’Œy
 *
	$d_ªû¡Ü
(
d’Œy
 *
p1
, d’Œy *
p2
)

2246 
d’Œy
 *
p
;

2248 
p
 = 
p2
; !
	`IS_ROOT
Õ);… =…->
d_·»Á
) {

2249 ià(
p
->
d_·»Á
 =ğ
p1
)

2250  
p
;

2252  
NULL
;

2253 
	}
}

2264 
d’Œy
 *
	$__d_uÇlŸs
(
šode
 *inode,

2265 
d’Œy
 *d’Œy, d’Œy *
®Ÿs
)

2267 
mu‹x
 *
m1
 = 
NULL
, *
m2
 = NULL;

2268 
d’Œy
 *
»t
;

2271 ià(
®Ÿs
->
d_·»Á
 =ğ
d’Œy
->d_parent)

2272 
out_uÇlŸs
;

2275 
»t
 = 
	`ERR_PTR
(-
EBUSY
);

2276 ià(!
	`mu‹x_Œylock
(&
d’Œy
->
d_sb
->
s_vfs_»Çme_mu‹x
))

2277 
out_”r
;

2278 
m1
 = &
d’Œy
->
d_sb
->
s_vfs_»Çme_mu‹x
;

2279 ià(!
	`mu‹x_Œylock
(&
®Ÿs
->
d_·»Á
->
d_šode
->
i_mu‹x
))

2280 
out_”r
;

2281 
m2
 = &
®Ÿs
->
d_·»Á
->
d_šode
->
i_mu‹x
;

2282 
out_uÇlŸs
:

2283 
	`__d_move
(
®Ÿs
, 
d’Œy
);

2284 
»t
 = 
®Ÿs
;

2285 
out_”r
:

2286 
	`¥š_uÆock
(&
šode
->
i_lock
);

2287 ià(
m2
)

2288 
	`mu‹x_uÆock
(
m2
);

2289 ià(
m1
)

2290 
	`mu‹x_uÆock
(
m1
);

2291  
»t
;

2292 
	}
}

2299 
	$__d_m©”Ÿli£_d’Œy
(
d’Œy
 *d’Œy, d’Œy *
ªÚ
)

2301 
d’Œy
 *
d·»Á
, *
­¬’t
;

2303 
	`d’Œy_lock_fÜ_move
(
ªÚ
, 
d’Œy
);

2305 
	`wr™e_£qcouÁ_begš
(&
d’Œy
->
d_£q
);

2306 
	`wr™e_£qcouÁ_begš
(&
ªÚ
->
d_£q
);

2308 
d·»Á
 = 
d’Œy
->
d_·»Á
;

2309 
­¬’t
 = 
ªÚ
->
d_·»Á
;

2311 
	`sw™ch_Çmes
(
d’Œy
, 
ªÚ
);

2312 
	`sw­
(
d’Œy
->
d_Çme
.
hash
, 
ªÚ
->d_name.hash);

2314 
d’Œy
->
d_·»Á
 = (
­¬’t
 =ğ
ªÚ
) ? dentry :‡parent;

2315 
	`li¡_d–
(&
d’Œy
->
d_u
.
d_chd
);

2316 ià(!
	`IS_ROOT
(
d’Œy
))

2317 
	`li¡_add
(&
d’Œy
->
d_u
.
d_chd
, &d’Œy->
d_·»Á
->
d_subdœs
);

2319 
	`INIT_LIST_HEAD
(&
d’Œy
->
d_u
.
d_chd
);

2321 
ªÚ
->
d_·»Á
 = (
d·»Á
 =ğ
d’Œy
) ?‡non : dparent;

2322 
	`li¡_d–
(&
ªÚ
->
d_u
.
d_chd
);

2323 ià(!
	`IS_ROOT
(
ªÚ
))

2324 
	`li¡_add
(&
ªÚ
->
d_u
.
d_chd
, &ªÚ->
d_·»Á
->
d_subdœs
);

2326 
	`INIT_LIST_HEAD
(&
ªÚ
->
d_u
.
d_chd
);

2328 
	`wr™e_£qcouÁ_’d
(&
d’Œy
->
d_£q
);

2329 
	`wr™e_£qcouÁ_’d
(&
ªÚ
->
d_£q
);

2331 
	`d’Œy_uÆock_·»Ás_fÜ_move
(
ªÚ
, 
d’Œy
);

2332 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

2335 
ªÚ
->
d_æags
 &ğ~
DCACHE_DISCONNECTED
;

2336 
	}
}

2347 
d’Œy
 *
	$d_m©”Ÿli£_unique
(
d’Œy
 *d’Œy, 
šode
 *inode)

2349 
d’Œy
 *
aùu®
;

2351 
	`BUG_ON
(!
	`d_unhashed
(
d’Œy
));

2353 ià(!
šode
) {

2354 
aùu®
 = 
d’Œy
;

2355 
	`__d_š¡ªtŸ‹
(
d’Œy
, 
NULL
);

2356 
	`d_»hash
(
aùu®
);

2357 
out_nŞock
;

2360 
	`¥š_lock
(&
šode
->
i_lock
);

2362 ià(
	`S_ISDIR
(
šode
->
i_mode
)) {

2363 
d’Œy
 *
®Ÿs
;

2366 
®Ÿs
 = 
	`__d_fšd_®Ÿs
(
šode
, 0);

2367 ià(
®Ÿs
) {

2368 
aùu®
 = 
®Ÿs
;

2369 
	`wr™e_£qlock
(&
»Çme_lock
);

2371 ià(
	`d_ªû¡Ü
(
®Ÿs
, 
d’Œy
)) {

2373 
aùu®
 = 
	`ERR_PTR
(-
ELOOP
);

2374 } ià(
	`IS_ROOT
(
®Ÿs
)) {

2377 
	`__d_m©”Ÿli£_d’Œy
(
d’Œy
, 
®Ÿs
);

2378 
	`wr™e_£quÆock
(&
»Çme_lock
);

2379 
	`__d_drİ
(
®Ÿs
);

2380 
found
;

2384 
aùu®
 = 
	`__d_uÇlŸs
(
šode
, 
d’Œy
, 
®Ÿs
);

2386 
	`wr™e_£quÆock
(&
»Çme_lock
);

2387 ià(
	`IS_ERR
(
aùu®
)) {

2388 ià(
	`PTR_ERR
(
aùu®
è=ğ-
ELOOP
)

2389 
	`´_w¬n_¿‹lim™ed
(

2392 
d’Œy
->
d_Çme
.
Çme
,

2393 
šode
->
i_sb
->
s_ty³
->
Çme
,

2394 
šode
->
i_sb
->
s_id
);

2395 
	`dput
(
®Ÿs
);

2397 
out_nŞock
;

2402 
aùu®
 = 
	`__d_š¡ªtŸ‹_unique
(
d’Œy
, 
šode
);

2403 ià(!
aùu®
)

2404 
aùu®
 = 
d’Œy
;

2406 
	`BUG_ON
(!
	`d_unhashed
(
aùu®
));

2408 
	`¥š_lock
(&
aùu®
->
d_lock
);

2409 
found
:

2410 
	`_d_»hash
(
aùu®
);

2411 
	`¥š_uÆock
(&
aùu®
->
d_lock
);

2412 
	`¥š_uÆock
(&
šode
->
i_lock
);

2413 
out_nŞock
:

2414 ià(
aùu®
 =ğ
d’Œy
) {

2415 
	`£cur™y_d_š¡ªtŸ‹
(
d’Œy
, 
šode
);

2416  
NULL
;

2419 
	`ut
(
šode
);

2420  
aùu®
;

2421 
	}
}

2422 
EXPORT_SYMBOL_GPL
(
d_m©”Ÿli£_unique
);

2424 
	$´•’d
(**
bufãr
, *
buæ’
, cÚ¡ *
¡r
, 
Çm–’
)

2426 *
buæ’
 -ğ
Çm–’
;

2427 ià(*
buæ’
 < 0)

2428  -
ENAMETOOLONG
;

2429 *
bufãr
 -ğ
Çm–’
;

2430 
	`memıy
(*
bufãr
, 
¡r
, 
Çm–’
);

2432 
	}
}

2434 
	$´•’d_Çme
(**
bufãr
, *
buæ’
, 
q¡r
 *
Çme
)

2436  
	`´•’d
(
bufãr
, 
buæ’
, 
Çme
->Çme,‚ame->
Ën
);

2437 
	}
}

2448 
	$´•’d_·th
(cÚ¡ 
·th
 *path,

2449 cÚ¡ 
·th
 *
roÙ
,

2450 **
bufãr
, *
buæ’
)

2452 
d’Œy
 *d’Œy = 
·th
->dentry;

2453 
vfsmouÁ
 *
vfsmÁ
 = 
·th
->
mÁ
;

2454 
boŞ
 
¦ash
 = 
çl£
;

2455 
”rÜ
 = 0;

2457 
	`br_»ad_lock
(
vfsmouÁ_lock
);

2458 
d’Œy
 !ğ
roÙ
->d’Œy || 
vfsmÁ
 !ğroÙ->
mÁ
) {

2459 
d’Œy
 * 
·»Á
;

2461 ià(
d’Œy
 =ğ
vfsmÁ
->
mÁ_roÙ
 || 
	`IS_ROOT
(dentry)) {

2463 ià(
vfsmÁ
->
mÁ_·»Á
 == vfsmnt) {

2464 
glob®_roÙ
;

2466 
d’Œy
 = 
vfsmÁ
->
mÁ_mouÁpošt
;

2467 
vfsmÁ
 = vfsmÁ->
mÁ_·»Á
;

2470 
·»Á
 = 
d’Œy
->
d_·»Á
;

2471 
	`´eãtch
(
·»Á
);

2472 
	`¥š_lock
(&
d’Œy
->
d_lock
);

2473 
”rÜ
 = 
	`´•’d_Çme
(
bufãr
, 
buæ’
, &
d’Œy
->
d_Çme
);

2474 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

2475 ià(!
”rÜ
)

2476 
”rÜ
 = 
	`´•’d
(
bufãr
, 
buæ’
, "/", 1);

2477 ià(
”rÜ
)

2480 
¦ash
 = 
Œue
;

2481 
d’Œy
 = 
·»Á
;

2484 ià(!
”rÜ
 && !
¦ash
)

2485 
”rÜ
 = 
	`´•’d
(
bufãr
, 
buæ’
, "/", 1);

2487 
out
:

2488 
	`br_»ad_uÆock
(
vfsmouÁ_lock
);

2489  
”rÜ
;

2491 
glob®_roÙ
:

2496 ià(
	`IS_ROOT
(
d’Œy
) &&

2497 (
d’Œy
->
d_Çme
.
Ën
 !ğ1 || d’Œy->d_Çme.
Çme
[0] != '/')) {

2498 
	`WARN
(1, "Root dentry has weird‚ame <%.*s>\n",

2499 (è
d’Œy
->
d_Çme
.
Ën
, d’Œy->d_Çme.
Çme
);

2501 ià(!
¦ash
)

2502 
”rÜ
 = 
	`´•’d
(
bufãr
, 
buæ’
, "/", 1);

2503 ià(!
”rÜ
)

2504 
”rÜ
 = 
vfsmÁ
->
mÁ_ns
 ? 1 : 2;

2505 
out
;

2506 
	}
}

2524 *
	$__d_·th
(cÚ¡ 
·th
 *path,

2525 cÚ¡ 
·th
 *
roÙ
,

2526 *
buf
, 
buæ’
)

2528 *
»s
 = 
buf
 + 
buæ’
;

2529 
”rÜ
;

2531 
	`´•’d
(&
»s
, &
buæ’
, "\0", 1);

2532 
	`wr™e_£qlock
(&
»Çme_lock
);

2533 
”rÜ
 = 
	`´•’d_·th
(
·th
, 
roÙ
, &
»s
, &
buæ’
);

2534 
	`wr™e_£quÆock
(&
»Çme_lock
);

2536 ià(
”rÜ
 < 0)

2537  
	`ERR_PTR
(
”rÜ
);

2538 ià(
”rÜ
 > 0)

2539  
NULL
;

2540  
»s
;

2541 
	}
}

2543 *
	$d_absŞu‹_·th
(cÚ¡ 
·th
 *path,

2544 *
buf
, 
buæ’
)

2546 
·th
 
roÙ
 = {};

2547 *
»s
 = 
buf
 + 
buæ’
;

2548 
”rÜ
;

2550 
	`´•’d
(&
»s
, &
buæ’
, "\0", 1);

2551 
	`wr™e_£qlock
(&
»Çme_lock
);

2552 
”rÜ
 = 
	`´•’d_·th
(
·th
, &
roÙ
, &
»s
, &
buæ’
);

2553 
	`wr™e_£quÆock
(&
»Çme_lock
);

2555 ià(
”rÜ
 > 1)

2556 
”rÜ
 = -
EINVAL
;

2557 ià(
”rÜ
 < 0)

2558  
	`ERR_PTR
(
”rÜ
);

2559  
»s
;

2560 
	}
}

2565 
	$·th_w™h_d–‘ed
(cÚ¡ 
·th
 *path,

2566 cÚ¡ 
·th
 *
roÙ
,

2567 **
buf
, *
buæ’
)

2569 
	`´•’d
(
buf
, 
buæ’
, "\0", 1);

2570 ià(
	`d_uÆšked
(
·th
->
d’Œy
)) {

2571 
”rÜ
 = 
	`´•’d
(
buf
, 
buæ’
, " (deleted)", 10);

2572 ià(
”rÜ
)

2573  
”rÜ
;

2576  
	`´•’d_·th
(
·th
, 
roÙ
, 
buf
, 
buæ’
);

2577 
	}
}

2579 
	$´•’d_uÄ—chabË
(**
bufãr
, *
buæ’
)

2581  
	`´•’d
(
bufãr
, 
buæ’
, "(unreachable)", 13);

2582 
	}
}

2600 *
	$d_·th
(cÚ¡ 
·th
 *·th, *
buf
, 
buæ’
)

2602 *
»s
 = 
buf
 + 
buæ’
;

2603 
·th
 
roÙ
;

2604 
”rÜ
;

2613 ià(
·th
->
d’Œy
->
d_İ
 &&…©h->d’Œy->d_İ->
d_dÇme
)

2614  
·th
->
d’Œy
->
d_İ
->
	`d_dÇme
Õ©h->d’Œy, 
buf
, 
buæ’
);

2616 
	`g‘_fs_roÙ
(
cu¼’t
->
fs
, &
roÙ
);

2617 
	`wr™e_£qlock
(&
»Çme_lock
);

2618 
”rÜ
 = 
	`·th_w™h_d–‘ed
(
·th
, &
roÙ
, &
»s
, &
buæ’
);

2619 ià(
”rÜ
 < 0)

2620 
»s
 = 
	`ERR_PTR
(
”rÜ
);

2621 
	`wr™e_£quÆock
(&
»Çme_lock
);

2622 
	`·th_put
(&
roÙ
);

2623  
»s
;

2624 
	}
}

2625 
EXPORT_SYMBOL
(
d_·th
);

2636 *
	$d_·th_w™h_uÄ—chabË
(cÚ¡ 
·th
 *·th, *
buf
, 
buæ’
)

2638 *
»s
 = 
buf
 + 
buæ’
;

2639 
·th
 
roÙ
;

2640 
”rÜ
;

2642 ià(
·th
->
d’Œy
->
d_İ
 &&…©h->d’Œy->d_İ->
d_dÇme
)

2643  
·th
->
d’Œy
->
d_İ
->
	`d_dÇme
Õ©h->d’Œy, 
buf
, 
buæ’
);

2645 
	`g‘_fs_roÙ
(
cu¼’t
->
fs
, &
roÙ
);

2646 
	`wr™e_£qlock
(&
»Çme_lock
);

2647 
”rÜ
 = 
	`·th_w™h_d–‘ed
(
·th
, &
roÙ
, &
»s
, &
buæ’
);

2648 ià(
”rÜ
 > 0)

2649 
”rÜ
 = 
	`´•’d_uÄ—chabË
(&
»s
, &
buæ’
);

2650 
	`wr™e_£quÆock
(&
»Çme_lock
);

2651 
	`·th_put
(&
roÙ
);

2652 ià(
”rÜ
)

2653 
»s
 = 
	`ERR_PTR
(
”rÜ
);

2655  
»s
;

2656 
	}
}

2661 *
	$dyÇmic_dÇme
(
d’Œy
 *d’Œy, *
bufãr
, 
buæ’
,

2662 cÚ¡ *
fmt
, ...)

2664 
va_li¡
 
¬gs
;

2665 
‹mp
[64];

2666 
sz
;

2668 
	`va_¡¬t
(
¬gs
, 
fmt
);

2669 
sz
 = 
	`v¢´štf
(
‹mp
, Ñemp), 
fmt
, 
¬gs
) + 1;

2670 
	`va_’d
(
¬gs
);

2672 ià(
sz
 > (
‹mp
è|| sz > 
buæ’
)

2673  
	`ERR_PTR
(-
ENAMETOOLONG
);

2675 
bufãr
 +ğ
buæ’
 - 
sz
;

2676  
	`memıy
(
bufãr
, 
‹mp
, 
sz
);

2677 
	}
}

2682 *
	$__d’Œy_·th
(
d’Œy
 *d’Œy, *
buf
, 
buæ’
)

2684 *
’d
 = 
buf
 + 
buæ’
;

2685 *
»tv®
;

2687 
	`´•’d
(&
’d
, &
buæ’
, "\0", 1);

2688 ià(
buæ’
 < 1)

2689 
ElÚg
;

2691 
»tv®
 = 
’d
-1;

2692 *
»tv®
 = '/';

2694 !
	`IS_ROOT
(
d’Œy
)) {

2695 
d’Œy
 *
·»Á
 = d’Œy->
d_·»Á
;

2696 
”rÜ
;

2698 
	`´eãtch
(
·»Á
);

2699 
	`¥š_lock
(&
d’Œy
->
d_lock
);

2700 
”rÜ
 = 
	`´•’d_Çme
(&
’d
, &
buæ’
, &
d’Œy
->
d_Çme
);

2701 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

2702 ià(
”rÜ
 !ğ0 || 
	`´•’d
(&
’d
, &
buæ’
, "/", 1) != 0)

2703 
ElÚg
;

2705 
»tv®
 = 
’d
;

2706 
d’Œy
 = 
·»Á
;

2708  
»tv®
;

2709 
ElÚg
:

2710  
	`ERR_PTR
(-
ENAMETOOLONG
);

2711 
	}
}

2713 *
	$d’Œy_·th_¿w
(
d’Œy
 *d’Œy, *
buf
, 
buæ’
)

2715 *
»tv®
;

2717 
	`wr™e_£qlock
(&
»Çme_lock
);

2718 
»tv®
 = 
	`__d’Œy_·th
(
d’Œy
, 
buf
, 
buæ’
);

2719 
	`wr™e_£quÆock
(&
»Çme_lock
);

2721  
»tv®
;

2722 
	}
}

2723 
EXPORT_SYMBOL
(
d’Œy_·th_¿w
);

2725 *
	$d’Œy_·th
(
d’Œy
 *d’Œy, *
buf
, 
buæ’
)

2727 *
p
 = 
NULL
;

2728 *
»tv®
;

2730 
	`wr™e_£qlock
(&
»Çme_lock
);

2731 ià(
	`d_uÆšked
(
d’Œy
)) {

2732 
p
 = 
buf
 + 
buæ’
;

2733 ià(
	`´•’d
(&
p
, &
buæ’
, "//deleted", 10) != 0)

2734 
ElÚg
;

2735 
buæ’
++;

2737 
»tv®
 = 
	`__d’Œy_·th
(
d’Œy
, 
buf
, 
buæ’
);

2738 
	`wr™e_£quÆock
(&
»Çme_lock
);

2739 ià(!
	`IS_ERR
(
»tv®
è&& 
p
)

2740 *
p
 = '/';

2741  
»tv®
;

2742 
ElÚg
:

2743  
	`ERR_PTR
(-
ENAMETOOLONG
);

2744 
	}
}

2764 
	$SYSCALL_DEFINE2
(
g‘cwd
, 
__u£r
 *, 
buf
, , 
size
)

2766 
”rÜ
;

2767 
·th
 
pwd
, 
roÙ
;

2768 *
·ge
 = (*è
	`__g‘_ä“_·ge
(
GFP_USER
);

2770 ià(!
·ge
)

2771  -
ENOMEM
;

2773 
	`g‘_fs_roÙ_ªd_pwd
(
cu¼’t
->
fs
, &
roÙ
, &
pwd
);

2775 
”rÜ
 = -
ENOENT
;

2776 
	`wr™e_£qlock
(&
»Çme_lock
);

2777 ià(!
	`d_uÆšked
(
pwd
.
d’Œy
)) {

2778 
Ën
;

2779 *
cwd
 = 
·ge
 + 
PAGE_SIZE
;

2780 
buæ’
 = 
PAGE_SIZE
;

2782 
	`´•’d
(&
cwd
, &
buæ’
, "\0", 1);

2783 
”rÜ
 = 
	`´•’d_·th
(&
pwd
, &
roÙ
, &
cwd
, &
buæ’
);

2784 
	`wr™e_£quÆock
(&
»Çme_lock
);

2786 ià(
”rÜ
 < 0)

2787 
out
;

2790 ià(
”rÜ
 > 0) {

2791 
”rÜ
 = 
	`´•’d_uÄ—chabË
(&
cwd
, &
buæ’
);

2792 ià(
”rÜ
)

2793 
out
;

2796 
”rÜ
 = -
ERANGE
;

2797 
Ën
 = 
PAGE_SIZE
 + 
·ge
 - 
cwd
;

2798 ià(
Ën
 <ğ
size
) {

2799 
”rÜ
 = 
Ën
;

2800 ià(
	`cİy_to_u£r
(
buf
, 
cwd
, 
Ën
))

2801 
”rÜ
 = -
EFAULT
;

2804 
	`wr™e_£quÆock
(&
»Çme_lock
);

2807 
out
:

2808 
	`·th_put
(&
pwd
);

2809 
	`·th_put
(&
roÙ
);

2810 
	`ä“_·ge
((è
·ge
);

2811  
”rÜ
;

2812 
	}
}

2830 
	$is_subdœ
(
d’Œy
 *
Ãw_d’Œy
, d’Œy *
Şd_d’Œy
)

2832 
»suÉ
;

2833 
£q
;

2835 ià(
Ãw_d’Œy
 =ğ
Şd_d’Œy
)

2840 
£q
 = 
	`»ad_£qbegš
(&
»Çme_lock
);

2845 
	`rcu_»ad_lock
();

2846 ià(
	`d_ªû¡Ü
(
Şd_d’Œy
, 
Ãw_d’Œy
))

2847 
»suÉ
 = 1;

2849 
»suÉ
 = 0;

2850 
	`rcu_»ad_uÆock
();

2851 } 
	`»ad_£q»Œy
(&
»Çme_lock
, 
£q
));

2853  
»suÉ
;

2854 
	}
}

2856 
	$·th_is_und”
(
·th
 *
·th1
, ·th *
·th2
)

2858 
vfsmouÁ
 *
mÁ
 = 
·th1
->mnt;

2859 
d’Œy
 *d’Œy = 
·th1
->dentry;

2860 
»s
;

2862 
	`br_»ad_lock
(
vfsmouÁ_lock
);

2863 ià(
mÁ
 !ğ
·th2
->mnt) {

2865 ià(
mÁ
->
mÁ_·»Á
 == mnt) {

2866 
	`br_»ad_uÆock
(
vfsmouÁ_lock
);

2869 ià(
mÁ
->
mÁ_·»Á
 =ğ
·th2
->mnt)

2871 
mÁ
 = mÁ->
mÁ_·»Á
;

2873 
d’Œy
 = 
mÁ
->
mÁ_mouÁpošt
;

2875 
»s
 = 
	`is_subdœ
(
d’Œy
, 
·th2
->dentry);

2876 
	`br_»ad_uÆock
(
vfsmouÁ_lock
);

2877  
»s
;

2878 
	}
}

2879 
EXPORT_SYMBOL
(
·th_is_und”
);

2881 
	$d_g’ocide
(
d’Œy
 *
roÙ
)

2883 
d’Œy
 *
this_·»Á
;

2884 
li¡_h—d
 *
Ãxt
;

2885 
£q
;

2886 
locked
 = 0;

2888 
£q
 = 
	`»ad_£qbegš
(&
»Çme_lock
);

2889 
agaš
:

2890 
this_·»Á
 = 
roÙ
;

2891 
	`¥š_lock
(&
this_·»Á
->
d_lock
);

2892 
»³©
:

2893 
Ãxt
 = 
this_·»Á
->
d_subdœs
.next;

2894 
»sume
:

2895 
Ãxt
 !ğ&
this_·»Á
->
d_subdœs
) {

2896 
li¡_h—d
 *
tmp
 = 
Ãxt
;

2897 
d’Œy
 *d’Œy = 
	`li¡_’Œy
(
tmp
, d’Œy, 
d_u
.
d_chd
);

2898 
Ãxt
 = 
tmp
->next;

2900 
	`¥š_lock_Ã¡ed
(&
d’Œy
->
d_lock
, 
DENTRY_D_LOCK_NESTED
);

2901 ià(
	`d_unhashed
(
d’Œy
è|| !d’Œy->
d_šode
) {

2902 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

2905 ià(!
	`li¡_em±y
(&
d’Œy
->
d_subdœs
)) {

2906 
	`¥š_uÆock
(&
this_·»Á
->
d_lock
);

2907 
	`¥š_»Ëa£
(&
d’Œy
->
d_lock
.
d•_m­
, 1, 
_RET_IP_
);

2908 
this_·»Á
 = 
d’Œy
;

2909 
	`¥š_acquœe
(&
this_·»Á
->
d_lock
.
d•_m­
, 0, 1, 
_RET_IP_
);

2910 
»³©
;

2912 ià(!(
d’Œy
->
d_æags
 & 
DCACHE_GENOCIDE
)) {

2913 
d’Œy
->
d_æags
 |ğ
DCACHE_GENOCIDE
;

2914 
d’Œy
->
d_couÁ
--;

2916 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

2918 ià(
this_·»Á
 !ğ
roÙ
) {

2919 
d’Œy
 *
chd
 = 
this_·»Á
;

2920 ià(!(
this_·»Á
->
d_æags
 & 
DCACHE_GENOCIDE
)) {

2921 
this_·»Á
->
d_æags
 |ğ
DCACHE_GENOCIDE
;

2922 
this_·»Á
->
d_couÁ
--;

2924 
this_·»Á
 = 
	`Œy_to_asûnd
Ñhis_·»Á, 
locked
, 
£q
);

2925 ià(!
this_·»Á
)

2926 
»Çme_»Œy
;

2927 
Ãxt
 = 
chd
->
d_u
.
d_chd
.next;

2928 
»sume
;

2930 
	`¥š_uÆock
(&
this_·»Á
->
d_lock
);

2931 ià(!
locked
 && 
	`»ad_£q»Œy
(&
»Çme_lock
, 
£q
))

2932 
»Çme_»Œy
;

2933 ià(
locked
)

2934 
	`wr™e_£quÆock
(&
»Çme_lock
);

2937 
»Çme_»Œy
:

2938 
locked
 = 1;

2939 
	`wr™e_£qlock
(&
»Çme_lock
);

2940 
agaš
;

2941 
	}
}

2957 
šo_t
 
	$fšd_šode_numb”
(
d’Œy
 *
dœ
, 
q¡r
 *
Çme
)

2959 
d’Œy
 * dentry;

2960 
šo_t
 
šo
 = 0;

2962 
d’Œy
 = 
	`d_hash_ªd_lookup
(
dœ
, 
Çme
);

2963 ià(
d’Œy
) {

2964 ià(
d’Œy
->
d_šode
)

2965 
šo
 = 
d’Œy
->
d_šode
->
i_šo
;

2966 
	`dput
(
d’Œy
);

2968  
šo
;

2969 
	}
}

2970 
EXPORT_SYMBOL
(
fšd_šode_numb”
);

2972 
__š™d©a
 
	gdhash_’Œ›s
;

2973 
__š™
 
	$£t_dhash_’Œ›s
(*
¡r
)

2975 ià(!
¡r
)

2977 
dhash_’Œ›s
 = 
	`sim¶e_¡¹oul
(
¡r
, &str, 0);

2979 
	}
}

2980 
__£tup
("dhash_’Œ›s=", 
£t_dhash_’Œ›s
);

2982 
__š™
 
	$dÿche_š™_—¾y
()

2984 
loİ
;

2989 ià(
hashdi¡
)

2992 
d’Œy_hashbË
 =

2993 
	`®loc_Ïrge_sy¡em_hash
("Dentry cache",

2994 (
hli¡_bl_h—d
),

2995 
dhash_’Œ›s
,

2997 
HASH_EARLY
,

2998 &
d_hash_shiá
,

2999 &
d_hash_mask
,

3002 
loİ
 = 0;†oİ < (1 << 
d_hash_shiá
);†oop++)

3003 
	`INIT_HLIST_BL_HEAD
(
d’Œy_hashbË
 + 
loİ
);

3004 
	}
}

3006 
__š™
 
	$dÿche_š™
()

3008 
loİ
;

3015 
d’Œy_ÿche
 = 
	`KMEM_CACHE
(
d’Œy
,

3016 
SLAB_RECLAIM_ACCOUNT
|
SLAB_PANIC
|
SLAB_MEM_SPREAD
);

3019 ià(!
hashdi¡
)

3022 
d’Œy_hashbË
 =

3023 
	`®loc_Ïrge_sy¡em_hash
("Dentry cache",

3024 (
hli¡_bl_h—d
),

3025 
dhash_’Œ›s
,

3028 &
d_hash_shiá
,

3029 &
d_hash_mask
,

3032 
loİ
 = 0;†oİ < (1 << 
d_hash_shiá
);†oop++)

3033 
	`INIT_HLIST_BL_HEAD
(
d’Œy_hashbË
 + 
loİ
);

3034 
	}
}

3037 
kmem_ÿche
 *
Çmes_ÿch•
 
	g__»ad_mo¡ly
;

3038 
EXPORT_SYMBOL
(
Çmes_ÿch•
);

3040 
EXPORT_SYMBOL
(
d_g’ocide
);

3042 
__š™
 
	$vfs_ÿches_š™_—¾y
()

3044 
	`dÿche_š™_—¾y
();

3045 
	`šode_š™_—¾y
();

3046 
	}
}

3048 
__š™
 
	$vfs_ÿches_š™
(
mem·ges
)

3050 
»£rve
;

3055 
»£rve
 = 
	`mš
((
mem·ges
 - 
	`Ä_ä“_·ges
()) * 3/2, mempages - 1);

3056 
mem·ges
 -ğ
»£rve
;

3058 
Çmes_ÿch•
 = 
	`kmem_ÿche_ü—‹
("Çmes_ÿche", 
PATH_MAX
, 0,

3059 
SLAB_HWCACHE_ALIGN
|
SLAB_PANIC
, 
NULL
);

3061 
	`dÿche_š™
();

3062 
	`šode_š™
();

3063 
	`fes_š™
(
mem·ges
);

3064 
	`mÁ_š™
();

3065 
	`bdev_ÿche_š™
();

3066 
	`chrdev_š™
();

3067 
	}
}

	@dcookies.c

15 
	~<lšux/sysÿÎs.h
>

16 
	~<lšux/moduË.h
>

17 
	~<lšux/¦ab.h
>

18 
	~<lšux/li¡.h
>

19 
	~<lšux/mouÁ.h
>

20 
	~<lšux/ÿ·b™y.h
>

21 
	~<lšux/dÿche.h
>

22 
	~<lšux/mm.h
>

23 
	~<lšux/”r.h
>

24 
	~<lšux/”ºo.h
>

25 
	~<lšux/dcook›s.h
>

26 
	~<lšux/mu‹x.h
>

27 
	~<lšux/·th.h
>

28 
	~<asm/uacûss.h
>

34 
	sdcook›_¡ruù
 {

35 
·th
 
	m·th
;

36 
li¡_h—d
 
	mhash_li¡
;

39 
LIST_HEAD
(
dcook›_u£rs
);

40 
DEFINE_MUTEX
(
dcook›_mu‹x
);

41 
kmem_ÿche
 *
dcook›_ÿche
 
	g__»ad_mo¡ly
;

42 
li¡_h—d
 *
dcook›_hashbË
 
	g__»ad_mo¡ly
;

43 
size_t
 
hash_size
 
	g__»ad_mo¡ly
;

45 
šlše
 
	$is_live
()

47  !(
	`li¡_em±y
(&
dcook›_u£rs
));

48 
	}
}

52 
šlše
 
	$dcook›_v®ue
(
dcook›_¡ruù
 * 
dcs
)

54  ()
dcs
->
·th
.
d’Œy
;

55 
	}
}

58 
size_t
 
	$dcook›_hash
(
dcook›
)

60  (
dcook›
 >> 
L1_CACHE_SHIFT
è& (
hash_size
 - 1);

61 
	}
}

64 
dcook›_¡ruù
 * 
	$fšd_dcook›
(
dcook›
)

66 
dcook›_¡ruù
 *
found
 = 
NULL
;

67 
dcook›_¡ruù
 * 
dcs
;

68 
li¡_h—d
 * 
pos
;

69 
li¡_h—d
 * 
li¡
;

71 
li¡
 = 
dcook›_hashbË
 + 
	`dcook›_hash
(
dcook›
);

73 
	`li¡_fÜ_—ch
(
pos
, 
li¡
) {

74 
dcs
 = 
	`li¡_’Œy
(
pos
, 
dcook›_¡ruù
, 
hash_li¡
);

75 ià(
	`dcook›_v®ue
(
dcs
è=ğ
dcook›
) {

76 
found
 = 
dcs
;

81  
found
;

82 
	}
}

85 
	$hash_dcook›
(
dcook›_¡ruù
 * 
dcs
)

87 
li¡_h—d
 * 
li¡
 = 
dcook›_hashbË
 + 
	`dcook›_hash
(
	`dcook›_v®ue
(
dcs
));

88 
	`li¡_add
(&
dcs
->
hash_li¡
, 
li¡
);

89 
	}
}

92 
dcook›_¡ruù
 *
	$®loc_dcook›
(
·th
 *path)

94 
dcook›_¡ruù
 *
dcs
 = 
	`kmem_ÿche_®loc
(
dcook›_ÿche
,

95 
GFP_KERNEL
);

96 
d’Œy
 *
d
;

97 ià(!
dcs
)

98  
NULL
;

100 
d
 = 
·th
->
d’Œy
;

101 
	`¥š_lock
(&
d
->
d_lock
);

102 
d
->
d_æags
 |ğ
DCACHE_COOKIE
;

103 
	`¥š_uÆock
(&
d
->
d_lock
);

105 
dcs
->
·th
 = *path;

106 
	`·th_g‘
(
·th
);

107 
	`hash_dcook›
(
dcs
);

108  
dcs
;

109 
	}
}

115 
	$g‘_dcook›
(
·th
 *·th, *
cook›
)

117 
”r
 = 0;

118 
dcook›_¡ruù
 * 
dcs
;

120 
	`mu‹x_lock
(&
dcook›_mu‹x
);

122 ià(!
	`is_live
()) {

123 
”r
 = -
EINVAL
;

124 
out
;

127 ià(
·th
->
d’Œy
->
d_æags
 & 
DCACHE_COOKIE
) {

128 
dcs
 = 
	`fšd_dcook›
(()
·th
->
d’Œy
);

130 
dcs
 = 
	`®loc_dcook›
(
·th
);

131 ià(!
dcs
) {

132 
”r
 = -
ENOMEM
;

133 
out
;

137 *
cook›
 = 
	`dcook›_v®ue
(
dcs
);

139 
out
:

140 
	`mu‹x_uÆock
(&
dcook›_mu‹x
);

141  
”r
;

142 
	}
}

148 
	$SYSCALL_DEFINE
(
lookup_dcook›
)(
u64
 
cook›64
, 
__u£r
 * 
buf
, 
size_t
 
Ën
)

150 
cook›
 = ()
cook›64
;

151 
”r
 = -
EINVAL
;

152 * 
kbuf
;

153 * 
·th
;

154 
size_t
 
·thËn
;

155 
dcook›_¡ruù
 * 
dcs
;

160 ià(!
	`ÿ·bË
(
CAP_SYS_ADMIN
))

161  -
EPERM
;

163 
	`mu‹x_lock
(&
dcook›_mu‹x
);

165 ià(!
	`is_live
()) {

166 
”r
 = -
EINVAL
;

167 
out
;

170 ià(!(
dcs
 = 
	`fšd_dcook›
(
cook›
)))

171 
out
;

173 
”r
 = -
ENOMEM
;

174 
kbuf
 = 
	`km®loc
(
PAGE_SIZE
, 
GFP_KERNEL
);

175 ià(!
kbuf
)

176 
out
;

179 
·th
 = 
	`d_·th
(&
dcs
->·th, 
kbuf
, 
PAGE_SIZE
);

181 
	`mu‹x_uÆock
(&
dcook›_mu‹x
);

183 ià(
	`IS_ERR
(
·th
)) {

184 
”r
 = 
	`PTR_ERR
(
·th
);

185 
out_ä“
;

188 
”r
 = -
ERANGE
;

190 
·thËn
 = 
kbuf
 + 
PAGE_SIZE
 - 
·th
;

191 ià(
·thËn
 <ğ
Ën
) {

192 
”r
 = 
·thËn
;

193 ià(
	`cİy_to_u£r
(
buf
, 
·th
, 
·thËn
))

194 
”r
 = -
EFAULT
;

197 
out_ä“
:

198 
	`kä“
(
kbuf
);

199  
”r
;

200 
out
:

201 
	`mu‹x_uÆock
(&
dcook›_mu‹x
);

202  
”r
;

203 
	}
}

204 #ifdeà
CONFIG_HAVE_SYSCALL_WRAPPERS


205 
asmlškage
 
	$SyS_lookup_dcook›
(
u64
 
cook›64
, 
buf
, 
Ën
)

207  
	`SYSC_lookup_dcook›
(
cook›64
, (
__u£r
 *è
buf
, (
size_t
è
Ën
);

208 
	}
}

209 
SYSCALL_ALIAS
(
sys_lookup_dcook›
, 
SyS_lookup_dcook›
);

212 
	$dcook›_š™
()

214 
li¡_h—d
 * 
d
;

215 
i
, 
hash_b™s
;

216 
”r
 = -
ENOMEM
;

218 
dcook›_ÿche
 = 
	`kmem_ÿche_ü—‹
("dcookie_cache",

219 (
dcook›_¡ruù
),

220 0, 0, 
NULL
);

222 ià(!
dcook›_ÿche
)

223 
out
;

225 
dcook›_hashbË
 = 
	`km®loc
(
PAGE_SIZE
, 
GFP_KERNEL
);

226 ià(!
dcook›_hashbË
)

227 
out_kmem
;

229 
”r
 = 0;

236 
hash_size
 = 
PAGE_SIZE
 / (
li¡_h—d
);

237 
hash_b™s
 = 0;

239 
hash_b™s
++;

240 } (
hash_size
 >> 
hash_b™s
) != 0);

241 
hash_b™s
--;

247 
hash_size
 = 1UL << 
hash_b™s
;

250 
d
 = 
dcook›_hashbË
;

251 
i
 = 
hash_size
;

253 
	`INIT_LIST_HEAD
(
d
);

254 
d
++;

255 
i
--;

256 } 
i
);

258 
out
:

259  
”r
;

260 
out_kmem
:

261 
	`kmem_ÿche_de¡roy
(
dcook›_ÿche
);

262 
out
;

263 
	}
}

266 
	$ä“_dcook›
(
dcook›_¡ruù
 * 
dcs
)

268 
d’Œy
 *
d
 = 
dcs
->
·th
.dentry;

270 
	`¥š_lock
(&
d
->
d_lock
);

271 
d
->
d_æags
 &ğ~
DCACHE_COOKIE
;

272 
	`¥š_uÆock
(&
d
->
d_lock
);

274 
	`·th_put
(&
dcs
->
·th
);

275 
	`kmem_ÿche_ä“
(
dcook›_ÿche
, 
dcs
);

276 
	}
}

279 
	$dcook›_ex™
()

281 
li¡_h—d
 * 
li¡
;

282 
li¡_h—d
 * 
pos
;

283 
li¡_h—d
 * 
pos2
;

284 
dcook›_¡ruù
 * 
dcs
;

285 
size_t
 
i
;

287 
i
 = 0; i < 
hash_size
; ++i) {

288 
li¡
 = 
dcook›_hashbË
 + 
i
;

289 
	`li¡_fÜ_—ch_§ã
(
pos
, 
pos2
, 
li¡
) {

290 
dcs
 = 
	`li¡_’Œy
(
pos
, 
dcook›_¡ruù
, 
hash_li¡
);

291 
	`li¡_d–
(&
dcs
->
hash_li¡
);

292 
	`ä“_dcook›
(
dcs
);

296 
	`kä“
(
dcook›_hashbË
);

297 
	`kmem_ÿche_de¡roy
(
dcook›_ÿche
);

298 
	}
}

301 
	sdcook›_u£r
 {

302 
li¡_h—d
 
	mÃxt
;

305 
dcook›_u£r
 * 
	$dcook›_»gi¡”
()

307 
dcook›_u£r
 * 
u£r
;

309 
	`mu‹x_lock
(&
dcook›_mu‹x
);

311 
u£r
 = 
	`km®loc
((
dcook›_u£r
), 
GFP_KERNEL
);

312 ià(!
u£r
)

313 
out
;

315 ià(!
	`is_live
(è&& 
	`dcook›_š™
())

316 
out_ä“
;

318 
	`li¡_add
(&
u£r
->
Ãxt
, &
dcook›_u£rs
);

320 
out
:

321 
	`mu‹x_uÆock
(&
dcook›_mu‹x
);

322  
u£r
;

323 
out_ä“
:

324 
	`kä“
(
u£r
);

325 
u£r
 = 
NULL
;

326 
out
;

327 
	}
}

330 
	$dcook›_uÄegi¡”
(
dcook›_u£r
 * 
u£r
)

332 
	`mu‹x_lock
(&
dcook›_mu‹x
);

334 
	`li¡_d–
(&
u£r
->
Ãxt
);

335 
	`kä“
(
u£r
);

337 ià(!
	`is_live
())

338 
	`dcook›_ex™
();

340 
	`mu‹x_uÆock
(&
dcook›_mu‹x
);

341 
	}
}

343 
EXPORT_SYMBOL_GPL
(
dcook›_»gi¡”
);

344 
EXPORT_SYMBOL_GPL
(
dcook›_uÄegi¡”
);

345 
EXPORT_SYMBOL_GPL
(
g‘_dcook›
);

	@direct-io.c

22 
	~<lšux/k”Ãl.h
>

23 
	~<lšux/moduË.h
>

24 
	~<lšux/ty³s.h
>

25 
	~<lšux/fs.h
>

26 
	~<lšux/mm.h
>

27 
	~<lšux/¦ab.h
>

28 
	~<lšux/highmem.h
>

29 
	~<lšux/·gem­.h
>

30 
	~<lšux/sk_io_accouÁšg_İs.h
>

31 
	~<lšux/bio.h
>

32 
	~<lšux/wa™.h
>

33 
	~<lšux/”r.h
>

34 
	~<lšux/blkdev.h
>

35 
	~<lšux/bufãr_h—d.h
>

36 
	~<lšux/rw£m.h
>

37 
	~<lšux/uio.h
>

38 
	~<lšux/©omic.h
>

44 
	#DIO_PAGES
 64

	)

60 
	sdio_subm™
 {

61 
bio
 *
	mbio
;

62 
	mblkb™s
;

63 
	mblkçùÜ
;

68 
	m¡¬t_z”o_dÚe
;

71 
	m·ges_š_io
;

72 
size_t
 
	msize
;

73 
£ùÜ_t
 
	mblock_š_fe
;

75 
	mblocks_avaabË
;

76 
	m»­_couÁ”
;

77 
£ùÜ_t
 
	mfš®_block_š_»que¡
;

78 
	mfœ¡_block_š_·ge
;

79 
	mbound¬y
;

80 
g‘_block_t
 *
	mg‘_block
;

81 
dio_subm™_t
 *
	msubm™_io
;

83 
loff_t
 
	mlogiÿl_off£t_š_bio
;

84 
£ùÜ_t
 
	mfš®_block_š_bio
;

85 
£ùÜ_t
 
	mÃxt_block_fÜ_io
;

93 
·ge
 *
	mcur_·ge
;

94 
	mcur_·ge_off£t
;

95 
	mcur_·ge_Ën
;

96 
£ùÜ_t
 
	mcur_·ge_block
;

97 
loff_t
 
	mcur_·ge_fs_off£t
;

102 
	mcu¼_·ge
;

103 
	mtÙ®_·ges
;

104 
	mcu¼_u£r_add»ss
;

110 
	mh—d
;

111 
	m
;

115 
	sdio
 {

116 
	mæags
;

117 
	mrw
;

118 
šode
 *
	mšode
;

119 
loff_t
 
	mi_size
;

120 
dio_iodÚe_t
 *
	m’d_io
;

122 *
	m´iv©e
;

125 
¥šlock_t
 
	mbio_lock
;

126 
	m·ge_”rÜs
;

127 
	mis_async
;

128 
	mio_”rÜ
;

129 
	m»fcouÁ
;

130 
bio
 *
	mbio_li¡
;

131 
sk_¡ruù
 *
	mwa™”
;

134 
kiocb
 *
	miocb
;

135 
ssize_t
 
	m»suÉ
;

142 
·ge
 *
	m·ges
[
DIO_PAGES
];

143 } 
	g____ÿch–še_®igÃd_š_smp
;

145 
kmem_ÿche
 *
dio_ÿche
 
	g__»ad_mo¡ly
;

147 
	$__šode_dio_wa™
(
šode
 *inode)

149 
wa™_queue_h—d_t
 *
wq
 = 
	`b™_wa™queue
(&
šode
->
i_¡©e
, 
__I_DIO_WAKEUP
);

150 
	`DEFINE_WAIT_BIT
(
q
, &
šode
->
i_¡©e
, 
__I_DIO_WAKEUP
);

153 
	`´•¬e_to_wa™
(
wq
, &
q
.
wa™
, 
TASK_UNINTERRUPTIBLE
);

154 ià(
	`©omic_»ad
(&
šode
->
i_dio_couÁ
))

155 
	`scheduË
();

156 } 
	`©omic_»ad
(&
šode
->
i_dio_couÁ
));

157 
	`fšish_wa™
(
wq
, &
q
.
wa™
);

158 
	}
}

170 
	$šode_dio_wa™
(
šode
 *inode)

172 ià(
	`©omic_»ad
(&
šode
->
i_dio_couÁ
))

173 
	`__šode_dio_wa™
(
šode
);

174 
	}
}

175 
EXPORT_SYMBOL_GPL
(
šode_dio_wa™
);

184 
	$šode_dio_dÚe
(
šode
 *inode)

186 ià(
	`©omic_dec_ªd_‹¡
(&
šode
->
i_dio_couÁ
))

187 
	`wake_up_b™
(&
šode
->
i_¡©e
, 
__I_DIO_WAKEUP
);

188 
	}
}

189 
EXPORT_SYMBOL_GPL
(
šode_dio_dÚe
);

194 
šlše
 
	$dio_·ges_´e£Á
(
dio_subm™
 *
sdio
)

196  
sdio
->

 - sdio->
h—d
;

197 
	}
}

202 
šlše
 
	$dio_»fl_·ges
(
dio
 *dio, 
dio_subm™
 *
sdio
)

204 
»t
;

205 
Ä_·ges
;

207 
Ä_·ges
 = 
	`mš
(
sdio
->
tÙ®_·ges
 - sdio->
cu¼_·ge
, 
DIO_PAGES
);

208 
»t
 = 
	`g‘_u£r_·ges_ç¡
(

209 
sdio
->
cu¼_u£r_add»ss
,

210 
Ä_·ges
,

211 
dio
->
rw
 =ğ
READ
,

212 &
dio
->
·ges
[0]);

214 ià(
»t
 < 0 && 
sdio
->
blocks_avaabË
 && (
dio
->
rw
 & 
WRITE
)) {

215 
·ge
 *·gğ
	`ZERO_PAGE
(0);

221 ià(
dio
->
·ge_”rÜs
 == 0)

222 
dio
->
·ge_”rÜs
 = 
»t
;

223 
	`·ge_ÿche_g‘
(
·ge
);

224 
dio
->
·ges
[0] = 
·ge
;

225 
sdio
->
h—d
 = 0;

226 
sdio
->

 = 1;

227 
»t
 = 0;

228 
out
;

231 ià(
»t
 >= 0) {

232 
sdio
->
cu¼_u£r_add»ss
 +ğ
»t
 * 
PAGE_SIZE
;

233 
sdio
->
cu¼_·ge
 +ğ
»t
;

234 
sdio
->
h—d
 = 0;

235 
sdio
->

 = 
»t
;

236 
»t
 = 0;

238 
out
:

239  
»t
;

240 
	}
}

248 
šlše
 
·ge
 *
	$dio_g‘_·ge
(
dio
 *dio,

249 
dio_subm™
 *
sdio
)

251 ià(
	`dio_·ges_´e£Á
(
sdio
) == 0) {

252 
»t
;

254 
»t
 = 
	`dio_»fl_·ges
(
dio
, 
sdio
);

255 ià(
»t
)

256  
	`ERR_PTR
(
»t
);

257 
	`BUG_ON
(
	`dio_·ges_´e£Á
(
sdio
) == 0);

259  
dio
->
·ges
[
sdio
->
h—d
++];

260 
	}
}

275 
ssize_t
 
	$dio_com¶‘e
(
dio
 *dio, 
loff_t
 
off£t
, 
ssize_t
 
»t
, 
boŞ
 
is_async
)

277 
ssize_t
 
Œªsã¼ed
 = 0;

285 ià(
»t
 =ğ-
EIOCBQUEUED
)

286 
»t
 = 0;

288 ià(
dio
->
»suÉ
) {

289 
Œªsã¼ed
 = 
dio
->
»suÉ
;

292 ià((
dio
->
rw
 =ğ
READ
è&& ((
off£t
 + 
Œªsã¼ed
è> dio->
i_size
))

293 
Œªsã¼ed
 = 
dio
->
i_size
 - 
off£t
;

296 ià(
»t
 == 0)

297 
»t
 = 
dio
->
·ge_”rÜs
;

298 ià(
»t
 == 0)

299 
»t
 = 
dio
->
io_”rÜ
;

300 ià(
»t
 == 0)

301 
»t
 = 
Œªsã¼ed
;

303 ià(
dio
->
’d_io
 && dio->
»suÉ
) {

304 
dio
->
	`’d_io
(dio->
iocb
, 
off£t
, 
Œªsã¼ed
,

305 
dio
->
´iv©e
, 
»t
, 
is_async
);

307 ià(
is_async
)

308 
	`aio_com¶‘e
(
dio
->
iocb
, 
»t
, 0);

309 
	`šode_dio_dÚe
(
dio
->
šode
);

312  
»t
;

313 
	}
}

315 
dio_bio_com¶‘e
(
dio
 *dio, 
bio
 *bio);

319 
	$dio_bio_’d_aio
(
bio
 *bio, 
”rÜ
)

321 
dio
 *diØğ
bio
->
bi_´iv©e
;

322 
»maššg
;

323 
æags
;

326 
	`dio_bio_com¶‘e
(
dio
, 
bio
);

328 
	`¥š_lock_œq§ve
(&
dio
->
bio_lock
, 
æags
);

329 
»maššg
 = --
dio
->
»fcouÁ
;

330 ià(
»maššg
 =ğ1 && 
dio
->
wa™”
)

331 
	`wake_up_´oûss
(
dio
->
wa™”
);

332 
	`¥š_uÆock_œq»¡Üe
(&
dio
->
bio_lock
, 
æags
);

334 ià(
»maššg
 == 0) {

335 
	`dio_com¶‘e
(
dio
, dio->
iocb
->
ki_pos
, 0, 
Œue
);

336 
	`kmem_ÿche_ä“
(
dio_ÿche
, 
dio
);

338 
	}
}

347 
	$dio_bio_’d_io
(
bio
 *bio, 
”rÜ
)

349 
dio
 *diØğ
bio
->
bi_´iv©e
;

350 
æags
;

352 
	`¥š_lock_œq§ve
(&
dio
->
bio_lock
, 
æags
);

353 
bio
->
bi_´iv©e
 = 
dio
->
bio_li¡
;

354 
dio
->
bio_li¡
 = 
bio
;

355 ià(--
dio
->
»fcouÁ
 =ğ1 && dio->
wa™”
)

356 
	`wake_up_´oûss
(
dio
->
wa™”
);

357 
	`¥š_uÆock_œq»¡Üe
(&
dio
->
bio_lock
, 
æags
);

358 
	}
}

369 
	$dio_’d_io
(
bio
 *bio, 
”rÜ
)

371 
dio
 *diØğ
bio
->
bi_´iv©e
;

373 ià(
dio
->
is_async
)

374 
	`dio_bio_’d_aio
(
bio
, 
”rÜ
);

376 
	`dio_bio_’d_io
(
bio
, 
”rÜ
);

377 
	}
}

378 
EXPORT_SYMBOL_GPL
(
dio_’d_io
);

380 
šlše
 

381 
	$dio_bio_®loc
(
dio
 *dio, 
dio_subm™
 *
sdio
,

382 
block_deviû
 *
bdev
,

383 
£ùÜ_t
 
fœ¡_£ùÜ
, 
Ä_vecs
)

385 
bio
 *bio;

391 
bio
 = 
	`bio_®loc
(
GFP_KERNEL
, 
Ä_vecs
);

393 
bio
->
bi_bdev
 = 
bdev
;

394 
bio
->
bi_£ùÜ
 = 
fœ¡_£ùÜ
;

395 ià(
dio
->
is_async
)

396 
bio
->
bi_’d_io
 = 
dio_bio_’d_aio
;

398 
bio
->
bi_’d_io
 = 
dio_bio_’d_io
;

400 
sdio
->
bio
 = bio;

401 
sdio
->
logiÿl_off£t_š_bio
 = sdio->
cur_·ge_fs_off£t
;

402 
	}
}

411 
šlše
 
	$dio_bio_subm™
(
dio
 *dio, 
dio_subm™
 *
sdio
)

413 
bio
 *biØğ
sdio
->bio;

414 
æags
;

416 
bio
->
bi_´iv©e
 = 
dio
;

418 
	`¥š_lock_œq§ve
(&
dio
->
bio_lock
, 
æags
);

419 
dio
->
»fcouÁ
++;

420 
	`¥š_uÆock_œq»¡Üe
(&
dio
->
bio_lock
, 
æags
);

422 ià(
dio
->
is_async
 && dio->
rw
 =ğ
READ
)

423 
	`bio_£t_·ges_dœty
(
bio
);

425 ià(
sdio
->
subm™_io
)

426 
sdio
->
	`subm™_io
(
dio
->
rw
, 
bio
, dio->
šode
,

427 
sdio
->
logiÿl_off£t_š_bio
);

429 
	`subm™_bio
(
dio
->
rw
, 
bio
);

431 
sdio
->
bio
 = 
NULL
;

432 
sdio
->
bound¬y
 = 0;

433 
sdio
->
logiÿl_off£t_š_bio
 = 0;

434 
	}
}

439 
šlše
 
	$dio_ş—nup
(
dio
 *dio, 
dio_subm™
 *
sdio
)

441 
	`dio_·ges_´e£Á
(
sdio
))

442 
	`·ge_ÿche_»Ëa£
(
	`dio_g‘_·ge
(
dio
, 
sdio
));

443 
	}
}

451 
bio
 *
	$dio_awa™_Úe
(
dio
 *dio)

453 
æags
;

454 
bio
 *biØğ
NULL
;

456 
	`¥š_lock_œq§ve
(&
dio
->
bio_lock
, 
æags
);

464 
dio
->
»fcouÁ
 > 1 && dio->
bio_li¡
 =ğ
NULL
) {

465 
	`__£t_cu¼’t_¡©e
(
TASK_UNINTERRUPTIBLE
);

466 
dio
->
wa™”
 = 
cu¼’t
;

467 
	`¥š_uÆock_œq»¡Üe
(&
dio
->
bio_lock
, 
æags
);

468 
	`io_scheduË
();

470 
	`¥š_lock_œq§ve
(&
dio
->
bio_lock
, 
æags
);

471 
dio
->
wa™”
 = 
NULL
;

473 ià(
dio
->
bio_li¡
) {

474 
bio
 = 
dio
->
bio_li¡
;

475 
dio
->
bio_li¡
 = 
bio
->
bi_´iv©e
;

477 
	`¥š_uÆock_œq»¡Üe
(&
dio
->
bio_lock
, 
æags
);

478  
bio
;

479 
	}
}

484 
	$dio_bio_com¶‘e
(
dio
 *dio, 
bio
 *bio)

486 cÚ¡ 
u±od©e
 = 
	`‹¡_b™
(
BIO_UPTODATE
, &
bio
->
bi_æags
);

487 
bio_vec
 *
bvec
 = 
bio
->
bi_io_vec
;

488 
·ge_no
;

490 ià(!
u±od©e
)

491 
dio
->
io_”rÜ
 = -
EIO
;

493 ià(
dio
->
is_async
 && dio->
rw
 =ğ
READ
) {

494 
	`bio_check_·ges_dœty
(
bio
);

496 
·ge_no
 = 0;…age_nØ< 
bio
->
bi_vút
;…age_no++) {

497 
·ge
 *·gğ
bvec
[
·ge_no
].
bv_·ge
;

499 ià(
dio
->
rw
 =ğ
READ
 && !
	`PageCompound
(
·ge
))

500 
	`£t_·ge_dœty_lock
(
·ge
);

501 
	`·ge_ÿche_»Ëa£
(
·ge
);

503 
	`bio_put
(
bio
);

505  
u±od©e
 ? 0 : -
EIO
;

506 
	}
}

515 
	$dio_awa™_com¶‘iÚ
(
dio
 *dio)

517 
bio
 *bio;

519 
bio
 = 
	`dio_awa™_Úe
(
dio
);

520 ià(
bio
)

521 
	`dio_bio_com¶‘e
(
dio
, 
bio
);

522 } 
bio
);

523 
	}
}

532 
šlše
 
	$dio_bio_»­
(
dio
 *dio, 
dio_subm™
 *
sdio
)

534 
»t
 = 0;

536 ià(
sdio
->
»­_couÁ”
++ >= 64) {

537 
dio
->
bio_li¡
) {

538 
æags
;

539 
bio
 *bio;

540 
»t2
;

542 
	`¥š_lock_œq§ve
(&
dio
->
bio_lock
, 
æags
);

543 
bio
 = 
dio
->
bio_li¡
;

544 
dio
->
bio_li¡
 = 
bio
->
bi_´iv©e
;

545 
	`¥š_uÆock_œq»¡Üe
(&
dio
->
bio_lock
, 
æags
);

546 
»t2
 = 
	`dio_bio_com¶‘e
(
dio
, 
bio
);

547 ià(
»t
 == 0)

548 
»t
 = 
»t2
;

550 
sdio
->
»­_couÁ”
 = 0;

552  
»t
;

553 
	}
}

578 
	$g‘_mÜe_blocks
(
dio
 *dio, 
dio_subm™
 *
sdio
,

579 
bufãr_h—d
 *
m­_bh
)

581 
»t
;

582 
£ùÜ_t
 
fs_¡¬tblk
;

583 
fs_couÁ
;

584 
dio_couÁ
;

585 
blkmask
;

586 
ü—‹
;

592 
»t
 = 
dio
->
·ge_”rÜs
;

593 ià(
»t
 == 0) {

594 
	`BUG_ON
(
sdio
->
block_š_fe
 >ğsdio->
fš®_block_š_»que¡
);

595 
fs_¡¬tblk
 = 
sdio
->
block_š_fe
 >> sdio->
blkçùÜ
;

596 
dio_couÁ
 = 
sdio
->
fš®_block_š_»que¡
 - sdio->
block_š_fe
;

597 
fs_couÁ
 = 
dio_couÁ
 >> 
sdio
->
blkçùÜ
;

598 
blkmask
 = (1 << 
sdio
->
blkçùÜ
) - 1;

599 ià(
dio_couÁ
 & 
blkmask
)

600 
fs_couÁ
++;

602 
m­_bh
->
b_¡©e
 = 0;

603 
m­_bh
->
b_size
 = 
fs_couÁ
 << 
dio
->
šode
->
i_blkb™s
;

616 
ü—‹
 = 
dio
->
rw
 & 
WRITE
;

617 ià(
dio
->
æags
 & 
DIO_SKIP_HOLES
) {

618 ià(
sdio
->
block_š_fe
 < (
	`i_size_»ad
(
dio
->
šode
) >>

619 
sdio
->
blkb™s
))

620 
ü—‹
 = 0;

623 
»t
 = (*
sdio
->
g‘_block
)(
dio
->
šode
, 
fs_¡¬tblk
,

624 
m­_bh
, 
ü—‹
);

627 
dio
->
´iv©e
 = 
m­_bh
->
b_´iv©e
;

629  
»t
;

630 
	}
}

635 
šlše
 
	$dio_Ãw_bio
(
dio
 *dio, 
dio_subm™
 *
sdio
,

636 
£ùÜ_t
 
¡¬t_£ùÜ
, 
bufãr_h—d
 *
m­_bh
)

638 
£ùÜ_t
 
£ùÜ
;

639 
»t
, 
Ä_·ges
;

641 
»t
 = 
	`dio_bio_»­
(
dio
, 
sdio
);

642 ià(
»t
)

643 
out
;

644 
£ùÜ
 = 
¡¬t_£ùÜ
 << (
sdio
->
blkb™s
 - 9);

645 
Ä_·ges
 = 
	`mš
(
sdio
->
·ges_š_io
, 
	`bio_g‘_Ä_vecs
(
m­_bh
->
b_bdev
));

646 
Ä_·ges
 = 
	`mš
Òr_·ges, 
BIO_MAX_PAGES
);

647 
	`BUG_ON
(
Ä_·ges
 <= 0);

648 
	`dio_bio_®loc
(
dio
, 
sdio
, 
m­_bh
->
b_bdev
, 
£ùÜ
, 
Ä_·ges
);

649 
sdio
->
bound¬y
 = 0;

650 
out
:

651  
»t
;

652 
	}
}

661 
šlše
 
	$dio_bio_add_·ge
(
dio_subm™
 *
sdio
)

663 
»t
;

665 
»t
 = 
	`bio_add_·ge
(
sdio
->
bio
, sdio->
cur_·ge
,

666 
sdio
->
cur_·ge_Ën
, sdio->
cur_·ge_off£t
);

667 ià(
»t
 =ğ
sdio
->
cur_·ge_Ën
) {

671 ià((
sdio
->
cur_·ge_Ën
 + sdio->
cur_·ge_off£t
è=ğ
PAGE_SIZE
)

672 
sdio
->
·ges_š_io
--;

673 
	`·ge_ÿche_g‘
(
sdio
->
cur_·ge
);

674 
sdio
->
fš®_block_š_bio
 = sdio->
cur_·ge_block
 +

675 (
sdio
->
cur_·ge_Ën
 >> sdio->
blkb™s
);

676 
»t
 = 0;

678 
»t
 = 1;

680  
»t
;

681 
	}
}

693 
šlše
 
	$dio_£nd_cur_·ge
(
dio
 *dio, 
dio_subm™
 *
sdio
,

694 
bufãr_h—d
 *
m­_bh
)

696 
»t
 = 0;

698 ià(
sdio
->
bio
) {

699 
loff_t
 
cur_off£t
 = 
sdio
->
cur_·ge_fs_off£t
;

700 
loff_t
 
bio_Ãxt_off£t
 = 
sdio
->
logiÿl_off£t_š_bio
 +

701 
sdio
->
bio
->
bi_size
;

717 ià(
sdio
->
fš®_block_š_bio
 !ğsdio->
cur_·ge_block
 ||

718 
cur_off£t
 !ğ
bio_Ãxt_off£t
)

719 
	`dio_bio_subm™
(
dio
, 
sdio
);

724 ià(
sdio
->
bound¬y
)

725 
	`dio_bio_subm™
(
dio
, 
sdio
);

728 ià(
sdio
->
bio
 =ğ
NULL
) {

729 
»t
 = 
	`dio_Ãw_bio
(
dio
, 
sdio
, sdio->
cur_·ge_block
, 
m­_bh
);

730 ià(
»t
)

731 
out
;

734 ià(
	`dio_bio_add_·ge
(
sdio
) != 0) {

735 
	`dio_bio_subm™
(
dio
, 
sdio
);

736 
»t
 = 
	`dio_Ãw_bio
(
dio
, 
sdio
, sdio->
cur_·ge_block
, 
m­_bh
);

737 ià(
»t
 == 0) {

738 
»t
 = 
	`dio_bio_add_·ge
(
sdio
);

739 
	`BUG_ON
(
»t
 != 0);

742 
out
:

743  
»t
;

744 
	}
}

763 
šlše
 

764 
	$subm™_·ge_£ùiÚ
(
dio
 *dio, 
dio_subm™
 *
sdio
, 
·ge
 *page,

765 
off£t
, 
Ën
, 
£ùÜ_t
 
blockÄ
,

766 
bufãr_h—d
 *
m­_bh
)

768 
»t
 = 0;

770 ià(
dio
->
rw
 & 
WRITE
) {

774 
	`sk_io_accouÁ_wr™e
(
Ën
);

780 ià(
sdio
->
cur_·ge
 =ğ
·ge
 &&

781 
sdio
->
cur_·ge_off£t
 + sdio->
cur_·ge_Ën
 =ğ
off£t
 &&

782 
sdio
->
cur_·ge_block
 +

783 (
sdio
->
cur_·ge_Ën
 >> sdio->
blkb™s
è=ğ
blockÄ
) {

784 
sdio
->
cur_·ge_Ën
 +ğ
Ën
;

790 ià(
sdio
->
bound¬y
) {

791 
»t
 = 
	`dio_£nd_cur_·ge
(
dio
, 
sdio
, 
m­_bh
);

792 
	`·ge_ÿche_»Ëa£
(
sdio
->
cur_·ge
);

793 
sdio
->
cur_·ge
 = 
NULL
;

795 
out
;

801 ià(
sdio
->
cur_·ge
) {

802 
»t
 = 
	`dio_£nd_cur_·ge
(
dio
, 
sdio
, 
m­_bh
);

803 
	`·ge_ÿche_»Ëa£
(
sdio
->
cur_·ge
);

804 
sdio
->
cur_·ge
 = 
NULL
;

805 ià(
»t
)

806 
out
;

809 
	`·ge_ÿche_g‘
(
·ge
);

810 
sdio
->
cur_·ge
 = 
·ge
;

811 
sdio
->
cur_·ge_off£t
 = 
off£t
;

812 
sdio
->
cur_·ge_Ën
 = 
Ën
;

813 
sdio
->
cur_·ge_block
 = 
blockÄ
;

814 
sdio
->
cur_·ge_fs_off£t
 = sdio->
block_š_fe
 << sdio->
blkb™s
;

815 
out
:

816  
»t
;

817 
	}
}

824 
	$ş—n_blockdev_®Ÿ£s
(
dio
 *dio, 
bufãr_h—d
 *
m­_bh
)

826 
i
;

827 
nblocks
;

829 
nblocks
 = 
m­_bh
->
b_size
 >> 
dio
->
šode
->
i_blkb™s
;

831 
i
 = 0; i < 
nblocks
; i++) {

832 
	`unm­_und”lyšg_m‘ad©a
(
m­_bh
->
b_bdev
,

833 
m­_bh
->
b_blockÄ
 + 
i
);

835 
	}
}

846 
šlše
 
	$dio_z”o_block
(
dio
 *dio, 
dio_subm™
 *
sdio
,

847 
’d
, 
bufãr_h—d
 *
m­_bh
)

849 
dio_blocks_³r_fs_block
;

850 
this_chunk_blocks
;

851 
this_chunk_by‹s
;

852 
·ge
 *page;

854 
sdio
->
¡¬t_z”o_dÚe
 = 1;

855 ià(!
sdio
->
blkçùÜ
 || !
	`bufãr_Ãw
(
m­_bh
))

858 
dio_blocks_³r_fs_block
 = 1 << 
sdio
->
blkçùÜ
;

859 
this_chunk_blocks
 = 
sdio
->
block_š_fe
 & (
dio_blocks_³r_fs_block
 - 1);

861 ià(!
this_chunk_blocks
)

868 ià(
’d
)

869 
this_chunk_blocks
 = 
dio_blocks_³r_fs_block
 -his_chunk_blocks;

871 
this_chunk_by‹s
 = 
this_chunk_blocks
 << 
sdio
->
blkb™s
;

873 
·ge
 = 
	`ZERO_PAGE
(0);

874 ià(
	`subm™_·ge_£ùiÚ
(
dio
, 
sdio
, 
·ge
, 0, 
this_chunk_by‹s
,

875 
sdio
->
Ãxt_block_fÜ_io
, 
m­_bh
))

878 
sdio
->
Ãxt_block_fÜ_io
 +ğ
this_chunk_blocks
;

879 
	}
}

897 
	$do_dœeù_IO
(
dio
 *dio, 
dio_subm™
 *
sdio
,

898 
bufãr_h—d
 *
m­_bh
)

900 cÚ¡ 
blkb™s
 = 
sdio
->blkbits;

901 cÚ¡ 
blocks_³r_·ge
 = 
PAGE_SIZE
 >> 
blkb™s
;

902 
·ge
 *page;

903 
block_š_·ge
;

904 
»t
 = 0;

907 
block_š_·ge
 = 
sdio
->
fœ¡_block_š_·ge
;

909 
sdio
->
block_š_fe
 < sdio->
fš®_block_š_»que¡
) {

910 
·ge
 = 
	`dio_g‘_·ge
(
dio
, 
sdio
);

911 ià(
	`IS_ERR
(
·ge
)) {

912 
»t
 = 
	`PTR_ERR
(
·ge
);

913 
out
;

916 
block_š_·ge
 < 
blocks_³r_·ge
) {

917 
off£t_š_·ge
 = 
block_š_·ge
 << 
blkb™s
;

918 
this_chunk_by‹s
;

919 
this_chunk_blocks
;

920 
u
;

922 ià(
sdio
->
blocks_avaabË
 == 0) {

926 
blkmask
;

927 
dio_»mašd”
;

929 
»t
 = 
	`g‘_mÜe_blocks
(
dio
, 
sdio
, 
m­_bh
);

930 ià(
»t
) {

931 
	`·ge_ÿche_»Ëa£
(
·ge
);

932 
out
;

934 ià(!
	`bufãr_m­³d
(
m­_bh
))

935 
do_hŞes
;

937 
sdio
->
blocks_avaabË
 =

938 
m­_bh
->
b_size
 >> 
sdio
->
blkb™s
;

939 
sdio
->
Ãxt_block_fÜ_io
 =

940 
m­_bh
->
b_blockÄ
 << 
sdio
->
blkçùÜ
;

941 ià(
	`bufãr_Ãw
(
m­_bh
))

942 
	`ş—n_blockdev_®Ÿ£s
(
dio
, 
m­_bh
);

944 ià(!
sdio
->
blkçùÜ
)

945 
do_hŞes
;

947 
blkmask
 = (1 << 
sdio
->
blkçùÜ
) - 1;

948 
dio_»mašd”
 = (
sdio
->
block_š_fe
 & 
blkmask
);

961 ià(!
	`bufãr_Ãw
(
m­_bh
))

962 
sdio
->
Ãxt_block_fÜ_io
 +ğ
dio_»mašd”
;

963 
sdio
->
blocks_avaabË
 -ğ
dio_»mašd”
;

965 
do_hŞes
:

967 ià(!
	`bufãr_m­³d
(
m­_bh
)) {

968 
loff_t
 
i_size_®igÃd
;

971 ià(
dio
->
rw
 & 
WRITE
) {

972 
	`·ge_ÿche_»Ëa£
(
·ge
);

973  -
ENOTBLK
;

980 
i_size_®igÃd
 = 
	`ALIGN
(
	`i_size_»ad
(
dio
->
šode
),

981 1 << 
blkb™s
);

982 ià(
sdio
->
block_š_fe
 >=

983 
i_size_®igÃd
 >> 
blkb™s
) {

985 
	`·ge_ÿche_»Ëa£
(
·ge
);

986 
out
;

988 
	`z”o_u£r
(
·ge
, 
block_š_·ge
 << 
blkb™s
,

989 1 << 
blkb™s
);

990 
sdio
->
block_š_fe
++;

991 
block_š_·ge
++;

992 
Ãxt_block
;

1000 ià(
	`uÆik–y
(
sdio
->
blkçùÜ
 && !sdio->
¡¬t_z”o_dÚe
))

1001 
	`dio_z”o_block
(
dio
, 
sdio
, 0, 
m­_bh
);

1007 
this_chunk_blocks
 = 
sdio
->
blocks_avaabË
;

1008 
u
 = (
PAGE_SIZE
 - 
off£t_š_·ge
è>> 
blkb™s
;

1009 ià(
this_chunk_blocks
 > 
u
)

1010 
this_chunk_blocks
 = 
u
;

1011 
u
 = 
sdio
->
fš®_block_š_»que¡
 - sdio->
block_š_fe
;

1012 ià(
this_chunk_blocks
 > 
u
)

1013 
this_chunk_blocks
 = 
u
;

1014 
this_chunk_by‹s
 = 
this_chunk_blocks
 << 
blkb™s
;

1015 
	`BUG_ON
(
this_chunk_by‹s
 == 0);

1017 
sdio
->
bound¬y
 = 
	`bufãr_bound¬y
(
m­_bh
);

1018 
»t
 = 
	`subm™_·ge_£ùiÚ
(
dio
, 
sdio
, 
·ge
,

1019 
off£t_š_·ge
,

1020 
this_chunk_by‹s
,

1021 
sdio
->
Ãxt_block_fÜ_io
,

1022 
m­_bh
);

1023 ià(
»t
) {

1024 
	`·ge_ÿche_»Ëa£
(
·ge
);

1025 
out
;

1027 
sdio
->
Ãxt_block_fÜ_io
 +ğ
this_chunk_blocks
;

1029 
sdio
->
block_š_fe
 +ğ
this_chunk_blocks
;

1030 
block_š_·ge
 +ğ
this_chunk_blocks
;

1031 
sdio
->
blocks_avaabË
 -ğ
this_chunk_blocks
;

1032 
Ãxt_block
:

1033 
	`BUG_ON
(
sdio
->
block_š_fe
 > sdio->
fš®_block_š_»que¡
);

1034 ià(
sdio
->
block_š_fe
 =ğsdio->
fš®_block_š_»que¡
)

1039 
	`·ge_ÿche_»Ëa£
(
·ge
);

1040 
block_š_·ge
 = 0;

1042 
out
:

1043  
»t
;

1044 
	}
}

1046 
šlše
 
	$drİ_»fcouÁ
(
dio
 *dio)

1048 
»t2
;

1049 
æags
;

1062 
	`¥š_lock_œq§ve
(&
dio
->
bio_lock
, 
æags
);

1063 
»t2
 = --
dio
->
»fcouÁ
;

1064 
	`¥š_uÆock_œq»¡Üe
(&
dio
->
bio_lock
, 
æags
);

1065  
»t2
;

1066 
	}
}

1093 
ssize_t


1094 
	$__blockdev_dœeù_IO
(
rw
, 
kiocb
 *
iocb
, 
šode
 *inode,

1095 
block_deviû
 *
bdev
, cÚ¡ 
iovec
 *
iov
, 
loff_t
 
off£t
,

1096 
Ä_£gs
, 
g‘_block_t
 
g‘_block
, 
dio_iodÚe_t
 
’d_io
,

1097 
dio_subm™_t
 
subm™_io
, 
æags
)

1099 
£g
;

1100 
size_t
 
size
;

1101 
addr
;

1102 
blkb™s
 = 
šode
->
i_blkb™s
;

1103 
bdev_blkb™s
 = 0;

1104 
blocksize_mask
 = (1 << 
blkb™s
) - 1;

1105 
ssize_t
 
»tv®
 = -
EINVAL
;

1106 
loff_t
 
’d
 = 
off£t
;

1107 
dio
 *dio;

1108 
dio_subm™
 
sdio
 = { 0, };

1109 
u£r_addr
;

1110 
size_t
 
by‹s
;

1111 
bufãr_h—d
 
m­_bh
 = { 0, };

1113 ià(
rw
 & 
WRITE
)

1114 
rw
 = 
WRITE_ODIRECT
;

1116 ià(
bdev
)

1117 
bdev_blkb™s
 = 
	`blksize_b™s
(
	`bdev_logiÿl_block_size
(
bdev
));

1119 ià(
off£t
 & 
blocksize_mask
) {

1120 ià(
bdev
)

1121 
blkb™s
 = 
bdev_blkb™s
;

1122 
blocksize_mask
 = (1 << 
blkb™s
) - 1;

1123 ià(
off£t
 & 
blocksize_mask
)

1124 
out
;

1128 
£g
 = 0; seg < 
Ä_£gs
; seg++) {

1129 
addr
 = ()
iov
[
£g
].
iov_ba£
;

1130 
size
 = 
iov
[
£g
].
iov_Ën
;

1131 
’d
 +ğ
size
;

1132 ià((
addr
 & 
blocksize_mask
è|| (
size
 & blocksize_mask)) {

1133 ià(
bdev
)

1134 
blkb™s
 = 
bdev_blkb™s
;

1135 
blocksize_mask
 = (1 << 
blkb™s
) - 1;

1136 ià((
addr
 & 
blocksize_mask
è|| (
size
 & blocksize_mask))

1137 
out
;

1142 ià(
rw
 =ğ
READ
 && 
’d
 =ğ
off£t
)

1145 
dio
 = 
	`kmem_ÿche_®loc
(
dio_ÿche
, 
GFP_KERNEL
);

1146 
»tv®
 = -
ENOMEM
;

1147 ià(!
dio
)

1148 
out
;

1154 
	`mem£t
(
dio
, 0, 
	`off£tof
(dio, 
·ges
));

1156 
dio
->
æags
 = flags;

1157 ià(
dio
->
æags
 & 
DIO_LOCKING
) {

1158 ià(
rw
 =ğ
READ
) {

1159 
add»ss_¥aû
 *
m­pšg
 =

1160 
iocb
->
ki_fp
->
f_m­pšg
;

1163 
	`mu‹x_lock
(&
šode
->
i_mu‹x
);

1165 
»tv®
 = 
	`fem­_wr™e_ªd_wa™_¿nge
(
m­pšg
, 
off£t
,

1166 
’d
 - 1);

1167 ià(
»tv®
) {

1168 
	`mu‹x_uÆock
(&
šode
->
i_mu‹x
);

1169 
	`kmem_ÿche_ä“
(
dio_ÿche
, 
dio
);

1170 
out
;

1178 
	`©omic_šc
(&
šode
->
i_dio_couÁ
);

1186 
dio
->
is_async
 = !
	`is_sync_kiocb
(
iocb
è&& !((
rw
 & 
WRITE
) &&

1187 (
’d
 > 
	`i_size_»ad
(
šode
)));

1189 
»tv®
 = 0;

1191 
dio
->
šode
 = inode;

1192 
dio
->
rw
 =„w;

1193 
sdio
.
blkb™s
 = blkbits;

1194 
sdio
.
blkçùÜ
 = 
šode
->
i_blkb™s
 - 
blkb™s
;

1195 
sdio
.
block_š_fe
 = 
off£t
 >> 
blkb™s
;

1197 
sdio
.
g‘_block
 = get_block;

1198 
dio
->
’d_io
 =ƒnd_io;

1199 
sdio
.
subm™_io
 = submit_io;

1200 
sdio
.
fš®_block_š_bio
 = -1;

1201 
sdio
.
Ãxt_block_fÜ_io
 = -1;

1203 
dio
->
iocb
 = iocb;

1204 
dio
->
i_size
 = 
	`i_size_»ad
(
šode
);

1206 
	`¥š_lock_š™
(&
dio
->
bio_lock
);

1207 
dio
->
»fcouÁ
 = 1;

1213 ià(
	`uÆik–y
(
sdio
.
blkçùÜ
))

1214 
sdio
.
·ges_š_io
 = 2;

1216 
£g
 = 0; seg < 
Ä_£gs
; seg++) {

1217 
u£r_addr
 = ()
iov
[
£g
].
iov_ba£
;

1218 
sdio
.
·ges_š_io
 +=

1219 ((
u£r_addr
 + 
iov
[
£g
].
iov_Ën
 + 
PAGE_SIZE
-1) /

1220 
PAGE_SIZE
 - 
u£r_addr
 / PAGE_SIZE);

1223 
£g
 = 0; seg < 
Ä_£gs
; seg++) {

1224 
u£r_addr
 = ()
iov
[
£g
].
iov_ba£
;

1225 
sdio
.
size
 +ğ
by‹s
 = 
iov
[
£g
].
iov_Ën
;

1228 
sdio
.
fœ¡_block_š_·ge
 = (
u£r_addr
 & ~
PAGE_MASK
è>> 
blkb™s
;

1229 
sdio
.
fš®_block_š_»que¡
 = sdio.
block_š_fe
 +

1230 (
by‹s
 >> 
blkb™s
);

1232 
sdio
.
h—d
 = 0;

1233 
sdio
.

 = 0;

1234 
sdio
.
cu¼_·ge
 = 0;

1236 
sdio
.
tÙ®_·ges
 = 0;

1237 ià(
u£r_addr
 & (
PAGE_SIZE
-1)) {

1238 
sdio
.
tÙ®_·ges
++;

1239 
by‹s
 -ğ
PAGE_SIZE
 - (
u£r_addr
 & (PAGE_SIZE - 1));

1241 
sdio
.
tÙ®_·ges
 +ğ(
by‹s
 + 
PAGE_SIZE
 - 1) / PAGE_SIZE;

1242 
sdio
.
cu¼_u£r_add»ss
 = 
u£r_addr
;

1244 
»tv®
 = 
	`do_dœeù_IO
(
dio
, &
sdio
, &
m­_bh
);

1246 
dio
->
»suÉ
 +ğ
iov
[
£g
].
iov_Ën
 -

1247 ((
sdio
.
fš®_block_š_»que¡
 - sdio.
block_š_fe
) <<

1248 
blkb™s
);

1250 ià(
»tv®
) {

1251 
	`dio_ş—nup
(
dio
, &
sdio
);

1256 ià(
»tv®
 =ğ-
ENOTBLK
) {

1261 
»tv®
 = 0;

1267 
	`dio_z”o_block
(
dio
, &
sdio
, 1, &
m­_bh
);

1269 ià(
sdio
.
cur_·ge
) {

1270 
ssize_t
 
»t2
;

1272 
»t2
 = 
	`dio_£nd_cur_·ge
(
dio
, &
sdio
, &
m­_bh
);

1273 ià(
»tv®
 == 0)

1274 
»tv®
 = 
»t2
;

1275 
	`·ge_ÿche_»Ëa£
(
sdio
.
cur_·ge
);

1276 
sdio
.
cur_·ge
 = 
NULL
;

1278 ià(
sdio
.
bio
)

1279 
	`dio_bio_subm™
(
dio
, &
sdio
);

1285 
	`dio_ş—nup
(
dio
, &
sdio
);

1292 ià(
rw
 =ğ
READ
 && (
dio
->
æags
 & 
DIO_LOCKING
))

1293 
	`mu‹x_uÆock
(&
dio
->
šode
->
i_mu‹x
);

1302 
	`BUG_ON
(
»tv®
 =ğ-
EIOCBQUEUED
);

1303 ià(
dio
->
is_async
 && 
»tv®
 =ğ0 && dio->
»suÉ
 &&

1304 ((
rw
 & 
READ
è|| (
dio
->
»suÉ
 =ğ
sdio
.
size
)))

1305 
»tv®
 = -
EIOCBQUEUED
;

1307 ià(
»tv®
 !ğ-
EIOCBQUEUED
)

1308 
	`dio_awa™_com¶‘iÚ
(
dio
);

1310 ià(
	`drİ_»fcouÁ
(
dio
) == 0) {

1311 
»tv®
 = 
	`dio_com¶‘e
(
dio
, 
off£t
,„‘v®, 
çl£
);

1312 
	`kmem_ÿche_ä“
(
dio_ÿche
, 
dio
);

1314 
	`BUG_ON
(
»tv®
 !ğ-
EIOCBQUEUED
);

1316 
out
:

1317  
»tv®
;

1318 
	}
}

1319 
EXPORT_SYMBOL
(
__blockdev_dœeù_IO
);

1321 
__š™
 
	$dio_š™
()

1323 
dio_ÿche
 = 
	`KMEM_CACHE
(
dio
, 
SLAB_PANIC
);

1325 
	}
}

1326 
moduË_š™
(
dio_š™
)

	@drop_caches.c

5 
	~<lšux/k”Ãl.h
>

6 
	~<lšux/mm.h
>

7 
	~<lšux/fs.h
>

8 
	~<lšux/wr™eback.h
>

9 
	~<lšux/sysùl.h
>

10 
	~<lšux/gå.h
>

11 
	~"š‹º®.h
"

14 
	gsysùl_drİ_ÿches
;

16 
	$drİ_·geÿche_sb
(
su³r_block
 *
sb
, *
unu£d
)

18 
šode
 *šode, *
tİut_šode
 = 
NULL
;

20 
	`¥š_lock
(&
šode_sb_li¡_lock
);

21 
	`li¡_fÜ_—ch_’Œy
(
šode
, &
sb
->
s_šodes
, 
i_sb_li¡
) {

22 
	`¥š_lock
(&
šode
->
i_lock
);

23 ià((
šode
->
i_¡©e
 & (
I_FREEING
|
I_WILL_FREE
|
I_NEW
)) ||

24 (
šode
->
i_m­pšg
->
Ä·ges
 == 0)) {

25 
	`¥š_uÆock
(&
šode
->
i_lock
);

28 
	`__ig‘
(
šode
);

29 
	`¥š_uÆock
(&
šode
->
i_lock
);

30 
	`¥š_uÆock
(&
šode_sb_li¡_lock
);

31 
	`šv®id©e_m­pšg_·ges
(
šode
->
i_m­pšg
, 0, -1);

32 
	`ut
(
tİut_šode
);

33 
tİut_šode
 = 
šode
;

34 
	`¥š_lock
(&
šode_sb_li¡_lock
);

36 
	`¥š_uÆock
(&
šode_sb_li¡_lock
);

37 
	`ut
(
tİut_šode
);

38 
	}
}

40 
	$drİ_¦ab
()

42 
Ä_objeùs
;

43 
shršk_cÚŒŞ
 
shršk
 = {

44 .
gå_mask
 = 
GFP_KERNEL
,

48 
Ä_objeùs
 = 
	`shršk_¦ab
(&
shršk
, 1000, 1000);

49 } 
Ä_objeùs
 > 10);

50 
	}
}

52 
	$drİ_ÿches_sysùl_hªdËr
(
ùl_bË
 *
bË
, 
wr™e
,

53 
__u£r
 *
bufãr
, 
size_t
 *
Ëngth
, 
loff_t
 *
µos
)

55 
»t
;

57 
»t
 = 
	`´oc_doštvec_mšmax
(
bË
, 
wr™e
, 
bufãr
, 
Ëngth
, 
µos
);

58 ià(
»t
)

59  
»t
;

60 ià(
wr™e
) {

61 ià(
sysùl_drİ_ÿches
 & 1)

62 
	`™”©e_su³rs
(
drİ_·geÿche_sb
, 
NULL
);

63 ià(
sysùl_drİ_ÿches
 & 2)

64 
	`drİ_¦ab
();

67 
	}
}

	@eventfd.c

8 
	~<lšux/fe.h
>

9 
	~<lšux/pŞl.h
>

10 
	~<lšux/š™.h
>

11 
	~<lšux/fs.h
>

12 
	~<lšux/sched.h
>

13 
	~<lšux/k”Ãl.h
>

14 
	~<lšux/¦ab.h
>

15 
	~<lšux/li¡.h
>

16 
	~<lšux/¥šlock.h
>

17 
	~<lšux/ªÚ_šodes.h
>

18 
	~<lšux/sysÿÎs.h
>

19 
	~<lšux/moduË.h
>

20 
	~<lšux/k»f.h
>

21 
	~<lšux/ev’tfd.h
>

23 
	sev’tfd_ùx
 {

24 
k»f
 
	mk»f
;

25 
wa™_queue_h—d_t
 
	mwqh
;

34 
__u64
 
	mcouÁ
;

35 
	mæags
;

54 
	$ev’tfd_sigÇl
(
ev’tfd_ùx
 *
ùx
, 
n
)

56 
æags
;

58 ià(
n
 < 0)

59  -
EINVAL
;

60 
	`¥š_lock_œq§ve
(&
ùx
->
wqh
.
lock
, 
æags
);

61 ià(
ULLONG_MAX
 - 
ùx
->
couÁ
 < 
n
)

62 
n
 = (è(
ULLONG_MAX
 - 
ùx
->
couÁ
);

63 
ùx
->
couÁ
 +ğ
n
;

64 ià(
	`wa™queue_aùive
(&
ùx
->
wqh
))

65 
	`wake_up_locked_pŞl
(&
ùx
->
wqh
, 
POLLIN
);

66 
	`¥š_uÆock_œq»¡Üe
(&
ùx
->
wqh
.
lock
, 
æags
);

68  
n
;

69 
	}
}

70 
EXPORT_SYMBOL_GPL
(
ev’tfd_sigÇl
);

72 
	$ev’tfd_ä“_ùx
(
ev’tfd_ùx
 *
ùx
)

74 
	`kä“
(
ùx
);

75 
	}
}

77 
	$ev’tfd_ä“
(
k»f
 *kref)

79 
ev’tfd_ùx
 *
ùx
 = 
	`cÚš”_of
(
k»f
, eventfd_ctx, kref);

81 
	`ev’tfd_ä“_ùx
(
ùx
);

82 
	}
}

90 
ev’tfd_ùx
 *
	$ev’tfd_ùx_g‘
(
ev’tfd_ùx
 *
ùx
)

92 
	`k»f_g‘
(&
ùx
->
k»f
);

93  
ùx
;

94 
	}
}

95 
EXPORT_SYMBOL_GPL
(
ev’tfd_ùx_g‘
);

104 
	$ev’tfd_ùx_put
(
ev’tfd_ùx
 *
ùx
)

106 
	`k»f_put
(&
ùx
->
k»f
, 
ev’tfd_ä“
);

107 
	}
}

108 
EXPORT_SYMBOL_GPL
(
ev’tfd_ùx_put
);

110 
	$ev’tfd_»Ëa£
(
šode
 *šode, 
fe
 *file)

112 
ev’tfd_ùx
 *
ùx
 = 
fe
->
´iv©e_d©a
;

114 
	`wake_up_pŞl
(&
ùx
->
wqh
, 
POLLHUP
);

115 
	`ev’tfd_ùx_put
(
ùx
);

117 
	}
}

119 
	$ev’tfd_pŞl
(
fe
 *fe, 
pŞl_bË
 *
wa™
)

121 
ev’tfd_ùx
 *
ùx
 = 
fe
->
´iv©e_d©a
;

122 
ev’ts
 = 0;

123 
æags
;

125 
	`pŞl_wa™
(
fe
, &
ùx
->
wqh
, 
wa™
);

127 
	`¥š_lock_œq§ve
(&
ùx
->
wqh
.
lock
, 
æags
);

128 ià(
ùx
->
couÁ
 > 0)

129 
ev’ts
 |ğ
POLLIN
;

130 ià(
ùx
->
couÁ
 =ğ
ULLONG_MAX
)

131 
ev’ts
 |ğ
POLLERR
;

132 ià(
ULLONG_MAX
 - 1 > 
ùx
->
couÁ
)

133 
ev’ts
 |ğ
POLLOUT
;

134 
	`¥š_uÆock_œq»¡Üe
(&
ùx
->
wqh
.
lock
, 
æags
);

136  
ev’ts
;

137 
	}
}

139 
	$ev’tfd_ùx_do_»ad
(
ev’tfd_ùx
 *
ùx
, 
__u64
 *
út
)

141 *
út
 = (
ùx
->
æags
 & 
EFD_SEMAPHORE
è? 1 : ctx->
couÁ
;

142 
ùx
->
couÁ
 -ğ*
út
;

143 
	}
}

158 
	$ev’tfd_ùx_»move_wa™_queue
(
ev’tfd_ùx
 *
ùx
, 
wa™_queue_t
 *
wa™
,

159 
__u64
 *
út
)

161 
æags
;

163 
	`¥š_lock_œq§ve
(&
ùx
->
wqh
.
lock
, 
æags
);

164 
	`ev’tfd_ùx_do_»ad
(
ùx
, 
út
);

165 
	`__»move_wa™_queue
(&
ùx
->
wqh
, 
wa™
);

166 ià(*
út
 !ğ0 && 
	`wa™queue_aùive
(&
ùx
->
wqh
))

167 
	`wake_up_locked_pŞl
(&
ùx
->
wqh
, 
POLLOUT
);

168 
	`¥š_uÆock_œq»¡Üe
(&
ùx
->
wqh
.
lock
, 
æags
);

170  *
út
 !ğ0 ? 0 : -
EAGAIN
;

171 
	}
}

172 
EXPORT_SYMBOL_GPL
(
ev’tfd_ùx_»move_wa™_queue
);

188 
ssize_t
 
	$ev’tfd_ùx_»ad
(
ev’tfd_ùx
 *
ùx
, 
no_wa™
, 
__u64
 *
út
)

190 
ssize_t
 
»s
;

191 
	`DECLARE_WAITQUEUE
(
wa™
, 
cu¼’t
);

193 
	`¥š_lock_œq
(&
ùx
->
wqh
.
lock
);

194 *
út
 = 0;

195 
»s
 = -
EAGAIN
;

196 ià(
ùx
->
couÁ
 > 0)

197 
»s
 = 0;

198 ià(!
no_wa™
) {

199 
	`__add_wa™_queue
(&
ùx
->
wqh
, &
wa™
);

201 
	`£t_cu¼’t_¡©e
(
TASK_INTERRUPTIBLE
);

202 ià(
ùx
->
couÁ
 > 0) {

203 
»s
 = 0;

206 ià(
	`sigÇl_³ndšg
(
cu¼’t
)) {

207 
»s
 = -
ERESTARTSYS
;

210 
	`¥š_uÆock_œq
(&
ùx
->
wqh
.
lock
);

211 
	`scheduË
();

212 
	`¥š_lock_œq
(&
ùx
->
wqh
.
lock
);

214 
	`__»move_wa™_queue
(&
ùx
->
wqh
, &
wa™
);

215 
	`__£t_cu¼’t_¡©e
(
TASK_RUNNING
);

217 ià(
	`lik–y
(
»s
 == 0)) {

218 
	`ev’tfd_ùx_do_»ad
(
ùx
, 
út
);

219 ià(
	`wa™queue_aùive
(&
ùx
->
wqh
))

220 
	`wake_up_locked_pŞl
(&
ùx
->
wqh
, 
POLLOUT
);

222 
	`¥š_uÆock_œq
(&
ùx
->
wqh
.
lock
);

224  
»s
;

225 
	}
}

226 
EXPORT_SYMBOL_GPL
(
ev’tfd_ùx_»ad
);

228 
ssize_t
 
	$ev’tfd_»ad
(
fe
 *fe, 
__u£r
 *
buf
, 
size_t
 
couÁ
,

229 
loff_t
 *
µos
)

231 
ev’tfd_ùx
 *
ùx
 = 
fe
->
´iv©e_d©a
;

232 
ssize_t
 
»s
;

233 
__u64
 
út
;

235 ià(
couÁ
 < (
út
))

236  -
EINVAL
;

237 
»s
 = 
	`ev’tfd_ùx_»ad
(
ùx
, 
fe
->
f_æags
 & 
O_NONBLOCK
, &
út
);

238 ià(
»s
 < 0)

239  
»s
;

241  
	`put_u£r
(
út
, (
__u64
 
__u£r
 *è
buf
è? -
EFAULT
 : (cnt);

242 
	}
}

244 
ssize_t
 
	$ev’tfd_wr™e
(
fe
 *fe, cÚ¡ 
__u£r
 *
buf
, 
size_t
 
couÁ
,

245 
loff_t
 *
µos
)

247 
ev’tfd_ùx
 *
ùx
 = 
fe
->
´iv©e_d©a
;

248 
ssize_t
 
»s
;

249 
__u64
 
uút
;

250 
	`DECLARE_WAITQUEUE
(
wa™
, 
cu¼’t
);

252 ià(
couÁ
 < (
uút
))

253  -
EINVAL
;

254 ià(
	`cİy_äom_u£r
(&
uút
, 
buf
, (ucnt)))

255  -
EFAULT
;

256 ià(
uút
 =ğ
ULLONG_MAX
)

257  -
EINVAL
;

258 
	`¥š_lock_œq
(&
ùx
->
wqh
.
lock
);

259 
»s
 = -
EAGAIN
;

260 ià(
ULLONG_MAX
 - 
ùx
->
couÁ
 > 
uút
)

261 
»s
 = (
uút
);

262 ià(!(
fe
->
f_æags
 & 
O_NONBLOCK
)) {

263 
	`__add_wa™_queue
(&
ùx
->
wqh
, &
wa™
);

264 
»s
 = 0;;) {

265 
	`£t_cu¼’t_¡©e
(
TASK_INTERRUPTIBLE
);

266 ià(
ULLONG_MAX
 - 
ùx
->
couÁ
 > 
uút
) {

267 
»s
 = (
uút
);

270 ià(
	`sigÇl_³ndšg
(
cu¼’t
)) {

271 
»s
 = -
ERESTARTSYS
;

274 
	`¥š_uÆock_œq
(&
ùx
->
wqh
.
lock
);

275 
	`scheduË
();

276 
	`¥š_lock_œq
(&
ùx
->
wqh
.
lock
);

278 
	`__»move_wa™_queue
(&
ùx
->
wqh
, &
wa™
);

279 
	`__£t_cu¼’t_¡©e
(
TASK_RUNNING
);

281 ià(
	`lik–y
(
»s
 > 0)) {

282 
ùx
->
couÁ
 +ğ
uút
;

283 ià(
	`wa™queue_aùive
(&
ùx
->
wqh
))

284 
	`wake_up_locked_pŞl
(&
ùx
->
wqh
, 
POLLIN
);

286 
	`¥š_uÆock_œq
(&
ùx
->
wqh
.
lock
);

288  
»s
;

289 
	}
}

291 cÚ¡ 
fe_İ”©iÚs
 
	gev’tfd_fİs
 = {

292 .
»Ëa£
 = 
ev’tfd_»Ëa£
,

293 .
	gpŞl
 = 
ev’tfd_pŞl
,

294 .
	g»ad
 = 
ev’tfd_»ad
,

295 .
	gwr™e
 = 
ev’tfd_wr™e
,

296 .
	gÎ£ek
 = 
noİ_Î£ek
,

309 
fe
 *
	$ev’tfd_fg‘
(
fd
)

311 
fe
 *file;

313 
fe
 = 
	`fg‘
(
fd
);

314 ià(!
fe
)

315  
	`ERR_PTR
(-
EBADF
);

316 ià(
fe
->
f_İ
 !ğ&
ev’tfd_fİs
) {

317 
	`åut
(
fe
);

318  
	`ERR_PTR
(-
EINVAL
);

321  
fe
;

322 
	}
}

323 
EXPORT_SYMBOL_GPL
(
ev’tfd_fg‘
);

334 
ev’tfd_ùx
 *
	$ev’tfd_ùx_fdg‘
(
fd
)

336 
fe
 *file;

337 
ev’tfd_ùx
 *
ùx
;

339 
fe
 = 
	`ev’tfd_fg‘
(
fd
);

340 ià(
	`IS_ERR
(
fe
))

341  (
ev’tfd_ùx
 *è
fe
;

342 
ùx
 = 
	`ev’tfd_ùx_g‘
(
fe
->
´iv©e_d©a
);

343 
	`åut
(
fe
);

345  
ùx
;

346 
	}
}

347 
EXPORT_SYMBOL_GPL
(
ev’tfd_ùx_fdg‘
);

358 
ev’tfd_ùx
 *
	$ev’tfd_ùx_feg‘
(
fe
 *file)

360 ià(
fe
->
f_İ
 !ğ&
ev’tfd_fİs
)

361  
	`ERR_PTR
(-
EINVAL
);

363  
	`ev’tfd_ùx_g‘
(
fe
->
´iv©e_d©a
);

364 
	}
}

365 
EXPORT_SYMBOL_GPL
(
ev’tfd_ùx_feg‘
);

381 
fe
 *
	$ev’tfd_fe_ü—‹
(
couÁ
, 
æags
)

383 
fe
 *file;

384 
ev’tfd_ùx
 *
ùx
;

387 
	`BUILD_BUG_ON
(
EFD_CLOEXEC
 !ğ
O_CLOEXEC
);

388 
	`BUILD_BUG_ON
(
EFD_NONBLOCK
 !ğ
O_NONBLOCK
);

390 ià(
æags
 & ~
EFD_FLAGS_SET
)

391  
	`ERR_PTR
(-
EINVAL
);

393 
ùx
 = 
	`km®loc
((*ùx), 
GFP_KERNEL
);

394 ià(!
ùx
)

395  
	`ERR_PTR
(-
ENOMEM
);

397 
	`k»f_š™
(&
ùx
->
k»f
);

398 
	`š™_wa™queue_h—d
(&
ùx
->
wqh
);

399 
ùx
->
couÁ
 = count;

400 
ùx
->
æags
 = flags;

402 
fe
 = 
	`ªÚ_šode_g‘fe
("[ev’tfd]", &
ev’tfd_fİs
, 
ùx
,

403 
O_RDWR
 | (
æags
 & 
EFD_SHARED_FCNTL_FLAGS
));

404 ià(
	`IS_ERR
(
fe
))

405 
	`ev’tfd_ä“_ùx
(
ùx
);

407  
fe
;

408 
	}
}

410 
	$SYSCALL_DEFINE2
(
ev’tfd2
, , 
couÁ
, , 
æags
)

412 
fd
, 
”rÜ
;

413 
fe
 *file;

415 
”rÜ
 = 
	`g‘_unu£d_fd_æags
(
æags
 & 
EFD_SHARED_FCNTL_FLAGS
);

416 ià(
”rÜ
 < 0)

417  
”rÜ
;

418 
fd
 = 
”rÜ
;

420 
fe
 = 
	`ev’tfd_fe_ü—‹
(
couÁ
, 
æags
);

421 ià(
	`IS_ERR
(
fe
)) {

422 
”rÜ
 = 
	`PTR_ERR
(
fe
);

423 
”r_put_unu£d_fd
;

425 
	`fd_š¡®l
(
fd
, 
fe
);

427  
fd
;

429 
”r_put_unu£d_fd
:

430 
	`put_unu£d_fd
(
fd
);

432  
”rÜ
;

433 
	}
}

435 
	$SYSCALL_DEFINE1
(
ev’tfd
, , 
couÁ
)

437  
	`sys_ev’tfd2
(
couÁ
, 0);

438 
	}
}

	@eventpoll.c

14 
	~<lšux/š™.h
>

15 
	~<lšux/k”Ãl.h
>

16 
	~<lšux/sched.h
>

17 
	~<lšux/fs.h
>

18 
	~<lšux/fe.h
>

19 
	~<lšux/sigÇl.h
>

20 
	~<lšux/”ºo.h
>

21 
	~<lšux/mm.h
>

22 
	~<lšux/¦ab.h
>

23 
	~<lšux/pŞl.h
>

24 
	~<lšux/¡ršg.h
>

25 
	~<lšux/li¡.h
>

26 
	~<lšux/hash.h
>

27 
	~<lšux/¥šlock.h
>

28 
	~<lšux/sysÿÎs.h
>

29 
	~<lšux/rbŒ“.h
>

30 
	~<lšux/wa™.h
>

31 
	~<lšux/ev’Şl.h
>

32 
	~<lšux/mouÁ.h
>

33 
	~<lšux/b™İs.h
>

34 
	~<lšux/mu‹x.h
>

35 
	~<lšux/ªÚ_šodes.h
>

36 
	~<asm/uacûss.h
>

37 
	~<asm/sy¡em.h
>

38 
	~<asm/io.h
>

39 
	~<asm/mmª.h
>

40 
	~<lšux/©omic.h
>

91 
	#EP_PRIVATE_BITS
 (
EPOLLONESHOT
 | 
EPOLLET
)

	)

94 
	#EP_MAX_NESTS
 4

	)

96 
	#EP_MAX_EVENTS
 (
INT_MAX
 / (
•Şl_ev’t
))

	)

98 
	#EP_UNACTIVE_PTR
 ((*è-1L)

	)

100 
	#EP_ITEM_COST
 ((
•™em
è+ (
•pŞl_’Œy
))

	)

102 
	s•Şl_fefd
 {

103 
fe
 *
	mfe
;

104 
	mfd
;

111 
	sÃ¡ed_ÿÎ_node
 {

112 
li¡_h—d
 
	mÎšk
;

113 *
	mcook›
;

114 *
	mùx
;

121 
	sÃ¡ed_ÿÎs
 {

122 
li¡_h—d
 
	msks_ÿÎ_li¡
;

123 
¥šlock_t
 
	mlock
;

130 
	s•™em
 {

132 
rb_node
 
	mrbn
;

135 
li¡_h—d
 
	mrdÎšk
;

141 
•™em
 *
	mÃxt
;

144 
•Şl_fefd
 
	mffd
;

147 
	mnwa™
;

150 
li¡_h—d
 
	mpwqli¡
;

153 
ev’Şl
 *
	m•
;

156 
li¡_h—d
 
	mælšk
;

159 
•Şl_ev’t
 
	mev’t
;

167 
	sev’Şl
 {

169 
¥šlock_t
 
	mlock
;

177 
mu‹x
 
	mmtx
;

180 
wa™_queue_h—d_t
 
	mwq
;

183 
wa™_queue_h—d_t
 
	mpŞl_wa™
;

186 
li¡_h—d
 
	mrdÎi¡
;

189 
rb_roÙ
 
	mrbr
;

196 
•™em
 *
	movæi¡
;

199 
u£r_¡ruù
 *
	mu£r
;

203 
	s•pŞl_’Œy
 {

205 
li¡_h—d
 
	mÎšk
;

208 
•™em
 *
	mba£
;

214 
wa™_queue_t
 
	mwa™
;

217 
wa™_queue_h—d_t
 *
	mwh—d
;

221 
	s•_pqueue
 {

222 
pŞl_bË
 
	m±
;

223 
•™em
 *
	m•i
;

227 
	s•_£nd_ev’ts_d©a
 {

228 
	mmaxev’ts
;

229 
•Şl_ev’t
 
__u£r
 *
	mev’ts
;

236 
max_u£r_w©ches
 
	g__»ad_mo¡ly
;

241 
DEFINE_MUTEX
(
•mu‹x
);

244 
Ã¡ed_ÿÎs
 
	gpŞl_loİ_nÿÎs
;

247 
Ã¡ed_ÿÎs
 
	gpŞl_§ãwake_nÿÎs
;

250 
Ã¡ed_ÿÎs
 
	gpŞl_»adyw®k_nÿÎs
;

253 
kmem_ÿche
 *
•i_ÿche
 
	g__»ad_mo¡ly
;

256 
kmem_ÿche
 *
pwq_ÿche
 
	g__»ad_mo¡ly
;

258 #ifdeà
CONFIG_SYSCTL


260 
	~<lšux/sysùl.h
>

262 
	gz”o
;

263 
	glÚg_max
 = 
LONG_MAX
;

265 
ùl_bË
 
	g•Şl_bË
[] = {

267 .
´oúame
 = "max_user_watches",

268 .
	gd©a
 = &
max_u£r_w©ches
,

269 .
	gmaxËn
 = (
max_u£r_w©ches
),

270 .
	gmode
 = 0644,

271 .
	g´oc_hªdËr
 = 
´oc_doulÚgvec_mšmax
,

272 .
	gexŒa1
 = &
z”o
,

273 .
	gexŒa2
 = &
lÚg_max
,

281 
šlše
 
	$•_£t_ffd
(
•Şl_fefd
 *
ffd
,

282 
fe
 *fe, 
fd
)

284 
ffd
->
fe
 = file;

285 
ffd
->
fd
 = fd;

286 
	}
}

289 
šlše
 
	$•_cmp_ffd
(
•Şl_fefd
 *
p1
,

290 
•Şl_fefd
 *
p2
)

292  (
p1
->
fe
 > 
p2
->file ? +1:

293 (
p1
->
fe
 < 
p2
->f? -1 :…1->
fd
 -…2->fd));

294 
	}
}

297 
šlše
 
	$•_is_lšked
(
li¡_h—d
 *
p
)

299  !
	`li¡_em±y
(
p
);

300 
	}
}

303 
šlše
 
•™em
 *
	$•_™em_äom_wa™
(
wa™_queue_t
 *
p
)

305  
	`cÚš”_of
(
p
, 
•pŞl_’Œy
, 
wa™
)->
ba£
;

306 
	}
}

309 
šlše
 
•™em
 *
	$•_™em_äom_•queue
(
pŞl_bË
 *
p
)

311  
	`cÚš”_of
(
p
, 
•_pqueue
, 
±
)->
•i
;

312 
	}
}

315 
šlše
 
	$•_İ_has_ev’t
(
İ
)

317  
İ
 !ğ
EPOLL_CTL_DEL
;

318 
	}
}

321 
	$•_Ã¡ed_ÿÎs_š™
(
Ã¡ed_ÿÎs
 *
nÿÎs
)

323 
	`INIT_LIST_HEAD
(&
nÿÎs
->
sks_ÿÎ_li¡
);

324 
	`¥š_lock_š™
(&
nÿÎs
->
lock
);

325 
	}
}

335 
šlše
 
	$•_ev’ts_avaabË
(
ev’Şl
 *
•
)

337  !
	`li¡_em±y
(&
•
->
rdÎi¡
è||ƒp->
ovæi¡
 !ğ
EP_UNACTIVE_PTR
;

338 
	}
}

356 
•_ÿÎ_Ã¡ed
(
Ã¡ed_ÿÎs
 *
nÿÎs
, 
max_Ã¡s
,

357 (*
Åroc
)(*, *, ), *
´iv
,

358 *
cook›
, *
ùx
)

360 
”rÜ
, 
ÿÎ_Ã¡s
 = 0;

361 
æags
;

362 
li¡_h—d
 *
l¡h—d
 = &
nÿÎs
->
sks_ÿÎ_li¡
;

363 
Ã¡ed_ÿÎ_node
 *
Šcur
;

364 
Ã¡ed_ÿÎ_node
 
Šode
;

366 
	`¥š_lock_œq§ve
(&
nÿÎs
->
lock
, 
æags
);

373 
	`li¡_fÜ_—ch_’Œy
(
Šcur
, 
l¡h—d
, 
Îšk
) {

374 ià(
Šcur
->
ùx
 == ctx &&

375 (
Šcur
->
cook›
 =ğcook› || ++
ÿÎ_Ã¡s
 > 
max_Ã¡s
)) {

380 
”rÜ
 = -1;

381 
out_uÆock
;

386 
Šode
.
ùx
 = ctx;

387 
Šode
.
cook›
 = cookie;

388 
	`li¡_add
(&
Šode
.
Îšk
, 
l¡h—d
);

390 
	`¥š_uÆock_œq»¡Üe
(&
nÿÎs
->
lock
, 
æags
);

393 
”rÜ
 = (*
Åroc
)(
´iv
, 
cook›
, 
ÿÎ_Ã¡s
);

396 
	`¥š_lock_œq§ve
(&
nÿÎs
->
lock
, 
æags
);

397 
	`li¡_d–
(&
Šode
.
Îšk
);

398 
out_uÆock
:

399 
	`¥š_uÆock_œq»¡Üe
(&
nÿÎs
->
lock
, 
æags
);

401  
”rÜ
;

402 
	}
}

404 #ifdeà
CONFIG_DEBUG_LOCK_ALLOC


405 
šlše
 
	$•_wake_up_Ã¡ed
(
wa™_queue_h—d_t
 *
wqueue
,

406 
ev’ts
, 
subşass
)

408 
æags
;

410 
	`¥š_lock_œq§ve_Ã¡ed
(&
wqueue
->
lock
, 
æags
, 
subşass
);

411 
	`wake_up_locked_pŞl
(
wqueue
, 
ev’ts
);

412 
	`¥š_uÆock_œq»¡Üe
(&
wqueue
->
lock
, 
æags
);

413 
	}
}

415 
šlše
 
	$•_wake_up_Ã¡ed
(
wa™_queue_h—d_t
 *
wqueue
,

416 
ev’ts
, 
subşass
)

418 
	`wake_up_pŞl
(
wqueue
, 
ev’ts
);

419 
	}
}

422 
	$•_pŞl_wakeup_´oc
(*
´iv
, *
cook›
, 
ÿÎ_Ã¡s
)

424 
	`•_wake_up_Ã¡ed
((
wa™_queue_h—d_t
 *è
cook›
, 
POLLIN
,

425 1 + 
ÿÎ_Ã¡s
);

427 
	}
}

439 
	$•_pŞl_§ãwake
(
wa™_queue_h—d_t
 *
wq
)

441 
this_ıu
 = 
	`g‘_ıu
();

443 
	`•_ÿÎ_Ã¡ed
(&
pŞl_§ãwake_nÿÎs
, 
EP_MAX_NESTS
,

444 
•_pŞl_wakeup_´oc
, 
NULL
, 
wq
, (*è(è
this_ıu
);

446 
	`put_ıu
();

447 
	}
}

454 
	$•_uÄegi¡”_pŞlwa™
(
ev’Şl
 *
•
, 
•™em
 *
•i
)

456 
li¡_h—d
 *
l¡h—d
 = &
•i
->
pwqli¡
;

457 
•pŞl_’Œy
 *
pwq
;

459 !
	`li¡_em±y
(
l¡h—d
)) {

460 
pwq
 = 
	`li¡_fœ¡_’Œy
(
l¡h—d
, 
•pŞl_’Œy
, 
Îšk
);

462 
	`li¡_d–
(&
pwq
->
Îšk
);

463 
	`»move_wa™_queue
(
pwq
->
wh—d
, &pwq->
wa™
);

464 
	`kmem_ÿche_ä“
(
pwq_ÿche
, 
pwq
);

466 
	}
}

480 
•_sÿn_»ady_li¡
(
ev’Şl
 *
•
,

481 (*
¥roc
)(
ev’Şl
 *,

482 
li¡_h—d
 *, *),

483 *
´iv
,

484 
d•th
)

486 
”rÜ
, 
pwake
 = 0;

487 
æags
;

488 
•™em
 *
•i
, *
Ãpi
;

489 
	`LIST_HEAD
(
txli¡
);

495 
	`mu‹x_lock_Ã¡ed
(&
•
->
mtx
, 
d•th
);

505 
	`¥š_lock_œq§ve
(&
•
->
lock
, 
æags
);

506 
	`li¡_¥liû_š™
(&
•
->
rdÎi¡
, &
txli¡
);

507 
•
->
ovæi¡
 = 
NULL
;

508 
	`¥š_uÆock_œq»¡Üe
(&
•
->
lock
, 
æags
);

513 
”rÜ
 = (*
¥roc
)(
•
, &
txli¡
, 
´iv
);

515 
	`¥š_lock_œq§ve
(&
•
->
lock
, 
æags
);

521 
Ãpi
 = 
•
->
ovæi¡
; (
•i
 =‚•iè!ğ
NULL
;

522 
Ãpi
 = 
•i
->
Ãxt
,ƒpi->Ãxˆğ
EP_UNACTIVE_PTR
) {

529 ià(!
	`•_is_lšked
(&
•i
->
rdÎšk
))

530 
	`li¡_add_
(&
•i
->
rdÎšk
, &
•
->
rdÎi¡
);

537 
•
->
ovæi¡
 = 
EP_UNACTIVE_PTR
;

542 
	`li¡_¥liû
(&
txli¡
, &
•
->
rdÎi¡
);

544 ià(!
	`li¡_em±y
(&
•
->
rdÎi¡
)) {

549 ià(
	`wa™queue_aùive
(&
•
->
wq
))

550 
	`wake_up_locked
(&
•
->
wq
);

551 ià(
	`wa™queue_aùive
(&
•
->
pŞl_wa™
))

552 
pwake
++;

554 
	`¥š_uÆock_œq»¡Üe
(&
•
->
lock
, 
æags
);

556 
	`mu‹x_uÆock
(&
•
->
mtx
);

559 ià(
pwake
)

560 
	`•_pŞl_§ãwake
(&
•
->
pŞl_wa™
);

562  
”rÜ
;

563 
	}
}

569 
	$•_»move
(
ev’Şl
 *
•
, 
•™em
 *
•i
)

571 
æags
;

572 
fe
 *fğ
•i
->
ffd
.file;

582 
	`•_uÄegi¡”_pŞlwa™
(
•
, 
•i
);

585 
	`¥š_lock
(&
fe
->
f_lock
);

586 ià(
	`•_is_lšked
(&
•i
->
ælšk
))

587 
	`li¡_d–_š™
(&
•i
->
ælšk
);

588 
	`¥š_uÆock
(&
fe
->
f_lock
);

590 
	`rb_”a£
(&
•i
->
rbn
, &
•
->
rbr
);

592 
	`¥š_lock_œq§ve
(&
•
->
lock
, 
æags
);

593 ià(
	`•_is_lšked
(&
•i
->
rdÎšk
))

594 
	`li¡_d–_š™
(&
•i
->
rdÎšk
);

595 
	`¥š_uÆock_œq»¡Üe
(&
•
->
lock
, 
æags
);

598 
	`kmem_ÿche_ä“
(
•i_ÿche
, 
•i
);

600 
	`©omic_lÚg_dec
(&
•
->
u£r
->
•Şl_w©ches
);

603 
	}
}

605 
	$•_ä“
(
ev’Şl
 *
•
)

607 
rb_node
 *
rbp
;

608 
•™em
 *
•i
;

611 ià(
	`wa™queue_aùive
(&
•
->
pŞl_wa™
))

612 
	`•_pŞl_§ãwake
(&
•
->
pŞl_wa™
);

622 
	`mu‹x_lock
(&
•mu‹x
);

627 
rbp
 = 
	`rb_fœ¡
(&
•
->
rbr
);„bp;„b°ğ
	`rb_Ãxt
(rbp)) {

628 
•i
 = 
	`rb_’Œy
(
rbp
, 
•™em
, 
rbn
);

630 
	`•_uÄegi¡”_pŞlwa™
(
•
, 
•i
);

639 (
rbp
 = 
	`rb_fœ¡
(&
•
->
rbr
)è!ğ
NULL
) {

640 
•i
 = 
	`rb_’Œy
(
rbp
, 
•™em
, 
rbn
);

641 
	`•_»move
(
•
, 
•i
);

644 
	`mu‹x_uÆock
(&
•mu‹x
);

645 
	`mu‹x_de¡roy
(&
•
->
mtx
);

646 
	`ä“_uid
(
•
->
u£r
);

647 
	`kä“
(
•
);

648 
	}
}

650 
	$•_ev’Şl_»Ëa£
(
šode
 *šode, 
fe
 *file)

652 
ev’Şl
 *
•
 = 
fe
->
´iv©e_d©a
;

654 ià(
•
)

655 
	`•_ä“
(
•
);

658 
	}
}

660 
	$•_»ad_ev’ts_´oc
(
ev’Şl
 *
•
, 
li¡_h—d
 *
h—d
,

661 *
´iv
)

663 
•™em
 *
•i
, *
tmp
;

665 
	`li¡_fÜ_—ch_’Œy_§ã
(
•i
, 
tmp
, 
h—d
, 
rdÎšk
) {

666 ià(
•i
->
ffd
.
fe
->
f_İ
->
	`pŞl
Ópi->ffd.fe, 
NULL
) &

667 
•i
->
ev’t
.
ev’ts
)

668  
POLLIN
 | 
POLLRDNORM
;

675 
	`li¡_d–_š™
(&
•i
->
rdÎšk
);

680 
	}
}

682 
	$•_pŞl_»adyev’ts_´oc
(*
´iv
, *
cook›
, 
ÿÎ_Ã¡s
)

684  
	`•_sÿn_»ady_li¡
(
´iv
, 
•_»ad_ev’ts_´oc
, 
NULL
, 
ÿÎ_Ã¡s
 + 1);

685 
	}
}

687 
	$•_ev’Şl_pŞl
(
fe
 *fe, 
pŞl_bË
 *
wa™
)

689 
pŞlæags
;

690 
ev’Şl
 *
•
 = 
fe
->
´iv©e_d©a
;

693 
	`pŞl_wa™
(
fe
, &
•
->
pŞl_wa™
, 
wa™
);

701 
pŞlæags
 = 
	`•_ÿÎ_Ã¡ed
(&
pŞl_»adyw®k_nÿÎs
, 
EP_MAX_NESTS
,

702 
•_pŞl_»adyev’ts_´oc
, 
•
,ƒp, 
cu¼’t
);

704  
pŞlæags
 != -1 ?…ollflags : 0;

705 
	}
}

708 cÚ¡ 
fe_İ”©iÚs
 
	gev’Şl_fİs
 = {

709 .
»Ëa£
 = 
•_ev’Şl_»Ëa£
,

710 .
	gpŞl
 = 
•_ev’Şl_pŞl
,

711 .
	gÎ£ek
 = 
noİ_Î£ek
,

715 
šlše
 
	$is_fe_•Şl
(
fe
 *
f
)

717  
f
->
f_İ
 =ğ&
ev’Şl_fİs
;

718 
	}
}

725 
	$ev’Şl_»Ëa£_fe
(
fe
 *file)

727 
li¡_h—d
 *
l¡h—d
 = &
fe
->
f_•_lšks
;

728 
ev’Şl
 *
•
;

729 
•™em
 *
•i
;

744 
	`mu‹x_lock
(&
•mu‹x
);

746 !
	`li¡_em±y
(
l¡h—d
)) {

747 
•i
 = 
	`li¡_fœ¡_’Œy
(
l¡h—d
, 
•™em
, 
ælšk
);

749 
•
 = 
•i
->ep;

750 
	`li¡_d–_š™
(&
•i
->
ælšk
);

751 
	`mu‹x_lock_Ã¡ed
(&
•
->
mtx
, 0);

752 
	`•_»move
(
•
, 
•i
);

753 
	`mu‹x_uÆock
(&
•
->
mtx
);

756 
	`mu‹x_uÆock
(&
•mu‹x
);

757 
	}
}

759 
	$•_®loc
(
ev’Şl
 **
³p
)

761 
”rÜ
;

762 
u£r_¡ruù
 *
u£r
;

763 
ev’Şl
 *
•
;

765 
u£r
 = 
	`g‘_cu¼’t_u£r
();

766 
”rÜ
 = -
ENOMEM
;

767 
•
 = 
	`kz®loc
((*•), 
GFP_KERNEL
);

768 ià(
	`uÆik–y
(!
•
))

769 
ä“_uid
;

771 
	`¥š_lock_š™
(&
•
->
lock
);

772 
	`mu‹x_š™
(&
•
->
mtx
);

773 
	`š™_wa™queue_h—d
(&
•
->
wq
);

774 
	`š™_wa™queue_h—d
(&
•
->
pŞl_wa™
);

775 
	`INIT_LIST_HEAD
(&
•
->
rdÎi¡
);

776 
•
->
rbr
 = 
RB_ROOT
;

777 
•
->
ovæi¡
 = 
EP_UNACTIVE_PTR
;

778 
•
->
u£r
 = user;

780 *
³p
 = 
•
;

784 
ä“_uid
:

785 
	`ä“_uid
(
u£r
);

786  
”rÜ
;

787 
	}
}

794 
•™em
 *
	$•_fšd
(
ev’Şl
 *
•
, 
fe
 *fe, 
fd
)

796 
kcmp
;

797 
rb_node
 *
rbp
;

798 
•™em
 *
•i
, *
•œ
 = 
NULL
;

799 
•Şl_fefd
 
ffd
;

801 
	`•_£t_ffd
(&
ffd
, 
fe
, 
fd
);

802 
rbp
 = 
•
->
rbr
.
rb_node
;„bp; ) {

803 
•i
 = 
	`rb_’Œy
(
rbp
, 
•™em
, 
rbn
);

804 
kcmp
 = 
	`•_cmp_ffd
(&
ffd
, &
•i
->ffd);

805 ià(
kcmp
 > 0)

806 
rbp
 =„bp->
rb_right
;

807 ià(
kcmp
 < 0)

808 
rbp
 =„bp->
rb_Ëá
;

810 
•œ
 = 
•i
;

815  
•œ
;

816 
	}
}

823 
	$•_pŞl_ÿÎback
(
wa™_queue_t
 *
wa™
, 
mode
, 
sync
, *
key
)

825 
pwake
 = 0;

826 
æags
;

827 
•™em
 *
•i
 = 
	`•_™em_äom_wa™
(
wa™
);

828 
ev’Şl
 *
•
 = 
•i
->ep;

830 
	`¥š_lock_œq§ve
(&
•
->
lock
, 
æags
);

838 ià(!(
•i
->
ev’t
.
ev’ts
 & ~
EP_PRIVATE_BITS
))

839 
out_uÆock
;

847 ià(
key
 && !((èkey & 
•i
->
ev’t
.
ev’ts
))

848 
out_uÆock
;

856 ià(
	`uÆik–y
(
•
->
ovæi¡
 !ğ
EP_UNACTIVE_PTR
)) {

857 ià(
•i
->
Ãxt
 =ğ
EP_UNACTIVE_PTR
) {

858 
•i
->
Ãxt
 = 
•
->
ovæi¡
;

859 
•
->
ovæi¡
 = 
•i
;

861 
out_uÆock
;

865 ià(!
	`•_is_lšked
(&
•i
->
rdÎšk
))

866 
	`li¡_add_
(&
•i
->
rdÎšk
, &
•
->
rdÎi¡
);

872 ià(
	`wa™queue_aùive
(&
•
->
wq
))

873 
	`wake_up_locked
(&
•
->
wq
);

874 ià(
	`wa™queue_aùive
(&
•
->
pŞl_wa™
))

875 
pwake
++;

877 
out_uÆock
:

878 
	`¥š_uÆock_œq»¡Üe
(&
•
->
lock
, 
æags
);

881 ià(
pwake
)

882 
	`•_pŞl_§ãwake
(&
•
->
pŞl_wa™
);

885 
	}
}

891 
	$•_±abË_queue_´oc
(
fe
 *fe, 
wa™_queue_h—d_t
 *
wh—d
,

892 
pŞl_bË
 *
±
)

894 
•™em
 *
•i
 = 
	`•_™em_äom_•queue
(
±
);

895 
•pŞl_’Œy
 *
pwq
;

897 ià(
•i
->
nwa™
 >ğ0 && (
pwq
 = 
	`kmem_ÿche_®loc
(
pwq_ÿche
, 
GFP_KERNEL
))) {

898 
	`š™_wa™queue_func_’Œy
(&
pwq
->
wa™
, 
•_pŞl_ÿÎback
);

899 
pwq
->
wh—d
 = whead;

900 
pwq
->
ba£
 = 
•i
;

901 
	`add_wa™_queue
(
wh—d
, &
pwq
->
wa™
);

902 
	`li¡_add_
(&
pwq
->
Îšk
, &
•i
->
pwqli¡
);

903 
•i
->
nwa™
++;

906 
•i
->
nwa™
 = -1;

908 
	}
}

910 
	$•_rbŒ“_š£¹
(
ev’Şl
 *
•
, 
•™em
 *
•i
)

912 
kcmp
;

913 
rb_node
 **
p
 = &
•
->
rbr
.rb_node, *
·»Á
 = 
NULL
;

914 
•™em
 *
•ic
;

916 *
p
) {

917 
·»Á
 = *
p
;

918 
•ic
 = 
	`rb_’Œy
(
·»Á
, 
•™em
, 
rbn
);

919 
kcmp
 = 
	`•_cmp_ffd
(&
•i
->
ffd
, &
•ic
->ffd);

920 ià(
kcmp
 > 0)

921 
p
 = &
·»Á
->
rb_right
;

923 
p
 = &
·»Á
->
rb_Ëá
;

925 
	`rb_lšk_node
(&
•i
->
rbn
, 
·»Á
, 
p
);

926 
	`rb_š£¹_cŞÜ
(&
•i
->
rbn
, &
•
->
rbr
);

927 
	}
}

932 
	$•_š£¹
(
ev’Şl
 *
•
, 
•Şl_ev’t
 *
ev’t
,

933 
fe
 *
tfe
, 
fd
)

935 
”rÜ
, 
»v’ts
, 
pwake
 = 0;

936 
æags
;

937 
u£r_w©ches
;

938 
•™em
 *
•i
;

939 
•_pqueue
 
•q
;

941 
u£r_w©ches
 = 
	`©omic_lÚg_»ad
(&
•
->
u£r
->
•Şl_w©ches
);

942 ià(
	`uÆik–y
(
u£r_w©ches
 >ğ
max_u£r_w©ches
))

943  -
ENOSPC
;

944 ià(!(
•i
 = 
	`kmem_ÿche_®loc
(
•i_ÿche
, 
GFP_KERNEL
)))

945  -
ENOMEM
;

948 
	`INIT_LIST_HEAD
(&
•i
->
rdÎšk
);

949 
	`INIT_LIST_HEAD
(&
•i
->
ælšk
);

950 
	`INIT_LIST_HEAD
(&
•i
->
pwqli¡
);

951 
•i
->
•
 =ƒp;

952 
	`•_£t_ffd
(&
•i
->
ffd
, 
tfe
, 
fd
);

953 
•i
->
ev’t
 = *event;

954 
•i
->
nwa™
 = 0;

955 
•i
->
Ãxt
 = 
EP_UNACTIVE_PTR
;

958 
•q
.
•i
 =ƒpi;

959 
	`š™_pŞl_funıŒ
(&
•q
.
±
, 
•_±abË_queue_´oc
);

968 
»v’ts
 = 
tfe
->
f_İ
->
	`pŞl
Ñfe, &
•q
.
±
);

975 
”rÜ
 = -
ENOMEM
;

976 ià(
•i
->
nwa™
 < 0)

977 
”rÜ_uÄegi¡”
;

980 
	`¥š_lock
(&
tfe
->
f_lock
);

981 
	`li¡_add_
(&
•i
->
ælšk
, &
tfe
->
f_•_lšks
);

982 
	`¥š_uÆock
(&
tfe
->
f_lock
);

988 
	`•_rbŒ“_š£¹
(
•
, 
•i
);

991 
	`¥š_lock_œq§ve
(&
•
->
lock
, 
æags
);

994 ià((
»v’ts
 & 
ev’t
->
ev’ts
è&& !
	`•_is_lšked
(&
•i
->
rdÎšk
)) {

995 
	`li¡_add_
(&
•i
->
rdÎšk
, &
•
->
rdÎi¡
);

998 ià(
	`wa™queue_aùive
(&
•
->
wq
))

999 
	`wake_up_locked
(&
•
->
wq
);

1000 ià(
	`wa™queue_aùive
(&
•
->
pŞl_wa™
))

1001 
pwake
++;

1004 
	`¥š_uÆock_œq»¡Üe
(&
•
->
lock
, 
æags
);

1006 
	`©omic_lÚg_šc
(&
•
->
u£r
->
•Şl_w©ches
);

1009 ià(
pwake
)

1010 
	`•_pŞl_§ãwake
(&
•
->
pŞl_wa™
);

1014 
”rÜ_uÄegi¡”
:

1015 
	`•_uÄegi¡”_pŞlwa™
(
•
, 
•i
);

1023 
	`¥š_lock_œq§ve
(&
•
->
lock
, 
æags
);

1024 ià(
	`•_is_lšked
(&
•i
->
rdÎšk
))

1025 
	`li¡_d–_š™
(&
•i
->
rdÎšk
);

1026 
	`¥š_uÆock_œq»¡Üe
(&
•
->
lock
, 
æags
);

1028 
	`kmem_ÿche_ä“
(
•i_ÿche
, 
•i
);

1030  
”rÜ
;

1031 
	}
}

1037 
	$•_modify
(
ev’Şl
 *
•
, 
•™em
 *
•i
, 
•Şl_ev’t
 *
ev’t
)

1039 
pwake
 = 0;

1040 
»v’ts
;

1047 
•i
->
ev’t
.
ev’ts
 =ƒvent->events;

1048 
•i
->
ev’t
.
d©a
 =ƒvent->data;

1054 
»v’ts
 = 
•i
->
ffd
.
fe
->
f_İ
->
	`pŞl
Ópi->ffd.fe, 
NULL
);

1060 ià(
»v’ts
 & 
ev’t
->
ev’ts
) {

1061 
	`¥š_lock_œq
(&
•
->
lock
);

1062 ià(!
	`•_is_lšked
(&
•i
->
rdÎšk
)) {

1063 
	`li¡_add_
(&
•i
->
rdÎšk
, &
•
->
rdÎi¡
);

1066 ià(
	`wa™queue_aùive
(&
•
->
wq
))

1067 
	`wake_up_locked
(&
•
->
wq
);

1068 ià(
	`wa™queue_aùive
(&
•
->
pŞl_wa™
))

1069 
pwake
++;

1071 
	`¥š_uÆock_œq
(&
•
->
lock
);

1075 ià(
pwake
)

1076 
	`•_pŞl_§ãwake
(&
•
->
pŞl_wa™
);

1079 
	}
}

1081 
	$•_£nd_ev’ts_´oc
(
ev’Şl
 *
•
, 
li¡_h—d
 *
h—d
,

1082 *
´iv
)

1084 
•_£nd_ev’ts_d©a
 *
e£d
 = 
´iv
;

1085 
ev’tút
;

1086 
»v’ts
;

1087 
•™em
 *
•i
;

1088 
•Şl_ev’t
 
__u£r
 *
uev’t
;

1095 
ev’tút
 = 0, 
uev’t
 = 
e£d
->
ev’ts
;

1096 !
	`li¡_em±y
(
h—d
è&& 
ev’tút
 < 
e£d
->
maxev’ts
;) {

1097 
•i
 = 
	`li¡_fœ¡_’Œy
(
h—d
, 
•™em
, 
rdÎšk
);

1099 
	`li¡_d–_š™
(&
•i
->
rdÎšk
);

1101 
»v’ts
 = 
•i
->
ffd
.
fe
->
f_İ
->
	`pŞl
Ópi->ffd.fe, 
NULL
) &

1102 
•i
->
ev’t
.
ev’ts
;

1110 ià(
»v’ts
) {

1111 ià(
	`__put_u£r
(
»v’ts
, &
uev’t
->
ev’ts
) ||

1112 
	`__put_u£r
(
•i
->
ev’t
.
d©a
, &
uev’t
->data)) {

1113 
	`li¡_add
(&
•i
->
rdÎšk
, 
h—d
);

1114  
ev’tút
 ?ƒv’túˆ: -
EFAULT
;

1116 
ev’tút
++;

1117 
uev’t
++;

1118 ià(
•i
->
ev’t
.
ev’ts
 & 
EPOLLONESHOT
)

1119 
•i
->
ev’t
.
ev’ts
 &ğ
EP_PRIVATE_BITS
;

1120 ià(!(
•i
->
ev’t
.
ev’ts
 & 
EPOLLET
)) {

1132 
	`li¡_add_
(&
•i
->
rdÎšk
, &
•
->
rdÎi¡
);

1137  
ev’tút
;

1138 
	}
}

1140 
	$•_£nd_ev’ts
(
ev’Şl
 *
•
,

1141 
•Şl_ev’t
 
__u£r
 *
ev’ts
, 
maxev’ts
)

1143 
•_£nd_ev’ts_d©a
 
e£d
;

1145 
e£d
.
maxev’ts
 = maxevents;

1146 
e£d
.
ev’ts
 =ƒvents;

1148  
	`•_sÿn_»ady_li¡
(
•
, 
•_£nd_ev’ts_´oc
, &
e£d
, 0);

1149 
	}
}

1151 
šlše
 
time¥ec
 
	$•_£t_m¡imeout
(
ms
)

1153 
time¥ec
 
now
, 
ts
 = {

1154 .
tv_£c
 = 
ms
 / 
MSEC_PER_SEC
,

1155 .
tv_n£c
 = 
NSEC_PER_MSEC
 * (
ms
 % 
MSEC_PER_SEC
),

1158 
	`ktime_g‘_ts
(&
now
);

1159  
	`time¥ec_add_§ã
(
now
, 
ts
);

1160 
	}
}

1179 
	$•_pŞl
(
ev’Şl
 *
•
, 
•Şl_ev’t
 
__u£r
 *
ev’ts
,

1180 
maxev’ts
, 
timeout
)

1182 
»s
 = 0, 
—va
, 
timed_out
 = 0;

1183 
æags
;

1184 
¦ack
 = 0;

1185 
wa™_queue_t
 
wa™
;

1186 
ktime_t
 
expœes
, *
to
 = 
NULL
;

1188 ià(
timeout
 > 0) {

1189 
time¥ec
 
’d_time
 = 
	`•_£t_m¡imeout
(
timeout
);

1191 
¦ack
 = 
	`£Ëù_e¡im©e_accu¿cy
(&
’d_time
);

1192 
to
 = &
expœes
;

1193 *
to
 = 
	`time¥ec_to_ktime
(
’d_time
);

1194 } ià(
timeout
 == 0) {

1199 
timed_out
 = 1;

1200 
	`¥š_lock_œq§ve
(&
•
->
lock
, 
æags
);

1201 
check_ev’ts
;

1204 
ãtch_ev’ts
:

1205 
	`¥š_lock_œq§ve
(&
•
->
lock
, 
æags
);

1207 ià(!
	`•_ev’ts_avaabË
(
•
)) {

1213 
	`š™_wa™queue_’Œy
(&
wa™
, 
cu¼’t
);

1214 
	`__add_wa™_queue_exşusive
(&
•
->
wq
, &
wa™
);

1222 
	`£t_cu¼’t_¡©e
(
TASK_INTERRUPTIBLE
);

1223 ià(
	`•_ev’ts_avaabË
(
•
è|| 
timed_out
)

1225 ià(
	`sigÇl_³ndšg
(
cu¼’t
)) {

1226 
»s
 = -
EINTR
;

1230 
	`¥š_uÆock_œq»¡Üe
(&
•
->
lock
, 
æags
);

1231 ià(!
	`scheduË_h¹imeout_¿nge
(
to
, 
¦ack
, 
HRTIMER_MODE_ABS
))

1232 
timed_out
 = 1;

1234 
	`¥š_lock_œq§ve
(&
•
->
lock
, 
æags
);

1236 
	`__»move_wa™_queue
(&
•
->
wq
, &
wa™
);

1238 
	`£t_cu¼’t_¡©e
(
TASK_RUNNING
);

1240 
check_ev’ts
:

1242 
—va
 = 
	`•_ev’ts_avaabË
(
•
);

1244 
	`¥š_uÆock_œq»¡Üe
(&
•
->
lock
, 
æags
);

1251 ià(!
»s
 && 
—va
 &&

1252 !(
»s
 = 
	`•_£nd_ev’ts
(
•
, 
ev’ts
, 
maxev’ts
)è&& !
timed_out
)

1253 
ãtch_ev’ts
;

1255  
»s
;

1256 
	}
}

1273 
	$•_loİ_check_´oc
(*
´iv
, *
cook›
, 
ÿÎ_Ã¡s
)

1275 
”rÜ
 = 0;

1276 
fe
 *fğ
´iv
;

1277 
ev’Şl
 *
•
 = 
fe
->
´iv©e_d©a
;

1278 
rb_node
 *
rbp
;

1279 
•™em
 *
•i
;

1281 
	`mu‹x_lock_Ã¡ed
(&
•
->
mtx
, 
ÿÎ_Ã¡s
 + 1);

1282 
rbp
 = 
	`rb_fœ¡
(&
•
->
rbr
);„bp;„b°ğ
	`rb_Ãxt
(rbp)) {

1283 
•i
 = 
	`rb_’Œy
(
rbp
, 
•™em
, 
rbn
);

1284 ià(
	`uÆik–y
(
	`is_fe_•Şl
(
•i
->
ffd
.
fe
))) {

1285 
”rÜ
 = 
	`•_ÿÎ_Ã¡ed
(&
pŞl_loİ_nÿÎs
, 
EP_MAX_NESTS
,

1286 
•_loİ_check_´oc
, 
•i
->
ffd
.
fe
,

1287 
•i
->
ffd
.
fe
->
´iv©e_d©a
, 
cu¼’t
);

1288 ià(
”rÜ
 != 0)

1292 
	`mu‹x_uÆock
(&
•
->
mtx
);

1294  
”rÜ
;

1295 
	}
}

1308 
	$•_loİ_check
(
ev’Şl
 *
•
, 
fe
 *file)

1310  
	`•_ÿÎ_Ã¡ed
(&
pŞl_loİ_nÿÎs
, 
EP_MAX_NESTS
,

1311 
•_loİ_check_´oc
, 
fe
, 
•
, 
cu¼’t
);

1312 
	}
}

1317 
	$SYSCALL_DEFINE1
(
•Şl_ü—‹1
, , 
æags
)

1319 
”rÜ
;

1320 
ev’Şl
 *
•
 = 
NULL
;

1323 
	`BUILD_BUG_ON
(
EPOLL_CLOEXEC
 !ğ
O_CLOEXEC
);

1325 ià(
æags
 & ~
EPOLL_CLOEXEC
)

1326  -
EINVAL
;

1330 
”rÜ
 = 
	`•_®loc
(&
•
);

1331 ià(
”rÜ
 < 0)

1332  
”rÜ
;

1337 
”rÜ
 = 
	`ªÚ_šode_g‘fd
("[ev’Şl]", &
ev’Şl_fİs
, 
•
,

1338 
O_RDWR
 | (
æags
 & 
O_CLOEXEC
));

1339 ià(
”rÜ
 < 0)

1340 
	`•_ä“
(
•
);

1342  
”rÜ
;

1343 
	}
}

1345 
	$SYSCALL_DEFINE1
(
•Şl_ü—‹
, , 
size
)

1347 ià(
size
 <= 0)

1348  -
EINVAL
;

1350  
	`sys_•Şl_ü—‹1
(0);

1351 
	}
}

1358 
	$SYSCALL_DEFINE4
(
•Şl_ùl
, , 
•fd
, , 
İ
, , 
fd
,

1359 
•Şl_ev’t
 
__u£r
 *, 
ev’t
)

1361 
”rÜ
;

1362 
did_lock_•mu‹x
 = 0;

1363 
fe
 *fe, *
tfe
;

1364 
ev’Şl
 *
•
;

1365 
•™em
 *
•i
;

1366 
•Şl_ev’t
 
•ds
;

1368 
”rÜ
 = -
EFAULT
;

1369 ià(
	`•_İ_has_ev’t
(
İ
) &&

1370 
	`cİy_äom_u£r
(&
•ds
, 
ev’t
, (
•Şl_ev’t
)))

1371 
”rÜ_»tuº
;

1374 
”rÜ
 = -
EBADF
;

1375 
fe
 = 
	`fg‘
(
•fd
);

1376 ià(!
fe
)

1377 
”rÜ_»tuº
;

1380 
tfe
 = 
	`fg‘
(
fd
);

1381 ià(!
tfe
)

1382 
”rÜ_åut
;

1385 
”rÜ
 = -
EPERM
;

1386 ià(!
tfe
->
f_İ
 || !tfe->f_İ->
pŞl
)

1387 
”rÜ_tgt_åut
;

1394 
”rÜ
 = -
EINVAL
;

1395 ià(
fe
 =ğ
tfe
 || !
	`is_fe_•Şl
(file))

1396 
”rÜ_tgt_åut
;

1402 
•
 = 
fe
->
´iv©e_d©a
;

1414 ià(
	`uÆik–y
(
	`is_fe_•Şl
(
tfe
è&& 
İ
 =ğ
EPOLL_CTL_ADD
)) {

1415 
	`mu‹x_lock
(&
•mu‹x
);

1416 
did_lock_•mu‹x
 = 1;

1417 
”rÜ
 = -
ELOOP
;

1418 ià(
	`•_loİ_check
(
•
, 
tfe
) != 0)

1419 
”rÜ_tgt_åut
;

1423 
	`mu‹x_lock_Ã¡ed
(&
•
->
mtx
, 0);

1430 
•i
 = 
	`•_fšd
(
•
, 
tfe
, 
fd
);

1432 
”rÜ
 = -
EINVAL
;

1433 
İ
) {

1434 
EPOLL_CTL_ADD
:

1435 ià(!
•i
) {

1436 
•ds
.
ev’ts
 |ğ
POLLERR
 | 
POLLHUP
;

1437 
”rÜ
 = 
	`•_š£¹
(
•
, &
•ds
, 
tfe
, 
fd
);

1439 
”rÜ
 = -
EEXIST
;

1441 
EPOLL_CTL_DEL
:

1442 ià(
•i
)

1443 
”rÜ
 = 
	`•_»move
(
•
, 
•i
);

1445 
”rÜ
 = -
ENOENT
;

1447 
EPOLL_CTL_MOD
:

1448 ià(
•i
) {

1449 
•ds
.
ev’ts
 |ğ
POLLERR
 | 
POLLHUP
;

1450 
”rÜ
 = 
	`•_modify
(
•
, 
•i
, &
•ds
);

1452 
”rÜ
 = -
ENOENT
;

1455 
	`mu‹x_uÆock
(&
•
->
mtx
);

1457 
”rÜ_tgt_åut
:

1458 ià(
	`uÆik–y
(
did_lock_•mu‹x
))

1459 
	`mu‹x_uÆock
(&
•mu‹x
);

1461 
	`åut
(
tfe
);

1462 
”rÜ_åut
:

1463 
	`åut
(
fe
);

1464 
”rÜ_»tuº
:

1466  
”rÜ
;

1467 
	}
}

1473 
	$SYSCALL_DEFINE4
(
•Şl_wa™
, , 
•fd
, 
•Şl_ev’t
 
__u£r
 *, 
ev’ts
,

1474 , 
maxev’ts
, , 
timeout
)

1476 
”rÜ
;

1477 
fe
 *file;

1478 
ev’Şl
 *
•
;

1481 ià(
maxev’ts
 <ğ0 || maxev’t > 
EP_MAX_EVENTS
)

1482  -
EINVAL
;

1485 ià(!
	`acûss_ok
(
VERIFY_WRITE
, 
ev’ts
, 
maxev’ts
 * (
•Şl_ev’t
))) {

1486 
”rÜ
 = -
EFAULT
;

1487 
”rÜ_»tuº
;

1491 
”rÜ
 = -
EBADF
;

1492 
fe
 = 
	`fg‘
(
•fd
);

1493 ià(!
fe
)

1494 
”rÜ_»tuº
;

1500 
”rÜ
 = -
EINVAL
;

1501 ià(!
	`is_fe_•Şl
(
fe
))

1502 
”rÜ_åut
;

1508 
•
 = 
fe
->
´iv©e_d©a
;

1511 
”rÜ
 = 
	`•_pŞl
(
•
, 
ev’ts
, 
maxev’ts
, 
timeout
);

1513 
”rÜ_åut
:

1514 
	`åut
(
fe
);

1515 
”rÜ_»tuº
:

1517  
”rÜ
;

1518 
	}
}

1520 #ifdeà
HAVE_SET_RESTORE_SIGMASK


1526 
	$SYSCALL_DEFINE6
(
•Şl_pwa™
, , 
•fd
, 
•Şl_ev’t
 
__u£r
 *, 
ev’ts
,

1527 , 
maxev’ts
, , 
timeout
, cÚ¡ 
sig£t_t
 
__u£r
 *, 
sigmask
,

1528 
size_t
, 
sig£tsize
)

1530 
”rÜ
;

1531 
sig£t_t
 
ksigmask
, 
sig§ved
;

1537 ià(
sigmask
) {

1538 ià(
sig£tsize
 !ğ(
sig£t_t
))

1539  -
EINVAL
;

1540 ià(
	`cİy_äom_u£r
(&
ksigmask
, 
sigmask
, (ksigmask)))

1541  -
EFAULT
;

1542 
	`sigd–£tmask
(&
ksigmask
, 
	`sigmask
(
SIGKILL
è| sigmask(
SIGSTOP
));

1543 
	`sig´ocmask
(
SIG_SETMASK
, &
ksigmask
, &
sig§ved
);

1546 
”rÜ
 = 
	`sys_•Şl_wa™
(
•fd
, 
ev’ts
, 
maxev’ts
, 
timeout
);

1554 ià(
sigmask
) {

1555 ià(
”rÜ
 =ğ-
EINTR
) {

1556 
	`memıy
(&
cu¼’t
->
§ved_sigmask
, &
sig§ved
,

1557 (
sig§ved
));

1558 
	`£t_»¡Üe_sigmask
();

1560 
	`sig´ocmask
(
SIG_SETMASK
, &
sig§ved
, 
NULL
);

1563  
”rÜ
;

1564 
	}
}

1568 
__š™
 
	$ev’Şl_š™
()

1570 
sysšfo
 
si
;

1572 
	`si_memšfo
(&
si
);

1576 
max_u£r_w©ches
 = (((
si
.
tÙ®¿m
 - si.
tÙ®high
è/ 25è<< 
PAGE_SHIFT
) /

1577 
EP_ITEM_COST
;

1578 
	`BUG_ON
(
max_u£r_w©ches
 < 0);

1584 
	`•_Ã¡ed_ÿÎs_š™
(&
pŞl_loİ_nÿÎs
);

1587 
	`•_Ã¡ed_ÿÎs_š™
(&
pŞl_§ãwake_nÿÎs
);

1590 
	`•_Ã¡ed_ÿÎs_š™
(&
pŞl_»adyw®k_nÿÎs
);

1593 
•i_ÿche
 = 
	`kmem_ÿche_ü—‹
("ev’Şl_•i", (
•™em
),

1594 0, 
SLAB_HWCACHE_ALIGN
 | 
SLAB_PANIC
, 
NULL
);

1597 
pwq_ÿche
 = 
	`kmem_ÿche_ü—‹
("eventpoll_pwq",

1598 (
•pŞl_’Œy
), 0, 
SLAB_PANIC
, 
NULL
);

1601 
	}
}

1602 
fs_š™ÿÎ
(
ev’Şl_š™
);

	@exec.c

25 
	~<lšux/¦ab.h
>

26 
	~<lšux/fe.h
>

27 
	~<lšux/fdbË.h
>

28 
	~<lšux/mm.h
>

29 
	~<lšux/¡©.h
>

30 
	~<lšux/fú.h
>

31 
	~<lšux/sw­.h
>

32 
	~<lšux/¡ršg.h
>

33 
	~<lšux/š™.h
>

34 
	~<lšux/·gem­.h
>

35 
	~<lšux/³rf_ev’t.h
>

36 
	~<lšux/highmem.h
>

37 
	~<lšux/¥šlock.h
>

38 
	~<lšux/key.h
>

39 
	~<lšux/³rsÚ®™y.h
>

40 
	~<lšux/bšfmts.h
>

41 
	~<lšux/ut¢ame.h
>

42 
	~<lšux/pid_Çme¥aû.h
>

43 
	~<lšux/moduË.h
>

44 
	~<lšux/Çmei.h
>

45 
	~<lšux/mouÁ.h
>

46 
	~<lšux/£cur™y.h
>

47 
	~<lšux/sysÿÎs.h
>

48 
	~<lšux/t§cù_k”n.h
>

49 
	~<lšux/ú_´oc.h
>

50 
	~<lšux/aud™.h
>

51 
	~<lšux/Œaûhook.h
>

52 
	~<lšux/kmod.h
>

53 
	~<lšux/f¢Ùify.h
>

54 
	~<lšux/fs_¡ruù.h
>

55 
	~<lšux/pe_fs_i.h
>

56 
	~<lšux/oom.h
>

57 
	~<lšux/com·t.h
>

59 
	~<asm/uacûss.h
>

60 
	~<asm/mmu_cÚ‹xt.h
>

61 
	~<asm/b.h
>

62 
	~"š‹º®.h
"

64 
	gcÜe_u£s_pid
;

65 
	gcÜe_·‰”n
[
CORENAME_MAX_SIZE
] = "core";

66 
	gcÜe_pe_lim™
;

67 
	gsuid_dum·bË
 = 0;

69 
	scÜe_Çme
 {

70 *
	mcÜ’ame
;

71 
	mu£d
, 
	msize
;

73 
©omic_t
 
	gÿÎ_couÁ
 = 
ATOMIC_INIT
(1);

77 
LIST_HEAD
(
fÜm©s
);

78 
DEFINE_RWLOCK
(
bšfmt_lock
);

80 
	$__»gi¡”_bšfmt
(
lšux_bšfmt
 * 
fmt
, 
š£¹
)

82 ià(!
fmt
)

83  -
EINVAL
;

84 
	`wr™e_lock
(&
bšfmt_lock
);

85 
š£¹
 ? 
	`li¡_add
(&
fmt
->
lh
, &
fÜm©s
) :

86 
	`li¡_add_
(&
fmt
->
lh
, &
fÜm©s
);

87 
	`wr™e_uÆock
(&
bšfmt_lock
);

89 
	}
}

91 
EXPORT_SYMBOL
(
__»gi¡”_bšfmt
);

93 
	$uÄegi¡”_bšfmt
(
lšux_bšfmt
 * 
fmt
)

95 
	`wr™e_lock
(&
bšfmt_lock
);

96 
	`li¡_d–
(&
fmt
->
lh
);

97 
	`wr™e_uÆock
(&
bšfmt_lock
);

98 
	}
}

100 
EXPORT_SYMBOL
(
uÄegi¡”_bšfmt
);

102 
šlše
 
	$put_bšfmt
(
lšux_bšfmt
 * 
fmt
)

104 
	`moduË_put
(
fmt
->
moduË
);

105 
	}
}

113 
	$SYSCALL_DEFINE1
(
u£lib
, cÚ¡ 
__u£r
 *, 
lib¿ry
)

115 
fe
 *file;

116 *
tmp
 = 
	`g‘Çme
(
lib¿ry
);

117 
”rÜ
 = 
	`PTR_ERR
(
tmp
);

118 cÚ¡ 
İ’_æags
 
u£lib_æags
 = {

119 .
İ’_æag
 = 
O_LARGEFILE
 | 
O_RDONLY
 | 
__FMODE_EXEC
,

120 .
acc_mode
 = 
MAY_READ
 | 
MAY_EXEC
 | 
MAY_OPEN
,

121 .
š‹Á
 = 
LOOKUP_OPEN


124 ià(
	`IS_ERR
(
tmp
))

125 
out
;

127 
fe
 = 
	`do_fp_İ’
(
AT_FDCWD
, 
tmp
, &
u£lib_æags
, 
LOOKUP_FOLLOW
);

128 
	`puŠame
(
tmp
);

129 
”rÜ
 = 
	`PTR_ERR
(
fe
);

130 ià(
	`IS_ERR
(
fe
))

131 
out
;

133 
”rÜ
 = -
EINVAL
;

134 ià(!
	`S_ISREG
(
fe
->
f_·th
.
d’Œy
->
d_šode
->
i_mode
))

135 
ex™
;

137 
”rÜ
 = -
EACCES
;

138 ià(
fe
->
f_·th
.
mÁ
->
mÁ_æags
 & 
MNT_NOEXEC
)

139 
ex™
;

141 
	`f¢Ùify_İ’
(
fe
);

143 
”rÜ
 = -
ENOEXEC
;

144 if(
fe
->
f_İ
) {

145 
lšux_bšfmt
 * 
fmt
;

147 
	`»ad_lock
(&
bšfmt_lock
);

148 
	`li¡_fÜ_—ch_’Œy
(
fmt
, &
fÜm©s
, 
lh
) {

149 ià(!
fmt
->
lßd_shlib
)

151 ià(!
	`Œy_moduË_g‘
(
fmt
->
moduË
))

153 
	`»ad_uÆock
(&
bšfmt_lock
);

154 
”rÜ
 = 
fmt
->
	`lßd_shlib
(
fe
);

155 
	`»ad_lock
(&
bšfmt_lock
);

156 
	`put_bšfmt
(
fmt
);

157 ià(
”rÜ
 !ğ-
ENOEXEC
)

160 
	`»ad_uÆock
(&
bšfmt_lock
);

162 
ex™
:

163 
	`åut
(
fe
);

164 
out
:

165  
”rÜ
;

166 
	}
}

168 #ifdeà
CONFIG_MMU


175 
	$acù_¬g_size
(
lšux_bš´m
 *
b´m
, 
·ges
)

177 
mm_¡ruù
 *
mm
 = 
cu¼’t
->mm;

178 
diff
 = ()(
·ges
 - 
b´m
->
vma_·ges
);

180 ià(!
mm
 || !
diff
)

183 
b´m
->
vma_·ges
 = 
·ges
;

184 
	`add_mm_couÁ”
(
mm
, 
MM_ANONPAGES
, 
diff
);

185 
	}
}

187 
·ge
 *
	$g‘_¬g_·ge
(
lšux_bš´m
 *
b´m
, 
pos
,

188 
wr™e
)

190 
·ge
 *page;

191 
»t
;

193 #ifdeà
CONFIG_STACK_GROWSUP


194 ià(
wr™e
) {

195 
»t
 = 
	`ex·nd_downw¬ds
(
b´m
->
vma
, 
pos
);

196 ià(
»t
 < 0)

197  
NULL
;

200 
»t
 = 
	`g‘_u£r_·ges
(
cu¼’t
, 
b´m
->
mm
, 
pos
,

201 1, 
wr™e
, 1, &
·ge
, 
NULL
);

202 ià(
»t
 <= 0)

203  
NULL
;

205 ià(
wr™e
) {

206 
size
 = 
b´m
->
vma
->
vm_’d
 - b´m->vma->
vm_¡¬t
;

207 
¾im™
 *
¾im
;

209 
	`acù_¬g_size
(
b´m
, 
size
 / 
PAGE_SIZE
);

215 ià(
size
 <ğ
ARG_MAX
)

216  
·ge
;

225 
¾im
 = 
cu¼’t
->
sigÇl
->rlim;

226 ià(
size
 > 
	`ACCESS_ONCE
(
¾im
[
RLIMIT_STACK
].
¾im_cur
) / 4) {

227 
	`put_·ge
(
·ge
);

228  
NULL
;

232  
·ge
;

233 
	}
}

235 
	$put_¬g_·ge
(
·ge
 *page)

237 
	`put_·ge
(
·ge
);

238 
	}
}

240 
	$ä“_¬g_·ge
(
lšux_bš´m
 *
b´m
, 
i
)

242 
	}
}

244 
	$ä“_¬g_·ges
(
lšux_bš´m
 *
b´m
)

246 
	}
}

248 
	$æush_¬g_·ge
(
lšux_bš´m
 *
b´m
, 
pos
,

249 
·ge
 *page)

251 
	`æush_ÿche_·ge
(
b´m
->
vma
, 
pos
, 
	`·ge_to_pâ
(
·ge
));

252 
	}
}

254 
	$__b´m_mm_š™
(
lšux_bš´m
 *
b´m
)

256 
”r
;

257 
vm_¬—_¡ruù
 *
vma
 = 
NULL
;

258 
mm_¡ruù
 *
mm
 = 
b´m
->mm;

260 
b´m
->
vma
 = vm¨ğ
	`kmem_ÿche_z®loc
(
vm_¬—_ÿch•
, 
GFP_KERNEL
);

261 ià(!
vma
)

262  -
ENOMEM
;

264 
	`down_wr™e
(&
mm
->
mm­_£m
);

265 
vma
->
vm_mm
 = 
mm
;

273 
	`BUILD_BUG_ON
(
VM_STACK_FLAGS
 & 
VM_STACK_INCOMPLETE_SETUP
);

274 
vma
->
vm_’d
 = 
STACK_TOP_MAX
;

275 
vma
->
vm_¡¬t
 = vma->
vm_’d
 - 
PAGE_SIZE
;

276 
vma
->
vm_æags
 = 
VM_STACK_FLAGS
 | 
VM_STACK_INCOMPLETE_SETUP
;

277 
vma
->
vm_·ge_´Ù
 = 
	`vm_g‘_·ge_´Ù
(vma->
vm_æags
);

278 
	`INIT_LIST_HEAD
(&
vma
->
ªÚ_vma_chaš
);

280 
”r
 = 
	`£cur™y_fe_mm­
(
NULL
, 0, 0, 0, 
vma
->
vm_¡¬t
, 1);

281 ià(
”r
)

282 
”r
;

284 
”r
 = 
	`š£¹_vm_¡ruù
(
mm
, 
vma
);

285 ià(
”r
)

286 
”r
;

288 
mm
->
¡ack_vm
 = mm->
tÙ®_vm
 = 1;

289 
	`up_wr™e
(&
mm
->
mm­_£m
);

290 
b´m
->
p
 = 
vma
->
vm_’d
 - (*);

292 
”r
:

293 
	`up_wr™e
(&
mm
->
mm­_£m
);

294 
b´m
->
vma
 = 
NULL
;

295 
	`kmem_ÿche_ä“
(
vm_¬—_ÿch•
, 
vma
);

296  
”r
;

297 
	}
}

299 
boŞ
 
	$v®id_¬g_Ën
(
lšux_bš´m
 *
b´m
, 
Ën
)

301  
Ën
 <ğ
MAX_ARG_STRLEN
;

302 
	}
}

306 
šlše
 
	$acù_¬g_size
(
lšux_bš´m
 *
b´m
, 
·ges
)

308 
	}
}

310 
·ge
 *
	$g‘_¬g_·ge
(
lšux_bš´m
 *
b´m
, 
pos
,

311 
wr™e
)

313 
·ge
 *page;

315 
·ge
 = 
b´m
->·ge[
pos
 / 
PAGE_SIZE
];

316 ià(!
·ge
 && 
wr™e
) {

317 
·ge
 = 
	`®loc_·ge
(
GFP_HIGHUSER
|
__GFP_ZERO
);

318 ià(!
·ge
)

319  
NULL
;

320 
b´m
->
·ge
[
pos
 / 
PAGE_SIZE
] =…age;

323  
·ge
;

324 
	}
}

326 
	$put_¬g_·ge
(
·ge
 *page)

328 
	}
}

330 
	$ä“_¬g_·ge
(
lšux_bš´m
 *
b´m
, 
i
)

332 ià(
b´m
->
·ge
[
i
]) {

333 
	`__ä“_·ge
(
b´m
->
·ge
[
i
]);

334 
b´m
->
·ge
[
i
] = 
NULL
;

336 
	}
}

338 
	$ä“_¬g_·ges
(
lšux_bš´m
 *
b´m
)

340 
i
;

342 
i
 = 0; i < 
MAX_ARG_PAGES
; i++)

343 
	`ä“_¬g_·ge
(
b´m
, 
i
);

344 
	}
}

346 
	$æush_¬g_·ge
(
lšux_bš´m
 *
b´m
, 
pos
,

347 
·ge
 *page)

349 
	}
}

351 
	$__b´m_mm_š™
(
lšux_bš´m
 *
b´m
)

353 
b´m
->
p
 = 
PAGE_SIZE
 * 
MAX_ARG_PAGES
 - (*);

355 
	}
}

357 
boŞ
 
	$v®id_¬g_Ën
(
lšux_bš´m
 *
b´m
, 
Ën
)

359  
Ën
 <ğ
b´m
->
p
;

360 
	}
}

370 
	$b´m_mm_š™
(
lšux_bš´m
 *
b´m
)

372 
”r
;

373 
mm_¡ruù
 *
mm
 = 
NULL
;

375 
b´m
->
mm
 = mm = 
	`mm_®loc
();

376 
”r
 = -
ENOMEM
;

377 ià(!
mm
)

378 
”r
;

380 
”r
 = 
	`š™_Ãw_cÚ‹xt
(
cu¼’t
, 
mm
);

381 ià(
”r
)

382 
”r
;

384 
”r
 = 
	`__b´m_mm_š™
(
b´m
);

385 ià(
”r
)

386 
”r
;

390 
”r
:

391 ià(
mm
) {

392 
b´m
->
mm
 = 
NULL
;

393 
	`mmdrİ
(
mm
);

396  
”r
;

397 
	}
}

399 
	su£r_¬g_±r
 {

400 #ifdeà
CONFIG_COMPAT


401 
boŞ
 
	mis_com·t
;

404 cÚ¡ 
__u£r
 *cÚ¡ __u£¸*
	mÇtive
;

405 #ifdeà
CONFIG_COMPAT


406 
com·t_u±r_t
 
__u£r
 *
	mcom·t
;

408 } 
	m±r
;

411 cÚ¡ 
__u£r
 *
	$g‘_u£r_¬g_±r
(
u£r_¬g_±r
 
¬gv
, 
Ä
)

413 cÚ¡ 
__u£r
 *
Çtive
;

415 #ifdeà
CONFIG_COMPAT


416 ià(
	`uÆik–y
(
¬gv
.
is_com·t
)) {

417 
com·t_u±r_t
 
com·t
;

419 ià(
	`g‘_u£r
(
com·t
, 
¬gv
.
±r
.com·ˆ+ 
Ä
))

420  
	`ERR_PTR
(-
EFAULT
);

422  
	`com·t_±r
(
com·t
);

426 ià(
	`g‘_u£r
(
Çtive
, 
¬gv
.
±r
.Çtiv+ 
Ä
))

427  
	`ERR_PTR
(-
EFAULT
);

429  
Çtive
;

430 
	}
}

435 
	$couÁ
(
u£r_¬g_±r
 
¬gv
, 
max
)

437 
i
 = 0;

439 ià(
¬gv
.
±r
.
Çtive
 !ğ
NULL
) {

441 cÚ¡ 
__u£r
 *
p
 = 
	`g‘_u£r_¬g_±r
(
¬gv
, 
i
);

443 ià(!
p
)

446 ià(
	`IS_ERR
(
p
))

447  -
EFAULT
;

449 ià(
i
++ >ğ
max
)

450  -
E2BIG
;

452 ià(
	`çl_sigÇl_³ndšg
(
cu¼’t
))

453  -
ERESTARTNOHAND
;

454 
	`cÚd_»sched
();

457  
i
;

458 
	}
}

465 
	$cİy_¡ršgs
(
¬gc
, 
u£r_¬g_±r
 
¬gv
,

466 
lšux_bš´m
 *
b´m
)

468 
·ge
 *
km­³d_·ge
 = 
NULL
;

469 *
kaddr
 = 
NULL
;

470 
kpos
 = 0;

471 
»t
;

473 
¬gc
-- > 0) {

474 cÚ¡ 
__u£r
 *
¡r
;

475 
Ën
;

476 
pos
;

478 
»t
 = -
EFAULT
;

479 
¡r
 = 
	`g‘_u£r_¬g_±r
(
¬gv
, 
¬gc
);

480 ià(
	`IS_ERR
(
¡r
))

481 
out
;

483 
Ën
 = 
	`¡ºËn_u£r
(
¡r
, 
MAX_ARG_STRLEN
);

484 ià(!
Ën
)

485 
out
;

487 
»t
 = -
E2BIG
;

488 ià(!
	`v®id_¬g_Ën
(
b´m
, 
Ën
))

489 
out
;

492 
pos
 = 
b´m
->
p
;

493 
¡r
 +ğ
Ën
;

494 
b´m
->
p
 -ğ
Ën
;

496 
Ën
 > 0) {

497 
off£t
, 
by‹s_to_cİy
;

499 ià(
	`çl_sigÇl_³ndšg
(
cu¼’t
)) {

500 
»t
 = -
ERESTARTNOHAND
;

501 
out
;

503 
	`cÚd_»sched
();

505 
off£t
 = 
pos
 % 
PAGE_SIZE
;

506 ià(
off£t
 == 0)

507 
off£t
 = 
PAGE_SIZE
;

509 
by‹s_to_cİy
 = 
off£t
;

510 ià(
by‹s_to_cİy
 > 
Ën
)

511 
by‹s_to_cİy
 = 
Ën
;

513 
off£t
 -ğ
by‹s_to_cİy
;

514 
pos
 -ğ
by‹s_to_cİy
;

515 
¡r
 -ğ
by‹s_to_cİy
;

516 
Ën
 -ğ
by‹s_to_cİy
;

518 ià(!
km­³d_·ge
 || 
kpos
 !ğ(
pos
 & 
PAGE_MASK
)) {

519 
·ge
 *page;

521 
·ge
 = 
	`g‘_¬g_·ge
(
b´m
, 
pos
, 1);

522 ià(!
·ge
) {

523 
»t
 = -
E2BIG
;

524 
out
;

527 ià(
km­³d_·ge
) {

528 
	`æush_k”Ãl_dÿche_·ge
(
km­³d_·ge
);

529 
	`kunm­
(
km­³d_·ge
);

530 
	`put_¬g_·ge
(
km­³d_·ge
);

532 
km­³d_·ge
 = 
·ge
;

533 
kaddr
 = 
	`km­
(
km­³d_·ge
);

534 
kpos
 = 
pos
 & 
PAGE_MASK
;

535 
	`æush_¬g_·ge
(
b´m
, 
kpos
, 
km­³d_·ge
);

537 ià(
	`cİy_äom_u£r
(
kaddr
+
off£t
, 
¡r
, 
by‹s_to_cİy
)) {

538 
»t
 = -
EFAULT
;

539 
out
;

543 
»t
 = 0;

544 
out
:

545 ià(
km­³d_·ge
) {

546 
	`æush_k”Ãl_dÿche_·ge
(
km­³d_·ge
);

547 
	`kunm­
(
km­³d_·ge
);

548 
	`put_¬g_·ge
(
km­³d_·ge
);

550  
»t
;

551 
	}
}

556 
	$cİy_¡ršgs_k”Ãl
(
¬gc
, cÚ¡ *cÚ¡ *
__¬gv
,

557 
lšux_bš´m
 *
b´m
)

559 
r
;

560 
mm_£gm’t_t
 
Şdfs
 = 
	`g‘_fs
();

561 
u£r_¬g_±r
 
¬gv
 = {

562 .
±r
.
Çtive
 = (cÚ¡ 
__u£r
 *cÚ¡ __u£¸*)
__¬gv
,

565 
	`£t_fs
(
KERNEL_DS
);

566 
r
 = 
	`cİy_¡ršgs
(
¬gc
, 
¬gv
, 
b´m
);

567 
	`£t_fs
(
Şdfs
);

569  
r
;

570 
	}
}

571 
EXPORT_SYMBOL
(
cİy_¡ršgs_k”Ãl
);

573 #ifdeà
CONFIG_MMU


587 
	$shiá_¬g_·ges
(
vm_¬—_¡ruù
 *
vma
, 
shiá
)

589 
mm_¡ruù
 *
mm
 = 
vma
->
vm_mm
;

590 
Şd_¡¬t
 = 
vma
->
vm_¡¬t
;

591 
Şd_’d
 = 
vma
->
vm_’d
;

592 
Ëngth
 = 
Şd_’d
 - 
Şd_¡¬t
;

593 
Ãw_¡¬t
 = 
Şd_¡¬t
 - 
shiá
;

594 
Ãw_’d
 = 
Şd_’d
 - 
shiá
;

595 
mmu_g©h”
 
b
;

597 
	`BUG_ON
(
Ãw_¡¬t
 > 
Ãw_’d
);

603 ià(
vma
 !ğ
	`fšd_vma
(
mm
, 
Ãw_¡¬t
))

604  -
EFAULT
;

609 ià(
	`vma_adju¡
(
vma
, 
Ãw_¡¬t
, 
Şd_’d
, vma->
vm_pgoff
, 
NULL
))

610  -
ENOMEM
;

616 ià(
Ëngth
 !ğ
	`move_·ge_bËs
(
vma
, 
Şd_¡¬t
,

617 
vma
, 
Ãw_¡¬t
, 
Ëngth
))

618  -
ENOMEM
;

620 
	`Ìu_add_d¿š
();

621 
	`b_g©h”_mmu
(&
b
, 
mm
, 0);

622 ià(
Ãw_’d
 > 
Şd_¡¬t
) {

626 
	`ä“_pgd_¿nge
(&
b
, 
Ãw_’d
, 
Şd_’d
,‚ew_end,

627 
vma
->
vm_Ãxt
 ? vma->vm_Ãxt->
vm_¡¬t
 : 0);

635 
	`ä“_pgd_¿nge
(&
b
, 
Şd_¡¬t
, 
Şd_’d
, 
Ãw_’d
,

636 
vma
->
vm_Ãxt
 ? vma->vm_Ãxt->
vm_¡¬t
 : 0);

638 
	`b_fšish_mmu
(&
b
, 
Ãw_’d
, 
Şd_’d
);

643 
	`vma_adju¡
(
vma
, 
Ãw_¡¬t
, 
Ãw_’d
, vma->
vm_pgoff
, 
NULL
);

646 
	}
}

652 
	$£tup_¬g_·ges
(
lšux_bš´m
 *
b´m
,

653 
¡ack_tİ
,

654 
execubË_¡ack
)

656 
»t
;

657 
¡ack_shiá
;

658 
mm_¡ruù
 *
mm
 = 
cu¼’t
->mm;

659 
vm_¬—_¡ruù
 *
vma
 = 
b´m
->vma;

660 
vm_¬—_¡ruù
 *
´ev
 = 
NULL
;

661 
vm_æags
;

662 
¡ack_ba£
;

663 
¡ack_size
;

664 
¡ack_ex·nd
;

665 
¾im_¡ack
;

667 #ifdeà
CONFIG_STACK_GROWSUP


669 
¡ack_ba£
 = 
	`¾im™_max
(
RLIMIT_STACK
);

670 ià(
¡ack_ba£
 > (1 << 30))

671 
¡ack_ba£
 = 1 << 30;

674 ià(
vma
->
vm_’d
 - vma->
vm_¡¬t
 > 
¡ack_ba£
)

675  -
ENOMEM
;

677 
¡ack_ba£
 = 
	`PAGE_ALIGN
(
¡ack_tİ
 - stack_base);

679 
¡ack_shiá
 = 
vma
->
vm_¡¬t
 - 
¡ack_ba£
;

680 
mm
->
¬g_¡¬t
 = 
b´m
->
p
 - 
¡ack_shiá
;

681 
b´m
->
p
 = 
vma
->
vm_’d
 - 
¡ack_shiá
;

683 
¡ack_tİ
 = 
	`¬ch_®ign_¡ack
(stack_top);

684 
¡ack_tİ
 = 
	`PAGE_ALIGN
(stack_top);

686 ià(
	`uÆik–y
(
¡ack_tİ
 < 
mm­_mš_addr
) ||

687 
	`uÆik–y
(
vma
->
vm_’d
 - vma->
vm_¡¬t
 >ğ
¡ack_tİ
 - 
mm­_mš_addr
))

688  -
ENOMEM
;

690 
¡ack_shiá
 = 
vma
->
vm_’d
 - 
¡ack_tİ
;

692 
b´m
->
p
 -ğ
¡ack_shiá
;

693 
mm
->
¬g_¡¬t
 = 
b´m
->
p
;

696 ià(
b´m
->
lßd”
)

697 
b´m
->
lßd”
 -ğ
¡ack_shiá
;

698 
b´m
->
exec
 -ğ
¡ack_shiá
;

700 
	`down_wr™e
(&
mm
->
mm­_£m
);

701 
vm_æags
 = 
VM_STACK_FLAGS
;

708 ià(
	`uÆik–y
(
execubË_¡ack
 =ğ
EXSTACK_ENABLE_X
))

709 
vm_æags
 |ğ
VM_EXEC
;

710 ià(
execubË_¡ack
 =ğ
EXSTACK_DISABLE_X
)

711 
vm_æags
 &ğ~
VM_EXEC
;

712 
vm_æags
 |ğ
mm
->
def_æags
;

713 
vm_æags
 |ğ
VM_STACK_INCOMPLETE_SETUP
;

715 
»t
 = 
	`m´Ùeù_fixup
(
vma
, &
´ev
, vma->
vm_¡¬t
, vma->
vm_’d
,

716 
vm_æags
);

717 ià(
»t
)

718 
out_uÆock
;

719 
	`BUG_ON
(
´ev
 !ğ
vma
);

722 ià(
¡ack_shiá
) {

723 
»t
 = 
	`shiá_¬g_·ges
(
vma
, 
¡ack_shiá
);

724 ià(
»t
)

725 
out_uÆock
;

729 
vma
->
vm_æags
 &ğ~
VM_STACK_INCOMPLETE_SETUP
;

731 
¡ack_ex·nd
 = 131072UL;

732 
¡ack_size
 = 
vma
->
vm_’d
 - vma->
vm_¡¬t
;

737 
¾im_¡ack
 = 
	`¾im™
(
RLIMIT_STACK
è& 
PAGE_MASK
;

738 #ifdeà
CONFIG_STACK_GROWSUP


739 ià(
¡ack_size
 + 
¡ack_ex·nd
 > 
¾im_¡ack
)

740 
¡ack_ba£
 = 
vma
->
vm_¡¬t
 + 
¾im_¡ack
;

742 
¡ack_ba£
 = 
vma
->
vm_’d
 + 
¡ack_ex·nd
;

744 ià(
¡ack_size
 + 
¡ack_ex·nd
 > 
¾im_¡ack
)

745 
¡ack_ba£
 = 
vma
->
vm_’d
 - 
¾im_¡ack
;

747 
¡ack_ba£
 = 
vma
->
vm_¡¬t
 - 
¡ack_ex·nd
;

749 
cu¼’t
->
mm
->
¡¬t_¡ack
 = 
b´m
->
p
;

750 
»t
 = 
	`ex·nd_¡ack
(
vma
, 
¡ack_ba£
);

751 ià(
»t
)

752 
»t
 = -
EFAULT
;

754 
out_uÆock
:

755 
	`up_wr™e
(&
mm
->
mm­_£m
);

756  
»t
;

757 
	}
}

758 
EXPORT_SYMBOL
(
£tup_¬g_·ges
);

762 
fe
 *
	$İ’_exec
(cÚ¡ *
Çme
)

764 
fe
 *file;

765 
”r
;

766 cÚ¡ 
İ’_æags
 
İ’_exec_æags
 = {

767 .
İ’_æag
 = 
O_LARGEFILE
 | 
O_RDONLY
 | 
__FMODE_EXEC
,

768 .
acc_mode
 = 
MAY_EXEC
 | 
MAY_OPEN
,

769 .
š‹Á
 = 
LOOKUP_OPEN


772 
fe
 = 
	`do_fp_İ’
(
AT_FDCWD
, 
Çme
, &
İ’_exec_æags
, 
LOOKUP_FOLLOW
);

773 ià(
	`IS_ERR
(
fe
))

774 
out
;

776 
”r
 = -
EACCES
;

777 ià(!
	`S_ISREG
(
fe
->
f_·th
.
d’Œy
->
d_šode
->
i_mode
))

778 
ex™
;

780 ià(
fe
->
f_·th
.
mÁ
->
mÁ_æags
 & 
MNT_NOEXEC
)

781 
ex™
;

783 
	`f¢Ùify_İ’
(
fe
);

785 
”r
 = 
	`d’y_wr™e_acûss
(
fe
);

786 ià(
”r
)

787 
ex™
;

789 
out
:

790  
fe
;

792 
ex™
:

793 
	`åut
(
fe
);

794  
	`ERR_PTR
(
”r
);

795 
	}
}

796 
EXPORT_SYMBOL
(
İ’_exec
);

798 
	$k”Ãl_»ad
(
fe
 *fe, 
loff_t
 
off£t
,

799 *
addr
, 
couÁ
)

801 
mm_£gm’t_t
 
Şd_fs
;

802 
loff_t
 
pos
 = 
off£t
;

803 
»suÉ
;

805 
Şd_fs
 = 
	`g‘_fs
();

806 
	`£t_fs
(
	`g‘_ds
());

808 
»suÉ
 = 
	`vfs_»ad
(
fe
, (
__u£r
 *)
addr
, 
couÁ
, &
pos
);

809 
	`£t_fs
(
Şd_fs
);

810  
»suÉ
;

811 
	}
}

813 
EXPORT_SYMBOL
(
k”Ãl_»ad
);

815 
	$exec_mm­
(
mm_¡ruù
 *
mm
)

817 
sk_¡ruù
 *
tsk
;

818 
mm_¡ruù
 * 
Şd_mm
, *
aùive_mm
;

821 
tsk
 = 
cu¼’t
;

822 
Şd_mm
 = 
cu¼’t
->
mm
;

823 
	`sync_mm_rss
(
tsk
, 
Şd_mm
);

824 
	`mm_»Ëa£
(
tsk
, 
Şd_mm
);

826 ià(
Şd_mm
) {

833 
	`down_»ad
(&
Şd_mm
->
mm­_£m
);

834 ià(
	`uÆik–y
(
Şd_mm
->
cÜe_¡©e
)) {

835 
	`up_»ad
(&
Şd_mm
->
mm­_£m
);

836  -
EINTR
;

839 
	`sk_lock
(
tsk
);

840 
aùive_mm
 = 
tsk
->active_mm;

841 
tsk
->
mm
 = mm;

842 
tsk
->
aùive_mm
 = 
mm
;

843 
	`aùiv©e_mm
(
aùive_mm
, 
mm
);

844 
	`sk_uÆock
(
tsk
);

845 
	`¬ch_pick_mm­_Ïyout
(
mm
);

846 ià(
Şd_mm
) {

847 
	`up_»ad
(&
Şd_mm
->
mm­_£m
);

848 
	`BUG_ON
(
aùive_mm
 !ğ
Şd_mm
);

849 
	`mm_upd©e_Ãxt_owÃr
(
Şd_mm
);

850 
	`mmput
(
Şd_mm
);

853 
	`mmdrİ
(
aùive_mm
);

855 
	}
}

863 
	$de_th»ad
(
sk_¡ruù
 *
tsk
)

865 
sigÇl_¡ruù
 *
sig
 = 
tsk
->
sigÇl
;

866 
sighªd_¡ruù
 *
Şdsighªd
 = 
tsk
->
sighªd
;

867 
¥šlock_t
 *
lock
 = &
Şdsighªd
->
siglock
;

869 ià(
	`th»ad_group_em±y
(
tsk
))

870 
no_th»ad_group
;

875 
	`¥š_lock_œq
(
lock
);

876 ià(
	`sigÇl_group_ex™
(
sig
)) {

881 
	`¥š_uÆock_œq
(
lock
);

882  -
EAGAIN
;

885 
sig
->
group_ex™_sk
 = 
tsk
;

886 
sig
->
nÙify_couÁ
 = 
	`z­_Ùh”_th»ads
(
tsk
);

887 ià(!
	`th»ad_group_Ëad”
(
tsk
))

888 
sig
->
nÙify_couÁ
--;

890 
sig
->
nÙify_couÁ
) {

891 
	`__£t_cu¼’t_¡©e
(
TASK_UNINTERRUPTIBLE
);

892 
	`¥š_uÆock_œq
(
lock
);

893 
	`scheduË
();

894 
	`¥š_lock_œq
(
lock
);

896 
	`¥š_uÆock_œq
(
lock
);

903 ià(!
	`th»ad_group_Ëad”
(
tsk
)) {

904 
sk_¡ruù
 *
Ëad”
 = 
tsk
->
group_Ëad”
;

906 
sig
->
nÙify_couÁ
 = -1;

908 
	`wr™e_lock_œq
(&
skli¡_lock
);

909 ià(
	`lik–y
(
Ëad”
->
ex™_¡©e
))

911 
	`__£t_cu¼’t_¡©e
(
TASK_UNINTERRUPTIBLE
);

912 
	`wr™e_uÆock_œq
(&
skli¡_lock
);

913 
	`scheduË
();

926 
tsk
->
¡¬t_time
 = 
Ëad”
->start_time;

928 
	`BUG_ON
(!
	`§me_th»ad_group
(
Ëad”
, 
tsk
));

929 
	`BUG_ON
(
	`has_group_Ëad”_pid
(
tsk
));

942 
	`d‘ach_pid
(
tsk
, 
PIDTYPE_PID
);

943 
tsk
->
pid
 = 
Ëad”
->pid;

944 
	`©ch_pid
(
tsk
, 
PIDTYPE_PID
, 
	`sk_pid
(
Ëad”
));

945 
	`Œªsãr_pid
(
Ëad”
, 
tsk
, 
PIDTYPE_PGID
);

946 
	`Œªsãr_pid
(
Ëad”
, 
tsk
, 
PIDTYPE_SID
);

948 
	`li¡_»¶aû_rcu
(&
Ëad”
->
sks
, &
tsk
->tasks);

949 
	`li¡_»¶aû_š™
(&
Ëad”
->
siblšg
, &
tsk
->sibling);

951 
tsk
->
group_Ëad”
 =sk;

952 
Ëad”
->
group_Ëad”
 = 
tsk
;

954 
tsk
->
ex™_sigÇl
 = 
SIGCHLD
;

955 
Ëad”
->
ex™_sigÇl
 = -1;

957 
	`BUG_ON
(
Ëad”
->
ex™_¡©e
 !ğ
EXIT_ZOMBIE
);

958 
Ëad”
->
ex™_¡©e
 = 
EXIT_DEAD
;

965 ià(
	`uÆik–y
(
Ëad”
->
±¿û
))

966 
	`__wake_up_·»Á
(
Ëad”
,†—d”->
·»Á
);

967 
	`wr™e_uÆock_œq
(&
skli¡_lock
);

969 
	`»Ëa£_sk
(
Ëad”
);

972 
sig
->
group_ex™_sk
 = 
NULL
;

973 
sig
->
nÙify_couÁ
 = 0;

975 
no_th»ad_group
:

976 ià(
cu¼’t
->
mm
)

977 
	`£tmax_mm_hiw©”_rss
(&
sig
->
maxrss
, 
cu¼’t
->
mm
);

979 
	`ex™_™im”s
(
sig
);

980 
	`æush_™im”_sigÇls
();

982 ià(
	`©omic_»ad
(&
Şdsighªd
->
couÁ
) != 1) {

983 
sighªd_¡ruù
 *
Ãwsighªd
;

988 
Ãwsighªd
 = 
	`kmem_ÿche_®loc
(
sighªd_ÿch•
, 
GFP_KERNEL
);

989 ià(!
Ãwsighªd
)

990  -
ENOMEM
;

992 
	`©omic_£t
(&
Ãwsighªd
->
couÁ
, 1);

993 
	`memıy
(
Ãwsighªd
->
aùiÚ
, 
Şdsighªd
->action,

994 (
Ãwsighªd
->
aùiÚ
));

996 
	`wr™e_lock_œq
(&
skli¡_lock
);

997 
	`¥š_lock
(&
Şdsighªd
->
siglock
);

998 
	`rcu_assign_poš‹r
(
tsk
->
sighªd
, 
Ãwsighªd
);

999 
	`¥š_uÆock
(&
Şdsighªd
->
siglock
);

1000 
	`wr™e_uÆock_œq
(&
skli¡_lock
);

1002 
	`__ş—nup_sighªd
(
Şdsighªd
);

1005 
	`BUG_ON
(!
	`th»ad_group_Ëad”
(
tsk
));

1007 
	}
}

1013 
	$æush_Şd_fes
(
fes_¡ruù
 * 
fes
)

1015 
j
 = -1;

1016 
fdbË
 *
fdt
;

1018 
	`¥š_lock
(&
fes
->
fe_lock
);

1020 
£t
, 
i
;

1022 
j
++;

1023 
i
 = 
j
 * 
__NFDBITS
;

1024 
fdt
 = 
	`fes_fdbË
(
fes
);

1025 ià(
i
 >ğ
fdt
->
max_fds
)

1027 
£t
 = 
fdt
->
şo£_Ú_exec
->
fds_b™s
[
j
];

1028 ià(!
£t
)

1030 
fdt
->
şo£_Ú_exec
->
fds_b™s
[
j
] = 0;

1031 
	`¥š_uÆock
(&
fes
->
fe_lock
);

1032  ; 
£t
 ; 
i
++,set >>= 1) {

1033 ià(
£t
 & 1) {

1034 
	`sys_şo£
(
i
);

1037 
	`¥š_lock
(&
fes
->
fe_lock
);

1040 
	`¥š_uÆock
(&
fes
->
fe_lock
);

1041 
	}
}

1043 *
	$g‘_sk_comm
(*
buf
, 
sk_¡ruù
 *
tsk
)

1046 
	`sk_lock
(
tsk
);

1047 
	`¡ºıy
(
buf
, 
tsk
->
comm
, (tsk->comm));

1048 
	`sk_uÆock
(
tsk
);

1049  
buf
;

1050 
	}
}

1051 
EXPORT_SYMBOL_GPL
(
g‘_sk_comm
);

1053 
	$£t_sk_comm
(
sk_¡ruù
 *
tsk
, *
buf
)

1055 
	`sk_lock
(
tsk
);

1063 
	`mem£t
(
tsk
->
comm
, 0, 
TASK_COMM_LEN
);

1064 
	`wmb
();

1065 
	`¡¾ıy
(
tsk
->
comm
, 
buf
, (tsk->comm));

1066 
	`sk_uÆock
(
tsk
);

1067 
	`³rf_ev’t_comm
(
tsk
);

1068 
	}
}

1070 
	$æush_Şd_exec
(
lšux_bš´m
 * 
b´m
)

1072 
»tv®
;

1078 
»tv®
 = 
	`de_th»ad
(
cu¼’t
);

1079 ià(
»tv®
)

1080 
out
;

1082 
	`£t_mm_exe_fe
(
b´m
->
mm
, b´m->
fe
);

1087 
	`acù_¬g_size
(
b´m
, 0);

1088 
»tv®
 = 
	`exec_mm­
(
b´m
->
mm
);

1089 ià(
»tv®
)

1090 
out
;

1092 
b´m
->
mm
 = 
NULL
;

1094 
	`£t_fs
(
USER_DS
);

1095 
cu¼’t
->
æags
 &ğ~(
PF_RANDOMIZE
 | 
PF_KTHREAD
);

1096 
	`æush_th»ad
();

1097 
cu¼’t
->
³rsÚ®™y
 &ğ~
b´m
->
³r_ş—r
;

1101 
out
:

1102  
»tv®
;

1103 
	}
}

1104 
EXPORT_SYMBOL
(
æush_Şd_exec
);

1106 
	$would_dump
(
lšux_bš´m
 *
b´m
, 
fe
 *file)

1108 ià(
	`šode_³rmissiÚ
(
fe
->
f_·th
.
d’Œy
->
d_šode
, 
MAY_READ
) < 0)

1109 
b´m
->
š‹½_æags
 |ğ
BINPRM_FLAGS_ENFORCE_NONDUMP
;

1110 
	}
}

1111 
EXPORT_SYMBOL
(
would_dump
);

1113 
	$£tup_Ãw_exec
(
lšux_bš´m
 * 
b´m
)

1115 
i
, 
ch
;

1116 cÚ¡ *
Çme
;

1117 
tcomm
[(
cu¼’t
->
comm
)];

1119 
	`¬ch_pick_mm­_Ïyout
(
cu¼’t
->
mm
);

1122 
cu¼’t
->
§s_ss_¥
 = cu¼’t->
§s_ss_size
 = 0;

1124 ià(
	`cu¼’t_euid
(è=ğ
	`cu¼’t_uid
(è&& 
	`cu¼’t_egid
(è=ğ
	`cu¼’t_gid
())

1125 
	`£t_dum·bË
(
cu¼’t
->
mm
, 1);

1127 
	`£t_dum·bË
(
cu¼’t
->
mm
, 
suid_dum·bË
);

1129 
Çme
 = 
b´m
->
f’ame
;

1132 
i
=0; (
ch
 = *(
Çme
++)) != '\0';) {

1133 ià(
ch
 == '/')

1134 
i
 = 0;

1136 ià(
i
 < ((
tcomm
) - 1))

1137 
tcomm
[
i
++] = 
ch
;

1139 
tcomm
[
i
] = '\0';

1140 
	`£t_sk_comm
(
cu¼’t
, 
tcomm
);

1146 
cu¼’t
->
mm
->
sk_size
 = 
TASK_SIZE
;

1149 ià(
b´m
->
üed
->
uid
 !ğ
	`cu¼’t_euid
() ||

1150 
b´m
->
üed
->
gid
 !ğ
	`cu¼’t_egid
()) {

1151 
cu¼’t
->
pd—th_sigÇl
 = 0;

1153 
	`would_dump
(
b´m
, b´m->
fe
);

1154 ià(
b´m
->
š‹½_æags
 & 
BINPRM_FLAGS_ENFORCE_NONDUMP
)

1155 
	`£t_dum·bË
(
cu¼’t
->
mm
, 
suid_dum·bË
);

1162 ià(!
	`g‘_dum·bË
(
cu¼’t
->
mm
))

1163 
	`³rf_ev’t_ex™_sk
(
cu¼’t
);

1168 
cu¼’t
->
£lf_exec_id
++;

1170 
	`æush_sigÇl_hªdËrs
(
cu¼’t
, 0);

1171 
	`æush_Şd_fes
(
cu¼’t
->
fes
);

1172 
	}
}

1173 
EXPORT_SYMBOL
(
£tup_Ãw_exec
);

1181 
	$´•¬e_b´m_üeds
(
lšux_bš´m
 *
b´m
)

1183 ià(
	`mu‹x_lock_š‹¼u±ibË
(&
cu¼’t
->
sigÇl
->
üed_gu¬d_mu‹x
))

1184  -
ERESTARTNOINTR
;

1186 
b´m
->
üed
 = 
	`´•¬e_exec_üeds
();

1187 ià(
	`lik–y
(
b´m
->
üed
))

1190 
	`mu‹x_uÆock
(&
cu¼’t
->
sigÇl
->
üed_gu¬d_mu‹x
);

1191  -
ENOMEM
;

1192 
	}
}

1194 
	$ä“_b´m
(
lšux_bš´m
 *
b´m
)

1196 
	`ä“_¬g_·ges
(
b´m
);

1197 ià(
b´m
->
üed
) {

1198 
	`mu‹x_uÆock
(&
cu¼’t
->
sigÇl
->
üed_gu¬d_mu‹x
);

1199 
	`abÜt_üeds
(
b´m
->
üed
);

1201 
	`kä“
(
b´m
);

1202 
	}
}

1207 
	$š¡®l_exec_üeds
(
lšux_bš´m
 *
b´m
)

1209 
	`£cur™y_b´m_comm™tšg_üeds
(
b´m
);

1211 
	`comm™_üeds
(
b´m
->
üed
);

1212 
b´m
->
üed
 = 
NULL
;

1218 
	`£cur™y_b´m_comm™‹d_üeds
(
b´m
);

1219 
	`mu‹x_uÆock
(&
cu¼’t
->
sigÇl
->
üed_gu¬d_mu‹x
);

1220 
	}
}

1221 
EXPORT_SYMBOL
(
š¡®l_exec_üeds
);

1228 
	$check_un§ã_exec
(
lšux_bš´m
 *
b´m
)

1230 
sk_¡ruù
 *
p
 = 
cu¼’t
, *
t
;

1231 
n_fs
;

1232 
»s
 = 0;

1234 ià(
p
->
±¿û
) {

1235 ià(
p
->
±¿û
 & 
PT_PTRACE_CAP
)

1236 
b´m
->
un§ã
 |ğ
LSM_UNSAFE_PTRACE_CAP
;

1238 
b´m
->
un§ã
 |ğ
LSM_UNSAFE_PTRACE
;

1241 
n_fs
 = 1;

1242 
	`¥š_lock
(&
p
->
fs
->
lock
);

1243 
	`rcu_»ad_lock
();

1244 
t
 = 
	`Ãxt_th»ad
(
p
); !=…; =‚ext_thread(t)) {

1245 ià(
t
->
fs
 =ğ
p
->fs)

1246 
n_fs
++;

1248 
	`rcu_»ad_uÆock
();

1250 ià(
p
->
fs
->
u£rs
 > 
n_fs
) {

1251 
b´m
->
un§ã
 |ğ
LSM_UNSAFE_SHARE
;

1253 
»s
 = -
EAGAIN
;

1254 ià(!
p
->
fs
->
š_exec
) {

1255 
p
->
fs
->
š_exec
 = 1;

1256 
»s
 = 1;

1259 
	`¥š_uÆock
(&
p
->
fs
->
lock
);

1261  
»s
;

1262 
	}
}

1270 
	$´•¬e_bš´m
(
lšux_bš´m
 *
b´m
)

1272 
umode_t
 
mode
;

1273 
šode
 * inodğ
b´m
->
fe
->
f_·th
.
d’Œy
->
d_šode
;

1274 
»tv®
;

1276 
mode
 = 
šode
->
i_mode
;

1277 ià(
b´m
->
fe
->
f_İ
 =ğ
NULL
)

1278  -
EACCES
;

1281 
b´m
->
üed
->
euid
 = 
	`cu¼’t_euid
();

1282 
b´m
->
üed
->
egid
 = 
	`cu¼’t_egid
();

1284 ià(!(
b´m
->
fe
->
f_·th
.
mÁ
->
mÁ_æags
 & 
MNT_NOSUID
)) {

1286 ià(
mode
 & 
S_ISUID
) {

1287 
b´m
->
³r_ş—r
 |ğ
PER_CLEAR_ON_SETID
;

1288 
b´m
->
üed
->
euid
 = 
šode
->
i_uid
;

1297 ià((
mode
 & (
S_ISGID
 | 
S_IXGRP
)) == (S_ISGID | S_IXGRP)) {

1298 
b´m
->
³r_ş—r
 |ğ
PER_CLEAR_ON_SETID
;

1299 
b´m
->
üed
->
egid
 = 
šode
->
i_gid
;

1304 
»tv®
 = 
	`£cur™y_b´m_£t_üeds
(
b´m
);

1305 ià(
»tv®
)

1306  
»tv®
;

1307 
b´m
->
üed_´•¬ed
 = 1;

1309 
	`mem£t
(
b´m
->
buf
, 0, 
BINPRM_BUF_SIZE
);

1310  
	`k”Ãl_»ad
(
b´m
->
fe
, 0, b´m->
buf
, 
BINPRM_BUF_SIZE
);

1311 
	}
}

1313 
EXPORT_SYMBOL
(
´•¬e_bš´m
);

1320 
	$»move_¬g_z”o
(
lšux_bš´m
 *
b´m
)

1322 
»t
 = 0;

1323 
off£t
;

1324 *
kaddr
;

1325 
·ge
 *page;

1327 ià(!
b´m
->
¬gc
)

1331 
off£t
 = 
b´m
->
p
 & ~
PAGE_MASK
;

1332 
·ge
 = 
	`g‘_¬g_·ge
(
b´m
, b´m->
p
, 0);

1333 ià(!
·ge
) {

1334 
»t
 = -
EFAULT
;

1335 
out
;

1337 
kaddr
 = 
	`km­_©omic
(
·ge
, 
KM_USER0
);

1339 ; 
off£t
 < 
PAGE_SIZE
 && 
kaddr
[offset];

1340 
off£t
++, 
b´m
->
p
++)

1343 
	`kunm­_©omic
(
kaddr
, 
KM_USER0
);

1344 
	`put_¬g_·ge
(
·ge
);

1346 ià(
off£t
 =ğ
PAGE_SIZE
)

1347 
	`ä“_¬g_·ge
(
b´m
, (b´m->
p
 >> 
PAGE_SHIFT
) - 1);

1348 } 
off£t
 =ğ
PAGE_SIZE
);

1350 
b´m
->
p
++;

1351 
b´m
->
¬gc
--;

1352 
»t
 = 0;

1354 
out
:

1355  
»t
;

1356 
	}
}

1357 
EXPORT_SYMBOL
(
»move_¬g_z”o
);

1362 
	$£¬ch_bš¬y_hªdËr
(
lšux_bš´m
 *
b´m
,
±_»gs
 *
»gs
)

1364 
d•th
 = 
b´m
->
»cursiÚ_d•th
;

1365 
Œy
,
»tv®
;

1366 
lšux_bšfmt
 *
fmt
;

1367 
pid_t
 
Şd_pid
;

1369 
»tv®
 = 
	`£cur™y_b´m_check
(
b´m
);

1370 ià(
»tv®
)

1371  
»tv®
;

1373 
»tv®
 = 
	`aud™_b´m
(
b´m
);

1374 ià(
»tv®
)

1375  
»tv®
;

1378 
	`rcu_»ad_lock
();

1379 
Şd_pid
 = 
	`sk_pid_Ä_ns
(
cu¼’t
, 
	`sk_aùive_pid_ns
(cu¼’t->
·»Á
));

1380 
	`rcu_»ad_uÆock
();

1382 
»tv®
 = -
ENOENT
;

1383 
Œy
=0;ry<2;ry++) {

1384 
	`»ad_lock
(&
bšfmt_lock
);

1385 
	`li¡_fÜ_—ch_’Œy
(
fmt
, &
fÜm©s
, 
lh
) {

1386 (*
â
)(
lšux_bš´m
 *, 
±_»gs
 *èğ
fmt
->
lßd_bš¬y
;

1387 ià(!
â
)

1389 ià(!
	`Œy_moduË_g‘
(
fmt
->
moduË
))

1391 
	`»ad_uÆock
(&
bšfmt_lock
);

1392 
»tv®
 = 
	`â
(
b´m
, 
»gs
);

1398 
b´m
->
»cursiÚ_d•th
 = 
d•th
;

1399 ià(
»tv®
 >= 0) {

1400 ià(
d•th
 == 0)

1401 
	`±¿û_ev’t
(
PTRACE_EVENT_EXEC
,

1402 
Şd_pid
);

1403 
	`put_bšfmt
(
fmt
);

1404 
	`®low_wr™e_acûss
(
b´m
->
fe
);

1405 ià(
b´m
->
fe
)

1406 
	`åut
(
b´m
->
fe
);

1407 
b´m
->
fe
 = 
NULL
;

1408 
cu¼’t
->
did_exec
 = 1;

1409 
	`´oc_exec_cÚÃùÜ
(
cu¼’t
);

1410  
»tv®
;

1412 
	`»ad_lock
(&
bšfmt_lock
);

1413 
	`put_bšfmt
(
fmt
);

1414 ià(
»tv®
 !ğ-
ENOEXEC
 || 
b´m
->
mm
 =ğ
NULL
)

1416 ià(!
b´m
->
fe
) {

1417 
	`»ad_uÆock
(&
bšfmt_lock
);

1418  
»tv®
;

1421 
	`»ad_uÆock
(&
bšfmt_lock
);

1422 #ifdeà
CONFIG_MODULES


1423 ià(
»tv®
 !ğ-
ENOEXEC
 || 
b´m
->
mm
 =ğ
NULL
) {

1426 
	#´šbË
(
c
è(((c)=='\t'è|| ((c)=='\n'è|| (0x20<=(cè&& (c)<=0x7e))

	)

1427 ià(
	`´šbË
(
b´m
->
buf
[0]) &&

1428 
	`´šbË
(
b´m
->
buf
[1]) &&

1429 
	`´šbË
(
b´m
->
buf
[2]) &&

1430 
	`´šbË
(
b´m
->
buf
[3]))

1432 ià(
Œy
)

1434 
	`»que¡_moduË
("bšfmt-%04x", *(*)(&
b´m
->
buf
[2]));

1440  
»tv®
;

1441 
	}
}

1443 
EXPORT_SYMBOL
(
£¬ch_bš¬y_hªdËr
);

1448 
	$do_execve_commÚ
(cÚ¡ *
f’ame
,

1449 
u£r_¬g_±r
 
¬gv
,

1450 
u£r_¬g_±r
 
’vp
,

1451 
±_»gs
 *
»gs
)

1453 
lšux_bš´m
 *
b´m
;

1454 
fe
 *file;

1455 
fes_¡ruù
 *
di¥Ïûd
;

1456 
boŞ
 
ş—r_š_exec
;

1457 
»tv®
;

1458 cÚ¡ 
üed
 *üed = 
	`cu¼’t_üed
();

1466 ià((
cu¼’t
->
æags
 & 
PF_NPROC_EXCEEDED
) &&

1467 
	`©omic_»ad
(&
üed
->
u£r
->
´oûs£s
è> 
	`¾im™
(
RLIMIT_NPROC
)) {

1468 
»tv®
 = -
EAGAIN
;

1469 
out_»t
;

1474 
cu¼’t
->
æags
 &ğ~
PF_NPROC_EXCEEDED
;

1476 
»tv®
 = 
	`unsh¬e_fes
(&
di¥Ïûd
);

1477 ià(
»tv®
)

1478 
out_»t
;

1480 
»tv®
 = -
ENOMEM
;

1481 
b´m
 = 
	`kz®loc
((*b´m), 
GFP_KERNEL
);

1482 ià(!
b´m
)

1483 
out_fes
;

1485 
»tv®
 = 
	`´•¬e_b´m_üeds
(
b´m
);

1486 ià(
»tv®
)

1487 
out_ä“
;

1489 
»tv®
 = 
	`check_un§ã_exec
(
b´m
);

1490 ià(
»tv®
 < 0)

1491 
out_ä“
;

1492 
ş—r_š_exec
 = 
»tv®
;

1493 
cu¼’t
->
š_execve
 = 1;

1495 
fe
 = 
	`İ’_exec
(
f’ame
);

1496 
»tv®
 = 
	`PTR_ERR
(
fe
);

1497 ià(
	`IS_ERR
(
fe
))

1498 
out_unm¬k
;

1500 
	`sched_exec
();

1502 
b´m
->
fe
 = file;

1503 
b´m
->
f’ame
 = filename;

1504 
b´m
->
š‹½
 = 
f’ame
;

1506 
»tv®
 = 
	`b´m_mm_š™
(
b´m
);

1507 ià(
»tv®
)

1508 
out_fe
;

1510 
b´m
->
¬gc
 = 
	`couÁ
(
¬gv
, 
MAX_ARG_STRINGS
);

1511 ià((
»tv®
 = 
b´m
->
¬gc
) < 0)

1512 
out
;

1514 
b´m
->
’vc
 = 
	`couÁ
(
’vp
, 
MAX_ARG_STRINGS
);

1515 ià((
»tv®
 = 
b´m
->
’vc
) < 0)

1516 
out
;

1518 
»tv®
 = 
	`´•¬e_bš´m
(
b´m
);

1519 ià(
»tv®
 < 0)

1520 
out
;

1522 
»tv®
 = 
	`cİy_¡ršgs_k”Ãl
(1, &
b´m
->
f’ame
, bprm);

1523 ià(
»tv®
 < 0)

1524 
out
;

1526 
b´m
->
exec
 = b´m->
p
;

1527 
»tv®
 = 
	`cİy_¡ršgs
(
b´m
->
’vc
, 
’vp
, bprm);

1528 ià(
»tv®
 < 0)

1529 
out
;

1531 
»tv®
 = 
	`cİy_¡ršgs
(
b´m
->
¬gc
, 
¬gv
, bprm);

1532 ià(
»tv®
 < 0)

1533 
out
;

1535 
»tv®
 = 
	`£¬ch_bš¬y_hªdËr
(
b´m
,
»gs
);

1536 ià(
»tv®
 < 0)

1537 
out
;

1540 
cu¼’t
->
fs
->
š_exec
 = 0;

1541 
cu¼’t
->
š_execve
 = 0;

1542 
	`acù_upd©e_š‹g¿ls
(
cu¼’t
);

1543 
	`ä“_b´m
(
b´m
);

1544 ià(
di¥Ïûd
)

1545 
	`put_fes_¡ruù
(
di¥Ïûd
);

1546  
»tv®
;

1548 
out
:

1549 ià(
b´m
->
mm
) {

1550 
	`acù_¬g_size
(
b´m
, 0);

1551 
	`mmput
(
b´m
->
mm
);

1554 
out_fe
:

1555 ià(
b´m
->
fe
) {

1556 
	`®low_wr™e_acûss
(
b´m
->
fe
);

1557 
	`åut
(
b´m
->
fe
);

1560 
out_unm¬k
:

1561 ià(
ş—r_š_exec
)

1562 
cu¼’t
->
fs
->
š_exec
 = 0;

1563 
cu¼’t
->
š_execve
 = 0;

1565 
out_ä“
:

1566 
	`ä“_b´m
(
b´m
);

1568 
out_fes
:

1569 ià(
di¥Ïûd
)

1570 
	`»£t_fes_¡ruù
(
di¥Ïûd
);

1571 
out_»t
:

1572  
»tv®
;

1573 
	}
}

1575 
	$do_execve
(cÚ¡ *
f’ame
,

1576 cÚ¡ 
__u£r
 *cÚ¡ __u£¸*
__¬gv
,

1577 cÚ¡ 
__u£r
 *cÚ¡ __u£¸*
__’vp
,

1578 
±_»gs
 *
»gs
)

1580 
u£r_¬g_±r
 
¬gv
 = { .
±r
.
Çtive
 = 
__¬gv
 };

1581 
u£r_¬g_±r
 
’vp
 = { .
±r
.
Çtive
 = 
__’vp
 };

1582  
	`do_execve_commÚ
(
f’ame
, 
¬gv
, 
’vp
, 
»gs
);

1583 
	}
}

1585 #ifdeà
CONFIG_COMPAT


1586 
	$com·t_do_execve
(*
f’ame
,

1587 
com·t_u±r_t
 
__u£r
 *
__¬gv
,

1588 
com·t_u±r_t
 
__u£r
 *
__’vp
,

1589 
±_»gs
 *
»gs
)

1591 
u£r_¬g_±r
 
¬gv
 = {

1592 .
is_com·t
 = 
Œue
,

1593 .
±r
.
com·t
 = 
__¬gv
,

1595 
u£r_¬g_±r
 
’vp
 = {

1596 .
is_com·t
 = 
Œue
,

1597 .
±r
.
com·t
 = 
__’vp
,

1599  
	`do_execve_commÚ
(
f’ame
, 
¬gv
, 
’vp
, 
»gs
);

1600 
	}
}

1603 
	$£t_bšfmt
(
lšux_bšfmt
 *
Ãw
)

1605 
mm_¡ruù
 *
mm
 = 
cu¼’t
->mm;

1607 ià(
mm
->
bšfmt
)

1608 
	`moduË_put
(
mm
->
bšfmt
->
moduË
);

1610 
mm
->
bšfmt
 = 
Ãw
;

1611 ià(
Ãw
)

1612 
	`__moduË_g‘
(
Ãw
->
moduË
);

1613 
	}
}

1615 
EXPORT_SYMBOL
(
£t_bšfmt
);

1617 
	$ex·nd_cÜ’ame
(
cÜe_Çme
 *
ú
)

1619 *
Şd_cÜ’ame
 = 
ú
->
cÜ’ame
;

1621 
ú
->
size
 = 
CORENAME_MAX_SIZE
 * 
	`©omic_šc_»tuº
(&
ÿÎ_couÁ
);

1622 
ú
->
cÜ’ame
 = 
	`k»®loc
(
Şd_cÜ’ame
, cn->
size
, 
GFP_KERNEL
);

1624 ià(!
ú
->
cÜ’ame
) {

1625 
	`kä“
(
Şd_cÜ’ame
);

1626  -
ENOMEM
;

1630 
	}
}

1632 
	$ú_´štf
(
cÜe_Çme
 *
ú
, cÚ¡ *
fmt
, ...)

1634 *
cur
;

1635 
Ãed
;

1636 
»t
;

1637 
va_li¡
 
¬g
;

1639 
	`va_¡¬t
(
¬g
, 
fmt
);

1640 
Ãed
 = 
	`v¢´štf
(
NULL
, 0, 
fmt
, 
¬g
);

1641 
	`va_’d
(
¬g
);

1643 ià(
	`lik–y
(
Ãed
 < 
ú
->
size
 - cn->
u£d
 - 1))

1644 
out_´štf
;

1646 
»t
 = 
	`ex·nd_cÜ’ame
(
ú
);

1647 ià(
»t
)

1648 
ex·nd_ç
;

1650 
out_´štf
:

1651 
cur
 = 
ú
->
cÜ’ame
 + cn->
u£d
;

1652 
	`va_¡¬t
(
¬g
, 
fmt
);

1653 
	`v¢´štf
(
cur
, 
Ãed
 + 1, 
fmt
, 
¬g
);

1654 
	`va_’d
(
¬g
);

1655 
ú
->
u£d
 +ğ
Ãed
;

1658 
ex·nd_ç
:

1659  
»t
;

1660 
	}
}

1662 
	$ú_esÿ³
(*
¡r
)

1664 ; *
¡r
; str++)

1665 ià(*
¡r
 == '/')

1666 *
¡r
 = '!';

1667 
	}
}

1669 
	$ú_´št_exe_fe
(
cÜe_Çme
 *
ú
)

1671 
fe
 *
exe_fe
;

1672 *
·thbuf
, *
·th
;

1673 
»t
;

1675 
exe_fe
 = 
	`g‘_mm_exe_fe
(
cu¼’t
->
mm
);

1676 ià(!
exe_fe
) {

1677 *
comm¡¬t
 = 
ú
->
cÜ’ame
 + cn->
u£d
;

1678 
»t
 = 
	`ú_´štf
(
ú
, "% Õ©h unknown)", 
cu¼’t
->
comm
);

1679 
	`ú_esÿ³
(
comm¡¬t
);

1680  
»t
;

1683 
·thbuf
 = 
	`km®loc
(
PATH_MAX
, 
GFP_TEMPORARY
);

1684 ià(!
·thbuf
) {

1685 
»t
 = -
ENOMEM
;

1686 
put_exe_fe
;

1689 
·th
 = 
	`d_·th
(&
exe_fe
->
f_·th
, 
·thbuf
, 
PATH_MAX
);

1690 ià(
	`IS_ERR
(
·th
)) {

1691 
»t
 = 
	`PTR_ERR
(
·th
);

1692 
ä“_buf
;

1695 
	`ú_esÿ³
(
·th
);

1697 
»t
 = 
	`ú_´štf
(
ú
, "%s", 
·th
);

1699 
ä“_buf
:

1700 
	`kä“
(
·thbuf
);

1701 
put_exe_fe
:

1702 
	`åut
(
exe_fe
);

1703  
»t
;

1704 
	}
}

1710 
	$fÜm©_cÜ’ame
(
cÜe_Çme
 *
ú
, 
sigÄ
)

1712 cÚ¡ 
üed
 *üed = 
	`cu¼’t_üed
();

1713 cÚ¡ *
·t_±r
 = 
cÜe_·‰”n
;

1714 
i¥e
 = (*
·t_±r
 == '|');

1715 
pid_š_·‰”n
 = 0;

1716 
”r
 = 0;

1718 
ú
->
size
 = 
CORENAME_MAX_SIZE
 * 
	`©omic_»ad
(&
ÿÎ_couÁ
);

1719 
ú
->
cÜ’ame
 = 
	`km®loc
(ú->
size
, 
GFP_KERNEL
);

1720 
ú
->
u£d
 = 0;

1722 ià(!
ú
->
cÜ’ame
)

1723  -
ENOMEM
;

1727 *
·t_±r
) {

1728 ià(*
·t_±r
 != '%') {

1729 ià(*
·t_±r
 == 0)

1730 
out
;

1731 
”r
 = 
	`ú_´štf
(
ú
, "%c", *
·t_±r
++);

1733 *++
·t_±r
) {

1736 
out
;

1739 
”r
 = 
	`ú_´štf
(
ú
, "%c", '%');

1743 
pid_š_·‰”n
 = 1;

1744 
”r
 = 
	`ú_´štf
(
ú
, "%d",

1745 
	`sk_tgid_vÄ
(
cu¼’t
));

1749 
”r
 = 
	`ú_´štf
(
ú
, "%d", 
üed
->
uid
);

1753 
”r
 = 
	`ú_´štf
(
ú
, "%d", 
üed
->
gid
);

1757 
”r
 = 
	`ú_´štf
(
ú
, "%ld", 
sigÄ
);

1761 
timev®
 
tv
;

1762 
	`do_g‘timeofday
(&
tv
);

1763 
”r
 = 
	`ú_´štf
(
ú
, "%lu", 
tv
.
tv_£c
);

1768 *
Çme¡¬t
 = 
ú
->
cÜ’ame
 + cn->
u£d
;

1769 
	`down_»ad
(&
uts_£m
);

1770 
”r
 = 
	`ú_´štf
(
ú
, "%s",

1771 
	`ut¢ame
()->
nod’ame
);

1772 
	`up_»ad
(&
uts_£m
);

1773 
	`ú_esÿ³
(
Çme¡¬t
);

1778 *
comm¡¬t
 = 
ú
->
cÜ’ame
 + cn->
u£d
;

1779 
”r
 = 
	`ú_´štf
(
ú
, "%s", 
cu¼’t
->
comm
);

1780 
	`ú_esÿ³
(
comm¡¬t
);

1784 
”r
 = 
	`ú_´št_exe_fe
(
ú
);

1788 
”r
 = 
	`ú_´štf
(
ú
, "%lu",

1789 
	`¾im™
(
RLIMIT_CORE
));

1794 ++
·t_±r
;

1797 ià(
”r
)

1798  
”r
;

1806 ià(!
i¥e
 && !
pid_š_·‰”n
 && 
cÜe_u£s_pid
) {

1807 
”r
 = 
	`ú_´štf
(
ú
, ".%d", 
	`sk_tgid_vÄ
(
cu¼’t
));

1808 ià(
”r
)

1809  
”r
;

1811 
out
:

1812  
i¥e
;

1813 
	}
}

1815 
	$z­_´oûss
(
sk_¡ruù
 *
¡¬t
, 
ex™_code
)

1817 
sk_¡ruù
 *
t
;

1818 
Ä
 = 0;

1820 
¡¬t
->
sigÇl
->
æags
 = 
SIGNAL_GROUP_EXIT
;

1821 
¡¬t
->
sigÇl
->
group_ex™_code
 = 
ex™_code
;

1822 
¡¬t
->
sigÇl
->
group_¡İ_couÁ
 = 0;

1824 
t
 = 
¡¬t
;

1826 
	`sk_ş—r_jobùl_³ndšg
(
t
, 
JOBCTL_PENDING_MASK
);

1827 ià(
t
 !ğ
cu¼’t
 &&->
mm
) {

1828 
	`sigadd£t
(&
t
->
³ndšg
.
sigÇl
, 
SIGKILL
);

1829 
	`sigÇl_wake_up
(
t
, 1);

1830 
Ä
++;

1832 } 
	`whe_—ch_th»ad
(
¡¬t
, 
t
);

1834  
Ä
;

1835 
	}
}

1837 
šlše
 
	$z­_th»ads
(
sk_¡ruù
 *
tsk
, 
mm_¡ruù
 *
mm
,

1838 
cÜe_¡©e
 *cÜe_¡©e, 
ex™_code
)

1840 
sk_¡ruù
 *
g
, *
p
;

1841 
æags
;

1842 
Ä
 = -
EAGAIN
;

1844 
	`¥š_lock_œq
(&
tsk
->
sighªd
->
siglock
);

1845 ià(!
	`sigÇl_group_ex™
(
tsk
->
sigÇl
)) {

1846 
mm
->
cÜe_¡©e
 = core_state;

1847 
Ä
 = 
	`z­_´oûss
(
tsk
, 
ex™_code
);

1849 
	`¥š_uÆock_œq
(&
tsk
->
sighªd
->
siglock
);

1850 ià(
	`uÆik–y
(
Ä
 < 0))

1851  
Ä
;

1853 ià(
	`©omic_»ad
(&
mm
->
mm_u£rs
è=ğ
Ä
 + 1)

1854 
dÚe
;

1885 
	`rcu_»ad_lock
();

1886 
	`fÜ_—ch_´oûss
(
g
) {

1887 ià(
g
 =ğ
tsk
->
group_Ëad”
)

1889 ià(
g
->
æags
 & 
PF_KTHREAD
)

1891 
p
 = 
g
;

1893 ià(
p
->
mm
) {

1894 ià(
	`uÆik–y
(
p
->
mm
 == mm)) {

1895 
	`lock_sk_sighªd
(
p
, &
æags
);

1896 
Ä
 +ğ
	`z­_´oûss
(
p
, 
ex™_code
);

1897 
	`uÆock_sk_sighªd
(
p
, &
æags
);

1901 } 
	`whe_—ch_th»ad
(
g
, 
p
);

1903 
	`rcu_»ad_uÆock
();

1904 
dÚe
:

1905 
	`©omic_£t
(&
cÜe_¡©e
->
Ä_th»ads
, 
Ä
);

1906  
Ä
;

1907 
	}
}

1909 
	$cÜedump_wa™
(
ex™_code
, 
cÜe_¡©e
 *core_state)

1911 
sk_¡ruù
 *
tsk
 = 
cu¼’t
;

1912 
mm_¡ruù
 *
mm
 = 
tsk
->mm;

1913 
com¶‘iÚ
 *
vfÜk_dÚe
;

1914 
cÜe_wa™”s
 = -
EBUSY
;

1916 
	`š™_com¶‘iÚ
(&
cÜe_¡©e
->
¡¬tup
);

1917 
cÜe_¡©e
->
dum³r
.
sk
 = 
tsk
;

1918 
cÜe_¡©e
->
dum³r
.
Ãxt
 = 
NULL
;

1920 
	`down_wr™e
(&
mm
->
mm­_£m
);

1921 ià(!
mm
->
cÜe_¡©e
)

1922 
cÜe_wa™”s
 = 
	`z­_th»ads
(
tsk
, 
mm
, 
cÜe_¡©e
, 
ex™_code
);

1923 
	`up_wr™e
(&
mm
->
mm­_£m
);

1925 ià(
	`uÆik–y
(
cÜe_wa™”s
 < 0))

1926 
ç
;

1932 
vfÜk_dÚe
 = 
tsk
->vfork_done;

1933 ià(
vfÜk_dÚe
) {

1934 
tsk
->
vfÜk_dÚe
 = 
NULL
;

1935 
	`com¶‘e
(
vfÜk_dÚe
);

1938 ià(
cÜe_wa™”s
)

1939 
	`wa™_fÜ_com¶‘iÚ
(&
cÜe_¡©e
->
¡¬tup
);

1940 
ç
:

1941  
cÜe_wa™”s
;

1942 
	}
}

1944 
	$cÜedump_fšish
(
mm_¡ruù
 *
mm
)

1946 
cÜe_th»ad
 *
cu¼
, *
Ãxt
;

1947 
sk_¡ruù
 *
sk
;

1949 
Ãxt
 = 
mm
->
cÜe_¡©e
->
dum³r
.next;

1950 (
cu¼
 = 
Ãxt
è!ğ
NULL
) {

1951 
Ãxt
 = 
cu¼
->next;

1952 
sk
 = 
cu¼
->task;

1957 
	`smp_mb
();

1958 
cu¼
->
sk
 = 
NULL
;

1959 
	`wake_up_´oûss
(
sk
);

1962 
mm
->
cÜe_¡©e
 = 
NULL
;

1963 
	}
}

1985 
	$£t_dum·bË
(
mm_¡ruù
 *
mm
, 
v®ue
)

1987 
v®ue
) {

1989 
	`ş—r_b™
(
MMF_DUMPABLE
, &
mm
->
æags
);

1990 
	`smp_wmb
();

1991 
	`ş—r_b™
(
MMF_DUMP_SECURELY
, &
mm
->
æags
);

1994 
	`£t_b™
(
MMF_DUMPABLE
, &
mm
->
æags
);

1995 
	`smp_wmb
();

1996 
	`ş—r_b™
(
MMF_DUMP_SECURELY
, &
mm
->
æags
);

1999 
	`£t_b™
(
MMF_DUMP_SECURELY
, &
mm
->
æags
);

2000 
	`smp_wmb
();

2001 
	`£t_b™
(
MMF_DUMPABLE
, &
mm
->
æags
);

2004 
	}
}

2006 
	$__g‘_dum·bË
(
mm_æags
)

2008 
»t
;

2010 
»t
 = 
mm_æags
 & 
MMF_DUMPABLE_MASK
;

2011  (
»t
 >= 2) ? 2 :„et;

2012 
	}
}

2014 
	$g‘_dum·bË
(
mm_¡ruù
 *
mm
)

2016  
	`__g‘_dum·bË
(
mm
->
æags
);

2017 
	}
}

2019 
	$wa™_fÜ_dump_h–³rs
(
fe
 *file)

2021 
pe_šode_šfo
 *
pe
;

2023 
pe
 = 
fe
->
f_·th
.
d’Œy
->
d_šode
->
i_pe
;

2025 
	`pe_lock
(
pe
);

2026 
pe
->
»ad”s
++;

2027 
pe
->
wr™”s
--;

2029 (
pe
->
»ad”s
 > 1è&& (!
	`sigÇl_³ndšg
(
cu¼’t
))) {

2030 
	`wake_up_š‹¼u±ibË_sync
(&
pe
->
wa™
);

2031 
	`kl_çsync
(&
pe
->
çsync_»ad”s
, 
SIGIO
, 
POLL_IN
);

2032 
	`pe_wa™
(
pe
);

2035 
pe
->
»ad”s
--;

2036 
pe
->
wr™”s
++;

2037 
	`pe_uÆock
(
pe
);

2039 
	}
}

2053 
	$umh_pe_£tup
(
sub´oûss_šfo
 *
šfo
, 
üed
 *
Ãw
)

2055 
fe
 *
½
, *
wp
;

2056 
fdbË
 *
fdt
;

2057 
cÜedump_·¿ms
 *
ı
 = (cÜedump_·¿m *)
šfo
->
d©a
;

2058 
fes_¡ruù
 *
cf
 = 
cu¼’t
->
fes
;

2060 
wp
 = 
	`ü—‹_wr™e_pe
(0);

2061 ià(
	`IS_ERR
(
wp
))

2062  
	`PTR_ERR
(
wp
);

2064 
½
 = 
	`ü—‹_»ad_pe
(
wp
, 0);

2065 ià(
	`IS_ERR
(
½
)) {

2066 
	`ä“_wr™e_pe
(
wp
);

2067  
	`PTR_ERR
(
½
);

2070 
ı
->
fe
 = 
wp
;

2072 
	`sys_şo£
(0);

2073 
	`fd_š¡®l
(0, 
½
);

2074 
	`¥š_lock
(&
cf
->
fe_lock
);

2075 
fdt
 = 
	`fes_fdbË
(
cf
);

2076 
	`FD_SET
(0, 
fdt
->
İ’_fds
);

2077 
	`FD_CLR
(0, 
fdt
->
şo£_Ú_exec
);

2078 
	`¥š_uÆock
(&
cf
->
fe_lock
);

2081 
cu¼’t
->
sigÇl
->
¾im
[
RLIMIT_CORE
] = (
¾im™
){1, 1};

2084 
	}
}

2086 
	$do_cÜedump
(
sigÄ
, 
ex™_code
, 
±_»gs
 *
»gs
)

2088 
cÜe_¡©e
 core_state;

2089 
cÜe_Çme
 
ú
;

2090 
mm_¡ruù
 *
mm
 = 
cu¼’t
->mm;

2091 
lšux_bšfmt
 * 
bšfmt
;

2092 cÚ¡ 
üed
 *
Şd_üed
;

2093 
üed
 *cred;

2094 
»tv®
 = 0;

2095 
æag
 = 0;

2096 
i¥e
;

2097 
©omic_t
 
cÜe_dump_couÁ
 = 
	`ATOMIC_INIT
(0);

2098 
cÜedump_·¿ms
 
ırm
 = {

2099 .
sigÄ
 = signr,

2100 .
»gs
 =„egs,

2101 .
lim™
 = 
	`¾im™
(
RLIMIT_CORE
),

2107 .
mm_æags
 = 
mm
->
æags
,

2110 
	`aud™_cÜe_dumps
(
sigÄ
);

2112 
bšfmt
 = 
mm
->binfmt;

2113 ià(!
bšfmt
 || !bšfmt->
cÜe_dump
)

2114 
ç
;

2115 ià(!
	`__g‘_dum·bË
(
ırm
.
mm_æags
))

2116 
ç
;

2118 
üed
 = 
	`´•¬e_üeds
();

2119 ià(!
üed
)

2120 
ç
;

2126 ià(
	`__g‘_dum·bË
(
ırm
.
mm_æags
) == 2) {

2128 
æag
 = 
O_EXCL
;

2129 
üed
->
fsuid
 = 0;

2132 
»tv®
 = 
	`cÜedump_wa™
(
ex™_code
, &
cÜe_¡©e
);

2133 ià(
»tv®
 < 0)

2134 
ç_üeds
;

2136 
Şd_üed
 = 
	`ov”ride_üeds
(
üed
);

2142 
	`ş—r_th»ad_æag
(
TIF_SIGPENDING
);

2144 
i¥e
 = 
	`fÜm©_cÜ’ame
(&
ú
, 
sigÄ
);

2146 ià(
i¥e
) {

2147 
dump_couÁ
;

2148 **
h–³r_¬gv
;

2150 ià(
i¥e
 < 0) {

2151 
	`´štk
(
KERN_WARNING
 "format_corename failed\n");

2152 
	`´štk
(
KERN_WARNING
 "Aborting core\n");

2153 
ç_cÜ’ame
;

2156 ià(
ırm
.
lim™
 == 1) {

2171 
	`´štk
(
KERN_WARNING


2173 
	`sk_tgid_vÄ
(
cu¼’t
), cu¼’t->
comm
);

2174 
	`´štk
(
KERN_WARNING
 "Aborting core\n");

2175 
ç_uÆock
;

2177 
ırm
.
lim™
 = 
RLIM_INFINITY
;

2179 
dump_couÁ
 = 
	`©omic_šc_»tuº
(&
cÜe_dump_couÁ
);

2180 ià(
cÜe_pe_lim™
 && (cÜe_pe_lim™ < 
dump_couÁ
)) {

2181 
	`´štk
(
KERN_WARNING
 "Pid %d(%s) over core_pipe_limit\n",

2182 
	`sk_tgid_vÄ
(
cu¼’t
), cu¼’t->
comm
);

2183 
	`´štk
(
KERN_WARNING
 "Skipping core dump\n");

2184 
ç_drİcouÁ
;

2187 
h–³r_¬gv
 = 
	`¬gv_¥l™
(
GFP_KERNEL
, 
ú
.
cÜ’ame
+1, 
NULL
);

2188 ià(!
h–³r_¬gv
) {

2189 
	`´štk
(
KERN_WARNING
 "%s failedo‡llocate memory\n",

2190 
__func__
);

2191 
ç_drİcouÁ
;

2194 
»tv®
 = 
	`ÿÎ_u£rmodeh–³r_âs
(
h–³r_¬gv
[0], helper_argv,

2195 
NULL
, 
UMH_WAIT_EXEC
, 
umh_pe_£tup
,

2196 
NULL
, &
ırm
);

2197 
	`¬gv_ä“
(
h–³r_¬gv
);

2198 ià(
»tv®
) {

2199 
	`´štk
(
KERN_INFO
 "Core dumpo %s…ipe failed\n",

2200 
ú
.
cÜ’ame
);

2201 
şo£_ç
;

2204 
šode
 *inode;

2206 ià(
ırm
.
lim™
 < 
bšfmt
->
mš_cÜedump
)

2207 
ç_uÆock
;

2209 
ırm
.
fe
 = 
	`fp_İ’
(
ú
.
cÜ’ame
,

2210 
O_CREAT
 | 2 | 
O_NOFOLLOW
 | 
O_LARGEFILE
 | 
æag
,

2212 ià(
	`IS_ERR
(
ırm
.
fe
))

2213 
ç_uÆock
;

2215 
šode
 = 
ırm
.
fe
->
f_·th
.
d’Œy
->
d_šode
;

2216 ià(
šode
->
i_Æšk
 > 1)

2217 
şo£_ç
;

2218 ià(
	`d_unhashed
(
ırm
.
fe
->
f_·th
.
d’Œy
))

2219 
şo£_ç
;

2224 ià(!
	`S_ISREG
(
šode
->
i_mode
))

2225 
şo£_ç
;

2230 ià(
šode
->
i_uid
 !ğ
	`cu¼’t_fsuid
())

2231 
şo£_ç
;

2232 ià(!
ırm
.
fe
->
f_İ
 || !ırm.fe->f_İ->
wr™e
)

2233 
şo£_ç
;

2234 ià(
	`do_Œunÿ‹
(
ırm
.
fe
->
f_·th
.
d’Œy
, 0, 0, cprm.file))

2235 
şo£_ç
;

2238 
»tv®
 = 
bšfmt
->
	`cÜe_dump
(&
ırm
);

2239 ià(
»tv®
)

2240 
cu¼’t
->
sigÇl
->
group_ex™_code
 |= 0x80;

2242 ià(
i¥e
 && 
cÜe_pe_lim™
)

2243 
	`wa™_fÜ_dump_h–³rs
(
ırm
.
fe
);

2244 
şo£_ç
:

2245 ià(
ırm
.
fe
)

2246 
	`fp_şo£
(
ırm
.
fe
, 
NULL
);

2247 
ç_drİcouÁ
:

2248 ià(
i¥e
)

2249 
	`©omic_dec
(&
cÜe_dump_couÁ
);

2250 
ç_uÆock
:

2251 
	`kä“
(
ú
.
cÜ’ame
);

2252 
ç_cÜ’ame
:

2253 
	`cÜedump_fšish
(
mm
);

2254 
	`»v”t_üeds
(
Şd_üed
);

2255 
ç_üeds
:

2256 
	`put_üed
(
üed
);

2257 
ç
:

2259 
	}
}

2266 
	$dump_wr™e
(
fe
 *fe, cÚ¡ *
addr
, 
Ä
)

2268  
	`acûss_ok
(
VERIFY_READ
, 
addr
, 
Ä
è&& 
fe
->
f_İ
->
	`wr™e
(fe,‡ddr,‚r, &fe->
f_pos
) ==‚r;

2269 
	}
}

2270 
EXPORT_SYMBOL
(
dump_wr™e
);

2272 
	$dump_£ek
(
fe
 *fe, 
loff_t
 
off
)

2274 
»t
 = 1;

2276 ià(
fe
->
f_İ
->
Î£ek
 && fe->f_İ->Î£ek !ğ
no_Î£ek
) {

2277 ià(
fe
->
f_İ
->
	`Î£ek
(fe, 
off
, 
SEEK_CUR
) < 0)

2280 *
buf
 = (*)
	`g‘_z”Ûd_·ge
(
GFP_KERNEL
);

2282 ià(!
buf
)

2284 
off
 > 0) {

2285 
n
 = 
off
;

2287 ià(
n
 > 
PAGE_SIZE
)

2288 
n
 = 
PAGE_SIZE
;

2289 ià(!
	`dump_wr™e
(
fe
, 
buf
, 
n
)) {

2290 
»t
 = 0;

2293 
off
 -ğ
n
;

2295 
	`ä“_·ge
(()
buf
);

2297  
»t
;

2298 
	}
}

2299 
EXPORT_SYMBOL
(
dump_£ek
);

	@fcntl.c

7 
	~<lšux/sysÿÎs.h
>

8 
	~<lšux/š™.h
>

9 
	~<lšux/mm.h
>

10 
	~<lšux/fs.h
>

11 
	~<lšux/fe.h
>

12 
	~<lšux/fdbË.h
>

13 
	~<lšux/ÿ·b™y.h
>

14 
	~<lšux/dnÙify.h
>

15 
	~<lšux/¦ab.h
>

16 
	~<lšux/moduË.h
>

17 
	~<lšux/pe_fs_i.h
>

18 
	~<lšux/£cur™y.h
>

19 
	~<lšux/±¿û.h
>

20 
	~<lšux/sigÇl.h
>

21 
	~<lšux/rcupd©e.h
>

22 
	~<lšux/pid_Çme¥aû.h
>

24 
	~<asm/pŞl.h
>

25 
	~<asm/sigšfo.h
>

26 
	~<asm/uacûss.h
>

28 
	$£t_şo£_Ú_exec
(
fd
, 
æag
)

30 
fes_¡ruù
 *
fes
 = 
cu¼’t
->files;

31 
fdbË
 *
fdt
;

32 
	`¥š_lock
(&
fes
->
fe_lock
);

33 
fdt
 = 
	`fes_fdbË
(
fes
);

34 ià(
æag
)

35 
	`FD_SET
(
fd
, 
fdt
->
şo£_Ú_exec
);

37 
	`FD_CLR
(
fd
, 
fdt
->
şo£_Ú_exec
);

38 
	`¥š_uÆock
(&
fes
->
fe_lock
);

39 
	}
}

41 
	$g‘_şo£_Ú_exec
(
fd
)

43 
fes_¡ruù
 *
fes
 = 
cu¼’t
->files;

44 
fdbË
 *
fdt
;

45 
»s
;

46 
	`rcu_»ad_lock
();

47 
fdt
 = 
	`fes_fdbË
(
fes
);

48 
»s
 = 
	`FD_ISSET
(
fd
, 
fdt
->
şo£_Ú_exec
);

49 
	`rcu_»ad_uÆock
();

50  
»s
;

51 
	}
}

53 
	$SYSCALL_DEFINE3
(
dup3
, , 
Şdfd
, , 
Ãwfd
, , 
æags
)

55 
”r
 = -
EBADF
;

56 
fe
 * fe, *
toä“
;

57 
fes_¡ruù
 * 
fes
 = 
cu¼’t
->files;

58 
fdbË
 *
fdt
;

60 ià((
æags
 & ~
O_CLOEXEC
) != 0)

61  -
EINVAL
;

63 ià(
	`uÆik–y
(
Şdfd
 =ğ
Ãwfd
))

64  -
EINVAL
;

66 
	`¥š_lock
(&
fes
->
fe_lock
);

67 
”r
 = 
	`ex·nd_fes
(
fes
, 
Ãwfd
);

68 
fe
 = 
	`fcheck
(
Şdfd
);

69 ià(
	`uÆik–y
(!
fe
))

70 
Ebadf
;

71 ià(
	`uÆik–y
(
”r
 < 0)) {

72 ià(
”r
 =ğ-
EMFILE
)

73 
Ebadf
;

74 
out_uÆock
;

90 
”r
 = -
EBUSY
;

91 
fdt
 = 
	`fes_fdbË
(
fes
);

92 
toä“
 = 
fdt
->
fd
[
Ãwfd
];

93 ià(!
toä“
 && 
	`FD_ISSET
(
Ãwfd
, 
fdt
->
İ’_fds
))

94 
out_uÆock
;

95 
	`g‘_fe
(
fe
);

96 
	`rcu_assign_poš‹r
(
fdt
->
fd
[
Ãwfd
], 
fe
);

97 
	`FD_SET
(
Ãwfd
, 
fdt
->
İ’_fds
);

98 ià(
æags
 & 
O_CLOEXEC
)

99 
	`FD_SET
(
Ãwfd
, 
fdt
->
şo£_Ú_exec
);

101 
	`FD_CLR
(
Ãwfd
, 
fdt
->
şo£_Ú_exec
);

102 
	`¥š_uÆock
(&
fes
->
fe_lock
);

104 ià(
toä“
)

105 
	`fp_şo£
(
toä“
, 
fes
);

107  
Ãwfd
;

109 
Ebadf
:

110 
”r
 = -
EBADF
;

111 
out_uÆock
:

112 
	`¥š_uÆock
(&
fes
->
fe_lock
);

113  
”r
;

114 
	}
}

116 
	$SYSCALL_DEFINE2
(
dup2
, , 
Şdfd
, , 
Ãwfd
)

118 ià(
	`uÆik–y
(
Ãwfd
 =ğ
Şdfd
)) {

119 
fes_¡ruù
 *
fes
 = 
cu¼’t
->files;

120 
»tv®
 = 
Şdfd
;

122 
	`rcu_»ad_lock
();

123 ià(!
	`fcheck_fes
(
fes
, 
Şdfd
))

124 
»tv®
 = -
EBADF
;

125 
	`rcu_»ad_uÆock
();

126  
»tv®
;

128  
	`sys_dup3
(
Şdfd
, 
Ãwfd
, 0);

129 
	}
}

131 
	$SYSCALL_DEFINE1
(
dup
, , 
fdes
)

133 
»t
 = -
EBADF
;

134 
fe
 *fğ
	`fg‘_¿w
(
fdes
);

136 ià(
fe
) {

137 
»t
 = 
	`g‘_unu£d_fd
();

138 ià(
»t
 >= 0)

139 
	`fd_š¡®l
(
»t
, 
fe
);

141 
	`åut
(
fe
);

143  
»t
;

144 
	}
}

146 
	#SETFL_MASK
 (
O_APPEND
 | 
O_NONBLOCK
 | 
O_NDELAY
 | 
O_DIRECT
 | 
O_NOATIME
)

	)

148 
	$£tæ
(
fd
, 
fe
 * 
fp
, 
¬g
)

150 
šode
 * inodğ
fp
->
f_·th
.
d’Œy
->
d_šode
;

151 
”rÜ
 = 0;

157 ià(((
¬g
 ^ 
fp
->
f_æags
è& 
O_APPEND
è&& 
	`IS_APPEND
(
šode
))

158  -
EPERM
;

161 ià((
¬g
 & 
O_NOATIME
è&& !(
fp
->
f_æags
 & O_NOATIME))

162 ià(!
	`šode_owÃr_Ü_ÿ·bË
(
šode
))

163  -
EPERM
;

166 ià(
O_NONBLOCK
 !ğ
O_NDELAY
)

167 ià(
¬g
 & 
O_NDELAY
)

168 
¬g
 |ğ
O_NONBLOCK
;

170 ià(
¬g
 & 
O_DIRECT
) {

171 ià(!
fp
->
f_m­pšg
 || !fp->f_m­pšg->
a_İs
 ||

172 !
fp
->
f_m­pšg
->
a_İs
->
dœeù_IO
)

173  -
EINVAL
;

176 ià(
fp
->
f_İ
 && fp->f_İ->
check_æags
)

177 
”rÜ
 = 
fp
->
f_İ
->
	`check_æags
(
¬g
);

178 ià(
”rÜ
)

179  
”rÜ
;

184 ià(((
¬g
 ^ 
fp
->
f_æags
è& 
FASYNC
è&& fp->
f_İ
 &&

185 
fp
->
f_İ
->
çsync
) {

186 
”rÜ
 = 
fp
->
f_İ
->
	`çsync
(
fd
, fp, (
¬g
 & 
FASYNC
) != 0);

187 ià(
”rÜ
 < 0)

188 
out
;

189 ià(
”rÜ
 > 0)

190 
”rÜ
 = 0;

192 
	`¥š_lock
(&
fp
->
f_lock
);

193 
fp
->
f_æags
 = (
¬g
 & 
SETFL_MASK
) | (filp->f_flags & ~SETFL_MASK);

194 
	`¥š_uÆock
(&
fp
->
f_lock
);

196 
out
:

197  
”rÜ
;

198 
	}
}

200 
	$f_modown
(
fe
 *
fp
, 
pid
 *pid, 
pid_ty³
 
ty³
,

201 
fÜû
)

204 
	`wr™e_lock_œq
(&
fp
->
f_owÃr
.
lock
);

205 ià(
fÜû
 || !
fp
->
f_owÃr
.
pid
) {

206 
	`put_pid
(
fp
->
f_owÃr
.
pid
);

207 
fp
->
f_owÃr
.
pid
 = 
	`g‘_pid
(pid);

208 
fp
->
f_owÃr
.
pid_ty³
 = 
ty³
;

210 ià(
pid
) {

211 cÚ¡ 
üed
 *üed = 
	`cu¼’t_üed
();

212 
fp
->
f_owÃr
.
uid
 = 
üed
->uid;

213 
fp
->
f_owÃr
.
euid
 = 
üed
->euid;

216 
	`wr™e_uÆock_œq
(&
fp
->
f_owÃr
.
lock
);

217 
	}
}

219 
	$__f_£town
(
fe
 *
fp
, 
pid
 *pid, 
pid_ty³
 
ty³
,

220 
fÜû
)

222 
”r
;

224 
”r
 = 
	`£cur™y_fe_£t_fowÃr
(
fp
);

225 ià(
”r
)

226  
”r
;

228 
	`f_modown
(
fp
, 
pid
, 
ty³
, 
fÜû
);

230 
	}
}

231 
EXPORT_SYMBOL
(
__f_£town
);

233 
	$f_£town
(
fe
 *
fp
, 
¬g
, 
fÜû
)

235 
pid_ty³
 
ty³
;

236 
pid
 *pid;

237 
who
 = 
¬g
;

238 
»suÉ
;

239 
ty³
 = 
PIDTYPE_PID
;

240 ià(
who
 < 0) {

241 
ty³
 = 
PIDTYPE_PGID
;

242 
who
 = -who;

244 
	`rcu_»ad_lock
();

245 
pid
 = 
	`fšd_vpid
(
who
);

246 
»suÉ
 = 
	`__f_£town
(
fp
, 
pid
, 
ty³
, 
fÜû
);

247 
	`rcu_»ad_uÆock
();

248  
»suÉ
;

249 
	}
}

250 
EXPORT_SYMBOL
(
f_£town
);

252 
	$f_d–own
(
fe
 *
fp
)

254 
	`f_modown
(
fp
, 
NULL
, 
PIDTYPE_PID
, 1);

255 
	}
}

257 
pid_t
 
	$f_g‘own
(
fe
 *
fp
)

259 
pid_t
 
pid
;

260 
	`»ad_lock
(&
fp
->
f_owÃr
.
lock
);

261 
pid
 = 
	`pid_vÄ
(
fp
->
f_owÃr
.pid);

262 ià(
fp
->
f_owÃr
.
pid_ty³
 =ğ
PIDTYPE_PGID
)

263 
pid
 = -pid;

264 
	`»ad_uÆock
(&
fp
->
f_owÃr
.
lock
);

265  
pid
;

266 
	}
}

268 
	$f_£town_ex
(
fe
 *
fp
, 
¬g
)

270 
f_owÃr_ex
 * 
__u£r
 
owÃr_p
 = (* __u£r)
¬g
;

271 
f_owÃr_ex
 
owÃr
;

272 
pid
 *pid;

273 
ty³
;

274 
»t
;

276 
»t
 = 
	`cİy_äom_u£r
(&
owÃr
, 
owÃr_p
, (owner));

277 ià(
»t
)

278  -
EFAULT
;

280 
owÃr
.
ty³
) {

281 
F_OWNER_TID
:

282 
ty³
 = 
PIDTYPE_MAX
;

285 
F_OWNER_PID
:

286 
ty³
 = 
PIDTYPE_PID
;

289 
F_OWNER_PGRP
:

290 
ty³
 = 
PIDTYPE_PGID
;

294  -
EINVAL
;

297 
	`rcu_»ad_lock
();

298 
pid
 = 
	`fšd_vpid
(
owÃr
.pid);

299 ià(
owÃr
.
pid
 && !pid)

300 
»t
 = -
ESRCH
;

302 
»t
 = 
	`__f_£town
(
fp
, 
pid
, 
ty³
, 1);

303 
	`rcu_»ad_uÆock
();

305  
»t
;

306 
	}
}

308 
	$f_g‘own_ex
(
fe
 *
fp
, 
¬g
)

310 
f_owÃr_ex
 * 
__u£r
 
owÃr_p
 = (* __u£r)
¬g
;

311 
f_owÃr_ex
 
owÃr
;

312 
»t
 = 0;

314 
	`»ad_lock
(&
fp
->
f_owÃr
.
lock
);

315 
owÃr
.
pid
 = 
	`pid_vÄ
(
fp
->
f_owÃr
.pid);

316 
fp
->
f_owÃr
.
pid_ty³
) {

317 
PIDTYPE_MAX
:

318 
owÃr
.
ty³
 = 
F_OWNER_TID
;

321 
PIDTYPE_PID
:

322 
owÃr
.
ty³
 = 
F_OWNER_PID
;

325 
PIDTYPE_PGID
:

326 
owÃr
.
ty³
 = 
F_OWNER_PGRP
;

330 
	`WARN_ON
(1);

331 
»t
 = -
EINVAL
;

334 
	`»ad_uÆock
(&
fp
->
f_owÃr
.
lock
);

336 ià(!
»t
) {

337 
»t
 = 
	`cİy_to_u£r
(
owÃr_p
, &
owÃr
, (owner));

338 ià(
»t
)

339 
»t
 = -
EFAULT
;

341  
»t
;

342 
	}
}

344 
	$do_fú
(
fd
, 
cmd
, 
¬g
,

345 
fe
 *
fp
)

347 
”r
 = -
EINVAL
;

349 
cmd
) {

350 
F_DUPFD
:

351 
F_DUPFD_CLOEXEC
:

352 ià(
¬g
 >ğ
	`¾im™
(
RLIMIT_NOFILE
))

354 
”r
 = 
	`®loc_fd
(
¬g
, 
cmd
 =ğ
F_DUPFD_CLOEXEC
 ? 
O_CLOEXEC
 : 0);

355 ià(
”r
 >= 0) {

356 
	`g‘_fe
(
fp
);

357 
	`fd_š¡®l
(
”r
, 
fp
);

360 
F_GETFD
:

361 
”r
 = 
	`g‘_şo£_Ú_exec
(
fd
è? 
FD_CLOEXEC
 : 0;

363 
F_SETFD
:

364 
”r
 = 0;

365 
	`£t_şo£_Ú_exec
(
fd
, 
¬g
 & 
FD_CLOEXEC
);

367 
F_GETFL
:

368 
”r
 = 
fp
->
f_æags
;

370 
F_SETFL
:

371 
”r
 = 
	`£tæ
(
fd
, 
fp
, 
¬g
);

373 
F_GETLK
:

374 
”r
 = 
	`fú_g‘lk
(
fp
, (
æock
 
__u£r
 *è
¬g
);

376 
F_SETLK
:

377 
F_SETLKW
:

378 
”r
 = 
	`fú_£k
(
fd
, 
fp
, 
cmd
, (
æock
 
__u£r
 *è
¬g
);

380 
F_GETOWN
:

388 
”r
 = 
	`f_g‘own
(
fp
);

389 
	`fÜû_sucûssful_sysÿÎ_»tuº
();

391 
F_SETOWN
:

392 
”r
 = 
	`f_£town
(
fp
, 
¬g
, 1);

394 
F_GETOWN_EX
:

395 
”r
 = 
	`f_g‘own_ex
(
fp
, 
¬g
);

397 
F_SETOWN_EX
:

398 
”r
 = 
	`f_£town_ex
(
fp
, 
¬g
);

400 
F_GETSIG
:

401 
”r
 = 
fp
->
f_owÃr
.
signum
;

403 
F_SETSIG
:

405 ià(!
	`v®id_sigÇl
(
¬g
)) {

408 
”r
 = 0;

409 
fp
->
f_owÃr
.
signum
 = 
¬g
;

411 
F_GETLEASE
:

412 
”r
 = 
	`fú_g‘Ëa£
(
fp
);

414 
F_SETLEASE
:

415 
”r
 = 
	`fú_£—£
(
fd
, 
fp
, 
¬g
);

417 
F_NOTIFY
:

418 
”r
 = 
	`fú_dœnÙify
(
fd
, 
fp
, 
¬g
);

420 
F_SETPIPE_SZ
:

421 
F_GETPIPE_SZ
:

422 
”r
 = 
	`pe_fú
(
fp
, 
cmd
, 
¬g
);

427  
”r
;

428 
	}
}

430 
	$check_fú_cmd
(
cmd
)

432 
cmd
) {

433 
F_DUPFD
:

434 
F_DUPFD_CLOEXEC
:

435 
F_GETFD
:

436 
F_SETFD
:

437 
F_GETFL
:

441 
	}
}

443 
	$SYSCALL_DEFINE3
(
fú
, , 
fd
, , 
cmd
, , 
¬g
)

445 
fe
 *
fp
;

446 
”r
 = -
EBADF
;

448 
fp
 = 
	`fg‘_¿w
(
fd
);

449 ià(!
fp
)

450 
out
;

452 ià(
	`uÆik–y
(
fp
->
f_mode
 & 
FMODE_PATH
)) {

453 ià(!
	`check_fú_cmd
(
cmd
)) {

454 
	`åut
(
fp
);

455 
out
;

459 
”r
 = 
	`£cur™y_fe_fú
(
fp
, 
cmd
, 
¬g
);

460 ià(
”r
) {

461 
	`åut
(
fp
);

462  
”r
;

465 
”r
 = 
	`do_fú
(
fd
, 
cmd
, 
¬g
, 
fp
);

467 
	`åut
(
fp
);

468 
out
:

469  
”r
;

470 
	}
}

472 #ià
BITS_PER_LONG
 == 32

473 
	$SYSCALL_DEFINE3
(
fú64
, , 
fd
, , 
cmd
,

474 , 
¬g
)

476 
fe
 * 
fp
;

477 
”r
;

479 
”r
 = -
EBADF
;

480 
fp
 = 
	`fg‘_¿w
(
fd
);

481 ià(!
fp
)

482 
out
;

484 ià(
	`uÆik–y
(
fp
->
f_mode
 & 
FMODE_PATH
)) {

485 ià(!
	`check_fú_cmd
(
cmd
)) {

486 
	`åut
(
fp
);

487 
out
;

491 
”r
 = 
	`£cur™y_fe_fú
(
fp
, 
cmd
, 
¬g
);

492 ià(
”r
) {

493 
	`åut
(
fp
);

494  
”r
;

496 
”r
 = -
EBADF
;

498 
cmd
) {

499 
F_GETLK64
:

500 
”r
 = 
	`fú_g‘lk64
(
fp
, (
æock64
 
__u£r
 *è
¬g
);

502 
F_SETLK64
:

503 
F_SETLKW64
:

504 
”r
 = 
	`fú_£k64
(
fd
, 
fp
, 
cmd
,

505 (
æock64
 
__u£r
 *è
¬g
);

508 
”r
 = 
	`do_fú
(
fd
, 
cmd
, 
¬g
, 
fp
);

511 
	`åut
(
fp
);

512 
out
:

513  
”r
;

514 
	}
}

519 cÚ¡ 
	gbªd_bË
[
NSIGPOLL
] = {

520 
POLLIN
 | 
POLLRDNORM
,

521 
POLLOUT
 | 
POLLWRNORM
 | 
POLLWRBAND
,

522 
POLLIN
 | 
POLLRDNORM
 | 
POLLMSG
,

523 
POLLERR
,

524 
POLLPRI
 | 
POLLRDBAND
,

525 
POLLHUP
 | 
POLLERR


528 
šlše
 
	$sigio_³rm
(
sk_¡ruù
 *
p
,

529 
fown_¡ruù
 *
fown
, 
sig
)

531 cÚ¡ 
üed
 *cred;

532 
»t
;

534 
	`rcu_»ad_lock
();

535 
üed
 = 
	`__sk_üed
(
p
);

536 
»t
 = ((
fown
->
euid
 == 0 ||

537 
fown
->
euid
 =ğ
üed
->
suid
 || fown->euid =ğüed->
uid
 ||

538 
fown
->
uid
 =ğ
üed
->
suid
 || fown->uid == cred->uid) &&

539 !
	`£cur™y_fe_£nd_sigiÙask
(
p
, 
fown
, 
sig
));

540 
	`rcu_»ad_uÆock
();

541  
»t
;

542 
	}
}

544 
	$£nd_sigio_to_sk
(
sk_¡ruù
 *
p
,

545 
fown_¡ruù
 *
fown
,

546 
fd
, 
»asÚ
, 
group
)

552 
signum
 = 
	`ACCESS_ONCE
(
fown
->signum);

554 ià(!
	`sigio_³rm
(
p
, 
fown
, 
signum
))

557 
signum
) {

558 
sigšfo_t
 
si
;

566 
si
.
si_signo
 = 
signum
;

567 
si
.
si_”ºo
 = 0;

568 
si
.
si_code
 = 
»asÚ
;

572 
	`BUG_ON
((
»asÚ
 & 
__SI_MASK
è!ğ
__SI_POLL
);

573 ià(
»asÚ
 - 
POLL_IN
 >ğ
NSIGPOLL
)

574 
si
.
si_bªd
 = ~0L;

576 
si
.
si_bªd
 = 
bªd_bË
[
»asÚ
 - 
POLL_IN
];

577 
si
.
si_fd
 = 
fd
;

578 ià(!
	`do_£nd_sig_šfo
(
signum
, &
si
, 
p
, 
group
))

582 
	`do_£nd_sig_šfo
(
SIGIO
, 
SEND_SIG_PRIV
, 
p
, 
group
);

584 
	}
}

586 
	$£nd_sigio
(
fown_¡ruù
 *
fown
, 
fd
, 
bªd
)

588 
sk_¡ruù
 *
p
;

589 
pid_ty³
 
ty³
;

590 
pid
 *pid;

591 
group
 = 1;

593 
	`»ad_lock
(&
fown
->
lock
);

595 
ty³
 = 
fown
->
pid_ty³
;

596 ià(
ty³
 =ğ
PIDTYPE_MAX
) {

597 
group
 = 0;

598 
ty³
 = 
PIDTYPE_PID
;

601 
pid
 = 
fown
->pid;

602 ià(!
pid
)

603 
out_uÆock_fown
;

605 
	`»ad_lock
(&
skli¡_lock
);

606 
	`do_—ch_pid_sk
(
pid
, 
ty³
, 
p
) {

607 
	`£nd_sigio_to_sk
(
p
, 
fown
, 
fd
, 
bªd
, 
group
);

608 } 
	`whe_—ch_pid_sk
(
pid
, 
ty³
, 
p
);

609 
	`»ad_uÆock
(&
skli¡_lock
);

610 
out_uÆock_fown
:

611 
	`»ad_uÆock
(&
fown
->
lock
);

612 
	}
}

614 
	$£nd_sigurg_to_sk
(
sk_¡ruù
 *
p
,

615 
fown_¡ruù
 *
fown
, 
group
)

617 ià(
	`sigio_³rm
(
p
, 
fown
, 
SIGURG
))

618 
	`do_£nd_sig_šfo
(
SIGURG
, 
SEND_SIG_PRIV
, 
p
, 
group
);

619 
	}
}

621 
	$£nd_sigurg
(
fown_¡ruù
 *
fown
)

623 
sk_¡ruù
 *
p
;

624 
pid_ty³
 
ty³
;

625 
pid
 *pid;

626 
group
 = 1;

627 
»t
 = 0;

629 
	`»ad_lock
(&
fown
->
lock
);

631 
ty³
 = 
fown
->
pid_ty³
;

632 ià(
ty³
 =ğ
PIDTYPE_MAX
) {

633 
group
 = 0;

634 
ty³
 = 
PIDTYPE_PID
;

637 
pid
 = 
fown
->pid;

638 ià(!
pid
)

639 
out_uÆock_fown
;

641 
»t
 = 1;

643 
	`»ad_lock
(&
skli¡_lock
);

644 
	`do_—ch_pid_sk
(
pid
, 
ty³
, 
p
) {

645 
	`£nd_sigurg_to_sk
(
p
, 
fown
, 
group
);

646 } 
	`whe_—ch_pid_sk
(
pid
, 
ty³
, 
p
);

647 
	`»ad_uÆock
(&
skli¡_lock
);

648 
out_uÆock_fown
:

649 
	`»ad_uÆock
(&
fown
->
lock
);

650  
»t
;

651 
	}
}

653 
DEFINE_SPINLOCK
(
çsync_lock
);

654 
kmem_ÿche
 *
çsync_ÿche
 
	g__»ad_mo¡ly
;

656 
	$çsync_ä“_rcu
(
rcu_h—d
 *
h—d
)

658 
	`kmem_ÿche_ä“
(
çsync_ÿche
,

659 
	`cÚš”_of
(
h—d
, 
çsync_¡ruù
, 
ç_rcu
));

660 
	}
}

671 
	$çsync_»move_’Œy
(
fe
 *
fp
, 
çsync_¡ruù
 **
çµ
)

673 
çsync_¡ruù
 *
ç
, **
å
;

674 
»suÉ
 = 0;

676 
	`¥š_lock
(&
fp
->
f_lock
);

677 
	`¥š_lock
(&
çsync_lock
);

678 
å
 = 
çµ
; (
ç
 = *åè!ğ
NULL
; f°ğ&ç->
ç_Ãxt
) {

679 ià(
ç
->
ç_fe
 !ğ
fp
)

682 
	`¥š_lock_œq
(&
ç
->
ç_lock
);

683 
ç
->
ç_fe
 = 
NULL
;

684 
	`¥š_uÆock_œq
(&
ç
->
ç_lock
);

686 *
å
 = 
ç
->
ç_Ãxt
;

687 
	`ÿÎ_rcu
(&
ç
->
ç_rcu
, 
çsync_ä“_rcu
);

688 
fp
->
f_æags
 &ğ~
FASYNC
;

689 
»suÉ
 = 1;

692 
	`¥š_uÆock
(&
çsync_lock
);

693 
	`¥š_uÆock
(&
fp
->
f_lock
);

694  
»suÉ
;

695 
	}
}

697 
çsync_¡ruù
 *
	$çsync_®loc
()

699  
	`kmem_ÿche_®loc
(
çsync_ÿche
, 
GFP_KERNEL
);

700 
	}
}

707 
	$çsync_ä“
(
çsync_¡ruù
 *
Ãw
)

709 
	`kmem_ÿche_ä“
(
çsync_ÿche
, 
Ãw
);

710 
	}
}

719 
çsync_¡ruù
 *
	$çsync_š£¹_’Œy
(
fd
, 
fe
 *
fp
, 
çsync_¡ruù
 **
çµ
, çsync_¡ruù *
Ãw
)

721 
çsync_¡ruù
 *
ç
, **
å
;

723 
	`¥š_lock
(&
fp
->
f_lock
);

724 
	`¥š_lock
(&
çsync_lock
);

725 
å
 = 
çµ
; (
ç
 = *åè!ğ
NULL
; f°ğ&ç->
ç_Ãxt
) {

726 ià(
ç
->
ç_fe
 !ğ
fp
)

729 
	`¥š_lock_œq
(&
ç
->
ç_lock
);

730 
ç
->
ç_fd
 = 
fd
;

731 
	`¥š_uÆock_œq
(&
ç
->
ç_lock
);

732 
out
;

735 
	`¥š_lock_š™
(&
Ãw
->
ç_lock
);

736 
Ãw
->
magic
 = 
FASYNC_MAGIC
;

737 
Ãw
->
ç_fe
 = 
fp
;

738 
Ãw
->
ç_fd
 = 
fd
;

739 
Ãw
->
ç_Ãxt
 = *
çµ
;

740 
	`rcu_assign_poš‹r
(*
çµ
, 
Ãw
);

741 
fp
->
f_æags
 |ğ
FASYNC
;

743 
out
:

744 
	`¥š_uÆock
(&
çsync_lock
);

745 
	`¥š_uÆock
(&
fp
->
f_lock
);

746  
ç
;

747 
	}
}

753 
	$çsync_add_’Œy
(
fd
, 
fe
 *
fp
, 
çsync_¡ruù
 **
çµ
)

755 
çsync_¡ruù
 *
Ãw
;

757 
Ãw
 = 
	`çsync_®loc
();

758 ià(!
Ãw
)

759  -
ENOMEM
;

768 ià(
	`çsync_š£¹_’Œy
(
fd
, 
fp
, 
çµ
, 
Ãw
)) {

769 
	`çsync_ä“
(
Ãw
);

774 
	}
}

782 
	$çsync_h–³r
(
fd
, 
fe
 * 
fp
, 
Ú
, 
çsync_¡ruù
 **
çµ
)

784 ià(!
Ú
)

785  
	`çsync_»move_’Œy
(
fp
, 
çµ
);

786  
	`çsync_add_’Œy
(
fd
, 
fp
, 
çµ
);

787 
	}
}

789 
EXPORT_SYMBOL
(
çsync_h–³r
);

794 
	$kl_çsync_rcu
(
çsync_¡ruù
 *
ç
, 
sig
, 
bªd
)

796 
ç
) {

797 
fown_¡ruù
 *
fown
;

798 
æags
;

800 ià(
ç
->
magic
 !ğ
FASYNC_MAGIC
) {

801 
	`´štk
(
KERN_ERR
 "kill_fasync: bad magic‚umber in "

805 
	`¥š_lock_œq§ve
(&
ç
->
ç_lock
, 
æags
);

806 ià(
ç
->
ç_fe
) {

807 
fown
 = &
ç
->
ç_fe
->
f_owÃr
;

811 ià(!(
sig
 =ğ
SIGURG
 && 
fown
->
signum
 == 0))

812 
	`£nd_sigio
(
fown
, 
ç
->
ç_fd
, 
bªd
);

814 
	`¥š_uÆock_œq»¡Üe
(&
ç
->
ç_lock
, 
æags
);

815 
ç
 = 
	`rcu_d”eã»nû
(ç->
ç_Ãxt
);

817 
	}
}

819 
	$kl_çsync
(
çsync_¡ruù
 **
å
, 
sig
, 
bªd
)

824 ià(*
å
) {

825 
	`rcu_»ad_lock
();

826 
	`kl_çsync_rcu
(
	`rcu_d”eã»nû
(*
å
), 
sig
, 
bªd
);

827 
	`rcu_»ad_uÆock
();

829 
	}
}

830 
EXPORT_SYMBOL
(
kl_çsync
);

832 
__š™
 
	$fú_š™
()

839 
	`BUILD_BUG_ON
(19 - 1 !ğ
	`HWEIGHT32
(

840 
O_RDONLY
 | 
O_WRONLY
 | 
O_RDWR
 |

841 
O_CREAT
 | 
O_EXCL
 | 
O_NOCTTY
 |

842 
O_TRUNC
 | 
O_APPEND
 |

843 
__O_SYNC
 | 
O_DSYNC
 | 
FASYNC
 |

844 
O_DIRECT
 | 
O_LARGEFILE
 | 
O_DIRECTORY
 |

845 
O_NOFOLLOW
 | 
O_NOATIME
 | 
O_CLOEXEC
 |

846 
__FMODE_EXEC
 | 
O_PATH


849 
çsync_ÿche
 = 
	`kmem_ÿche_ü—‹
("fasync_cache",

850 (
çsync_¡ruù
), 0, 
SLAB_PANIC
, 
NULL
);

852 
	}
}

854 
moduË_š™
(
fú_š™
)

	@fhandle.c

1 
	~<lšux/sysÿÎs.h
>

2 
	~<lšux/¦ab.h
>

3 
	~<lšux/fs.h
>

4 
	~<lšux/fe.h
>

5 
	~<lšux/mouÁ.h
>

6 
	~<lšux/Çmei.h
>

7 
	~<lšux/expÜtfs.h
>

8 
	~<lšux/fs_¡ruù.h
>

9 
	~<lšux/f¢Ùify.h
>

10 
	~<lšux/³rsÚ®™y.h
>

11 
	~<asm/uacûss.h
>

12 
	~"š‹º®.h
"

14 
	$do_sys_Çme_to_hªdË
(
·th
 *path,

15 
fe_hªdË
 
__u£r
 *
ufh
,

16 
__u£r
 *
mÁ_id
)

18 
»tv®
;

19 
fe_hªdË
 
f_hªdË
;

20 
hªdË_dwÜds
, 
hªdË_by‹s
;

21 
fe_hªdË
 *
hªdË
 = 
NULL
;

27 ià(!
·th
->
mÁ
->
mÁ_sb
->
s_expÜt_İ
 ||

28 !
·th
->
mÁ
->
mÁ_sb
->
s_expÜt_İ
->
fh_to_d’Œy
)

29  -
EOPNOTSUPP
;

31 ià(
	`cİy_äom_u£r
(&
f_hªdË
, 
ufh
, (
fe_hªdË
)))

32  -
EFAULT
;

34 ià(
f_hªdË
.
hªdË_by‹s
 > 
MAX_HANDLE_SZ
)

35  -
EINVAL
;

37 
hªdË
 = 
	`km®loc
((
fe_hªdË
è+ 
f_hªdË
.
hªdË_by‹s
,

38 
GFP_KERNEL
);

39 ià(!
hªdË
)

40  -
ENOMEM
;

43 
hªdË_dwÜds
 = 
f_hªdË
.
hªdË_by‹s
 >> 2;

46 
»tv®
 = 
	`expÜtfs_’code_fh
(
·th
->
d’Œy
,

47 (
fid
 *)
hªdË
->
f_hªdË
,

48 &
hªdË_dwÜds
, 0);

49 
hªdË
->
hªdË_ty³
 = 
»tv®
;

51 
hªdË_by‹s
 = 
hªdË_dwÜds
 * (
u32
);

52 
hªdË
->
hªdË_by‹s
 = handle_bytes;

53 ià((
hªdË
->
hªdË_by‹s
 > 
f_hªdË
.handle_bytes) ||

54 (
»tv®
 =ğ255è|| (»tv® =ğ-
ENOSPC
)) {

64 
hªdË_by‹s
 = 0;

65 
»tv®
 = -
EOVERFLOW
;

67 
»tv®
 = 0;

69 ià(
	`cİy_to_u£r
(
mÁ_id
, &
·th
->
mÁ
->mnt_id, (*mnt_id)) ||

70 
	`cİy_to_u£r
(
ufh
, 
hªdË
,

71 (
fe_hªdË
è+ 
hªdË_by‹s
))

72 
»tv®
 = -
EFAULT
;

73 
	`kä“
(
hªdË
);

74  
»tv®
;

75 
	}
}

90 
	$SYSCALL_DEFINE5
(
Çme_to_hªdË_©
, , 
dfd
, cÚ¡ 
__u£r
 *, 
Çme
,

91 
fe_hªdË
 
__u£r
 *, 
hªdË
, __u£¸*, 
mÁ_id
,

92 , 
æag
)

94 
·th
…ath;

95 
lookup_æags
;

96 
”r
;

98 ià((
æag
 & ~(
AT_SYMLINK_FOLLOW
 | 
AT_EMPTY_PATH
)) != 0)

99  -
EINVAL
;

101 
lookup_æags
 = (
æag
 & 
AT_SYMLINK_FOLLOW
è? 
LOOKUP_FOLLOW
 : 0;

102 ià(
æag
 & 
AT_EMPTY_PATH
)

103 
lookup_æags
 |ğ
LOOKUP_EMPTY
;

104 
”r
 = 
	`u£r_·th_©
(
dfd
, 
Çme
, 
lookup_æags
, &
·th
);

105 ià(!
”r
) {

106 
”r
 = 
	`do_sys_Çme_to_hªdË
(&
·th
, 
hªdË
, 
mÁ_id
);

107 
	`·th_put
(&
·th
);

109  
”r
;

110 
	}
}

112 
vfsmouÁ
 *
	$g‘_vfsmouÁ_äom_fd
(
fd
)

114 
·th
…ath;

116 ià(
fd
 =ğ
AT_FDCWD
) {

117 
fs_¡ruù
 *
fs
 = 
cu¼’t
->fs;

118 
	`¥š_lock
(&
fs
->
lock
);

119 
·th
 = 
fs
->
pwd
;

120 
	`mÁg‘
(
·th
.
mÁ
);

121 
	`¥š_uÆock
(&
fs
->
lock
);

123 
åut_Ãeded
;

124 
fe
 *fğ
	`fg‘_light
(
fd
, &
åut_Ãeded
);

125 ià(!
fe
)

126  
	`ERR_PTR
(-
EBADF
);

127 
·th
 = 
fe
->
f_·th
;

128 
	`mÁg‘
(
·th
.
mÁ
);

129 
	`åut_light
(
fe
, 
åut_Ãeded
);

131  
·th
.
mÁ
;

132 
	}
}

134 
	$vfs_d’Œy_acû±abË
(*
cÚ‹xt
, 
d’Œy
 *dentry)

137 
	}
}

139 
	$do_hªdË_to_·th
(
mouÁdœfd
, 
fe_hªdË
 *
hªdË
,

140 
·th
 *path)

142 
»tv®
 = 0;

143 
hªdË_dwÜds
;

145 
·th
->
mÁ
 = 
	`g‘_vfsmouÁ_äom_fd
(
mouÁdœfd
);

146 ià(
	`IS_ERR
(
·th
->
mÁ
)) {

147 
»tv®
 = 
	`PTR_ERR
(
·th
->
mÁ
);

148 
out_”r
;

151 
hªdË_dwÜds
 = 
hªdË
->
hªdË_by‹s
 >> 2;

152 
·th
->
d’Œy
 = 
	`expÜtfs_decode_fh
Õ©h->
mÁ
,

153 (
fid
 *)
hªdË
->
f_hªdË
,

154 
hªdË_dwÜds
, 
hªdË
->
hªdË_ty³
,

155 
vfs_d’Œy_acû±abË
, 
NULL
);

156 ià(
	`IS_ERR
(
·th
->
d’Œy
)) {

157 
»tv®
 = 
	`PTR_ERR
(
·th
->
d’Œy
);

158 
out_mÁ
;

161 
out_mÁ
:

162 
	`mÁput
(
·th
->
mÁ
);

163 
out_”r
:

164  
»tv®
;

165 
	}
}

167 
	$hªdË_to_·th
(
mouÁdœfd
, 
fe_hªdË
 
__u£r
 *
ufh
,

168 
·th
 *path)

170 
»tv®
 = 0;

171 
fe_hªdË
 
f_hªdË
;

172 
fe_hªdË
 *
hªdË
 = 
NULL
;

179 ià(!
	`ÿ·bË
(
CAP_DAC_READ_SEARCH
)) {

180 
»tv®
 = -
EPERM
;

181 
out_”r
;

183 ià(
	`cİy_äom_u£r
(&
f_hªdË
, 
ufh
, (
fe_hªdË
))) {

184 
»tv®
 = -
EFAULT
;

185 
out_”r
;

187 ià((
f_hªdË
.
hªdË_by‹s
 > 
MAX_HANDLE_SZ
) ||

188 (
f_hªdË
.
hªdË_by‹s
 == 0)) {

189 
»tv®
 = -
EINVAL
;

190 
out_”r
;

192 
hªdË
 = 
	`km®loc
((
fe_hªdË
è+ 
f_hªdË
.
hªdË_by‹s
,

193 
GFP_KERNEL
);

194 ià(!
hªdË
) {

195 
»tv®
 = -
ENOMEM
;

196 
out_”r
;

199 ià(
	`cİy_äom_u£r
(
hªdË
, 
ufh
,

200 (
fe_hªdË
) +

201 
f_hªdË
.
hªdË_by‹s
)) {

202 
»tv®
 = -
EFAULT
;

203 
out_hªdË
;

206 
»tv®
 = 
	`do_hªdË_to_·th
(
mouÁdœfd
, 
hªdË
, 
·th
);

208 
out_hªdË
:

209 
	`kä“
(
hªdË
);

210 
out_”r
:

211  
»tv®
;

212 
	}
}

214 
	$do_hªdË_İ’
(
mouÁdœfd
,

215 
fe_hªdË
 
__u£r
 *
ufh
, 
İ’_æag
)

217 
»tv®
 = 0;

218 
·th
…ath;

219 
fe
 *file;

220 
fd
;

222 
»tv®
 = 
	`hªdË_to_·th
(
mouÁdœfd
, 
ufh
, &
·th
);

223 ià(
»tv®
)

224  
»tv®
;

226 
fd
 = 
	`g‘_unu£d_fd_æags
(
İ’_æag
);

227 ià(
fd
 < 0) {

228 
	`·th_put
(&
·th
);

229  
fd
;

231 
fe
 = 
	`fe_İ’_roÙ
(
·th
.
d’Œy
,…©h.
mÁ
, "", 
İ’_æag
);

232 ià(
	`IS_ERR
(
fe
)) {

233 
	`put_unu£d_fd
(
fd
);

234 
»tv®
 = 
	`PTR_ERR
(
fe
);

236 
»tv®
 = 
fd
;

237 
	`f¢Ùify_İ’
(
fe
);

238 
	`fd_š¡®l
(
fd
, 
fe
);

240 
	`·th_put
(&
·th
);

241  
»tv®
;

242 
	}
}

255 
	$SYSCALL_DEFINE3
(
İ’_by_hªdË_©
, , 
mouÁdœfd
,

256 
fe_hªdË
 
__u£r
 *, 
hªdË
,

257 , 
æags
)

259 
»t
;

261 ià(
	`fÜû_o_Ïrgefe
())

262 
æags
 |ğ
O_LARGEFILE
;

264 
»t
 = 
	`do_hªdË_İ’
(
mouÁdœfd
, 
hªdË
, 
æags
);

265  
»t
;

266 
	}
}

	@fifo.c

12 
	~<lšux/mm.h
>

13 
	~<lšux/fs.h
>

14 
	~<lšux/sched.h
>

15 
	~<lšux/pe_fs_i.h
>

17 
	$wa™_fÜ_·¹Ãr
(
šode
* inode, *
út
)

19 
cur
 = *
út
;

21 
cur
 =ğ*
út
) {

22 
	`pe_wa™
(
šode
->
i_pe
);

23 ià(
	`sigÇl_³ndšg
(
cu¼’t
))

26 
	}
}

28 
	$wake_up_·¹Ãr
(
šode
* inode)

30 
	`wake_up_š‹¼u±ibË
(&
šode
->
i_pe
->
wa™
);

31 
	}
}

33 
	$fifo_İ’
(
šode
 *šode, 
fe
 *
fp
)

35 
pe_šode_šfo
 *
pe
;

36 
»t
;

38 
	`mu‹x_lock
(&
šode
->
i_mu‹x
);

39 
pe
 = 
šode
->
i_pe
;

40 ià(!
pe
) {

41 
»t
 = -
ENOMEM
;

42 
pe
 = 
	`®loc_pe_šfo
(
šode
);

43 ià(!
pe
)

44 
”r_noş—nup
;

45 
šode
->
i_pe
 = 
pe
;

47 
fp
->
f_v”siÚ
 = 0;

50 
fp
->
f_mode
 &ğ(
FMODE_READ
 | 
FMODE_WRITE
);

52 
fp
->
f_mode
) {

53 
FMODE_READ
:

59 
fp
->
f_İ
 = &
»ad_pefifo_fİs
;

60 
pe
->
r_couÁ”
++;

61 ià(
pe
->
»ad”s
++ == 0)

62 
	`wake_up_·¹Ãr
(
šode
);

64 ià(!
pe
->
wr™”s
) {

65 ià((
fp
->
f_æags
 & 
O_NONBLOCK
)) {

68 
fp
->
f_v”siÚ
 = 
pe
->
w_couÁ”
;

70 
	`wa™_fÜ_·¹Ãr
(
šode
, &
pe
->
w_couÁ”
);

71 if(
	`sigÇl_³ndšg
(
cu¼’t
))

72 
”r_rd
;

77 
FMODE_WRITE
:

83 
»t
 = -
ENXIO
;

84 ià((
fp
->
f_æags
 & 
O_NONBLOCK
è&& !
pe
->
»ad”s
)

85 
”r
;

87 
fp
->
f_İ
 = &
wr™e_pefifo_fİs
;

88 
pe
->
w_couÁ”
++;

89 ià(!
pe
->
wr™”s
++)

90 
	`wake_up_·¹Ãr
(
šode
);

92 ià(!
pe
->
»ad”s
) {

93 
	`wa™_fÜ_·¹Ãr
(
šode
, &
pe
->
r_couÁ”
);

94 ià(
	`sigÇl_³ndšg
(
cu¼’t
))

95 
”r_wr
;

99 
FMODE_READ
 | 
FMODE_WRITE
:

106 
fp
->
f_İ
 = &
rdwr_pefifo_fİs
;

108 
pe
->
»ad”s
++;

109 
pe
->
wr™”s
++;

110 
pe
->
r_couÁ”
++;

111 
pe
->
w_couÁ”
++;

112 ià(
pe
->
»ad”s
 =ğ1 ||…e->
wr™”s
 == 1)

113 
	`wake_up_·¹Ãr
(
šode
);

117 
»t
 = -
EINVAL
;

118 
”r
;

122 
	`mu‹x_uÆock
(&
šode
->
i_mu‹x
);

125 
”r_rd
:

126 ià(!--
pe
->
»ad”s
)

127 
	`wake_up_š‹¼u±ibË
(&
pe
->
wa™
);

128 
»t
 = -
ERESTARTSYS
;

129 
”r
;

131 
”r_wr
:

132 ià(!--
pe
->
wr™”s
)

133 
	`wake_up_š‹¼u±ibË
(&
pe
->
wa™
);

134 
»t
 = -
ERESTARTSYS
;

135 
”r
;

137 
”r
:

138 ià(!
pe
->
»ad”s
 && !pe->
wr™”s
)

139 
	`ä“_pe_šfo
(
šode
);

141 
”r_noş—nup
:

142 
	`mu‹x_uÆock
(&
šode
->
i_mu‹x
);

143  
»t
;

144 
	}
}

151 cÚ¡ 
fe_İ”©iÚs
 
	gdef_fifo_fİs
 = {

152 .
İ’
 = 
fifo_İ’
,

153 .
	gÎ£ek
 = 
noİ_Î£ek
,

	@file.c

9 
	~<lšux/moduË.h
>

10 
	~<lšux/fs.h
>

11 
	~<lšux/mm.h
>

12 
	~<lšux/mmzÚe.h
>

13 
	~<lšux/time.h
>

14 
	~<lšux/sched.h
>

15 
	~<lšux/¦ab.h
>

16 
	~<lšux/vm®loc.h
>

17 
	~<lšux/fe.h
>

18 
	~<lšux/fdbË.h
>

19 
	~<lšux/b™İs.h
>

20 
	~<lšux/š‹¼u±.h
>

21 
	~<lšux/¥šlock.h
>

22 
	~<lšux/rcupd©e.h
>

23 
	~<lšux/wÜkqueue.h
>

25 
	sfdbË_deãr
 {

26 
¥šlock_t
 
	mlock
;

27 
wÜk_¡ruù
 
	mwq
;

28 
fdbË
 *
	mÃxt
;

31 
sysùl_Ä_İ’
 
	g__»ad_mo¡ly
 = 1024*1024;

32 
	gsysùl_Ä_İ’_mš
 = 
BITS_PER_LONG
;

33 
	gsysùl_Ä_İ’_max
 = 1024 * 1024;

41 
DEFINE_PER_CPU
(
fdbË_deãr
, 
fdbË_deãr_li¡
);

43 *
	$®loc_fdmem
(
size
)

49 ià(
size
 <ğ(
PAGE_SIZE
 << 
PAGE_ALLOC_COSTLY_ORDER
)) {

50 *
d©a
 = 
	`km®loc
(
size
, 
GFP_KERNEL
|
__GFP_NOWARN
);

51 ià(
d©a
 !ğ
NULL
)

52  
d©a
;

54  
	`vm®loc
(
size
);

55 
	}
}

57 
	$ä“_fdmem
(*
±r
)

59 
	`is_vm®loc_addr
(
±r
è? 
	`vä“
ÕŒè: 
	`kä“
(ptr);

60 
	}
}

62 
	$__ä“_fdbË
(
fdbË
 *
fdt
)

64 
	`ä“_fdmem
(
fdt
->
fd
);

65 
	`ä“_fdmem
(
fdt
->
İ’_fds
);

66 
	`kä“
(
fdt
);

67 
	}
}

69 
	$ä“_fdbË_wÜk
(
wÜk_¡ruù
 *
wÜk
)

71 
fdbË_deãr
 *
f
 =

72 
	`cÚš”_of
(
wÜk
, 
fdbË_deãr
, 
wq
);

73 
fdbË
 *
fdt
;

75 
	`¥š_lock_bh
(&
f
->
lock
);

76 
fdt
 = 
f
->
Ãxt
;

77 
f
->
Ãxt
 = 
NULL
;

78 
	`¥š_uÆock_bh
(&
f
->
lock
);

79 
fdt
) {

80 
fdbË
 *
Ãxt
 = 
fdt
->next;

82 
	`__ä“_fdbË
(
fdt
);

83 
fdt
 = 
Ãxt
;

85 
	}
}

87 
	$ä“_fdbË_rcu
(
rcu_h—d
 *
rcu
)

89 
fdbË
 *
fdt
 = 
	`cÚš”_of
(
rcu
, fdtable,„cu);

90 
fdbË_deãr
 *
fddef
;

92 
	`BUG_ON
(!
fdt
);

94 ià(
fdt
->
max_fds
 <ğ
NR_OPEN_DEFAULT
) {

99 
	`kmem_ÿche_ä“
(
fes_ÿch•
,

100 
	`cÚš”_of
(
fdt
, 
fes_¡ruù
, 
fdb
));

103 ià(!
	`is_vm®loc_addr
(
fdt
->
fd
è&& !is_vm®loc_addr(fdt->
İ’_fds
)) {

104 
	`kä“
(
fdt
->
fd
);

105 
	`kä“
(
fdt
->
İ’_fds
);

106 
	`kä“
(
fdt
);

108 
fddef
 = &
	`g‘_ıu_v¬
(
fdbË_deãr_li¡
);

109 
	`¥š_lock
(&
fddef
->
lock
);

110 
fdt
->
Ãxt
 = 
fddef
->next;

111 
fddef
->
Ãxt
 = 
fdt
;

113 
	`scheduË_wÜk
(&
fddef
->
wq
);

114 
	`¥š_uÆock
(&
fddef
->
lock
);

115 
	`put_ıu_v¬
(
fdbË_deãr_li¡
);

117 
	}
}

123 
	$cİy_fdbË
(
fdbË
 *
nfdt
, fdbË *
ofdt
)

125 
ıy
, 
£t
;

127 
	`BUG_ON
(
nfdt
->
max_fds
 < 
ofdt
->max_fds);

129 
ıy
 = 
ofdt
->
max_fds
 * (
fe
 *);

130 
£t
 = (
nfdt
->
max_fds
 - 
ofdt
->max_fdsè* (
fe
 *);

131 
	`memıy
(
nfdt
->
fd
, 
ofdt
->fd, 
ıy
);

132 
	`mem£t
((*)(
nfdt
->
fd
è+ 
ıy
, 0, 
£t
);

134 
ıy
 = 
ofdt
->
max_fds
 / 
BITS_PER_BYTE
;

135 
£t
 = (
nfdt
->
max_fds
 - 
ofdt
->max_fdsè/ 
BITS_PER_BYTE
;

136 
	`memıy
(
nfdt
->
İ’_fds
, 
ofdt
->İ’_fds, 
ıy
);

137 
	`mem£t
((*)(
nfdt
->
İ’_fds
è+ 
ıy
, 0, 
£t
);

138 
	`memıy
(
nfdt
->
şo£_Ú_exec
, 
ofdt
->şo£_Ú_exec, 
ıy
);

139 
	`mem£t
((*)(
nfdt
->
şo£_Ú_exec
è+ 
ıy
, 0, 
£t
);

140 
	}
}

142 
fdbË
 * 
	$®loc_fdbË
(
Ä
)

144 
fdbË
 *
fdt
;

145 *
d©a
;

154 
Ä
 /ğ(1024 / (
fe
 *));

155 
Ä
 = 
	`roundup_pow_of_two
(nr + 1);

156 
Ä
 *ğ(1024 / (
fe
 *));

165 ià(
	`uÆik–y
(
Ä
 > 
sysùl_Ä_İ’
))

166 
Ä
 = ((
sysùl_Ä_İ’
 - 1è| (
BITS_PER_LONG
 - 1)) + 1;

168 
fdt
 = 
	`km®loc
((
fdbË
), 
GFP_KERNEL
);

169 ià(!
fdt
)

170 
out
;

171 
fdt
->
max_fds
 = 
Ä
;

172 
d©a
 = 
	`®loc_fdmem
(
Ä
 * (
fe
 *));

173 ià(!
d©a
)

174 
out_fdt
;

175 
fdt
->
fd
 = (
fe
 **)
d©a
;

176 
d©a
 = 
	`®loc_fdmem
(
	`max_t
(,

177 2 * 
Ä
 / 
BITS_PER_BYTE
, 
L1_CACHE_BYTES
));

178 ià(!
d©a
)

179 
out_¬r
;

180 
fdt
->
İ’_fds
 = (
fd_£t
 *)
d©a
;

181 
d©a
 +ğ
Ä
 / 
BITS_PER_BYTE
;

182 
fdt
->
şo£_Ú_exec
 = (
fd_£t
 *)
d©a
;

183 
fdt
->
Ãxt
 = 
NULL
;

185  
fdt
;

187 
out_¬r
:

188 
	`ä“_fdmem
(
fdt
->
fd
);

189 
out_fdt
:

190 
	`kä“
(
fdt
);

191 
out
:

192  
NULL
;

193 
	}
}

202 
	$ex·nd_fdbË
(
fes_¡ruù
 *
fes
, 
Ä
)

203 
	`__»Ëa£s
(
fes
->
fe_lock
)

204 
	`__acquœes
(
fes
->
fe_lock
)

206 
fdbË
 *
Ãw_fdt
, *
cur_fdt
;

208 
	`¥š_uÆock
(&
fes
->
fe_lock
);

209 
Ãw_fdt
 = 
	`®loc_fdbË
(
Ä
);

210 
	`¥š_lock
(&
fes
->
fe_lock
);

211 ià(!
Ãw_fdt
)

212  -
ENOMEM
;

217 ià(
	`uÆik–y
(
Ãw_fdt
->
max_fds
 <ğ
Ä
)) {

218 
	`__ä“_fdbË
(
Ãw_fdt
);

219  -
EMFILE
;

225 
cur_fdt
 = 
	`fes_fdbË
(
fes
);

226 ià(
Ä
 >ğ
cur_fdt
->
max_fds
) {

228 
	`cİy_fdbË
(
Ãw_fdt
, 
cur_fdt
);

229 
	`rcu_assign_poš‹r
(
fes
->
fdt
, 
Ãw_fdt
);

230 ià(
cur_fdt
->
max_fds
 > 
NR_OPEN_DEFAULT
)

231 
	`ä“_fdbË
(
cur_fdt
);

234 
	`__ä“_fdbË
(
Ãw_fdt
);

237 
	}
}

247 
	$ex·nd_fes
(
fes_¡ruù
 *
fes
, 
Ä
)

249 
fdbË
 *
fdt
;

251 
fdt
 = 
	`fes_fdbË
(
fes
);

257 ià(
Ä
 >ğ
	`¾im™
(
RLIMIT_NOFILE
))

258  -
EMFILE
;

261 ià(
Ä
 < 
fdt
->
max_fds
)

265 ià(
Ä
 >ğ
sysùl_Ä_İ’
)

266  -
EMFILE
;

269  
	`ex·nd_fdbË
(
fes
, 
Ä
);

270 
	}
}

272 
	$couÁ_İ’_fes
(
fdbË
 *
fdt
)

274 
size
 = 
fdt
->
max_fds
;

275 
i
;

278 
i
 = 
size
/(8*()); i > 0; ) {

279 ià(
fdt
->
İ’_fds
->
fds_b™s
[--
i
])

282 
i
 = (i+1) * 8 * ();

283  
i
;

284 
	}
}

291 
fes_¡ruù
 *
	$dup_fd
(
fes_¡ruù
 *
Şdf
, *
”rÜp
)

293 
fes_¡ruù
 *
Ãwf
;

294 
fe
 **
Şd_fds
, **
Ãw_fds
;

295 
İ’_fes
, 
size
, 
i
;

296 
fdbË
 *
Şd_fdt
, *
Ãw_fdt
;

298 *
”rÜp
 = -
ENOMEM
;

299 
Ãwf
 = 
	`kmem_ÿche_®loc
(
fes_ÿch•
, 
GFP_KERNEL
);

300 ià(!
Ãwf
)

301 
out
;

303 
	`©omic_£t
(&
Ãwf
->
couÁ
, 1);

305 
	`¥š_lock_š™
(&
Ãwf
->
fe_lock
);

306 
Ãwf
->
Ãxt_fd
 = 0;

307 
Ãw_fdt
 = &
Ãwf
->
fdb
;

308 
Ãw_fdt
->
max_fds
 = 
NR_OPEN_DEFAULT
;

309 
Ãw_fdt
->
şo£_Ú_exec
 = (
fd_£t
 *)&
Ãwf
->
şo£_Ú_exec_š™
;

310 
Ãw_fdt
->
İ’_fds
 = (
fd_£t
 *)&
Ãwf
->
İ’_fds_š™
;

311 
Ãw_fdt
->
fd
 = &
Ãwf
->
fd_¬¿y
[0];

312 
Ãw_fdt
->
Ãxt
 = 
NULL
;

314 
	`¥š_lock
(&
Şdf
->
fe_lock
);

315 
Şd_fdt
 = 
	`fes_fdbË
(
Şdf
);

316 
İ’_fes
 = 
	`couÁ_İ’_fes
(
Şd_fdt
);

321 
	`uÆik–y
(
İ’_fes
 > 
Ãw_fdt
->
max_fds
)) {

322 
	`¥š_uÆock
(&
Şdf
->
fe_lock
);

324 ià(
Ãw_fdt
 !ğ&
Ãwf
->
fdb
)

325 
	`__ä“_fdbË
(
Ãw_fdt
);

327 
Ãw_fdt
 = 
	`®loc_fdbË
(
İ’_fes
 - 1);

328 ià(!
Ãw_fdt
) {

329 *
”rÜp
 = -
ENOMEM
;

330 
out_»Ëa£
;

334 ià(
	`uÆik–y
(
Ãw_fdt
->
max_fds
 < 
İ’_fes
)) {

335 
	`__ä“_fdbË
(
Ãw_fdt
);

336 *
”rÜp
 = -
EMFILE
;

337 
out_»Ëa£
;

345 
	`¥š_lock
(&
Şdf
->
fe_lock
);

346 
Şd_fdt
 = 
	`fes_fdbË
(
Şdf
);

347 
İ’_fes
 = 
	`couÁ_İ’_fes
(
Şd_fdt
);

350 
Şd_fds
 = 
Şd_fdt
->
fd
;

351 
Ãw_fds
 = 
Ãw_fdt
->
fd
;

353 
	`memıy
(
Ãw_fdt
->
İ’_fds
->
fds_b™s
,

354 
Şd_fdt
->
İ’_fds
->
fds_b™s
, 
İ’_fes
/8);

355 
	`memıy
(
Ãw_fdt
->
şo£_Ú_exec
->
fds_b™s
,

356 
Şd_fdt
->
şo£_Ú_exec
->
fds_b™s
, 
İ’_fes
/8);

358 
i
 = 
İ’_fes
; i != 0; i--) {

359 
fe
 *
f
 = *
Şd_fds
++;

360 ià(
f
) {

361 
	`g‘_fe
(
f
);

369 
	`FD_CLR
(
İ’_fes
 - 
i
, 
Ãw_fdt
->
İ’_fds
);

371 
	`rcu_assign_poš‹r
(*
Ãw_fds
++, 
f
);

373 
	`¥š_uÆock
(&
Şdf
->
fe_lock
);

376 
size
 = (
Ãw_fdt
->
max_fds
 - 
İ’_fes
è* (
fe
 *);

379 
	`mem£t
(
Ãw_fds
, 0, 
size
);

381 ià(
Ãw_fdt
->
max_fds
 > 
İ’_fes
) {

382 
Ëá
 = (
Ãw_fdt
->
max_fds
-
İ’_fes
)/8;

383 
¡¬t
 = 
İ’_fes
 / (8 * ());

385 
	`mem£t
(&
Ãw_fdt
->
İ’_fds
->
fds_b™s
[
¡¬t
], 0, 
Ëá
);

386 
	`mem£t
(&
Ãw_fdt
->
şo£_Ú_exec
->
fds_b™s
[
¡¬t
], 0, 
Ëá
);

389 
	`rcu_assign_poš‹r
(
Ãwf
->
fdt
, 
Ãw_fdt
);

391  
Ãwf
;

393 
out_»Ëa£
:

394 
	`kmem_ÿche_ä“
(
fes_ÿch•
, 
Ãwf
);

395 
out
:

396  
NULL
;

397 
	}
}

399 
__devš™
 
	$fdbË_deãr_li¡_š™
(
ıu
)

401 
fdbË_deãr
 *
fddef
 = &
	`³r_ıu
(
fdbË_deãr_li¡
, 
ıu
);

402 
	`¥š_lock_š™
(&
fddef
->
lock
);

403 
	`INIT_WORK
(&
fddef
->
wq
, 
ä“_fdbË_wÜk
);

404 
fddef
->
Ãxt
 = 
NULL
;

405 
	}
}

407 
__š™
 
	$fes_deãr_š™
()

409 
i
;

410 
	`fÜ_—ch_possibË_ıu
(
i
)

411 
	`fdbË_deãr_li¡_š™
(
i
);

412 
sysùl_Ä_İ’_max
 = 
	`mš
((
size_t
)
INT_MAX
, ~(size_t)0/(*)) &

413 -
BITS_PER_LONG
;

414 
	}
}

416 
fes_¡ruù
 
	gš™_fes
 = {

417 .
couÁ
 = 
ATOMIC_INIT
(1),

418 .
	gfdt
 = &
š™_fes
.
fdb
,

419 .
	gfdb
 = {

420 .
max_fds
 = 
NR_OPEN_DEFAULT
,

421 .
	gfd
 = &
š™_fes
.
fd_¬¿y
[0],

422 .
	gşo£_Ú_exec
 = (
fd_£t
 *)&
š™_fes
.
şo£_Ú_exec_š™
,

423 .
	gİ’_fds
 = (
fd_£t
 *)&
š™_fes
.
İ’_fds_š™
,

425 .
	gfe_lock
 = 
__SPIN_LOCK_UNLOCKED
(
š™_sk
.
fe_lock
),

431 
	$®loc_fd
(
¡¬t
, 
æags
)

433 
fes_¡ruù
 *
fes
 = 
cu¼’t
->files;

434 
fd
;

435 
”rÜ
;

436 
fdbË
 *
fdt
;

438 
	`¥š_lock
(&
fes
->
fe_lock
);

439 
»³©
:

440 
fdt
 = 
	`fes_fdbË
(
fes
);

441 
fd
 = 
¡¬t
;

442 ià(
fd
 < 
fes
->
Ãxt_fd
)

443 
fd
 = 
fes
->
Ãxt_fd
;

445 ià(
fd
 < 
fdt
->
max_fds
)

446 
fd
 = 
	`fšd_Ãxt_z”o_b™
(
fdt
->
İ’_fds
->
fds_b™s
,

447 
fdt
->
max_fds
, 
fd
);

449 
”rÜ
 = 
	`ex·nd_fes
(
fes
, 
fd
);

450 ià(
”rÜ
 < 0)

451 
out
;

457 ià(
”rÜ
)

458 
»³©
;

460 ià(
¡¬t
 <ğ
fes
->
Ãxt_fd
)

461 
fes
->
Ãxt_fd
 = 
fd
 + 1;

463 
	`FD_SET
(
fd
, 
fdt
->
İ’_fds
);

464 ià(
æags
 & 
O_CLOEXEC
)

465 
	`FD_SET
(
fd
, 
fdt
->
şo£_Ú_exec
);

467 
	`FD_CLR
(
fd
, 
fdt
->
şo£_Ú_exec
);

468 
”rÜ
 = 
fd
;

471 ià(
	`rcu_d”eã»nû_¿w
(
fdt
->
fd
[fd]è!ğ
NULL
) {

472 
	`´štk
(
KERN_WARNING
 "®loc_fd: slÙ %d‚Ù NULL!\n", 
fd
);

473 
	`rcu_assign_poš‹r
(
fdt
->
fd
[fd], 
NULL
);

477 
out
:

478 
	`¥š_uÆock
(&
fes
->
fe_lock
);

479  
”rÜ
;

480 
	}
}

482 
	$g‘_unu£d_fd
()

484  
	`®loc_fd
(0, 0);

485 
	}
}

486 
EXPORT_SYMBOL
(
g‘_unu£d_fd
);

	@file_table.c

8 
	~<lšux/¡ršg.h
>

9 
	~<lšux/¦ab.h
>

10 
	~<lšux/fe.h
>

11 
	~<lšux/fdbË.h
>

12 
	~<lšux/š™.h
>

13 
	~<lšux/moduË.h
>

14 
	~<lšux/fs.h
>

15 
	~<lšux/£cur™y.h
>

16 
	~<lšux/ev’Şl.h
>

17 
	~<lšux/rcupd©e.h
>

18 
	~<lšux/mouÁ.h
>

19 
	~<lšux/ÿ·b™y.h
>

20 
	~<lšux/cdev.h
>

21 
	~<lšux/f¢Ùify.h
>

22 
	~<lšux/sysùl.h
>

23 
	~<lšux/lglock.h
>

24 
	~<lšux/³rıu_couÁ”.h
>

25 
	~<lšux/³rıu.h
>

26 
	~<lšux/ima.h
>

28 
	~<lšux/©omic.h
>

30 
	~"š‹º®.h
"

33 
fes_¡©_¡ruù
 
	gfes_¡©
 = {

34 .
max_fes
 = 
NR_FILE


37 
DECLARE_LGLOCK
(
fes_lglock
);

38 
DEFINE_LGLOCK
(
fes_lglock
);

41 
kmem_ÿche
 *
fp_ÿch•
 
	g__»ad_mo¡ly
;

43 
³rıu_couÁ”
 
Ä_fes
 
	g__ÿch–še_®igÃd_š_smp
;

45 
šlše
 
	$fe_ä“_rcu
(
rcu_h—d
 *
h—d
)

47 
fe
 *
f
 = 
	`cÚš”_of
(
h—d
, fe, 
f_u
.
fu_rcuh—d
);

49 
	`put_üed
(
f
->
f_üed
);

50 
	`kmem_ÿche_ä“
(
fp_ÿch•
, 
f
);

51 
	}
}

53 
šlše
 
	$fe_ä“
(
fe
 *
f
)

55 
	`³rıu_couÁ”_dec
(&
Ä_fes
);

56 
	`fe_check_¡©e
(
f
);

57 
	`ÿÎ_rcu
(&
f
->
f_u
.
fu_rcuh—d
, 
fe_ä“_rcu
);

58 
	}
}

63 
	$g‘_Ä_fes
()

65  
	`³rıu_couÁ”_»ad_pos™ive
(&
Ä_fes
);

66 
	}
}

71 
	$g‘_max_fes
()

73  
fes_¡©
.
max_fes
;

74 
	}
}

75 
EXPORT_SYMBOL_GPL
(
g‘_max_fes
);

80 #ià
defšed
(
CONFIG_SYSCTL
è&& defšed(
CONFIG_PROC_FS
)

81 
	$´oc_Ä_fes
(
ùl_bË
 *
bË
, 
wr™e
,

82 
__u£r
 *
bufãr
, 
size_t
 *
ËÅ
, 
loff_t
 *
µos
)

84 
fes_¡©
.
Ä_fes
 = 
	`g‘_Ä_fes
();

85  
	`´oc_doulÚgvec_mšmax
(
bË
, 
wr™e
, 
bufãr
, 
ËÅ
, 
µos
);

86 
	}
}

88 
	$´oc_Ä_fes
(
ùl_bË
 *
bË
, 
wr™e
,

89 
__u£r
 *
bufãr
, 
size_t
 *
ËÅ
, 
loff_t
 *
µos
)

91  -
ENOSYS
;

92 
	}
}

105 
fe
 *
	$g‘_em±y_fp
()

107 cÚ¡ 
üed
 *üed = 
	`cu¼’t_üed
();

108 
Şd_max
;

109 
fe
 * 
f
;

114 ià(
	`g‘_Ä_fes
(è>ğ
fes_¡©
.
max_fes
 && !
	`ÿ·bË
(
CAP_SYS_ADMIN
)) {

119 ià(
	`³rıu_couÁ”_sum_pos™ive
(&
Ä_fes
è>ğ
fes_¡©
.
max_fes
)

120 
ov”
;

123 
f
 = 
	`kmem_ÿche_z®loc
(
fp_ÿch•
, 
GFP_KERNEL
);

124 ià(
f
 =ğ
NULL
)

125 
ç
;

127 
	`³rıu_couÁ”_šc
(&
Ä_fes
);

128 
f
->
f_üed
 = 
	`g‘_üed
(
üed
);

129 ià(
	`£cur™y_fe_®loc
(
f
))

130 
ç_£c
;

132 
	`INIT_LIST_HEAD
(&
f
->
f_u
.
fu_li¡
);

133 
	`©omic_lÚg_£t
(&
f
->
f_couÁ
, 1);

134 
	`rwlock_š™
(&
f
->
f_owÃr
.
lock
);

135 
	`¥š_lock_š™
(&
f
->
f_lock
);

136 
	`ev’Şl_š™_fe
(
f
);

138  
f
;

140 
ov”
:

142 ià(
	`g‘_Ä_fes
(è> 
Şd_max
) {

143 
	`´_šfo
("VFS: fe-max†im™ %lu„—ched\n", 
	`g‘_max_fes
());

144 
Şd_max
 = 
	`g‘_Ä_fes
();

146 
ç
;

148 
ç_£c
:

149 
	`fe_ä“
(
f
);

150 
ç
:

151  
NULL
;

152 
	}
}

169 
fe
 *
	$®loc_fe
(
·th
 *·th, 
fmode_t
 
mode
,

170 cÚ¡ 
fe_İ”©iÚs
 *
fİ
)

172 
fe
 *file;

174 
fe
 = 
	`g‘_em±y_fp
();

175 ià(!
fe
)

176  
NULL
;

178 
fe
->
f_·th
 = *
·th
;

179 
fe
->
f_m­pšg
 = 
·th
->
d’Œy
->
d_šode
->
i_m­pšg
;

180 
fe
->
f_mode
 = 
mode
;

181 
fe
->
f_İ
 = 
fİ
;

189 ià((
mode
 & 
FMODE_WRITE
è&& !
	`¥ecŸl_fe
(
·th
->
d’Œy
->
d_šode
->
i_mode
)) {

190 
	`fe_ke_wr™e
(
fe
);

191 
	`WARN_ON
(
	`mÁ_şÚe_wr™e
(
·th
->
mÁ
));

193 ià((
mode
 & (
FMODE_READ
 | 
FMODE_WRITE
)) == FMODE_READ)

194 
	`i_»adcouÁ_šc
(
·th
->
d’Œy
->
d_šode
);

195  
fe
;

196 
	}
}

197 
EXPORT_SYMBOL
(
®loc_fe
);

207 
	$drİ_fe_wr™e_acûss
(
fe
 *file)

209 
vfsmouÁ
 *
mÁ
 = 
fe
->
f_·th
.mnt;

210 
d’Œy
 *d’Œy = 
fe
->
f_·th
.dentry;

211 
šode
 *šodğ
d’Œy
->
d_šode
;

213 
	`put_wr™e_acûss
(
šode
);

215 ià(
	`¥ecŸl_fe
(
šode
->
i_mode
))

217 ià(
	`fe_check_wr™—bË
(
fe
) != 0)

219 
	`mÁ_drİ_wr™e
(
mÁ
);

220 
	`fe_»Ëa£_wr™e
(
fe
);

221 
	}
}

222 
EXPORT_SYMBOL_GPL
(
drİ_fe_wr™e_acûss
);

226 
	$__åut
(
fe
 *file)

228 
d’Œy
 *d’Œy = 
fe
->
f_·th
.dentry;

229 
vfsmouÁ
 *
mÁ
 = 
fe
->
f_·th
.mnt;

230 
šode
 *šodğ
d’Œy
->
d_šode
;

232 
	`might_¦“p
();

234 
	`f¢Ùify_şo£
(
fe
);

239 
	`ev’Şl_»Ëa£
(
fe
);

240 
	`locks_»move_æock
(
fe
);

242 ià(
	`uÆik–y
(
fe
->
f_æags
 & 
FASYNC
)) {

243 ià(
fe
->
f_İ
 && fe->f_İ->
çsync
)

244 
fe
->
f_İ
->
	`çsync
(-1, file, 0);

246 ià(
fe
->
f_İ
 && fe->f_İ->
»Ëa£
)

247 
fe
->
f_İ
->
	`»Ëa£
(
šode
, file);

248 
	`£cur™y_fe_ä“
(
fe
);

249 
	`ima_fe_ä“
(
fe
);

250 ià(
	`uÆik–y
(
	`S_ISCHR
(
šode
->
i_mode
è&& inode->
i_cdev
 !ğ
NULL
 &&

251 !(
fe
->
f_mode
 & 
FMODE_PATH
))) {

252 
	`cdev_put
(
šode
->
i_cdev
);

254 
	`fİs_put
(
fe
->
f_İ
);

255 
	`put_pid
(
fe
->
f_owÃr
.
pid
);

256 
	`fe_sb_li¡_d–
(
fe
);

257 ià((
fe
->
f_mode
 & (
FMODE_READ
 | 
FMODE_WRITE
)) == FMODE_READ)

258 
	`i_»adcouÁ_dec
(
šode
);

259 ià(
fe
->
f_mode
 & 
FMODE_WRITE
)

260 
	`drİ_fe_wr™e_acûss
(
fe
);

261 
fe
->
f_·th
.
d’Œy
 = 
NULL
;

262 
fe
->
f_·th
.
mÁ
 = 
NULL
;

263 
	`fe_ä“
(
fe
);

264 
	`dput
(
d’Œy
);

265 
	`mÁput
(
mÁ
);

266 
	}
}

268 
	$åut
(
fe
 *file)

270 ià(
	`©omic_lÚg_dec_ªd_‹¡
(&
fe
->
f_couÁ
))

271 
	`__åut
(
fe
);

272 
	}
}

274 
EXPORT_SYMBOL
(
åut
);

276 
fe
 *
	$fg‘
(
fd
)

278 
fe
 *file;

279 
fes_¡ruù
 *
fes
 = 
cu¼’t
->files;

281 
	`rcu_»ad_lock
();

282 
fe
 = 
	`fcheck_fes
(
fes
, 
fd
);

283 ià(
fe
) {

285 ià(
fe
->
f_mode
 & 
FMODE_PATH
 ||

286 !
	`©omic_lÚg_šc_nÙ_z”o
(&
fe
->
f_couÁ
))

287 
fe
 = 
NULL
;

289 
	`rcu_»ad_uÆock
();

291  
fe
;

292 
	}
}

294 
EXPORT_SYMBOL
(
fg‘
);

296 
fe
 *
	$fg‘_¿w
(
fd
)

298 
fe
 *file;

299 
fes_¡ruù
 *
fes
 = 
cu¼’t
->files;

301 
	`rcu_»ad_lock
();

302 
fe
 = 
	`fcheck_fes
(
fes
, 
fd
);

303 ià(
fe
) {

305 ià(!
	`©omic_lÚg_šc_nÙ_z”o
(&
fe
->
f_couÁ
))

306 
fe
 = 
NULL
;

308 
	`rcu_»ad_uÆock
();

310  
fe
;

311 
	}
}

313 
EXPORT_SYMBOL
(
fg‘_¿w
);

331 
fe
 *
	$fg‘_light
(
fd
, *
åut_Ãeded
)

333 
fe
 *file;

334 
fes_¡ruù
 *
fes
 = 
cu¼’t
->files;

336 *
åut_Ãeded
 = 0;

337 ià(
	`©omic_»ad
(&
fes
->
couÁ
) == 1) {

338 
fe
 = 
	`fcheck_fes
(
fes
, 
fd
);

339 ià(
fe
 && (fe->
f_mode
 & 
FMODE_PATH
))

340 
fe
 = 
NULL
;

342 
	`rcu_»ad_lock
();

343 
fe
 = 
	`fcheck_fes
(
fes
, 
fd
);

344 ià(
fe
) {

345 ià(!(
fe
->
f_mode
 & 
FMODE_PATH
) &&

346 
	`©omic_lÚg_šc_nÙ_z”o
(&
fe
->
f_couÁ
))

347 *
åut_Ãeded
 = 1;

350 
fe
 = 
NULL
;

352 
	`rcu_»ad_uÆock
();

355  
fe
;

356 
	}
}

358 
fe
 *
	$fg‘_¿w_light
(
fd
, *
åut_Ãeded
)

360 
fe
 *file;

361 
fes_¡ruù
 *
fes
 = 
cu¼’t
->files;

363 *
åut_Ãeded
 = 0;

364 ià(
	`©omic_»ad
(&
fes
->
couÁ
) == 1) {

365 
fe
 = 
	`fcheck_fes
(
fes
, 
fd
);

367 
	`rcu_»ad_lock
();

368 
fe
 = 
	`fcheck_fes
(
fes
, 
fd
);

369 ià(
fe
) {

370 ià(
	`©omic_lÚg_šc_nÙ_z”o
(&
fe
->
f_couÁ
))

371 *
åut_Ãeded
 = 1;

374 
fe
 = 
NULL
;

376 
	`rcu_»ad_uÆock
();

379  
fe
;

380 
	}
}

382 
	$put_fp
(
fe
 *file)

384 ià(
	`©omic_lÚg_dec_ªd_‹¡
(&
fe
->
f_couÁ
)) {

385 
	`£cur™y_fe_ä“
(
fe
);

386 
	`fe_sb_li¡_d–
(
fe
);

387 
	`fe_ä“
(
fe
);

389 
	}
}

391 
šlše
 
	$fe_li¡_ıu
(
fe
 *file)

393 #ifdeà
CONFIG_SMP


394  
fe
->
f_sb_li¡_ıu
;

396  
	`smp_´oûssÜ_id
();

398 
	}
}

401 
šlše
 
	$__fe_sb_li¡_add
(
fe
 *fe, 
su³r_block
 *
sb
)

403 
li¡_h—d
 *
li¡
;

404 #ifdeà
CONFIG_SMP


405 
ıu
;

406 
ıu
 = 
	`smp_´oûssÜ_id
();

407 
fe
->
f_sb_li¡_ıu
 = 
ıu
;

408 
li¡
 = 
	`³r_ıu_±r
(
sb
->
s_fes
, 
ıu
);

410 
li¡
 = &
sb
->
s_fes
;

412 
	`li¡_add
(&
fe
->
f_u
.
fu_li¡
, 
li¡
);

413 
	}
}

423 
	$fe_sb_li¡_add
(
fe
 *fe, 
su³r_block
 *
sb
)

425 
	`lg_loÿl_lock
(
fes_lglock
);

426 
	`__fe_sb_li¡_add
(
fe
, 
sb
);

427 
	`lg_loÿl_uÆock
(
fes_lglock
);

428 
	}
}

437 
	$fe_sb_li¡_d–
(
fe
 *file)

439 ià(!
	`li¡_em±y
(&
fe
->
f_u
.
fu_li¡
)) {

440 
	`lg_loÿl_lock_ıu
(
fes_lglock
, 
	`fe_li¡_ıu
(
fe
));

441 
	`li¡_d–_š™
(&
fe
->
f_u
.
fu_li¡
);

442 
	`lg_loÿl_uÆock_ıu
(
fes_lglock
, 
	`fe_li¡_ıu
(
fe
));

444 
	}
}

446 #ifdeà
CONFIG_SMP


452 
	#do_fe_li¡_fÜ_—ch_’Œy
(
__sb
, 
__fe
) \

454 
i
; \

455 
	`fÜ_—ch_possibË_ıu
(
i
) { \

456 
li¡_h—d
 *
li¡
; \

457 
li¡
 = 
	`³r_ıu_±r
((
__sb
)->
s_fes
, 
i
); \

458 
	`li¡_fÜ_—ch_’Œy
((
__fe
), 
li¡
, 
f_u
.
fu_li¡
)

	)

460 
	#whe_fe_li¡_fÜ_—ch_’Œy
 \

462 }

	)

466 
	#do_fe_li¡_fÜ_—ch_’Œy
(
__sb
, 
__fe
) \

468 
li¡_h—d
 *
li¡
; \

469 
li¡
 = &(
sb
)->
s_fes
; \

470 
	`li¡_fÜ_—ch_’Œy
((
__fe
), 
li¡
, 
f_u
.
fu_li¡
)

	)

472 
	#whe_fe_li¡_fÜ_—ch_’Œy
 \

473 }

	)

477 
	$fs_may_»mouÁ_ro
(
su³r_block
 *
sb
)

479 
fe
 *file;

481 
	`lg_glob®_lock
(
fes_lglock
);

482 
	`do_fe_li¡_fÜ_—ch_’Œy
(
sb
, 
fe
) {

483 
šode
 *šodğ
fe
->
f_·th
.
d’Œy
->
d_šode
;

486 ià(
šode
->
i_Æšk
 == 0)

487 
too_bad
;

490 ià(
	`S_ISREG
(
šode
->
i_mode
è&& (
fe
->
f_mode
 & 
FMODE_WRITE
))

491 
too_bad
;

492 } 
whe_fe_li¡_fÜ_—ch_’Œy
;

493 
	`lg_glob®_uÆock
(
fes_lglock
);

495 
too_bad
:

496 
	`lg_glob®_uÆock
(
fes_lglock
);

498 
	}
}

507 
	$m¬k_fes_ro
(
su³r_block
 *
sb
)

509 
fe
 *
f
;

511 
»Œy
:

512 
	`lg_glob®_lock
(
fes_lglock
);

513 
	`do_fe_li¡_fÜ_—ch_’Œy
(
sb
, 
f
) {

514 
vfsmouÁ
 *
mÁ
;

515 ià(!
	`S_ISREG
(
f
->
f_·th
.
d’Œy
->
d_šode
->
i_mode
))

517 ià(!
	`fe_couÁ
(
f
))

519 ià(!(
f
->
f_mode
 & 
FMODE_WRITE
))

521 
	`¥š_lock
(&
f
->
f_lock
);

522 
f
->
f_mode
 &ğ~
FMODE_WRITE
;

523 
	`¥š_uÆock
(&
f
->
f_lock
);

524 ià(
	`fe_check_wr™—bË
(
f
) != 0)

526 
	`fe_»Ëa£_wr™e
(
f
);

527 
mÁ
 = 
	`mÁg‘
(
f
->
f_·th
.mnt);

529 
	`lg_glob®_uÆock
(
fes_lglock
);

530 
	`mÁ_drİ_wr™e
(
mÁ
);

531 
	`mÁput
(
mÁ
);

532 
»Œy
;

533 } 
whe_fe_li¡_fÜ_—ch_’Œy
;

534 
	`lg_glob®_uÆock
(
fes_lglock
);

535 
	}
}

537 
__š™
 
	$fes_š™
(
mem·ges
)

539 
n
;

541 
fp_ÿch•
 = 
	`kmem_ÿche_ü—‹
("fp", (
fe
), 0,

542 
SLAB_HWCACHE_ALIGN
 | 
SLAB_PANIC
, 
NULL
);

549 
n
 = (
mem·ges
 * (
PAGE_SIZE
 / 1024)) / 10;

550 
fes_¡©
.
max_fes
 = 
	`max_t
(, 
n
, 
NR_FILE
);

551 
	`fes_deãr_š™
();

552 
	`lg_lock_š™
(
fes_lglock
);

553 
	`³rıu_couÁ”_š™
(&
Ä_fes
, 0);

554 
	}
}

	@filesystems.c

9 
	~<lšux/sysÿÎs.h
>

10 
	~<lšux/fs.h
>

11 
	~<lšux/´oc_fs.h
>

12 
	~<lšux/£q_fe.h
>

13 
	~<lšux/kmod.h
>

14 
	~<lšux/š™.h
>

15 
	~<lšux/moduË.h
>

16 
	~<lšux/¦ab.h
>

17 
	~<asm/uacûss.h
>

32 
fe_sy¡em_ty³
 *
	gfe_sy¡ems
;

33 
DEFINE_RWLOCK
(
fe_sy¡ems_lock
);

36 
	$g‘_fesy¡em
(
fe_sy¡em_ty³
 *
fs
)

38 
	`__moduË_g‘
(
fs
->
owÃr
);

39 
	}
}

41 
	$put_fesy¡em
(
fe_sy¡em_ty³
 *
fs
)

43 
	`moduË_put
(
fs
->
owÃr
);

44 
	}
}

46 
fe_sy¡em_ty³
 **
	$fšd_fesy¡em
(cÚ¡ *
Çme
, 
Ën
)

48 
fe_sy¡em_ty³
 **
p
;

49 
p
=&
fe_sy¡ems
; *p;…=&(*p)->
Ãxt
)

50 ià(
	`¡¾’
((*
p
)->
Çme
è=ğ
Ën
 &&

51 
	`¡ºcmp
((*
p
)->
Çme
,‚ame, 
Ën
) == 0)

53  
p
;

54 
	}
}

69 
	$»gi¡”_fesy¡em
(
fe_sy¡em_ty³
 * 
fs
)

71 
»s
 = 0;

72 
fe_sy¡em_ty³
 ** 
p
;

74 
	`BUG_ON
(
	`¡rchr
(
fs
->
Çme
, '.'));

75 ià(
fs
->
Ãxt
)

76  -
EBUSY
;

77 
	`INIT_LIST_HEAD
(&
fs
->
fs_su³rs
);

78 
	`wr™e_lock
(&
fe_sy¡ems_lock
);

79 
p
 = 
	`fšd_fesy¡em
(
fs
->
Çme
, 
	`¡¾’
(fs->name));

80 ià(*
p
)

81 
»s
 = -
EBUSY
;

83 *
p
 = 
fs
;

84 
	`wr™e_uÆock
(&
fe_sy¡ems_lock
);

85  
»s
;

86 
	}
}

88 
EXPORT_SYMBOL
(
»gi¡”_fesy¡em
);

102 
	$uÄegi¡”_fesy¡em
(
fe_sy¡em_ty³
 * 
fs
)

104 
fe_sy¡em_ty³
 ** 
tmp
;

106 
	`wr™e_lock
(&
fe_sy¡ems_lock
);

107 
tmp
 = &
fe_sy¡ems
;

108 *
tmp
) {

109 ià(
fs
 =ğ*
tmp
) {

110 *
tmp
 = 
fs
->
Ãxt
;

111 
fs
->
Ãxt
 = 
NULL
;

112 
	`wr™e_uÆock
(&
fe_sy¡ems_lock
);

113 
	`synchrÚize_rcu
();

116 
tmp
 = &(*tmp)->
Ãxt
;

118 
	`wr™e_uÆock
(&
fe_sy¡ems_lock
);

120  -
EINVAL
;

121 
	}
}

123 
EXPORT_SYMBOL
(
uÄegi¡”_fesy¡em
);

125 
	$fs_šdex
(cÚ¡ 
__u£r
 * 
__Çme
)

127 
fe_sy¡em_ty³
 * 
tmp
;

128 * 
Çme
;

129 
”r
, 
šdex
;

131 
Çme
 = 
	`g‘Çme
(
__Çme
);

132 
”r
 = 
	`PTR_ERR
(
Çme
);

133 ià(
	`IS_ERR
(
Çme
))

134  
”r
;

136 
”r
 = -
EINVAL
;

137 
	`»ad_lock
(&
fe_sy¡ems_lock
);

138 
tmp
=
fe_sy¡ems
, 
šdex
=0 ;m°;mpñmp->
Ãxt
, index++) {

139 ià(
	`¡rcmp
(
tmp
->
Çme
,name) == 0) {

140 
”r
 = 
šdex
;

144 
	`»ad_uÆock
(&
fe_sy¡ems_lock
);

145 
	`puŠame
(
Çme
);

146  
”r
;

147 
	}
}

149 
	$fs_Çme
(
šdex
, 
__u£r
 * 
buf
)

151 
fe_sy¡em_ty³
 * 
tmp
;

152 
Ën
, 
»s
;

154 
	`»ad_lock
(&
fe_sy¡ems_lock
);

155 
tmp
 = 
fe_sy¡ems
;mp;m°ğtmp->
Ãxt
, 
šdex
--)

156 ià(
šdex
 <ğ0 && 
	`Œy_moduË_g‘
(
tmp
->
owÃr
))

158 
	`»ad_uÆock
(&
fe_sy¡ems_lock
);

159 ià(!
tmp
)

160  -
EINVAL
;

163 
Ën
 = 
	`¡¾’
(
tmp
->
Çme
) + 1;

164 
»s
 = 
	`cİy_to_u£r
(
buf
, 
tmp
->
Çme
, 
Ën
è? -
EFAULT
 : 0;

165 
	`put_fesy¡em
(
tmp
);

166  
»s
;

167 
	}
}

169 
	$fs_maxšdex
()

171 
fe_sy¡em_ty³
 * 
tmp
;

172 
šdex
;

174 
	`»ad_lock
(&
fe_sy¡ems_lock
);

175 
tmp
 = 
fe_sy¡ems
, 
šdex
 = 0 ;m°;m°ğtmp->
Ãxt
, index++)

177 
	`»ad_uÆock
(&
fe_sy¡ems_lock
);

178  
šdex
;

179 
	}
}

184 
	$SYSCALL_DEFINE3
(
sysfs
, , 
İtiÚ
, , 
¬g1
, , 
¬g2
)

186 
»tv®
 = -
EINVAL
;

188 
İtiÚ
) {

190 
»tv®
 = 
	`fs_šdex
((cÚ¡ 
__u£r
 *è
¬g1
);

194 
»tv®
 = 
	`fs_Çme
(
¬g1
, (
__u£r
 *è
¬g2
);

198 
»tv®
 = 
	`fs_maxšdex
();

201  
»tv®
;

202 
	}
}

204 
__š™
 
	$g‘_fesy¡em_li¡
(*
buf
)

206 
Ën
 = 0;

207 
fe_sy¡em_ty³
 * 
tmp
;

209 
	`»ad_lock
(&
fe_sy¡ems_lock
);

210 
tmp
 = 
fe_sy¡ems
;

211 
tmp
 && 
Ën
 < 
PAGE_SIZE
 - 80) {

212 
Ën
 +ğ
	`¥rštf
(
buf
+len, "%s\t%s\n",

213 (
tmp
->
fs_æags
 & 
FS_REQUIRES_DEV
) ? "" : "nodev",

214 
tmp
->
Çme
);

215 
tmp
 =mp->
Ãxt
;

217 
	`»ad_uÆock
(&
fe_sy¡ems_lock
);

218  
Ën
;

219 
	}
}

221 #ifdeà
CONFIG_PROC_FS


222 
	$fesy¡ems_´oc_show
(
£q_fe
 *
m
, *
v
)

224 
fe_sy¡em_ty³
 * 
tmp
;

226 
	`»ad_lock
(&
fe_sy¡ems_lock
);

227 
tmp
 = 
fe_sy¡ems
;

228 
tmp
) {

229 
	`£q_´štf
(
m
, "%s\t%s\n",

230 (
tmp
->
fs_æags
 & 
FS_REQUIRES_DEV
) ? "" : "nodev",

231 
tmp
->
Çme
);

232 
tmp
 =mp->
Ãxt
;

234 
	`»ad_uÆock
(&
fe_sy¡ems_lock
);

236 
	}
}

238 
	$fesy¡ems_´oc_İ’
(
šode
 *šode, 
fe
 *file)

240  
	`sšgË_İ’
(
fe
, 
fesy¡ems_´oc_show
, 
NULL
);

241 
	}
}

243 cÚ¡ 
fe_İ”©iÚs
 
	gfesy¡ems_´oc_fİs
 = {

244 .
İ’
 = 
fesy¡ems_´oc_İ’
,

245 .
	g»ad
 = 
£q_»ad
,

246 .
	gÎ£ek
 = 
£q_l£ek
,

247 .
	g»Ëa£
 = 
sšgË_»Ëa£
,

250 
__š™
 
	$´oc_fesy¡ems_š™
()

252 
	`´oc_ü—‹
("fesy¡ems", 0, 
NULL
, &
fesy¡ems_´oc_fİs
);

254 
	}
}

255 
moduË_š™
(
´oc_fesy¡ems_š™
);

258 
fe_sy¡em_ty³
 *
	$__g‘_fs_ty³
(cÚ¡ *
Çme
, 
Ën
)

260 
fe_sy¡em_ty³
 *
fs
;

262 
	`»ad_lock
(&
fe_sy¡ems_lock
);

263 
fs
 = *(
	`fšd_fesy¡em
(
Çme
, 
Ën
));

264 ià(
fs
 && !
	`Œy_moduË_g‘
(fs->
owÃr
))

265 
fs
 = 
NULL
;

266 
	`»ad_uÆock
(&
fe_sy¡ems_lock
);

267  
fs
;

268 
	}
}

270 
fe_sy¡em_ty³
 *
	$g‘_fs_ty³
(cÚ¡ *
Çme
)

272 
fe_sy¡em_ty³
 *
fs
;

273 cÚ¡ *
dÙ
 = 
	`¡rchr
(
Çme
, '.');

274 
Ën
 = 
dÙ
 ? dÙ - 
Çme
 : 
	`¡¾’
(name);

276 
fs
 = 
	`__g‘_fs_ty³
(
Çme
, 
Ën
);

277 ià(!
fs
 && (
	`»que¡_moduË
("%.*s", 
Ën
, 
Çme
) == 0))

278 
fs
 = 
	`__g‘_fs_ty³
(
Çme
, 
Ën
);

280 ià(
dÙ
 && 
fs
 && !(fs->
fs_æags
 & 
FS_HAS_SUBTYPE
)) {

281 
	`put_fesy¡em
(
fs
);

282 
fs
 = 
NULL
;

284  
fs
;

285 
	}
}

287 
EXPORT_SYMBOL
(
g‘_fs_ty³
);

	@fs-writeback.c

16 
	~<lšux/k”Ãl.h
>

17 
	~<lšux/moduË.h
>

18 
	~<lšux/¥šlock.h
>

19 
	~<lšux/¦ab.h
>

20 
	~<lšux/sched.h
>

21 
	~<lšux/fs.h
>

22 
	~<lšux/mm.h
>

23 
	~<lšux/kth»ad.h
>

24 
	~<lšux/ä“z”.h
>

25 
	~<lšux/wr™eback.h
>

26 
	~<lšux/blkdev.h
>

27 
	~<lšux/backšg-dev.h
>

28 
	~<lšux/bufãr_h—d.h
>

29 
	~<lšux/Œaûpošt.h
>

30 
	~"š‹º®.h
"

35 
	swb_wr™eback_wÜk
 {

36 
	mÄ_·ges
;

37 
su³r_block
 *
	msb
;

38 *
	mŞd”_thª_this
;

39 
wr™eback_sync_modes
 
	msync_mode
;

40 
	mgged_wr™•ages
:1;

41 
	mfÜ_kupd©e
:1;

42 
	m¿nge_cyşic
:1;

43 
	mfÜ_background
:1;

44 
wb_»asÚ
 
	m»asÚ
;

46 
li¡_h—d
 
	mli¡
;

47 
com¶‘iÚ
 *
	mdÚe
;

55 
	#CREATE_TRACE_POINTS


	)

56 
	~<Œaû/ev’ts/wr™eback.h
>

61 
	gÄ_pdæush_th»ads
;

70 
	$wr™eback_š_´og»ss
(
backšg_dev_šfo
 *
bdi
)

72  
	`‹¡_b™
(
BDI_wr™eback_ruÂšg
, &
bdi
->
¡©e
);

73 
	}
}

75 
šlše
 
backšg_dev_šfo
 *
	$šode_to_bdi
(
šode
 *inode)

77 
su³r_block
 *
sb
 = 
šode
->
i_sb
;

79 ià(
	`¡rcmp
(
sb
->
s_ty³
->
Çme
, "bdev") == 0)

80  
šode
->
i_m­pšg
->
backšg_dev_šfo
;

82  
sb
->
s_bdi
;

83 
	}
}

85 
šlše
 
šode
 *
	$wb_šode
(
li¡_h—d
 *
h—d
)

87  
	`li¡_’Œy
(
h—d
, 
šode
, 
i_wb_li¡
);

88 
	}
}

91 
	$bdi_wakeup_æush”
(
backšg_dev_šfo
 *
bdi
)

93 ià(
bdi
->
wb
.
sk
) {

94 
	`wake_up_´oûss
(
bdi
->
wb
.
sk
);

100 
	`wake_up_´oûss
(
deçuÉ_backšg_dev_šfo
.
wb
.
sk
);

102 
	}
}

104 
	$bdi_queue_wÜk
(
backšg_dev_šfo
 *
bdi
,

105 
wb_wr™eback_wÜk
 *
wÜk
)

107 
	`Œaû_wr™eback_queue
(
bdi
, 
wÜk
);

109 
	`¥š_lock_bh
(&
bdi
->
wb_lock
);

110 
	`li¡_add_
(&
wÜk
->
li¡
, &
bdi
->
wÜk_li¡
);

111 ià(!
bdi
->
wb
.
sk
)

112 
	`Œaû_wr™eback_nÙh»ad
(
bdi
, 
wÜk
);

113 
	`bdi_wakeup_æush”
(
bdi
);

114 
	`¥š_uÆock_bh
(&
bdi
->
wb_lock
);

115 
	}
}

118 
	$__bdi_¡¬t_wr™eback
(
backšg_dev_šfo
 *
bdi
, 
Ä_·ges
,

119 
boŞ
 
¿nge_cyşic
, 
wb_»asÚ
 
»asÚ
)

121 
wb_wr™eback_wÜk
 *
wÜk
;

127 
wÜk
 = 
	`kz®loc
((*wÜk), 
GFP_ATOMIC
);

128 ià(!
wÜk
) {

129 ià(
bdi
->
wb
.
sk
) {

130 
	`Œaû_wr™eback_nowÜk
(
bdi
);

131 
	`wake_up_´oûss
(
bdi
->
wb
.
sk
);

136 
wÜk
->
sync_mode
 = 
WB_SYNC_NONE
;

137 
wÜk
->
Ä_·ges
 =‚r_pages;

138 
wÜk
->
¿nge_cyşic
 =„ange_cyclic;

139 
wÜk
->
»asÚ
 =„eason;

141 
	`bdi_queue_wÜk
(
bdi
, 
wÜk
);

142 
	}
}

156 
	$bdi_¡¬t_wr™eback
(
backšg_dev_šfo
 *
bdi
, 
Ä_·ges
,

157 
wb_»asÚ
 
»asÚ
)

159 
	`__bdi_¡¬t_wr™eback
(
bdi
, 
Ä_·ges
, 
Œue
, 
»asÚ
);

160 
	}
}

172 
	$bdi_¡¬t_background_wr™eback
(
backšg_dev_šfo
 *
bdi
)

178 
	`Œaû_wr™eback_wake_background
(
bdi
);

179 
	`¥š_lock_bh
(&
bdi
->
wb_lock
);

180 
	`bdi_wakeup_æush”
(
bdi
);

181 
	`¥š_uÆock_bh
(&
bdi
->
wb_lock
);

182 
	}
}

187 
	$šode_wb_li¡_d–
(
šode
 *inode)

189 
backšg_dev_šfo
 *
bdi
 = 
	`šode_to_bdi
(
šode
);

191 
	`¥š_lock
(&
bdi
->
wb
.
li¡_lock
);

192 
	`li¡_d–_š™
(&
šode
->
i_wb_li¡
);

193 
	`¥š_uÆock
(&
bdi
->
wb
.
li¡_lock
);

194 
	}
}

205 
	$»dœty_
(
šode
 *šode, 
bdi_wr™eback
 *
wb
)

207 
	`as£¹_¥š_locked
(&
wb
->
li¡_lock
);

208 ià(!
	`li¡_em±y
(&
wb
->
b_dœty
)) {

209 
šode
 *

;

211 

 = 
	`wb_šode
(
wb
->
b_dœty
.
Ãxt
);

212 ià(
	`time_befÜe
(
šode
->
dœt›d_wh’
, 

->dirtied_when))

213 
šode
->
dœt›d_wh’
 = 
jiff›s
;

215 
	`li¡_move
(&
šode
->
i_wb_li¡
, &
wb
->
b_dœty
);

216 
	}
}

221 
	$»queue_io
(
šode
 *šode, 
bdi_wr™eback
 *
wb
)

223 
	`as£¹_¥š_locked
(&
wb
->
li¡_lock
);

224 
	`li¡_move
(&
šode
->
i_wb_li¡
, &
wb
->
b_mÜe_io
);

225 
	}
}

227 
	$šode_sync_com¶‘e
(
šode
 *inode)

234 
	`smp_mb
();

235 
	`wake_up_b™
(&
šode
->
i_¡©e
, 
__I_SYNC
);

236 
	}
}

238 
boŞ
 
	$šode_dœt›d_aá”
(
šode
 *šode, 
t
)

240 
boŞ
 
»t
 = 
	`time_aá”
(
šode
->
dœt›d_wh’
, 
t
);

241 #iâdeà
CONFIG_64BIT


248 
»t
 =„‘ && 
	`time_befÜe_eq
(
šode
->
dœt›d_wh’
, 
jiff›s
);

250  
»t
;

251 
	}
}

256 
	$move_expœed_šodes
(
li¡_h—d
 *
d–ayšg_queue
,

257 
li¡_h—d
 *
di¥©ch_queue
,

258 
wb_wr™eback_wÜk
 *
wÜk
)

260 
	`LIST_HEAD
(
tmp
);

261 
li¡_h—d
 *
pos
, *
node
;

262 
su³r_block
 *
sb
 = 
NULL
;

263 
šode
 *inode;

264 
do_sb_sÜt
 = 0;

265 
moved
 = 0;

267 !
	`li¡_em±y
(
d–ayšg_queue
)) {

268 
šode
 = 
	`wb_šode
(
d–ayšg_queue
->
´ev
);

269 ià(
wÜk
->
Şd”_thª_this
 &&

270 
	`šode_dœt›d_aá”
(
šode
, *
wÜk
->
Şd”_thª_this
))

272 ià(
sb
 && sb !ğ
šode
->
i_sb
)

273 
do_sb_sÜt
 = 1;

274 
sb
 = 
šode
->
i_sb
;

275 
	`li¡_move
(&
šode
->
i_wb_li¡
, &
tmp
);

276 
moved
++;

280 ià(!
do_sb_sÜt
) {

281 
	`li¡_¥liû
(&
tmp
, 
di¥©ch_queue
);

282 
out
;

286 !
	`li¡_em±y
(&
tmp
)) {

287 
sb
 = 
	`wb_šode
(
tmp
.
´ev
)->
i_sb
;

288 
	`li¡_fÜ_—ch_´ev_§ã
(
pos
, 
node
, &
tmp
) {

289 
šode
 = 
	`wb_šode
(
pos
);

290 ià(
šode
->
i_sb
 =ğ
sb
)

291 
	`li¡_move
(&
šode
->
i_wb_li¡
, 
di¥©ch_queue
);

294 
out
:

295  
moved
;

296 
	}
}

309 
	$queue_io
(
bdi_wr™eback
 *
wb
, 
wb_wr™eback_wÜk
 *
wÜk
)

311 
moved
;

312 
	`as£¹_¥š_locked
(&
wb
->
li¡_lock
);

313 
	`li¡_¥liû_š™
(&
wb
->
b_mÜe_io
, &wb->
b_io
);

314 
moved
 = 
	`move_expœed_šodes
(&
wb
->
b_dœty
, &wb->
b_io
, 
wÜk
);

315 
	`Œaû_wr™eback_queue_io
(
wb
, 
wÜk
, 
moved
);

316 
	}
}

318 
	$wr™e_šode
(
šode
 *šode, 
wr™eback_cÚŒŞ
 *
wbc
)

320 ià(
šode
->
i_sb
->
s_İ
->
wr™e_šode
 && !
	`is_bad_šode
(inode))

321  
šode
->
i_sb
->
s_İ
->
	`wr™e_šode
(šode, 
wbc
);

323 
	}
}

328 
	$šode_wa™_fÜ_wr™eback
(
šode
 *inode,

329 
bdi_wr™eback
 *
wb
)

331 
	`DEFINE_WAIT_BIT
(
wq
, &
šode
->
i_¡©e
, 
__I_SYNC
);

332 
wa™_queue_h—d_t
 *
wqh
;

334 
wqh
 = 
	`b™_wa™queue
(&
šode
->
i_¡©e
, 
__I_SYNC
);

335 
šode
->
i_¡©e
 & 
I_SYNC
) {

336 
	`¥š_uÆock
(&
šode
->
i_lock
);

337 
	`¥š_uÆock
(&
wb
->
li¡_lock
);

338 
	`__wa™_Ú_b™
(
wqh
, &
wq
, 
šode_wa™
, 
TASK_UNINTERRUPTIBLE
);

339 
	`¥š_lock
(&
wb
->
li¡_lock
);

340 
	`¥š_lock
(&
šode
->
i_lock
);

342 
	}
}

356 
	$wr™eback_sšgË_šode
(
šode
 *šode, 
bdi_wr™eback
 *
wb
,

357 
wr™eback_cÚŒŞ
 *
wbc
)

359 
add»ss_¥aû
 *
m­pšg
 = 
šode
->
i_m­pšg
;

360 
Ä_to_wr™e
 = 
wbc
->nr_to_write;

361 
dœty
;

362 
»t
;

364 
	`as£¹_¥š_locked
(&
wb
->
li¡_lock
);

365 
	`as£¹_¥š_locked
(&
šode
->
i_lock
);

367 ià(!
	`©omic_»ad
(&
šode
->
i_couÁ
))

368 
	`WARN_ON
(!(
šode
->
i_¡©e
 & (
I_WILL_FREE
|
I_FREEING
)));

370 
	`WARN_ON
(
šode
->
i_¡©e
 & 
I_WILL_FREE
);

372 ià(
šode
->
i_¡©e
 & 
I_SYNC
) {

381 ià(
wbc
->
sync_mode
 !ğ
WB_SYNC_ALL
) {

382 
	`»queue_io
(
šode
, 
wb
);

383 
	`Œaû_wr™eback_sšgË_šode_»queue
(
šode
, 
wbc
,

384 
Ä_to_wr™e
);

391 
	`šode_wa™_fÜ_wr™eback
(
šode
, 
wb
);

394 
	`BUG_ON
(
šode
->
i_¡©e
 & 
I_SYNC
);

397 
šode
->
i_¡©e
 |ğ
I_SYNC
;

398 
šode
->
i_¡©e
 &ğ~
I_DIRTY_PAGES
;

399 
	`¥š_uÆock
(&
šode
->
i_lock
);

400 
	`¥š_uÆock
(&
wb
->
li¡_lock
);

402 
»t
 = 
	`do_wr™•ages
(
m­pšg
, 
wbc
);

409 ià(
wbc
->
sync_mode
 =ğ
WB_SYNC_ALL
) {

410 
”r
 = 
	`fem­_fd©awa™
(
m­pšg
);

411 ià(
»t
 == 0)

412 
»t
 = 
”r
;

420 
	`¥š_lock
(&
šode
->
i_lock
);

421 
dœty
 = 
šode
->
i_¡©e
 & 
I_DIRTY
;

422 
šode
->
i_¡©e
 &ğ~(
I_DIRTY_SYNC
 | 
I_DIRTY_DATASYNC
);

423 
	`¥š_uÆock
(&
šode
->
i_lock
);

425 ià(
dœty
 & (
I_DIRTY_SYNC
 | 
I_DIRTY_DATASYNC
)) {

426 
”r
 = 
	`wr™e_šode
(
šode
, 
wbc
);

427 ià(
»t
 == 0)

428 
»t
 = 
”r
;

431 
	`¥š_lock
(&
wb
->
li¡_lock
);

432 
	`¥š_lock
(&
šode
->
i_lock
);

433 
šode
->
i_¡©e
 &ğ~
I_SYNC
;

434 ià(!(
šode
->
i_¡©e
 & 
I_FREEING
)) {

440 ià((
šode
->
i_¡©e
 & 
I_DIRTY
) &&

441 (
wbc
->
sync_mode
 =ğ
WB_SYNC_ALL
 || wbc->
gged_wr™•ages
))

442 
šode
->
dœt›d_wh’
 = 
jiff›s
;

444 ià(
	`m­pšg_gged
(
m­pšg
, 
PAGECACHE_TAG_DIRTY
)) {

449 
šode
->
i_¡©e
 |ğ
I_DIRTY_PAGES
;

450 ià(
wbc
->
Ä_to_wr™e
 <= 0) {

454 
	`»queue_io
(
šode
, 
wb
);

463 
	`»dœty_
(
šode
, 
wb
);

465 } ià(
šode
->
i_¡©e
 & 
I_DIRTY
) {

472 
	`»dœty_
(
šode
, 
wb
);

479 
	`li¡_d–_š™
(&
šode
->
i_wb_li¡
);

482 
	`šode_sync_com¶‘e
(
šode
);

483 
	`Œaû_wr™eback_sšgË_šode
(
šode
, 
wbc
, 
Ä_to_wr™e
);

484  
»t
;

485 
	}
}

487 
	$wr™eback_chunk_size
(
backšg_dev_šfo
 *
bdi
,

488 
wb_wr™eback_wÜk
 *
wÜk
)

490 
·ges
;

505 ià(
wÜk
->
sync_mode
 =ğ
WB_SYNC_ALL
 || wÜk->
gged_wr™•ages
)

506 
·ges
 = 
LONG_MAX
;

508 
·ges
 = 
	`mš
(
bdi
->
avg_wr™e_bªdwidth
 / 2,

509 
glob®_dœty_lim™
 / 
DIRTY_SCOPE
);

510 
·ges
 = 
	`mš
Õages, 
wÜk
->
Ä_·ges
);

511 
·ges
 = 
	`round_down
Õage + 
MIN_WRITEBACK_PAGES
,

512 
MIN_WRITEBACK_PAGES
);

515  
·ges
;

516 
	}
}

527 
	$wr™eback_sb_šodes
(
su³r_block
 *
sb
,

528 
bdi_wr™eback
 *
wb
,

529 
wb_wr™eback_wÜk
 *
wÜk
)

531 
wr™eback_cÚŒŞ
 
wbc
 = {

532 .
sync_mode
 = 
wÜk
->sync_mode,

533 .
gged_wr™•ages
 = 
wÜk
->tagged_writepages,

534 .
fÜ_kupd©e
 = 
wÜk
->for_kupdate,

535 .
fÜ_background
 = 
wÜk
->for_background,

536 .
¿nge_cyşic
 = 
wÜk
->range_cyclic,

537 .
¿nge_¡¬t
 = 0,

538 .
¿nge_’d
 = 
LLONG_MAX
,

540 
¡¬t_time
 = 
jiff›s
;

541 
wr™e_chunk
;

542 
wrÙe
 = 0;

544 !
	`li¡_em±y
(&
wb
->
b_io
)) {

545 
šode
 *šodğ
	`wb_šode
(
wb
->
b_io
.
´ev
);

547 ià(
šode
->
i_sb
 !ğ
sb
) {

548 ià(
wÜk
->
sb
) {

554 
	`»dœty_
(
šode
, 
wb
);

571 
	`¥š_lock
(&
šode
->
i_lock
);

572 ià(
šode
->
i_¡©e
 & (
I_NEW
 | 
I_FREEING
 | 
I_WILL_FREE
)) {

573 
	`¥š_uÆock
(&
šode
->
i_lock
);

574 
	`»dœty_
(
šode
, 
wb
);

577 
	`__ig‘
(
šode
);

578 
wr™e_chunk
 = 
	`wr™eback_chunk_size
(
wb
->
bdi
, 
wÜk
);

579 
wbc
.
Ä_to_wr™e
 = 
wr™e_chunk
;

580 
wbc
.
·ges_sk³d
 = 0;

582 
	`wr™eback_sšgË_šode
(
šode
, 
wb
, &
wbc
);

584 
wÜk
->
Ä_·ges
 -ğ
wr™e_chunk
 - 
wbc
.
Ä_to_wr™e
;

585 
wrÙe
 +ğ
wr™e_chunk
 - 
wbc
.
Ä_to_wr™e
;

586 ià(!(
šode
->
i_¡©e
 & 
I_DIRTY
))

587 
wrÙe
++;

588 ià(
wbc
.
·ges_sk³d
) {

593 
	`»dœty_
(
šode
, 
wb
);

595 
	`¥š_uÆock
(&
šode
->
i_lock
);

596 
	`¥š_uÆock
(&
wb
->
li¡_lock
);

597 
	`ut
(
šode
);

598 
	`cÚd_»sched
();

599 
	`¥š_lock
(&
wb
->
li¡_lock
);

604 ià(
wrÙe
) {

605 ià(
	`time_is_befÜe_jiff›s
(
¡¬t_time
 + 
HZ
 / 10UL))

607 ià(
wÜk
->
Ä_·ges
 <= 0)

611  
wrÙe
;

612 
	}
}

614 
	$__wr™eback_šodes_wb
(
bdi_wr™eback
 *
wb
,

615 
wb_wr™eback_wÜk
 *
wÜk
)

617 
¡¬t_time
 = 
jiff›s
;

618 
wrÙe
 = 0;

620 !
	`li¡_em±y
(&
wb
->
b_io
)) {

621 
šode
 *šodğ
	`wb_šode
(
wb
->
b_io
.
´ev
);

622 
su³r_block
 *
sb
 = 
šode
->
i_sb
;

624 ià(!
	`g¿b_su³r_·ssive
(
sb
)) {

630 
	`»dœty_
(
šode
, 
wb
);

633 
wrÙe
 +ğ
	`wr™eback_sb_šodes
(
sb
, 
wb
, 
wÜk
);

634 
	`drİ_su³r
(
sb
);

637 ià(
wrÙe
) {

638 ià(
	`time_is_befÜe_jiff›s
(
¡¬t_time
 + 
HZ
 / 10UL))

640 ià(
wÜk
->
Ä_·ges
 <= 0)

645  
wrÙe
;

646 
	}
}

648 
	$wr™eback_šodes_wb
(
bdi_wr™eback
 *
wb
, 
Ä_·ges
,

649 
wb_»asÚ
 
»asÚ
)

651 
wb_wr™eback_wÜk
 
wÜk
 = {

652 .
Ä_·ges
 =‚r_pages,

653 .
sync_mode
 = 
WB_SYNC_NONE
,

654 .
¿nge_cyşic
 = 1,

655 .
»asÚ
 =„eason,

658 
	`¥š_lock
(&
wb
->
li¡_lock
);

659 ià(
	`li¡_em±y
(&
wb
->
b_io
))

660 
	`queue_io
(
wb
, &
wÜk
);

661 
	`__wr™eback_šodes_wb
(
wb
, &
wÜk
);

662 
	`¥š_uÆock
(&
wb
->
li¡_lock
);

664  
Ä_·ges
 - 
wÜk
.nr_pages;

665 
	}
}

667 
boŞ
 
	$ov”_bground_th»sh
(
backšg_dev_šfo
 *
bdi
)

669 
background_th»sh
, 
dœty_th»sh
;

671 
	`glob®_dœty_lim™s
(&
background_th»sh
, &
dœty_th»sh
);

673 ià(
	`glob®_·ge_¡©e
(
NR_FILE_DIRTY
) +

674 
	`glob®_·ge_¡©e
(
NR_UNSTABLE_NFS
è> 
background_th»sh
)

675  
Œue
;

677 ià(
	`bdi_¡©
(
bdi
, 
BDI_RECLAIMABLE
) >

678 
	`bdi_dœty_lim™
(
bdi
, 
background_th»sh
))

679  
Œue
;

681  
çl£
;

682 
	}
}

688 
	$wb_upd©e_bªdwidth
(
bdi_wr™eback
 *
wb
,

689 
¡¬t_time
)

691 
	`__bdi_upd©e_bªdwidth
(
wb
->
bdi
, 0, 0, 0, 0, 0, 
¡¬t_time
);

692 
	}
}

709 
	$wb_wr™eback
(
bdi_wr™eback
 *
wb
,

710 
wb_wr™eback_wÜk
 *
wÜk
)

712 
wb_¡¬t
 = 
jiff›s
;

713 
Ä_·ges
 = 
wÜk
->nr_pages;

714 
Şde¡_jif
;

715 
šode
 *inode;

716 
´og»ss
;

718 
Şde¡_jif
 = 
jiff›s
;

719 
wÜk
->
Şd”_thª_this
 = &
Şde¡_jif
;

721 
	`¥š_lock
(&
wb
->
li¡_lock
);

726 ià(
wÜk
->
Ä_·ges
 <= 0)

735 ià((
wÜk
->
fÜ_background
 || wÜk->
fÜ_kupd©e
) &&

736 !
	`li¡_em±y
(&
wb
->
bdi
->
wÜk_li¡
))

743 ià(
wÜk
->
fÜ_background
 && !
	`ov”_bground_th»sh
(
wb
->
bdi
))

746 ià(
wÜk
->
fÜ_kupd©e
) {

747 
Şde¡_jif
 = 
jiff›s
 -

748 
	`m£cs_to_jiff›s
(
dœty_expœe_š‹rv®
 * 10);

749 
wÜk
->
Şd”_thª_this
 = &
Şde¡_jif
;

752 
	`Œaû_wr™eback_¡¬t
(
wb
->
bdi
, 
wÜk
);

753 ià(
	`li¡_em±y
(&
wb
->
b_io
))

754 
	`queue_io
(
wb
, 
wÜk
);

755 ià(
wÜk
->
sb
)

756 
´og»ss
 = 
	`wr™eback_sb_šodes
(
wÜk
->
sb
, 
wb
, work);

758 
´og»ss
 = 
	`__wr™eback_šodes_wb
(
wb
, 
wÜk
);

759 
	`Œaû_wr™eback_wr™‹n
(
wb
->
bdi
, 
wÜk
);

761 
	`wb_upd©e_bªdwidth
(
wb
, 
wb_¡¬t
);

771 ià(
´og»ss
)

776 ià(
	`li¡_em±y
(&
wb
->
b_mÜe_io
))

783 ià(!
	`li¡_em±y
(&
wb
->
b_mÜe_io
)) {

784 
	`Œaû_wr™eback_wa™
(
wb
->
bdi
, 
wÜk
);

785 
šode
 = 
	`wb_šode
(
wb
->
b_mÜe_io
.
´ev
);

786 
	`¥š_lock
(&
šode
->
i_lock
);

787 
	`šode_wa™_fÜ_wr™eback
(
šode
, 
wb
);

788 
	`¥š_uÆock
(&
šode
->
i_lock
);

791 
	`¥š_uÆock
(&
wb
->
li¡_lock
);

793  
Ä_·ges
 - 
wÜk
->nr_pages;

794 
	}
}

799 
wb_wr™eback_wÜk
 *

800 
	$g‘_Ãxt_wÜk_™em
(
backšg_dev_šfo
 *
bdi
)

802 
wb_wr™eback_wÜk
 *
wÜk
 = 
NULL
;

804 
	`¥š_lock_bh
(&
bdi
->
wb_lock
);

805 ià(!
	`li¡_em±y
(&
bdi
->
wÜk_li¡
)) {

806 
wÜk
 = 
	`li¡_’Œy
(
bdi
->
wÜk_li¡
.
Ãxt
,

807 
wb_wr™eback_wÜk
, 
li¡
);

808 
	`li¡_d–_š™
(&
wÜk
->
li¡
);

810 
	`¥š_uÆock_bh
(&
bdi
->
wb_lock
);

811  
wÜk
;

812 
	}
}

818 
	$g‘_Ä_dœty_·ges
()

820  
	`glob®_·ge_¡©e
(
NR_FILE_DIRTY
) +

821 
	`glob®_·ge_¡©e
(
NR_UNSTABLE_NFS
) +

822 
	`g‘_Ä_dœty_šodes
();

823 
	}
}

825 
	$wb_check_background_æush
(
bdi_wr™eback
 *
wb
)

827 ià(
	`ov”_bground_th»sh
(
wb
->
bdi
)) {

829 
wb_wr™eback_wÜk
 
wÜk
 = {

830 .
Ä_·ges
 = 
LONG_MAX
,

831 .
sync_mode
 = 
WB_SYNC_NONE
,

832 .
fÜ_background
 = 1,

833 .
¿nge_cyşic
 = 1,

834 .
»asÚ
 = 
WB_REASON_BACKGROUND
,

837  
	`wb_wr™eback
(
wb
, &
wÜk
);

841 
	}
}

843 
	$wb_check_Şd_d©a_æush
(
bdi_wr™eback
 *
wb
)

845 
expœed
;

846 
Ä_·ges
;

851 ià(!
dœty_wr™eback_š‹rv®
)

854 
expœed
 = 
wb
->
Ï¡_Şd_æush
 +

855 
	`m£cs_to_jiff›s
(
dœty_wr™eback_š‹rv®
 * 10);

856 ià(
	`time_befÜe
(
jiff›s
, 
expœed
))

859 
wb
->
Ï¡_Şd_æush
 = 
jiff›s
;

860 
Ä_·ges
 = 
	`g‘_Ä_dœty_·ges
();

862 ià(
Ä_·ges
) {

863 
wb_wr™eback_wÜk
 
wÜk
 = {

864 .
Ä_·ges
 =‚r_pages,

865 .
sync_mode
 = 
WB_SYNC_NONE
,

866 .
fÜ_kupd©e
 = 1,

867 .
¿nge_cyşic
 = 1,

868 .
»asÚ
 = 
WB_REASON_PERIODIC
,

871  
	`wb_wr™eback
(
wb
, &
wÜk
);

875 
	}
}

880 
	$wb_do_wr™eback
(
bdi_wr™eback
 *
wb
, 
fÜû_wa™
)

882 
backšg_dev_šfo
 *
bdi
 = 
wb
->bdi;

883 
wb_wr™eback_wÜk
 *
wÜk
;

884 
wrÙe
 = 0;

886 
	`£t_b™
(
BDI_wr™eback_ruÂšg
, &
wb
->
bdi
->
¡©e
);

887 (
wÜk
 = 
	`g‘_Ãxt_wÜk_™em
(
bdi
)è!ğ
NULL
) {

892 ià(
fÜû_wa™
)

893 
wÜk
->
sync_mode
 = 
WB_SYNC_ALL
;

895 
	`Œaû_wr™eback_exec
(
bdi
, 
wÜk
);

897 
wrÙe
 +ğ
	`wb_wr™eback
(
wb
, 
wÜk
);

903 ià(
wÜk
->
dÚe
)

904 
	`com¶‘e
(
wÜk
->
dÚe
);

906 
	`kä“
(
wÜk
);

912 
wrÙe
 +ğ
	`wb_check_Şd_d©a_æush
(
wb
);

913 
wrÙe
 +ğ
	`wb_check_background_æush
(
wb
);

914 
	`ş—r_b™
(
BDI_wr™eback_ruÂšg
, &
wb
->
bdi
->
¡©e
);

916  
wrÙe
;

917 
	}
}

923 
	$bdi_wr™eback_th»ad
(*
d©a
)

925 
bdi_wr™eback
 *
wb
 = 
d©a
;

926 
backšg_dev_šfo
 *
bdi
 = 
wb
->bdi;

927 
·ges_wr™‹n
;

929 
cu¼’t
->
æags
 |ğ
PF_SWAPWRITE
;

930 
	`£t_ä“zabË
();

931 
wb
->
Ï¡_aùive
 = 
jiff›s
;

936 
	`£t_u£r_niû
(
cu¼’t
, 0);

938 
	`Œaû_wr™eback_th»ad_¡¬t
(
bdi
);

940 !
	`kth»ad_should_¡İ
()) {

945 
	`d–_tim”
(&
wb
->
wakeup_tim”
);

947 
·ges_wr™‹n
 = 
	`wb_do_wr™eback
(
wb
, 0);

949 
	`Œaû_wr™eback_·ges_wr™‹n
(
·ges_wr™‹n
);

951 ià(
·ges_wr™‹n
)

952 
wb
->
Ï¡_aùive
 = 
jiff›s
;

954 
	`£t_cu¼’t_¡©e
(
TASK_INTERRUPTIBLE
);

955 ià(!
	`li¡_em±y
(&
bdi
->
wÜk_li¡
è|| 
	`kth»ad_should_¡İ
()) {

956 
	`__£t_cu¼’t_¡©e
(
TASK_RUNNING
);

960 ià(
	`wb_has_dœty_io
(
wb
è&& 
dœty_wr™eback_š‹rv®
)

961 
	`scheduË_timeout
(
	`m£cs_to_jiff›s
(
dœty_wr™eback_š‹rv®
 * 10));

968 
	`scheduË
();

971 
	`Œy_to_ä“ze
();

975 ià(!
	`li¡_em±y
(&
bdi
->
wÜk_li¡
))

976 
	`wb_do_wr™eback
(
wb
, 1);

978 
	`Œaû_wr™eback_th»ad_¡İ
(
bdi
);

980 
	}
}

987 
	$wakeup_æush”_th»ads
(
Ä_·ges
, 
wb_»asÚ
 
»asÚ
)

989 
backšg_dev_šfo
 *
bdi
;

991 ià(!
Ä_·ges
) {

992 
Ä_·ges
 = 
	`glob®_·ge_¡©e
(
NR_FILE_DIRTY
) +

993 
	`glob®_·ge_¡©e
(
NR_UNSTABLE_NFS
);

996 
	`rcu_»ad_lock
();

997 
	`li¡_fÜ_—ch_’Œy_rcu
(
bdi
, &
bdi_li¡
, bdi_list) {

998 ià(!
	`bdi_has_dœty_io
(
bdi
))

1000 
	`__bdi_¡¬t_wr™eback
(
bdi
, 
Ä_·ges
, 
çl£
, 
»asÚ
);

1002 
	`rcu_»ad_uÆock
();

1003 
	}
}

1005 
nošlše
 
	$block_dump___m¬k_šode_dœty
(
šode
 *inode)

1007 ià(
šode
->
i_šo
 || 
	`¡rcmp
(šode->
i_sb
->
s_id
, "bdev")) {

1008 
d’Œy
 *dentry;

1009 cÚ¡ *
Çme
 = "?";

1011 
d’Œy
 = 
	`d_fšd_®Ÿs
(
šode
);

1012 ià(
d’Œy
) {

1013 
	`¥š_lock
(&
d’Œy
->
d_lock
);

1014 
Çme
 = (cÚ¡ *è
d’Œy
->
d_Çme
.name;

1016 
	`´štk
(
KERN_DEBUG


1018 
cu¼’t
->
comm
, 
	`sk_pid_Ä
(cu¼’t), 
šode
->
i_šo
,

1019 
Çme
, 
šode
->
i_sb
->
s_id
);

1020 ià(
d’Œy
) {

1021 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

1022 
	`dput
(
d’Œy
);

1025 
	}
}

1051 
	$__m¬k_šode_dœty
(
šode
 *šode, 
æags
)

1053 
su³r_block
 *
sb
 = 
šode
->
i_sb
;

1054 
backšg_dev_šfo
 *
bdi
 = 
NULL
;

1060 ià(
æags
 & (
I_DIRTY_SYNC
 | 
I_DIRTY_DATASYNC
)) {

1061 ià(
sb
->
s_İ
->
dœty_šode
)

1062 
sb
->
s_İ
->
	`dœty_šode
(
šode
, 
æags
);

1069 
	`smp_mb
();

1072 ià((
šode
->
i_¡©e
 & 
æags
) == flags)

1075 ià(
	`uÆik–y
(
block_dump
))

1076 
	`block_dump___m¬k_šode_dœty
(
šode
);

1078 
	`¥š_lock
(&
šode
->
i_lock
);

1079 ià((
šode
->
i_¡©e
 & 
æags
) != flags) {

1080 cÚ¡ 
was_dœty
 = 
šode
->
i_¡©e
 & 
I_DIRTY
;

1082 
šode
->
i_¡©e
 |ğ
æags
;

1089 ià(
šode
->
i_¡©e
 & 
I_SYNC
)

1090 
out_uÆock_šode
;

1096 ià(!
	`S_ISBLK
(
šode
->
i_mode
)) {

1097 ià(
	`šode_unhashed
(
šode
))

1098 
out_uÆock_šode
;

1100 ià(
šode
->
i_¡©e
 & 
I_FREEING
)

1101 
out_uÆock_šode
;

1107 ià(!
was_dœty
) {

1108 
boŞ
 
wakeup_bdi
 = 
çl£
;

1109 
bdi
 = 
	`šode_to_bdi
(
šode
);

1111 ià(
	`bdi_ÿp_wr™eback_dœty
(
bdi
)) {

1112 
	`WARN
(!
	`‹¡_b™
(
BDI_»gi¡”ed
, &
bdi
->
¡©e
),

1113 "bdi-% nÙ„egi¡”ed\n", 
bdi
->
Çme
);

1121 ià(!
	`wb_has_dœty_io
(&
bdi
->
wb
))

1122 
wakeup_bdi
 = 
Œue
;

1125 
	`¥š_uÆock
(&
šode
->
i_lock
);

1126 
	`¥š_lock
(&
bdi
->
wb
.
li¡_lock
);

1127 
šode
->
dœt›d_wh’
 = 
jiff›s
;

1128 
	`li¡_move
(&
šode
->
i_wb_li¡
, &
bdi
->
wb
.
b_dœty
);

1129 
	`¥š_uÆock
(&
bdi
->
wb
.
li¡_lock
);

1131 ià(
wakeup_bdi
)

1132 
	`bdi_wakeup_th»ad_d–ayed
(
bdi
);

1136 
out_uÆock_šode
:

1137 
	`¥š_uÆock
(&
šode
->
i_lock
);

1139 
	}
}

1140 
EXPORT_SYMBOL
(
__m¬k_šode_dœty
);

1159 
	$wa™_sb_šodes
(
su³r_block
 *
sb
)

1161 
šode
 *šode, *
Şd_šode
 = 
NULL
;

1167 
	`WARN_ON
(!
	`rw£m_is_locked
(&
sb
->
s_umouÁ
));

1169 
	`¥š_lock
(&
šode_sb_li¡_lock
);

1178 
	`li¡_fÜ_—ch_’Œy
(
šode
, &
sb
->
s_šodes
, 
i_sb_li¡
) {

1179 
add»ss_¥aû
 *
m­pšg
 = 
šode
->
i_m­pšg
;

1181 
	`¥š_lock
(&
šode
->
i_lock
);

1182 ià((
šode
->
i_¡©e
 & (
I_FREEING
|
I_WILL_FREE
|
I_NEW
)) ||

1183 (
m­pšg
->
Ä·ges
 == 0)) {

1184 
	`¥š_uÆock
(&
šode
->
i_lock
);

1187 
	`__ig‘
(
šode
);

1188 
	`¥š_uÆock
(&
šode
->
i_lock
);

1189 
	`¥š_uÆock
(&
šode_sb_li¡_lock
);

1199 
	`ut
(
Şd_šode
);

1200 
Şd_šode
 = 
šode
;

1202 
	`fem­_fd©awa™
(
m­pšg
);

1204 
	`cÚd_»sched
();

1206 
	`¥š_lock
(&
šode_sb_li¡_lock
);

1208 
	`¥š_uÆock
(&
šode_sb_li¡_lock
);

1209 
	`ut
(
Şd_šode
);

1210 
	}
}

1222 
	$wr™eback_šodes_sb_Ä
(
su³r_block
 *
sb
,

1223 
Ä
,

1224 
wb_»asÚ
 
»asÚ
)

1226 
	`DECLARE_COMPLETION_ONSTACK
(
dÚe
);

1227 
wb_wr™eback_wÜk
 
wÜk
 = {

1228 .
sb
 = sb,

1229 .
sync_mode
 = 
WB_SYNC_NONE
,

1230 .
gged_wr™•ages
 = 1,

1231 .
dÚe
 = &done,

1232 .
Ä_·ges
 = 
Ä
,

1233 .
»asÚ
 =„eason,

1236 
	`WARN_ON
(!
	`rw£m_is_locked
(&
sb
->
s_umouÁ
));

1237 
	`bdi_queue_wÜk
(
sb
->
s_bdi
, &
wÜk
);

1238 
	`wa™_fÜ_com¶‘iÚ
(&
dÚe
);

1239 
	}
}

1240 
EXPORT_SYMBOL
(
wr™eback_šodes_sb_Ä
);

1251 
	$wr™eback_šodes_sb
(
su³r_block
 *
sb
, 
wb_»asÚ
 
»asÚ
)

1253  
	`wr™eback_šodes_sb_Ä
(
sb
, 
	`g‘_Ä_dœty_·ges
(), 
»asÚ
);

1254 
	}
}

1255 
EXPORT_SYMBOL
(
wr™eback_šodes_sb
);

1265 
	$wr™eback_šodes_sb_if_idË
(
su³r_block
 *
sb
, 
wb_»asÚ
 
»asÚ
)

1267 ià(!
	`wr™eback_š_´og»ss
(
sb
->
s_bdi
)) {

1268 
	`down_»ad
(&
sb
->
s_umouÁ
);

1269 
	`wr™eback_šodes_sb
(
sb
, 
»asÚ
);

1270 
	`up_»ad
(&
sb
->
s_umouÁ
);

1274 
	}
}

1275 
EXPORT_SYMBOL
(
wr™eback_šodes_sb_if_idË
);

1286 
	$wr™eback_šodes_sb_Ä_if_idË
(
su³r_block
 *
sb
,

1287 
Ä
,

1288 
wb_»asÚ
 
»asÚ
)

1290 ià(!
	`wr™eback_š_´og»ss
(
sb
->
s_bdi
)) {

1291 
	`down_»ad
(&
sb
->
s_umouÁ
);

1292 
	`wr™eback_šodes_sb_Ä
(
sb
, 
Ä
, 
»asÚ
);

1293 
	`up_»ad
(&
sb
->
s_umouÁ
);

1297 
	}
}

1298 
EXPORT_SYMBOL
(
wr™eback_šodes_sb_Ä_if_idË
);

1307 
	$sync_šodes_sb
(
su³r_block
 *
sb
)

1309 
	`DECLARE_COMPLETION_ONSTACK
(
dÚe
);

1310 
wb_wr™eback_wÜk
 
wÜk
 = {

1311 .
sb
 = sb,

1312 .
sync_mode
 = 
WB_SYNC_ALL
,

1313 .
Ä_·ges
 = 
LONG_MAX
,

1314 .
¿nge_cyşic
 = 0,

1315 .
dÚe
 = &done,

1316 .
»asÚ
 = 
WB_REASON_SYNC
,

1319 
	`WARN_ON
(!
	`rw£m_is_locked
(&
sb
->
s_umouÁ
));

1321 
	`bdi_queue_wÜk
(
sb
->
s_bdi
, &
wÜk
);

1322 
	`wa™_fÜ_com¶‘iÚ
(&
dÚe
);

1324 
	`wa™_sb_šodes
(
sb
);

1325 
	}
}

1326 
EXPORT_SYMBOL
(
sync_šodes_sb
);

1338 
	$wr™e_šode_now
(
šode
 *šode, 
sync
)

1340 
bdi_wr™eback
 *
wb
 = &
	`šode_to_bdi
(
šode
)->wb;

1341 
»t
;

1342 
wr™eback_cÚŒŞ
 
wbc
 = {

1343 .
Ä_to_wr™e
 = 
LONG_MAX
,

1344 .
sync_mode
 = 
sync
 ? 
WB_SYNC_ALL
 : 
WB_SYNC_NONE
,

1345 .
¿nge_¡¬t
 = 0,

1346 .
¿nge_’d
 = 
LLONG_MAX
,

1349 ià(!
	`m­pšg_ÿp_wr™eback_dœty
(
šode
->
i_m­pšg
))

1350 
wbc
.
Ä_to_wr™e
 = 0;

1352 
	`might_¦“p
();

1353 
	`¥š_lock
(&
wb
->
li¡_lock
);

1354 
	`¥š_lock
(&
šode
->
i_lock
);

1355 
»t
 = 
	`wr™eback_sšgË_šode
(
šode
, 
wb
, &
wbc
);

1356 
	`¥š_uÆock
(&
šode
->
i_lock
);

1357 
	`¥š_uÆock
(&
wb
->
li¡_lock
);

1358 ià(
sync
)

1359 
	`šode_sync_wa™
(
šode
);

1360  
»t
;

1361 
	}
}

1362 
EXPORT_SYMBOL
(
wr™e_šode_now
);

1375 
	$sync_šode
(
šode
 *šode, 
wr™eback_cÚŒŞ
 *
wbc
)

1377 
bdi_wr™eback
 *
wb
 = &
	`šode_to_bdi
(
šode
)->wb;

1378 
»t
;

1380 
	`¥š_lock
(&
wb
->
li¡_lock
);

1381 
	`¥š_lock
(&
šode
->
i_lock
);

1382 
»t
 = 
	`wr™eback_sšgË_šode
(
šode
, 
wb
, 
wbc
);

1383 
	`¥š_uÆock
(&
šode
->
i_lock
);

1384 
	`¥š_uÆock
(&
wb
->
li¡_lock
);

1385  
»t
;

1386 
	}
}

1387 
EXPORT_SYMBOL
(
sync_šode
);

1398 
	$sync_šode_m‘ad©a
(
šode
 *šode, 
wa™
)

1400 
wr™eback_cÚŒŞ
 
wbc
 = {

1401 .
sync_mode
 = 
wa™
 ? 
WB_SYNC_ALL
 : 
WB_SYNC_NONE
,

1402 .
Ä_to_wr™e
 = 0,

1405  
	`sync_šode
(
šode
, &
wbc
);

1406 
	}
}

1407 
EXPORT_SYMBOL
(
sync_šode_m‘ad©a
);

	@fs_struct.c

1 
	~<lšux/moduË.h
>

2 
	~<lšux/sched.h
>

3 
	~<lšux/fs.h
>

4 
	~<lšux/·th.h
>

5 
	~<lšux/¦ab.h
>

6 
	~<lšux/fs_¡ruù.h
>

7 
	~"š‹º®.h
"

9 
šlše
 
	$·th_g‘_lÚg‹rm
(
·th
 *path)

11 
	`·th_g‘
(
·th
);

12 
	`mÁ_make_lÚg‹rm
(
·th
->
mÁ
);

13 
	}
}

15 
šlše
 
	$·th_put_lÚg‹rm
(
·th
 *path)

17 
	`mÁ_make_shÜ‰”m
(
·th
->
mÁ
);

18 
	`·th_put
(
·th
);

19 
	}
}

25 
	$£t_fs_roÙ
(
fs_¡ruù
 *
fs
, 
·th
 *path)

27 
·th
 
Şd_roÙ
;

29 
	`¥š_lock
(&
fs
->
lock
);

30 
	`wr™e_£qcouÁ_begš
(&
fs
->
£q
);

31 
Şd_roÙ
 = 
fs
->
roÙ
;

32 
fs
->
roÙ
 = *
·th
;

33 
	`·th_g‘_lÚg‹rm
(
·th
);

34 
	`wr™e_£qcouÁ_’d
(&
fs
->
£q
);

35 
	`¥š_uÆock
(&
fs
->
lock
);

36 ià(
Şd_roÙ
.
d’Œy
)

37 
	`·th_put_lÚg‹rm
(&
Şd_roÙ
);

38 
	}
}

44 
	$£t_fs_pwd
(
fs_¡ruù
 *
fs
, 
·th
 *path)

46 
·th
 
Şd_pwd
;

48 
	`¥š_lock
(&
fs
->
lock
);

49 
	`wr™e_£qcouÁ_begš
(&
fs
->
£q
);

50 
Şd_pwd
 = 
fs
->
pwd
;

51 
fs
->
pwd
 = *
·th
;

52 
	`·th_g‘_lÚg‹rm
(
·th
);

53 
	`wr™e_£qcouÁ_’d
(&
fs
->
£q
);

54 
	`¥š_uÆock
(&
fs
->
lock
);

56 ià(
Şd_pwd
.
d’Œy
)

57 
	`·th_put_lÚg‹rm
(&
Şd_pwd
);

58 
	}
}

60 
	$chroÙ_fs_»fs
(
·th
 *
Şd_roÙ
, ·th *
Ãw_roÙ
)

62 
sk_¡ruù
 *
g
, *
p
;

63 
fs_¡ruù
 *
fs
;

64 
couÁ
 = 0;

66 
	`»ad_lock
(&
skli¡_lock
);

67 
	`do_—ch_th»ad
(
g
, 
p
) {

68 
	`sk_lock
(
p
);

69 
fs
 = 
p
->fs;

70 ià(
fs
) {

71 
	`¥š_lock
(&
fs
->
lock
);

72 
	`wr™e_£qcouÁ_begš
(&
fs
->
£q
);

73 ià(
fs
->
roÙ
.
d’Œy
 =ğ
Şd_roÙ
->dentry

74 && 
fs
->
roÙ
.
mÁ
 =ğ
Şd_roÙ
->mnt) {

75 
	`·th_g‘_lÚg‹rm
(
Ãw_roÙ
);

76 
fs
->
roÙ
 = *
Ãw_roÙ
;

77 
couÁ
++;

79 ià(
fs
->
pwd
.
d’Œy
 =ğ
Şd_roÙ
->dentry

80 && 
fs
->
pwd
.
mÁ
 =ğ
Şd_roÙ
->mnt) {

81 
	`·th_g‘_lÚg‹rm
(
Ãw_roÙ
);

82 
fs
->
pwd
 = *
Ãw_roÙ
;

83 
couÁ
++;

85 
	`wr™e_£qcouÁ_’d
(&
fs
->
£q
);

86 
	`¥š_uÆock
(&
fs
->
lock
);

88 
	`sk_uÆock
(
p
);

89 } 
	`whe_—ch_th»ad
(
g
, 
p
);

90 
	`»ad_uÆock
(&
skli¡_lock
);

91 
couÁ
--)

92 
	`·th_put_lÚg‹rm
(
Şd_roÙ
);

93 
	}
}

95 
	$ä“_fs_¡ruù
(
fs_¡ruù
 *
fs
)

97 
	`·th_put_lÚg‹rm
(&
fs
->
roÙ
);

98 
	`·th_put_lÚg‹rm
(&
fs
->
pwd
);

99 
	`kmem_ÿche_ä“
(
fs_ÿch•
, 
fs
);

100 
	}
}

102 
	$ex™_fs
(
sk_¡ruù
 *
tsk
)

104 
fs_¡ruù
 *
fs
 = 
tsk
->fs;

106 ià(
fs
) {

107 
kl
;

108 
	`sk_lock
(
tsk
);

109 
	`¥š_lock
(&
fs
->
lock
);

110 
	`wr™e_£qcouÁ_begš
(&
fs
->
£q
);

111 
tsk
->
fs
 = 
NULL
;

112 
kl
 = !--
fs
->
u£rs
;

113 
	`wr™e_£qcouÁ_’d
(&
fs
->
£q
);

114 
	`¥š_uÆock
(&
fs
->
lock
);

115 
	`sk_uÆock
(
tsk
);

116 ià(
kl
)

117 
	`ä“_fs_¡ruù
(
fs
);

119 
	}
}

121 
fs_¡ruù
 *
	$cİy_fs_¡ruù
(
fs_¡ruù
 *
Şd
)

123 
fs_¡ruù
 *
fs
 = 
	`kmem_ÿche_®loc
(
fs_ÿch•
, 
GFP_KERNEL
);

125 ià(
fs
) {

126 
fs
->
u£rs
 = 1;

127 
fs
->
š_exec
 = 0;

128 
	`¥š_lock_š™
(&
fs
->
lock
);

129 
	`£qcouÁ_š™
(&
fs
->
£q
);

130 
fs
->
umask
 = 
Şd
->umask;

132 
	`¥š_lock
(&
Şd
->
lock
);

133 
fs
->
roÙ
 = 
Şd
->root;

134 
	`·th_g‘_lÚg‹rm
(&
fs
->
roÙ
);

135 
fs
->
pwd
 = 
Şd
->pwd;

136 
	`·th_g‘_lÚg‹rm
(&
fs
->
pwd
);

137 
	`¥š_uÆock
(&
Şd
->
lock
);

139  
fs
;

140 
	}
}

142 
	$unsh¬e_fs_¡ruù
()

144 
fs_¡ruù
 *
fs
 = 
cu¼’t
->fs;

145 
fs_¡ruù
 *
Ãw_fs
 = 
	`cİy_fs_¡ruù
(
fs
);

146 
kl
;

148 ià(!
Ãw_fs
)

149  -
ENOMEM
;

151 
	`sk_lock
(
cu¼’t
);

152 
	`¥š_lock
(&
fs
->
lock
);

153 
kl
 = !--
fs
->
u£rs
;

154 
cu¼’t
->
fs
 = 
Ãw_fs
;

155 
	`¥š_uÆock
(&
fs
->
lock
);

156 
	`sk_uÆock
(
cu¼’t
);

158 ià(
kl
)

159 
	`ä“_fs_¡ruù
(
fs
);

162 
	}
}

163 
EXPORT_SYMBOL_GPL
(
unsh¬e_fs_¡ruù
);

165 
	$cu¼’t_umask
()

167  
cu¼’t
->
fs
->
umask
;

168 
	}
}

169 
EXPORT_SYMBOL
(
cu¼’t_umask
);

172 
fs_¡ruù
 
	gš™_fs
 = {

173 .
u£rs
 = 1,

174 .
	glock
 = 
__SPIN_LOCK_UNLOCKED
(
š™_fs
.
lock
),

175 .
	g£q
 = 
SEQCNT_ZERO
,

176 .
	gumask
 = 0022,

179 
	$d«mÚize_fs_¡ruù
()

181 
fs_¡ruù
 *
fs
 = 
cu¼’t
->fs;

183 ià(
fs
) {

184 
kl
;

186 
	`sk_lock
(
cu¼’t
);

188 
	`¥š_lock
(&
š™_fs
.
lock
);

189 
š™_fs
.
u£rs
++;

190 
	`¥š_uÆock
(&
š™_fs
.
lock
);

192 
	`¥š_lock
(&
fs
->
lock
);

193 
cu¼’t
->
fs
 = &
š™_fs
;

194 
kl
 = !--
fs
->
u£rs
;

195 
	`¥š_uÆock
(&
fs
->
lock
);

197 
	`sk_uÆock
(
cu¼’t
);

198 ià(
kl
)

199 
	`ä“_fs_¡ruù
(
fs
);

201 
	}
}

	@generic_acl.c

9 
	~<lšux/sched.h
>

10 
	~<lšux/gå.h
>

11 
	~<lšux/fs.h
>

12 
	~<lšux/g’”ic_aş.h
>

13 
	~<lšux/posix_aş.h
>

14 
	~<lšux/posix_aş_x©Œ.h
>

17 
size_t


18 
	$g’”ic_aş_li¡
(
d’Œy
 *d’Œy, *
li¡
, 
size_t
 
li¡_size
,

19 cÚ¡ *
Çme
, 
size_t
 
Çme_Ën
, 
ty³
)

21 
posix_aş
 *
aş
;

22 cÚ¡ *
xÇme
;

23 
size_t
 
size
;

25 
aş
 = 
	`g‘_ÿched_aş
(
d’Œy
->
d_šode
, 
ty³
);

26 ià(!
aş
)

28 
	`posix_aş_»Ëa£
(
aş
);

30 
ty³
) {

31 
ACL_TYPE_ACCESS
:

32 
xÇme
 = 
POSIX_ACL_XATTR_ACCESS
;

34 
ACL_TYPE_DEFAULT
:

35 
xÇme
 = 
POSIX_ACL_XATTR_DEFAULT
;

40 
size
 = 
	`¡¾’
(
xÇme
) + 1;

41 ià(
li¡
 && 
size
 <ğ
li¡_size
)

42 
	`memıy
(
li¡
, 
xÇme
, 
size
);

43  
size
;

44 
	}
}

47 
	$g’”ic_aş_g‘
(
d’Œy
 *d’Œy, cÚ¡ *
Çme
, *
bufãr
,

48 
size_t
 
size
, 
ty³
)

50 
posix_aş
 *
aş
;

51 
”rÜ
;

53 ià(
	`¡rcmp
(
Çme
, "") != 0)

54  -
EINVAL
;

56 
aş
 = 
	`g‘_ÿched_aş
(
d’Œy
->
d_šode
, 
ty³
);

57 ià(!
aş
)

58  -
ENODATA
;

59 
”rÜ
 = 
	`posix_aş_to_x©Œ
(
aş
, 
bufãr
, 
size
);

60 
	`posix_aş_»Ëa£
(
aş
);

62  
”rÜ
;

63 
	}
}

66 
	$g’”ic_aş_£t
(
d’Œy
 *d’Œy, cÚ¡ *
Çme
, cÚ¡ *
v®ue
,

67 
size_t
 
size
, 
æags
, 
ty³
)

69 
šode
 *šodğ
d’Œy
->
d_šode
;

70 
posix_aş
 *
aş
 = 
NULL
;

71 
”rÜ
;

73 ià(
	`¡rcmp
(
Çme
, "") != 0)

74  -
EINVAL
;

75 ià(
	`S_ISLNK
(
šode
->
i_mode
))

76  -
EOPNOTSUPP
;

77 ià(!
	`šode_owÃr_Ü_ÿ·bË
(
šode
))

78  -
EPERM
;

79 ià(
v®ue
) {

80 
aş
 = 
	`posix_aş_äom_x©Œ
(
v®ue
, 
size
);

81 ià(
	`IS_ERR
(
aş
))

82  
	`PTR_ERR
(
aş
);

84 ià(
aş
) {

85 
”rÜ
 = 
	`posix_aş_v®id
(
aş
);

86 ià(
”rÜ
)

87 
çed
;

88 
ty³
) {

89 
ACL_TYPE_ACCESS
:

90 
”rÜ
 = 
	`posix_aş_equiv_mode
(
aş
, &
šode
->
i_mode
);

91 ià(
”rÜ
 < 0)

92 
çed
;

93 
šode
->
i_ùime
 = 
CURRENT_TIME
;

94 ià(
”rÜ
 == 0) {

95 
	`posix_aş_»Ëa£
(
aş
);

96 
aş
 = 
NULL
;

99 
ACL_TYPE_DEFAULT
:

100 ià(!
	`S_ISDIR
(
šode
->
i_mode
)) {

101 
”rÜ
 = -
EINVAL
;

102 
çed
;

107 
	`£t_ÿched_aş
(
šode
, 
ty³
, 
aş
);

108 
”rÜ
 = 0;

109 
çed
:

110 
	`posix_aş_»Ëa£
(
aş
);

111  
”rÜ
;

112 
	}
}

121 
	$g’”ic_aş_š™
(
šode
 *šode, šod*
dœ
)

123 
posix_aş
 *
aş
 = 
NULL
;

124 
”rÜ
;

126 ià(!
	`S_ISLNK
(
šode
->
i_mode
))

127 
aş
 = 
	`g‘_ÿched_aş
(
dœ
, 
ACL_TYPE_DEFAULT
);

128 ià(
aş
) {

129 ià(
	`S_ISDIR
(
šode
->
i_mode
))

130 
	`£t_ÿched_aş
(
šode
, 
ACL_TYPE_DEFAULT
, 
aş
);

131 
”rÜ
 = 
	`posix_aş_ü—‹
(&
aş
, 
GFP_KERNEL
, &
šode
->
i_mode
);

132 ià(
”rÜ
 < 0)

133  
”rÜ
;

134 ià(
”rÜ
 > 0)

135 
	`£t_ÿched_aş
(
šode
, 
ACL_TYPE_ACCESS
, 
aş
);

137 
šode
->
i_mode
 &ğ~
	`cu¼’t_umask
();

139 
”rÜ
 = 0;

141 
	`posix_aş_»Ëa£
(
aş
);

142  
”rÜ
;

143 
	}
}

152 
	$g’”ic_aş_chmod
(
šode
 *inode)

154 
posix_aş
 *
aş
;

155 
”rÜ
 = 0;

157 ià(
	`S_ISLNK
(
šode
->
i_mode
))

158  -
EOPNOTSUPP
;

159 
aş
 = 
	`g‘_ÿched_aş
(
šode
, 
ACL_TYPE_ACCESS
);

160 ià(
aş
) {

161 
”rÜ
 = 
	`posix_aş_chmod
(&
aş
, 
GFP_KERNEL
, 
šode
->
i_mode
);

162 ià(
”rÜ
)

163  
”rÜ
;

164 
	`£t_ÿched_aş
(
šode
, 
ACL_TYPE_ACCESS
, 
aş
);

165 
	`posix_aş_»Ëa£
(
aş
);

167  
”rÜ
;

168 
	}
}

170 cÚ¡ 
x©Œ_hªdËr
 
	gg’”ic_aş_acûss_hªdËr
 = {

171 .
´efix
 = 
POSIX_ACL_XATTR_ACCESS
,

172 .
	gæags
 = 
ACL_TYPE_ACCESS
,

173 .
	gli¡
 = 
g’”ic_aş_li¡
,

174 .
	gg‘
 = 
g’”ic_aş_g‘
,

175 .
	g£t
 = 
g’”ic_aş_£t
,

178 cÚ¡ 
x©Œ_hªdËr
 
	gg’”ic_aş_deçuÉ_hªdËr
 = {

179 .
´efix
 = 
POSIX_ACL_XATTR_DEFAULT
,

180 .
	gæags
 = 
ACL_TYPE_DEFAULT
,

181 .
	gli¡
 = 
g’”ic_aş_li¡
,

182 .
	gg‘
 = 
g’”ic_aş_g‘
,

183 .
	g£t
 = 
g’”ic_aş_£t
,

	@inode.c

5 
	~<lšux/fs.h
>

6 
	~<lšux/mm.h
>

7 
	~<lšux/dÿche.h
>

8 
	~<lšux/š™.h
>

9 
	~<lšux/¦ab.h
>

10 
	~<lšux/wr™eback.h
>

11 
	~<lšux/moduË.h
>

12 
	~<lšux/backšg-dev.h
>

13 
	~<lšux/wa™.h
>

14 
	~<lšux/rw£m.h
>

15 
	~<lšux/hash.h
>

16 
	~<lšux/sw­.h
>

17 
	~<lšux/£cur™y.h
>

18 
	~<lšux/·gem­.h
>

19 
	~<lšux/cdev.h
>

20 
	~<lšux/boÙmem.h
>

21 
	~<lšux/f¢Ùify.h
>

22 
	~<lšux/mouÁ.h
>

23 
	~<lšux/async.h
>

24 
	~<lšux/posix_aş.h
>

25 
	~<lšux/´eãtch.h
>

26 
	~<lšux/ima.h
>

27 
	~<lšux/üed.h
>

28 
	~<lšux/bufãr_h—d.h
>

29 
	~"š‹º®.h
"

62 
i_hash_mask
 
	g__»ad_mo¡ly
;

63 
i_hash_shiá
 
	g__»ad_mo¡ly
;

64 
hli¡_h—d
 *
šode_hashbË
 
	g__»ad_mo¡ly
;

65 
__ÿch–še_®igÃd_š_smp
 
DEFINE_SPINLOCK
(
šode_hash_lock
);

67 
__ÿch–še_®igÃd_š_smp
 
DEFINE_SPINLOCK
(
šode_sb_li¡_lock
);

73 cÚ¡ 
add»ss_¥aû_İ”©iÚs
 
	gem±y_aİs
 = {

75 
EXPORT_SYMBOL
(
em±y_aİs
);

80 
šodes_¡©_t
 
	gšodes_¡©
;

82 
DEFINE_PER_CPU
(, 
Ä_šodes
);

83 
DEFINE_PER_CPU
(, 
Ä_unu£d
);

85 
kmem_ÿche
 *
šode_ÿch•
 
	g__»ad_mo¡ly
;

87 
	$g‘_Ä_šodes
()

89 
i
;

90 
sum
 = 0;

91 
	`fÜ_—ch_possibË_ıu
(
i
)

92 
sum
 +ğ
	`³r_ıu
(
Ä_šodes
, 
i
);

93  
sum
 < 0 ? 0 : sum;

94 
	}
}

96 
šlše
 
	$g‘_Ä_šodes_unu£d
()

98 
i
;

99 
sum
 = 0;

100 
	`fÜ_—ch_possibË_ıu
(
i
)

101 
sum
 +ğ
	`³r_ıu
(
Ä_unu£d
, 
i
);

102  
sum
 < 0 ? 0 : sum;

103 
	}
}

105 
	$g‘_Ä_dœty_šodes
()

108 
Ä_dœty
 = 
	`g‘_Ä_šodes
(è- 
	`g‘_Ä_šodes_unu£d
();

109  
Ä_dœty
 > 0 ?‚r_dirty : 0;

110 
	}
}

115 #ifdeà
CONFIG_SYSCTL


116 
	$´oc_Ä_šodes
(
ùl_bË
 *
bË
, 
wr™e
,

117 
__u£r
 *
bufãr
, 
size_t
 *
ËÅ
, 
loff_t
 *
µos
)

119 
šodes_¡©
.
Ä_šodes
 = 
	`g‘_Ä_šodes
();

120 
šodes_¡©
.
Ä_unu£d
 = 
	`g‘_Ä_šodes_unu£d
();

121  
	`´oc_doštvec
(
bË
, 
wr™e
, 
bufãr
, 
ËÅ
, 
µos
);

122 
	}
}

133 
	$šode_š™_®ways
(
su³r_block
 *
sb
, 
šode
 *inode)

135 cÚ¡ 
šode_İ”©iÚs
 
em±y_iİs
;

136 cÚ¡ 
fe_İ”©iÚs
 
em±y_fİs
;

137 
add»ss_¥aû
 *cÚ¡ 
m­pšg
 = &
šode
->
i_d©a
;

139 
šode
->
i_sb
 = 
sb
;

140 
šode
->
i_blkb™s
 = 
sb
->
s_blocksize_b™s
;

141 
šode
->
i_æags
 = 0;

142 
	`©omic_£t
(&
šode
->
i_couÁ
, 1);

143 
šode
->
i_İ
 = &
em±y_iİs
;

144 
šode
->
i_fİ
 = &
em±y_fİs
;

145 
šode
->
__i_Æšk
 = 1;

146 
šode
->
i_İæags
 = 0;

147 
šode
->
i_uid
 = 0;

148 
šode
->
i_gid
 = 0;

149 
	`©omic_£t
(&
šode
->
i_wr™ecouÁ
, 0);

150 
šode
->
i_size
 = 0;

151 
šode
->
i_blocks
 = 0;

152 
šode
->
i_by‹s
 = 0;

153 
šode
->
i_g’”©iÚ
 = 0;

154 #ifdeà
CONFIG_QUOTA


155 
	`mem£t
(&
šode
->
i_dquÙ
, 0, (inode->i_dquot));

157 
šode
->
i_pe
 = 
NULL
;

158 
šode
->
i_bdev
 = 
NULL
;

159 
šode
->
i_cdev
 = 
NULL
;

160 
šode
->
i_rdev
 = 0;

161 
šode
->
dœt›d_wh’
 = 0;

163 ià(
	`£cur™y_šode_®loc
(
šode
))

164 
out
;

165 
	`¥š_lock_š™
(&
šode
->
i_lock
);

166 
	`lockd•_£t_şass
(&
šode
->
i_lock
, &
sb
->
s_ty³
->
i_lock_key
);

168 
	`mu‹x_š™
(&
šode
->
i_mu‹x
);

169 
	`lockd•_£t_şass
(&
šode
->
i_mu‹x
, &
sb
->
s_ty³
->
i_mu‹x_key
);

171 
	`©omic_£t
(&
šode
->
i_dio_couÁ
, 0);

173 
m­pšg
->
a_İs
 = &
em±y_aİs
;

174 
m­pšg
->
ho¡
 = 
šode
;

175 
m­pšg
->
æags
 = 0;

176 
	`m­pšg_£t_gå_mask
(
m­pšg
, 
GFP_HIGHUSER_MOVABLE
);

177 
m­pšg
->
assoc_m­pšg
 = 
NULL
;

178 
m­pšg
->
backšg_dev_šfo
 = &
deçuÉ_backšg_dev_šfo
;

179 
m­pšg
->
wr™eback_šdex
 = 0;

186 ià(
sb
->
s_bdev
) {

187 
backšg_dev_šfo
 *
bdi
;

189 
bdi
 = 
sb
->
s_bdev
->
bd_šode
->
i_m­pšg
->
backšg_dev_šfo
;

190 
m­pšg
->
backšg_dev_šfo
 = 
bdi
;

192 
šode
->
i_´iv©e
 = 
NULL
;

193 
šode
->
i_m­pšg
 = 
m­pšg
;

194 #ifdeà
CONFIG_FS_POSIX_ACL


195 
šode
->
i_aş
 = inode->
i_deçuÉ_aş
 = 
ACL_NOT_CACHED
;

198 #ifdeà
CONFIG_FSNOTIFY


199 
šode
->
i_f¢Ùify_mask
 = 0;

202 
	`this_ıu_šc
(
Ä_šodes
);

205 
out
:

206  -
ENOMEM
;

207 
	}
}

208 
EXPORT_SYMBOL
(
šode_š™_®ways
);

210 
šode
 *
	$®loc_šode
(
su³r_block
 *
sb
)

212 
šode
 *inode;

214 ià(
sb
->
s_İ
->
®loc_šode
)

215 
šode
 = 
sb
->
s_İ
->
	`®loc_šode
(sb);

217 
šode
 = 
	`kmem_ÿche_®loc
(
šode_ÿch•
, 
GFP_KERNEL
);

219 ià(!
šode
)

220  
NULL
;

222 ià(
	`uÆik–y
(
	`šode_š™_®ways
(
sb
, 
šode
))) {

223 ià(
šode
->
i_sb
->
s_İ
->
de¡roy_šode
)

224 
šode
->
i_sb
->
s_İ
->
	`de¡roy_šode
(inode);

226 
	`kmem_ÿche_ä“
(
šode_ÿch•
, 
šode
);

227  
NULL
;

230  
šode
;

231 
	}
}

233 
	$ä“_šode_nÚrcu
(
šode
 *inode)

235 
	`kmem_ÿche_ä“
(
šode_ÿch•
, 
šode
);

236 
	}
}

237 
EXPORT_SYMBOL
(
ä“_šode_nÚrcu
);

239 
	$__de¡roy_šode
(
šode
 *inode)

241 
	`BUG_ON
(
	`šode_has_bufãrs
(
šode
));

242 
	`£cur™y_šode_ä“
(
šode
);

243 
	`f¢Ùify_šode_d–‘e
(
šode
);

244 #ifdeà
CONFIG_FS_POSIX_ACL


245 ià(
šode
->
i_aş
 && inode->i_aş !ğ
ACL_NOT_CACHED
)

246 
	`posix_aş_»Ëa£
(
šode
->
i_aş
);

247 ià(
šode
->
i_deçuÉ_aş
 && inode->i_deçuÉ_aş !ğ
ACL_NOT_CACHED
)

248 
	`posix_aş_»Ëa£
(
šode
->
i_deçuÉ_aş
);

250 
	`this_ıu_dec
(
Ä_šodes
);

251 
	}
}

252 
EXPORT_SYMBOL
(
__de¡roy_šode
);

254 
	$i_ÿÎback
(
rcu_h—d
 *
h—d
)

256 
šode
 *šodğ
	`cÚš”_of
(
h—d
, šode, 
i_rcu
);

257 
	`INIT_LIST_HEAD
(&
šode
->
i_d’Œy
);

258 
	`kmem_ÿche_ä“
(
šode_ÿch•
, 
šode
);

259 
	}
}

261 
	$de¡roy_šode
(
šode
 *inode)

263 
	`BUG_ON
(!
	`li¡_em±y
(&
šode
->
i_Ìu
));

264 
	`__de¡roy_šode
(
šode
);

265 ià(
šode
->
i_sb
->
s_İ
->
de¡roy_šode
)

266 
šode
->
i_sb
->
s_İ
->
	`de¡roy_šode
(inode);

268 
	`ÿÎ_rcu
(&
šode
->
i_rcu
, 
i_ÿÎback
);

269 
	}
}

271 
	$add»ss_¥aû_š™_Úû
(
add»ss_¥aû
 *
m­pšg
)

273 
	`mem£t
(
m­pšg
, 0, (*mapping));

274 
	`INIT_RADIX_TREE
(&
m­pšg
->
·ge_Œ“
, 
GFP_ATOMIC
);

275 
	`¥š_lock_š™
(&
m­pšg
->
Œ“_lock
);

276 
	`mu‹x_š™
(&
m­pšg
->
i_mm­_mu‹x
);

277 
	`INIT_LIST_HEAD
(&
m­pšg
->
´iv©e_li¡
);

278 
	`¥š_lock_š™
(&
m­pšg
->
´iv©e_lock
);

279 
	`INIT_RAW_PRIO_TREE_ROOT
(&
m­pšg
->
i_mm­
);

280 
	`INIT_LIST_HEAD
(&
m­pšg
->
i_mm­_nÚlš—r
);

281 
	}
}

282 
EXPORT_SYMBOL
(
add»ss_¥aû_š™_Úû
);

289 
	$šode_š™_Úû
(
šode
 *inode)

291 
	`mem£t
(
šode
, 0, (*inode));

292 
	`INIT_HLIST_NODE
(&
šode
->
i_hash
);

293 
	`INIT_LIST_HEAD
(&
šode
->
i_d’Œy
);

294 
	`INIT_LIST_HEAD
(&
šode
->
i_deviûs
);

295 
	`INIT_LIST_HEAD
(&
šode
->
i_wb_li¡
);

296 
	`INIT_LIST_HEAD
(&
šode
->
i_Ìu
);

297 
	`add»ss_¥aû_š™_Úû
(&
šode
->
i_d©a
);

298 
	`i_size_Üd”ed_š™
(
šode
);

299 #ifdeà
CONFIG_FSNOTIFY


300 
	`INIT_HLIST_HEAD
(&
šode
->
i_f¢Ùify_m¬ks
);

302 
	}
}

303 
EXPORT_SYMBOL
(
šode_š™_Úû
);

305 
	$š™_Úû
(*
foo
)

307 
šode
 *šodğ(šod*è
foo
;

309 
	`šode_š™_Úû
(
šode
);

310 
	}
}

315 
	$__ig‘
(
šode
 *inode)

317 
	`©omic_šc
(&
šode
->
i_couÁ
);

318 
	}
}

323 
	$ihŞd
(
šode
 *inode)

325 
	`WARN_ON
(
	`©omic_šc_»tuº
(&
šode
->
i_couÁ
) < 2);

326 
	}
}

327 
EXPORT_SYMBOL
(
ihŞd
);

329 
	$šode_Ìu_li¡_add
(
šode
 *inode)

331 
	`¥š_lock
(&
šode
->
i_sb
->
s_šode_Ìu_lock
);

332 ià(
	`li¡_em±y
(&
šode
->
i_Ìu
)) {

333 
	`li¡_add
(&
šode
->
i_Ìu
, &šode->
i_sb
->
s_šode_Ìu
);

334 
šode
->
i_sb
->
s_Ä_šodes_unu£d
++;

335 
	`this_ıu_šc
(
Ä_unu£d
);

337 
	`¥š_uÆock
(&
šode
->
i_sb
->
s_šode_Ìu_lock
);

338 
	}
}

340 
	$šode_Ìu_li¡_d–
(
šode
 *inode)

342 
	`¥š_lock
(&
šode
->
i_sb
->
s_šode_Ìu_lock
);

343 ià(!
	`li¡_em±y
(&
šode
->
i_Ìu
)) {

344 
	`li¡_d–_š™
(&
šode
->
i_Ìu
);

345 
šode
->
i_sb
->
s_Ä_šodes_unu£d
--;

346 
	`this_ıu_dec
(
Ä_unu£d
);

348 
	`¥š_uÆock
(&
šode
->
i_sb
->
s_šode_Ìu_lock
);

349 
	}
}

355 
	$šode_sb_li¡_add
(
šode
 *inode)

357 
	`¥š_lock
(&
šode_sb_li¡_lock
);

358 
	`li¡_add
(&
šode
->
i_sb_li¡
, &šode->
i_sb
->
s_šodes
);

359 
	`¥š_uÆock
(&
šode_sb_li¡_lock
);

360 
	}
}

361 
EXPORT_SYMBOL_GPL
(
šode_sb_li¡_add
);

363 
šlše
 
	$šode_sb_li¡_d–
(
šode
 *inode)

365 ià(!
	`li¡_em±y
(&
šode
->
i_sb_li¡
)) {

366 
	`¥š_lock
(&
šode_sb_li¡_lock
);

367 
	`li¡_d–_š™
(&
šode
->
i_sb_li¡
);

368 
	`¥š_uÆock
(&
šode_sb_li¡_lock
);

370 
	}
}

372 
	$hash
(
su³r_block
 *
sb
, 
hashv®
)

374 
tmp
;

376 
tmp
 = (
hashv®
 * ()
sb
è^ (
GOLDEN_RATIO_PRIME
 + hashval) /

377 
L1_CACHE_BYTES
;

378 
tmp
 =m°^ (Ñm°^ 
GOLDEN_RATIO_PRIME
è>> 
i_hash_shiá
);

379  
tmp
 & 
i_hash_mask
;

380 
	}
}

390 
	$__š£¹_šode_hash
(
šode
 *šode, 
hashv®
)

392 
hli¡_h—d
 *
b
 = 
šode_hashbË
 + 
	`hash
(
šode
->
i_sb
, 
hashv®
);

394 
	`¥š_lock
(&
šode_hash_lock
);

395 
	`¥š_lock
(&
šode
->
i_lock
);

396 
	`hli¡_add_h—d
(&
šode
->
i_hash
, 
b
);

397 
	`¥š_uÆock
(&
šode
->
i_lock
);

398 
	`¥š_uÆock
(&
šode_hash_lock
);

399 
	}
}

400 
EXPORT_SYMBOL
(
__š£¹_šode_hash
);

408 
	$__»move_šode_hash
(
šode
 *inode)

410 
	`¥š_lock
(&
šode_hash_lock
);

411 
	`¥š_lock
(&
šode
->
i_lock
);

412 
	`hli¡_d–_š™
(&
šode
->
i_hash
);

413 
	`¥š_uÆock
(&
šode
->
i_lock
);

414 
	`¥š_uÆock
(&
šode_hash_lock
);

415 
	}
}

416 
EXPORT_SYMBOL
(
__»move_šode_hash
);

418 
	$’d_wr™eback
(
šode
 *inode)

420 
	`might_¦“p
();

426 
	`¥š_lock_œq
(&
šode
->
i_d©a
.
Œ“_lock
);

427 
	`BUG_ON
(
šode
->
i_d©a
.
Ä·ges
);

428 
	`¥š_uÆock_œq
(&
šode
->
i_d©a
.
Œ“_lock
);

429 
	`BUG_ON
(!
	`li¡_em±y
(&
šode
->
i_d©a
.
´iv©e_li¡
));

430 
	`BUG_ON
(!(
šode
->
i_¡©e
 & 
I_FREEING
));

431 
	`BUG_ON
(
šode
->
i_¡©e
 & 
I_CLEAR
);

432 
	`šode_sync_wa™
(
šode
);

434 
šode
->
i_¡©e
 = 
I_FREEING
 | 
I_CLEAR
;

435 
	}
}

436 
EXPORT_SYMBOL
(
’d_wr™eback
);

451 
	$eviù
(
šode
 *inode)

453 cÚ¡ 
su³r_İ”©iÚs
 *
İ
 = 
šode
->
i_sb
->
s_İ
;

455 
	`BUG_ON
(!(
šode
->
i_¡©e
 & 
I_FREEING
));

456 
	`BUG_ON
(!
	`li¡_em±y
(&
šode
->
i_Ìu
));

458 ià(!
	`li¡_em±y
(&
šode
->
i_wb_li¡
))

459 
	`šode_wb_li¡_d–
(
šode
);

461 
	`šode_sb_li¡_d–
(
šode
);

463 ià(
İ
->
eviù_šode
) {

464 
İ
->
	`eviù_šode
(
šode
);

466 ià(
šode
->
i_d©a
.
Ä·ges
)

467 
	`Œunÿ‹_šode_·ges
(&
šode
->
i_d©a
, 0);

468 
	`’d_wr™eback
(
šode
);

470 ià(
	`S_ISBLK
(
šode
->
i_mode
è&& inode->
i_bdev
)

471 
	`bd_fÜg‘
(
šode
);

472 ià(
	`S_ISCHR
(
šode
->
i_mode
è&& inode->
i_cdev
)

473 
	`cd_fÜg‘
(
šode
);

475 
	`»move_šode_hash
(
šode
);

477 
	`¥š_lock
(&
šode
->
i_lock
);

478 
	`wake_up_b™
(&
šode
->
i_¡©e
, 
__I_NEW
);

479 
	`BUG_ON
(
šode
->
i_¡©e
 !ğ(
I_FREEING
 | 
I_CLEAR
));

480 
	`¥š_uÆock
(&
šode
->
i_lock
);

482 
	`de¡roy_šode
(
šode
);

483 
	}
}

492 
	$di¥o£_li¡
(
li¡_h—d
 *
h—d
)

494 !
	`li¡_em±y
(
h—d
)) {

495 
šode
 *inode;

497 
šode
 = 
	`li¡_fœ¡_’Œy
(
h—d
, šode, 
i_Ìu
);

498 
	`li¡_d–_š™
(&
šode
->
i_Ìu
);

500 
	`eviù
(
šode
);

502 
	}
}

513 
	$eviù_šodes
(
su³r_block
 *
sb
)

515 
šode
 *šode, *
Ãxt
;

516 
	`LIST_HEAD
(
di¥o£
);

518 
	`¥š_lock
(&
šode_sb_li¡_lock
);

519 
	`li¡_fÜ_—ch_’Œy_§ã
(
šode
, 
Ãxt
, &
sb
->
s_šodes
, 
i_sb_li¡
) {

520 ià(
	`©omic_»ad
(&
šode
->
i_couÁ
))

523 
	`¥š_lock
(&
šode
->
i_lock
);

524 ià(
šode
->
i_¡©e
 & (
I_NEW
 | 
I_FREEING
 | 
I_WILL_FREE
)) {

525 
	`¥š_uÆock
(&
šode
->
i_lock
);

529 
šode
->
i_¡©e
 |ğ
I_FREEING
;

530 
	`šode_Ìu_li¡_d–
(
šode
);

531 
	`¥š_uÆock
(&
šode
->
i_lock
);

532 
	`li¡_add
(&
šode
->
i_Ìu
, &
di¥o£
);

534 
	`¥š_uÆock
(&
šode_sb_li¡_lock
);

536 
	`di¥o£_li¡
(&
di¥o£
);

537 
	}
}

549 
	$šv®id©e_šodes
(
su³r_block
 *
sb
, 
boŞ
 
kl_dœty
)

551 
busy
 = 0;

552 
šode
 *šode, *
Ãxt
;

553 
	`LIST_HEAD
(
di¥o£
);

555 
	`¥š_lock
(&
šode_sb_li¡_lock
);

556 
	`li¡_fÜ_—ch_’Œy_§ã
(
šode
, 
Ãxt
, &
sb
->
s_šodes
, 
i_sb_li¡
) {

557 
	`¥š_lock
(&
šode
->
i_lock
);

558 ià(
šode
->
i_¡©e
 & (
I_NEW
 | 
I_FREEING
 | 
I_WILL_FREE
)) {

559 
	`¥š_uÆock
(&
šode
->
i_lock
);

562 ià(
šode
->
i_¡©e
 & 
I_DIRTY
 && !
kl_dœty
) {

563 
	`¥š_uÆock
(&
šode
->
i_lock
);

564 
busy
 = 1;

567 ià(
	`©omic_»ad
(&
šode
->
i_couÁ
)) {

568 
	`¥š_uÆock
(&
šode
->
i_lock
);

569 
busy
 = 1;

573 
šode
->
i_¡©e
 |ğ
I_FREEING
;

574 
	`šode_Ìu_li¡_d–
(
šode
);

575 
	`¥š_uÆock
(&
šode
->
i_lock
);

576 
	`li¡_add
(&
šode
->
i_Ìu
, &
di¥o£
);

578 
	`¥š_uÆock
(&
šode_sb_li¡_lock
);

580 
	`di¥o£_li¡
(&
di¥o£
);

582  
busy
;

583 
	}
}

585 
	$ÿn_unu£
(
šode
 *inode)

587 ià(
šode
->
i_¡©e
 & ~
I_REFERENCED
)

589 ià(
	`šode_has_bufãrs
(
šode
))

591 ià(
	`©omic_»ad
(&
šode
->
i_couÁ
))

593 ià(
šode
->
i_d©a
.
Ä·ges
)

596 
	}
}

616 
	$´uÃ_iÿche_sb
(
su³r_block
 *
sb
, 
Ä_to_sÿn
)

618 
	`LIST_HEAD
(
ä“abË
);

619 
Ä_sÿÂed
;

620 
»­
 = 0;

622 
	`¥š_lock
(&
sb
->
s_šode_Ìu_lock
);

623 
Ä_sÿÂed
 = 
Ä_to_sÿn
;‚r_scanned >= 0;‚r_scanned--) {

624 
šode
 *inode;

626 ià(
	`li¡_em±y
(&
sb
->
s_šode_Ìu
))

629 
šode
 = 
	`li¡_’Œy
(
sb
->
s_šode_Ìu
.
´ev
, šode, 
i_Ìu
);

636 ià(!
	`¥š_Œylock
(&
šode
->
i_lock
)) {

637 
	`li¡_move_
(&
šode
->
i_Ìu
, &
sb
->
s_šode_Ìu
);

645 ià(
	`©omic_»ad
(&
šode
->
i_couÁ
) ||

646 (
šode
->
i_¡©e
 & ~
I_REFERENCED
)) {

647 
	`li¡_d–_š™
(&
šode
->
i_Ìu
);

648 
	`¥š_uÆock
(&
šode
->
i_lock
);

649 
sb
->
s_Ä_šodes_unu£d
--;

650 
	`this_ıu_dec
(
Ä_unu£d
);

655 ià(
šode
->
i_¡©e
 & 
I_REFERENCED
) {

656 
šode
->
i_¡©e
 &ğ~
I_REFERENCED
;

657 
	`li¡_move
(&
šode
->
i_Ìu
, &
sb
->
s_šode_Ìu
);

658 
	`¥š_uÆock
(&
šode
->
i_lock
);

661 ià(
	`šode_has_bufãrs
(
šode
è|| inode->
i_d©a
.
Ä·ges
) {

662 
	`__ig‘
(
šode
);

663 
	`¥š_uÆock
(&
šode
->
i_lock
);

664 
	`¥š_uÆock
(&
sb
->
s_šode_Ìu_lock
);

665 ià(
	`»move_šode_bufãrs
(
šode
))

666 
»­
 +ğ
	`šv®id©e_m­pšg_·ges
(&
šode
->
i_d©a
,

668 
	`ut
(
šode
);

669 
	`¥š_lock
(&
sb
->
s_šode_Ìu_lock
);

671 ià(
šode
 !ğ
	`li¡_’Œy
(
sb
->
s_šode_Ìu
.
Ãxt
,

672 
šode
, 
i_Ìu
))

675 ià(!
	`¥š_Œylock
(&
šode
->
i_lock
))

677 ià(!
	`ÿn_unu£
(
šode
)) {

678 
	`¥š_uÆock
(&
šode
->
i_lock
);

682 
	`WARN_ON
(
šode
->
i_¡©e
 & 
I_NEW
);

683 
šode
->
i_¡©e
 |ğ
I_FREEING
;

684 
	`¥š_uÆock
(&
šode
->
i_lock
);

686 
	`li¡_move
(&
šode
->
i_Ìu
, &
ä“abË
);

687 
sb
->
s_Ä_šodes_unu£d
--;

688 
	`this_ıu_dec
(
Ä_unu£d
);

690 ià(
	`cu¼’t_is_ksw­d
())

691 
	`__couÁ_vm_ev’ts
(
KSWAPD_INODESTEAL
, 
»­
);

693 
	`__couÁ_vm_ev’ts
(
PGINODESTEAL
, 
»­
);

694 
	`¥š_uÆock
(&
sb
->
s_šode_Ìu_lock
);

696 
	`di¥o£_li¡
(&
ä“abË
);

697 
	}
}

699 
__wa™_Ú_ä“šg_šode
(
šode
 *inode);

703 
šode
 *
fšd_šode
(
su³r_block
 *
sb
,

704 
hli¡_h—d
 *
h—d
,

705 (*
‹¡
)(
šode
 *, *),

706 *
d©a
)

708 
hli¡_node
 *
node
;

709 
šode
 *šodğ
NULL
;

711 
»³©
:

712 
	`hli¡_fÜ_—ch_’Œy
(
šode
, 
node
, 
h—d
, 
i_hash
) {

713 
	`¥š_lock
(&
šode
->
i_lock
);

714 ià(
šode
->
i_sb
 !ğ
sb
) {

715 
	`¥š_uÆock
(&
šode
->
i_lock
);

718 ià(!
	`‹¡
(
šode
, 
d©a
)) {

719 
	`¥š_uÆock
(&
šode
->
i_lock
);

722 ià(
šode
->
i_¡©e
 & (
I_FREEING
|
I_WILL_FREE
)) {

723 
	`__wa™_Ú_ä“šg_šode
(
šode
);

724 
»³©
;

726 
	`__ig‘
(
šode
);

727 
	`¥š_uÆock
(&
šode
->
i_lock
);

728  
šode
;

730  
NULL
;

731 
	}
}

737 
šode
 *
	$fšd_šode_ç¡
(
su³r_block
 *
sb
,

738 
hli¡_h—d
 *
h—d
, 
šo
)

740 
hli¡_node
 *
node
;

741 
šode
 *šodğ
NULL
;

743 
»³©
:

744 
	`hli¡_fÜ_—ch_’Œy
(
šode
, 
node
, 
h—d
, 
i_hash
) {

745 
	`¥š_lock
(&
šode
->
i_lock
);

746 ià(
šode
->
i_šo
 !ğ
šo
) {

747 
	`¥š_uÆock
(&
šode
->
i_lock
);

750 ià(
šode
->
i_sb
 !ğ
sb
) {

751 
	`¥š_uÆock
(&
šode
->
i_lock
);

754 ià(
šode
->
i_¡©e
 & (
I_FREEING
|
I_WILL_FREE
)) {

755 
	`__wa™_Ú_ä“šg_šode
(
šode
);

756 
»³©
;

758 
	`__ig‘
(
šode
);

759 
	`¥š_uÆock
(&
šode
->
i_lock
);

760  
šode
;

762  
NULL
;

763 
	}
}

780 
	#LAST_INO_BATCH
 1024

	)

781 
DEFINE_PER_CPU
(, 
Ï¡_šo
);

783 
	$g‘_Ãxt_šo
()

785 *
p
 = &
	`g‘_ıu_v¬
(
Ï¡_šo
);

786 
»s
 = *
p
;

788 #ifdeà
CONFIG_SMP


789 ià(
	`uÆik–y
((
»s
 & (
LAST_INO_BATCH
-1)) == 0)) {

790 
©omic_t
 
sh¬ed_Ï¡_šo
;

791 
Ãxt
 = 
	`©omic_add_»tuº
(
LAST_INO_BATCH
, &
sh¬ed_Ï¡_šo
);

793 
»s
 = 
Ãxt
 - 
LAST_INO_BATCH
;

797 *
p
 = ++
»s
;

798 
	`put_ıu_v¬
(
Ï¡_šo
);

799  
»s
;

800 
	}
}

801 
EXPORT_SYMBOL
(
g‘_Ãxt_šo
);

813 
šode
 *
	$Ãw_šode_p£udo
(
su³r_block
 *
sb
)

815 
šode
 *šodğ
	`®loc_šode
(
sb
);

817 ià(
šode
) {

818 
	`¥š_lock
(&
šode
->
i_lock
);

819 
šode
->
i_¡©e
 = 0;

820 
	`¥š_uÆock
(&
šode
->
i_lock
);

821 
	`INIT_LIST_HEAD
(&
šode
->
i_sb_li¡
);

823  
šode
;

824 
	}
}

838 
šode
 *
	$Ãw_šode
(
su³r_block
 *
sb
)

840 
šode
 *inode;

842 
	`¥š_lock_´eãtch
(&
šode_sb_li¡_lock
);

844 
šode
 = 
	`Ãw_šode_p£udo
(
sb
);

845 ià(
šode
)

846 
	`šode_sb_li¡_add
(
šode
);

847  
šode
;

848 
	}
}

849 
EXPORT_SYMBOL
(
Ãw_šode
);

851 #ifdeà
CONFIG_DEBUG_LOCK_ALLOC


852 
	$lockd•_ªnÙ©e_šode_mu‹x_key
(
šode
 *inode)

854 ià(
	`S_ISDIR
(
šode
->
i_mode
)) {

855 
fe_sy¡em_ty³
 *
ty³
 = 
šode
->
i_sb
->
s_ty³
;

858 ià(!
	`lockd•_m©ch_şass
(&
šode
->
i_mu‹x
,

859 &
ty³
->
i_mu‹x_key
)) {

863 
	`mu‹x_de¡roy
(&
šode
->
i_mu‹x
);

864 
	`mu‹x_š™
(&
šode
->
i_mu‹x
);

865 
	`lockd•_£t_şass
(&
šode
->
i_mu‹x
,

866 &
ty³
->
i_mu‹x_dœ_key
);

869 
	}
}

870 
EXPORT_SYMBOL
(
lockd•_ªnÙ©e_šode_mu‹x_key
);

880 
	$uÆock_Ãw_šode
(
šode
 *inode)

882 
	`lockd•_ªnÙ©e_šode_mu‹x_key
(
šode
);

883 
	`¥š_lock
(&
šode
->
i_lock
);

884 
	`WARN_ON
(!(
šode
->
i_¡©e
 & 
I_NEW
));

885 
šode
->
i_¡©e
 &ğ~
I_NEW
;

886 
	`wake_up_b™
(&
šode
->
i_¡©e
, 
__I_NEW
);

887 
	`¥š_uÆock
(&
šode
->
i_lock
);

888 
	}
}

889 
EXPORT_SYMBOL
(
uÆock_Ãw_šode
);

911 
šode
 *
ig‘5_locked
(
su³r_block
 *
sb
, 
hashv®
,

912 (*
‹¡
)(
šode
 *, *),

913 (*
£t
)(
šode
 *, *), *
d©a
)

915 
hli¡_h—d
 *
h—d
 = 
šode_hashbË
 + 
	`hash
(
sb
, 
hashv®
);

916 
šode
 *inode;

918 
	`¥š_lock
(&
šode_hash_lock
);

919 
šode
 = 
	`fšd_šode
(
sb
, 
h—d
, 
‹¡
, 
d©a
);

920 
	`¥š_uÆock
(&
šode_hash_lock
);

922 ià(
šode
) {

923 
	`wa™_Ú_šode
(
šode
);

924  
šode
;

927 
šode
 = 
	`®loc_šode
(
sb
);

928 ià(
šode
) {

929 
šode
 *
Şd
;

931 
	`¥š_lock
(&
šode_hash_lock
);

933 
Şd
 = 
	`fšd_šode
(
sb
, 
h—d
, 
‹¡
, 
d©a
);

934 ià(!
Şd
) {

935 ià(
	`£t
(
šode
, 
d©a
))

936 
£t_çed
;

938 
	`¥š_lock
(&
šode
->
i_lock
);

939 
šode
->
i_¡©e
 = 
I_NEW
;

940 
	`hli¡_add_h—d
(&
šode
->
i_hash
, 
h—d
);

941 
	`¥š_uÆock
(&
šode
->
i_lock
);

942 
	`šode_sb_li¡_add
(
šode
);

943 
	`¥š_uÆock
(&
šode_hash_lock
);

948  
šode
;

956 
	`¥š_uÆock
(&
šode_hash_lock
);

957 
	`de¡roy_šode
(
šode
);

958 
šode
 = 
Şd
;

959 
	`wa™_Ú_šode
(
šode
);

961  
šode
;

963 
£t_çed
:

964 
	`¥š_uÆock
(&
šode_hash_lock
);

965 
	`de¡roy_šode
(
šode
);

966  
NULL
;

967 
	}
}

968 
EXPORT_SYMBOL
(
ig‘5_locked
);

983 
šode
 *
	$ig‘_locked
(
su³r_block
 *
sb
, 
šo
)

985 
hli¡_h—d
 *
h—d
 = 
šode_hashbË
 + 
	`hash
(
sb
, 
šo
);

986 
šode
 *inode;

988 
	`¥š_lock
(&
šode_hash_lock
);

989 
šode
 = 
	`fšd_šode_ç¡
(
sb
, 
h—d
, 
šo
);

990 
	`¥š_uÆock
(&
šode_hash_lock
);

991 ià(
šode
) {

992 
	`wa™_Ú_šode
(
šode
);

993  
šode
;

996 
šode
 = 
	`®loc_šode
(
sb
);

997 ià(
šode
) {

998 
šode
 *
Şd
;

1000 
	`¥š_lock
(&
šode_hash_lock
);

1002 
Şd
 = 
	`fšd_šode_ç¡
(
sb
, 
h—d
, 
šo
);

1003 ià(!
Şd
) {

1004 
šode
->
i_šo
 = 
šo
;

1005 
	`¥š_lock
(&
šode
->
i_lock
);

1006 
šode
->
i_¡©e
 = 
I_NEW
;

1007 
	`hli¡_add_h—d
(&
šode
->
i_hash
, 
h—d
);

1008 
	`¥š_uÆock
(&
šode
->
i_lock
);

1009 
	`šode_sb_li¡_add
(
šode
);

1010 
	`¥š_uÆock
(&
šode_hash_lock
);

1015  
šode
;

1023 
	`¥š_uÆock
(&
šode_hash_lock
);

1024 
	`de¡roy_šode
(
šode
);

1025 
šode
 = 
Şd
;

1026 
	`wa™_Ú_šode
(
šode
);

1028  
šode
;

1029 
	}
}

1030 
EXPORT_SYMBOL
(
ig‘_locked
);

1039 
	$‹¡_šode_iunique
(
su³r_block
 *
sb
, 
šo
)

1041 
hli¡_h—d
 *
b
 = 
šode_hashbË
 + 
	`hash
(
sb
, 
šo
);

1042 
hli¡_node
 *
node
;

1043 
šode
 *inode;

1045 
	`¥š_lock
(&
šode_hash_lock
);

1046 
	`hli¡_fÜ_—ch_’Œy
(
šode
, 
node
, 
b
, 
i_hash
) {

1047 ià(
šode
->
i_šo
 =ğ
šo
 && inode->
i_sb
 =ğ
sb
) {

1048 
	`¥š_uÆock
(&
šode_hash_lock
);

1052 
	`¥š_uÆock
(&
šode_hash_lock
);

1055 
	}
}

1071 
šo_t
 
	$iunique
(
su³r_block
 *
sb
, 
šo_t
 
max_»£rved
)

1078 
	`DEFINE_SPINLOCK
(
iunique_lock
);

1079 
couÁ”
;

1080 
šo_t
 
»s
;

1082 
	`¥š_lock
(&
iunique_lock
);

1084 ià(
couÁ”
 <ğ
max_»£rved
)

1085 
couÁ”
 = 
max_»£rved
 + 1;

1086 
»s
 = 
couÁ”
++;

1087 } !
	`‹¡_šode_iunique
(
sb
, 
»s
));

1088 
	`¥š_uÆock
(&
iunique_lock
);

1090  
»s
;

1091 
	}
}

1092 
EXPORT_SYMBOL
(
iunique
);

1094 
šode
 *
	$ig¿b
(
šode
 *inode)

1096 
	`¥š_lock
(&
šode
->
i_lock
);

1097 ià(!(
šode
->
i_¡©e
 & (
I_FREEING
|
I_WILL_FREE
))) {

1098 
	`__ig‘
(
šode
);

1099 
	`¥š_uÆock
(&
šode
->
i_lock
);

1101 
	`¥š_uÆock
(&
šode
->
i_lock
);

1107 
šode
 = 
NULL
;

1109  
šode
;

1110 
	}
}

1111 
EXPORT_SYMBOL
(
ig¿b
);

1129 
šode
 *
ookup5_nowa™
(
su³r_block
 *
sb
, 
hashv®
,

1130 (*
‹¡
)(
šode
 *, *), *
d©a
)

1132 
hli¡_h—d
 *
h—d
 = 
šode_hashbË
 + 
	`hash
(
sb
, 
hashv®
);

1133 
šode
 *inode;

1135 
	`¥š_lock
(&
šode_hash_lock
);

1136 
šode
 = 
	`fšd_šode
(
sb
, 
h—d
, 
‹¡
, 
d©a
);

1137 
	`¥š_uÆock
(&
šode_hash_lock
);

1139  
šode
;

1140 
	}
}

1141 
EXPORT_SYMBOL
(
ookup5_nowa™
);

1160 
šode
 *
ookup5
(
su³r_block
 *
sb
, 
hashv®
,

1161 (*
‹¡
)(
šode
 *, *), *
d©a
)

1163 
šode
 *šodğ
	`ookup5_nowa™
(
sb
, 
hashv®
, 
‹¡
, 
d©a
);

1165 ià(
šode
)

1166 
	`wa™_Ú_šode
(
šode
);

1167  
šode
;

1168 
	}
}

1169 
EXPORT_SYMBOL
(
ookup5
);

1179 
šode
 *
	$ookup
(
su³r_block
 *
sb
, 
šo
)

1181 
hli¡_h—d
 *
h—d
 = 
šode_hashbË
 + 
	`hash
(
sb
, 
šo
);

1182 
šode
 *inode;

1184 
	`¥š_lock
(&
šode_hash_lock
);

1185 
šode
 = 
	`fšd_šode_ç¡
(
sb
, 
h—d
, 
šo
);

1186 
	`¥š_uÆock
(&
šode_hash_lock
);

1188 ià(
šode
)

1189 
	`wa™_Ú_šode
(
šode
);

1190  
šode
;

1191 
	}
}

1192 
EXPORT_SYMBOL
(
ookup
);

1194 
	$š£¹_šode_locked
(
šode
 *inode)

1196 
su³r_block
 *
sb
 = 
šode
->
i_sb
;

1197 
šo_t
 
šo
 = 
šode
->
i_šo
;

1198 
hli¡_h—d
 *
h—d
 = 
šode_hashbË
 + 
	`hash
(
sb
, 
šo
);

1201 
hli¡_node
 *
node
;

1202 
šode
 *
Şd
 = 
NULL
;

1203 
	`¥š_lock
(&
šode_hash_lock
);

1204 
	`hli¡_fÜ_—ch_’Œy
(
Şd
, 
node
, 
h—d
, 
i_hash
) {

1205 ià(
Şd
->
i_šo
 !ğ
šo
)

1207 ià(
Şd
->
i_sb
 !ğ
sb
)

1209 
	`¥š_lock
(&
Şd
->
i_lock
);

1210 ià(
Şd
->
i_¡©e
 & (
I_FREEING
|
I_WILL_FREE
)) {

1211 
	`¥š_uÆock
(&
Şd
->
i_lock
);

1216 ià(
	`lik–y
(!
node
)) {

1217 
	`¥š_lock
(&
šode
->
i_lock
);

1218 
šode
->
i_¡©e
 |ğ
I_NEW
;

1219 
	`hli¡_add_h—d
(&
šode
->
i_hash
, 
h—d
);

1220 
	`¥š_uÆock
(&
šode
->
i_lock
);

1221 
	`¥š_uÆock
(&
šode_hash_lock
);

1224 
	`__ig‘
(
Şd
);

1225 
	`¥š_uÆock
(&
Şd
->
i_lock
);

1226 
	`¥š_uÆock
(&
šode_hash_lock
);

1227 
	`wa™_Ú_šode
(
Şd
);

1228 ià(
	`uÆik–y
(!
	`šode_unhashed
(
Şd
))) {

1229 
	`ut
(
Şd
);

1230  -
EBUSY
;

1232 
	`ut
(
Şd
);

1234 
	}
}

1235 
EXPORT_SYMBOL
(
š£¹_šode_locked
);

1237 
š£¹_šode_locked4
(
šode
 *šode, 
hashv®
,

1238 (*
‹¡
)(
šode
 *, *), *
d©a
)

1240 
su³r_block
 *
sb
 = 
šode
->
i_sb
;

1241 
hli¡_h—d
 *
h—d
 = 
šode_hashbË
 + 
	`hash
(
sb
, 
hashv®
);

1244 
hli¡_node
 *
node
;

1245 
šode
 *
Şd
 = 
NULL
;

1247 
	`¥š_lock
(&
šode_hash_lock
);

1248 
	`hli¡_fÜ_—ch_’Œy
(
Şd
, 
node
, 
h—d
, 
i_hash
) {

1249 ià(
Şd
->
i_sb
 !ğ
sb
)

1251 ià(!
	`‹¡
(
Şd
, 
d©a
))

1253 
	`¥š_lock
(&
Şd
->
i_lock
);

1254 ià(
Şd
->
i_¡©e
 & (
I_FREEING
|
I_WILL_FREE
)) {

1255 
	`¥š_uÆock
(&
Şd
->
i_lock
);

1260 ià(
	`lik–y
(!
node
)) {

1261 
	`¥š_lock
(&
šode
->
i_lock
);

1262 
šode
->
i_¡©e
 |ğ
I_NEW
;

1263 
	`hli¡_add_h—d
(&
šode
->
i_hash
, 
h—d
);

1264 
	`¥š_uÆock
(&
šode
->
i_lock
);

1265 
	`¥š_uÆock
(&
šode_hash_lock
);

1268 
	`__ig‘
(
Şd
);

1269 
	`¥š_uÆock
(&
Şd
->
i_lock
);

1270 
	`¥š_uÆock
(&
šode_hash_lock
);

1271 
	`wa™_Ú_šode
(
Şd
);

1272 ià(
	`uÆik–y
(!
	`šode_unhashed
(
Şd
))) {

1273 
	`ut
(
Şd
);

1274  -
EBUSY
;

1276 
	`ut
(
Şd
);

1278 
	}
}

1279 
EXPORT_SYMBOL
(
š£¹_šode_locked4
);

1282 
	$g’”ic_d–‘e_šode
(
šode
 *inode)

1285 
	}
}

1286 
EXPORT_SYMBOL
(
g’”ic_d–‘e_šode
);

1293 
	$g’”ic_drİ_šode
(
šode
 *inode)

1295  !
šode
->
i_Æšk
 || 
	`šode_unhashed
(inode);

1296 
	}
}

1297 
EXPORT_SYMBOL_GPL
(
g’”ic_drİ_šode
);

1309 
	$ut_fš®
(
šode
 *inode)

1311 
su³r_block
 *
sb
 = 
šode
->
i_sb
;

1312 cÚ¡ 
su³r_İ”©iÚs
 *
İ
 = 
šode
->
i_sb
->
s_İ
;

1313 
drİ
;

1315 
	`WARN_ON
(
šode
->
i_¡©e
 & 
I_NEW
);

1317 ià(
İ
->
drİ_šode
)

1318 
drİ
 = 
İ
->
	`drİ_šode
(
šode
);

1320 
drİ
 = 
	`g’”ic_drİ_šode
(
šode
);

1322 ià(!
drİ
 && (
sb
->
s_æags
 & 
MS_ACTIVE
)) {

1323 
šode
->
i_¡©e
 |ğ
I_REFERENCED
;

1324 ià(!(
šode
->
i_¡©e
 & (
I_DIRTY
|
I_SYNC
)))

1325 
	`šode_Ìu_li¡_add
(
šode
);

1326 
	`¥š_uÆock
(&
šode
->
i_lock
);

1330 ià(!
drİ
) {

1331 
šode
->
i_¡©e
 |ğ
I_WILL_FREE
;

1332 
	`¥š_uÆock
(&
šode
->
i_lock
);

1333 
	`wr™e_šode_now
(
šode
, 1);

1334 
	`¥š_lock
(&
šode
->
i_lock
);

1335 
	`WARN_ON
(
šode
->
i_¡©e
 & 
I_NEW
);

1336 
šode
->
i_¡©e
 &ğ~
I_WILL_FREE
;

1339 
šode
->
i_¡©e
 |ğ
I_FREEING
;

1340 ià(!
	`li¡_em±y
(&
šode
->
i_Ìu
))

1341 
	`šode_Ìu_li¡_d–
(
šode
);

1342 
	`¥š_uÆock
(&
šode
->
i_lock
);

1344 
	`eviù
(
šode
);

1345 
	}
}

1356 
	$ut
(
šode
 *inode)

1358 ià(
šode
) {

1359 
	`BUG_ON
(
šode
->
i_¡©e
 & 
I_CLEAR
);

1361 ià(
	`©omic_dec_ªd_lock
(&
šode
->
i_couÁ
, &šode->
i_lock
))

1362 
	`ut_fš®
(
šode
);

1364 
	}
}

1365 
EXPORT_SYMBOL
(
ut
);

1378 
£ùÜ_t
 
	$bm­
(
šode
 *šode, 
£ùÜ_t
 
block
)

1380 
£ùÜ_t
 
»s
 = 0;

1381 ià(
šode
->
i_m­pšg
->
a_İs
->
bm­
)

1382 
»s
 = 
šode
->
i_m­pšg
->
a_İs
->
	`bm­
(šode->i_m­pšg, 
block
);

1383  
»s
;

1384 
	}
}

1385 
EXPORT_SYMBOL
(
bm­
);

1392 
	$»Ïtime_Ãed_upd©e
(
vfsmouÁ
 *
mÁ
, 
šode
 *inode,

1393 
time¥ec
 
now
)

1396 ià(!(
mÁ
->
mÁ_æags
 & 
MNT_RELATIME
))

1401 ià(
	`time¥ec_com·»
(&
šode
->
i_mtime
, &šode->
i_©ime
) >= 0)

1406 ià(
	`time¥ec_com·»
(&
šode
->
i_ùime
, &šode->
i_©ime
) >= 0)

1413 ià(()(
now
.
tv_£c
 - 
šode
->
i_©ime
.tv_sec) >= 24*60*60)

1419 
	}
}

1430 
	$touch_©ime
(
vfsmouÁ
 *
mÁ
, 
d’Œy
 *dentry)

1432 
šode
 *šodğ
d’Œy
->
d_šode
;

1433 
time¥ec
 
now
;

1435 ià(
šode
->
i_æags
 & 
S_NOATIME
)

1437 ià(
	`IS_NOATIME
(
šode
))

1439 ià((
šode
->
i_sb
->
s_æags
 & 
MS_NODIRATIME
è&& 
	`S_ISDIR
(šode->
i_mode
))

1442 ià(
mÁ
->
mÁ_æags
 & 
MNT_NOATIME
)

1444 ià((
mÁ
->
mÁ_æags
 & 
MNT_NODIRATIME
è&& 
	`S_ISDIR
(
šode
->
i_mode
))

1447 
now
 = 
	`cu¼’t_fs_time
(
šode
->
i_sb
);

1449 ià(!
	`»Ïtime_Ãed_upd©e
(
mÁ
, 
šode
, 
now
))

1452 ià(
	`time¥ec_equ®
(&
šode
->
i_©ime
, &
now
))

1455 ià(
	`mÁ_wªt_wr™e
(
mÁ
))

1458 
šode
->
i_©ime
 = 
now
;

1459 
	`m¬k_šode_dœty_sync
(
šode
);

1460 
	`mÁ_drİ_wr™e
(
mÁ
);

1461 
	}
}

1462 
EXPORT_SYMBOL
(
touch_©ime
);

1476 
	$fe_upd©e_time
(
fe
 *file)

1478 
šode
 *šodğ
fe
->
f_·th
.
d’Œy
->
d_šode
;

1479 
time¥ec
 
now
;

1480 ’um { 
S_MTIME
 = 1, 
S_CTIME
 = 2, 
S_VERSION
 = 4 } 
sync_™
 = 0;

1483 ià(
	`IS_NOCMTIME
(
šode
))

1486 
now
 = 
	`cu¼’t_fs_time
(
šode
->
i_sb
);

1487 ià(!
	`time¥ec_equ®
(&
šode
->
i_mtime
, &
now
))

1488 
sync_™
 = 
S_MTIME
;

1490 ià(!
	`time¥ec_equ®
(&
šode
->
i_ùime
, &
now
))

1491 
sync_™
 |ğ
S_CTIME
;

1493 ià(
	`IS_I_VERSION
(
šode
))

1494 
sync_™
 |ğ
S_VERSION
;

1496 ià(!
sync_™
)

1500 ià(
	`mÁ_wªt_wr™e_fe
(
fe
))

1504 ià(
sync_™
 & 
S_VERSION
)

1505 
	`šode_šc_iv”siÚ
(
šode
);

1506 ià(
sync_™
 & 
S_CTIME
)

1507 
šode
->
i_ùime
 = 
now
;

1508 ià(
sync_™
 & 
S_MTIME
)

1509 
šode
->
i_mtime
 = 
now
;

1510 
	`m¬k_šode_dœty_sync
(
šode
);

1511 
	`mÁ_drİ_wr™e
(
fe
->
f_·th
.
mÁ
);

1512 
	}
}

1513 
EXPORT_SYMBOL
(
fe_upd©e_time
);

1515 
	$šode_Ãeds_sync
(
šode
 *inode)

1517 ià(
	`IS_SYNC
(
šode
))

1519 ià(
	`S_ISDIR
(
šode
->
i_mode
è&& 
	`IS_DIRSYNC
(inode))

1522 
	}
}

1523 
EXPORT_SYMBOL
(
šode_Ãeds_sync
);

1525 
	$šode_wa™
(*
wÜd
)

1527 
	`scheduË
();

1529 
	}
}

1530 
EXPORT_SYMBOL
(
šode_wa™
);

1543 
	$__wa™_Ú_ä“šg_šode
(
šode
 *inode)

1545 
wa™_queue_h—d_t
 *
wq
;

1546 
	`DEFINE_WAIT_BIT
(
wa™
, &
šode
->
i_¡©e
, 
__I_NEW
);

1547 
wq
 = 
	`b™_wa™queue
(&
šode
->
i_¡©e
, 
__I_NEW
);

1548 
	`´•¬e_to_wa™
(
wq
, &
wa™
.wa™, 
TASK_UNINTERRUPTIBLE
);

1549 
	`¥š_uÆock
(&
šode
->
i_lock
);

1550 
	`¥š_uÆock
(&
šode_hash_lock
);

1551 
	`scheduË
();

1552 
	`fšish_wa™
(
wq
, &
wa™
.wait);

1553 
	`¥š_lock
(&
šode_hash_lock
);

1554 
	}
}

1556 
__š™d©a
 
	gihash_’Œ›s
;

1557 
__š™
 
	$£t_ihash_’Œ›s
(*
¡r
)

1559 ià(!
¡r
)

1561 
ihash_’Œ›s
 = 
	`sim¶e_¡¹oul
(
¡r
, &str, 0);

1563 
	}
}

1564 
__£tup
("ihash_’Œ›s=", 
£t_ihash_’Œ›s
);

1569 
__š™
 
	$šode_š™_—¾y
()

1571 
loİ
;

1576 ià(
hashdi¡
)

1579 
šode_hashbË
 =

1580 
	`®loc_Ïrge_sy¡em_hash
("Inode-cache",

1581 (
hli¡_h—d
),

1582 
ihash_’Œ›s
,

1584 
HASH_EARLY
,

1585 &
i_hash_shiá
,

1586 &
i_hash_mask
,

1589 
loİ
 = 0;†oİ < (1 << 
i_hash_shiá
);†oop++)

1590 
	`INIT_HLIST_HEAD
(&
šode_hashbË
[
loİ
]);

1591 
	}
}

1593 
__š™
 
	$šode_š™
()

1595 
loİ
;

1598 
šode_ÿch•
 = 
	`kmem_ÿche_ü—‹
("inode_cache",

1599 (
šode
),

1601 (
SLAB_RECLAIM_ACCOUNT
|
SLAB_PANIC
|

1602 
SLAB_MEM_SPREAD
),

1603 
š™_Úû
);

1606 ià(!
hashdi¡
)

1609 
šode_hashbË
 =

1610 
	`®loc_Ïrge_sy¡em_hash
("Inode-cache",

1611 (
hli¡_h—d
),

1612 
ihash_’Œ›s
,

1615 &
i_hash_shiá
,

1616 &
i_hash_mask
,

1619 
loİ
 = 0;†oİ < (1 << 
i_hash_shiá
);†oop++)

1620 
	`INIT_HLIST_HEAD
(&
šode_hashbË
[
loİ
]);

1621 
	}
}

1623 
	$š™_¥ecŸl_šode
(
šode
 *šode, 
umode_t
 
mode
, 
dev_t
 
rdev
)

1625 
šode
->
i_mode
 = 
mode
;

1626 ià(
	`S_ISCHR
(
mode
)) {

1627 
šode
->
i_fİ
 = &
def_chr_fİs
;

1628 
šode
->
i_rdev
 = 
rdev
;

1629 } ià(
	`S_ISBLK
(
mode
)) {

1630 
šode
->
i_fİ
 = &
def_blk_fİs
;

1631 
šode
->
i_rdev
 = 
rdev
;

1632 } ià(
	`S_ISFIFO
(
mode
))

1633 
šode
->
i_fİ
 = &
def_fifo_fİs
;

1634 ià(
	`S_ISSOCK
(
mode
))

1635 
šode
->
i_fİ
 = &
bad_sock_fİs
;

1637 
	`´štk
(
KERN_DEBUG
 "init_special_inode: bogus i_mode (%o) for"

1638 " inod%s:%lu\n", 
mode
, 
šode
->
i_sb
->
s_id
,

1639 
šode
->
i_šo
);

1640 
	}
}

1641 
EXPORT_SYMBOL
(
š™_¥ecŸl_šode
);

1649 
	$šode_š™_owÃr
(
šode
 *šode, cÚ¡ šod*
dœ
,

1650 
mode_t
 
mode
)

1652 
šode
->
i_uid
 = 
	`cu¼’t_fsuid
();

1653 ià(
dœ
 && dœ->
i_mode
 & 
S_ISGID
) {

1654 
šode
->
i_gid
 = 
dœ
->i_gid;

1655 ià(
	`S_ISDIR
(
mode
))

1656 
mode
 |ğ
S_ISGID
;

1658 
šode
->
i_gid
 = 
	`cu¼’t_fsgid
();

1659 
šode
->
i_mode
 = 
mode
;

1660 
	}
}

1661 
EXPORT_SYMBOL
(
šode_š™_owÃr
);

1670 
boŞ
 
	$šode_owÃr_Ü_ÿ·bË
(cÚ¡ 
šode
 *inode)

1672 
u£r_Çme¥aû
 *
ns
 = 
	`šode_u£ºs
(
šode
);

1674 ià(
	`cu¼’t_u£r_ns
(è=ğ
ns
 && 
	`cu¼’t_fsuid
(è=ğ
šode
->
i_uid
)

1675  
Œue
;

1676 ià(
	`ns_ÿ·bË
(
ns
, 
CAP_FOWNER
))

1677  
Œue
;

1678  
çl£
;

1679 
	}
}

1680 
EXPORT_SYMBOL
(
šode_owÃr_Ü_ÿ·bË
);

	@internal.h

12 
	~<lšux/lglock.h
>

14 
	gsu³r_block
;

15 
	gfe_sy¡em_ty³
;

16 
	glšux_bš´m
;

17 
	g·th
;

22 #ifdeà
CONFIG_BLOCK


23 
su³r_block
 *
blockdev_su³rblock
;

24 
__š™
 
bdev_ÿche_š™
();

26 
šlše
 
	$sb_is_blkdev_sb
(
su³r_block
 *
sb
)

28  
sb
 =ğ
blockdev_su³rblock
;

29 
	}
}

31 
__sync_blockdev
(
block_deviû
 *
bdev
, 
wa™
);

34 
šlše
 
	$bdev_ÿche_š™
()

36 
	}
}

38 
šlše
 
	$sb_is_blkdev_sb
(
su³r_block
 *
sb
)

41 
	}
}

43 
šlše
 
	$__sync_blockdev
(
block_deviû
 *
bdev
, 
wa™
)

46 
	}
}

52 
__š™
 
chrdev_š™
();

57 
check_un§ã_exec
(
lšux_bš´m
 *);

62 
cİy_mouÁ_İtiÚs
(cÚ¡ 
__u£r
 *, *);

63 
cİy_mouÁ_¡ršg
(cÚ¡ 
__u£r
 *, **);

65 
mÁ_g‘_couÁ
(
vfsmouÁ
 *
mÁ
);

66 
vfsmouÁ
 *
__lookup_mÁ
(vfsmouÁ *, 
d’Œy
 *, );

67 
vfsmouÁ
 *
lookup_mÁ
(
·th
 *);

68 
mÁ_£t_mouÁpošt
(
vfsmouÁ
 *, 
d’Œy
 *,

69 
vfsmouÁ
 *);

70 
»Ëa£_mouÁs
(
li¡_h—d
 *);

71 
umouÁ_Œ“
(
vfsmouÁ
 *, , 
li¡_h—d
 *);

72 
vfsmouÁ
 *
cİy_Œ“
(vfsmouÁ *, 
d’Œy
 *, );

73 
fšish_automouÁ
(
vfsmouÁ
 *, 
·th
 *);

75 
mÁ_make_lÚg‹rm
(
vfsmouÁ
 *);

76 
mÁ_make_shÜ‰”m
(
vfsmouÁ
 *);

78 
__š™
 
mÁ_š™
();

80 
DECLARE_BRLOCK
(
vfsmouÁ_lock
);

86 
chroÙ_fs_»fs
(
·th
 *, path *);

91 
fe_sb_li¡_add
(
fe
 *
f
, 
su³r_block
 *
sb
);

92 
fe_sb_li¡_d–
(
fe
 *
f
);

93 
m¬k_fes_ro
(
su³r_block
 *);

94 
fe
 *
g‘_em±y_fp
();

99 
do_»mouÁ_sb
(
su³r_block
 *, , *, );

100 
boŞ
 
g¿b_su³r_·ssive
(
su³r_block
 *
sb
);

101 
__put_su³r
(
su³r_block
 *
sb
);

102 
put_su³r
(
su³r_block
 *
sb
);

103 
d’Œy
 *
mouÁ_fs
(
fe_sy¡em_ty³
 *,

109 
	gÇmeid©a
;

110 
fe
 *
Çmeid©a_to_fp
(
Çmeid©a
 *);

111 
»Ëa£_İ’_š‹Á
(
Çmeid©a
 *);

112 
	sİ’_æags
 {

113 
	mİ’_æag
;

114 
	mmode
;

115 
	macc_mode
;

116 
	mš‹Á
;

118 
fe
 *
do_fp_İ’
(
dfd
, cÚ¡ *
·thÇme
,

119 cÚ¡ 
İ’_æags
 *
İ
, 
lookup_æags
);

120 
fe
 *
do_fe_İ’_roÙ
(
d’Œy
 *, 
vfsmouÁ
 *,

121 cÚ¡ *, cÚ¡ 
İ’_æags
 *, 
lookup_æags
);

123 
do_hªdË_İ’
(
mouÁdœfd
,

124 
fe_hªdË
 
__u£r
 *
ufh
, 
İ’_æag
);

129 
¥šlock_t
 
šode_sb_li¡_lock
;

134 
šode_wb_li¡_d–
(
šode
 *inode);

136 
g‘_Ä_dœty_šodes
();

137 
eviù_šodes
(
su³r_block
 *);

138 
šv®id©e_šodes
(
su³r_block
 *, 
boŞ
);

143 
d’Œy
 *
__d_®loc
(
su³r_block
 *, cÚ¡ 
q¡r
 *);

	@ioctl.c

7 
	~<lšux/sysÿÎs.h
>

8 
	~<lšux/mm.h
>

9 
	~<lšux/ÿ·b™y.h
>

10 
	~<lšux/fe.h
>

11 
	~<lšux/fs.h
>

12 
	~<lšux/£cur™y.h
>

13 
	~<lšux/moduË.h
>

14 
	~<lšux/uacûss.h
>

15 
	~<lšux/wr™eback.h
>

16 
	~<lšux/bufãr_h—d.h
>

17 
	~<lšux/çÎoc.h
>

19 
	~<asm/ioùls.h
>

22 
	#FIEMAP_MAX_EXTENTS
 (
UINT_MAX
 / (
f›m­_ex‹Á
))

	)

35 
	$vfs_ioùl
(
fe
 *
fp
, 
cmd
,

36 
¬g
)

38 
”rÜ
 = -
ENOTTY
;

40 ià(!
fp
->
f_İ
 || !fp->f_İ->
uÆocked_ioùl
)

41 
out
;

43 
”rÜ
 = 
fp
->
f_İ
->
	`uÆocked_ioùl
(fp, 
cmd
, 
¬g
);

44 ià(
”rÜ
 =ğ-
ENOIOCTLCMD
)

45 
”rÜ
 = -
EINVAL
;

46 
out
:

47  
”rÜ
;

48 
	}
}

50 
	$ioùl_fibm­
(
fe
 *
fp
, 
__u£r
 *
p
)

52 
add»ss_¥aû
 *
m­pšg
 = 
fp
->
f_m­pšg
;

53 
»s
, 
block
;

56 ià(!
m­pšg
->
a_İs
->
bm­
)

57  -
EINVAL
;

58 ià(!
	`ÿ·bË
(
CAP_SYS_RAWIO
))

59  -
EPERM
;

60 
»s
 = 
	`g‘_u£r
(
block
, 
p
);

61 ià(
»s
)

62  
»s
;

63 
»s
 = 
m­pšg
->
a_İs
->
	`bm­
(m­pšg, 
block
);

64  
	`put_u£r
(
»s
, 
p
);

65 
	}
}

82 
	#SET_UNKNOWN_FLAGS
 (
FIEMAP_EXTENT_DELALLOC
)

	)

83 
	#SET_NO_UNMOUNTED_IO_FLAGS
 (
FIEMAP_EXTENT_DATA_ENCRYPTED
)

	)

84 
	#SET_NOT_ALIGNED_FLAGS
 (
FIEMAP_EXTENT_DATA_TAIL
|
FIEMAP_EXTENT_DATA_INLINE
)

	)

85 
	$f›m­_fl_Ãxt_ex‹Á
(
f›m­_ex‹Á_šfo
 *
f›šfo
, 
u64
 
logiÿl
,

86 
u64
 
phys
, u64 
Ën
, 
u32
 
æags
)

88 
f›m­_ex‹Á
 
ex‹Á
;

89 
f›m­_ex‹Á
 
__u£r
 *
de¡
 = 
f›šfo
->
fi_ex‹Ás_¡¬t
;

92 ià(
f›šfo
->
fi_ex‹Ás_max
 == 0) {

93 
f›šfo
->
fi_ex‹Ás_m­³d
++;

94  (
æags
 & 
FIEMAP_EXTENT_LAST
) ? 1 : 0;

97 ià(
f›šfo
->
fi_ex‹Ás_m­³d
 >ğf›šfo->
fi_ex‹Ás_max
)

100 ià(
æags
 & 
SET_UNKNOWN_FLAGS
)

101 
æags
 |ğ
FIEMAP_EXTENT_UNKNOWN
;

102 ià(
æags
 & 
SET_NO_UNMOUNTED_IO_FLAGS
)

103 
æags
 |ğ
FIEMAP_EXTENT_ENCODED
;

104 ià(
æags
 & 
SET_NOT_ALIGNED_FLAGS
)

105 
æags
 |ğ
FIEMAP_EXTENT_NOT_ALIGNED
;

107 
	`mem£t
(&
ex‹Á
, 0, (extent));

108 
ex‹Á
.
ã_logiÿl
 = 
logiÿl
;

109 
ex‹Á
.
ã_physiÿl
 = 
phys
;

110 
ex‹Á
.
ã_Ëngth
 = 
Ën
;

111 
ex‹Á
.
ã_æags
 = 
æags
;

113 
de¡
 +ğ
f›šfo
->
fi_ex‹Ás_m­³d
;

114 ià(
	`cİy_to_u£r
(
de¡
, &
ex‹Á
, (extent)))

115  -
EFAULT
;

117 
f›šfo
->
fi_ex‹Ás_m­³d
++;

118 ià(
f›šfo
->
fi_ex‹Ás_m­³d
 =ğf›šfo->
fi_ex‹Ás_max
)

120  (
æags
 & 
FIEMAP_EXTENT_LAST
) ? 1 : 0;

121 
	}
}

122 
EXPORT_SYMBOL
(
f›m­_fl_Ãxt_ex‹Á
);

138 
	$f›m­_check_æags
(
f›m­_ex‹Á_šfo
 *
f›šfo
, 
u32
 
fs_æags
)

140 
u32
 
šcom·t_æags
;

142 
šcom·t_æags
 = 
f›šfo
->
fi_æags
 & ~(
FIEMAP_FLAGS_COMPAT
 & 
fs_æags
);

143 ià(
šcom·t_æags
) {

144 
f›šfo
->
fi_æags
 = 
šcom·t_æags
;

145  -
EBADR
;

148 
	}
}

149 
EXPORT_SYMBOL
(
f›m­_check_æags
);

151 
	$f›m­_check_¿nges
(
su³r_block
 *
sb
,

152 
u64
 
¡¬t
, u64 
Ën
, u64 *
Ãw_Ën
)

154 
u64
 
maxby‹s
 = (u64è
sb
->
s_maxby‹s
;

156 *
Ãw_Ën
 = 
Ën
;

158 ià(
Ën
 == 0)

159  -
EINVAL
;

161 ià(
¡¬t
 > 
maxby‹s
)

162  -
EFBIG
;

167 ià(
Ën
 > 
maxby‹s
 || (maxby‹ -†’è< 
¡¬t
)

168 *
Ãw_Ën
 = 
maxby‹s
 - 
¡¬t
;

171 
	}
}

173 
	$ioùl_f›m­
(
fe
 *
fp
, 
¬g
)

175 
f›m­
 fiemap;

176 
f›m­
 
__u£r
 *
uf›m­
 = (f›m­ __u£¸*è
¬g
;

177 
f›m­_ex‹Á_šfo
 
f›šfo
 = { 0, };

178 
šode
 *šodğ
fp
->
f_·th
.
d’Œy
->
d_šode
;

179 
su³r_block
 *
sb
 = 
šode
->
i_sb
;

180 
u64
 
Ën
;

181 
”rÜ
;

183 ià(!
šode
->
i_İ
->
f›m­
)

184  -
EOPNOTSUPP
;

186 ià(
	`cİy_äom_u£r
(&
f›m­
, 
uf›m­
, (fiemap)))

187  -
EFAULT
;

189 ià(
f›m­
.
fm_ex‹Á_couÁ
 > 
FIEMAP_MAX_EXTENTS
)

190  -
EINVAL
;

192 
”rÜ
 = 
	`f›m­_check_¿nges
(
sb
, 
f›m­
.
fm_¡¬t
, f›m­.
fm_Ëngth
,

193 &
Ën
);

194 ià(
”rÜ
)

195  
”rÜ
;

197 
f›šfo
.
fi_æags
 = 
f›m­
.
fm_æags
;

198 
f›šfo
.
fi_ex‹Ás_max
 = 
f›m­
.
fm_ex‹Á_couÁ
;

199 
f›šfo
.
fi_ex‹Ás_¡¬t
 = 
uf›m­
->
fm_ex‹Ás
;

201 ià(
f›m­
.
fm_ex‹Á_couÁ
 != 0 &&

202 !
	`acûss_ok
(
VERIFY_WRITE
, 
f›šfo
.
fi_ex‹Ás_¡¬t
,

203 
f›šfo
.
fi_ex‹Ás_max
 * (
f›m­_ex‹Á
)))

204  -
EFAULT
;

206 ià(
f›šfo
.
fi_æags
 & 
FIEMAP_FLAG_SYNC
)

207 
	`fem­_wr™e_ªd_wa™
(
šode
->
i_m­pšg
);

209 
”rÜ
 = 
šode
->
i_İ
->
	`f›m­
(šode, &
f›šfo
, 
f›m­
.
fm_¡¬t
, 
Ën
);

210 
f›m­
.
fm_æags
 = 
f›šfo
.
fi_æags
;

211 
f›m­
.
fm_m­³d_ex‹Ás
 = 
f›šfo
.
fi_ex‹Ás_m­³d
;

212 ià(
	`cİy_to_u£r
(
uf›m­
, &
f›m­
, (fiemap)))

213 
”rÜ
 = -
EFAULT
;

215  
”rÜ
;

216 
	}
}

218 #ifdeà
CONFIG_BLOCK


220 
šlše
 
£ùÜ_t
 
	$logiÿl_to_blk
(
šode
 *šode, 
loff_t
 
off£t
)

222  (
off£t
 >> 
šode
->
i_blkb™s
);

223 
	}
}

225 
šlše
 
loff_t
 
	$blk_to_logiÿl
(
šode
 *šode, 
£ùÜ_t
 
blk
)

227  (
blk
 << 
šode
->
i_blkb™s
);

228 
	}
}

250 
	$__g’”ic_block_f›m­
(
šode
 *inode,

251 
f›m­_ex‹Á_šfo
 *
f›šfo
, 
loff_t
 
¡¬t
,

252 
loff_t
 
Ën
, 
g‘_block_t
 *
g‘_block
)

254 
bufãr_h—d
 
m­_bh
;

255 
£ùÜ_t
 
¡¬t_blk
, 
Ï¡_blk
;

256 
loff_t
 
isize
 = 
	`i_size_»ad
(
šode
);

257 
u64
 
logiÿl
 = 0, 
phys
 = 0, 
size
 = 0;

258 
u32
 
æags
 = 
FIEMAP_EXTENT_MERGED
;

259 
boŞ
 
·¡_eof
 = 
çl£
, 
whŞe_fe
 = false;

260 
»t
 = 0;

262 
»t
 = 
	`f›m­_check_æags
(
f›šfo
, 
FIEMAP_FLAG_SYNC
);

263 ià(
»t
)

264  
»t
;

271 ià(
Ën
 >ğ
isize
) {

272 
whŞe_fe
 = 
Œue
;

273 
Ën
 = 
isize
;

280 ià(
	`logiÿl_to_blk
(
šode
, 
Ën
) == 0)

281 
Ën
 = 
	`blk_to_logiÿl
(
šode
, 1);

283 
¡¬t_blk
 = 
	`logiÿl_to_blk
(
šode
, 
¡¬t
);

284 
Ï¡_blk
 = 
	`logiÿl_to_blk
(
šode
, 
¡¬t
 + 
Ën
 - 1);

291 
	`mem£t
(&
m­_bh
, 0, (
bufãr_h—d
));

292 
m­_bh
.
b_size
 = 
Ën
;

294 
»t
 = 
	`g‘_block
(
šode
, 
¡¬t_blk
, &
m­_bh
, 0);

295 ià(
»t
)

299 ià(!
	`bufãr_m­³d
(&
m­_bh
)) {

300 
¡¬t_blk
++;

309 ià(!
·¡_eof
 &&

310 
	`blk_to_logiÿl
(
šode
, 
¡¬t_blk
è>ğ
isize
)

311 
·¡_eof
 = 1;

317 ià(
·¡_eof
 && 
size
) {

318 
æags
 = 
FIEMAP_EXTENT_MERGED
|
FIEMAP_EXTENT_LAST
;

319 
»t
 = 
	`f›m­_fl_Ãxt_ex‹Á
(
f›šfo
, 
logiÿl
,

320 
phys
, 
size
,

321 
æags
);

322 } ià(
size
) {

323 
»t
 = 
	`f›m­_fl_Ãxt_ex‹Á
(
f›šfo
, 
logiÿl
,

324 
phys
, 
size
, 
æags
);

325 
size
 = 0;

329 ià(
¡¬t_blk
 > 
Ï¡_blk
 || 
·¡_eof
 || 
»t
)

347 ià(
¡¬t_blk
 > 
Ï¡_blk
 && !
whŞe_fe
) {

348 
»t
 = 
	`f›m­_fl_Ãxt_ex‹Á
(
f›šfo
, 
logiÿl
,

349 
phys
, 
size
,

350 
æags
);

358 ià(
size
) {

359 
»t
 = 
	`f›m­_fl_Ãxt_ex‹Á
(
f›šfo
, 
logiÿl
,

360 
phys
, 
size
,

361 
æags
);

362 ià(
»t
)

366 
logiÿl
 = 
	`blk_to_logiÿl
(
šode
, 
¡¬t_blk
);

367 
phys
 = 
	`blk_to_logiÿl
(
šode
, 
m­_bh
.
b_blockÄ
);

368 
size
 = 
m­_bh
.
b_size
;

369 
æags
 = 
FIEMAP_EXTENT_MERGED
;

371 
¡¬t_blk
 +ğ
	`logiÿl_to_blk
(
šode
, 
size
);

378 ià(!
·¡_eof
 && 
logiÿl
 + 
size
 >ğ
isize
)

379 
·¡_eof
 = 
Œue
;

381 
	`cÚd_»sched
();

385 ià(
»t
 == 1)

386 
»t
 = 0;

388  
»t
;

389 
	}
}

390 
EXPORT_SYMBOL
(
__g’”ic_block_f›m­
);

404 
	$g’”ic_block_f›m­
(
šode
 *inode,

405 
f›m­_ex‹Á_šfo
 *
f›šfo
, 
u64
 
¡¬t
,

406 
u64
 
Ën
, 
g‘_block_t
 *
g‘_block
)

408 
»t
;

409 
	`mu‹x_lock
(&
šode
->
i_mu‹x
);

410 
»t
 = 
	`__g’”ic_block_f›m­
(
šode
, 
f›šfo
, 
¡¬t
, 
Ën
, 
g‘_block
);

411 
	`mu‹x_uÆock
(&
šode
->
i_mu‹x
);

412  
»t
;

413 
	}
}

414 
EXPORT_SYMBOL
(
g’”ic_block_f›m­
);

425 
	$ioùl_´—Îoÿ‹
(
fe
 *
fp
, 
__u£r
 *
¬gp
)

427 
šode
 *šodğ
fp
->
f_·th
.
d’Œy
->
d_šode
;

428 
¥aû_»sv
 
¤
;

430 ià(
	`cİy_äom_u£r
(&
¤
, 
¬gp
, (sr)))

431  -
EFAULT
;

433 
¤
.
l_wh’û
) {

434 
SEEK_SET
:

436 
SEEK_CUR
:

437 
¤
.
l_¡¬t
 +ğ
fp
->
f_pos
;

439 
SEEK_END
:

440 
¤
.
l_¡¬t
 +ğ
	`i_size_»ad
(
šode
);

443  -
EINVAL
;

446  
	`do_çÎoÿ‹
(
fp
, 
FALLOC_FL_KEEP_SIZE
, 
¤
.
l_¡¬t
, sr.
l_Ën
);

447 
	}
}

449 
	$fe_ioùl
(
fe
 *
fp
, 
cmd
,

450 
¬g
)

452 
šode
 *šodğ
fp
->
f_·th
.
d’Œy
->
d_šode
;

453 
__u£r
 *
p
 = (__u£¸*)
¬g
;

455 
cmd
) {

456 
FIBMAP
:

457  
	`ioùl_fibm­
(
fp
, 
p
);

458 
FIONREAD
:

459  
	`put_u£r
(
	`i_size_»ad
(
šode
è- 
fp
->
f_pos
, 
p
);

460 
FS_IOC_RESVSP
:

461 
FS_IOC_RESVSP64
:

462  
	`ioùl_´—Îoÿ‹
(
fp
, 
p
);

465  
	`vfs_ioùl
(
fp
, 
cmd
, 
¬g
);

466 
	}
}

468 
	$ioùl_fiÚbio
(
fe
 *
fp
, 
__u£r
 *
¬gp
)

470 
æag
;

471 
Ú
, 
”rÜ
;

473 
”rÜ
 = 
	`g‘_u£r
(
Ú
, 
¬gp
);

474 ià(
”rÜ
)

475  
”rÜ
;

476 
æag
 = 
O_NONBLOCK
;

477 #ifdeà
__¥¬c__


479 ià(
O_NONBLOCK
 !ğ
O_NDELAY
)

480 
æag
 |ğ
O_NDELAY
;

482 
	`¥š_lock
(&
fp
->
f_lock
);

483 ià(
Ú
)

484 
fp
->
f_æags
 |ğ
æag
;

486 
fp
->
f_æags
 &ğ~
æag
;

487 
	`¥š_uÆock
(&
fp
->
f_lock
);

488  
”rÜ
;

489 
	}
}

491 
	$ioùl_fißsync
(
fd
, 
fe
 *
fp
,

492 
__u£r
 *
¬gp
)

494 
æag
;

495 
Ú
, 
”rÜ
;

497 
”rÜ
 = 
	`g‘_u£r
(
Ú
, 
¬gp
);

498 ià(
”rÜ
)

499  
”rÜ
;

500 
æag
 = 
Ú
 ? 
FASYNC
 : 0;

503 ià((
æag
 ^ 
fp
->
f_æags
è& 
FASYNC
) {

504 ià(
fp
->
f_İ
 && fp->f_İ->
çsync
)

506 
”rÜ
 = 
fp
->
f_İ
->
	`çsync
(
fd
, fp, 
Ú
);

508 
”rÜ
 = -
ENOTTY
;

510  
”rÜ
 < 0 ?ƒrror : 0;

511 
	}
}

513 
	$ioùl_fsä“ze
(
fe
 *
fp
)

515 
su³r_block
 *
sb
 = 
fp
->
f_·th
.
d’Œy
->
d_šode
->
i_sb
;

517 ià(!
	`ÿ·bË
(
CAP_SYS_ADMIN
))

518  -
EPERM
;

521 ià(
sb
->
s_İ
->
ä“ze_fs
 =ğ
NULL
)

522  -
EOPNOTSUPP
;

525  
	`ä“ze_su³r
(
sb
);

526 
	}
}

528 
	$ioùl_f¡haw
(
fe
 *
fp
)

530 
su³r_block
 *
sb
 = 
fp
->
f_·th
.
d’Œy
->
d_šode
->
i_sb
;

532 ià(!
	`ÿ·bË
(
CAP_SYS_ADMIN
))

533  -
EPERM
;

536  
	`thaw_su³r
(
sb
);

537 
	}
}

546 
	$do_vfs_ioùl
(
fe
 *
fp
, 
fd
, 
cmd
,

547 
¬g
)

549 
”rÜ
 = 0;

550 
__u£r
 *
¬gp
 = (__u£¸*)
¬g
;

551 
šode
 *šodğ
fp
->
f_·th
.
d’Œy
->
d_šode
;

553 
cmd
) {

554 
FIOCLEX
:

555 
	`£t_şo£_Ú_exec
(
fd
, 1);

558 
FIONCLEX
:

559 
	`£t_şo£_Ú_exec
(
fd
, 0);

562 
FIONBIO
:

563 
”rÜ
 = 
	`ioùl_fiÚbio
(
fp
, 
¬gp
);

566 
FIOASYNC
:

567 
”rÜ
 = 
	`ioùl_fißsync
(
fd
, 
fp
, 
¬gp
);

570 
FIOQSIZE
:

571 ià(
	`S_ISDIR
(
šode
->
i_mode
è|| 
	`S_ISREG
(inode->i_mode) ||

572 
	`S_ISLNK
(
šode
->
i_mode
)) {

573 
loff_t
 
»s
 = 
	`šode_g‘_by‹s
(
šode
);

574 
”rÜ
 = 
	`cİy_to_u£r
(
¬gp
, &
»s
, (res)) ?

575 -
EFAULT
 : 0;

577 
”rÜ
 = -
ENOTTY
;

580 
FIFREEZE
:

581 
”rÜ
 = 
	`ioùl_fsä“ze
(
fp
);

584 
FITHAW
:

585 
”rÜ
 = 
	`ioùl_f¡haw
(
fp
);

588 
FS_IOC_FIEMAP
:

589  
	`ioùl_f›m­
(
fp
, 
¬g
);

591 
FIGETBSZ
:

592  
	`put_u£r
(
šode
->
i_sb
->
s_blocksize
, 
¬gp
);

595 ià(
	`S_ISREG
(
šode
->
i_mode
))

596 
”rÜ
 = 
	`fe_ioùl
(
fp
, 
cmd
, 
¬g
);

598 
”rÜ
 = 
	`vfs_ioùl
(
fp
, 
cmd
, 
¬g
);

601  
”rÜ
;

602 
	}
}

604 
	$SYSCALL_DEFINE3
(
ioùl
, , 
fd
, , 
cmd
, , 
¬g
)

606 
fe
 *
fp
;

607 
”rÜ
 = -
EBADF
;

608 
åut_Ãeded
;

610 
fp
 = 
	`fg‘_light
(
fd
, &
åut_Ãeded
);

611 ià(!
fp
)

612 
out
;

614 
”rÜ
 = 
	`£cur™y_fe_ioùl
(
fp
, 
cmd
, 
¬g
);

615 ià(
”rÜ
)

616 
out_åut
;

618 
”rÜ
 = 
	`do_vfs_ioùl
(
fp
, 
fd
, 
cmd
, 
¬g
);

619 
out_åut
:

620 
	`åut_light
(
fp
, 
åut_Ãeded
);

621 
out
:

622  
”rÜ
;

623 
	}
}

	@ioprio.c

22 
	~<lšux/gå.h
>

23 
	~<lšux/k”Ãl.h
>

24 
	~<lšux/expÜt.h
>

25 
	~<lšux/iİrio.h
>

26 
	~<lšux/blkdev.h
>

27 
	~<lšux/ÿ·b™y.h
>

28 
	~<lšux/sysÿÎs.h
>

29 
	~<lšux/£cur™y.h
>

30 
	~<lšux/pid_Çme¥aû.h
>

32 
	$£t_sk_iİrio
(
sk_¡ruù
 *
sk
, 
iİrio
)

34 
”r
;

35 
io_cÚ‹xt
 *
ioc
;

36 cÚ¡ 
üed
 *üed = 
	`cu¼’t_üed
(), *
tüed
;

38 
	`rcu_»ad_lock
();

39 
tüed
 = 
	`__sk_üed
(
sk
);

40 ià(
tüed
->
uid
 !ğ
üed
->
euid
 &&

41 
tüed
->
uid
 !ğ
üed
->uid && !
	`ÿ·bË
(
CAP_SYS_NICE
)) {

42 
	`rcu_»ad_uÆock
();

43  -
EPERM
;

45 
	`rcu_»ad_uÆock
();

47 
”r
 = 
	`£cur™y_sk_£tiİrio
(
sk
, 
iİrio
);

48 ià(
”r
)

49  
”r
;

51 
	`sk_lock
(
sk
);

53 
ioc
 = 
sk
->
io_cÚ‹xt
;

55 
	`smp_»ad_b¬r›r_d•’ds
();

56 ià(
ioc
)

59 
ioc
 = 
	`®loc_io_cÚ‹xt
(
GFP_ATOMIC
, -1);

60 ià(!
ioc
) {

61 
”r
 = -
ENOMEM
;

64 
sk
->
io_cÚ‹xt
 = 
ioc
;

67 ià(!
”r
) {

68 
ioc
->
iİrio
 = ioprio;

69 
ioc
->
iİrio_chªged
 = 1;

72 
	`sk_uÆock
(
sk
);

73  
”r
;

74 
	}
}

75 
EXPORT_SYMBOL_GPL
(
£t_sk_iİrio
);

77 
	$SYSCALL_DEFINE3
(
iİrio_£t
, , 
which
, , 
who
, , 
iİrio
)

79 
şass
 = 
	`IOPRIO_PRIO_CLASS
(
iİrio
);

80 
d©a
 = 
	`IOPRIO_PRIO_DATA
(
iİrio
);

81 
sk_¡ruù
 *
p
, *
g
;

82 
u£r_¡ruù
 *
u£r
;

83 
pid
 *
pg½
;

84 
»t
;

86 
şass
) {

87 
IOPRIO_CLASS_RT
:

88 ià(!
	`ÿ·bË
(
CAP_SYS_ADMIN
))

89  -
EPERM
;

91 
IOPRIO_CLASS_BE
:

92 ià(
d©a
 >ğ
IOPRIO_BE_NR
 || data < 0)

93  -
EINVAL
;

96 
IOPRIO_CLASS_IDLE
:

98 
IOPRIO_CLASS_NONE
:

99 ià(
d©a
)

100  -
EINVAL
;

103  -
EINVAL
;

106 
»t
 = -
ESRCH
;

107 
	`rcu_»ad_lock
();

108 
which
) {

109 
IOPRIO_WHO_PROCESS
:

110 ià(!
who
)

111 
p
 = 
cu¼’t
;

113 
p
 = 
	`fšd_sk_by_vpid
(
who
);

114 ià(
p
)

115 
»t
 = 
	`£t_sk_iİrio
(
p
, 
iİrio
);

117 
IOPRIO_WHO_PGRP
:

118 ià(!
who
)

119 
pg½
 = 
	`sk_pg½
(
cu¼’t
);

121 
pg½
 = 
	`fšd_vpid
(
who
);

122 
	`do_—ch_pid_th»ad
(
pg½
, 
PIDTYPE_PGID
, 
p
) {

123 
»t
 = 
	`£t_sk_iİrio
(
p
, 
iİrio
);

124 ià(
»t
)

126 } 
	`whe_—ch_pid_th»ad
(
pg½
, 
PIDTYPE_PGID
, 
p
);

128 
IOPRIO_WHO_USER
:

129 ià(!
who
)

130 
u£r
 = 
	`cu¼’t_u£r
();

132 
u£r
 = 
	`fšd_u£r
(
who
);

134 ià(!
u£r
)

137 
	`do_—ch_th»ad
(
g
, 
p
) {

138 ià(
	`__sk_üed
(
p
)->
uid
 !ğ
who
)

140 
»t
 = 
	`£t_sk_iİrio
(
p
, 
iİrio
);

141 ià(
»t
)

142 
ä“_uid
;

143 } 
	`whe_—ch_th»ad
(
g
, 
p
);

144 
ä“_uid
:

145 ià(
who
)

146 
	`ä“_uid
(
u£r
);

149 
»t
 = -
EINVAL
;

152 
	`rcu_»ad_uÆock
();

153  
»t
;

154 
	}
}

156 
	$g‘_sk_iİrio
(
sk_¡ruù
 *
p
)

158 
»t
;

160 
»t
 = 
	`£cur™y_sk_g‘iİrio
(
p
);

161 ià(
»t
)

162 
out
;

163 
»t
 = 
	`IOPRIO_PRIO_VALUE
(
IOPRIO_CLASS_NONE
, 
IOPRIO_NORM
);

164 ià(
p
->
io_cÚ‹xt
)

165 
»t
 = 
p
->
io_cÚ‹xt
->
iİrio
;

166 
out
:

167  
»t
;

168 
	}
}

170 
	$iİrio_be¡
(
­rio
, 
b´io
)

172 
aşass
 = 
	`IOPRIO_PRIO_CLASS
(
­rio
);

173 
bşass
 = 
	`IOPRIO_PRIO_CLASS
(
b´io
);

175 ià(
aşass
 =ğ
IOPRIO_CLASS_NONE
)

176 
aşass
 = 
IOPRIO_CLASS_BE
;

177 ià(
bşass
 =ğ
IOPRIO_CLASS_NONE
)

178 
bşass
 = 
IOPRIO_CLASS_BE
;

180 ià(
aşass
 =ğ
bşass
)

181  
	`mš
(
­rio
, 
b´io
);

182 ià(
aşass
 > 
bşass
)

183  
b´io
;

185  
­rio
;

186 
	}
}

188 
	$SYSCALL_DEFINE2
(
iİrio_g‘
, , 
which
, , 
who
)

190 
sk_¡ruù
 *
g
, *
p
;

191 
u£r_¡ruù
 *
u£r
;

192 
pid
 *
pg½
;

193 
»t
 = -
ESRCH
;

194 
tmpio
;

196 
	`rcu_»ad_lock
();

197 
which
) {

198 
IOPRIO_WHO_PROCESS
:

199 ià(!
who
)

200 
p
 = 
cu¼’t
;

202 
p
 = 
	`fšd_sk_by_vpid
(
who
);

203 ià(
p
)

204 
»t
 = 
	`g‘_sk_iİrio
(
p
);

206 
IOPRIO_WHO_PGRP
:

207 ià(!
who
)

208 
pg½
 = 
	`sk_pg½
(
cu¼’t
);

210 
pg½
 = 
	`fšd_vpid
(
who
);

211 
	`do_—ch_pid_th»ad
(
pg½
, 
PIDTYPE_PGID
, 
p
) {

212 
tmpio
 = 
	`g‘_sk_iİrio
(
p
);

213 ià(
tmpio
 < 0)

215 ià(
»t
 =ğ-
ESRCH
)

216 
»t
 = 
tmpio
;

218 
»t
 = 
	`iİrio_be¡
Ô‘, 
tmpio
);

219 } 
	`whe_—ch_pid_th»ad
(
pg½
, 
PIDTYPE_PGID
, 
p
);

221 
IOPRIO_WHO_USER
:

222 ià(!
who
)

223 
u£r
 = 
	`cu¼’t_u£r
();

225 
u£r
 = 
	`fšd_u£r
(
who
);

227 ià(!
u£r
)

230 
	`do_—ch_th»ad
(
g
, 
p
) {

231 ià(
	`__sk_üed
(
p
)->
uid
 !ğ
u£r
->uid)

233 
tmpio
 = 
	`g‘_sk_iİrio
(
p
);

234 ià(
tmpio
 < 0)

236 ià(
»t
 =ğ-
ESRCH
)

237 
»t
 = 
tmpio
;

239 
»t
 = 
	`iİrio_be¡
Ô‘, 
tmpio
);

240 } 
	`whe_—ch_th»ad
(
g
, 
p
);

242 ià(
who
)

243 
	`ä“_uid
(
u£r
);

246 
»t
 = -
EINVAL
;

249 
	`rcu_»ad_uÆock
();

250  
»t
;

251 
	}
}

	@libfs.c

6 
	~<lšux/moduË.h
>

7 
	~<lšux/·gem­.h
>

8 
	~<lšux/¦ab.h
>

9 
	~<lšux/mouÁ.h
>

10 
	~<lšux/vfs.h
>

11 
	~<lšux/quÙaİs.h
>

12 
	~<lšux/mu‹x.h
>

13 
	~<lšux/expÜtfs.h
>

14 
	~<lšux/wr™eback.h
>

15 
	~<lšux/bufãr_h—d.h
>

17 
	~<asm/uacûss.h
>

19 
	~"š‹º®.h
"

21 
šlše
 
	$sim¶e_pos™ive
(
d’Œy
 *dentry)

23  
d’Œy
->
d_šode
 && !
	`d_unhashed
(dentry);

24 
	}
}

26 
	$sim¶e_g‘©Œ
(
vfsmouÁ
 *
mÁ
, 
d’Œy
 *dentry,

27 
k¡©
 *
¡©
)

29 
šode
 *šodğ
d’Œy
->
d_šode
;

30 
	`g’”ic_fÏ‰r
(
šode
, 
¡©
);

31 
¡©
->
blocks
 = 
šode
->
i_m­pšg
->
Ä·ges
 << (
PAGE_CACHE_SHIFT
 - 9);

33 
	}
}

35 
	$sim¶e_¡©fs
(
d’Œy
 *d’Œy, 
k¡©fs
 *
buf
)

37 
buf
->
f_ty³
 = 
d’Œy
->
d_sb
->
s_magic
;

38 
buf
->
f_bsize
 = 
PAGE_CACHE_SIZE
;

39 
buf
->
f_Çm–’
 = 
NAME_MAX
;

41 
	}
}

47 
	$sim¶e_d–‘e_d’Œy
(cÚ¡ 
d’Œy
 *dentry)

50 
	}
}

56 
d’Œy
 *
	$sim¶e_lookup
(
šode
 *
dœ
, 
d’Œy
 *d’Œy, 
Çmeid©a
 *
nd
)

58 cÚ¡ 
d’Œy_İ”©iÚs
 
sim¶e_d’Œy_İ”©iÚs
 = {

59 .
d_d–‘e
 = 
sim¶e_d–‘e_d’Œy
,

62 ià(
d’Œy
->
d_Çme
.
Ën
 > 
NAME_MAX
)

63  
	`ERR_PTR
(-
ENAMETOOLONG
);

64 
	`d_£t_d_İ
(
d’Œy
, &
sim¶e_d’Œy_İ”©iÚs
);

65 
	`d_add
(
d’Œy
, 
NULL
);

66  
NULL
;

67 
	}
}

69 
	$dÿche_dœ_İ’
(
šode
 *šode, 
fe
 *file)

71 
q¡r
 
cursÜ_Çme
 = {.
Ën
 = 1, .
Çme
 = "."};

73 
fe
->
´iv©e_d©a
 = 
	`d_®loc
(fe->
f_·th
.
d’Œy
, &
cursÜ_Çme
);

75  
fe
->
´iv©e_d©a
 ? 0 : -
ENOMEM
;

76 
	}
}

78 
	$dÿche_dœ_şo£
(
šode
 *šode, 
fe
 *file)

80 
	`dput
(
fe
->
´iv©e_d©a
);

82 
	}
}

84 
loff_t
 
	$dÿche_dœ_l£ek
(
fe
 *fe, 
loff_t
 
off£t
, 
Üigš
)

86 
d’Œy
 *d’Œy = 
fe
->
f_·th
.dentry;

87 
	`mu‹x_lock
(&
d’Œy
->
d_šode
->
i_mu‹x
);

88 
Üigš
) {

90 
off£t
 +ğ
fe
->
f_pos
;

92 ià(
off£t
 >= 0)

95 
	`mu‹x_uÆock
(&
d’Œy
->
d_šode
->
i_mu‹x
);

96  -
EINVAL
;

98 ià(
off£t
 !ğ
fe
->
f_pos
) {

99 
fe
->
f_pos
 = 
off£t
;

100 ià(
fe
->
f_pos
 >= 2) {

101 
li¡_h—d
 *
p
;

102 
d’Œy
 *
cursÜ
 = 
fe
->
´iv©e_d©a
;

103 
loff_t
 
n
 = 
fe
->
f_pos
 - 2;

105 
	`¥š_lock
(&
d’Œy
->
d_lock
);

107 
	`li¡_d–
(&
cursÜ
->
d_u
.
d_chd
);

108 
p
 = 
d’Œy
->
d_subdœs
.
Ãxt
;

109 
n
 && 
p
 !ğ&
d’Œy
->
d_subdœs
) {

110 
d’Œy
 *
Ãxt
;

111 
Ãxt
 = 
	`li¡_’Œy
(
p
, 
d’Œy
, 
d_u
.
d_chd
);

112 
	`¥š_lock_Ã¡ed
(&
Ãxt
->
d_lock
, 
DENTRY_D_LOCK_NESTED
);

113 ià(
	`sim¶e_pos™ive
(
Ãxt
))

114 
n
--;

115 
	`¥š_uÆock
(&
Ãxt
->
d_lock
);

116 
p
 =…->
Ãxt
;

118 
	`li¡_add_
(&
cursÜ
->
d_u
.
d_chd
, 
p
);

119 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

122 
	`mu‹x_uÆock
(&
d’Œy
->
d_šode
->
i_mu‹x
);

123  
off£t
;

124 
	}
}

127 
šlše
 
	$dt_ty³
(
šode
 *inode)

129  (
šode
->
i_mode
 >> 12) & 15;

130 
	}
}

138 
	$dÿche_»addœ
(
fe
 * 
fp
, * 
dœ’t
, 
fldœ_t
 
fldœ
)

140 
d’Œy
 *d’Œy = 
fp
->
f_·th
.dentry;

141 
d’Œy
 *
cursÜ
 = 
fp
->
´iv©e_d©a
;

142 
li¡_h—d
 *
p
, *
q
 = &
cursÜ
->
d_u
.
d_chd
;

143 
šo_t
 
šo
;

144 
i
 = 
fp
->
f_pos
;

146 
i
) {

148 
šo
 = 
d’Œy
->
d_šode
->
i_šo
;

149 ià(
	`fldœ
(
dœ’t
, ".", 1, 
i
, 
šo
, 
DT_DIR
) < 0)

151 
fp
->
f_pos
++;

152 
i
++;

155 
šo
 = 
	`·»Á_šo
(
d’Œy
);

156 ià(
	`fldœ
(
dœ’t
, "..", 2, 
i
, 
šo
, 
DT_DIR
) < 0)

158 
fp
->
f_pos
++;

159 
i
++;

162 
	`¥š_lock
(&
d’Œy
->
d_lock
);

163 ià(
fp
->
f_pos
 == 2)

164 
	`li¡_move
(
q
, &
d’Œy
->
d_subdœs
);

166 
p
=
q
->
Ãxt
;… !ğ&
d’Œy
->
d_subdœs
;…=p->next) {

167 
d’Œy
 *
Ãxt
;

168 
Ãxt
 = 
	`li¡_’Œy
(
p
, 
d’Œy
, 
d_u
.
d_chd
);

169 
	`¥š_lock_Ã¡ed
(&
Ãxt
->
d_lock
, 
DENTRY_D_LOCK_NESTED
);

170 ià(!
	`sim¶e_pos™ive
(
Ãxt
)) {

171 
	`¥š_uÆock
(&
Ãxt
->
d_lock
);

175 
	`¥š_uÆock
(&
Ãxt
->
d_lock
);

176 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

177 ià(
	`fldœ
(
dœ’t
, 
Ãxt
->
d_Çme
.
Çme
,

178 
Ãxt
->
d_Çme
.
Ën
, 
fp
->
f_pos
,

179 
Ãxt
->
d_šode
->
i_šo
,

180 
	`dt_ty³
(
Ãxt
->
d_šode
)) < 0)

182 
	`¥š_lock
(&
d’Œy
->
d_lock
);

183 
	`¥š_lock_Ã¡ed
(&
Ãxt
->
d_lock
, 
DENTRY_D_LOCK_NESTED
);

185 
	`li¡_move
(
q
, 
p
);

186 
	`¥š_uÆock
(&
Ãxt
->
d_lock
);

187 
p
 = 
q
;

188 
fp
->
f_pos
++;

190 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

193 
	}
}

195 
ssize_t
 
	$g’”ic_»ad_dœ
(
fe
 *
fp
, 
__u£r
 *
buf
, 
size_t
 
siz
, 
loff_t
 *
µos
)

197  -
EISDIR
;

198 
	}
}

200 cÚ¡ 
fe_İ”©iÚs
 
	gsim¶e_dœ_İ”©iÚs
 = {

201 .
İ’
 = 
dÿche_dœ_İ’
,

202 .
	g»Ëa£
 = 
dÿche_dœ_şo£
,

203 .
	gÎ£ek
 = 
dÿche_dœ_l£ek
,

204 .
	g»ad
 = 
g’”ic_»ad_dœ
,

205 .
	g»addœ
 = 
dÿche_»addœ
,

206 .
	gfsync
 = 
noİ_fsync
,

209 cÚ¡ 
šode_İ”©iÚs
 
	gsim¶e_dœ_šode_İ”©iÚs
 = {

210 .
lookup
 = 
sim¶e_lookup
,

213 cÚ¡ 
su³r_İ”©iÚs
 
	gsim¶e_su³r_İ”©iÚs
 = {

214 .
¡©fs
 = 
sim¶e_¡©fs
,

221 
d’Œy
 *
	$mouÁ_p£udo
(
fe_sy¡em_ty³
 *
fs_ty³
, *
Çme
,

222 cÚ¡ 
su³r_İ”©iÚs
 *
İs
,

223 cÚ¡ 
d’Œy_İ”©iÚs
 *
dİs
, 
magic
)

225 
su³r_block
 *
s
 = 
	`sg‘
(
fs_ty³
, 
NULL
, 
£t_ªÚ_su³r
, NULL);

226 
d’Œy
 *dentry;

227 
šode
 *
roÙ
;

228 
q¡r
 
d_Çme
 = {.
Çme
 =‚ame, .
Ën
 = 
	`¡¾’
(name)};

230 ià(
	`IS_ERR
(
s
))

231  
	`ERR_CAST
(
s
);

233 
s
->
s_æags
 = 
MS_NOUSER
;

234 
s
->
s_maxby‹s
 = 
MAX_LFS_FILESIZE
;

235 
s
->
s_blocksize
 = 
PAGE_SIZE
;

236 
s
->
s_blocksize_b™s
 = 
PAGE_SHIFT
;

237 
s
->
s_magic
 = 
magic
;

238 
s
->
s_İ
 = 
İs
 ? op : &
sim¶e_su³r_İ”©iÚs
;

239 
s
->
s_time_g¿n
 = 1;

240 
roÙ
 = 
	`Ãw_šode
(
s
);

241 ià(!
roÙ
)

242 
Enomem
;

248 
roÙ
->
i_šo
 = 1;

249 
roÙ
->
i_mode
 = 
S_IFDIR
 | 
S_IRUSR
 | 
S_IWUSR
;

250 
roÙ
->
i_©ime
 =„oÙ->
i_mtime
 =„oÙ->
i_ùime
 = 
CURRENT_TIME
;

251 
d’Œy
 = 
	`__d_®loc
(
s
, &
d_Çme
);

252 ià(!
d’Œy
) {

253 
	`ut
(
roÙ
);

254 
Enomem
;

256 
	`d_š¡ªtŸ‹
(
d’Œy
, 
roÙ
);

257 
s
->
s_roÙ
 = 
d’Œy
;

258 
s
->
s_d_İ
 = 
dİs
;

259 
s
->
s_æags
 |ğ
MS_ACTIVE
;

260  
	`dg‘
(
s
->
s_roÙ
);

262 
Enomem
:

263 
	`d—ùiv©e_locked_su³r
(
s
);

264  
	`ERR_PTR
(-
ENOMEM
);

265 
	}
}

267 
	$sim¶e_lšk
(
d’Œy
 *
Şd_d’Œy
, 
šode
 *
dœ
, dentry *dentry)

269 
šode
 *šodğ
Şd_d’Œy
->
d_šode
;

271 
šode
->
i_ùime
 = 
dœ
->i_ùimğdœ->
i_mtime
 = 
CURRENT_TIME
;

272 
	`šc_Æšk
(
šode
);

273 
	`ihŞd
(
šode
);

274 
	`dg‘
(
d’Œy
);

275 
	`d_š¡ªtŸ‹
(
d’Œy
, 
šode
);

277 
	}
}

279 
	$sim¶e_em±y
(
d’Œy
 *dentry)

281 
d’Œy
 *
chd
;

282 
»t
 = 0;

284 
	`¥š_lock
(&
d’Œy
->
d_lock
);

285 
	`li¡_fÜ_—ch_’Œy
(
chd
, &
d’Œy
->
d_subdœs
, 
d_u
.
d_chd
) {

286 
	`¥š_lock_Ã¡ed
(&
chd
->
d_lock
, 
DENTRY_D_LOCK_NESTED
);

287 ià(
	`sim¶e_pos™ive
(
chd
)) {

288 
	`¥š_uÆock
(&
chd
->
d_lock
);

289 
out
;

291 
	`¥š_uÆock
(&
chd
->
d_lock
);

293 
»t
 = 1;

294 
out
:

295 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

296  
»t
;

297 
	}
}

299 
	$sim¶e_uÆšk
(
šode
 *
dœ
, 
d’Œy
 *dentry)

301 
šode
 *šodğ
d’Œy
->
d_šode
;

303 
šode
->
i_ùime
 = 
dœ
->i_ùimğdœ->
i_mtime
 = 
CURRENT_TIME
;

304 
	`drİ_Æšk
(
šode
);

305 
	`dput
(
d’Œy
);

307 
	}
}

309 
	$sim¶e_rmdœ
(
šode
 *
dœ
, 
d’Œy
 *dentry)

311 ià(!
	`sim¶e_em±y
(
d’Œy
))

312  -
ENOTEMPTY
;

314 
	`drİ_Æšk
(
d’Œy
->
d_šode
);

315 
	`sim¶e_uÆšk
(
dœ
, 
d’Œy
);

316 
	`drİ_Æšk
(
dœ
);

318 
	}
}

320 
	$sim¶e_»Çme
(
šode
 *
Şd_dœ
, 
d’Œy
 *
Şd_d’Œy
,

321 
šode
 *
Ãw_dœ
, 
d’Œy
 *
Ãw_d’Œy
)

323 
šode
 *šodğ
Şd_d’Œy
->
d_šode
;

324 
they_¬e_dœs
 = 
	`S_ISDIR
(
Şd_d’Œy
->
d_šode
->
i_mode
);

326 ià(!
	`sim¶e_em±y
(
Ãw_d’Œy
))

327  -
ENOTEMPTY
;

329 ià(
Ãw_d’Œy
->
d_šode
) {

330 
	`sim¶e_uÆšk
(
Ãw_dœ
, 
Ãw_d’Œy
);

331 ià(
they_¬e_dœs
) {

332 
	`drİ_Æšk
(
Ãw_d’Œy
->
d_šode
);

333 
	`drİ_Æšk
(
Şd_dœ
);

335 } ià(
they_¬e_dœs
) {

336 
	`drİ_Æšk
(
Şd_dœ
);

337 
	`šc_Æšk
(
Ãw_dœ
);

340 
Şd_dœ
->
i_ùime
 = old_dœ->
i_mtime
 = 
Ãw_dœ
->i_ctime =

341 
Ãw_dœ
->
i_mtime
 = 
šode
->
i_ùime
 = 
CURRENT_TIME
;

344 
	}
}

360 
	$sim¶e_£‰r
(
d’Œy
 *d’Œy, 
Ÿ‰r
 *iattr)

362 
šode
 *šodğ
d’Œy
->
d_šode
;

363 
”rÜ
;

365 
	`WARN_ON_ONCE
(
šode
->
i_İ
->
Œunÿ‹
);

367 
”rÜ
 = 
	`šode_chªge_ok
(
šode
, 
Ÿ‰r
);

368 ià(
”rÜ
)

369  
”rÜ
;

371 ià(
Ÿ‰r
->
Ÿ_v®id
 & 
ATTR_SIZE
)

372 
	`Œunÿ‹_£tsize
(
šode
, 
Ÿ‰r
->
Ÿ_size
);

373 
	`£‰r_cİy
(
šode
, 
Ÿ‰r
);

374 
	`m¬k_šode_dœty
(
šode
);

376 
	}
}

377 
EXPORT_SYMBOL
(
sim¶e_£‰r
);

379 
	$sim¶e_»ad·ge
(
fe
 *fe, 
·ge
 *page)

381 
	`ş—r_high·ge
(
·ge
);

382 
	`æush_dÿche_·ge
(
·ge
);

383 
	`S‘PageU±od©e
(
·ge
);

384 
	`uÆock_·ge
(
·ge
);

386 
	}
}

388 
	$sim¶e_wr™e_begš
(
fe
 *fe, 
add»ss_¥aû
 *
m­pšg
,

389 
loff_t
 
pos
, 
Ën
, 
æags
,

390 
·ge
 **
·g•
, **
fsd©a
)

392 
·ge
 *page;

393 
pgoff_t
 
šdex
;

395 
šdex
 = 
pos
 >> 
PAGE_CACHE_SHIFT
;

397 
·ge
 = 
	`g¿b_ÿche_·ge_wr™e_begš
(
m­pšg
, 
šdex
, 
æags
);

398 ià(!
·ge
)

399  -
ENOMEM
;

401 *
·g•
 = 
·ge
;

403 ià(!
	`PageU±od©e
(
·ge
è&& (
Ën
 !ğ
PAGE_CACHE_SIZE
)) {

404 
äom
 = 
pos
 & (
PAGE_CACHE_SIZE
 - 1);

406 
	`z”o_u£r_£gm’ts
(
·ge
, 0, 
äom
, from + 
Ën
, 
PAGE_CACHE_SIZE
);

409 
	}
}

432 
	$sim¶e_wr™e_’d
(
fe
 *fe, 
add»ss_¥aû
 *
m­pšg
,

433 
loff_t
 
pos
, 
Ën
, 
cİ›d
,

434 
·ge
 *·ge, *
fsd©a
)

436 
šode
 *šodğ
·ge
->
m­pšg
->
ho¡
;

437 
loff_t
 
Ï¡_pos
 = 
pos
 + 
cİ›d
;

440 ià(
cİ›d
 < 
Ën
) {

441 
äom
 = 
pos
 & (
PAGE_CACHE_SIZE
 - 1);

443 
	`z”o_u£r
(
·ge
, 
äom
 + 
cİ›d
, 
Ën
 - copied);

446 ià(!
	`PageU±od©e
(
·ge
))

447 
	`S‘PageU±od©e
(
·ge
);

452 ià(
Ï¡_pos
 > 
šode
->
i_size
)

453 
	`i_size_wr™e
(
šode
, 
Ï¡_pos
);

455 
	`£t_·ge_dœty
(
·ge
);

456 
	`uÆock_·ge
(
·ge
);

457 
	`·ge_ÿche_»Ëa£
(
·ge
);

459  
cİ›d
;

460 
	}
}

467 
	$sim¶e_fl_su³r
(
su³r_block
 *
s
, 
magic
,

468 
Œ“_desü
 *
fes
)

470 
šode
 *inode;

471 
d’Œy
 *
roÙ
;

472 
d’Œy
 *dentry;

473 
i
;

475 
s
->
s_blocksize
 = 
PAGE_CACHE_SIZE
;

476 
s
->
s_blocksize_b™s
 = 
PAGE_CACHE_SHIFT
;

477 
s
->
s_magic
 = 
magic
;

478 
s
->
s_İ
 = &
sim¶e_su³r_İ”©iÚs
;

479 
s
->
s_time_g¿n
 = 1;

481 
šode
 = 
	`Ãw_šode
(
s
);

482 ià(!
šode
)

483  -
ENOMEM
;

488 
šode
->
i_šo
 = 1;

489 
šode
->
i_mode
 = 
S_IFDIR
 | 0755;

490 
šode
->
i_©ime
 = inode->
i_mtime
 = inode->
i_ùime
 = 
CURRENT_TIME
;

491 
šode
->
i_İ
 = &
sim¶e_dœ_šode_İ”©iÚs
;

492 
šode
->
i_fİ
 = &
sim¶e_dœ_İ”©iÚs
;

493 
	`£t_Æšk
(
šode
, 2);

494 
roÙ
 = 
	`d_®loc_roÙ
(
šode
);

495 ià(!
roÙ
) {

496 
	`ut
(
šode
);

497  -
ENOMEM
;

499 
i
 = 0; !
fes
->
Çme
 || files->name[0]; i++, files++) {

500 ià(!
fes
->
Çme
)

504 ià(
	`uÆik–y
(
i
 == 1))

505 
	`´štk
(
KERN_WARNING
 "%s: %s…assed in‡ files‡rray"

506 "w™h‡Àšdex oà1!\n", 
__func__
,

507 
s
->
s_ty³
->
Çme
);

509 
d’Œy
 = 
	`d_®loc_Çme
(
roÙ
, 
fes
->
Çme
);

510 ià(!
d’Œy
)

511 
out
;

512 
šode
 = 
	`Ãw_šode
(
s
);

513 ià(!
šode
) {

514 
	`dput
(
d’Œy
);

515 
out
;

517 
šode
->
i_mode
 = 
S_IFREG
 | 
fes
->
mode
;

518 
šode
->
i_©ime
 = inode->
i_mtime
 = inode->
i_ùime
 = 
CURRENT_TIME
;

519 
šode
->
i_fİ
 = 
fes
->
İs
;

520 
šode
->
i_šo
 = 
i
;

521 
	`d_add
(
d’Œy
, 
šode
);

523 
s
->
s_roÙ
 = 
roÙ
;

525 
out
:

526 
	`d_g’ocide
(
roÙ
);

527 
	`dput
(
roÙ
);

528  -
ENOMEM
;

529 
	}
}

531 
DEFINE_SPINLOCK
(
pš_fs_lock
);

533 
	$sim¶e_pš_fs
(
fe_sy¡em_ty³
 *
ty³
, 
vfsmouÁ
 **
mouÁ
, *
couÁ
)

535 
vfsmouÁ
 *
mÁ
 = 
NULL
;

536 
	`¥š_lock
(&
pš_fs_lock
);

537 ià(
	`uÆik–y
(!*
mouÁ
)) {

538 
	`¥š_uÆock
(&
pš_fs_lock
);

539 
mÁ
 = 
	`vfs_k”n_mouÁ
(
ty³
, 0,y³->
Çme
, 
NULL
);

540 ià(
	`IS_ERR
(
mÁ
))

541  
	`PTR_ERR
(
mÁ
);

542 
	`¥š_lock
(&
pš_fs_lock
);

543 ià(!*
mouÁ
)

544 *
mouÁ
 = 
mÁ
;

546 
	`mÁg‘
(*
mouÁ
);

547 ++*
couÁ
;

548 
	`¥š_uÆock
(&
pš_fs_lock
);

549 
	`mÁput
(
mÁ
);

551 
	}
}

553 
	$sim¶e_»Ëa£_fs
(
vfsmouÁ
 **
mouÁ
, *
couÁ
)

555 
vfsmouÁ
 *
mÁ
;

556 
	`¥š_lock
(&
pš_fs_lock
);

557 
mÁ
 = *
mouÁ
;

558 ià(!--*
couÁ
)

559 *
mouÁ
 = 
NULL
;

560 
	`¥š_uÆock
(&
pš_fs_lock
);

561 
	`mÁput
(
mÁ
);

562 
	}
}

578 
ssize_t
 
	$sim¶e_»ad_äom_bufãr
(
__u£r
 *
to
, 
size_t
 
couÁ
, 
loff_t
 *
µos
,

579 cÚ¡ *
äom
, 
size_t
 
avaabË
)

581 
loff_t
 
pos
 = *
µos
;

582 
size_t
 
»t
;

584 ià(
pos
 < 0)

585  -
EINVAL
;

586 ià(
pos
 >ğ
avaabË
 || !
couÁ
)

588 ià(
couÁ
 > 
avaabË
 - 
pos
)

589 
couÁ
 = 
avaabË
 - 
pos
;

590 
»t
 = 
	`cİy_to_u£r
(
to
, 
äom
 + 
pos
, 
couÁ
);

591 ià(
»t
 =ğ
couÁ
)

592  -
EFAULT
;

593 
couÁ
 -ğ
»t
;

594 *
µos
 = 
pos
 + 
couÁ
;

595  
couÁ
;

596 
	}
}

612 
ssize_t
 
	$sim¶e_wr™e_to_bufãr
(*
to
, 
size_t
 
avaabË
, 
loff_t
 *
µos
,

613 cÚ¡ 
__u£r
 *
äom
, 
size_t
 
couÁ
)

615 
loff_t
 
pos
 = *
µos
;

616 
size_t
 
»s
;

618 ià(
pos
 < 0)

619  -
EINVAL
;

620 ià(
pos
 >ğ
avaabË
 || !
couÁ
)

622 ià(
couÁ
 > 
avaabË
 - 
pos
)

623 
couÁ
 = 
avaabË
 - 
pos
;

624 
»s
 = 
	`cİy_äom_u£r
(
to
 + 
pos
, 
äom
, 
couÁ
);

625 ià(
»s
 =ğ
couÁ
)

626  -
EFAULT
;

627 
couÁ
 -ğ
»s
;

628 *
µos
 = 
pos
 + 
couÁ
;

629  
couÁ
;

630 
	}
}

646 
ssize_t
 
	$memÜy_»ad_äom_bufãr
(*
to
, 
size_t
 
couÁ
, 
loff_t
 *
µos
,

647 cÚ¡ *
äom
, 
size_t
 
avaabË
)

649 
loff_t
 
pos
 = *
µos
;

651 ià(
pos
 < 0)

652  -
EINVAL
;

653 ià(
pos
 >ğ
avaabË
)

655 ià(
couÁ
 > 
avaabË
 - 
pos
)

656 
couÁ
 = 
avaabË
 - 
pos
;

657 
	`memıy
(
to
, 
äom
 + 
pos
, 
couÁ
);

658 *
µos
 = 
pos
 + 
couÁ
;

660  
couÁ
;

661 
	}
}

670 
	$sim¶e_Œª§ùiÚ_£t
(
fe
 *fe, 
size_t
 
n
)

672 
sim¶e_Œª§ùiÚ_¬g»¥
 *
¬
 = 
fe
->
´iv©e_d©a
;

674 
	`BUG_ON
(
n
 > 
SIMPLE_TRANSACTION_LIMIT
);

680 
	`smp_mb
();

681 
¬
->
size
 = 
n
;

682 
	}
}

684 *
	$sim¶e_Œª§ùiÚ_g‘
(
fe
 *fe, cÚ¡ 
__u£r
 *
buf
, 
size_t
 
size
)

686 
sim¶e_Œª§ùiÚ_¬g»¥
 *
¬
;

687 
	`DEFINE_SPINLOCK
(
sim¶e_Œª§ùiÚ_lock
);

689 ià(
size
 > 
SIMPLE_TRANSACTION_LIMIT
 - 1)

690  
	`ERR_PTR
(-
EFBIG
);

692 
¬
 = (
sim¶e_Œª§ùiÚ_¬g»¥
 *)
	`g‘_z”Ûd_·ge
(
GFP_KERNEL
);

693 ià(!
¬
)

694  
	`ERR_PTR
(-
ENOMEM
);

696 
	`¥š_lock
(&
sim¶e_Œª§ùiÚ_lock
);

699 ià(
fe
->
´iv©e_d©a
) {

700 
	`¥š_uÆock
(&
sim¶e_Œª§ùiÚ_lock
);

701 
	`ä“_·ge
(()
¬
);

702  
	`ERR_PTR
(-
EBUSY
);

705 
fe
->
´iv©e_d©a
 = 
¬
;

707 
	`¥š_uÆock
(&
sim¶e_Œª§ùiÚ_lock
);

709 ià(
	`cİy_äom_u£r
(
¬
->
d©a
, 
buf
, 
size
))

710  
	`ERR_PTR
(-
EFAULT
);

712  
¬
->
d©a
;

713 
	}
}

715 
ssize_t
 
	$sim¶e_Œª§ùiÚ_»ad
(
fe
 *fe, 
__u£r
 *
buf
, 
size_t
 
size
, 
loff_t
 *
pos
)

717 
sim¶e_Œª§ùiÚ_¬g»¥
 *
¬
 = 
fe
->
´iv©e_d©a
;

719 ià(!
¬
)

721  
	`sim¶e_»ad_äom_bufãr
(
buf
, 
size
, 
pos
, 
¬
->
d©a
,‡r->size);

722 
	}
}

724 
	$sim¶e_Œª§ùiÚ_»Ëa£
(
šode
 *šode, 
fe
 *file)

726 
	`ä“_·ge
(()
fe
->
´iv©e_d©a
);

728 
	}
}

732 
	ssim¶e_©Œ
 {

733 (*
	mg‘
)(*, 
	mu64
 *);

734 (*
	m£t
)(*, 
	mu64
);

735 
	mg‘_buf
[24];

736 
	m£t_buf
[24];

737 *
	md©a
;

738 cÚ¡ *
	mfmt
;

739 
mu‹x
 
	mmu‹x
;

744 
sim¶e_©Œ_İ’
(
šode
 *šode, 
fe
 *file,

745 (*
g‘
)(*, 
u64
 *), (*
£t
)(*, u64),

746 cÚ¡ *
fmt
)

748 
sim¶e_©Œ
 *
©Œ
;

750 
©Œ
 = 
	`km®loc
((*©Œ), 
GFP_KERNEL
);

751 ià(!
©Œ
)

752  -
ENOMEM
;

754 
©Œ
->
g‘
 = get;

755 
©Œ
->
£t
 = set;

756 
©Œ
->
d©a
 = 
šode
->
i_´iv©e
;

757 
©Œ
->
fmt
 = fmt;

758 
	`mu‹x_š™
(&
©Œ
->
mu‹x
);

760 
fe
->
´iv©e_d©a
 = 
©Œ
;

762  
	`nÚ£ekabË_İ’
(
šode
, 
fe
);

763 
	}
}

765 
	$sim¶e_©Œ_»Ëa£
(
šode
 *šode, 
fe
 *file)

767 
	`kä“
(
fe
->
´iv©e_d©a
);

769 
	}
}

772 
ssize_t
 
	$sim¶e_©Œ_»ad
(
fe
 *fe, 
__u£r
 *
buf
,

773 
size_t
 
Ën
, 
loff_t
 *
µos
)

775 
sim¶e_©Œ
 *
©Œ
;

776 
size_t
 
size
;

777 
ssize_t
 
»t
;

779 
©Œ
 = 
fe
->
´iv©e_d©a
;

781 ià(!
©Œ
->
g‘
)

782  -
EACCES
;

784 
»t
 = 
	`mu‹x_lock_š‹¼u±ibË
(&
©Œ
->
mu‹x
);

785 ià(
»t
)

786  
»t
;

788 ià(*
µos
) {

789 
size
 = 
	`¡¾’
(
©Œ
->
g‘_buf
);

791 
u64
 
v®
;

792 
»t
 = 
©Œ
->
	`g‘
×‰r->
d©a
, &
v®
);

793 ià(
»t
)

794 
out
;

796 
size
 = 
	`sú´štf
(
©Œ
->
g‘_buf
, (attr->get_buf),

797 
©Œ
->
fmt
, ()
v®
);

800 
»t
 = 
	`sim¶e_»ad_äom_bufãr
(
buf
, 
Ën
, 
µos
, 
©Œ
->
g‘_buf
, 
size
);

801 
out
:

802 
	`mu‹x_uÆock
(&
©Œ
->
mu‹x
);

803  
»t
;

804 
	}
}

807 
ssize_t
 
	$sim¶e_©Œ_wr™e
(
fe
 *fe, cÚ¡ 
__u£r
 *
buf
,

808 
size_t
 
Ën
, 
loff_t
 *
µos
)

810 
sim¶e_©Œ
 *
©Œ
;

811 
u64
 
v®
;

812 
size_t
 
size
;

813 
ssize_t
 
»t
;

815 
©Œ
 = 
fe
->
´iv©e_d©a
;

816 ià(!
©Œ
->
£t
)

817  -
EACCES
;

819 
»t
 = 
	`mu‹x_lock_š‹¼u±ibË
(&
©Œ
->
mu‹x
);

820 ià(
»t
)

821  
»t
;

823 
»t
 = -
EFAULT
;

824 
size
 = 
	`mš
((
©Œ
->
£t_buf
è- 1, 
Ën
);

825 ià(
	`cİy_äom_u£r
(
©Œ
->
£t_buf
, 
buf
, 
size
))

826 
out
;

828 
©Œ
->
£t_buf
[
size
] = '\0';

829 
v®
 = 
	`sim¶e_¡¹Şl
(
©Œ
->
£t_buf
, 
NULL
, 0);

830 
»t
 = 
©Œ
->
	`£t
×‰r->
d©a
, 
v®
);

831 ià(
»t
 == 0)

832 
»t
 = 
Ën
;

833 
out
:

834 
	`mu‹x_uÆock
(&
©Œ
->
mu‹x
);

835  
»t
;

836 
	}
}

850 
d’Œy
 *
g’”ic_fh_to_d’Œy
(
su³r_block
 *
sb
, 
fid
 *fid,

851 
fh_Ën
, 
fh_ty³
, 
šode
 *(*
g‘_šode
)

852 (
su³r_block
 *
sb
, 
u64
 
šo
, 
u32
 
g’
))

854 
šode
 *
	gšode
 = 
NULL
;

856 ià(
	gfh_Ën
 < 2)

857  
	gNULL
;

859 
	gfh_ty³
) {

860 
	gFILEID_INO32_GEN
:

861 
FILEID_INO32_GEN_PARENT
:

862 
šode
 = 
g‘_šode
(
sb
, 
fid
->
i32
.
šo
, fid->i32.
g’
);

866  
d_obš_®Ÿs
(
šode
);

868 
EXPORT_SYMBOL_GPL
(
g’”ic_fh_to_d’Œy
);

883 
d’Œy
 *
g’”ic_fh_to_·»Á
(
su³r_block
 *
sb
, 
fid
 *fid,

884 
fh_Ën
, 
fh_ty³
, 
šode
 *(*
g‘_šode
)

885 (
su³r_block
 *
sb
, 
u64
 
šo
, 
u32
 
g’
))

887 
šode
 *
	gšode
 = 
NULL
;

889 ià(
	gfh_Ën
 <= 2)

890  
NULL
;

892 
	gfh_ty³
) {

893 
	gFILEID_INO32_GEN_PARENT
:

894 
šode
 = 
g‘_šode
(
sb
, 
fid
->
i32
.
·»Á_šo
,

895 (
fh_Ën
 > 3 ? 
fid
->
i32
.
·»Á_g’
 : 0));

899  
d_obš_®Ÿs
(
šode
);

901 
EXPORT_SYMBOL_GPL
(
g’”ic_fh_to_·»Á
);

912 
	$g’”ic_fe_fsync
(
fe
 *fe, 
loff_t
 
¡¬t
,†off_ˆ
’d
,

913 
d©async
)

915 
šode
 *šodğ
fe
->
f_m­pšg
->
ho¡
;

916 
”r
;

917 
»t
;

919 
”r
 = 
	`fem­_wr™e_ªd_wa™_¿nge
(
šode
->
i_m­pšg
, 
¡¬t
, 
’d
);

920 ià(
”r
)

921  
”r
;

923 
	`mu‹x_lock
(&
šode
->
i_mu‹x
);

924 
»t
 = 
	`sync_m­pšg_bufãrs
(
šode
->
i_m­pšg
);

925 ià(!(
šode
->
i_¡©e
 & 
I_DIRTY
))

926 
out
;

927 ià(
d©async
 && !(
šode
->
i_¡©e
 & 
I_DIRTY_DATASYNC
))

928 
out
;

930 
”r
 = 
	`sync_šode_m‘ad©a
(
šode
, 1);

931 ià(
»t
 == 0)

932 
»t
 = 
”r
;

933 
out
:

934 
	`mu‹x_uÆock
(&
šode
->
i_mu‹x
);

935  
»t
;

936 
	}
}

937 
EXPORT_SYMBOL
(
g’”ic_fe_fsync
);

948 
	$g’”ic_check_add»s§bË
(
blocksize_b™s
, 
u64
 
num_blocks
)

950 
u64
 
Ï¡_fs_block
 = 
num_blocks
 - 1;

951 
u64
 
Ï¡_fs_·ge
 =

952 
Ï¡_fs_block
 >> (
PAGE_CACHE_SHIFT
 - 
blocksize_b™s
);

954 ià(
	`uÆik–y
(
num_blocks
 == 0))

957 ià((
blocksize_b™s
 < 9è|| (blocksize_b™ > 
PAGE_CACHE_SHIFT
))

958  -
EINVAL
;

960 ià((
Ï¡_fs_block
 > (
£ùÜ_t
)(~0ULLè>> (
blocksize_b™s
 - 9)) ||

961 (
Ï¡_fs_·ge
 > (
pgoff_t
)(~0ULL))) {

962  -
EFBIG
;

965 
	}
}

966 
EXPORT_SYMBOL
(
g’”ic_check_add»s§bË
);

971 
	$noİ_fsync
(
fe
 *fe, 
loff_t
 
¡¬t
,†off_ˆ
’d
, 
d©async
)

974 
	}
}

976 
EXPORT_SYMBOL
(
dÿche_dœ_şo£
);

977 
EXPORT_SYMBOL
(
dÿche_dœ_l£ek
);

978 
EXPORT_SYMBOL
(
dÿche_dœ_İ’
);

979 
EXPORT_SYMBOL
(
dÿche_»addœ
);

980 
EXPORT_SYMBOL
(
g’”ic_»ad_dœ
);

981 
EXPORT_SYMBOL
(
mouÁ_p£udo
);

982 
EXPORT_SYMBOL
(
sim¶e_wr™e_begš
);

983 
EXPORT_SYMBOL
(
sim¶e_wr™e_’d
);

984 
EXPORT_SYMBOL
(
sim¶e_dœ_šode_İ”©iÚs
);

985 
EXPORT_SYMBOL
(
sim¶e_dœ_İ”©iÚs
);

986 
EXPORT_SYMBOL
(
sim¶e_em±y
);

987 
EXPORT_SYMBOL
(
sim¶e_fl_su³r
);

988 
EXPORT_SYMBOL
(
sim¶e_g‘©Œ
);

989 
EXPORT_SYMBOL
(
sim¶e_lšk
);

990 
EXPORT_SYMBOL
(
sim¶e_lookup
);

991 
EXPORT_SYMBOL
(
sim¶e_pš_fs
);

992 
EXPORT_SYMBOL
(
sim¶e_»ad·ge
);

993 
EXPORT_SYMBOL
(
sim¶e_»Ëa£_fs
);

994 
EXPORT_SYMBOL
(
sim¶e_»Çme
);

995 
EXPORT_SYMBOL
(
sim¶e_rmdœ
);

996 
EXPORT_SYMBOL
(
sim¶e_¡©fs
);

997 
EXPORT_SYMBOL
(
noİ_fsync
);

998 
EXPORT_SYMBOL
(
sim¶e_uÆšk
);

999 
EXPORT_SYMBOL
(
sim¶e_»ad_äom_bufãr
);

1000 
EXPORT_SYMBOL
(
sim¶e_wr™e_to_bufãr
);

1001 
EXPORT_SYMBOL
(
memÜy_»ad_äom_bufãr
);

1002 
EXPORT_SYMBOL
(
sim¶e_Œª§ùiÚ_£t
);

1003 
EXPORT_SYMBOL
(
sim¶e_Œª§ùiÚ_g‘
);

1004 
EXPORT_SYMBOL
(
sim¶e_Œª§ùiÚ_»ad
);

1005 
EXPORT_SYMBOL
(
sim¶e_Œª§ùiÚ_»Ëa£
);

1006 
EXPORT_SYMBOL_GPL
(
sim¶e_©Œ_İ’
);

1007 
EXPORT_SYMBOL_GPL
(
sim¶e_©Œ_»Ëa£
);

1008 
EXPORT_SYMBOL_GPL
(
sim¶e_©Œ_»ad
);

1009 
EXPORT_SYMBOL_GPL
(
sim¶e_©Œ_wr™e
);

	@locks.c

117 
	~<lšux/ÿ·b™y.h
>

118 
	~<lšux/fe.h
>

119 
	~<lšux/fdbË.h
>

120 
	~<lšux/fs.h
>

121 
	~<lšux/š™.h
>

122 
	~<lšux/moduË.h
>

123 
	~<lšux/£cur™y.h
>

124 
	~<lšux/¦ab.h
>

125 
	~<lšux/sysÿÎs.h
>

126 
	~<lšux/time.h
>

127 
	~<lšux/rcupd©e.h
>

128 
	~<lšux/pid_Çme¥aû.h
>

130 
	~<asm/uacûss.h
>

132 
	#IS_POSIX
(
æ
è(æ->
æ_æags
 & 
FL_POSIX
)

	)

133 
	#IS_FLOCK
(
æ
è(æ->
æ_æags
 & 
FL_FLOCK
)

	)

134 
	#IS_LEASE
(
æ
è(æ->
æ_æags
 & 
FL_LEASE
)

	)

136 
boŞ
 
	$Ëa£_b»akšg
(
fe_lock
 *
æ
)

138  
æ
->
æ_æags
 & (
FL_UNLOCK_PENDING
 | 
FL_DOWNGRADE_PENDING
);

139 
	}
}

141 
	$rg‘_Ëa£ty³
(
fe_lock
 *
æ
)

143 ià(
æ
->
æ_æags
 & 
FL_UNLOCK_PENDING
)

144  
F_UNLCK
;

145 ià(
æ
->
æ_æags
 & 
FL_DOWNGRADE_PENDING
)

146  
F_RDLCK
;

147  
æ
->
æ_ty³
;

148 
	}
}

150 
	gËa£s_’abË
 = 1;

151 
	gËa£_b»ak_time
 = 45;

153 
	#fÜ_—ch_lock
(
šode
, 
lockp
) \

154 
lockp
 = &
šode
->
i_æock
; *lock°!ğ
NULL
;†ock°ğ&(*lockp)->
æ_Ãxt
)

	)

156 
LIST_HEAD
(
fe_lock_li¡
);

157 
LIST_HEAD
(
blocked_li¡
);

158 
DEFINE_SPINLOCK
(
fe_lock_lock
);

163 
	$lock_æocks
()

165 
	`¥š_lock
(&
fe_lock_lock
);

166 
	}
}

167 
EXPORT_SYMBOL_GPL
(
lock_æocks
);

169 
	$uÆock_æocks
()

171 
	`¥š_uÆock
(&
fe_lock_lock
);

172 
	}
}

173 
EXPORT_SYMBOL_GPL
(
uÆock_æocks
);

175 
kmem_ÿche
 *
f–ock_ÿche
 
	g__»ad_mo¡ly
;

177 
	$locks_š™_lock_h—ds
(
fe_lock
 *
æ
)

179 
	`INIT_LIST_HEAD
(&
æ
->
æ_lšk
);

180 
	`INIT_LIST_HEAD
(&
æ
->
æ_block
);

181 
	`š™_wa™queue_h—d
(&
æ
->
æ_wa™
);

182 
	}
}

185 
fe_lock
 *
	$locks_®loc_lock
()

187 
fe_lock
 *
æ
 = 
	`kmem_ÿche_z®loc
(
f–ock_ÿche
, 
GFP_KERNEL
);

189 ià(
æ
)

190 
	`locks_š™_lock_h—ds
(
æ
);

192  
æ
;

193 
	}
}

194 
EXPORT_SYMBOL_GPL
(
locks_®loc_lock
);

196 
	$locks_»Ëa£_´iv©e
(
fe_lock
 *
æ
)

198 ià(
æ
->
æ_İs
) {

199 ià(
æ
->
æ_İs
->
æ_»Ëa£_´iv©e
)

200 
æ
->
æ_İs
->
	`æ_»Ëa£_´iv©e
(fl);

201 
æ
->
æ_İs
 = 
NULL
;

203 ià(
æ
->
æ_lmİs
) {

204 ià(
æ
->
æ_lmİs
->
lm_»Ëa£_´iv©e
)

205 
æ
->
æ_lmİs
->
	`lm_»Ëa£_´iv©e
(fl);

206 
æ
->
æ_lmİs
 = 
NULL
;

209 
	}
}

210 
EXPORT_SYMBOL_GPL
(
locks_»Ëa£_´iv©e
);

213 
	$locks_ä“_lock
(
fe_lock
 *
æ
)

215 
	`BUG_ON
(
	`wa™queue_aùive
(&
æ
->
æ_wa™
));

216 
	`BUG_ON
(!
	`li¡_em±y
(&
æ
->
æ_block
));

217 
	`BUG_ON
(!
	`li¡_em±y
(&
æ
->
æ_lšk
));

219 
	`locks_»Ëa£_´iv©e
(
æ
);

220 
	`kmem_ÿche_ä“
(
f–ock_ÿche
, 
æ
);

221 
	}
}

222 
EXPORT_SYMBOL
(
locks_ä“_lock
);

224 
	$locks_š™_lock
(
fe_lock
 *
æ
)

226 
	`mem£t
(
æ
, 0, (
fe_lock
));

227 
	`locks_š™_lock_h—ds
(
æ
);

228 
	}
}

230 
EXPORT_SYMBOL
(
locks_š™_lock
);

232 
	$locks_cİy_´iv©e
(
fe_lock
 *
Ãw
, fe_lock *
æ
)

234 ià(
æ
->
æ_İs
) {

235 ià(
æ
->
æ_İs
->
æ_cİy_lock
)

236 
æ
->
æ_İs
->
	`æ_cİy_lock
(
Ãw
, fl);

237 
Ãw
->
æ_İs
 = 
æ
->fl_ops;

239 ià(
æ
->
æ_lmİs
)

240 
Ãw
->
æ_lmİs
 = 
æ
->fl_lmops;

241 
	}
}

246 
	$__locks_cİy_lock
(
fe_lock
 *
Ãw
, cÚ¡ fe_lock *
æ
)

248 
Ãw
->
æ_owÃr
 = 
æ
->fl_owner;

249 
Ãw
->
æ_pid
 = 
æ
->fl_pid;

250 
Ãw
->
æ_fe
 = 
NULL
;

251 
Ãw
->
æ_æags
 = 
æ
->fl_flags;

252 
Ãw
->
æ_ty³
 = 
æ
->fl_type;

253 
Ãw
->
æ_¡¬t
 = 
æ
->fl_start;

254 
Ãw
->
æ_’d
 = 
æ
->fl_end;

255 
Ãw
->
æ_İs
 = 
NULL
;

256 
Ãw
->
æ_lmİs
 = 
NULL
;

257 
	}
}

258 
EXPORT_SYMBOL
(
__locks_cİy_lock
);

260 
	$locks_cİy_lock
(
fe_lock
 *
Ãw
, fe_lock *
æ
)

262 
	`locks_»Ëa£_´iv©e
(
Ãw
);

264 
	`__locks_cİy_lock
(
Ãw
, 
æ
);

265 
Ãw
->
æ_fe
 = 
æ
->fl_file;

266 
Ãw
->
æ_İs
 = 
æ
->fl_ops;

267 
Ãw
->
æ_lmİs
 = 
æ
->fl_lmops;

269 
	`locks_cİy_´iv©e
(
Ãw
, 
æ
);

270 
	}
}

272 
EXPORT_SYMBOL
(
locks_cİy_lock
);

274 
šlše
 
	$æock_Œª¦©e_cmd
(
cmd
) {

275 ià(
cmd
 & 
LOCK_MAND
)

276  
cmd
 & (
LOCK_MAND
 | 
LOCK_RW
);

277 
cmd
) {

278 
LOCK_SH
:

279  
F_RDLCK
;

280 
LOCK_EX
:

281  
F_WRLCK
;

282 
LOCK_UN
:

283  
F_UNLCK
;

285  -
EINVAL
;

286 
	}
}

289 
	$æock_make_lock
(
fe
 *
fp
, 
fe_lock
 **
lock
,

290 
cmd
)

292 
fe_lock
 *
æ
;

293 
ty³
 = 
	`æock_Œª¦©e_cmd
(
cmd
);

294 ià(
ty³
 < 0)

295  
ty³
;

297 
æ
 = 
	`locks_®loc_lock
();

298 ià(
æ
 =ğ
NULL
)

299  -
ENOMEM
;

301 
æ
->
æ_fe
 = 
fp
;

302 
æ
->
æ_pid
 = 
cu¼’t
->
tgid
;

303 
æ
->
æ_æags
 = 
FL_FLOCK
;

304 
æ
->
æ_ty³
 = 
ty³
;

305 
æ
->
æ_’d
 = 
OFFSET_MAX
;

307 *
lock
 = 
æ
;

309 
	}
}

311 
	$assign_ty³
(
fe_lock
 *
æ
, 
ty³
)

313 
ty³
) {

314 
F_RDLCK
:

315 
F_WRLCK
:

316 
F_UNLCK
:

317 
æ
->
æ_ty³
 = 
ty³
;

320  -
EINVAL
;

323 
	}
}

328 
	$æock_to_posix_lock
(
fe
 *
fp
, 
fe_lock
 *
æ
,

329 
æock
 *
l
)

331 
off_t
 
¡¬t
, 
’d
;

333 
l
->
l_wh’û
) {

334 
SEEK_SET
:

335 
¡¬t
 = 0;

337 
SEEK_CUR
:

338 
¡¬t
 = 
fp
->
f_pos
;

340 
SEEK_END
:

341 
¡¬t
 = 
	`i_size_»ad
(
fp
->
f_·th
.
d’Œy
->
d_šode
);

344  -
EINVAL
;

349 
¡¬t
 +ğ
l
->
l_¡¬t
;

350 ià(
¡¬t
 < 0)

351  -
EINVAL
;

352 
æ
->
æ_’d
 = 
OFFSET_MAX
;

353 ià(
l
->
l_Ën
 > 0) {

354 
’d
 = 
¡¬t
 + 
l
->
l_Ën
 - 1;

355 
æ
->
æ_’d
 = 
’d
;

356 } ià(
l
->
l_Ën
 < 0) {

357 
’d
 = 
¡¬t
 - 1;

358 
æ
->
æ_’d
 = 
’d
;

359 
¡¬t
 +ğ
l
->
l_Ën
;

360 ià(
¡¬t
 < 0)

361  -
EINVAL
;

363 
æ
->
æ_¡¬t
 = 
¡¬t
;

364 ià(
æ
->
æ_’d
 < fl->
æ_¡¬t
)

365  -
EOVERFLOW
;

367 
æ
->
æ_owÃr
 = 
cu¼’t
->
fes
;

368 
æ
->
æ_pid
 = 
cu¼’t
->
tgid
;

369 
æ
->
æ_fe
 = 
fp
;

370 
æ
->
æ_æags
 = 
FL_POSIX
;

371 
æ
->
æ_İs
 = 
NULL
;

372 
æ
->
æ_lmİs
 = 
NULL
;

374  
	`assign_ty³
(
æ
, 
l
->
l_ty³
);

375 
	}
}

377 #ià
BITS_PER_LONG
 == 32

378 
	$æock64_to_posix_lock
(
fe
 *
fp
, 
fe_lock
 *
æ
,

379 
æock64
 *
l
)

381 
loff_t
 
¡¬t
;

383 
l
->
l_wh’û
) {

384 
SEEK_SET
:

385 
¡¬t
 = 0;

387 
SEEK_CUR
:

388 
¡¬t
 = 
fp
->
f_pos
;

390 
SEEK_END
:

391 
¡¬t
 = 
	`i_size_»ad
(
fp
->
f_·th
.
d’Œy
->
d_šode
);

394  -
EINVAL
;

397 
¡¬t
 +ğ
l
->
l_¡¬t
;

398 ià(
¡¬t
 < 0)

399  -
EINVAL
;

400 
æ
->
æ_’d
 = 
OFFSET_MAX
;

401 ià(
l
->
l_Ën
 > 0) {

402 
æ
->
æ_’d
 = 
¡¬t
 + 
l
->
l_Ën
 - 1;

403 } ià(
l
->
l_Ën
 < 0) {

404 
æ
->
æ_’d
 = 
¡¬t
 - 1;

405 
¡¬t
 +ğ
l
->
l_Ën
;

406 ià(
¡¬t
 < 0)

407  -
EINVAL
;

409 
æ
->
æ_¡¬t
 = 
¡¬t
;

410 ià(
æ
->
æ_’d
 < fl->
æ_¡¬t
)

411  -
EOVERFLOW
;

413 
æ
->
æ_owÃr
 = 
cu¼’t
->
fes
;

414 
æ
->
æ_pid
 = 
cu¼’t
->
tgid
;

415 
æ
->
æ_fe
 = 
fp
;

416 
æ
->
æ_æags
 = 
FL_POSIX
;

417 
æ
->
æ_İs
 = 
NULL
;

418 
æ
->
æ_lmİs
 = 
NULL
;

420  
	`assign_ty³
(
æ
, 
l
->
l_ty³
);

421 
	}
}

425 
	$Ëa£_b»ak_ÿÎback
(
fe_lock
 *
æ
)

427 
	`kl_çsync
(&
æ
->
æ_çsync
, 
SIGIO
, 
POLL_MSG
);

428 
	}
}

430 
	$Ëa£_»Ëa£_´iv©e_ÿÎback
(
fe_lock
 *
æ
)

432 ià(!
æ
->
æ_fe
)

435 
	`f_d–own
(
æ
->
æ_fe
);

436 
æ
->
æ_fe
->
f_owÃr
.
signum
 = 0;

437 
	}
}

439 cÚ¡ 
lock_mªag”_İ”©iÚs
 
	gËa£_mªag”_İs
 = {

440 .
lm_b»ak
 = 
Ëa£_b»ak_ÿÎback
,

441 .
	glm_»Ëa£_´iv©e
 = 
Ëa£_»Ëa£_´iv©e_ÿÎback
,

442 .
	glm_chªge
 = 
Ëa£_modify
,

448 
	$Ëa£_š™
(
fe
 *
fp
, 
ty³
, 
fe_lock
 *
æ
)

450 ià(
	`assign_ty³
(
æ
, 
ty³
) != 0)

451  -
EINVAL
;

453 
æ
->
æ_owÃr
 = 
cu¼’t
->
fes
;

454 
æ
->
æ_pid
 = 
cu¼’t
->
tgid
;

456 
æ
->
æ_fe
 = 
fp
;

457 
æ
->
æ_æags
 = 
FL_LEASE
;

458 
æ
->
æ_¡¬t
 = 0;

459 
æ
->
æ_’d
 = 
OFFSET_MAX
;

460 
æ
->
æ_İs
 = 
NULL
;

461 
æ
->
æ_lmİs
 = &
Ëa£_mªag”_İs
;

463 
	}
}

466 
fe_lock
 *
	$Ëa£_®loc
(
fe
 *
fp
, 
ty³
)

468 
fe_lock
 *
æ
 = 
	`locks_®loc_lock
();

469 
”rÜ
 = -
ENOMEM
;

471 ià(
æ
 =ğ
NULL
)

472  
	`ERR_PTR
(
”rÜ
);

474 
”rÜ
 = 
	`Ëa£_š™
(
fp
, 
ty³
, 
æ
);

475 ià(
”rÜ
) {

476 
	`locks_ä“_lock
(
æ
);

477  
	`ERR_PTR
(
”rÜ
);

479  
æ
;

480 
	}
}

484 
šlše
 
	$locks_ov”Ïp
(
fe_lock
 *
æ1
, fe_lock *
æ2
)

486  ((
æ1
->
æ_’d
 >ğ
æ2
->
æ_¡¬t
) &&

487 (
æ2
->
æ_’d
 >ğ
æ1
->
æ_¡¬t
));

488 
	}
}

493 
	$posix_§me_owÃr
(
fe_lock
 *
æ1
, fe_lock *
æ2
)

495 ià(
æ1
->
æ_lmİs
 && fl1->æ_lmİs->
lm_com·»_owÃr
)

496  
æ2
->
æ_lmİs
 =ğ
æ1
->fl_lmops &&

497 
æ1
->
æ_lmİs
->
	`lm_com·»_owÃr
(æ1, 
æ2
);

498  
æ1
->
æ_owÃr
 =ğ
æ2
->fl_owner;

499 
	}
}

504 
	$__locks_d–‘e_block
(
fe_lock
 *
wa™”
)

506 
	`li¡_d–_š™
(&
wa™”
->
æ_block
);

507 
	`li¡_d–_š™
(&
wa™”
->
æ_lšk
);

508 
wa™”
->
æ_Ãxt
 = 
NULL
;

509 
	}
}

513 
	$locks_d–‘e_block
(
fe_lock
 *
wa™”
)

515 
	`lock_æocks
();

516 
	`__locks_d–‘e_block
(
wa™”
);

517 
	`uÆock_æocks
();

518 
	}
}

525 
	$locks_š£¹_block
(
fe_lock
 *
block”
,

526 
fe_lock
 *
wa™”
)

528 
	`BUG_ON
(!
	`li¡_em±y
(&
wa™”
->
æ_block
));

529 
	`li¡_add_
(&
wa™”
->
æ_block
, &
block”
->fl_block);

530 
wa™”
->
æ_Ãxt
 = 
block”
;

531 ià(
	`IS_POSIX
(
block”
))

532 
	`li¡_add
(&
wa™”
->
æ_lšk
, &
blocked_li¡
);

533 
	}
}

539 
	$locks_wake_up_blocks
(
fe_lock
 *
block”
)

541 !
	`li¡_em±y
(&
block”
->
æ_block
)) {

542 
fe_lock
 *
wa™”
;

544 
wa™”
 = 
	`li¡_fœ¡_’Œy
(&
block”
->
æ_block
,

545 
fe_lock
, 
æ_block
);

546 
	`__locks_d–‘e_block
(
wa™”
);

547 ià(
wa™”
->
æ_lmİs
 && wa™”->æ_lmİs->
lm_nÙify
)

548 
wa™”
->
æ_lmİs
->
	`lm_nÙify
(waiter);

550 
	`wake_up
(&
wa™”
->
æ_wa™
);

552 
	}
}

557 
	$locks_š£¹_lock
(
fe_lock
 **
pos
, fe_lock *
æ
)

560 
	`li¡_add
(&
æ
->
æ_lšk
, &
fe_lock_li¡
);

562 
æ
->
æ_n¥id
 = 
	`g‘_pid
(
	`sk_tgid
(
cu¼’t
));

565 
æ
->
æ_Ãxt
 = *
pos
;

566 *
pos
 = 
æ
;

567 
	}
}

575 
	$locks_d–‘e_lock
(
fe_lock
 **
thisæ_p
)

577 
fe_lock
 *
æ
 = *
thisæ_p
;

579 *
thisæ_p
 = 
æ
->
æ_Ãxt
;

580 
æ
->
æ_Ãxt
 = 
NULL
;

581 
	`li¡_d–_š™
(&
æ
->
æ_lšk
);

583 
	`çsync_h–³r
(0, 
æ
->
æ_fe
, 0, &æ->
æ_çsync
);

584 ià(
æ
->
æ_çsync
 !ğ
NULL
) {

585 
	`´štk
(
KERN_ERR
 "locks_d–‘e_lock: fasynø=ğ%p\n", 
æ
->
æ_çsync
);

586 
æ
->
æ_çsync
 = 
NULL
;

589 ià(
æ
->
æ_n¥id
) {

590 
	`put_pid
(
æ
->
æ_n¥id
);

591 
æ
->
æ_n¥id
 = 
NULL
;

594 
	`locks_wake_up_blocks
(
æ
);

595 
	`locks_ä“_lock
(
æ
);

596 
	}
}

601 
	$locks_cÚæiù
(
fe_lock
 *
ÿÎ”_æ
, fe_lock *
sys_æ
)

603 ià(
sys_æ
->
æ_ty³
 =ğ
F_WRLCK
)

605 ià(
ÿÎ”_æ
->
æ_ty³
 =ğ
F_WRLCK
)

608 
	}
}

613 
	$posix_locks_cÚæiù
(
fe_lock
 *
ÿÎ”_æ
, fe_lock *
sys_æ
)

618 ià(!
	`IS_POSIX
(
sys_æ
è|| 
	`posix_§me_owÃr
(
ÿÎ”_æ
, sys_fl))

622 ià(!
	`locks_ov”Ïp
(
ÿÎ”_æ
, 
sys_æ
))

625  (
	`locks_cÚæiù
(
ÿÎ”_æ
, 
sys_æ
));

626 
	}
}

631 
	$æock_locks_cÚæiù
(
fe_lock
 *
ÿÎ”_æ
, fe_lock *
sys_æ
)

636 ià(!
	`IS_FLOCK
(
sys_æ
è|| (
ÿÎ”_æ
->
æ_fe
 == sys_fl->fl_file))

638 ià((
ÿÎ”_æ
->
æ_ty³
 & 
LOCK_MAND
è|| (
sys_æ
->fl_type & LOCK_MAND))

641  (
	`locks_cÚæiù
(
ÿÎ”_æ
, 
sys_æ
));

642 
	}
}

645 
	$posix_‹¡_lock
(
fe
 *
fp
, 
fe_lock
 *
æ
)

647 
fe_lock
 *
cæ
;

649 
	`lock_æocks
();

650 
cæ
 = 
fp
->
f_·th
.
d’Œy
->
d_šode
->
i_æock
; cæ; cæ = cæ->
æ_Ãxt
) {

651 ià(!
	`IS_POSIX
(
cæ
))

653 ià(
	`posix_locks_cÚæiù
(
æ
, 
cæ
))

656 ià(
cæ
) {

657 
	`__locks_cİy_lock
(
æ
, 
cæ
);

658 ià(
cæ
->
æ_n¥id
)

659 
æ
->
æ_pid
 = 
	`pid_vÄ
(
cæ
->
æ_n¥id
);

661 
æ
->
æ_ty³
 = 
F_UNLCK
;

662 
	`uÆock_æocks
();

664 
	}
}

665 
EXPORT_SYMBOL
(
posix_‹¡_lock
);

692 
	#MAX_DEADLK_ITERATIONS
 10

	)

695 
fe_lock
 *
	$wh©_owÃr_is_wa™šg_fÜ
(
fe_lock
 *
block_æ
)

697 
fe_lock
 *
æ
;

699 
	`li¡_fÜ_—ch_’Œy
(
æ
, &
blocked_li¡
, 
æ_lšk
) {

700 ià(
	`posix_§me_owÃr
(
æ
, 
block_æ
))

701  
æ
->
æ_Ãxt
;

703  
NULL
;

704 
	}
}

706 
	$posix_locks_d—dlock
(
fe_lock
 *
ÿÎ”_æ
,

707 
fe_lock
 *
block_æ
)

709 
i
 = 0;

711 (
block_æ
 = 
	`wh©_owÃr_is_wa™šg_fÜ
(block_fl))) {

712 ià(
i
++ > 
MAX_DEADLK_ITERATIONS
)

714 ià(
	`posix_§me_owÃr
(
ÿÎ”_æ
, 
block_æ
))

718 
	}
}

727 
	$æock_lock_fe
(
fe
 *
fp
, 
fe_lock
 *
»que¡
)

729 
fe_lock
 *
Ãw_æ
 = 
NULL
;

730 
fe_lock
 **
befÜe
;

731 
šode
 * inodğ
fp
->
f_·th
.
d’Œy
->
d_šode
;

732 
”rÜ
 = 0;

733 
found
 = 0;

735 ià(!(
»que¡
->
æ_æags
 & 
FL_ACCESS
è&& (»que¡->
æ_ty³
 !ğ
F_UNLCK
)) {

736 
Ãw_æ
 = 
	`locks_®loc_lock
();

737 ià(!
Ãw_æ
)

738  -
ENOMEM
;

741 
	`lock_æocks
();

742 ià(
»que¡
->
æ_æags
 & 
FL_ACCESS
)

743 
fšd_cÚæiù
;

745 
	`fÜ_—ch_lock
(
šode
, 
befÜe
) {

746 
fe_lock
 *
æ
 = *
befÜe
;

747 ià(
	`IS_POSIX
(
æ
))

749 ià(
	`IS_LEASE
(
æ
))

751 ià(
fp
 !ğ
æ
->
æ_fe
)

753 ià(
»que¡
->
æ_ty³
 =ğ
æ
->fl_type)

754 
out
;

755 
found
 = 1;

756 
	`locks_d–‘e_lock
(
befÜe
);

760 ià(
»que¡
->
æ_ty³
 =ğ
F_UNLCK
) {

761 ià((
»que¡
->
æ_æags
 & 
FL_EXISTS
è&& !
found
)

762 
”rÜ
 = -
ENOENT
;

763 
out
;

770 ià(
found
) {

771 
	`uÆock_æocks
();

772 
	`cÚd_»sched
();

773 
	`lock_æocks
();

776 
fšd_cÚæiù
:

777 
	`fÜ_—ch_lock
(
šode
, 
befÜe
) {

778 
fe_lock
 *
æ
 = *
befÜe
;

779 ià(
	`IS_POSIX
(
æ
))

781 ià(
	`IS_LEASE
(
æ
))

783 ià(!
	`æock_locks_cÚæiù
(
»que¡
, 
æ
))

785 
”rÜ
 = -
EAGAIN
;

786 ià(!(
»que¡
->
æ_æags
 & 
FL_SLEEP
))

787 
out
;

788 
”rÜ
 = 
FILE_LOCK_DEFERRED
;

789 
	`locks_š£¹_block
(
æ
, 
»que¡
);

790 
out
;

792 ià(
»que¡
->
æ_æags
 & 
FL_ACCESS
)

793 
out
;

794 
	`locks_cİy_lock
(
Ãw_æ
, 
»que¡
);

795 
	`locks_š£¹_lock
(
befÜe
, 
Ãw_æ
);

796 
Ãw_æ
 = 
NULL
;

797 
”rÜ
 = 0;

799 
out
:

800 
	`uÆock_æocks
();

801 ià(
Ãw_æ
)

802 
	`locks_ä“_lock
(
Ãw_æ
);

803  
”rÜ
;

804 
	}
}

806 
	$__posix_lock_fe
(
šode
 *šode, 
fe_lock
 *
»que¡
, fe_lock *
cÚæock
)

808 
fe_lock
 *
æ
;

809 
fe_lock
 *
Ãw_æ
 = 
NULL
;

810 
fe_lock
 *
Ãw_æ2
 = 
NULL
;

811 
fe_lock
 *
Ëá
 = 
NULL
;

812 
fe_lock
 *
right
 = 
NULL
;

813 
fe_lock
 **
befÜe
;

814 
”rÜ
, 
added
 = 0;

822 ià(!(
»que¡
->
æ_æags
 & 
FL_ACCESS
) &&

823 (
»que¡
->
æ_ty³
 !ğ
F_UNLCK
 ||

824 
»que¡
->
æ_¡¬t
 !ğ0 ||„eque¡->
æ_’d
 !ğ
OFFSET_MAX
)) {

825 
Ãw_æ
 = 
	`locks_®loc_lock
();

826 
Ãw_æ2
 = 
	`locks_®loc_lock
();

829 
	`lock_æocks
();

830 ià(
»que¡
->
æ_ty³
 !ğ
F_UNLCK
) {

831 
	`fÜ_—ch_lock
(
šode
, 
befÜe
) {

832 
æ
 = *
befÜe
;

833 ià(!
	`IS_POSIX
(
æ
))

835 ià(!
	`posix_locks_cÚæiù
(
»que¡
, 
æ
))

837 ià(
cÚæock
)

838 
	`__locks_cİy_lock
(
cÚæock
, 
æ
);

839 
”rÜ
 = -
EAGAIN
;

840 ià(!(
»que¡
->
æ_æags
 & 
FL_SLEEP
))

841 
out
;

842 
”rÜ
 = -
EDEADLK
;

843 ià(
	`posix_locks_d—dlock
(
»que¡
, 
æ
))

844 
out
;

845 
”rÜ
 = 
FILE_LOCK_DEFERRED
;

846 
	`locks_š£¹_block
(
æ
, 
»que¡
);

847 
out
;

852 
”rÜ
 = 0;

853 ià(
»que¡
->
æ_æags
 & 
FL_ACCESS
)

854 
out
;

860 
befÜe
 = &
šode
->
i_æock
;

863 (
æ
 = *
befÜe
è&& (!
	`IS_POSIX
(fl) ||

864 !
	`posix_§me_owÃr
(
»que¡
, 
æ
))) {

865 
befÜe
 = &
æ
->
æ_Ãxt
;

869 (
æ
 = *
befÜe
è&& 
	`posix_§me_owÃr
(
»que¡
, fl)) {

872 ià(
»que¡
->
æ_ty³
 =ğ
æ
->fl_type) {

877 ià(
æ
->
æ_’d
 < 
»que¡
->
æ_¡¬t
 - 1)

878 
Ãxt_lock
;

882 ià(
æ
->
æ_¡¬t
 - 1 > 
»que¡
->
æ_’d
)

890 ià(
æ
->
æ_¡¬t
 > 
»que¡
->fl_start)

891 
æ
->
æ_¡¬t
 = 
»que¡
->fl_start;

893 
»que¡
->
æ_¡¬t
 = 
æ
->fl_start;

894 ià(
æ
->
æ_’d
 < 
»que¡
->fl_end)

895 
æ
->
æ_’d
 = 
»que¡
->fl_end;

897 
»que¡
->
æ_’d
 = 
æ
->fl_end;

898 ià(
added
) {

899 
	`locks_d–‘e_lock
(
befÜe
);

902 
»que¡
 = 
æ
;

903 
added
 = 1;

909 ià(
æ
->
æ_’d
 < 
»que¡
->
æ_¡¬t
)

910 
Ãxt_lock
;

911 ià(
æ
->
æ_¡¬t
 > 
»que¡
->
æ_’d
)

913 ià(
»que¡
->
æ_ty³
 =ğ
F_UNLCK
)

914 
added
 = 1;

915 ià(
æ
->
æ_¡¬t
 < 
»que¡
->fl_start)

916 
Ëá
 = 
æ
;

920 ià(
æ
->
æ_’d
 > 
»que¡
->fl_end) {

921 
right
 = 
æ
;

924 ià(
æ
->
æ_¡¬t
 >ğ
»que¡
->fl_start) {

928 ià(
added
) {

929 
	`locks_d–‘e_lock
(
befÜe
);

937 
	`locks_wake_up_blocks
(
æ
);

938 
æ
->
æ_¡¬t
 = 
»que¡
->fl_start;

939 
æ
->
æ_’d
 = 
»que¡
->fl_end;

940 
æ
->
æ_ty³
 = 
»que¡
->fl_type;

941 
	`locks_»Ëa£_´iv©e
(
æ
);

942 
	`locks_cİy_´iv©e
(
æ
, 
»que¡
);

943 
»que¡
 = 
æ
;

944 
added
 = 1;

949 
Ãxt_lock
:

950 
befÜe
 = &
æ
->
æ_Ãxt
;

959 
”rÜ
 = -
ENOLCK
;

960 ià(
right
 && 
Ëá
 =ğrighˆ&& !
Ãw_æ2
)

961 
out
;

963 
”rÜ
 = 0;

964 ià(!
added
) {

965 ià(
»que¡
->
æ_ty³
 =ğ
F_UNLCK
) {

966 ià(
»que¡
->
æ_æags
 & 
FL_EXISTS
)

967 
”rÜ
 = -
ENOENT
;

968 
out
;

971 ià(!
Ãw_æ
) {

972 
”rÜ
 = -
ENOLCK
;

973 
out
;

975 
	`locks_cİy_lock
(
Ãw_æ
, 
»que¡
);

976 
	`locks_š£¹_lock
(
befÜe
, 
Ãw_æ
);

977 
Ãw_æ
 = 
NULL
;

979 ià(
right
) {

980 ià(
Ëá
 =ğ
right
) {

984 
Ëá
 = 
Ãw_æ2
;

985 
Ãw_æ2
 = 
NULL
;

986 
	`locks_cİy_lock
(
Ëá
, 
right
);

987 
	`locks_š£¹_lock
(
befÜe
, 
Ëá
);

989 
right
->
æ_¡¬t
 = 
»que¡
->
æ_’d
 + 1;

990 
	`locks_wake_up_blocks
(
right
);

992 ià(
Ëá
) {

993 
Ëá
->
æ_’d
 = 
»que¡
->
æ_¡¬t
 - 1;

994 
	`locks_wake_up_blocks
(
Ëá
);

996 
out
:

997 
	`uÆock_æocks
();

1001 ià(
Ãw_æ
)

1002 
	`locks_ä“_lock
(
Ãw_æ
);

1003 ià(
Ãw_æ2
)

1004 
	`locks_ä“_lock
(
Ãw_æ2
);

1005  
”rÜ
;

1006 
	}
}

1022 
	$posix_lock_fe
(
fe
 *
fp
, 
fe_lock
 *
æ
,

1023 
fe_lock
 *
cÚæock
)

1025  
	`__posix_lock_fe
(
fp
->
f_·th
.
d’Œy
->
d_šode
, 
æ
, 
cÚæock
);

1026 
	}
}

1027 
EXPORT_SYMBOL
(
posix_lock_fe
);

1038 
	$posix_lock_fe_wa™
(
fe
 *
fp
, 
fe_lock
 *
æ
)

1040 
”rÜ
;

1041 
	`might_¦“p
 ();

1043 
”rÜ
 = 
	`posix_lock_fe
(
fp
, 
æ
, 
NULL
);

1044 ià(
”rÜ
 !ğ
FILE_LOCK_DEFERRED
)

1046 
”rÜ
 = 
	`wa™_ev’t_š‹¼u±ibË
(
æ
->
æ_wa™
, !æ->
æ_Ãxt
);

1047 ià(!
”rÜ
)

1050 
	`locks_d–‘e_block
(
æ
);

1053  
”rÜ
;

1054 
	}
}

1055 
EXPORT_SYMBOL
(
posix_lock_fe_wa™
);

1064 
	$locks_mªd©Üy_locked
(
šode
 *inode)

1066 
æ_owÃr_t
 
owÃr
 = 
cu¼’t
->
fes
;

1067 
fe_lock
 *
æ
;

1072 
	`lock_æocks
();

1073 
æ
 = 
šode
->
i_æock
; fÈ!ğ
NULL
; fÈğæ->
æ_Ãxt
) {

1074 ià(!
	`IS_POSIX
(
æ
))

1076 ià(
æ
->
æ_owÃr
 !ğ
owÃr
)

1079 
	`uÆock_æocks
();

1080  
æ
 ? -
EAGAIN
 : 0;

1081 
	}
}

1096 
	$locks_mªd©Üy_¬—
(
»ad_wr™e
, 
šode
 *inode,

1097 
fe
 *
fp
, 
loff_t
 
off£t
,

1098 
size_t
 
couÁ
)

1100 
fe_lock
 
æ
;

1101 
”rÜ
;

1103 
	`locks_š™_lock
(&
æ
);

1104 
æ
.
æ_owÃr
 = 
cu¼’t
->
fes
;

1105 
æ
.
æ_pid
 = 
cu¼’t
->
tgid
;

1106 
æ
.
æ_fe
 = 
fp
;

1107 
æ
.
æ_æags
 = 
FL_POSIX
 | 
FL_ACCESS
;

1108 ià(
fp
 && !(fp->
f_æags
 & 
O_NONBLOCK
))

1109 
æ
.
æ_æags
 |ğ
FL_SLEEP
;

1110 
æ
.
æ_ty³
 = (
»ad_wr™e
 =ğ
FLOCK_VERIFY_WRITE
è? 
F_WRLCK
 : 
F_RDLCK
;

1111 
æ
.
æ_¡¬t
 = 
off£t
;

1112 
æ
.
æ_’d
 = 
off£t
 + 
couÁ
 - 1;

1115 
”rÜ
 = 
	`__posix_lock_fe
(
šode
, &
æ
, 
NULL
);

1116 ià(
”rÜ
 !ğ
FILE_LOCK_DEFERRED
)

1118 
”rÜ
 = 
	`wa™_ev’t_š‹¼u±ibË
(
æ
.
æ_wa™
, !æ.
æ_Ãxt
);

1119 ià(!
”rÜ
) {

1124 ià(
	`__mªd©Üy_lock
(
šode
))

1128 
	`locks_d–‘e_block
(&
æ
);

1132  
”rÜ
;

1133 
	}
}

1135 
EXPORT_SYMBOL
(
locks_mªd©Üy_¬—
);

1137 
	$Ëa£_ş—r_³ndšg
(
fe_lock
 *
æ
, 
¬g
)

1139 
¬g
) {

1140 
F_UNLCK
:

1141 
æ
->
æ_æags
 &ğ~
FL_UNLOCK_PENDING
;

1143 
F_RDLCK
:

1144 
æ
->
æ_æags
 &ğ~
FL_DOWNGRADE_PENDING
;

1146 
	}
}

1149 
	$Ëa£_modify
(
fe_lock
 **
befÜe
, 
¬g
)

1151 
fe_lock
 *
æ
 = *
befÜe
;

1152 
”rÜ
 = 
	`assign_ty³
(
æ
, 
¬g
);

1154 ià(
”rÜ
)

1155  
”rÜ
;

1156 
	`Ëa£_ş—r_³ndšg
(
æ
, 
¬g
);

1157 
	`locks_wake_up_blocks
(
æ
);

1158 ià(
¬g
 =ğ
F_UNLCK
)

1159 
	`locks_d–‘e_lock
(
befÜe
);

1161 
	}
}

1163 
EXPORT_SYMBOL
(
Ëa£_modify
);

1165 
boŞ
 
	$·¡_time
(
th’
)

1167 ià(!
th’
)

1169  
çl£
;

1170  
	`time_aá”
(
jiff›s
, 
th’
);

1171 
	}
}

1173 
	$time_out_Ëa£s
(
šode
 *inode)

1175 
fe_lock
 **
befÜe
;

1176 
fe_lock
 *
æ
;

1178 
befÜe
 = &
šode
->
i_æock
;

1179 (
æ
 = *
befÜe
è&& 
	`IS_LEASE
(æè&& 
	`Ëa£_b»akšg
(fl)) {

1180 ià(
	`·¡_time
(
æ
->
æ_downg¿de_time
))

1181 
	`Ëa£_modify
(
befÜe
, 
F_RDLCK
);

1182 ià(
	`·¡_time
(
æ
->
æ_b»ak_time
))

1183 
	`Ëa£_modify
(
befÜe
, 
F_UNLCK
);

1184 ià(
æ
 =ğ*
befÜe
)

1185 
befÜe
 = &
æ
->
æ_Ãxt
;

1187 
	}
}

1199 
	$__b»ak_Ëa£
(
šode
 *šode, 
mode
)

1201 
”rÜ
 = 0;

1202 
fe_lock
 *
Ãw_æ
, *
æock
;

1203 
fe_lock
 *
æ
;

1204 
b»ak_time
;

1205 
i_have_this_Ëa£
 = 0;

1206 
wªt_wr™e
 = (
mode
 & 
O_ACCMODE
è!ğ
O_RDONLY
;

1208 
Ãw_æ
 = 
	`Ëa£_®loc
(
NULL
, 
wªt_wr™e
 ? 
F_WRLCK
 : 
F_RDLCK
);

1209 ià(
	`IS_ERR
(
Ãw_æ
))

1210  
	`PTR_ERR
(
Ãw_æ
);

1212 
	`lock_æocks
();

1214 
	`time_out_Ëa£s
(
šode
);

1216 
æock
 = 
šode
->
i_æock
;

1217 ià((
æock
 =ğ
NULL
è|| !
	`IS_LEASE
(flock))

1218 
out
;

1220 ià(!
	`locks_cÚæiù
(
æock
, 
Ãw_æ
))

1221 
out
;

1223 
æ
 = 
æock
; fÈ&& 
	`IS_LEASE
(æ); fÈğæ->
æ_Ãxt
)

1224 ià(
æ
->
æ_owÃr
 =ğ
cu¼’t
->
fes
)

1225 
i_have_this_Ëa£
 = 1;

1227 
b»ak_time
 = 0;

1228 ià(
Ëa£_b»ak_time
 > 0) {

1229 
b»ak_time
 = 
jiff›s
 + 
Ëa£_b»ak_time
 * 
HZ
;

1230 ià(
b»ak_time
 == 0)

1231 
b»ak_time
++;

1234 
æ
 = 
æock
; fÈ&& 
	`IS_LEASE
(æ); fÈğæ->
æ_Ãxt
) {

1235 ià(
wªt_wr™e
) {

1236 ià(
æ
->
æ_æags
 & 
FL_UNLOCK_PENDING
)

1238 
æ
->
æ_æags
 |ğ
FL_UNLOCK_PENDING
;

1239 
æ
->
æ_b»ak_time
 = 
b»ak_time
;

1241 ià(
	`Ëa£_b»akšg
(
æock
))

1243 
æ
->
æ_æags
 |ğ
FL_DOWNGRADE_PENDING
;

1244 
æ
->
æ_downg¿de_time
 = 
b»ak_time
;

1246 
æ
->
æ_lmİs
->
	`lm_b»ak
(fl);

1249 ià(
i_have_this_Ëa£
 || (
mode
 & 
O_NONBLOCK
)) {

1250 
”rÜ
 = -
EWOULDBLOCK
;

1251 
out
;

1254 
»¡¬t
:

1255 
b»ak_time
 = 
æock
->
æ_b»ak_time
;

1256 ià(
b»ak_time
 != 0) {

1257 
b»ak_time
 -ğ
jiff›s
;

1258 ià(
b»ak_time
 == 0)

1259 
b»ak_time
++;

1261 
	`locks_š£¹_block
(
æock
, 
Ãw_æ
);

1262 
	`uÆock_æocks
();

1263 
”rÜ
 = 
	`wa™_ev’t_š‹¼u±ibË_timeout
(
Ãw_æ
->
æ_wa™
,

1264 !
Ãw_æ
->
æ_Ãxt
, 
b»ak_time
);

1265 
	`lock_æocks
();

1266 
	`__locks_d–‘e_block
(
Ãw_æ
);

1267 ià(
”rÜ
 >= 0) {

1268 ià(
”rÜ
 == 0)

1269 
	`time_out_Ëa£s
(
šode
);

1274 
æock
 = 
šode
->
i_æock
; flock && 
	`IS_LEASE
(flock);

1275 
æock
 = flock->
æ_Ãxt
) {

1276 ià(
	`locks_cÚæiù
(
Ãw_æ
, 
æock
))

1277 
»¡¬t
;

1279 
”rÜ
 = 0;

1282 
out
:

1283 
	`uÆock_æocks
();

1284 
	`locks_ä“_lock
(
Ãw_æ
);

1285  
”rÜ
;

1286 
	}
}

1288 
EXPORT_SYMBOL
(
__b»ak_Ëa£
);

1299 
	$Ëa£_g‘_mtime
(
šode
 *šode, 
time¥ec
 *
time
)

1301 
fe_lock
 *
æock
 = 
šode
->
i_æock
;

1302 ià(
æock
 && 
	`IS_LEASE
(æockè&& (æock->
æ_ty³
 & 
F_WRLCK
))

1303 *
time
 = 
	`cu¼’t_fs_time
(
šode
->
i_sb
);

1305 *
time
 = 
šode
->
i_mtime
;

1306 
	}
}

1308 
EXPORT_SYMBOL
(
Ëa£_g‘_mtime
);

1333 
	$fú_g‘Ëa£
(
fe
 *
fp
)

1335 
fe_lock
 *
æ
;

1336 
ty³
 = 
F_UNLCK
;

1338 
	`lock_æocks
();

1339 
	`time_out_Ëa£s
(
fp
->
f_·th
.
d’Œy
->
d_šode
);

1340 
æ
 = 
fp
->
f_·th
.
d’Œy
->
d_šode
->
i_æock
; fÈ&& 
	`IS_LEASE
(fl);

1341 
æ
 = fl->
æ_Ãxt
) {

1342 ià(
æ
->
æ_fe
 =ğ
fp
) {

1343 
ty³
 = 
	`rg‘_Ëa£ty³
(
æ
);

1347 
	`uÆock_æocks
();

1348  
ty³
;

1349 
	}
}

1351 
	$g’”ic_add_Ëa£
(
fe
 *
fp
, 
¬g
, 
fe_lock
 **
æp
)

1353 
fe_lock
 *
æ
, **
befÜe
, **
my_befÜe
 = 
NULL
, *
Ëa£
;

1354 
d’Œy
 *d’Œy = 
fp
->
f_·th
.dentry;

1355 
šode
 *šodğ
d’Œy
->
d_šode
;

1356 
”rÜ
;

1358 
Ëa£
 = *
æp
;

1360 
”rÜ
 = -
EAGAIN
;

1361 ià((
¬g
 =ğ
F_RDLCK
è&& (
	`©omic_»ad
(&
šode
->
i_wr™ecouÁ
) > 0))

1362 
out
;

1363 ià((
¬g
 =ğ
F_WRLCK
)

1364 && ((
d’Œy
->
d_couÁ
 > 1)

1365 || (
	`©omic_»ad
(&
šode
->
i_couÁ
) > 1)))

1366 
out
;

1376 
”rÜ
 = -
EAGAIN
;

1377 
befÜe
 = &
šode
->
i_æock
;

1378 ((
æ
 = *
befÜe
è!ğ
NULL
è&& 
	`IS_LEASE
(fl);

1379 
befÜe
 = &
æ
->
æ_Ãxt
) {

1380 ià(
æ
->
æ_fe
 =ğ
fp
) {

1381 
my_befÜe
 = 
befÜe
;

1388 ià(
¬g
 =ğ
F_WRLCK
)

1389 
out
;

1394 ià(
æ
->
æ_æags
 & 
FL_UNLOCK_PENDING
)

1395 
out
;

1398 ià(
my_befÜe
 !ğ
NULL
) {

1399 
”rÜ
 = 
Ëa£
->
æ_lmİs
->
	`lm_chªge
(
my_befÜe
, 
¬g
);

1400 ià(!
”rÜ
)

1401 *
æp
 = *
my_befÜe
;

1402 
out
;

1405 
”rÜ
 = -
EINVAL
;

1406 ià(!
Ëa£s_’abË
)

1407 
out
;

1409 
	`locks_š£¹_lock
(
befÜe
, 
Ëa£
);

1412 
out
:

1413  
”rÜ
;

1414 
	}
}

1416 
	$g’”ic_d–‘e_Ëa£
(
fe
 *
fp
, 
fe_lock
 **
æp
)

1418 
fe_lock
 *
æ
, **
befÜe
;

1419 
d’Œy
 *d’Œy = 
fp
->
f_·th
.dentry;

1420 
šode
 *šodğ
d’Œy
->
d_šode
;

1422 
befÜe
 = &
šode
->
i_æock
;

1423 ((
æ
 = *
befÜe
è!ğ
NULL
è&& 
	`IS_LEASE
(fl);

1424 
befÜe
 = &
æ
->
æ_Ãxt
) {

1425 ià(
æ
->
æ_fe
 !ğ
fp
)

1427  (*
æp
)->
æ_lmİs
->
	`lm_chªge
(
befÜe
, 
F_UNLCK
);

1429  -
EAGAIN
;

1430 
	}
}

1443 
	$g’”ic_£—£
(
fe
 *
fp
, 
¬g
, 
fe_lock
 **
æp
)

1445 
d’Œy
 *d’Œy = 
fp
->
f_·th
.dentry;

1446 
šode
 *šodğ
d’Œy
->
d_šode
;

1447 
”rÜ
;

1449 ià((
	`cu¼’t_fsuid
(è!ğ
šode
->
i_uid
è&& !
	`ÿ·bË
(
CAP_LEASE
))

1450  -
EACCES
;

1451 ià(!
	`S_ISREG
(
šode
->
i_mode
))

1452  -
EINVAL
;

1453 
”rÜ
 = 
	`£cur™y_fe_lock
(
fp
, 
¬g
);

1454 ià(
”rÜ
)

1455  
”rÜ
;

1457 
	`time_out_Ëa£s
(
šode
);

1459 
	`BUG_ON
(!(*
æp
)->
æ_lmİs
->
lm_b»ak
);

1461 
¬g
) {

1462 
F_UNLCK
:

1463  
	`g’”ic_d–‘e_Ëa£
(
fp
, 
æp
);

1464 
F_RDLCK
:

1465 
F_WRLCK
:

1466  
	`g’”ic_add_Ëa£
(
fp
, 
¬g
, 
æp
);

1468 
	`BUG
();

1470 
	}
}

1471 
EXPORT_SYMBOL
(
g’”ic_£—£
);

1473 
	$__vfs_£—£
(
fe
 *
fp
, 
¬g
, 
fe_lock
 **
Ëa£
)

1475 ià(
fp
->
f_İ
 && fp->f_İ->
£—£
)

1476  
fp
->
f_İ
->
	`£—£
(fp, 
¬g
, 
Ëa£
);

1478  
	`g’”ic_£—£
(
fp
, 
¬g
, 
Ëa£
);

1479 
	}
}

1508 
	$vfs_£—£
(
fe
 *
fp
, 
¬g
, 
fe_lock
 **
Ëa£
)

1510 
”rÜ
;

1512 
	`lock_æocks
();

1513 
”rÜ
 = 
	`__vfs_£—£
(
fp
, 
¬g
, 
Ëa£
);

1514 
	`uÆock_æocks
();

1516  
”rÜ
;

1517 
	}
}

1518 
EXPORT_SYMBOL_GPL
(
vfs_£—£
);

1520 
	$do_fú_d–‘e_Ëa£
(
fe
 *
fp
)

1522 
fe_lock
 
æ
, *
æp
 = &fl;

1524 
	`Ëa£_š™
(
fp
, 
F_UNLCK
, 
æp
);

1526  
	`vfs_£—£
(
fp
, 
F_UNLCK
, &
æp
);

1527 
	}
}

1529 
	$do_fú_add_Ëa£
(
fd
, 
fe
 *
fp
, 
¬g
)

1531 
fe_lock
 *
æ
, *
»t
;

1532 
çsync_¡ruù
 *
Ãw
;

1533 
”rÜ
;

1535 
æ
 = 
	`Ëa£_®loc
(
fp
, 
¬g
);

1536 ià(
	`IS_ERR
(
æ
))

1537  
	`PTR_ERR
(
æ
);

1539 
Ãw
 = 
	`çsync_®loc
();

1540 ià(!
Ãw
) {

1541 
	`locks_ä“_lock
(
æ
);

1542  -
ENOMEM
;

1544 
»t
 = 
æ
;

1545 
	`lock_æocks
();

1546 
”rÜ
 = 
	`__vfs_£—£
(
fp
, 
¬g
, &
»t
);

1547 ià(
”rÜ
) {

1548 
	`uÆock_æocks
();

1549 
	`locks_ä“_lock
(
æ
);

1550 
out_ä“_çsync
;

1552 ià(
»t
 !ğ
æ
)

1553 
	`locks_ä“_lock
(
æ
);

1561 ià(!
	`çsync_š£¹_’Œy
(
fd
, 
fp
, &
»t
->
æ_çsync
, 
Ãw
))

1562 
Ãw
 = 
NULL
;

1564 
”rÜ
 = 
	`__f_£town
(
fp
, 
	`sk_pid
(
cu¼’t
), 
PIDTYPE_PID
, 0);

1565 
	`uÆock_æocks
();

1567 
out_ä“_çsync
:

1568 ià(
Ãw
)

1569 
	`çsync_ä“
(
Ãw
);

1570  
”rÜ
;

1571 
	}
}

1583 
	$fú_£—£
(
fd
, 
fe
 *
fp
, 
¬g
)

1585 ià(
¬g
 =ğ
F_UNLCK
)

1586  
	`do_fú_d–‘e_Ëa£
(
fp
);

1587  
	`do_fú_add_Ëa£
(
fd
, 
fp
, 
¬g
);

1588 
	}
}

1597 
	$æock_lock_fe_wa™
(
fe
 *
fp
, 
fe_lock
 *
æ
)

1599 
”rÜ
;

1600 
	`might_¦“p
();

1602 
”rÜ
 = 
	`æock_lock_fe
(
fp
, 
æ
);

1603 ià(
”rÜ
 !ğ
FILE_LOCK_DEFERRED
)

1605 
”rÜ
 = 
	`wa™_ev’t_š‹¼u±ibË
(
æ
->
æ_wa™
, !æ->
æ_Ãxt
);

1606 ià(!
”rÜ
)

1609 
	`locks_d–‘e_block
(
æ
);

1612  
”rÜ
;

1613 
	}
}

1615 
EXPORT_SYMBOL
(
æock_lock_fe_wa™
);

1636 
	$SYSCALL_DEFINE2
(
æock
, , 
fd
, , 
cmd
)

1638 
fe
 *
fp
;

1639 
fe_lock
 *
lock
;

1640 
ÿn_¦“p
, 
uÆock
;

1641 
”rÜ
;

1643 
”rÜ
 = -
EBADF
;

1644 
fp
 = 
	`fg‘
(
fd
);

1645 ià(!
fp
)

1646 
out
;

1648 
ÿn_¦“p
 = !(
cmd
 & 
LOCK_NB
);

1649 
cmd
 &ğ~
LOCK_NB
;

1650 
uÆock
 = (
cmd
 =ğ
LOCK_UN
);

1652 ià(!
uÆock
 && !(
cmd
 & 
LOCK_MAND
) &&

1653 !(
fp
->
f_mode
 & (
FMODE_READ
|
FMODE_WRITE
)))

1654 
out_putf
;

1656 
”rÜ
 = 
	`æock_make_lock
(
fp
, &
lock
, 
cmd
);

1657 ià(
”rÜ
)

1658 
out_putf
;

1659 ià(
ÿn_¦“p
)

1660 
lock
->
æ_æags
 |ğ
FL_SLEEP
;

1662 
”rÜ
 = 
	`£cur™y_fe_lock
(
fp
, 
lock
->
æ_ty³
);

1663 ià(
”rÜ
)

1664 
out_ä“
;

1666 ià(
fp
->
f_İ
 && fp->f_İ->
æock
)

1667 
”rÜ
 = 
fp
->
f_İ
->
	`æock
(filp,

1668 (
ÿn_¦“p
è? 
F_SETLKW
 : 
F_SETLK
,

1669 
lock
);

1671 
”rÜ
 = 
	`æock_lock_fe_wa™
(
fp
, 
lock
);

1673 
out_ä“
:

1674 
	`locks_ä“_lock
(
lock
);

1676 
out_putf
:

1677 
	`åut
(
fp
);

1678 
out
:

1679  
”rÜ
;

1680 
	}
}

1690 
	$vfs_‹¡_lock
(
fe
 *
fp
, 
fe_lock
 *
æ
)

1692 ià(
fp
->
f_İ
 && fp->f_İ->
lock
)

1693  
fp
->
f_İ
->
	`lock
(fp, 
F_GETLK
, 
æ
);

1694 
	`posix_‹¡_lock
(
fp
, 
æ
);

1696 
	}
}

1697 
EXPORT_SYMBOL_GPL
(
vfs_‹¡_lock
);

1699 
	$posix_lock_to_æock
(
æock
 *æock, 
fe_lock
 *
æ
)

1701 
æock
->
l_pid
 = 
æ
->
æ_pid
;

1702 #ià
BITS_PER_LONG
 == 32

1707 ià(
æ
->
æ_¡¬t
 > 
OFFT_OFFSET_MAX
)

1708  -
EOVERFLOW
;

1709 ià(
æ
->
æ_’d
 !ğ
OFFSET_MAX
 && fl->æ_’d > 
OFFT_OFFSET_MAX
)

1710  -
EOVERFLOW
;

1712 
æock
->
l_¡¬t
 = 
æ
->
æ_¡¬t
;

1713 
æock
->
l_Ën
 = 
æ
->
æ_’d
 =ğ
OFFSET_MAX
 ? 0 :

1714 
æ
->
æ_’d
 - fl->
æ_¡¬t
 + 1;

1715 
æock
->
l_wh’û
 = 0;

1716 
æock
->
l_ty³
 = 
æ
->
æ_ty³
;

1718 
	}
}

1720 #ià
BITS_PER_LONG
 == 32

1721 
	$posix_lock_to_æock64
(
æock64
 *
æock
, 
fe_lock
 *
æ
)

1723 
æock
->
l_pid
 = 
æ
->
æ_pid
;

1724 
æock
->
l_¡¬t
 = 
æ
->
æ_¡¬t
;

1725 
æock
->
l_Ën
 = 
æ
->
æ_’d
 =ğ
OFFSET_MAX
 ? 0 :

1726 
æ
->
æ_’d
 - fl->
æ_¡¬t
 + 1;

1727 
æock
->
l_wh’û
 = 0;

1728 
æock
->
l_ty³
 = 
æ
->
æ_ty³
;

1729 
	}
}

1735 
	$fú_g‘lk
(
fe
 *
fp
, 
æock
 
__u£r
 *
l
)

1737 
fe_lock
 file_lock;

1738 
æock
 flock;

1739 
”rÜ
;

1741 
”rÜ
 = -
EFAULT
;

1742 ià(
	`cİy_äom_u£r
(&
æock
, 
l
, (flock)))

1743 
out
;

1744 
”rÜ
 = -
EINVAL
;

1745 ià((
æock
.
l_ty³
 !ğ
F_RDLCK
è&& (æock.l_ty³ !ğ
F_WRLCK
))

1746 
out
;

1748 
”rÜ
 = 
	`æock_to_posix_lock
(
fp
, &
fe_lock
, &
æock
);

1749 ià(
”rÜ
)

1750 
out
;

1752 
”rÜ
 = 
	`vfs_‹¡_lock
(
fp
, &
fe_lock
);

1753 ià(
”rÜ
)

1754 
out
;

1756 
æock
.
l_ty³
 = 
fe_lock
.
æ_ty³
;

1757 ià(
fe_lock
.
æ_ty³
 !ğ
F_UNLCK
) {

1758 
”rÜ
 = 
	`posix_lock_to_æock
(&
æock
, &
fe_lock
);

1759 ià(
”rÜ
)

1760 
out
;

1762 
”rÜ
 = -
EFAULT
;

1763 ià(!
	`cİy_to_u£r
(
l
, &
æock
, (flock)))

1764 
”rÜ
 = 0;

1765 
out
:

1766  
”rÜ
;

1767 
	}
}

1802 
	$vfs_lock_fe
(
fe
 *
fp
, 
cmd
, 
fe_lock
 *
æ
, fe_lock *
cÚf
)

1804 ià(
fp
->
f_İ
 && fp->f_İ->
lock
)

1805  
fp
->
f_İ
->
	`lock
(fp, 
cmd
, 
æ
);

1807  
	`posix_lock_fe
(
fp
, 
æ
, 
cÚf
);

1808 
	}
}

1809 
EXPORT_SYMBOL_GPL
(
vfs_lock_fe
);

1811 
	$do_lock_fe_wa™
(
fe
 *
fp
, 
cmd
,

1812 
fe_lock
 *
æ
)

1814 
”rÜ
;

1816 
”rÜ
 = 
	`£cur™y_fe_lock
(
fp
, 
æ
->
æ_ty³
);

1817 ià(
”rÜ
)

1818  
”rÜ
;

1821 
”rÜ
 = 
	`vfs_lock_fe
(
fp
, 
cmd
, 
æ
, 
NULL
);

1822 ià(
”rÜ
 !ğ
FILE_LOCK_DEFERRED
)

1824 
”rÜ
 = 
	`wa™_ev’t_š‹¼u±ibË
(
æ
->
æ_wa™
, !æ->
æ_Ãxt
);

1825 ià(!
”rÜ
)

1828 
	`locks_d–‘e_block
(
æ
);

1832  
”rÜ
;

1833 
	}
}

1838 
	$fú_£k
(
fd
, 
fe
 *
fp
, 
cmd
,

1839 
æock
 
__u£r
 *
l
)

1841 
fe_lock
 *fe_lock = 
	`locks_®loc_lock
();

1842 
æock
 flock;

1843 
šode
 *inode;

1844 
fe
 *
f
;

1845 
”rÜ
;

1847 ià(
fe_lock
 =ğ
NULL
)

1848  -
ENOLCK
;

1853 
”rÜ
 = -
EFAULT
;

1854 ià(
	`cİy_äom_u£r
(&
æock
, 
l
, (flock)))

1855 
out
;

1857 
šode
 = 
fp
->
f_·th
.
d’Œy
->
d_šode
;

1862 ià(
	`mªd©Üy_lock
(
šode
è&& 
	`m­pšg_wr™ably_m­³d
(
fp
->
f_m­pšg
)) {

1863 
”rÜ
 = -
EAGAIN
;

1864 
out
;

1867 
agaš
:

1868 
”rÜ
 = 
	`æock_to_posix_lock
(
fp
, 
fe_lock
, &
æock
);

1869 ià(
”rÜ
)

1870 
out
;

1871 ià(
cmd
 =ğ
F_SETLKW
) {

1872 
fe_lock
->
æ_æags
 |ğ
FL_SLEEP
;

1875 
”rÜ
 = -
EBADF
;

1876 
æock
.
l_ty³
) {

1877 
F_RDLCK
:

1878 ià(!(
fp
->
f_mode
 & 
FMODE_READ
))

1879 
out
;

1881 
F_WRLCK
:

1882 ià(!(
fp
->
f_mode
 & 
FMODE_WRITE
))

1883 
out
;

1885 
F_UNLCK
:

1888 
”rÜ
 = -
EINVAL
;

1889 
out
;

1892 
”rÜ
 = 
	`do_lock_fe_wa™
(
fp
, 
cmd
, 
fe_lock
);

1903 
	`¥š_lock
(&
cu¼’t
->
fes
->
fe_lock
);

1904 
f
 = 
	`fcheck
(
fd
);

1905 
	`¥š_uÆock
(&
cu¼’t
->
fes
->
fe_lock
);

1906 ià(!
”rÜ
 && 
f
 !ğ
fp
 && 
æock
.
l_ty³
 !ğ
F_UNLCK
) {

1907 
æock
.
l_ty³
 = 
F_UNLCK
;

1908 
agaš
;

1911 
out
:

1912 
	`locks_ä“_lock
(
fe_lock
);

1913  
”rÜ
;

1914 
	}
}

1916 #ià
BITS_PER_LONG
 == 32

1920 
	$fú_g‘lk64
(
fe
 *
fp
, 
æock64
 
__u£r
 *
l
)

1922 
fe_lock
 file_lock;

1923 
æock64
 
æock
;

1924 
”rÜ
;

1926 
”rÜ
 = -
EFAULT
;

1927 ià(
	`cİy_äom_u£r
(&
æock
, 
l
, (flock)))

1928 
out
;

1929 
”rÜ
 = -
EINVAL
;

1930 ià((
æock
.
l_ty³
 !ğ
F_RDLCK
è&& (æock.l_ty³ !ğ
F_WRLCK
))

1931 
out
;

1933 
”rÜ
 = 
	`æock64_to_posix_lock
(
fp
, &
fe_lock
, &
æock
);

1934 ià(
”rÜ
)

1935 
out
;

1937 
”rÜ
 = 
	`vfs_‹¡_lock
(
fp
, &
fe_lock
);

1938 ià(
”rÜ
)

1939 
out
;

1941 
æock
.
l_ty³
 = 
fe_lock
.
æ_ty³
;

1942 ià(
fe_lock
.
æ_ty³
 !ğ
F_UNLCK
)

1943 
	`posix_lock_to_æock64
(&
æock
, &
fe_lock
);

1945 
”rÜ
 = -
EFAULT
;

1946 ià(!
	`cİy_to_u£r
(
l
, &
æock
, (flock)))

1947 
”rÜ
 = 0;

1949 
out
:

1950  
”rÜ
;

1951 
	}
}

1956 
	$fú_£k64
(
fd
, 
fe
 *
fp
, 
cmd
,

1957 
æock64
 
__u£r
 *
l
)

1959 
fe_lock
 *fe_lock = 
	`locks_®loc_lock
();

1960 
æock64
 
æock
;

1961 
šode
 *inode;

1962 
fe
 *
f
;

1963 
”rÜ
;

1965 ià(
fe_lock
 =ğ
NULL
)

1966  -
ENOLCK
;

1971 
”rÜ
 = -
EFAULT
;

1972 ià(
	`cİy_äom_u£r
(&
æock
, 
l
, (flock)))

1973 
out
;

1975 
šode
 = 
fp
->
f_·th
.
d’Œy
->
d_šode
;

1980 ià(
	`mªd©Üy_lock
(
šode
è&& 
	`m­pšg_wr™ably_m­³d
(
fp
->
f_m­pšg
)) {

1981 
”rÜ
 = -
EAGAIN
;

1982 
out
;

1985 
agaš
:

1986 
”rÜ
 = 
	`æock64_to_posix_lock
(
fp
, 
fe_lock
, &
æock
);

1987 ià(
”rÜ
)

1988 
out
;

1989 ià(
cmd
 =ğ
F_SETLKW64
) {

1990 
fe_lock
->
æ_æags
 |ğ
FL_SLEEP
;

1993 
”rÜ
 = -
EBADF
;

1994 
æock
.
l_ty³
) {

1995 
F_RDLCK
:

1996 ià(!(
fp
->
f_mode
 & 
FMODE_READ
))

1997 
out
;

1999 
F_WRLCK
:

2000 ià(!(
fp
->
f_mode
 & 
FMODE_WRITE
))

2001 
out
;

2003 
F_UNLCK
:

2006 
”rÜ
 = -
EINVAL
;

2007 
out
;

2010 
”rÜ
 = 
	`do_lock_fe_wa™
(
fp
, 
cmd
, 
fe_lock
);

2016 
	`¥š_lock
(&
cu¼’t
->
fes
->
fe_lock
);

2017 
f
 = 
	`fcheck
(
fd
);

2018 
	`¥š_uÆock
(&
cu¼’t
->
fes
->
fe_lock
);

2019 ià(!
”rÜ
 && 
f
 !ğ
fp
 && 
æock
.
l_ty³
 !ğ
F_UNLCK
) {

2020 
æock
.
l_ty³
 = 
F_UNLCK
;

2021 
agaš
;

2024 
out
:

2025 
	`locks_ä“_lock
(
fe_lock
);

2026  
”rÜ
;

2027 
	}
}

2035 
	$locks_»move_posix
(
fe
 *
fp
, 
æ_owÃr_t
 
owÃr
)

2037 
fe_lock
 
lock
;

2044 ià(!
fp
->
f_·th
.
d’Œy
->
d_šode
->
i_æock
)

2047 
lock
.
æ_ty³
 = 
F_UNLCK
;

2048 
lock
.
æ_æags
 = 
FL_POSIX
 | 
FL_CLOSE
;

2049 
lock
.
æ_¡¬t
 = 0;

2050 
lock
.
æ_’d
 = 
OFFSET_MAX
;

2051 
lock
.
æ_owÃr
 = 
owÃr
;

2052 
lock
.
æ_pid
 = 
cu¼’t
->
tgid
;

2053 
lock
.
æ_fe
 = 
fp
;

2054 
lock
.
æ_İs
 = 
NULL
;

2055 
lock
.
æ_lmİs
 = 
NULL
;

2057 
	`vfs_lock_fe
(
fp
, 
F_SETLK
, &
lock
, 
NULL
);

2059 ià(
lock
.
æ_İs
 &&†ock.æ_İs->
æ_»Ëa£_´iv©e
)

2060 
lock
.
æ_İs
->
	`æ_»Ëa£_´iv©e
(&lock);

2061 
	}
}

2063 
EXPORT_SYMBOL
(
locks_»move_posix
);

2068 
	$locks_»move_æock
(
fe
 *
fp
)

2070 
šode
 * inodğ
fp
->
f_·th
.
d’Œy
->
d_šode
;

2071 
fe_lock
 *
æ
;

2072 
fe_lock
 **
befÜe
;

2074 ià(!
šode
->
i_æock
)

2077 ià(
fp
->
f_İ
 && fp->f_İ->
æock
) {

2078 
fe_lock
 
æ
 = {

2079 .
æ_pid
 = 
cu¼’t
->
tgid
,

2080 .
æ_fe
 = 
fp
,

2081 .
æ_æags
 = 
FL_FLOCK
,

2082 .
æ_ty³
 = 
F_UNLCK
,

2083 .
æ_’d
 = 
OFFSET_MAX
,

2085 
fp
->
f_İ
->
	`æock
(fp, 
F_SETLKW
, &
æ
);

2086 ià(
æ
.
æ_İs
 && fl.æ_İs->
æ_»Ëa£_´iv©e
)

2087 
æ
.
æ_İs
->
	`æ_»Ëa£_´iv©e
(&fl);

2090 
	`lock_æocks
();

2091 
befÜe
 = &
šode
->
i_æock
;

2093 (
æ
 = *
befÜe
è!ğ
NULL
) {

2094 ià(
æ
->
æ_fe
 =ğ
fp
) {

2095 ià(
	`IS_FLOCK
(
æ
)) {

2096 
	`locks_d–‘e_lock
(
befÜe
);

2099 ià(
	`IS_LEASE
(
æ
)) {

2100 
	`Ëa£_modify
(
befÜe
, 
F_UNLCK
);

2104 
	`BUG
();

2106 
befÜe
 = &
æ
->
æ_Ãxt
;

2108 
	`uÆock_æocks
();

2109 
	}
}

2119 
	$posix_unblock_lock
(
fe
 *
fp
, 
fe_lock
 *
wa™”
)

2121 
¡©us
 = 0;

2123 
	`lock_æocks
();

2124 ià(
wa™”
->
æ_Ãxt
)

2125 
	`__locks_d–‘e_block
(
wa™”
);

2127 
¡©us
 = -
ENOENT
;

2128 
	`uÆock_æocks
();

2129  
¡©us
;

2130 
	}
}

2132 
EXPORT_SYMBOL
(
posix_unblock_lock
);

2141 
	$vfs_ÿnûl_lock
(
fe
 *
fp
, 
fe_lock
 *
æ
)

2143 ià(
fp
->
f_İ
 && fp->f_İ->
lock
)

2144  
fp
->
f_İ
->
	`lock
(fp, 
F_CANCELLK
, 
æ
);

2146 
	}
}

2148 
EXPORT_SYMBOL_GPL
(
vfs_ÿnûl_lock
);

2150 #ifdeà
CONFIG_PROC_FS


2151 
	~<lšux/´oc_fs.h
>

2152 
	~<lšux/£q_fe.h
>

2154 
	$lock_g‘_¡©us
(
£q_fe
 *
f
, 
fe_lock
 *
æ
,

2155 
loff_t
 
id
, *
pfx
)

2157 
šode
 *šodğ
NULL
;

2158 
æ_pid
;

2160 ià(
æ
->
æ_n¥id
)

2161 
æ_pid
 = 
	`pid_vÄ
(
æ
->
æ_n¥id
);

2163 
æ_pid
 = 
æ
->fl_pid;

2165 ià(
æ
->
æ_fe
 !ğ
NULL
)

2166 
šode
 = 
æ
->
æ_fe
->
f_·th
.
d’Œy
->
d_šode
;

2168 
	`£q_´štf
(
f
, "%Îd:% ", 
id
, 
pfx
);

2169 ià(
	`IS_POSIX
(
æ
)) {

2170 
	`£q_´štf
(
f
, "%6s %s ",

2171 (
æ
->
æ_æags
 & 
FL_ACCESS
) ? "ACCESS" : "POSIX ",

2172 (
šode
 =ğ
NULL
) ? "*NOINODE*" :

2173 
	`mªd©Üy_lock
(
šode
) ? "MANDATORY" : "ADVISORY ");

2174 } ià(
	`IS_FLOCK
(
æ
)) {

2175 ià(
æ
->
æ_ty³
 & 
LOCK_MAND
) {

2176 
	`£q_´štf
(
f
, "FLOCK MSNFS ");

2178 
	`£q_´štf
(
f
, "FLOCK ADVISORY ");

2180 } ià(
	`IS_LEASE
(
æ
)) {

2181 
	`£q_´štf
(
f
, "LEASE ");

2182 ià(
	`Ëa£_b»akšg
(
æ
))

2183 
	`£q_´štf
(
f
, "BREAKING ");

2184 ià(
æ
->
æ_fe
)

2185 
	`£q_´štf
(
f
, "ACTIVE ");

2187 
	`£q_´štf
(
f
, "BREAKER ");

2189 
	`£q_´štf
(
f
, "UNKNOWN UNKNOWN ");

2191 ià(
æ
->
æ_ty³
 & 
LOCK_MAND
) {

2192 
	`£q_´štf
(
f
, "%s ",

2193 (
æ
->
æ_ty³
 & 
LOCK_READ
)

2194 ? (
æ
->
æ_ty³
 & 
LOCK_WRITE
) ? "RW " : "READ "

2195 : (
æ
->
æ_ty³
 & 
LOCK_WRITE
) ? "WRITE" : "NONE ");

2197 
	`£q_´štf
(
f
, "%s ",

2198 (
	`Ëa£_b»akšg
(
æ
))

2199 ? (
æ
->
æ_ty³
 & 
F_UNLCK
) ? "UNLCK" : "READ "

2200 : (
æ
->
æ_ty³
 & 
F_WRLCK
) ? "WRITE" : "READ ");

2202 ià(
šode
) {

2203 #ifdeà
WE_CAN_BREAK_LSLK_NOW


2204 
	`£q_´štf
(
f
, "%d %s:%ld ", 
æ_pid
,

2205 
šode
->
i_sb
->
s_id
, inode->
i_šo
);

2208 
	`£q_´štf
(
f
, "%d %02x:%02x:%ld ", 
æ_pid
,

2209 
	`MAJOR
(
šode
->
i_sb
->
s_dev
),

2210 
	`MINOR
(
šode
->
i_sb
->
s_dev
), inode->
i_šo
);

2213 
	`£q_´štf
(
f
, "%d <nÚe>:0 ", 
æ_pid
);

2215 ià(
	`IS_POSIX
(
æ
)) {

2216 ià(
æ
->
æ_’d
 =ğ
OFFSET_MAX
)

2217 
	`£q_´štf
(
f
, "%Ld EOF\n", 
æ
->
æ_¡¬t
);

2219 
	`£q_´štf
(
f
, "%Ld %Ld\n", 
æ
->
æ_¡¬t
, fl->
æ_’d
);

2221 
	`£q_´štf
(
f
, "0 EOF\n");

2223 
	}
}

2225 
	$locks_show
(
£q_fe
 *
f
, *
v
)

2227 
fe_lock
 *
æ
, *
bæ
;

2229 
æ
 = 
	`li¡_’Œy
(
v
, 
fe_lock
, 
æ_lšk
);

2231 
	`lock_g‘_¡©us
(
f
, 
æ
, *((
loff_t
 *)f->
´iv©e
), "");

2233 
	`li¡_fÜ_—ch_’Œy
(
bæ
, &
æ
->
æ_block
, fl_block)

2234 
	`lock_g‘_¡©us
(
f
, 
bæ
, *((
loff_t
 *)f->
´iv©e
), " ->");

2237 
	}
}

2239 *
	$locks_¡¬t
(
£q_fe
 *
f
, 
loff_t
 *
pos
)

2241 
loff_t
 *
p
 = 
f
->
´iv©e
;

2243 
	`lock_æocks
();

2244 *
p
 = (*
pos
 + 1);

2245  
	`£q_li¡_¡¬t
(&
fe_lock_li¡
, *
pos
);

2246 
	}
}

2248 *
	$locks_Ãxt
(
£q_fe
 *
f
, *
v
, 
loff_t
 *
pos
)

2250 
loff_t
 *
p
 = 
f
->
´iv©e
;

2251 ++*
p
;

2252  
	`£q_li¡_Ãxt
(
v
, &
fe_lock_li¡
, 
pos
);

2253 
	}
}

2255 
	$locks_¡İ
(
£q_fe
 *
f
, *
v
)

2257 
	`uÆock_æocks
();

2258 
	}
}

2260 cÚ¡ 
£q_İ”©iÚs
 
	glocks_£q_İ”©iÚs
 = {

2261 .
¡¬t
 = 
locks_¡¬t
,

2262 .
	gÃxt
 = 
locks_Ãxt
,

2263 .
	g¡İ
 = 
locks_¡İ
,

2264 .
	gshow
 = 
locks_show
,

2267 
	$locks_İ’
(
šode
 *šode, 
fe
 *
fp
)

2269  
	`£q_İ’_´iv©e
(
fp
, &
locks_£q_İ”©iÚs
, (
loff_t
));

2270 
	}
}

2272 cÚ¡ 
fe_İ”©iÚs
 
	g´oc_locks_İ”©iÚs
 = {

2273 .
İ’
 = 
locks_İ’
,

2274 .
	g»ad
 = 
£q_»ad
,

2275 .
	gÎ£ek
 = 
£q_l£ek
,

2276 .
	g»Ëa£
 = 
£q_»Ëa£_´iv©e
,

2279 
__š™
 
	$´oc_locks_š™
()

2281 
	`´oc_ü—‹
("locks", 0, 
NULL
, &
´oc_locks_İ”©iÚs
);

2283 
	}
}

2284 
moduË_š™
(
´oc_locks_š™
);

2300 
	$lock_may_»ad
(
šode
 *šode, 
loff_t
 
¡¬t
, 
Ën
)

2302 
fe_lock
 *
æ
;

2303 
»suÉ
 = 1;

2304 
	`lock_æocks
();

2305 
æ
 = 
šode
->
i_æock
; fÈ!ğ
NULL
; fÈğæ->
æ_Ãxt
) {

2306 ià(
	`IS_POSIX
(
æ
)) {

2307 ià(
æ
->
æ_ty³
 =ğ
F_RDLCK
)

2309 ià((
æ
->
æ_’d
 < 
¡¬t
è|| (æ->
æ_¡¬t
 > (¡¬ˆ+ 
Ën
)))

2311 } ià(
	`IS_FLOCK
(
æ
)) {

2312 ià(!(
æ
->
æ_ty³
 & 
LOCK_MAND
))

2314 ià(
æ
->
æ_ty³
 & 
LOCK_READ
)

2318 
»suÉ
 = 0;

2321 
	`uÆock_æocks
();

2322  
»suÉ
;

2323 
	}
}

2325 
EXPORT_SYMBOL
(
lock_may_»ad
);

2340 
	$lock_may_wr™e
(
šode
 *šode, 
loff_t
 
¡¬t
, 
Ën
)

2342 
fe_lock
 *
æ
;

2343 
»suÉ
 = 1;

2344 
	`lock_æocks
();

2345 
æ
 = 
šode
->
i_æock
; fÈ!ğ
NULL
; fÈğæ->
æ_Ãxt
) {

2346 ià(
	`IS_POSIX
(
æ
)) {

2347 ià((
æ
->
æ_’d
 < 
¡¬t
è|| (æ->
æ_¡¬t
 > (¡¬ˆ+ 
Ën
)))

2349 } ià(
	`IS_FLOCK
(
æ
)) {

2350 ià(!(
æ
->
æ_ty³
 & 
LOCK_MAND
))

2352 ià(
æ
->
æ_ty³
 & 
LOCK_WRITE
)

2356 
»suÉ
 = 0;

2359 
	`uÆock_æocks
();

2360  
»suÉ
;

2361 
	}
}

2363 
EXPORT_SYMBOL
(
lock_may_wr™e
);

2365 
__š™
 
	$f–ock_š™
()

2367 
f–ock_ÿche
 = 
	`kmem_ÿche_ü—‹
("file_lock_cache",

2368 (
fe_lock
), 0, 
SLAB_PANIC
, 
NULL
);

2371 
	}
}

2373 
cÜe_š™ÿÎ
(
f–ock_š™
);

	@mbcache.c

29 
	~<lšux/k”Ãl.h
>

30 
	~<lšux/moduË.h
>

32 
	~<lšux/hash.h
>

33 
	~<lšux/fs.h
>

34 
	~<lšux/mm.h
>

35 
	~<lšux/¦ab.h
>

36 
	~<lšux/sched.h
>

37 
	~<lšux/š™.h
>

38 
	~<lšux/mbÿche.h
>

41 #ifdeà
MB_CACHE_DEBUG


42 
	#mb_debug
(
f
...) do { \

43 
	`´štk
(
KERN_DEBUG
 
f
); \

44 
	`´štk
("\n"); \

45 } 0)

	)

46 
	#mb_as£¹
(
c
) do { if (!(c)) \

47 
	`´štk
(
KERN_ERR
 "assertion " #c " failed\n"); \

48 } 0)

	)

50 
	#mb_debug
(
f
...èdØ{ } 0)

	)

51 
	#mb_as£¹
(
c
èdØ{ } 0)

	)

53 
	#mb_”rÜ
(
f
...) do { \

54 
	`´štk
(
KERN_ERR
 
f
); \

55 
	`´štk
("\n"); \

56 } 0)

	)

58 
	#MB_CACHE_WRITER
 (()~0U >> 1)

	)

60 
DECLARE_WAIT_QUEUE_HEAD
(
mb_ÿche_queue
);

62 
MODULE_AUTHOR
("Andreas Gruenbacher <a.gruenbacher@computer.org>");

63 
MODULE_DESCRIPTION
("Meta block cache (forƒxtended‡ttributes)");

64 
MODULE_LICENSE
("GPL");

66 
EXPORT_SYMBOL
(
mb_ÿche_ü—‹
);

67 
EXPORT_SYMBOL
(
mb_ÿche_shršk
);

68 
EXPORT_SYMBOL
(
mb_ÿche_de¡roy
);

69 
EXPORT_SYMBOL
(
mb_ÿche_’Œy_®loc
);

70 
EXPORT_SYMBOL
(
mb_ÿche_’Œy_š£¹
);

71 
EXPORT_SYMBOL
(
mb_ÿche_’Œy_»Ëa£
);

72 
EXPORT_SYMBOL
(
mb_ÿche_’Œy_ä“
);

73 
EXPORT_SYMBOL
(
mb_ÿche_’Œy_g‘
);

74 #ià!
defšed
(
MB_CACHE_INDEXES_COUNT
) || (MB_CACHE_INDEXES_COUNT > 0)

75 
EXPORT_SYMBOL
(
mb_ÿche_’Œy_fšd_fœ¡
);

76 
EXPORT_SYMBOL
(
mb_ÿche_’Œy_fšd_Ãxt
);

85 
LIST_HEAD
(
mb_ÿche_li¡
);

86 
LIST_HEAD
(
mb_ÿche_Ìu_li¡
);

87 
DEFINE_SPINLOCK
(
mb_ÿche_¥šlock
);

93 
mb_ÿche_shršk_â
(
shršk”
 *
shršk
,

94 
shršk_cÚŒŞ
 *
sc
);

96 
shršk”
 
	gmb_ÿche_shršk”
 = {

97 .
shršk
 = 
mb_ÿche_shršk_â
,

98 .
	g£eks
 = 
DEFAULT_SEEKS
,

101 
šlše
 

102 
	$__mb_ÿche_’Œy_is_hashed
(
mb_ÿche_’Œy
 *
û
)

104  !
	`li¡_em±y
(&
û
->
e_block_li¡
);

105 
	}
}

109 
	$__mb_ÿche_’Œy_unhash
(
mb_ÿche_’Œy
 *
û
)

111 ià(
	`__mb_ÿche_’Œy_is_hashed
(
û
)) {

112 
	`li¡_d–_š™
(&
û
->
e_block_li¡
);

113 
	`li¡_d–
(&
û
->
e_šdex
.
o_li¡
);

115 
	}
}

119 
	$__mb_ÿche_’Œy_fÜg‘
(
mb_ÿche_’Œy
 *
û
, 
gå_t
 
gå_mask
)

121 
mb_ÿche
 *
ÿche
 = 
û
->
e_ÿche
;

123 
	`mb_as£¹
(!(
û
->
e_u£d
 || ce->
e_queued
));

124 
	`kmem_ÿche_ä“
(
ÿche
->
c_’Œy_ÿche
, 
û
);

125 
	`©omic_dec
(&
ÿche
->
c_’Œy_couÁ
);

126 
	}
}

130 
	$__mb_ÿche_’Œy_»Ëa£_uÆock
(
mb_ÿche_’Œy
 *
û
)

131 
	$__»Ëa£s
(
mb_ÿche_¥šlock
)

134 ià(
û
->
e_queued
)

135 
	`wake_up_®l
(&
mb_ÿche_queue
);

136 ià(
û
->
e_u£d
 >ğ
MB_CACHE_WRITER
)

137 
û
->
e_u£d
 -ğ
MB_CACHE_WRITER
;

138 
û
->
e_u£d
--;

139 ià(!(
û
->
e_u£d
 || ce->
e_queued
)) {

140 ià(!
	`__mb_ÿche_’Œy_is_hashed
(
û
))

141 
fÜg‘
;

142 
	`mb_as£¹
(
	`li¡_em±y
(&
û
->
e_Ìu_li¡
));

143 
	`li¡_add_
(&
û
->
e_Ìu_li¡
, &
mb_ÿche_Ìu_li¡
);

145 
	`¥š_uÆock
(&
mb_ÿche_¥šlock
);

147 
fÜg‘
:

148 
	`¥š_uÆock
(&
mb_ÿche_¥šlock
);

149 
	`__mb_ÿche_’Œy_fÜg‘
(
û
, 
GFP_KERNEL
);

150 
	}
}

165 
	$mb_ÿche_shršk_â
(
shršk”
 *
shršk
, 
shršk_cÚŒŞ
 *
sc
)

167 
	`LIST_HEAD
(
ä“_li¡
);

168 
mb_ÿche
 *
ÿche
;

169 
mb_ÿche_’Œy
 *
’Œy
, *
tmp
;

170 
couÁ
 = 0;

171 
Ä_to_sÿn
 = 
sc
->nr_to_scan;

172 
gå_t
 
gå_mask
 = 
sc
->gfp_mask;

174 
	`mb_debug
("ŒyšgØä“ %dƒÁr›s", 
Ä_to_sÿn
);

175 
	`¥š_lock
(&
mb_ÿche_¥šlock
);

176 
Ä_to_sÿn
-- && !
	`li¡_em±y
(&
mb_ÿche_Ìu_li¡
)) {

177 
mb_ÿche_’Œy
 *
û
 =

178 
	`li¡_’Œy
(
mb_ÿche_Ìu_li¡
.
Ãxt
,

179 
mb_ÿche_’Œy
, 
e_Ìu_li¡
);

180 
	`li¡_move_
(&
û
->
e_Ìu_li¡
, &
ä“_li¡
);

181 
	`__mb_ÿche_’Œy_unhash
(
û
);

183 
	`li¡_fÜ_—ch_’Œy
(
ÿche
, &
mb_ÿche_li¡
, 
c_ÿche_li¡
) {

184 
	`mb_debug
("ÿch% (%d)", 
ÿche
->
c_Çme
,

185 
	`©omic_»ad
(&
ÿche
->
c_’Œy_couÁ
));

186 
couÁ
 +ğ
	`©omic_»ad
(&
ÿche
->
c_’Œy_couÁ
);

188 
	`¥š_uÆock
(&
mb_ÿche_¥šlock
);

189 
	`li¡_fÜ_—ch_’Œy_§ã
(
’Œy
, 
tmp
, &
ä“_li¡
, 
e_Ìu_li¡
) {

190 
	`__mb_ÿche_’Œy_fÜg‘
(
’Œy
, 
gå_mask
);

192  (
couÁ
 / 100è* 
sysùl_vfs_ÿche_´essu»
;

193 
	}
}

207 
mb_ÿche
 *

208 
	$mb_ÿche_ü—‹
(cÚ¡ *
Çme
, 
buck‘_b™s
)

210 
n
, 
buck‘_couÁ
 = 1 << 
buck‘_b™s
;

211 
mb_ÿche
 *
ÿche
 = 
NULL
;

213 
ÿche
 = 
	`km®loc
((
mb_ÿche
), 
GFP_KERNEL
);

214 ià(!
ÿche
)

215  
NULL
;

216 
ÿche
->
c_Çme
 = 
Çme
;

217 
	`©omic_£t
(&
ÿche
->
c_’Œy_couÁ
, 0);

218 
ÿche
->
c_buck‘_b™s
 = 
buck‘_b™s
;

219 
ÿche
->
c_block_hash
 = 
	`km®loc
(
buck‘_couÁ
 * (
li¡_h—d
),

220 
GFP_KERNEL
);

221 ià(!
ÿche
->
c_block_hash
)

222 
ç
;

223 
n
=0;‚<
buck‘_couÁ
;‚++)

224 
	`INIT_LIST_HEAD
(&
ÿche
->
c_block_hash
[
n
]);

225 
ÿche
->
c_šdex_hash
 = 
	`km®loc
(
buck‘_couÁ
 * (
li¡_h—d
),

226 
GFP_KERNEL
);

227 ià(!
ÿche
->
c_šdex_hash
)

228 
ç
;

229 
n
=0;‚<
buck‘_couÁ
;‚++)

230 
	`INIT_LIST_HEAD
(&
ÿche
->
c_šdex_hash
[
n
]);

231 
ÿche
->
c_’Œy_ÿche
 = 
	`kmem_ÿche_ü—‹
(
Çme
,

232 (
mb_ÿche_’Œy
), 0,

233 
SLAB_RECLAIM_ACCOUNT
|
SLAB_MEM_SPREAD
, 
NULL
);

234 ià(!
ÿche
->
c_’Œy_ÿche
)

235 
ç2
;

241 
ÿche
->
c_max_’Œ›s
 = 
buck‘_couÁ
 << 4;

243 
	`¥š_lock
(&
mb_ÿche_¥šlock
);

244 
	`li¡_add
(&
ÿche
->
c_ÿche_li¡
, &
mb_ÿche_li¡
);

245 
	`¥š_uÆock
(&
mb_ÿche_¥šlock
);

246  
ÿche
;

248 
ç2
:

249 
	`kä“
(
ÿche
->
c_šdex_hash
);

251 
ç
:

252 
	`kä“
(
ÿche
->
c_block_hash
);

253 
	`kä“
(
ÿche
);

254  
NULL
;

255 
	}
}

268 
	$mb_ÿche_shršk
(
block_deviû
 *
bdev
)

270 
	`LIST_HEAD
(
ä“_li¡
);

271 
li¡_h—d
 *
l
, *
Émp
;

273 
	`¥š_lock
(&
mb_ÿche_¥šlock
);

274 
	`li¡_fÜ_—ch_§ã
(
l
, 
Émp
, &
mb_ÿche_Ìu_li¡
) {

275 
mb_ÿche_’Œy
 *
û
 =

276 
	`li¡_’Œy
(
l
, 
mb_ÿche_’Œy
, 
e_Ìu_li¡
);

277 ià(
û
->
e_bdev
 =ğ
bdev
) {

278 
	`li¡_move_
(&
û
->
e_Ìu_li¡
, &
ä“_li¡
);

279 
	`__mb_ÿche_’Œy_unhash
(
û
);

282 
	`¥š_uÆock
(&
mb_ÿche_¥šlock
);

283 
	`li¡_fÜ_—ch_§ã
(
l
, 
Émp
, &
ä“_li¡
) {

284 
	`__mb_ÿche_’Œy_fÜg‘
(
	`li¡_’Œy
(
l
, 
mb_ÿche_’Œy
,

285 
e_Ìu_li¡
), 
GFP_KERNEL
);

287 
	}
}

298 
	$mb_ÿche_de¡roy
(
mb_ÿche
 *
ÿche
)

300 
	`LIST_HEAD
(
ä“_li¡
);

301 
li¡_h—d
 *
l
, *
Émp
;

303 
	`¥š_lock
(&
mb_ÿche_¥šlock
);

304 
	`li¡_fÜ_—ch_§ã
(
l
, 
Émp
, &
mb_ÿche_Ìu_li¡
) {

305 
mb_ÿche_’Œy
 *
û
 =

306 
	`li¡_’Œy
(
l
, 
mb_ÿche_’Œy
, 
e_Ìu_li¡
);

307 ià(
û
->
e_ÿche
 =ğ
ÿche
) {

308 
	`li¡_move_
(&
û
->
e_Ìu_li¡
, &
ä“_li¡
);

309 
	`__mb_ÿche_’Œy_unhash
(
û
);

312 
	`li¡_d–
(&
ÿche
->
c_ÿche_li¡
);

313 
	`¥š_uÆock
(&
mb_ÿche_¥šlock
);

315 
	`li¡_fÜ_—ch_§ã
(
l
, 
Émp
, &
ä“_li¡
) {

316 
	`__mb_ÿche_’Œy_fÜg‘
(
	`li¡_’Œy
(
l
, 
mb_ÿche_’Œy
,

317 
e_Ìu_li¡
), 
GFP_KERNEL
);

320 ià(
	`©omic_»ad
(&
ÿche
->
c_’Œy_couÁ
) > 0) {

321 
	`mb_”rÜ
("cache %s: %d orphanedƒntries",

322 
ÿche
->
c_Çme
,

323 
	`©omic_»ad
(&
ÿche
->
c_’Œy_couÁ
));

326 
	`kmem_ÿche_de¡roy
(
ÿche
->
c_’Œy_ÿche
);

328 
	`kä“
(
ÿche
->
c_šdex_hash
);

329 
	`kä“
(
ÿche
->
c_block_hash
);

330 
	`kä“
(
ÿche
);

331 
	}
}

341 
mb_ÿche_’Œy
 *

342 
	$mb_ÿche_’Œy_®loc
(
mb_ÿche
 *
ÿche
, 
gå_t
 
gå_æags
)

344 
mb_ÿche_’Œy
 *
û
 = 
NULL
;

346 ià(
	`©omic_»ad
(&
ÿche
->
c_’Œy_couÁ
è>ğÿche->
c_max_’Œ›s
) {

347 
	`¥š_lock
(&
mb_ÿche_¥šlock
);

348 ià(!
	`li¡_em±y
(&
mb_ÿche_Ìu_li¡
)) {

349 
û
 = 
	`li¡_’Œy
(
mb_ÿche_Ìu_li¡
.
Ãxt
,

350 
mb_ÿche_’Œy
, 
e_Ìu_li¡
);

351 
	`li¡_d–_š™
(&
û
->
e_Ìu_li¡
);

352 
	`__mb_ÿche_’Œy_unhash
(
û
);

354 
	`¥š_uÆock
(&
mb_ÿche_¥šlock
);

356 ià(!
û
) {

357 
û
 = 
	`kmem_ÿche_®loc
(
ÿche
->
c_’Œy_ÿche
, 
gå_æags
);

358 ià(!
û
)

359  
NULL
;

360 
	`©omic_šc
(&
ÿche
->
c_’Œy_couÁ
);

361 
	`INIT_LIST_HEAD
(&
û
->
e_Ìu_li¡
);

362 
	`INIT_LIST_HEAD
(&
û
->
e_block_li¡
);

363 
û
->
e_ÿche
 = 
ÿche
;

364 
û
->
e_queued
 = 0;

366 
û
->
e_u£d
 = 1 + 
MB_CACHE_WRITER
;

367  
û
;

368 
	}
}

386 
	$mb_ÿche_’Œy_š£¹
(
mb_ÿche_’Œy
 *
û
, 
block_deviû
 *
bdev
,

387 
£ùÜ_t
 
block
, 
key
)

389 
mb_ÿche
 *
ÿche
 = 
û
->
e_ÿche
;

390 
buck‘
;

391 
li¡_h—d
 *
l
;

392 
”rÜ
 = -
EBUSY
;

394 
buck‘
 = 
	`hash_lÚg
(()
bdev
 + (
block
 & 0xffffffff),

395 
ÿche
->
c_buck‘_b™s
);

396 
	`¥š_lock
(&
mb_ÿche_¥šlock
);

397 
	`li¡_fÜ_—ch_´ev
(
l
, &
ÿche
->
c_block_hash
[
buck‘
]) {

398 
mb_ÿche_’Œy
 *
û
 =

399 
	`li¡_’Œy
(
l
, 
mb_ÿche_’Œy
, 
e_block_li¡
);

400 ià(
û
->
e_bdev
 =ğ
bdev
 && ce->
e_block
 =ğ
block
)

401 
out
;

403 
	`__mb_ÿche_’Œy_unhash
(
û
);

404 
û
->
e_bdev
 = 
bdev
;

405 
û
->
e_block
 = 
block
;

406 
	`li¡_add
(&
û
->
e_block_li¡
, &
ÿche
->
c_block_hash
[
buck‘
]);

407 
û
->
e_šdex
.
o_key
 = 
key
;

408 
buck‘
 = 
	`hash_lÚg
(
key
, 
ÿche
->
c_buck‘_b™s
);

409 
	`li¡_add
(&
û
->
e_šdex
.
o_li¡
, &
ÿche
->
c_šdex_hash
[
buck‘
]);

410 
”rÜ
 = 0;

411 
out
:

412 
	`¥š_uÆock
(&
mb_ÿche_¥šlock
);

413  
”rÜ
;

414 
	}
}

425 
	$mb_ÿche_’Œy_»Ëa£
(
mb_ÿche_’Œy
 *
û
)

427 
	`¥š_lock
(&
mb_ÿche_¥šlock
);

428 
	`__mb_ÿche_’Œy_»Ëa£_uÆock
(
û
);

429 
	}
}

439 
	$mb_ÿche_’Œy_ä“
(
mb_ÿche_’Œy
 *
û
)

441 
	`¥š_lock
(&
mb_ÿche_¥šlock
);

442 
	`mb_as£¹
(
	`li¡_em±y
(&
û
->
e_Ìu_li¡
));

443 
	`__mb_ÿche_’Œy_unhash
(
û
);

444 
	`__mb_ÿche_’Œy_»Ëa£_uÆock
(
û
);

445 
	}
}

456 
mb_ÿche_’Œy
 *

457 
	$mb_ÿche_’Œy_g‘
(
mb_ÿche
 *
ÿche
, 
block_deviû
 *
bdev
,

458 
£ùÜ_t
 
block
)

460 
buck‘
;

461 
li¡_h—d
 *
l
;

462 
mb_ÿche_’Œy
 *
û
;

464 
buck‘
 = 
	`hash_lÚg
(()
bdev
 + (
block
 & 0xffffffff),

465 
ÿche
->
c_buck‘_b™s
);

466 
	`¥š_lock
(&
mb_ÿche_¥šlock
);

467 
	`li¡_fÜ_—ch
(
l
, &
ÿche
->
c_block_hash
[
buck‘
]) {

468 
û
 = 
	`li¡_’Œy
(
l
, 
mb_ÿche_’Œy
, 
e_block_li¡
);

469 ià(
û
->
e_bdev
 =ğ
bdev
 && ce->
e_block
 =ğ
block
) {

470 
	`DEFINE_WAIT
(
wa™
);

472 ià(!
	`li¡_em±y
(&
û
->
e_Ìu_li¡
))

473 
	`li¡_d–_š™
(&
û
->
e_Ìu_li¡
);

475 
û
->
e_u£d
 > 0) {

476 
û
->
e_queued
++;

477 
	`´•¬e_to_wa™
(&
mb_ÿche_queue
, &
wa™
,

478 
TASK_UNINTERRUPTIBLE
);

479 
	`¥š_uÆock
(&
mb_ÿche_¥šlock
);

480 
	`scheduË
();

481 
	`¥š_lock
(&
mb_ÿche_¥šlock
);

482 
û
->
e_queued
--;

484 
	`fšish_wa™
(&
mb_ÿche_queue
, &
wa™
);

485 
û
->
e_u£d
 +ğ1 + 
MB_CACHE_WRITER
;

487 ià(!
	`__mb_ÿche_’Œy_is_hashed
(
û
)) {

488 
	`__mb_ÿche_’Œy_»Ëa£_uÆock
(
û
);

489  
NULL
;

491 
ş—nup
;

494 
û
 = 
NULL
;

496 
ş—nup
:

497 
	`¥š_uÆock
(&
mb_ÿche_¥šlock
);

498  
û
;

499 
	}
}

501 #ià!
defšed
(
MB_CACHE_INDEXES_COUNT
) || (MB_CACHE_INDEXES_COUNT > 0)

503 
mb_ÿche_’Œy
 *

504 
	$__mb_ÿche_’Œy_fšd
(
li¡_h—d
 *
l
, li¡_h—d *
h—d
,

505 
block_deviû
 *
bdev
, 
key
)

507 
l
 !ğ
h—d
) {

508 
mb_ÿche_’Œy
 *
û
 =

509 
	`li¡_’Œy
(
l
, 
mb_ÿche_’Œy
, 
e_šdex
.
o_li¡
);

510 ià(
û
->
e_bdev
 =ğ
bdev
 && ce->
e_šdex
.
o_key
 =ğ
key
) {

511 
	`DEFINE_WAIT
(
wa™
);

513 ià(!
	`li¡_em±y
(&
û
->
e_Ìu_li¡
))

514 
	`li¡_d–_š™
(&
û
->
e_Ìu_li¡
);

518 
û
->
e_u£d
++;

519 
û
->
e_u£d
 >ğ
MB_CACHE_WRITER
) {

520 
û
->
e_queued
++;

521 
	`´•¬e_to_wa™
(&
mb_ÿche_queue
, &
wa™
,

522 
TASK_UNINTERRUPTIBLE
);

523 
	`¥š_uÆock
(&
mb_ÿche_¥šlock
);

524 
	`scheduË
();

525 
	`¥š_lock
(&
mb_ÿche_¥šlock
);

526 
û
->
e_queued
--;

528 
	`fšish_wa™
(&
mb_ÿche_queue
, &
wa™
);

530 ià(!
	`__mb_ÿche_’Œy_is_hashed
(
û
)) {

531 
	`__mb_ÿche_’Œy_»Ëa£_uÆock
(
û
);

532 
	`¥š_lock
(&
mb_ÿche_¥šlock
);

533  
	`ERR_PTR
(-
EAGAIN
);

535  
û
;

537 
l
 =†->
Ãxt
;

539  
NULL
;

540 
	}
}

555 
mb_ÿche_’Œy
 *

556 
	$mb_ÿche_’Œy_fšd_fœ¡
(
mb_ÿche
 *
ÿche
, 
block_deviû
 *
bdev
,

557 
key
)

559 
buck‘
 = 
	`hash_lÚg
(
key
, 
ÿche
->
c_buck‘_b™s
);

560 
li¡_h—d
 *
l
;

561 
mb_ÿche_’Œy
 *
û
;

563 
	`¥š_lock
(&
mb_ÿche_¥šlock
);

564 
l
 = 
ÿche
->
c_šdex_hash
[
buck‘
].
Ãxt
;

565 
û
 = 
	`__mb_ÿche_’Œy_fšd
(
l
, &
ÿche
->
c_šdex_hash
[
buck‘
], 
bdev
, 
key
);

566 
	`¥š_uÆock
(&
mb_ÿche_¥šlock
);

567  
û
;

568 
	}
}

589 
mb_ÿche_’Œy
 *

590 
	$mb_ÿche_’Œy_fšd_Ãxt
(
mb_ÿche_’Œy
 *
´ev
,

591 
block_deviû
 *
bdev
, 
key
)

593 
mb_ÿche
 *
ÿche
 = 
´ev
->
e_ÿche
;

594 
buck‘
 = 
	`hash_lÚg
(
key
, 
ÿche
->
c_buck‘_b™s
);

595 
li¡_h—d
 *
l
;

596 
mb_ÿche_’Œy
 *
û
;

598 
	`¥š_lock
(&
mb_ÿche_¥šlock
);

599 
l
 = 
´ev
->
e_šdex
.
o_li¡
.
Ãxt
;

600 
û
 = 
	`__mb_ÿche_’Œy_fšd
(
l
, &
ÿche
->
c_šdex_hash
[
buck‘
], 
bdev
, 
key
);

601 
	`__mb_ÿche_’Œy_»Ëa£_uÆock
(
´ev
);

602  
û
;

603 
	}
}

607 
__š™
 
	$š™_mbÿche
()

609 
	`»gi¡”_shršk”
(&
mb_ÿche_shršk”
);

611 
	}
}

613 
__ex™
 
	$ex™_mbÿche
()

615 
	`uÄegi¡”_shršk”
(&
mb_ÿche_shršk”
);

616 
	}
}

618 
	$moduË_š™
(
š™_mbÿche
)

619 
	`moduË_ex™
(
ex™_mbÿche
)

	@mpage.c

15 
	~<lšux/k”Ãl.h
>

16 
	~<lšux/moduË.h
>

17 
	~<lšux/mm.h
>

18 
	~<lšux/kdev_t.h
>

19 
	~<lšux/gå.h
>

20 
	~<lšux/bio.h
>

21 
	~<lšux/fs.h
>

22 
	~<lšux/bufãr_h—d.h
>

23 
	~<lšux/blkdev.h
>

24 
	~<lšux/highmem.h
>

25 
	~<lšux/´eãtch.h
>

26 
	~<lšux/m·ge.h
>

27 
	~<lšux/wr™eback.h
>

28 
	~<lšux/backšg-dev.h
>

29 
	~<lšux/·gevec.h
>

30 
	~<lšux/ş—nÿche.h
>

44 
	$m·ge_’d_io
(
bio
 *bio, 
”r
)

46 cÚ¡ 
u±od©e
 = 
	`‹¡_b™
(
BIO_UPTODATE
, &
bio
->
bi_æags
);

47 
bio_vec
 *
bvec
 = 
bio
->
bi_io_vec
 + bio->
bi_vút
 - 1;

50 
·ge
 *·gğ
bvec
->
bv_·ge
;

52 ià(--
bvec
 >ğ
bio
->
bi_io_vec
)

53 
	`´eãtchw
(&
bvec
->
bv_·ge
->
æags
);

54 ià(
	`bio_d©a_dœ
(
bio
è=ğ
READ
) {

55 ià(
u±od©e
) {

56 
	`S‘PageU±od©e
(
·ge
);

58 
	`CË¬PageU±od©e
(
·ge
);

59 
	`S‘PageE¼Ü
(
·ge
);

61 
	`uÆock_·ge
(
·ge
);

63 ià(!
u±od©e
) {

64 
	`S‘PageE¼Ü
(
·ge
);

65 ià(
·ge
->
m­pšg
)

66 
	`£t_b™
(
AS_EIO
, &
·ge
->
m­pšg
->
æags
);

68 
	`’d_·ge_wr™eback
(
·ge
);

70 } 
bvec
 >ğ
bio
->
bi_io_vec
);

71 
	`bio_put
(
bio
);

72 
	}
}

74 
bio
 *
	$m·ge_bio_subm™
(
rw
, 
bio
 *bio)

76 
bio
->
bi_’d_io
 = 
m·ge_’d_io
;

77 
	`subm™_bio
(
rw
, 
bio
);

78  
NULL
;

79 
	}
}

81 
bio
 *

82 
	$m·ge_®loc
(
block_deviû
 *
bdev
,

83 
£ùÜ_t
 
fœ¡_£ùÜ
, 
Ä_vecs
,

84 
gå_t
 
gå_æags
)

86 
bio
 *bio;

88 
bio
 = 
	`bio_®loc
(
gå_æags
, 
Ä_vecs
);

90 ià(
bio
 =ğ
NULL
 && (
cu¼’t
->
æags
 & 
PF_MEMALLOC
)) {

91 !
bio
 && (
Ä_vecs
 /= 2))

92 
bio
 = 
	`bio_®loc
(
gå_æags
, 
Ä_vecs
);

95 ià(
bio
) {

96 
bio
->
bi_bdev
 = 
bdev
;

97 
bio
->
bi_£ùÜ
 = 
fœ¡_£ùÜ
;

99  
bio
;

100 
	}
}

113 
	$m­_bufãr_to_·ge
(
·ge
 *·ge, 
bufãr_h—d
 *
bh
, 
·ge_block
)

115 
šode
 *šodğ
·ge
->
m­pšg
->
ho¡
;

116 
bufãr_h—d
 *
·ge_bh
, *
h—d
;

117 
block
 = 0;

119 ià(!
	`·ge_has_bufãrs
(
·ge
)) {

124 ià(
šode
->
i_blkb™s
 =ğ
PAGE_CACHE_SHIFT
 &&

125 
	`bufãr_u±od©e
(
bh
)) {

126 
	`S‘PageU±od©e
(
·ge
);

129 
	`ü—‹_em±y_bufãrs
(
·ge
, 1 << 
šode
->
i_blkb™s
, 0);

131 
h—d
 = 
	`·ge_bufãrs
(
·ge
);

132 
·ge_bh
 = 
h—d
;

134 ià(
block
 =ğ
·ge_block
) {

135 
·ge_bh
->
b_¡©e
 = 
bh
->b_state;

136 
·ge_bh
->
b_bdev
 = 
bh
->b_bdev;

137 
·ge_bh
->
b_blockÄ
 = 
bh
->b_blocknr;

140 
·ge_bh
 =…age_bh->
b_this_·ge
;

141 
block
++;

142 } 
·ge_bh
 !ğ
h—d
);

143 
	}
}

154 
bio
 *

155 
	$do_m·ge_»ad·ge
(
bio
 *bio, 
·ge
 *·ge, 
Ä_·ges
,

156 
£ùÜ_t
 *
Ï¡_block_š_bio
, 
bufãr_h—d
 *
m­_bh
,

157 *
fœ¡_logiÿl_block
, 
g‘_block_t
 
g‘_block
)

159 
šode
 *šodğ
·ge
->
m­pšg
->
ho¡
;

160 cÚ¡ 
blkb™s
 = 
šode
->
i_blkb™s
;

161 cÚ¡ 
blocks_³r_·ge
 = 
PAGE_CACHE_SIZE
 >> 
blkb™s
;

162 cÚ¡ 
blocksize
 = 1 << 
blkb™s
;

163 
£ùÜ_t
 
block_š_fe
;

164 
£ùÜ_t
 
Ï¡_block
;

165 
£ùÜ_t
 
Ï¡_block_š_fe
;

166 
£ùÜ_t
 
blocks
[
MAX_BUF_PER_PAGE
];

167 
·ge_block
;

168 
fœ¡_hŞe
 = 
blocks_³r_·ge
;

169 
block_deviû
 *
bdev
 = 
NULL
;

170 
Ëngth
;

171 
fuÎy_m­³d
 = 1;

172 
nblocks
;

173 
»Ïtive_block
;

175 ià(
	`·ge_has_bufãrs
(
·ge
))

176 
cÚfu£d
;

178 
block_š_fe
 = (
£ùÜ_t
)
·ge
->
šdex
 << (
PAGE_CACHE_SHIFT
 - 
blkb™s
);

179 
Ï¡_block
 = 
block_š_fe
 + 
Ä_·ges
 * 
blocks_³r_·ge
;

180 
Ï¡_block_š_fe
 = (
	`i_size_»ad
(
šode
è+ 
blocksize
 - 1è>> 
blkb™s
;

181 ià(
Ï¡_block
 > 
Ï¡_block_š_fe
)

182 
Ï¡_block
 = 
Ï¡_block_š_fe
;

183 
·ge_block
 = 0;

188 
nblocks
 = 
m­_bh
->
b_size
 >> 
blkb™s
;

189 ià(
	`bufãr_m­³d
(
m­_bh
è&& 
block_š_fe
 > *
fœ¡_logiÿl_block
 &&

190 
block_š_fe
 < (*
fœ¡_logiÿl_block
 + 
nblocks
)) {

191 
m­_off£t
 = 
block_š_fe
 - *
fœ¡_logiÿl_block
;

192 
Ï¡
 = 
nblocks
 - 
m­_off£t
;

194 
»Ïtive_block
 = 0; ;„elative_block++) {

195 ià(
»Ïtive_block
 =ğ
Ï¡
) {

196 
	`ş—r_bufãr_m­³d
(
m­_bh
);

199 ià(
·ge_block
 =ğ
blocks_³r_·ge
)

201 
blocks
[
·ge_block
] = 
m­_bh
->
b_blockÄ
 + 
m­_off£t
 +

202 
»Ïtive_block
;

203 
·ge_block
++;

204 
block_š_fe
++;

206 
bdev
 = 
m­_bh
->
b_bdev
;

212 
m­_bh
->
b_·ge
 = 
·ge
;

213 
·ge_block
 < 
blocks_³r_·ge
) {

214 
m­_bh
->
b_¡©e
 = 0;

215 
m­_bh
->
b_size
 = 0;

217 ià(
block_š_fe
 < 
Ï¡_block
) {

218 
m­_bh
->
b_size
 = (
Ï¡_block
-
block_š_fe
è<< 
blkb™s
;

219 ià(
	`g‘_block
(
šode
, 
block_š_fe
, 
m­_bh
, 0))

220 
cÚfu£d
;

221 *
fœ¡_logiÿl_block
 = 
block_š_fe
;

224 ià(!
	`bufãr_m­³d
(
m­_bh
)) {

225 
fuÎy_m­³d
 = 0;

226 ià(
fœ¡_hŞe
 =ğ
blocks_³r_·ge
)

227 
fœ¡_hŞe
 = 
·ge_block
;

228 
·ge_block
++;

229 
block_š_fe
++;

239 ià(
	`bufãr_u±od©e
(
m­_bh
)) {

240 
	`m­_bufãr_to_·ge
(
·ge
, 
m­_bh
, 
·ge_block
);

241 
cÚfu£d
;

244 ià(
fœ¡_hŞe
 !ğ
blocks_³r_·ge
)

245 
cÚfu£d
;

248 ià(
·ge_block
 && 
blocks
[·ge_block-1] !ğ
m­_bh
->
b_blockÄ
-1)

249 
cÚfu£d
;

250 
nblocks
 = 
m­_bh
->
b_size
 >> 
blkb™s
;

251 
»Ïtive_block
 = 0; ;„elative_block++) {

252 ià(
»Ïtive_block
 =ğ
nblocks
) {

253 
	`ş—r_bufãr_m­³d
(
m­_bh
);

255 } ià(
·ge_block
 =ğ
blocks_³r_·ge
)

257 
blocks
[
·ge_block
] = 
m­_bh
->
b_blockÄ
+
»Ïtive_block
;

258 
·ge_block
++;

259 
block_š_fe
++;

261 
bdev
 = 
m­_bh
->
b_bdev
;

264 ià(
fœ¡_hŞe
 !ğ
blocks_³r_·ge
) {

265 
	`z”o_u£r_£gm’t
(
·ge
, 
fœ¡_hŞe
 << 
blkb™s
, 
PAGE_CACHE_SIZE
);

266 ià(
fœ¡_hŞe
 == 0) {

267 
	`S‘PageU±od©e
(
·ge
);

268 
	`uÆock_·ge
(
·ge
);

269 
out
;

271 } ià(
fuÎy_m­³d
) {

272 
	`S‘PageM­³dToDisk
(
·ge
);

275 ià(
fuÎy_m­³d
 && 
blocks_³r_·ge
 =ğ1 && !
	`PageU±od©e
(
·ge
) &&

276 
	`ş—nÿche_g‘_·ge
(
·ge
) == 0) {

277 
	`S‘PageU±od©e
(
·ge
);

278 
cÚfu£d
;

284 ià(
bio
 && (*
Ï¡_block_š_bio
 !ğ
blocks
[0] - 1))

285 
bio
 = 
	`m·ge_bio_subm™
(
READ
, bio);

287 
®loc_Ãw
:

288 ià(
bio
 =ğ
NULL
) {

289 
bio
 = 
	`m·ge_®loc
(
bdev
, 
blocks
[0] << (
blkb™s
 - 9),

290 
	`mš_t
(, 
Ä_·ges
, 
	`bio_g‘_Ä_vecs
(
bdev
)),

291 
GFP_KERNEL
);

292 ià(
bio
 =ğ
NULL
)

293 
cÚfu£d
;

296 
Ëngth
 = 
fœ¡_hŞe
 << 
blkb™s
;

297 ià(
	`bio_add_·ge
(
bio
, 
·ge
, 
Ëngth
, 0) <†ength) {

298 
bio
 = 
	`m·ge_bio_subm™
(
READ
, bio);

299 
®loc_Ãw
;

302 
»Ïtive_block
 = 
block_š_fe
 - *
fœ¡_logiÿl_block
;

303 
nblocks
 = 
m­_bh
->
b_size
 >> 
blkb™s
;

304 ià((
	`bufãr_bound¬y
(
m­_bh
è&& 
»Ïtive_block
 =ğ
nblocks
) ||

305 (
fœ¡_hŞe
 !ğ
blocks_³r_·ge
))

306 
bio
 = 
	`m·ge_bio_subm™
(
READ
, bio);

308 *
Ï¡_block_š_bio
 = 
blocks
[
blocks_³r_·ge
 - 1];

309 
out
:

310  
bio
;

312 
cÚfu£d
:

313 ià(
bio
)

314 
bio
 = 
	`m·ge_bio_subm™
(
READ
, bio);

315 ià(!
	`PageU±od©e
(
·ge
))

316 
	`block_»ad_fuÎ_·ge
(
·ge
, 
g‘_block
);

318 
	`uÆock_·ge
(
·ge
);

319 
out
;

320 
	}
}

366 
	$m·ge_»ad·ges
(
add»ss_¥aû
 *
m­pšg
, 
li¡_h—d
 *
·ges
,

367 
Ä_·ges
, 
g‘_block_t
 
g‘_block
)

369 
bio
 *biØğ
NULL
;

370 
·ge_idx
;

371 
£ùÜ_t
 
Ï¡_block_š_bio
 = 0;

372 
bufãr_h—d
 
m­_bh
;

373 
fœ¡_logiÿl_block
 = 0;

374 
blk_¶ug
 
¶ug
;

376 
	`blk_¡¬t_¶ug
(&
¶ug
);

378 
m­_bh
.
b_¡©e
 = 0;

379 
m­_bh
.
b_size
 = 0;

380 
·ge_idx
 = 0;…age_idx < 
Ä_·ges
;…age_idx++) {

381 
·ge
 *·gğ
	`li¡_’Œy
(
·ges
->
´ev
, ·ge, 
Ìu
);

383 
	`´eãtchw
(&
·ge
->
æags
);

384 
	`li¡_d–
(&
·ge
->
Ìu
);

385 ià(!
	`add_to_·ge_ÿche_Ìu
(
·ge
, 
m­pšg
,

386 
·ge
->
šdex
, 
GFP_KERNEL
)) {

387 
bio
 = 
	`do_m·ge_»ad·ge
(bio, 
·ge
,

388 
Ä_·ges
 - 
·ge_idx
,

389 &
Ï¡_block_š_bio
, &
m­_bh
,

390 &
fœ¡_logiÿl_block
,

391 
g‘_block
);

393 
	`·ge_ÿche_»Ëa£
(
·ge
);

395 
	`BUG_ON
(!
	`li¡_em±y
(
·ges
));

396 ià(
bio
)

397 
	`m·ge_bio_subm™
(
READ
, 
bio
);

398 
	`blk_fšish_¶ug
(&
¶ug
);

400 
	}
}

401 
EXPORT_SYMBOL
(
m·ge_»ad·ges
);

406 
	$m·ge_»ad·ge
(
·ge
 *·ge, 
g‘_block_t
 
g‘_block
)

408 
bio
 *biØğ
NULL
;

409 
£ùÜ_t
 
Ï¡_block_š_bio
 = 0;

410 
bufãr_h—d
 
m­_bh
;

411 
fœ¡_logiÿl_block
 = 0;

413 
m­_bh
.
b_¡©e
 = 0;

414 
m­_bh
.
b_size
 = 0;

415 
bio
 = 
	`do_m·ge_»ad·ge
(bio, 
·ge
, 1, &
Ï¡_block_š_bio
,

416 &
m­_bh
, &
fœ¡_logiÿl_block
, 
g‘_block
);

417 ià(
bio
)

418 
	`m·ge_bio_subm™
(
READ
, 
bio
);

420 
	}
}

421 
EXPORT_SYMBOL
(
m·ge_»ad·ge
);

440 
	sm·ge_d©a
 {

441 
bio
 *
	mbio
;

442 
£ùÜ_t
 
	mÏ¡_block_š_bio
;

443 
g‘_block_t
 *
	mg‘_block
;

444 
	mu£_wr™•age
;

447 
	$__m·ge_wr™•age
(
·ge
 *·ge, 
wr™eback_cÚŒŞ
 *
wbc
,

448 *
d©a
)

450 
m·ge_d©a
 *
mpd
 = 
d©a
;

451 
bio
 *biØğ
mpd
->bio;

452 
add»ss_¥aû
 *
m­pšg
 = 
·ge
->mapping;

453 
šode
 *šodğ
·ge
->
m­pšg
->
ho¡
;

454 cÚ¡ 
blkb™s
 = 
šode
->
i_blkb™s
;

455 
’d_šdex
;

456 cÚ¡ 
blocks_³r_·ge
 = 
PAGE_CACHE_SIZE
 >> 
blkb™s
;

457 
£ùÜ_t
 
Ï¡_block
;

458 
£ùÜ_t
 
block_š_fe
;

459 
£ùÜ_t
 
blocks
[
MAX_BUF_PER_PAGE
];

460 
·ge_block
;

461 
fœ¡_unm­³d
 = 
blocks_³r_·ge
;

462 
block_deviû
 *
bdev
 = 
NULL
;

463 
bound¬y
 = 0;

464 
£ùÜ_t
 
bound¬y_block
 = 0;

465 
block_deviû
 *
bound¬y_bdev
 = 
NULL
;

466 
Ëngth
;

467 
bufãr_h—d
 
m­_bh
;

468 
loff_t
 
i_size
 = 
	`i_size_»ad
(
šode
);

469 
»t
 = 0;

471 ià(
	`·ge_has_bufãrs
(
·ge
)) {

472 
bufãr_h—d
 *
h—d
 = 
	`·ge_bufãrs
(
·ge
);

473 
bufãr_h—d
 *
bh
 = 
h—d
;

476 
·ge_block
 = 0;

478 
	`BUG_ON
(
	`bufãr_locked
(
bh
));

479 ià(!
	`bufãr_m­³d
(
bh
)) {

484 ià(
	`bufãr_dœty
(
bh
))

485 
cÚfu£d
;

486 ià(
fœ¡_unm­³d
 =ğ
blocks_³r_·ge
)

487 
fœ¡_unm­³d
 = 
·ge_block
;

491 ià(
fœ¡_unm­³d
 !ğ
blocks_³r_·ge
)

492 
cÚfu£d
;

494 ià(!
	`bufãr_dœty
(
bh
è|| !
	`bufãr_u±od©e
(bh))

495 
cÚfu£d
;

496 ià(
·ge_block
) {

497 ià(
bh
->
b_blockÄ
 !ğ
blocks
[
·ge_block
-1] + 1)

498 
cÚfu£d
;

500 
blocks
[
·ge_block
++] = 
bh
->
b_blockÄ
;

501 
bound¬y
 = 
	`bufãr_bound¬y
(
bh
);

502 ià(
bound¬y
) {

503 
bound¬y_block
 = 
bh
->
b_blockÄ
;

504 
bound¬y_bdev
 = 
bh
->
b_bdev
;

506 
bdev
 = 
bh
->
b_bdev
;

507 } (
bh
 = bh->
b_this_·ge
è!ğ
h—d
);

509 ià(
fœ¡_unm­³d
)

510 
·ge_is_m­³d
;

518 
cÚfu£d
;

524 
	`BUG_ON
(!
	`PageU±od©e
(
·ge
));

525 
block_š_fe
 = (
£ùÜ_t
)
·ge
->
šdex
 << (
PAGE_CACHE_SHIFT
 - 
blkb™s
);

526 
Ï¡_block
 = (
i_size
 - 1è>> 
blkb™s
;

527 
m­_bh
.
b_·ge
 = 
·ge
;

528 
·ge_block
 = 0;…age_block < 
blocks_³r_·ge
; ) {

530 
m­_bh
.
b_¡©e
 = 0;

531 
m­_bh
.
b_size
 = 1 << 
blkb™s
;

532 ià(
mpd
->
	`g‘_block
(
šode
, 
block_š_fe
, &
m­_bh
, 1))

533 
cÚfu£d
;

534 ià(
	`bufãr_Ãw
(&
m­_bh
))

535 
	`unm­_und”lyšg_m‘ad©a
(
m­_bh
.
b_bdev
,

536 
m­_bh
.
b_blockÄ
);

537 ià(
	`bufãr_bound¬y
(&
m­_bh
)) {

538 
bound¬y_block
 = 
m­_bh
.
b_blockÄ
;

539 
bound¬y_bdev
 = 
m­_bh
.
b_bdev
;

541 ià(
·ge_block
) {

542 ià(
m­_bh
.
b_blockÄ
 !ğ
blocks
[
·ge_block
-1] + 1)

543 
cÚfu£d
;

545 
blocks
[
·ge_block
++] = 
m­_bh
.
b_blockÄ
;

546 
bound¬y
 = 
	`bufãr_bound¬y
(&
m­_bh
);

547 
bdev
 = 
m­_bh
.
b_bdev
;

548 ià(
block_š_fe
 =ğ
Ï¡_block
)

550 
block_š_fe
++;

552 
	`BUG_ON
(
·ge_block
 == 0);

554 
fœ¡_unm­³d
 = 
·ge_block
;

556 
·ge_is_m­³d
:

557 
’d_šdex
 = 
i_size
 >> 
PAGE_CACHE_SHIFT
;

558 ià(
·ge
->
šdex
 >ğ
’d_šdex
) {

567 
off£t
 = 
i_size
 & (
PAGE_CACHE_SIZE
 - 1);

569 ià(
·ge
->
šdex
 > 
’d_šdex
 || !
off£t
)

570 
cÚfu£d
;

571 
	`z”o_u£r_£gm’t
(
·ge
, 
off£t
, 
PAGE_CACHE_SIZE
);

577 ià(
bio
 && 
mpd
->
Ï¡_block_š_bio
 !ğ
blocks
[0] - 1)

578 
bio
 = 
	`m·ge_bio_subm™
(
WRITE
, bio);

580 
®loc_Ãw
:

581 ià(
bio
 =ğ
NULL
) {

582 
bio
 = 
	`m·ge_®loc
(
bdev
, 
blocks
[0] << (
blkb™s
 - 9),

583 
	`bio_g‘_Ä_vecs
(
bdev
), 
GFP_NOFS
|
__GFP_HIGH
);

584 ià(
bio
 =ğ
NULL
)

585 
cÚfu£d
;

593 
Ëngth
 = 
fœ¡_unm­³d
 << 
blkb™s
;

594 ià(
	`bio_add_·ge
(
bio
, 
·ge
, 
Ëngth
, 0) <†ength) {

595 
bio
 = 
	`m·ge_bio_subm™
(
WRITE
, bio);

596 
®loc_Ãw
;

603 ià(
	`·ge_has_bufãrs
(
·ge
)) {

604 
bufãr_h—d
 *
h—d
 = 
	`·ge_bufãrs
(
·ge
);

605 
bufãr_h—d
 *
bh
 = 
h—d
;

606 
bufãr_couÁ”
 = 0;

609 ià(
bufãr_couÁ”
++ =ğ
fœ¡_unm­³d
)

611 
	`ş—r_bufãr_dœty
(
bh
);

612 
bh
 = bh->
b_this_·ge
;

613 } 
bh
 !ğ
h—d
);

620 ià(
bufãr_h—ds_ov”_lim™
 && 
	`PageU±od©e
(
·ge
))

621 
	`Œy_to_ä“_bufãrs
(
·ge
);

624 
	`BUG_ON
(
	`PageWr™eback
(
·ge
));

625 
	`£t_·ge_wr™eback
(
·ge
);

626 
	`uÆock_·ge
(
·ge
);

627 ià(
bound¬y
 || (
fœ¡_unm­³d
 !ğ
blocks_³r_·ge
)) {

628 
bio
 = 
	`m·ge_bio_subm™
(
WRITE
, bio);

629 ià(
bound¬y_block
) {

630 
	`wr™e_bound¬y_block
(
bound¬y_bdev
,

631 
bound¬y_block
, 1 << 
blkb™s
);

634 
mpd
->
Ï¡_block_š_bio
 = 
blocks
[
blocks_³r_·ge
 - 1];

636 
out
;

638 
cÚfu£d
:

639 ià(
bio
)

640 
bio
 = 
	`m·ge_bio_subm™
(
WRITE
, bio);

642 ià(
mpd
->
u£_wr™•age
) {

643 
»t
 = 
m­pšg
->
a_İs
->
	`wr™•age
(
·ge
, 
wbc
);

645 
»t
 = -
EAGAIN
;

646 
out
;

651 
	`m­pšg_£t_”rÜ
(
m­pšg
, 
»t
);

652 
out
:

653 
mpd
->
bio
 = bio;

654  
»t
;

655 
	}
}

677 
	$m·ge_wr™•ages
(
add»ss_¥aû
 *
m­pšg
,

678 
wr™eback_cÚŒŞ
 *
wbc
, 
g‘_block_t
 
g‘_block
)

680 
blk_¶ug
 
¶ug
;

681 
»t
;

683 
	`blk_¡¬t_¶ug
(&
¶ug
);

685 ià(!
g‘_block
)

686 
»t
 = 
	`g’”ic_wr™•ages
(
m­pšg
, 
wbc
);

688 
m·ge_d©a
 
mpd
 = {

689 .
bio
 = 
NULL
,

690 .
Ï¡_block_š_bio
 = 0,

691 .
g‘_block
 = get_block,

692 .
u£_wr™•age
 = 1,

695 
»t
 = 
	`wr™e_ÿche_·ges
(
m­pšg
, 
wbc
, 
__m·ge_wr™•age
, &
mpd
);

696 ià(
mpd
.
bio
)

697 
	`m·ge_bio_subm™
(
WRITE
, 
mpd
.
bio
);

699 
	`blk_fšish_¶ug
(&
¶ug
);

700  
»t
;

701 
	}
}

702 
EXPORT_SYMBOL
(
m·ge_wr™•ages
);

704 
	$m·ge_wr™•age
(
·ge
 *·ge, 
g‘_block_t
 
g‘_block
,

705 
wr™eback_cÚŒŞ
 *
wbc
)

707 
m·ge_d©a
 
mpd
 = {

708 .
bio
 = 
NULL
,

709 .
Ï¡_block_š_bio
 = 0,

710 .
g‘_block
 = get_block,

711 .
u£_wr™•age
 = 0,

713 
»t
 = 
	`__m·ge_wr™•age
(
·ge
, 
wbc
, &
mpd
);

714 ià(
mpd
.
bio
)

715 
	`m·ge_bio_subm™
(
WRITE
, 
mpd
.
bio
);

716  
»t
;

717 
	}
}

718 
EXPORT_SYMBOL
(
m·ge_wr™•age
);

	@namei.c

17 
	~<lšux/š™.h
>

18 
	~<lšux/moduË.h
>

19 
	~<lšux/¦ab.h
>

20 
	~<lšux/fs.h
>

21 
	~<lšux/Çmei.h
>

22 
	~<lšux/·gem­.h
>

23 
	~<lšux/f¢Ùify.h
>

24 
	~<lšux/³rsÚ®™y.h
>

25 
	~<lšux/£cur™y.h
>

26 
	~<lšux/ima.h
>

27 
	~<lšux/sysÿÎs.h
>

28 
	~<lšux/mouÁ.h
>

29 
	~<lšux/aud™.h
>

30 
	~<lšux/ÿ·b™y.h
>

31 
	~<lšux/fe.h
>

32 
	~<lšux/fú.h
>

33 
	~<lšux/deviû_cgroup.h
>

34 
	~<lšux/fs_¡ruù.h
>

35 
	~<lšux/posix_aş.h
>

36 
	~<asm/uacûss.h
>

38 
	~"š‹º®.h
"

118 
	$do_g‘Çme
(cÚ¡ 
__u£r
 *
f’ame
, *
·ge
)

120 
»tv®
;

121 
Ën
 = 
PATH_MAX
;

123 ià(!
	`£gm’t_eq
(
	`g‘_fs
(), 
KERNEL_DS
)) {

124 ià((è
f’ame
 >ğ
TASK_SIZE
)

125  -
EFAULT
;

126 ià(
TASK_SIZE
 - (è
f’ame
 < 
PATH_MAX
)

127 
Ën
 = 
TASK_SIZE
 - (è
f’ame
;

130 
»tv®
 = 
	`¡ºıy_äom_u£r
(
·ge
, 
f’ame
, 
Ën
);

131 ià(
»tv®
 > 0) {

132 ià(
»tv®
 < 
Ën
)

134  -
ENAMETOOLONG
;

135 } ià(!
»tv®
)

136 
»tv®
 = -
ENOENT
;

137  
»tv®
;

138 
	}
}

140 *
	$g‘Çme_æags
(cÚ¡ 
__u£r
 *
f’ame
, 
æags
, *
em±y
)

142 *
tmp
, *
»suÉ
;

144 
»suÉ
 = 
	`ERR_PTR
(-
ENOMEM
);

145 
tmp
 = 
	`__g‘Çme
();

146 ià(
tmp
) {

147 
»tv®
 = 
	`do_g‘Çme
(
f’ame
, 
tmp
);

149 
»suÉ
 = 
tmp
;

150 ià(
»tv®
 < 0) {

151 ià(
»tv®
 =ğ-
ENOENT
 && 
em±y
)

152 *
em±y
 = 1;

153 ià(
»tv®
 !ğ-
ENOENT
 || !(
æags
 & 
LOOKUP_EMPTY
)) {

154 
	`__puŠame
(
tmp
);

155 
»suÉ
 = 
	`ERR_PTR
(
»tv®
);

159 
	`aud™_g‘Çme
(
»suÉ
);

160  
»suÉ
;

161 
	}
}

163 *
	$g‘Çme
(cÚ¡ 
__u£r
 * 
f’ame
)

165  
	`g‘Çme_æags
(
f’ame
, 0, 0);

166 
	}
}

168 #ifdeà
CONFIG_AUDITSYSCALL


169 
	$puŠame
(cÚ¡ *
Çme
)

171 ià(
	`uÆik–y
(!
	`aud™_dummy_cÚ‹xt
()))

172 
	`aud™_puŠame
(
Çme
);

174 
	`__puŠame
(
Çme
);

175 
	}
}

176 
EXPORT_SYMBOL
(
puŠame
);

179 
	$check_aş
(
šode
 *šode, 
mask
)

181 #ifdeà
CONFIG_FS_POSIX_ACL


182 
posix_aş
 *
aş
;

184 ià(
mask
 & 
MAY_NOT_BLOCK
) {

185 
aş
 = 
	`g‘_ÿched_aş_rcu
(
šode
, 
ACL_TYPE_ACCESS
);

186 ià(!
aş
)

187  -
EAGAIN
;

189 ià(
aş
 =ğ
ACL_NOT_CACHED
)

190  -
ECHILD
;

191  
	`posix_aş_³rmissiÚ
(
šode
, 
aş
, 
mask
 & ~
MAY_NOT_BLOCK
);

194 
aş
 = 
	`g‘_ÿched_aş
(
šode
, 
ACL_TYPE_ACCESS
);

204 ià(
aş
 =ğ
ACL_NOT_CACHED
) {

205 ià(
šode
->
i_İ
->
g‘_aş
) {

206 
aş
 = 
šode
->
i_İ
->
	`g‘_aş
(šode, 
ACL_TYPE_ACCESS
);

207 ià(
	`IS_ERR
(
aş
))

208  
	`PTR_ERR
(
aş
);

210 
	`£t_ÿched_aş
(
šode
, 
ACL_TYPE_ACCESS
, 
NULL
);

211  -
EAGAIN
;

215 ià(
aş
) {

216 
”rÜ
 = 
	`posix_aş_³rmissiÚ
(
šode
, 
aş
, 
mask
);

217 
	`posix_aş_»Ëa£
(
aş
);

218  
”rÜ
;

222  -
EAGAIN
;

223 
	}
}

228 
	$aş_³rmissiÚ_check
(
šode
 *šode, 
mask
)

230 
mode
 = 
šode
->
i_mode
;

232 ià(
	`cu¼’t_u£r_ns
(è!ğ
	`šode_u£ºs
(
šode
))

233 
Ùh”_³rms
;

235 ià(
	`lik–y
(
	`cu¼’t_fsuid
(è=ğ
šode
->
i_uid
))

236 
mode
 >>= 6;

238 ià(
	`IS_POSIXACL
(
šode
è&& (
mode
 & 
S_IRWXG
)) {

239 
”rÜ
 = 
	`check_aş
(
šode
, 
mask
);

240 ià(
”rÜ
 !ğ-
EAGAIN
)

241  
”rÜ
;

244 ià(
	`š_group_p
(
šode
->
i_gid
))

245 
mode
 >>= 3;

248 
Ùh”_³rms
:

252 ià((
mask
 & ~
mode
 & (
MAY_READ
 | 
MAY_WRITE
 | 
MAY_EXEC
)) == 0)

254  -
EACCES
;

255 
	}
}

271 
	$g’”ic_³rmissiÚ
(
šode
 *šode, 
mask
)

273 
»t
;

278 
»t
 = 
	`aş_³rmissiÚ_check
(
šode
, 
mask
);

279 ià(
»t
 !ğ-
EACCES
)

280  
»t
;

282 ià(
	`S_ISDIR
(
šode
->
i_mode
)) {

284 ià(
	`ns_ÿ·bË
(
	`šode_u£ºs
(
šode
), 
CAP_DAC_OVERRIDE
))

286 ià(!(
mask
 & 
MAY_WRITE
))

287 ià(
	`ns_ÿ·bË
(
	`šode_u£ºs
(
šode
), 
CAP_DAC_READ_SEARCH
))

289  -
EACCES
;

296 ià(!(
mask
 & 
MAY_EXEC
è|| (
šode
->
i_mode
 & 
S_IXUGO
))

297 ià(
	`ns_ÿ·bË
(
	`šode_u£ºs
(
šode
), 
CAP_DAC_OVERRIDE
))

303 
mask
 &ğ
MAY_READ
 | 
MAY_WRITE
 | 
MAY_EXEC
;

304 ià(
mask
 =ğ
MAY_READ
)

305 ià(
	`ns_ÿ·bË
(
	`šode_u£ºs
(
šode
), 
CAP_DAC_READ_SEARCH
))

308  -
EACCES
;

309 
	}
}

317 
šlše
 
	$do_šode_³rmissiÚ
(
šode
 *šode, 
mask
)

319 ià(
	`uÆik–y
(!(
šode
->
i_İæags
 & 
IOP_FASTPERM
))) {

320 ià(
	`lik–y
(
šode
->
i_İ
->
³rmissiÚ
))

321  
šode
->
i_İ
->
	`³rmissiÚ
(šode, 
mask
);

324 
	`¥š_lock
(&
šode
->
i_lock
);

325 
šode
->
i_İæags
 |ğ
IOP_FASTPERM
;

326 
	`¥š_uÆock
(&
šode
->
i_lock
);

328  
	`g’”ic_³rmissiÚ
(
šode
, 
mask
);

329 
	}
}

343 
	$šode_³rmissiÚ
(
šode
 *šode, 
mask
)

345 
»tv®
;

347 ià(
	`uÆik–y
(
mask
 & 
MAY_WRITE
)) {

348 
umode_t
 
mode
 = 
šode
->
i_mode
;

353 ià(
	`IS_RDONLY
(
šode
) &&

354 (
	`S_ISREG
(
mode
è|| 
	`S_ISDIR
(modeè|| 
	`S_ISLNK
(mode)))

355  -
EROFS
;

360 ià(
	`IS_IMMUTABLE
(
šode
))

361  -
EACCES
;

364 
»tv®
 = 
	`do_šode_³rmissiÚ
(
šode
, 
mask
);

365 ià(
»tv®
)

366  
»tv®
;

368 
»tv®
 = 
	`devcgroup_šode_³rmissiÚ
(
šode
, 
mask
);

369 ià(
»tv®
)

370  
»tv®
;

372  
	`£cur™y_šode_³rmissiÚ
(
šode
, 
mask
);

373 
	}
}

381 
	$·th_g‘
(
·th
 *path)

383 
	`mÁg‘
(
·th
->
mÁ
);

384 
	`dg‘
(
·th
->
d’Œy
);

385 
	}
}

386 
EXPORT_SYMBOL
(
·th_g‘
);

394 
	$·th_put
(
·th
 *path)

396 
	`dput
(
·th
->
d’Œy
);

397 
	`mÁput
(
·th
->
mÁ
);

398 
	}
}

399 
EXPORT_SYMBOL
(
·th_put
);

422 
	$uÆazy_w®k
(
Çmeid©a
 *
nd
, 
d’Œy
 *dentry)

424 
fs_¡ruù
 *
fs
 = 
cu¼’t
->fs;

425 
d’Œy
 *
·»Á
 = 
nd
->
·th
.dentry;

426 
wªt_roÙ
 = 0;

428 
	`BUG_ON
(!(
nd
->
æags
 & 
LOOKUP_RCU
));

429 ià(
nd
->
roÙ
.
mÁ
 && !Òd->
æags
 & 
LOOKUP_ROOT
)) {

430 
wªt_roÙ
 = 1;

431 
	`¥š_lock
(&
fs
->
lock
);

432 ià(
nd
->
roÙ
.
mÁ
 !ğ
fs
->root.mnt ||

433 
nd
->
roÙ
.
d’Œy
 !ğ
fs
->root.dentry)

434 
”r_roÙ
;

436 
	`¥š_lock
(&
·»Á
->
d_lock
);

437 ià(!
d’Œy
) {

438 ià(!
	`__d_rcu_to_»fcouÁ
(
·»Á
, 
nd
->
£q
))

439 
”r_·»Á
;

440 
	`BUG_ON
(
nd
->
šode
 !ğ
·»Á
->
d_šode
);

442 ià(
d’Œy
->
d_·»Á
 !ğ
·»Á
)

443 
”r_·»Á
;

444 
	`¥š_lock_Ã¡ed
(&
d’Œy
->
d_lock
, 
DENTRY_D_LOCK_NESTED
);

445 ià(!
	`__d_rcu_to_»fcouÁ
(
d’Œy
, 
nd
->
£q
))

446 
”r_chd
;

453 
	`BUG_ON
(!
	`IS_ROOT
(
d’Œy
è&& d’Œy->
d_·»Á
 !ğ
·»Á
);

454 
	`BUG_ON
(!
·»Á
->
d_couÁ
);

455 
·»Á
->
d_couÁ
++;

456 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

458 
	`¥š_uÆock
(&
·»Á
->
d_lock
);

459 ià(
wªt_roÙ
) {

460 
	`·th_g‘
(&
nd
->
roÙ
);

461 
	`¥š_uÆock
(&
fs
->
lock
);

463 
	`mÁg‘
(
nd
->
·th
.
mÁ
);

465 
	`rcu_»ad_uÆock
();

466 
	`br_»ad_uÆock
(
vfsmouÁ_lock
);

467 
nd
->
æags
 &ğ~
LOOKUP_RCU
;

470 
”r_chd
:

471 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

472 
”r_·»Á
:

473 
	`¥š_uÆock
(&
·»Á
->
d_lock
);

474 
”r_roÙ
:

475 ià(
wªt_roÙ
)

476 
	`¥š_uÆock
(&
fs
->
lock
);

477  -
ECHILD
;

478 
	}
}

484 
	$»Ëa£_İ’_š‹Á
(
Çmeid©a
 *
nd
)

486 
fe
 *fğ
nd
->
š‹Á
.
İ’
.file;

488 ià(
fe
 && !
	`IS_ERR
(file)) {

489 ià(
fe
->
f_·th
.
d’Œy
 =ğ
NULL
)

490 
	`put_fp
(
fe
);

492 
	`åut
(
fe
);

494 
	}
}

496 
šlše
 
	$d_»v®id©e
(
d’Œy
 *d’Œy, 
Çmeid©a
 *
nd
)

498  
d’Œy
->
d_İ
->
	`d_»v®id©e
(d’Œy, 
nd
);

499 
	}
}

511 
	$com¶‘e_w®k
(
Çmeid©a
 *
nd
)

513 
d’Œy
 *d’Œy = 
nd
->
·th
.dentry;

514 
¡©us
;

516 ià(
nd
->
æags
 & 
LOOKUP_RCU
) {

517 
nd
->
æags
 &ğ~
LOOKUP_RCU
;

518 ià(!(
nd
->
æags
 & 
LOOKUP_ROOT
))

519 
nd
->
roÙ
.
mÁ
 = 
NULL
;

520 
	`¥š_lock
(&
d’Œy
->
d_lock
);

521 ià(
	`uÆik–y
(!
	`__d_rcu_to_»fcouÁ
(
d’Œy
, 
nd
->
£q
))) {

522 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

523 
	`rcu_»ad_uÆock
();

524 
	`br_»ad_uÆock
(
vfsmouÁ_lock
);

525  -
ECHILD
;

527 
	`BUG_ON
(
nd
->
šode
 !ğ
d’Œy
->
d_šode
);

528 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

529 
	`mÁg‘
(
nd
->
·th
.
mÁ
);

530 
	`rcu_»ad_uÆock
();

531 
	`br_»ad_uÆock
(
vfsmouÁ_lock
);

534 ià(
	`lik–y
(!(
nd
->
æags
 & 
LOOKUP_JUMPED
)))

537 ià(
	`lik–y
(!(
d’Œy
->
d_æags
 & 
DCACHE_OP_REVALIDATE
)))

540 ià(
	`lik–y
(!(
d’Œy
->
d_sb
->
s_ty³
->
fs_æags
 & 
FS_REVAL_DOT
)))

544 
¡©us
 = 
	`d_»v®id©e
(
d’Œy
, 
nd
);

545 ià(
¡©us
 > 0)

548 ià(!
¡©us
)

549 
¡©us
 = -
ESTALE
;

551 
	`·th_put
(&
nd
->
·th
);

552  
¡©us
;

553 
	}
}

555 
__®ways_šlše
 
	$£t_roÙ
(
Çmeid©a
 *
nd
)

557 ià(!
nd
->
roÙ
.
mÁ
)

558 
	`g‘_fs_roÙ
(
cu¼’t
->
fs
, &
nd
->
roÙ
);

559 
	}
}

561 
lšk_·th_w®k
(cÚ¡ *, 
Çmeid©a
 *);

563 
__®ways_šlše
 
	$£t_roÙ_rcu
(
Çmeid©a
 *
nd
)

565 ià(!
nd
->
roÙ
.
mÁ
) {

566 
fs_¡ruù
 *
fs
 = 
cu¼’t
->fs;

567 
£q
;

570 
£q
 = 
	`»ad_£qcouÁ_begš
(&
fs
->seq);

571 
nd
->
roÙ
 = 
fs
->root;

572 
nd
->
£q
 = 
	`__»ad_£qcouÁ_begš
(&nd->
roÙ
.
d’Œy
->
d_£q
);

573 } 
	`»ad_£qcouÁ_»Œy
(&
fs
->
£q
, seq));

575 
	}
}

577 
__®ways_šlše
 
	$__vfs_fŞlow_lšk
(
Çmeid©a
 *
nd
, cÚ¡ *
lšk
)

579 
»t
;

581 ià(
	`IS_ERR
(
lšk
))

582 
ç
;

584 ià(*
lšk
 == '/') {

585 
	`£t_roÙ
(
nd
);

586 
	`·th_put
(&
nd
->
·th
);

587 
nd
->
·th
 =‚d->
roÙ
;

588 
	`·th_g‘
(&
nd
->
roÙ
);

589 
nd
->
æags
 |ğ
LOOKUP_JUMPED
;

591 
nd
->
šode
 =‚d->
·th
.
d’Œy
->
d_šode
;

593 
»t
 = 
	`lšk_·th_w®k
(
lšk
, 
nd
);

594  
»t
;

595 
ç
:

596 
	`·th_put
(&
nd
->
·th
);

597  
	`PTR_ERR
(
lšk
);

598 
	}
}

600 
	$·th_put_cÚd™iÚ®
(
·th
 *·th, 
Çmeid©a
 *
nd
)

602 
	`dput
(
·th
->
d’Œy
);

603 ià(
·th
->
mÁ
 !ğ
nd
->path.mnt)

604 
	`mÁput
(
·th
->
mÁ
);

605 
	}
}

607 
šlše
 
	$·th_to_Çmeid©a
(cÚ¡ 
·th
 *path,

608 
Çmeid©a
 *
nd
)

610 ià(!(
nd
->
æags
 & 
LOOKUP_RCU
)) {

611 
	`dput
(
nd
->
·th
.
d’Œy
);

612 ià(
nd
->
·th
.
mÁ
 !=…ath->mnt)

613 
	`mÁput
(
nd
->
·th
.
mÁ
);

615 
nd
->
·th
.
mÁ
 =…ath->mnt;

616 
nd
->
·th
.
d’Œy
 =…ath->dentry;

617 
	}
}

619 
šlše
 
	$put_lšk
(
Çmeid©a
 *
nd
, 
·th
 *
lšk
, *
cook›
)

621 
šode
 *šodğ
lšk
->
d’Œy
->
d_šode
;

622 ià(!
	`IS_ERR
(
cook›
è&& 
šode
->
i_İ
->
put_lšk
)

623 
šode
->
i_İ
->
	`put_lšk
(
lšk
->
d’Œy
, 
nd
, 
cook›
);

624 
	`·th_put
(
lšk
);

625 
	}
}

627 
__®ways_šlše
 

628 
	$fŞlow_lšk
(
·th
 *
lšk
, 
Çmeid©a
 *
nd
, **
p
)

630 
”rÜ
;

631 
d’Œy
 *d’Œy = 
lšk
->dentry;

633 
	`BUG_ON
(
nd
->
æags
 & 
LOOKUP_RCU
);

635 ià(
lšk
->
mÁ
 =ğ
nd
->
·th
.mnt)

636 
	`mÁg‘
(
lšk
->
mÁ
);

638 ià(
	`uÆik–y
(
cu¼’t
->
tÙ®_lšk_couÁ
 >= 40)) {

639 *
p
 = 
	`ERR_PTR
(-
ELOOP
);

640 
	`·th_put
(&
nd
->
·th
);

641  -
ELOOP
;

643 
	`cÚd_»sched
();

644 
cu¼’t
->
tÙ®_lšk_couÁ
++;

646 
	`touch_©ime
(
lšk
->
mÁ
, 
d’Œy
);

647 
	`nd_£t_lšk
(
nd
, 
NULL
);

649 
”rÜ
 = 
	`£cur™y_šode_fŞlow_lšk
(
lšk
->
d’Œy
, 
nd
);

650 ià(
”rÜ
) {

651 *
p
 = 
	`ERR_PTR
(
”rÜ
);

652 
	`·th_put
(&
nd
->
·th
);

653  
”rÜ
;

656 
nd
->
Ï¡_ty³
 = 
LAST_BIND
;

657 *
p
 = 
d’Œy
->
d_šode
->
i_İ
->
	`fŞlow_lšk
(d’Œy, 
nd
);

658 
”rÜ
 = 
	`PTR_ERR
(*
p
);

659 ià(!
	`IS_ERR
(*
p
)) {

660 *
s
 = 
	`nd_g‘_lšk
(
nd
);

661 
”rÜ
 = 0;

662 ià(
s
)

663 
”rÜ
 = 
	`__vfs_fŞlow_lšk
(
nd
, 
s
);

664 ià(
nd
->
Ï¡_ty³
 =ğ
LAST_BIND
) {

665 
nd
->
æags
 |ğ
LOOKUP_JUMPED
;

666 
nd
->
šode
 =‚d->
·th
.
d’Œy
->
d_šode
;

667 ià(
nd
->
šode
->
i_İ
->
fŞlow_lšk
) {

669 
	`·th_put
(&
nd
->
·th
);

670 
”rÜ
 = -
ELOOP
;

674  
”rÜ
;

675 
	}
}

677 
	$fŞlow_up_rcu
(
·th
 *path)

679 
vfsmouÁ
 *
·»Á
;

680 
d’Œy
 *
mouÁpošt
;

682 
·»Á
 = 
·th
->
mÁ
->
mÁ_·»Á
;

683 ià(
·»Á
 =ğ
·th
->
mÁ
)

685 
mouÁpošt
 = 
·th
->
mÁ
->
mÁ_mouÁpošt
;

686 
·th
->
d’Œy
 = 
mouÁpošt
;

687 
·th
->
mÁ
 = 
·»Á
;

689 
	}
}

691 
	$fŞlow_up
(
·th
 *path)

693 
vfsmouÁ
 *
·»Á
;

694 
d’Œy
 *
mouÁpošt
;

696 
	`br_»ad_lock
(
vfsmouÁ_lock
);

697 
·»Á
 = 
·th
->
mÁ
->
mÁ_·»Á
;

698 ià(
·»Á
 =ğ
·th
->
mÁ
) {

699 
	`br_»ad_uÆock
(
vfsmouÁ_lock
);

702 
	`mÁg‘
(
·»Á
);

703 
mouÁpošt
 = 
	`dg‘
(
·th
->
mÁ
->
mÁ_mouÁpošt
);

704 
	`br_»ad_uÆock
(
vfsmouÁ_lock
);

705 
	`dput
(
·th
->
d’Œy
);

706 
·th
->
d’Œy
 = 
mouÁpošt
;

707 
	`mÁput
(
·th
->
mÁ
);

708 
·th
->
mÁ
 = 
·»Á
;

710 
	}
}

717 
	$fŞlow_automouÁ
(
·th
 *·th, 
æags
,

718 
boŞ
 *
Ãed_mÁput
)

720 
vfsmouÁ
 *
mÁ
;

721 
”r
;

723 ià(!
·th
->
d’Œy
->
d_İ
 || !·th->d’Œy->d_İ->
d_automouÁ
)

724  -
EREMOTE
;

737 ià(!(
æags
 & (
LOOKUP_PARENT
 | 
LOOKUP_DIRECTORY
 |

738 
LOOKUP_OPEN
 | 
LOOKUP_CREATE
 | 
LOOKUP_AUTOMOUNT
)) &&

739 
·th
->
d’Œy
->
d_šode
)

740  -
EISDIR
;

742 
cu¼’t
->
tÙ®_lšk_couÁ
++;

743 ià(
cu¼’t
->
tÙ®_lšk_couÁ
 >= 40)

744  -
ELOOP
;

746 
mÁ
 = 
·th
->
d’Œy
->
d_İ
->
	`d_automouÁ
(path);

747 ià(
	`IS_ERR
(
mÁ
)) {

757 ià(
	`PTR_ERR
(
mÁ
è=ğ-
EISDIR
 && (
æags
 & 
LOOKUP_PARENT
))

758  -
EREMOTE
;

759  
	`PTR_ERR
(
mÁ
);

762 ià(!
mÁ
)

765 ià(!*
Ãed_mÁput
) {

767 
	`mÁg‘
(
·th
->
mÁ
);

768 *
Ãed_mÁput
 = 
Œue
;

770 
”r
 = 
	`fšish_automouÁ
(
mÁ
, 
·th
);

772 
”r
) {

773 -
EBUSY
:

777 
	`·th_put
(
·th
);

778 
·th
->
mÁ
 = mnt;

779 
·th
->
d’Œy
 = 
	`dg‘
(
mÁ
->
mÁ_roÙ
);

782  
”r
;

785 
	}
}

797 
	$fŞlow_mªaged
(
·th
 *·th, 
æags
)

799 
vfsmouÁ
 *
mÁ
 = 
·th
->mnt;

800 
mªaged
;

801 
boŞ
 
Ãed_mÁput
 = 
çl£
;

802 
»t
 = 0;

807 
mªaged
 = 
	`ACCESS_ONCE
(
·th
->
d’Œy
->
d_æags
),

808 
mªaged
 &ğ
DCACHE_MANAGED_DENTRY
,

809 
	`uÆik–y
(
mªaged
 != 0)) {

812 ià(
mªaged
 & 
DCACHE_MANAGE_TRANSIT
) {

813 
	`BUG_ON
(!
·th
->
d’Œy
->
d_İ
);

814 
	`BUG_ON
(!
·th
->
d’Œy
->
d_İ
->
d_mªage
);

815 
»t
 = 
·th
->
d’Œy
->
d_İ
->
	`d_mªage
Õ©h->d’Œy, 
çl£
);

816 ià(
»t
 < 0)

821 ià(
mªaged
 & 
DCACHE_MOUNTED
) {

822 
vfsmouÁ
 *
mouÁed
 = 
	`lookup_mÁ
(
·th
);

823 ià(
mouÁed
) {

824 
	`dput
(
·th
->
d’Œy
);

825 ià(
Ãed_mÁput
)

826 
	`mÁput
(
·th
->
mÁ
);

827 
·th
->
mÁ
 = 
mouÁed
;

828 
·th
->
d’Œy
 = 
	`dg‘
(
mouÁed
->
mÁ_roÙ
);

829 
Ãed_mÁput
 = 
Œue
;

840 ià(
mªaged
 & 
DCACHE_NEED_AUTOMOUNT
) {

841 
»t
 = 
	`fŞlow_automouÁ
(
·th
, 
æags
, &
Ãed_mÁput
);

842 ià(
»t
 < 0)

851 ià(
Ãed_mÁput
 && 
·th
->
mÁ
 == mnt)

852 
	`mÁput
(
·th
->
mÁ
);

853 ià(
»t
 =ğ-
EISDIR
)

854 
»t
 = 0;

855  
»t
 < 0 ?„‘ : 
Ãed_mÁput
;

856 
	}
}

858 
	$fŞlow_down_Úe
(
·th
 *path)

860 
vfsmouÁ
 *
mouÁed
;

862 
mouÁed
 = 
	`lookup_mÁ
(
·th
);

863 ià(
mouÁed
) {

864 
	`dput
(
·th
->
d’Œy
);

865 
	`mÁput
(
·th
->
mÁ
);

866 
·th
->
mÁ
 = 
mouÁed
;

867 
·th
->
d’Œy
 = 
	`dg‘
(
mouÁed
->
mÁ_roÙ
);

871 
	}
}

873 
šlše
 
boŞ
 
	$mªaged_d’Œy_might_block
(
d’Œy
 *dentry)

875  (
d’Œy
->
d_æags
 & 
DCACHE_MANAGE_TRANSIT
 &&

876 
d’Œy
->
d_İ
->
	`d_mªage
(d’Œy, 
Œue
) < 0);

877 
	}
}

883 
boŞ
 
	$__fŞlow_mouÁ_rcu
(
Çmeid©a
 *
nd
, 
·th
 *path,

884 
šode
 **inode)

887 
vfsmouÁ
 *
mouÁed
;

892 ià(
	`uÆik–y
(
	`mªaged_d’Œy_might_block
(
·th
->
d’Œy
)))

893  
çl£
;

895 ià(!
	`d_mouÁpošt
(
·th
->
d’Œy
))

898 
mouÁed
 = 
	`__lookup_mÁ
(
·th
->
mÁ
,…©h->
d’Œy
, 1);

899 ià(!
mouÁed
)

901 
·th
->
mÁ
 = 
mouÁed
;

902 
·th
->
d’Œy
 = 
mouÁed
->
mÁ_roÙ
;

903 
nd
->
æags
 |ğ
LOOKUP_JUMPED
;

904 
nd
->
£q
 = 
	`»ad_£qcouÁ_begš
(&
·th
->
d’Œy
->
d_£q
);

910 *
šode
 = 
·th
->
d’Œy
->
d_šode
;

912  
Œue
;

913 
	}
}

915 
	$fŞlow_mouÁ_rcu
(
Çmeid©a
 *
nd
)

917 
	`d_mouÁpošt
(
nd
->
·th
.
d’Œy
)) {

918 
vfsmouÁ
 *
mouÁed
;

919 
mouÁed
 = 
	`__lookup_mÁ
(
nd
->
·th
.
mÁ
,‚d->·th.
d’Œy
, 1);

920 ià(!
mouÁed
)

922 
nd
->
·th
.
mÁ
 = 
mouÁed
;

923 
nd
->
·th
.
d’Œy
 = 
mouÁed
->
mÁ_roÙ
;

924 
nd
->
£q
 = 
	`»ad_£qcouÁ_begš
(&nd->
·th
.
d’Œy
->
d_£q
);

926 
	}
}

928 
	$fŞlow_dÙdÙ_rcu
(
Çmeid©a
 *
nd
)

930 
	`£t_roÙ_rcu
(
nd
);

933 ià(
nd
->
·th
.
d’Œy
 =ğnd->
roÙ
.dentry &&

934 
nd
->
·th
.
mÁ
 =ğnd->
roÙ
.mnt) {

937 ià(
nd
->
·th
.
d’Œy
 !ğnd->·th.
mÁ
->
mÁ_roÙ
) {

938 
d’Œy
 *
Şd
 = 
nd
->
·th
.dentry;

939 
d’Œy
 *
·»Á
 = 
Şd
->
d_·»Á
;

940 
£q
;

942 
£q
 = 
	`»ad_£qcouÁ_begš
(&
·»Á
->
d_£q
);

943 ià(
	`»ad_£qcouÁ_»Œy
(&
Şd
->
d_£q
, 
nd
->
£q
))

944 
çed
;

945 
nd
->
·th
.
d’Œy
 = 
·»Á
;

946 
nd
->
£q
 = seq;

949 ià(!
	`fŞlow_up_rcu
(&
nd
->
·th
))

951 
nd
->
£q
 = 
	`»ad_£qcouÁ_begš
(&nd->
·th
.
d’Œy
->
d_£q
);

953 
	`fŞlow_mouÁ_rcu
(
nd
);

954 
nd
->
šode
 =‚d->
·th
.
d’Œy
->
d_šode
;

957 
çed
:

958 
nd
->
æags
 &ğ~
LOOKUP_RCU
;

959 ià(!(
nd
->
æags
 & 
LOOKUP_ROOT
))

960 
nd
->
roÙ
.
mÁ
 = 
NULL
;

961 
	`rcu_»ad_uÆock
();

962 
	`br_»ad_uÆock
(
vfsmouÁ_lock
);

963  -
ECHILD
;

964 
	}
}

971 
	$fŞlow_down
(
·th
 *path)

973 
mªaged
;

974 
»t
;

976 
mªaged
 = 
	`ACCESS_ONCE
(
·th
->
d’Œy
->
d_æags
),

977 
	`uÆik–y
(
mªaged
 & 
DCACHE_MANAGED_DENTRY
)) {

988 ià(
mªaged
 & 
DCACHE_MANAGE_TRANSIT
) {

989 
	`BUG_ON
(!
·th
->
d’Œy
->
d_İ
);

990 
	`BUG_ON
(!
·th
->
d’Œy
->
d_İ
->
d_mªage
);

991 
»t
 = 
·th
->
d’Œy
->
d_İ
->
	`d_mªage
(

992 
·th
->
d’Œy
, 
çl£
);

993 ià(
»t
 < 0)

994  
»t
 =ğ-
EISDIR
 ? 0 :„et;

998 ià(
mªaged
 & 
DCACHE_MOUNTED
) {

999 
vfsmouÁ
 *
mouÁed
 = 
	`lookup_mÁ
(
·th
);

1000 ià(!
mouÁed
)

1002 
	`dput
(
·th
->
d’Œy
);

1003 
	`mÁput
(
·th
->
mÁ
);

1004 
·th
->
mÁ
 = 
mouÁed
;

1005 
·th
->
d’Œy
 = 
	`dg‘
(
mouÁed
->
mÁ_roÙ
);

1013 
	}
}

1018 
	$fŞlow_mouÁ
(
·th
 *path)

1020 
	`d_mouÁpošt
(
·th
->
d’Œy
)) {

1021 
vfsmouÁ
 *
mouÁed
 = 
	`lookup_mÁ
(
·th
);

1022 ià(!
mouÁed
)

1024 
	`dput
(
·th
->
d’Œy
);

1025 
	`mÁput
(
·th
->
mÁ
);

1026 
·th
->
mÁ
 = 
mouÁed
;

1027 
·th
->
d’Œy
 = 
	`dg‘
(
mouÁed
->
mÁ_roÙ
);

1029 
	}
}

1031 
	$fŞlow_dÙdÙ
(
Çmeid©a
 *
nd
)

1033 
	`£t_roÙ
(
nd
);

1036 
d’Œy
 *
Şd
 = 
nd
->
·th
.dentry;

1038 ià(
nd
->
·th
.
d’Œy
 =ğnd->
roÙ
.dentry &&

1039 
nd
->
·th
.
mÁ
 =ğnd->
roÙ
.mnt) {

1042 ià(
nd
->
·th
.
d’Œy
 !ğnd->·th.
mÁ
->
mÁ_roÙ
) {

1044 
nd
->
·th
.
d’Œy
 = 
	`dg‘_·»Á
(nd->path.dentry);

1045 
	`dput
(
Şd
);

1048 ià(!
	`fŞlow_up
(&
nd
->
·th
))

1051 
	`fŞlow_mouÁ
(&
nd
->
·th
);

1052 
nd
->
šode
 =‚d->
·th
.
d’Œy
->
d_šode
;

1053 
	}
}

1061 
d’Œy
 *
	$d_®loc_ªd_lookup
(
d’Œy
 *
·»Á
,

1062 
q¡r
 *
Çme
, 
Çmeid©a
 *
nd
)

1064 
šode
 *šodğ
·»Á
->
d_šode
;

1065 
d’Œy
 *dentry;

1066 
d’Œy
 *
Şd
;

1069 ià(
	`uÆik–y
(
	`IS_DEADDIR
(
šode
)))

1070  
	`ERR_PTR
(-
ENOENT
);

1072 
d’Œy
 = 
	`d_®loc
(
·»Á
, 
Çme
);

1073 ià(
	`uÆik–y
(!
d’Œy
))

1074  
	`ERR_PTR
(-
ENOMEM
);

1076 
Şd
 = 
šode
->
i_İ
->
	`lookup
(šode, 
d’Œy
, 
nd
);

1077 ià(
	`uÆik–y
(
Şd
)) {

1078 
	`dput
(
d’Œy
);

1079 
d’Œy
 = 
Şd
;

1081  
d’Œy
;

1082 
	}
}

1090 
d’Œy
 *
	$d_šode_lookup
(
d’Œy
 *
·»Á
, dentry *dentry,

1091 
Çmeid©a
 *
nd
)

1093 
šode
 *šodğ
·»Á
->
d_šode
;

1094 
d’Œy
 *
Şd
;

1097 ià(
	`uÆik–y
(
	`IS_DEADDIR
(
šode
)))

1098  
	`ERR_PTR
(-
ENOENT
);

1100 
Şd
 = 
šode
->
i_İ
->
	`lookup
(šode, 
d’Œy
, 
nd
);

1101 ià(
	`uÆik–y
(
Şd
)) {

1102 
	`dput
(
d’Œy
);

1103 
d’Œy
 = 
Şd
;

1105  
d’Œy
;

1106 
	}
}

1113 
	$do_lookup
(
Çmeid©a
 *
nd
, 
q¡r
 *
Çme
,

1114 
·th
 *·th, 
šode
 **inode)

1116 
vfsmouÁ
 *
mÁ
 = 
nd
->
·th
.mnt;

1117 
d’Œy
 *d’Œy, *
·»Á
 = 
nd
->
·th
.dentry;

1118 
Ãed_»v®
 = 1;

1119 
¡©us
 = 1;

1120 
”r
;

1127 ià(
nd
->
æags
 & 
LOOKUP_RCU
) {

1128 
£q
;

1129 *
šode
 = 
nd
->inode;

1130 
d’Œy
 = 
	`__d_lookup_rcu
(
·»Á
, 
Çme
, &
£q
, 
šode
);

1131 ià(!
d’Œy
)

1132 
uÆazy
;

1135 ià(
	`__»ad_£qcouÁ_»Œy
(&
·»Á
->
d_£q
, 
nd
->
£q
))

1136  -
ECHILD
;

1137 
nd
->
£q
 = seq;

1139 ià(
	`uÆik–y
(
d’Œy
->
d_æags
 & 
DCACHE_OP_REVALIDATE
)) {

1140 
¡©us
 = 
	`d_»v®id©e
(
d’Œy
, 
nd
);

1141 ià(
	`uÆik–y
(
¡©us
 <= 0)) {

1142 ià(
¡©us
 !ğ-
ECHILD
)

1143 
Ãed_»v®
 = 0;

1144 
uÆazy
;

1147 ià(
	`uÆik–y
(
	`d_Ãed_lookup
(
d’Œy
)))

1148 
uÆazy
;

1149 
·th
->
mÁ
 = mnt;

1150 
·th
->
d’Œy
 = dentry;

1151 ià(
	`uÆik–y
(!
	`__fŞlow_mouÁ_rcu
(
nd
, 
·th
, 
šode
)))

1152 
uÆazy
;

1153 ià(
	`uÆik–y
(
·th
->
d’Œy
->
d_æags
 & 
DCACHE_NEED_AUTOMOUNT
))

1154 
uÆazy
;

1156 
uÆazy
:

1157 ià(
	`uÆazy_w®k
(
nd
, 
d’Œy
))

1158  -
ECHILD
;

1160 
d’Œy
 = 
	`__d_lookup
(
·»Á
, 
Çme
);

1163 ià(
d’Œy
 && 
	`uÆik–y
(
	`d_Ãed_lookup
(dentry))) {

1164 
	`dput
(
d’Œy
);

1165 
d’Œy
 = 
NULL
;

1167 
»Œy
:

1168 ià(
	`uÆik–y
(!
d’Œy
)) {

1169 
šode
 *
dœ
 = 
·»Á
->
d_šode
;

1170 
	`BUG_ON
(
nd
->
šode
 !ğ
dœ
);

1172 
	`mu‹x_lock
(&
dœ
->
i_mu‹x
);

1173 
d’Œy
 = 
	`d_lookup
(
·»Á
, 
Çme
);

1174 ià(
	`lik–y
(!
d’Œy
)) {

1175 
d’Œy
 = 
	`d_®loc_ªd_lookup
(
·»Á
, 
Çme
, 
nd
);

1176 ià(
	`IS_ERR
(
d’Œy
)) {

1177 
	`mu‹x_uÆock
(&
dœ
->
i_mu‹x
);

1178  
	`PTR_ERR
(
d’Œy
);

1181 
Ãed_»v®
 = 0;

1182 
¡©us
 = 1;

1183 } ià(
	`uÆik–y
(
	`d_Ãed_lookup
(
d’Œy
))) {

1184 
d’Œy
 = 
	`d_šode_lookup
(
·»Á
, d’Œy, 
nd
);

1185 ià(
	`IS_ERR
(
d’Œy
)) {

1186 
	`mu‹x_uÆock
(&
dœ
->
i_mu‹x
);

1187  
	`PTR_ERR
(
d’Œy
);

1190 
Ãed_»v®
 = 0;

1191 
¡©us
 = 1;

1193 
	`mu‹x_uÆock
(&
dœ
->
i_mu‹x
);

1195 ià(
	`uÆik–y
(
d’Œy
->
d_æags
 & 
DCACHE_OP_REVALIDATE
è&& 
Ãed_»v®
)

1196 
¡©us
 = 
	`d_»v®id©e
(
d’Œy
, 
nd
);

1197 ià(
	`uÆik–y
(
¡©us
 <= 0)) {

1198 ià(
¡©us
 < 0) {

1199 
	`dput
(
d’Œy
);

1200  
¡©us
;

1202 ià(!
	`d_šv®id©e
(
d’Œy
)) {

1203 
	`dput
(
d’Œy
);

1204 
d’Œy
 = 
NULL
;

1205 
Ãed_»v®
 = 1;

1206 
»Œy
;

1210 
·th
->
mÁ
 = mnt;

1211 
·th
->
d’Œy
 = dentry;

1212 
”r
 = 
	`fŞlow_mªaged
(
·th
, 
nd
->
æags
);

1213 ià(
	`uÆik–y
(
”r
 < 0)) {

1214 
	`·th_put_cÚd™iÚ®
(
·th
, 
nd
);

1215  
”r
;

1217 ià(
”r
)

1218 
nd
->
æags
 |ğ
LOOKUP_JUMPED
;

1219 *
šode
 = 
·th
->
d’Œy
->
d_šode
;

1221 
	}
}

1223 
šlše
 
	$may_lookup
(
Çmeid©a
 *
nd
)

1225 ià(
nd
->
æags
 & 
LOOKUP_RCU
) {

1226 
”r
 = 
	`šode_³rmissiÚ
(
nd
->
šode
, 
MAY_EXEC
|
MAY_NOT_BLOCK
);

1227 ià(
”r
 !ğ-
ECHILD
)

1228  
”r
;

1229 ià(
	`uÆazy_w®k
(
nd
, 
NULL
))

1230  -
ECHILD
;

1232  
	`šode_³rmissiÚ
(
nd
->
šode
, 
MAY_EXEC
);

1233 
	}
}

1235 
šlše
 
	$hªdË_dÙs
(
Çmeid©a
 *
nd
, 
ty³
)

1237 ià(
ty³
 =ğ
LAST_DOTDOT
) {

1238 ià(
nd
->
æags
 & 
LOOKUP_RCU
) {

1239 ià(
	`fŞlow_dÙdÙ_rcu
(
nd
))

1240  -
ECHILD
;

1242 
	`fŞlow_dÙdÙ
(
nd
);

1245 
	}
}

1247 
	$‹rmš©e_w®k
(
Çmeid©a
 *
nd
)

1249 ià(!(
nd
->
æags
 & 
LOOKUP_RCU
)) {

1250 
	`·th_put
(&
nd
->
·th
);

1252 
nd
->
æags
 &ğ~
LOOKUP_RCU
;

1253 ià(!(
nd
->
æags
 & 
LOOKUP_ROOT
))

1254 
nd
->
roÙ
.
mÁ
 = 
NULL
;

1255 
	`rcu_»ad_uÆock
();

1256 
	`br_»ad_uÆock
(
vfsmouÁ_lock
);

1258 
	}
}

1266 
šlše
 
	$should_fŞlow_lšk
(
šode
 *šode, 
fŞlow
)

1268 ià(
	`uÆik–y
(!(
šode
->
i_İæags
 & 
IOP_NOFOLLOW
))) {

1269 ià(
	`lik–y
(
šode
->
i_İ
->
fŞlow_lšk
))

1270  
fŞlow
;

1273 
	`¥š_lock
(&
šode
->
i_lock
);

1274 
šode
->
i_İæags
 |ğ
IOP_NOFOLLOW
;

1275 
	`¥š_uÆock
(&
šode
->
i_lock
);

1278 
	}
}

1280 
šlše
 
	$w®k_compÚ’t
(
Çmeid©a
 *
nd
, 
·th
 *path,

1281 
q¡r
 *
Çme
, 
ty³
, 
fŞlow
)

1283 
šode
 *inode;

1284 
”r
;

1290 ià(
	`uÆik–y
(
ty³
 !ğ
LAST_NORM
))

1291  
	`hªdË_dÙs
(
nd
, 
ty³
);

1292 
”r
 = 
	`do_lookup
(
nd
, 
Çme
, 
·th
, &
šode
);

1293 ià(
	`uÆik–y
(
”r
)) {

1294 
	`‹rmš©e_w®k
(
nd
);

1295  
”r
;

1297 ià(!
šode
) {

1298 
	`·th_to_Çmeid©a
(
·th
, 
nd
);

1299 
	`‹rmš©e_w®k
(
nd
);

1300  -
ENOENT
;

1302 ià(
	`should_fŞlow_lšk
(
šode
, 
fŞlow
)) {

1303 ià(
nd
->
æags
 & 
LOOKUP_RCU
) {

1304 ià(
	`uÆik–y
(
	`uÆazy_w®k
(
nd
, 
·th
->
d’Œy
))) {

1305 
	`‹rmš©e_w®k
(
nd
);

1306  -
ECHILD
;

1309 
	`BUG_ON
(
šode
 !ğ
·th
->
d’Œy
->
d_šode
);

1312 
	`·th_to_Çmeid©a
(
·th
, 
nd
);

1313 
nd
->
šode
 = inode;

1315 
	}
}

1324 
šlše
 
	$Ã¡ed_symlšk
(
·th
 *·th, 
Çmeid©a
 *
nd
)

1326 
»s
;

1328 ià(
	`uÆik–y
(
cu¼’t
->
lšk_couÁ
 >ğ
MAX_NESTED_LINKS
)) {

1329 
	`·th_put_cÚd™iÚ®
(
·th
, 
nd
);

1330 
	`·th_put
(&
nd
->
·th
);

1331  -
ELOOP
;

1333 
	`BUG_ON
(
nd
->
d•th
 >ğ
MAX_NESTED_LINKS
);

1335 
nd
->
d•th
++;

1336 
cu¼’t
->
lšk_couÁ
++;

1339 
·th
 
lšk
 = *path;

1340 *
cook›
;

1342 
»s
 = 
	`fŞlow_lšk
(&
lšk
, 
nd
, &
cook›
);

1343 ià(!
»s
)

1344 
»s
 = 
	`w®k_compÚ’t
(
nd
, 
·th
, &nd->
Ï¡
,

1345 
nd
->
Ï¡_ty³
, 
LOOKUP_FOLLOW
);

1346 
	`put_lšk
(
nd
, &
lšk
, 
cook›
);

1347 } 
»s
 > 0);

1349 
cu¼’t
->
lšk_couÁ
--;

1350 
nd
->
d•th
--;

1351  
»s
;

1352 
	}
}

1360 
šlše
 
	$ÿn_lookup
(
šode
 *inode)

1362 ià(
	`lik–y
(
šode
->
i_İæags
 & 
IOP_LOOKUP
))

1364 ià(
	`lik–y
(!
šode
->
i_İ
->
lookup
))

1368 
	`¥š_lock
(&
šode
->
i_lock
);

1369 
šode
->
i_İæags
 |ğ
IOP_LOOKUP
;

1370 
	`¥š_uÆock
(&
šode
->
i_lock
);

1372 
	}
}

1382 
	$lšk_·th_w®k
(cÚ¡ *
Çme
, 
Çmeid©a
 *
nd
)

1384 
·th
 
Ãxt
;

1385 
”r
;

1387 *
Çme
=='/')

1388 
Çme
++;

1389 ià(!*
Çme
)

1394 
hash
;

1395 
q¡r
 
this
;

1396 
c
;

1397 
ty³
;

1399 
”r
 = 
	`may_lookup
(
nd
);

1400 ià(
”r
)

1403 
this
.
Çme
 =‚ame;

1404 
c
 = *(cÚ¡ *)
Çme
;

1406 
hash
 = 
	`š™_Çme_hash
();

1408 
Çme
++;

1409 
hash
 = 
	`·¹Ÿl_Çme_hash
(
c
, hash);

1410 
c
 = *(cÚ¡ *)
Çme
;

1411 } 
c
 && (c != '/'));

1412 
this
.
Ën
 = 
Çme
 - (const *)his.name;

1413 
this
.
hash
 = 
	`’d_Çme_hash
(hash);

1415 
ty³
 = 
LAST_NORM
;

1416 ià(
this
.
Çme
[0] =ğ'.'èthis.
Ën
) {

1418 ià(
this
.
Çme
[1] == '.') {

1419 
ty³
 = 
LAST_DOTDOT
;

1420 
nd
->
æags
 |ğ
LOOKUP_JUMPED
;

1424 
ty³
 = 
LAST_DOT
;

1426 ià(
	`lik–y
(
ty³
 =ğ
LAST_NORM
)) {

1427 
d’Œy
 *
·»Á
 = 
nd
->
·th
.dentry;

1428 
nd
->
æags
 &ğ~
LOOKUP_JUMPED
;

1429 ià(
	`uÆik–y
(
·»Á
->
d_æags
 & 
DCACHE_OP_HASH
)) {

1430 
”r
 = 
·»Á
->
d_İ
->
	`d_hash
Õ¬’t, 
nd
->
šode
,

1431 &
this
);

1432 ià(
”r
 < 0)

1438 ià(!
c
)

1439 
Ï¡_compÚ’t
;

1440 *++
Çme
 == '/');

1441 ià(!*
Çme
)

1442 
Ï¡_compÚ’t
;

1444 
”r
 = 
	`w®k_compÚ’t
(
nd
, &
Ãxt
, &
this
, 
ty³
, 
LOOKUP_FOLLOW
);

1445 ià(
”r
 < 0)

1446  
”r
;

1448 ià(
”r
) {

1449 
”r
 = 
	`Ã¡ed_symlšk
(&
Ãxt
, 
nd
);

1450 ià(
”r
)

1451  
”r
;

1453 ià(
	`ÿn_lookup
(
nd
->
šode
))

1455 
”r
 = -
ENOTDIR
;

1459 
Ï¡_compÚ’t
:

1460 
nd
->
Ï¡
 = 
this
;

1461 
nd
->
Ï¡_ty³
 = 
ty³
;

1464 
	`‹rmš©e_w®k
(
nd
);

1465  
”r
;

1466 
	}
}

1468 
	$·th_š™
(
dfd
, cÚ¡ *
Çme
, 
æags
,

1469 
Çmeid©a
 *
nd
, 
fe
 **
å
)

1471 
»tv®
 = 0;

1472 
åut_Ãeded
;

1473 
fe
 *file;

1475 
nd
->
Ï¡_ty³
 = 
LAST_ROOT
;

1476 
nd
->
æags
 = fÏg | 
LOOKUP_JUMPED
;

1477 
nd
->
d•th
 = 0;

1478 ià(
æags
 & 
LOOKUP_ROOT
) {

1479 
šode
 *šodğ
nd
->
roÙ
.
d’Œy
->
d_šode
;

1480 ià(*
Çme
) {

1481 ià(!
šode
->
i_İ
->
lookup
)

1482  -
ENOTDIR
;

1483 
»tv®
 = 
	`šode_³rmissiÚ
(
šode
, 
MAY_EXEC
);

1484 ià(
»tv®
)

1485  
»tv®
;

1487 
nd
->
·th
 =‚d->
roÙ
;

1488 
nd
->
šode
 = inode;

1489 ià(
æags
 & 
LOOKUP_RCU
) {

1490 
	`br_»ad_lock
(
vfsmouÁ_lock
);

1491 
	`rcu_»ad_lock
();

1492 
nd
->
£q
 = 
	`__»ad_£qcouÁ_begš
(&nd->
·th
.
d’Œy
->
d_£q
);

1494 
	`·th_g‘
(&
nd
->
·th
);

1499 
nd
->
roÙ
.
mÁ
 = 
NULL
;

1501 ià(*
Çme
=='/') {

1502 ià(
æags
 & 
LOOKUP_RCU
) {

1503 
	`br_»ad_lock
(
vfsmouÁ_lock
);

1504 
	`rcu_»ad_lock
();

1505 
	`£t_roÙ_rcu
(
nd
);

1507 
	`£t_roÙ
(
nd
);

1508 
	`·th_g‘
(&
nd
->
roÙ
);

1510 
nd
->
·th
 =‚d->
roÙ
;

1511 } ià(
dfd
 =ğ
AT_FDCWD
) {

1512 ià(
æags
 & 
LOOKUP_RCU
) {

1513 
fs_¡ruù
 *
fs
 = 
cu¼’t
->fs;

1514 
£q
;

1516 
	`br_»ad_lock
(
vfsmouÁ_lock
);

1517 
	`rcu_»ad_lock
();

1520 
£q
 = 
	`»ad_£qcouÁ_begš
(&
fs
->seq);

1521 
nd
->
·th
 = 
fs
->
pwd
;

1522 
nd
->
£q
 = 
	`__»ad_£qcouÁ_begš
(&nd->
·th
.
d’Œy
->
d_£q
);

1523 } 
	`»ad_£qcouÁ_»Œy
(&
fs
->
£q
, seq));

1525 
	`g‘_fs_pwd
(
cu¼’t
->
fs
, &
nd
->
·th
);

1528 
d’Œy
 *dentry;

1530 
fe
 = 
	`fg‘_¿w_light
(
dfd
, &
åut_Ãeded
);

1531 
»tv®
 = -
EBADF
;

1532 ià(!
fe
)

1533 
out_ç
;

1535 
d’Œy
 = 
fe
->
f_·th
.dentry;

1537 ià(*
Çme
) {

1538 
»tv®
 = -
ENOTDIR
;

1539 ià(!
	`S_ISDIR
(
d’Œy
->
d_šode
->
i_mode
))

1540 
åut_ç
;

1542 
»tv®
 = 
	`šode_³rmissiÚ
(
d’Œy
->
d_šode
, 
MAY_EXEC
);

1543 ià(
»tv®
)

1544 
åut_ç
;

1547 
nd
->
·th
 = 
fe
->
f_·th
;

1548 ià(
æags
 & 
LOOKUP_RCU
) {

1549 ià(
åut_Ãeded
)

1550 *
å
 = 
fe
;

1551 
nd
->
£q
 = 
	`__»ad_£qcouÁ_begš
(&nd->
·th
.
d’Œy
->
d_£q
);

1552 
	`br_»ad_lock
(
vfsmouÁ_lock
);

1553 
	`rcu_»ad_lock
();

1555 
	`·th_g‘
(&
fe
->
f_·th
);

1556 
	`åut_light
(
fe
, 
åut_Ãeded
);

1560 
nd
->
šode
 =‚d->
·th
.
d’Œy
->
d_šode
;

1563 
åut_ç
:

1564 
	`åut_light
(
fe
, 
åut_Ãeded
);

1565 
out_ç
:

1566  
»tv®
;

1567 
	}
}

1569 
šlše
 
	$lookup_Ï¡
(
Çmeid©a
 *
nd
, 
·th
 *path)

1571 ià(
nd
->
Ï¡_ty³
 =ğ
LAST_NORM
 &&‚d->
Ï¡
.
Çme
[nd->Ï¡.
Ën
])

1572 
nd
->
æags
 |ğ
LOOKUP_FOLLOW
 | 
LOOKUP_DIRECTORY
;

1574 
nd
->
æags
 &ğ~
LOOKUP_PARENT
;

1575  
	`w®k_compÚ’t
(
nd
, 
·th
, &nd->
Ï¡
,‚d->
Ï¡_ty³
,

1576 
nd
->
æags
 & 
LOOKUP_FOLLOW
);

1577 
	}
}

1580 
	$·th_looku·t
(
dfd
, cÚ¡ *
Çme
,

1581 
æags
, 
Çmeid©a
 *
nd
)

1583 
fe
 *
ba£
 = 
NULL
;

1584 
·th
…ath;

1585 
”r
;

1601 
”r
 = 
	`·th_š™
(
dfd
, 
Çme
, 
æags
 | 
LOOKUP_PARENT
, 
nd
, &
ba£
);

1603 ià(
	`uÆik–y
(
”r
))

1604  
”r
;

1606 
cu¼’t
->
tÙ®_lšk_couÁ
 = 0;

1607 
”r
 = 
	`lšk_·th_w®k
(
Çme
, 
nd
);

1609 ià(!
”r
 && !(
æags
 & 
LOOKUP_PARENT
)) {

1610 
”r
 = 
	`lookup_Ï¡
(
nd
, &
·th
);

1611 
”r
 > 0) {

1612 *
cook›
;

1613 
·th
 
lšk
 =…ath;

1614 
nd
->
æags
 |ğ
LOOKUP_PARENT
;

1615 
”r
 = 
	`fŞlow_lšk
(&
lšk
, 
nd
, &
cook›
);

1616 ià(!
”r
)

1617 
”r
 = 
	`lookup_Ï¡
(
nd
, &
·th
);

1618 
	`put_lšk
(
nd
, &
lšk
, 
cook›
);

1622 ià(!
”r
)

1623 
”r
 = 
	`com¶‘e_w®k
(
nd
);

1625 ià(!
”r
 && 
nd
->
æags
 & 
LOOKUP_DIRECTORY
) {

1626 ià(!
nd
->
šode
->
i_İ
->
lookup
) {

1627 
	`·th_put
(&
nd
->
·th
);

1628 
”r
 = -
ENOTDIR
;

1632 ià(
ba£
)

1633 
	`åut
(
ba£
);

1635 ià(
nd
->
roÙ
.
mÁ
 && !Òd->
æags
 & 
LOOKUP_ROOT
)) {

1636 
	`·th_put
(&
nd
->
roÙ
);

1637 
nd
->
roÙ
.
mÁ
 = 
NULL
;

1639  
”r
;

1640 
	}
}

1642 
	$do_·th_lookup
(
dfd
, cÚ¡ *
Çme
,

1643 
æags
, 
Çmeid©a
 *
nd
)

1645 
»tv®
 = 
	`·th_looku·t
(
dfd
, 
Çme
, 
æags
 | 
LOOKUP_RCU
, 
nd
);

1646 ià(
	`uÆik–y
(
»tv®
 =ğ-
ECHILD
))

1647 
»tv®
 = 
	`·th_looku·t
(
dfd
, 
Çme
, 
æags
, 
nd
);

1648 ià(
	`uÆik–y
(
»tv®
 =ğ-
ESTALE
))

1649 
»tv®
 = 
	`·th_looku·t
(
dfd
, 
Çme
, 
æags
 | 
LOOKUP_REVAL
, 
nd
);

1651 ià(
	`lik–y
(!
»tv®
)) {

1652 ià(
	`uÆik–y
(!
	`aud™_dummy_cÚ‹xt
())) {

1653 ià(
nd
->
·th
.
d’Œy
 &&‚d->
šode
)

1654 
	`aud™_šode
(
Çme
, 
nd
->
·th
.
d’Œy
);

1657  
»tv®
;

1658 
	}
}

1660 
	$k”n_·th_·»Á
(cÚ¡ *
Çme
, 
Çmeid©a
 *
nd
)

1662  
	`do_·th_lookup
(
AT_FDCWD
, 
Çme
, 
LOOKUP_PARENT
, 
nd
);

1663 
	}
}

1665 
	$k”n_·th
(cÚ¡ *
Çme
, 
æags
, 
·th
 *path)

1667 
Çmeid©a
 
nd
;

1668 
»s
 = 
	`do_·th_lookup
(
AT_FDCWD
, 
Çme
, 
æags
, &
nd
);

1669 ià(!
»s
)

1670 *
·th
 = 
nd
.path;

1671  
»s
;

1672 
	}
}

1682 
	$vfs_·th_lookup
(
d’Œy
 *d’Œy, 
vfsmouÁ
 *
mÁ
,

1683 cÚ¡ *
Çme
, 
æags
,

1684 
·th
 *path)

1686 
Çmeid©a
 
nd
;

1687 
”r
;

1688 
nd
.
roÙ
.
d’Œy
 = dentry;

1689 
nd
.
roÙ
.
mÁ
 = mnt;

1690 
	`BUG_ON
(
æags
 & 
LOOKUP_PARENT
);

1692 
”r
 = 
	`do_·th_lookup
(
AT_FDCWD
, 
Çme
, 
æags
 | 
LOOKUP_ROOT
, &
nd
);

1693 ià(!
”r
)

1694 *
·th
 = 
nd
.path;

1695  
”r
;

1696 
	}
}

1698 
d’Œy
 *
	$__lookup_hash
(
q¡r
 *
Çme
,

1699 
d’Œy
 *
ba£
, 
Çmeid©a
 *
nd
)

1701 
šode
 *šodğ
ba£
->
d_šode
;

1702 
d’Œy
 *dentry;

1703 
”r
;

1705 
”r
 = 
	`šode_³rmissiÚ
(
šode
, 
MAY_EXEC
);

1706 ià(
”r
)

1707  
	`ERR_PTR
(
”r
);

1714 
d’Œy
 = 
	`d_lookup
(
ba£
, 
Çme
);

1716 ià(
d’Œy
 && 
	`d_Ãed_lookup
(dentry)) {

1721 
d’Œy
 = 
	`d_šode_lookup
(
ba£
, d’Œy, 
nd
);

1722 ià(
	`IS_ERR
(
d’Œy
))

1723  
d’Œy
;

1726 ià(
d’Œy
 && (d’Œy->
d_æags
 & 
DCACHE_OP_REVALIDATE
)) {

1727 
¡©us
 = 
	`d_»v®id©e
(
d’Œy
, 
nd
);

1728 ià(
	`uÆik–y
(
¡©us
 <= 0)) {

1735 ià(
¡©us
 < 0) {

1736 
	`dput
(
d’Œy
);

1737  
	`ERR_PTR
(
¡©us
);

1738 } ià(!
	`d_šv®id©e
(
d’Œy
)) {

1739 
	`dput
(
d’Œy
);

1740 
d’Œy
 = 
NULL
;

1745 ià(!
d’Œy
)

1746 
d’Œy
 = 
	`d_®loc_ªd_lookup
(
ba£
, 
Çme
, 
nd
);

1748  
d’Œy
;

1749 
	}
}

1756 
d’Œy
 *
	$lookup_hash
(
Çmeid©a
 *
nd
)

1758  
	`__lookup_hash
(&
nd
->
Ï¡
,‚d->
·th
.
d’Œy
,‚d);

1759 
	}
}

1772 
d’Œy
 *
	$lookup_Úe_Ën
(cÚ¡ *
Çme
, 
d’Œy
 *
ba£
, 
Ën
)

1774 
q¡r
 
this
;

1775 
hash
;

1776 
c
;

1778 
	`WARN_ON_ONCE
(!
	`mu‹x_is_locked
(&
ba£
->
d_šode
->
i_mu‹x
));

1780 
this
.
Çme
 =‚ame;

1781 
this
.
Ën
 =†en;

1782 ià(!
Ën
)

1783  
	`ERR_PTR
(-
EACCES
);

1785 
hash
 = 
	`š™_Çme_hash
();

1786 
Ën
--) {

1787 
c
 = *(cÚ¡ *)
Çme
++;

1788 ià(
c
 == '/' || c == '\0')

1789  
	`ERR_PTR
(-
EACCES
);

1790 
hash
 = 
	`·¹Ÿl_Çme_hash
(
c
, hash);

1792 
this
.
hash
 = 
	`’d_Çme_hash
(hash);

1797 ià(
ba£
->
d_æags
 & 
DCACHE_OP_HASH
) {

1798 
”r
 = 
ba£
->
d_İ
->
	`d_hash
(ba£, ba£->
d_šode
, &
this
);

1799 ià(
”r
 < 0)

1800  
	`ERR_PTR
(
”r
);

1803  
	`__lookup_hash
(&
this
, 
ba£
, 
NULL
);

1804 
	}
}

1806 
	$u£r_·th_©_em±y
(
dfd
, cÚ¡ 
__u£r
 *
Çme
, 
æags
,

1807 
·th
 *·th, *
em±y
)

1809 
Çmeid©a
 
nd
;

1810 *
tmp
 = 
	`g‘Çme_æags
(
Çme
, 
æags
, 
em±y
);

1811 
”r
 = 
	`PTR_ERR
(
tmp
);

1812 ià(!
	`IS_ERR
(
tmp
)) {

1814 
	`BUG_ON
(
æags
 & 
LOOKUP_PARENT
);

1816 
”r
 = 
	`do_·th_lookup
(
dfd
, 
tmp
, 
æags
, &
nd
);

1817 
	`puŠame
(
tmp
);

1818 ià(!
”r
)

1819 *
·th
 = 
nd
.path;

1821  
”r
;

1822 
	}
}

1824 
	$u£r_·th_©
(
dfd
, cÚ¡ 
__u£r
 *
Çme
, 
æags
,

1825 
·th
 *path)

1827  
	`u£r_·th_©_em±y
(
dfd
, 
Çme
, 
æags
, 
·th
, 0);

1828 
	}
}

1830 
	$u£r_·th_·»Á
(
dfd
, cÚ¡ 
__u£r
 *
·th
,

1831 
Çmeid©a
 *
nd
, **
Çme
)

1833 *
s
 = 
	`g‘Çme
(
·th
);

1834 
”rÜ
;

1836 ià(
	`IS_ERR
(
s
))

1837  
	`PTR_ERR
(
s
);

1839 
”rÜ
 = 
	`do_·th_lookup
(
dfd
, 
s
, 
LOOKUP_PARENT
, 
nd
);

1840 ià(
”rÜ
)

1841 
	`puŠame
(
s
);

1843 *
Çme
 = 
s
;

1845  
”rÜ
;

1846 
	}
}

1852 
šlše
 
	$check_¡icky
(
šode
 *
dœ
, inode *inode)

1854 
uid_t
 
fsuid
 = 
	`cu¼’t_fsuid
();

1856 ià(!(
dœ
->
i_mode
 & 
S_ISVTX
))

1858 ià(
	`cu¼’t_u£r_ns
(è!ğ
	`šode_u£ºs
(
šode
))

1859 
Ùh”_u£ºs
;

1860 ià(
šode
->
i_uid
 =ğ
fsuid
)

1862 ià(
dœ
->
i_uid
 =ğ
fsuid
)

1865 
Ùh”_u£ºs
:

1866  !
	`ns_ÿ·bË
(
	`šode_u£ºs
(
šode
), 
CAP_FOWNER
);

1867 
	}
}

1888 
	$may_d–‘e
(
šode
 *
dœ
,
d’Œy
 *
viùim
,
isdœ
)

1890 
”rÜ
;

1892 ià(!
viùim
->
d_šode
)

1893  -
ENOENT
;

1895 
	`BUG_ON
(
viùim
->
d_·»Á
->
d_šode
 !ğ
dœ
);

1896 
	`aud™_šode_chd
(
viùim
, 
dœ
);

1898 
”rÜ
 = 
	`šode_³rmissiÚ
(
dœ
, 
MAY_WRITE
 | 
MAY_EXEC
);

1899 ià(
”rÜ
)

1900  
”rÜ
;

1901 ià(
	`IS_APPEND
(
dœ
))

1902  -
EPERM
;

1903 ià(
	`check_¡icky
(
dœ
, 
viùim
->
d_šode
)||
	`IS_APPEND
(victim->d_inode)||

1904 
	`IS_IMMUTABLE
(
viùim
->
d_šode
è|| 
	`IS_SWAPFILE
(victim->d_inode))

1905  -
EPERM
;

1906 ià(
isdœ
) {

1907 ià(!
	`S_ISDIR
(
viùim
->
d_šode
->
i_mode
))

1908  -
ENOTDIR
;

1909 ià(
	`IS_ROOT
(
viùim
))

1910  -
EBUSY
;

1911 } ià(
	`S_ISDIR
(
viùim
->
d_šode
->
i_mode
))

1912  -
EISDIR
;

1913 ià(
	`IS_DEADDIR
(
dœ
))

1914  -
ENOENT
;

1915 ià(
viùim
->
d_æags
 & 
DCACHE_NFSFS_RENAMED
)

1916  -
EBUSY
;

1918 
	}
}

1928 
šlše
 
	$may_ü—‹
(
šode
 *
dœ
, 
d’Œy
 *
chd
)

1930 ià(
chd
->
d_šode
)

1931  -
EEXIST
;

1932 ià(
	`IS_DEADDIR
(
dœ
))

1933  -
ENOENT
;

1934  
	`šode_³rmissiÚ
(
dœ
, 
MAY_WRITE
 | 
MAY_EXEC
);

1935 
	}
}

1940 
d’Œy
 *
	$lock_»Çme
(
d’Œy
 *
p1
, d’Œy *
p2
)

1942 
d’Œy
 *
p
;

1944 ià(
p1
 =ğ
p2
) {

1945 
	`mu‹x_lock_Ã¡ed
(&
p1
->
d_šode
->
i_mu‹x
, 
I_MUTEX_PARENT
);

1946  
NULL
;

1949 
	`mu‹x_lock
(&
p1
->
d_šode
->
i_sb
->
s_vfs_»Çme_mu‹x
);

1951 
p
 = 
	`d_ªû¡Ü
(
p2
, 
p1
);

1952 ià(
p
) {

1953 
	`mu‹x_lock_Ã¡ed
(&
p2
->
d_šode
->
i_mu‹x
, 
I_MUTEX_PARENT
);

1954 
	`mu‹x_lock_Ã¡ed
(&
p1
->
d_šode
->
i_mu‹x
, 
I_MUTEX_CHILD
);

1955  
p
;

1958 
p
 = 
	`d_ªû¡Ü
(
p1
, 
p2
);

1959 ià(
p
) {

1960 
	`mu‹x_lock_Ã¡ed
(&
p1
->
d_šode
->
i_mu‹x
, 
I_MUTEX_PARENT
);

1961 
	`mu‹x_lock_Ã¡ed
(&
p2
->
d_šode
->
i_mu‹x
, 
I_MUTEX_CHILD
);

1962  
p
;

1965 
	`mu‹x_lock_Ã¡ed
(&
p1
->
d_šode
->
i_mu‹x
, 
I_MUTEX_PARENT
);

1966 
	`mu‹x_lock_Ã¡ed
(&
p2
->
d_šode
->
i_mu‹x
, 
I_MUTEX_CHILD
);

1967  
NULL
;

1968 
	}
}

1970 
	$uÆock_»Çme
(
d’Œy
 *
p1
, d’Œy *
p2
)

1972 
	`mu‹x_uÆock
(&
p1
->
d_šode
->
i_mu‹x
);

1973 ià(
p1
 !ğ
p2
) {

1974 
	`mu‹x_uÆock
(&
p2
->
d_šode
->
i_mu‹x
);

1975 
	`mu‹x_uÆock
(&
p1
->
d_šode
->
i_sb
->
s_vfs_»Çme_mu‹x
);

1977 
	}
}

1979 
	$vfs_ü—‹
(
šode
 *
dœ
, 
d’Œy
 *d’Œy, 
mode
,

1980 
Çmeid©a
 *
nd
)

1982 
”rÜ
 = 
	`may_ü—‹
(
dœ
, 
d’Œy
);

1984 ià(
”rÜ
)

1985  
”rÜ
;

1987 ià(!
dœ
->
i_İ
->
ü—‹
)

1988  -
EACCES
;

1989 
mode
 &ğ
S_IALLUGO
;

1990 
mode
 |ğ
S_IFREG
;

1991 
”rÜ
 = 
	`£cur™y_šode_ü—‹
(
dœ
, 
d’Œy
, 
mode
);

1992 ià(
”rÜ
)

1993  
”rÜ
;

1994 
”rÜ
 = 
dœ
->
i_İ
->
	`ü—‹
(dœ, 
d’Œy
, 
mode
, 
nd
);

1995 ià(!
”rÜ
)

1996 
	`f¢Ùify_ü—‹
(
dœ
, 
d’Œy
);

1997  
”rÜ
;

1998 
	}
}

2000 
	$may_İ’
(
·th
 *·th, 
acc_mode
, 
æag
)

2002 
d’Œy
 *d’Œy = 
·th
->dentry;

2003 
šode
 *šodğ
d’Œy
->
d_šode
;

2004 
”rÜ
;

2007 ià(!
acc_mode
)

2010 ià(!
šode
)

2011  -
ENOENT
;

2013 
šode
->
i_mode
 & 
S_IFMT
) {

2014 
S_IFLNK
:

2015  -
ELOOP
;

2016 
S_IFDIR
:

2017 ià(
acc_mode
 & 
MAY_WRITE
)

2018  -
EISDIR
;

2020 
S_IFBLK
:

2021 
S_IFCHR
:

2022 ià(
·th
->
mÁ
->
mÁ_æags
 & 
MNT_NODEV
)

2023  -
EACCES
;

2025 
S_IFIFO
:

2026 
S_IFSOCK
:

2027 
æag
 &ğ~
O_TRUNC
;

2031 
”rÜ
 = 
	`šode_³rmissiÚ
(
šode
, 
acc_mode
);

2032 ià(
”rÜ
)

2033  
”rÜ
;

2038 ià(
	`IS_APPEND
(
šode
)) {

2039 ià((
æag
 & 
O_ACCMODE
è!ğ
O_RDONLY
 && !(æag & 
O_APPEND
))

2040  -
EPERM
;

2041 ià(
æag
 & 
O_TRUNC
)

2042  -
EPERM
;

2046 ià(
æag
 & 
O_NOATIME
 && !
	`šode_owÃr_Ü_ÿ·bË
(
šode
))

2047  -
EPERM
;

2050 
	}
}

2052 
	$hªdË_Œunÿ‹
(
fe
 *
fp
)

2054 
·th
 *·th = &
fp
->
f_·th
;

2055 
šode
 *šodğ
·th
->
d’Œy
->
d_šode
;

2056 
”rÜ
 = 
	`g‘_wr™e_acûss
(
šode
);

2057 ià(
”rÜ
)

2058  
”rÜ
;

2062 
”rÜ
 = 
	`locks_v”ify_locked
(
šode
);

2063 ià(!
”rÜ
)

2064 
”rÜ
 = 
	`£cur™y_·th_Œunÿ‹
(
·th
);

2065 ià(!
”rÜ
) {

2066 
”rÜ
 = 
	`do_Œunÿ‹
(
·th
->
d’Œy
, 0,

2067 
ATTR_MTIME
|
ATTR_CTIME
|
ATTR_OPEN
,

2068 
fp
);

2070 
	`put_wr™e_acûss
(
šode
);

2071  
”rÜ
;

2072 
	}
}

2074 
šlše
 
	$İ’_to_Çmei_æags
(
æag
)

2076 ià((
æag
 & 
O_ACCMODE
) == 3)

2077 
æag
--;

2078  
æag
;

2079 
	}
}

2084 
fe
 *
	$do_Ï¡
(
Çmeid©a
 *
nd
, 
·th
 *path,

2085 cÚ¡ 
İ’_æags
 *
İ
, cÚ¡ *
·thÇme
)

2087 
d’Œy
 *
dœ
 = 
nd
->
·th
.dentry;

2088 
d’Œy
 *dentry;

2089 
İ’_æag
 = 
İ
->open_flag;

2090 
wl_Œunÿ‹
 = 
İ’_æag
 & 
O_TRUNC
;

2091 
wªt_wr™e
 = 0;

2092 
acc_mode
 = 
İ
->acc_mode;

2093 
fe
 *
fp
;

2094 
”rÜ
;

2096 
nd
->
æags
 &ğ~
LOOKUP_PARENT
;

2097 
nd
->
æags
 |ğ
İ
->
š‹Á
;

2099 
nd
->
Ï¡_ty³
) {

2100 
LAST_DOTDOT
:

2101 
LAST_DOT
:

2102 
”rÜ
 = 
	`hªdË_dÙs
(
nd
,‚d->
Ï¡_ty³
);

2103 ià(
”rÜ
)

2104  
	`ERR_PTR
(
”rÜ
);

2106 
LAST_ROOT
:

2107 
”rÜ
 = 
	`com¶‘e_w®k
(
nd
);

2108 ià(
”rÜ
)

2109  
	`ERR_PTR
(
”rÜ
);

2110 
	`aud™_šode
(
·thÇme
, 
nd
->
·th
.
d’Œy
);

2111 ià(
İ’_æag
 & 
O_CREAT
) {

2112 
”rÜ
 = -
EISDIR
;

2113 
ex™
;

2115 
ok
;

2116 
LAST_BIND
:

2117 
”rÜ
 = 
	`com¶‘e_w®k
(
nd
);

2118 ià(
”rÜ
)

2119  
	`ERR_PTR
(
”rÜ
);

2120 
	`aud™_šode
(
·thÇme
, 
dœ
);

2121 
ok
;

2124 ià(!(
İ’_æag
 & 
O_CREAT
)) {

2125 
symlšk_ok
 = 0;

2126 ià(
nd
->
Ï¡
.
Çme
[nd->Ï¡.
Ën
])

2127 
nd
->
æags
 |ğ
LOOKUP_FOLLOW
 | 
LOOKUP_DIRECTORY
;

2128 ià(
İ’_æag
 & 
O_PATH
 && !(
nd
->
æags
 & 
LOOKUP_FOLLOW
))

2129 
symlšk_ok
 = 1;

2131 
”rÜ
 = 
	`w®k_compÚ’t
(
nd
, 
·th
, &nd->
Ï¡
, 
LAST_NORM
,

2132 !
symlšk_ok
);

2133 ià(
”rÜ
 < 0)

2134  
	`ERR_PTR
(
”rÜ
);

2135 ià(
”rÜ
)

2136  
NULL
;

2138 
”rÜ
 = 
	`com¶‘e_w®k
(
nd
);

2139 ià(
”rÜ
)

2140  
	`ERR_PTR
(-
ECHILD
);

2142 
”rÜ
 = -
ENOTDIR
;

2143 ià(
nd
->
æags
 & 
LOOKUP_DIRECTORY
) {

2144 ià(!
nd
->
šode
->
i_İ
->
lookup
)

2145 
ex™
;

2147 
	`aud™_šode
(
·thÇme
, 
nd
->
·th
.
d’Œy
);

2148 
ok
;

2156 
”rÜ
 = 
	`com¶‘e_w®k
(
nd
);

2157 ià(
”rÜ
)

2158  
	`ERR_PTR
(
”rÜ
);

2160 
	`aud™_šode
(
·thÇme
, 
dœ
);

2161 
”rÜ
 = -
EISDIR
;

2163 ià(
nd
->
Ï¡
.
Çme
[nd->Ï¡.
Ën
])

2164 
ex™
;

2166 
	`mu‹x_lock
(&
dœ
->
d_šode
->
i_mu‹x
);

2168 
d’Œy
 = 
	`lookup_hash
(
nd
);

2169 
”rÜ
 = 
	`PTR_ERR
(
d’Œy
);

2170 ià(
	`IS_ERR
(
d’Œy
)) {

2171 
	`mu‹x_uÆock
(&
dœ
->
d_šode
->
i_mu‹x
);

2172 
ex™
;

2175 
·th
->
d’Œy
 = dentry;

2176 
·th
->
mÁ
 = 
nd
->path.mnt;

2179 ià(!
d’Œy
->
d_šode
) {

2180 
mode
 = 
İ
->mode;

2181 ià(!
	`IS_POSIXACL
(
dœ
->
d_šode
))

2182 
mode
 &ğ~
	`cu¼’t_umask
();

2190 
”rÜ
 = 
	`mÁ_wªt_wr™e
(
nd
->
·th
.
mÁ
);

2191 ià(
”rÜ
)

2192 
ex™_mu‹x_uÆock
;

2193 
wªt_wr™e
 = 1;

2195 
İ’_æag
 &ğ~
O_TRUNC
;

2196 
wl_Œunÿ‹
 = 0;

2197 
acc_mode
 = 
MAY_OPEN
;

2198 
”rÜ
 = 
	`£cur™y_·th_mknod
(&
nd
->
·th
, 
d’Œy
, 
mode
, 0);

2199 ià(
”rÜ
)

2200 
ex™_mu‹x_uÆock
;

2201 
”rÜ
 = 
	`vfs_ü—‹
(
dœ
->
d_šode
, 
d’Œy
, 
mode
, 
nd
);

2202 ià(
”rÜ
)

2203 
ex™_mu‹x_uÆock
;

2204 
	`mu‹x_uÆock
(&
dœ
->
d_šode
->
i_mu‹x
);

2205 
	`dput
(
nd
->
·th
.
d’Œy
);

2206 
nd
->
·th
.
d’Œy
 = dentry;

2207 
commÚ
;

2213 
	`mu‹x_uÆock
(&
dœ
->
d_šode
->
i_mu‹x
);

2214 
	`aud™_šode
(
·thÇme
, 
·th
->
d’Œy
);

2216 
”rÜ
 = -
EEXIST
;

2217 ià(
İ’_æag
 & 
O_EXCL
)

2218 
ex™_dput
;

2220 
”rÜ
 = 
	`fŞlow_mªaged
(
·th
, 
nd
->
æags
);

2221 ià(
”rÜ
 < 0)

2222 
ex™_dput
;

2224 ià(
”rÜ
)

2225 
nd
->
æags
 |ğ
LOOKUP_JUMPED
;

2227 
”rÜ
 = -
ENOENT
;

2228 ià(!
·th
->
d’Œy
->
d_šode
)

2229 
ex™_dput
;

2231 ià(
·th
->
d’Œy
->
d_šode
->
i_İ
->
fŞlow_lšk
)

2232  
NULL
;

2234 
	`·th_to_Çmeid©a
(
·th
, 
nd
);

2235 
nd
->
šode
 = 
·th
->
d’Œy
->
d_šode
;

2237 
”rÜ
 = 
	`com¶‘e_w®k
(
nd
);

2238 ià(
”rÜ
)

2239 
ex™
;

2240 
”rÜ
 = -
EISDIR
;

2241 ià(
	`S_ISDIR
(
nd
->
šode
->
i_mode
))

2242 
ex™
;

2243 
ok
:

2244 ià(!
	`S_ISREG
(
nd
->
šode
->
i_mode
))

2245 
wl_Œunÿ‹
 = 0;

2247 ià(
wl_Œunÿ‹
) {

2248 
”rÜ
 = 
	`mÁ_wªt_wr™e
(
nd
->
·th
.
mÁ
);

2249 ià(
”rÜ
)

2250 
ex™
;

2251 
wªt_wr™e
 = 1;

2253 
commÚ
:

2254 
”rÜ
 = 
	`may_İ’
(&
nd
->
·th
, 
acc_mode
, 
İ’_æag
);

2255 ià(
”rÜ
)

2256 
ex™
;

2257 
fp
 = 
	`Çmeid©a_to_fp
(
nd
);

2258 ià(!
	`IS_ERR
(
fp
)) {

2259 
”rÜ
 = 
	`ima_fe_check
(
fp
, 
İ
->
acc_mode
);

2260 ià(
”rÜ
) {

2261 
	`åut
(
fp
);

2262 
fp
 = 
	`ERR_PTR
(
”rÜ
);

2265 ià(!
	`IS_ERR
(
fp
)) {

2266 ià(
wl_Œunÿ‹
) {

2267 
”rÜ
 = 
	`hªdË_Œunÿ‹
(
fp
);

2268 ià(
”rÜ
) {

2269 
	`åut
(
fp
);

2270 
fp
 = 
	`ERR_PTR
(
”rÜ
);

2274 
out
:

2275 ià(
wªt_wr™e
)

2276 
	`mÁ_drİ_wr™e
(
nd
->
·th
.
mÁ
);

2277 
	`·th_put
(&
nd
->
·th
);

2278  
fp
;

2280 
ex™_mu‹x_uÆock
:

2281 
	`mu‹x_uÆock
(&
dœ
->
d_šode
->
i_mu‹x
);

2282 
ex™_dput
:

2283 
	`·th_put_cÚd™iÚ®
(
·th
, 
nd
);

2284 
ex™
:

2285 
fp
 = 
	`ERR_PTR
(
”rÜ
);

2286 
out
;

2287 
	}
}

2289 
fe
 *
	$·th_İ’©
(
dfd
, cÚ¡ *
·thÇme
,

2290 
Çmeid©a
 *
nd
, cÚ¡ 
İ’_æags
 *
İ
, 
æags
)

2292 
fe
 *
ba£
 = 
NULL
;

2293 
fe
 *
fp
;

2294 
·th
…ath;

2295 
”rÜ
;

2297 
fp
 = 
	`g‘_em±y_fp
();

2298 ià(!
fp
)

2299  
	`ERR_PTR
(-
ENFILE
);

2301 
fp
->
f_æags
 = 
İ
->
İ’_æag
;

2302 
nd
->
š‹Á
.
İ’
.
fe
 = 
fp
;

2303 
nd
->
š‹Á
.
İ’
.
æags
 = 
	`İ’_to_Çmei_æags
(
İ
->
İ’_æag
);

2304 
nd
->
š‹Á
.
İ’
.
ü—‹_mode
 = 
İ
->
mode
;

2306 
”rÜ
 = 
	`·th_š™
(
dfd
, 
·thÇme
, 
æags
 | 
LOOKUP_PARENT
, 
nd
, &
ba£
);

2307 ià(
	`uÆik–y
(
”rÜ
))

2308 
out_fp
;

2310 
cu¼’t
->
tÙ®_lšk_couÁ
 = 0;

2311 
”rÜ
 = 
	`lšk_·th_w®k
(
·thÇme
, 
nd
);

2312 ià(
	`uÆik–y
(
”rÜ
))

2313 
out_fp
;

2315 
fp
 = 
	`do_Ï¡
(
nd
, &
·th
, 
İ
, 
·thÇme
);

2316 
	`uÆik–y
(!
fp
)) {

2317 
·th
 
lšk
 =…ath;

2318 *
cook›
;

2319 ià(!(
nd
->
æags
 & 
LOOKUP_FOLLOW
)) {

2320 
	`·th_put_cÚd™iÚ®
(&
·th
, 
nd
);

2321 
	`·th_put
(&
nd
->
·th
);

2322 
fp
 = 
	`ERR_PTR
(-
ELOOP
);

2325 
nd
->
æags
 |ğ
LOOKUP_PARENT
;

2326 
nd
->
æags
 &ğ~(
LOOKUP_OPEN
|
LOOKUP_CREATE
|
LOOKUP_EXCL
);

2327 
”rÜ
 = 
	`fŞlow_lšk
(&
lšk
, 
nd
, &
cook›
);

2328 ià(
	`uÆik–y
(
”rÜ
))

2329 
fp
 = 
	`ERR_PTR
(
”rÜ
);

2331 
fp
 = 
	`do_Ï¡
(
nd
, &
·th
, 
İ
, 
·thÇme
);

2332 
	`put_lšk
(
nd
, &
lšk
, 
cook›
);

2334 
out
:

2335 ià(
nd
->
roÙ
.
mÁ
 && !Òd->
æags
 & 
LOOKUP_ROOT
))

2336 
	`·th_put
(&
nd
->
roÙ
);

2337 ià(
ba£
)

2338 
	`åut
(
ba£
);

2339 
	`»Ëa£_İ’_š‹Á
(
nd
);

2340  
fp
;

2342 
out_fp
:

2343 
fp
 = 
	`ERR_PTR
(
”rÜ
);

2344 
out
;

2345 
	}
}

2347 
fe
 *
	$do_fp_İ’
(
dfd
, cÚ¡ *
·thÇme
,

2348 cÚ¡ 
İ’_æags
 *
İ
, 
æags
)

2350 
Çmeid©a
 
nd
;

2351 
fe
 *
fp
;

2353 
fp
 = 
	`·th_İ’©
(
dfd
, 
·thÇme
, &
nd
, 
İ
, 
æags
 | 
LOOKUP_RCU
);

2354 ià(
	`uÆik–y
(
fp
 =ğ
	`ERR_PTR
(-
ECHILD
)))

2355 
fp
 = 
	`·th_İ’©
(
dfd
, 
·thÇme
, &
nd
, 
İ
, 
æags
);

2356 ià(
	`uÆik–y
(
fp
 =ğ
	`ERR_PTR
(-
ESTALE
)))

2357 
fp
 = 
	`·th_İ’©
(
dfd
, 
·thÇme
, &
nd
, 
İ
, 
æags
 | 
LOOKUP_REVAL
);

2358  
fp
;

2359 
	}
}

2361 
fe
 *
	$do_fe_İ’_roÙ
(
d’Œy
 *d’Œy, 
vfsmouÁ
 *
mÁ
,

2362 cÚ¡ *
Çme
, cÚ¡ 
İ’_æags
 *
İ
, 
æags
)

2364 
Çmeid©a
 
nd
;

2365 
fe
 *file;

2367 
nd
.
roÙ
.
mÁ
 = mnt;

2368 
nd
.
roÙ
.
d’Œy
 = dentry;

2370 
æags
 |ğ
LOOKUP_ROOT
;

2372 ià(
d’Œy
->
d_šode
->
i_İ
->
fŞlow_lšk
 && 
İ
->
š‹Á
 & 
LOOKUP_OPEN
)

2373  
	`ERR_PTR
(-
ELOOP
);

2375 
fe
 = 
	`·th_İ’©
(-1, 
Çme
, &
nd
, 
İ
, 
æags
 | 
LOOKUP_RCU
);

2376 ià(
	`uÆik–y
(
fe
 =ğ
	`ERR_PTR
(-
ECHILD
)))

2377 
fe
 = 
	`·th_İ’©
(-1, 
Çme
, &
nd
, 
İ
, 
æags
);

2378 ià(
	`uÆik–y
(
fe
 =ğ
	`ERR_PTR
(-
ESTALE
)))

2379 
fe
 = 
	`·th_İ’©
(-1, 
Çme
, &
nd
, 
İ
, 
æags
 | 
LOOKUP_REVAL
);

2380  
fe
;

2381 
	}
}

2383 
d’Œy
 *
	$k”n_·th_ü—‹
(
dfd
, cÚ¡ *
·thÇme
, 
·th
 *·th, 
is_dœ
)

2385 
d’Œy
 *d’Œy = 
	`ERR_PTR
(-
EEXIST
);

2386 
Çmeid©a
 
nd
;

2387 
”rÜ
 = 
	`do_·th_lookup
(
dfd
, 
·thÇme
, 
LOOKUP_PARENT
, &
nd
);

2388 ià(
”rÜ
)

2389  
	`ERR_PTR
(
”rÜ
);

2395 ià(
nd
.
Ï¡_ty³
 !ğ
LAST_NORM
)

2396 
out
;

2397 
nd
.
æags
 &ğ~
LOOKUP_PARENT
;

2398 
nd
.
æags
 |ğ
LOOKUP_CREATE
 | 
LOOKUP_EXCL
;

2399 
nd
.
š‹Á
.
İ’
.
æags
 = 
O_EXCL
;

2404 
	`mu‹x_lock_Ã¡ed
(&
nd
.
·th
.
d’Œy
->
d_šode
->
i_mu‹x
, 
I_MUTEX_PARENT
);

2405 
d’Œy
 = 
	`lookup_hash
(&
nd
);

2406 ià(
	`IS_ERR
(
d’Œy
))

2407 
ç
;

2409 ià(
d’Œy
->
d_šode
)

2410 
“xi¡
;

2417 ià(
	`uÆik–y
(!
is_dœ
 && 
nd
.
Ï¡
.
Çme
[nd.Ï¡.
Ën
])) {

2418 
	`dput
(
d’Œy
);

2419 
d’Œy
 = 
	`ERR_PTR
(-
ENOENT
);

2420 
ç
;

2422 *
·th
 = 
nd
.path;

2423  
d’Œy
;

2424 
“xi¡
:

2425 
	`dput
(
d’Œy
);

2426 
d’Œy
 = 
	`ERR_PTR
(-
EEXIST
);

2427 
ç
:

2428 
	`mu‹x_uÆock
(&
nd
.
·th
.
d’Œy
->
d_šode
->
i_mu‹x
);

2429 
out
:

2430 
	`·th_put
(&
nd
.
·th
);

2431  
d’Œy
;

2432 
	}
}

2433 
EXPORT_SYMBOL
(
k”n_·th_ü—‹
);

2435 
d’Œy
 *
	$u£r_·th_ü—‹
(
dfd
, cÚ¡ 
__u£r
 *
·thÇme
, 
·th
 *·th, 
is_dœ
)

2437 *
tmp
 = 
	`g‘Çme
(
·thÇme
);

2438 
d’Œy
 *
»s
;

2439 ià(
	`IS_ERR
(
tmp
))

2440  
	`ERR_CAST
(
tmp
);

2441 
»s
 = 
	`k”n_·th_ü—‹
(
dfd
, 
tmp
, 
·th
, 
is_dœ
);

2442 
	`puŠame
(
tmp
);

2443  
»s
;

2444 
	}
}

2445 
EXPORT_SYMBOL
(
u£r_·th_ü—‹
);

2447 
	$vfs_mknod
(
šode
 *
dœ
, 
d’Œy
 *d’Œy, 
mode
, 
dev_t
 
dev
)

2449 
”rÜ
 = 
	`may_ü—‹
(
dœ
, 
d’Œy
);

2451 ià(
”rÜ
)

2452  
”rÜ
;

2454 ià((
	`S_ISCHR
(
mode
è|| 
	`S_ISBLK
(mode)) &&

2455 !
	`ns_ÿ·bË
(
	`šode_u£ºs
(
dœ
), 
CAP_MKNOD
))

2456  -
EPERM
;

2458 ià(!
dœ
->
i_İ
->
mknod
)

2459  -
EPERM
;

2461 
”rÜ
 = 
	`devcgroup_šode_mknod
(
mode
, 
dev
);

2462 ià(
”rÜ
)

2463  
”rÜ
;

2465 
”rÜ
 = 
	`£cur™y_šode_mknod
(
dœ
, 
d’Œy
, 
mode
, 
dev
);

2466 ià(
”rÜ
)

2467  
”rÜ
;

2469 
”rÜ
 = 
dœ
->
i_İ
->
	`mknod
(dœ, 
d’Œy
, 
mode
, 
dev
);

2470 ià(!
”rÜ
)

2471 
	`f¢Ùify_ü—‹
(
dœ
, 
d’Œy
);

2472  
”rÜ
;

2473 
	}
}

2475 
	$may_mknod
(
mode_t
 
mode
)

2477 
mode
 & 
S_IFMT
) {

2478 
S_IFREG
:

2479 
S_IFCHR
:

2480 
S_IFBLK
:

2481 
S_IFIFO
:

2482 
S_IFSOCK
:

2485 
S_IFDIR
:

2486  -
EPERM
;

2488  -
EINVAL
;

2490 
	}
}

2492 
	$SYSCALL_DEFINE4
(
mknod©
, , 
dfd
, cÚ¡ 
__u£r
 *, 
f’ame
, , 
mode
,

2493 , 
dev
)

2495 
d’Œy
 *dentry;

2496 
·th
…ath;

2497 
”rÜ
;

2499 ià(
	`S_ISDIR
(
mode
))

2500  -
EPERM
;

2502 
d’Œy
 = 
	`u£r_·th_ü—‹
(
dfd
, 
f’ame
, &
·th
, 0);

2503 ià(
	`IS_ERR
(
d’Œy
))

2504  
	`PTR_ERR
(
d’Œy
);

2506 ià(!
	`IS_POSIXACL
(
·th
.
d’Œy
->
d_šode
))

2507 
mode
 &ğ~
	`cu¼’t_umask
();

2508 
”rÜ
 = 
	`may_mknod
(
mode
);

2509 ià(
”rÜ
)

2510 
out_dput
;

2511 
”rÜ
 = 
	`mÁ_wªt_wr™e
(
·th
.
mÁ
);

2512 ià(
”rÜ
)

2513 
out_dput
;

2514 
”rÜ
 = 
	`£cur™y_·th_mknod
(&
·th
, 
d’Œy
, 
mode
, 
dev
);

2515 ià(
”rÜ
)

2516 
out_drİ_wr™e
;

2517 
mode
 & 
S_IFMT
) {

2518 0: 
S_IFREG
:

2519 
”rÜ
 = 
	`vfs_ü—‹
(
·th
.
d’Œy
->
d_šode
,d’Œy,
mode
,
NULL
);

2521 
S_IFCHR
: 
S_IFBLK
:

2522 
”rÜ
 = 
	`vfs_mknod
(
·th
.
d’Œy
->
d_šode
,d’Œy,
mode
,

2523 
	`Ãw_decode_dev
(
dev
));

2525 
S_IFIFO
: 
S_IFSOCK
:

2526 
”rÜ
 = 
	`vfs_mknod
(
·th
.
d’Œy
->
d_šode
,d’Œy,
mode
,0);

2529 
out_drİ_wr™e
:

2530 
	`mÁ_drİ_wr™e
(
·th
.
mÁ
);

2531 
out_dput
:

2532 
	`dput
(
d’Œy
);

2533 
	`mu‹x_uÆock
(&
·th
.
d’Œy
->
d_šode
->
i_mu‹x
);

2534 
	`·th_put
(&
·th
);

2536  
”rÜ
;

2537 
	}
}

2539 
	$SYSCALL_DEFINE3
(
mknod
, cÚ¡ 
__u£r
 *, 
f’ame
, , 
mode
, , 
dev
)

2541  
	`sys_mknod©
(
AT_FDCWD
, 
f’ame
, 
mode
, 
dev
);

2542 
	}
}

2544 
	$vfs_mkdœ
(
šode
 *
dœ
, 
d’Œy
 *d’Œy, 
mode
)

2546 
”rÜ
 = 
	`may_ü—‹
(
dœ
, 
d’Œy
);

2548 ià(
”rÜ
)

2549  
”rÜ
;

2551 ià(!
dœ
->
i_İ
->
mkdœ
)

2552  -
EPERM
;

2554 
mode
 &ğ(
S_IRWXUGO
|
S_ISVTX
);

2555 
”rÜ
 = 
	`£cur™y_šode_mkdœ
(
dœ
, 
d’Œy
, 
mode
);

2556 ià(
”rÜ
)

2557  
”rÜ
;

2559 
”rÜ
 = 
dœ
->
i_İ
->
	`mkdœ
(dœ, 
d’Œy
, 
mode
);

2560 ià(!
”rÜ
)

2561 
	`f¢Ùify_mkdœ
(
dœ
, 
d’Œy
);

2562  
”rÜ
;

2563 
	}
}

2565 
	$SYSCALL_DEFINE3
(
mkdœ©
, , 
dfd
, cÚ¡ 
__u£r
 *, 
·thÇme
, , 
mode
)

2567 
d’Œy
 *dentry;

2568 
·th
…ath;

2569 
”rÜ
;

2571 
d’Œy
 = 
	`u£r_·th_ü—‹
(
dfd
, 
·thÇme
, &
·th
, 1);

2572 ià(
	`IS_ERR
(
d’Œy
))

2573  
	`PTR_ERR
(
d’Œy
);

2575 ià(!
	`IS_POSIXACL
(
·th
.
d’Œy
->
d_šode
))

2576 
mode
 &ğ~
	`cu¼’t_umask
();

2577 
”rÜ
 = 
	`mÁ_wªt_wr™e
(
·th
.
mÁ
);

2578 ià(
”rÜ
)

2579 
out_dput
;

2580 
”rÜ
 = 
	`£cur™y_·th_mkdœ
(&
·th
, 
d’Œy
, 
mode
);

2581 ià(
”rÜ
)

2582 
out_drİ_wr™e
;

2583 
”rÜ
 = 
	`vfs_mkdœ
(
·th
.
d’Œy
->
d_šode
, d’Œy, 
mode
);

2584 
out_drİ_wr™e
:

2585 
	`mÁ_drİ_wr™e
(
·th
.
mÁ
);

2586 
out_dput
:

2587 
	`dput
(
d’Œy
);

2588 
	`mu‹x_uÆock
(&
·th
.
d’Œy
->
d_šode
->
i_mu‹x
);

2589 
	`·th_put
(&
·th
);

2590  
”rÜ
;

2591 
	}
}

2593 
	$SYSCALL_DEFINE2
(
mkdœ
, cÚ¡ 
__u£r
 *, 
·thÇme
, , 
mode
)

2595  
	`sys_mkdœ©
(
AT_FDCWD
, 
·thÇme
, 
mode
);

2596 
	}
}

2613 
	$d’Œy_unhash
(
d’Œy
 *dentry)

2615 
	`shršk_dÿche_·»Á
(
d’Œy
);

2616 
	`¥š_lock
(&
d’Œy
->
d_lock
);

2617 ià(
d’Œy
->
d_couÁ
 == 1)

2618 
	`__d_drİ
(
d’Œy
);

2619 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

2620 
	}
}

2622 
	$vfs_rmdœ
(
šode
 *
dœ
, 
d’Œy
 *dentry)

2624 
”rÜ
 = 
	`may_d–‘e
(
dœ
, 
d’Œy
, 1);

2626 ià(
”rÜ
)

2627  
”rÜ
;

2629 ià(!
dœ
->
i_İ
->
rmdœ
)

2630  -
EPERM
;

2632 
	`dg‘
(
d’Œy
);

2633 
	`mu‹x_lock
(&
d’Œy
->
d_šode
->
i_mu‹x
);

2635 
”rÜ
 = -
EBUSY
;

2636 ià(
	`d_mouÁpošt
(
d’Œy
))

2637 
out
;

2639 
”rÜ
 = 
	`£cur™y_šode_rmdœ
(
dœ
, 
d’Œy
);

2640 ià(
”rÜ
)

2641 
out
;

2643 
	`shršk_dÿche_·»Á
(
d’Œy
);

2644 
”rÜ
 = 
dœ
->
i_İ
->
	`rmdœ
(dœ, 
d’Œy
);

2645 ià(
”rÜ
)

2646 
out
;

2648 
d’Œy
->
d_šode
->
i_æags
 |ğ
S_DEAD
;

2649 
	`dÚt_mouÁ
(
d’Œy
);

2651 
out
:

2652 
	`mu‹x_uÆock
(&
d’Œy
->
d_šode
->
i_mu‹x
);

2653 
	`dput
(
d’Œy
);

2654 ià(!
”rÜ
)

2655 
	`d_d–‘e
(
d’Œy
);

2656  
”rÜ
;

2657 
	}
}

2659 
	$do_rmdœ
(
dfd
, cÚ¡ 
__u£r
 *
·thÇme
)

2661 
”rÜ
 = 0;

2662 * 
Çme
;

2663 
d’Œy
 *dentry;

2664 
Çmeid©a
 
nd
;

2666 
”rÜ
 = 
	`u£r_·th_·»Á
(
dfd
, 
·thÇme
, &
nd
, &
Çme
);

2667 ià(
”rÜ
)

2668  
”rÜ
;

2670 
nd
.
Ï¡_ty³
) {

2671 
LAST_DOTDOT
:

2672 
”rÜ
 = -
ENOTEMPTY
;

2673 
ex™1
;

2674 
LAST_DOT
:

2675 
”rÜ
 = -
EINVAL
;

2676 
ex™1
;

2677 
LAST_ROOT
:

2678 
”rÜ
 = -
EBUSY
;

2679 
ex™1
;

2682 
nd
.
æags
 &ğ~
LOOKUP_PARENT
;

2684 
	`mu‹x_lock_Ã¡ed
(&
nd
.
·th
.
d’Œy
->
d_šode
->
i_mu‹x
, 
I_MUTEX_PARENT
);

2685 
d’Œy
 = 
	`lookup_hash
(&
nd
);

2686 
”rÜ
 = 
	`PTR_ERR
(
d’Œy
);

2687 ià(
	`IS_ERR
(
d’Œy
))

2688 
ex™2
;

2689 ià(!
d’Œy
->
d_šode
) {

2690 
”rÜ
 = -
ENOENT
;

2691 
ex™3
;

2693 
”rÜ
 = 
	`mÁ_wªt_wr™e
(
nd
.
·th
.
mÁ
);

2694 ià(
”rÜ
)

2695 
ex™3
;

2696 
”rÜ
 = 
	`£cur™y_·th_rmdœ
(&
nd
.
·th
, 
d’Œy
);

2697 ià(
”rÜ
)

2698 
ex™4
;

2699 
”rÜ
 = 
	`vfs_rmdœ
(
nd
.
·th
.
d’Œy
->
d_šode
, dentry);

2700 
ex™4
:

2701 
	`mÁ_drİ_wr™e
(
nd
.
·th
.
mÁ
);

2702 
ex™3
:

2703 
	`dput
(
d’Œy
);

2704 
ex™2
:

2705 
	`mu‹x_uÆock
(&
nd
.
·th
.
d’Œy
->
d_šode
->
i_mu‹x
);

2706 
ex™1
:

2707 
	`·th_put
(&
nd
.
·th
);

2708 
	`puŠame
(
Çme
);

2709  
”rÜ
;

2710 
	}
}

2712 
	$SYSCALL_DEFINE1
(
rmdœ
, cÚ¡ 
__u£r
 *, 
·thÇme
)

2714  
	`do_rmdœ
(
AT_FDCWD
, 
·thÇme
);

2715 
	}
}

2717 
	$vfs_uÆšk
(
šode
 *
dœ
, 
d’Œy
 *dentry)

2719 
”rÜ
 = 
	`may_d–‘e
(
dœ
, 
d’Œy
, 0);

2721 ià(
”rÜ
)

2722  
”rÜ
;

2724 ià(!
dœ
->
i_İ
->
uÆšk
)

2725  -
EPERM
;

2727 
	`mu‹x_lock
(&
d’Œy
->
d_šode
->
i_mu‹x
);

2728 ià(
	`d_mouÁpošt
(
d’Œy
))

2729 
”rÜ
 = -
EBUSY
;

2731 
”rÜ
 = 
	`£cur™y_šode_uÆšk
(
dœ
, 
d’Œy
);

2732 ià(!
”rÜ
) {

2733 
”rÜ
 = 
dœ
->
i_İ
->
	`uÆšk
(dœ, 
d’Œy
);

2734 ià(!
”rÜ
)

2735 
	`dÚt_mouÁ
(
d’Œy
);

2738 
	`mu‹x_uÆock
(&
d’Œy
->
d_šode
->
i_mu‹x
);

2741 ià(!
”rÜ
 && !(
d’Œy
->
d_æags
 & 
DCACHE_NFSFS_RENAMED
)) {

2742 
	`f¢Ùify_lšk_couÁ
(
d’Œy
->
d_šode
);

2743 
	`d_d–‘e
(
d’Œy
);

2746  
”rÜ
;

2747 
	}
}

2755 
	$do_uÆšk©
(
dfd
, cÚ¡ 
__u£r
 *
·thÇme
)

2757 
”rÜ
;

2758 *
Çme
;

2759 
d’Œy
 *dentry;

2760 
Çmeid©a
 
nd
;

2761 
šode
 *šodğ
NULL
;

2763 
”rÜ
 = 
	`u£r_·th_·»Á
(
dfd
, 
·thÇme
, &
nd
, &
Çme
);

2764 ià(
”rÜ
)

2765  
”rÜ
;

2767 
”rÜ
 = -
EISDIR
;

2768 ià(
nd
.
Ï¡_ty³
 !ğ
LAST_NORM
)

2769 
ex™1
;

2771 
nd
.
æags
 &ğ~
LOOKUP_PARENT
;

2773 
	`mu‹x_lock_Ã¡ed
(&
nd
.
·th
.
d’Œy
->
d_šode
->
i_mu‹x
, 
I_MUTEX_PARENT
);

2774 
d’Œy
 = 
	`lookup_hash
(&
nd
);

2775 
”rÜ
 = 
	`PTR_ERR
(
d’Œy
);

2776 ià(!
	`IS_ERR
(
d’Œy
)) {

2778 ià(
nd
.
Ï¡
.
Çme
[nd.Ï¡.
Ën
])

2779 
¦ashes
;

2780 
šode
 = 
d’Œy
->
d_šode
;

2781 ià(!
šode
)

2782 
¦ashes
;

2783 
	`ihŞd
(
šode
);

2784 
”rÜ
 = 
	`mÁ_wªt_wr™e
(
nd
.
·th
.
mÁ
);

2785 ià(
”rÜ
)

2786 
ex™2
;

2787 
”rÜ
 = 
	`£cur™y_·th_uÆšk
(&
nd
.
·th
, 
d’Œy
);

2788 ià(
”rÜ
)

2789 
ex™3
;

2790 
”rÜ
 = 
	`vfs_uÆšk
(
nd
.
·th
.
d’Œy
->
d_šode
, dentry);

2791 
ex™3
:

2792 
	`mÁ_drİ_wr™e
(
nd
.
·th
.
mÁ
);

2793 
ex™2
:

2794 
	`dput
(
d’Œy
);

2796 
	`mu‹x_uÆock
(&
nd
.
·th
.
d’Œy
->
d_šode
->
i_mu‹x
);

2797 ià(
šode
)

2798 
	`ut
(
šode
);

2799 
ex™1
:

2800 
	`·th_put
(&
nd
.
·th
);

2801 
	`puŠame
(
Çme
);

2802  
”rÜ
;

2804 
¦ashes
:

2805 
”rÜ
 = !
d’Œy
->
d_šode
 ? -
ENOENT
 :

2806 
	`S_ISDIR
(
d’Œy
->
d_šode
->
i_mode
è? -
EISDIR
 : -
ENOTDIR
;

2807 
ex™2
;

2808 
	}
}

2810 
	$SYSCALL_DEFINE3
(
uÆšk©
, , 
dfd
, cÚ¡ 
__u£r
 *, 
·thÇme
, , 
æag
)

2812 ià((
æag
 & ~
AT_REMOVEDIR
) != 0)

2813  -
EINVAL
;

2815 ià(
æag
 & 
AT_REMOVEDIR
)

2816  
	`do_rmdœ
(
dfd
, 
·thÇme
);

2818  
	`do_uÆšk©
(
dfd
, 
·thÇme
);

2819 
	}
}

2821 
	$SYSCALL_DEFINE1
(
uÆšk
, cÚ¡ 
__u£r
 *, 
·thÇme
)

2823  
	`do_uÆšk©
(
AT_FDCWD
, 
·thÇme
);

2824 
	}
}

2826 
	$vfs_symlšk
(
šode
 *
dœ
, 
d’Œy
 *d’Œy, cÚ¡ *
ŞdÇme
)

2828 
”rÜ
 = 
	`may_ü—‹
(
dœ
, 
d’Œy
);

2830 ià(
”rÜ
)

2831  
”rÜ
;

2833 ià(!
dœ
->
i_İ
->
symlšk
)

2834  -
EPERM
;

2836 
”rÜ
 = 
	`£cur™y_šode_symlšk
(
dœ
, 
d’Œy
, 
ŞdÇme
);

2837 ià(
”rÜ
)

2838  
”rÜ
;

2840 
”rÜ
 = 
dœ
->
i_İ
->
	`symlšk
(dœ, 
d’Œy
, 
ŞdÇme
);

2841 ià(!
”rÜ
)

2842 
	`f¢Ùify_ü—‹
(
dœ
, 
d’Œy
);

2843  
”rÜ
;

2844 
	}
}

2846 
	$SYSCALL_DEFINE3
(
symlšk©
, cÚ¡ 
__u£r
 *, 
ŞdÇme
,

2847 , 
Ãwdfd
, cÚ¡ 
__u£r
 *, 
ÃwÇme
)

2849 
”rÜ
;

2850 *
äom
;

2851 
d’Œy
 *dentry;

2852 
·th
…ath;

2854 
äom
 = 
	`g‘Çme
(
ŞdÇme
);

2855 ià(
	`IS_ERR
(
äom
))

2856  
	`PTR_ERR
(
äom
);

2858 
d’Œy
 = 
	`u£r_·th_ü—‹
(
Ãwdfd
, 
ÃwÇme
, &
·th
, 0);

2859 
”rÜ
 = 
	`PTR_ERR
(
d’Œy
);

2860 ià(
	`IS_ERR
(
d’Œy
))

2861 
out_puŠame
;

2863 
”rÜ
 = 
	`mÁ_wªt_wr™e
(
·th
.
mÁ
);

2864 ià(
”rÜ
)

2865 
out_dput
;

2866 
”rÜ
 = 
	`£cur™y_·th_symlšk
(&
·th
, 
d’Œy
, 
äom
);

2867 ià(
”rÜ
)

2868 
out_drİ_wr™e
;

2869 
”rÜ
 = 
	`vfs_symlšk
(
·th
.
d’Œy
->
d_šode
, d’Œy, 
äom
);

2870 
out_drİ_wr™e
:

2871 
	`mÁ_drİ_wr™e
(
·th
.
mÁ
);

2872 
out_dput
:

2873 
	`dput
(
d’Œy
);

2874 
	`mu‹x_uÆock
(&
·th
.
d’Œy
->
d_šode
->
i_mu‹x
);

2875 
	`·th_put
(&
·th
);

2876 
out_puŠame
:

2877 
	`puŠame
(
äom
);

2878  
”rÜ
;

2879 
	}
}

2881 
	$SYSCALL_DEFINE2
(
symlšk
, cÚ¡ 
__u£r
 *, 
ŞdÇme
, cÚ¡ __u£¸*, 
ÃwÇme
)

2883  
	`sys_symlšk©
(
ŞdÇme
, 
AT_FDCWD
, 
ÃwÇme
);

2884 
	}
}

2886 
	$vfs_lšk
(
d’Œy
 *
Şd_d’Œy
, 
šode
 *
dœ
, d’Œy *
Ãw_d’Œy
)

2888 
šode
 *šodğ
Şd_d’Œy
->
d_šode
;

2889 
”rÜ
;

2891 ià(!
šode
)

2892  -
ENOENT
;

2894 
”rÜ
 = 
	`may_ü—‹
(
dœ
, 
Ãw_d’Œy
);

2895 ià(
”rÜ
)

2896  
”rÜ
;

2898 ià(
dœ
->
i_sb
 !ğ
šode
->i_sb)

2899  -
EXDEV
;

2904 ià(
	`IS_APPEND
(
šode
è|| 
	`IS_IMMUTABLE
(inode))

2905  -
EPERM
;

2906 ià(!
dœ
->
i_İ
->
lšk
)

2907  -
EPERM
;

2908 ià(
	`S_ISDIR
(
šode
->
i_mode
))

2909  -
EPERM
;

2911 
”rÜ
 = 
	`£cur™y_šode_lšk
(
Şd_d’Œy
, 
dœ
, 
Ãw_d’Œy
);

2912 ià(
”rÜ
)

2913  
”rÜ
;

2915 
	`mu‹x_lock
(&
šode
->
i_mu‹x
);

2917 ià(
šode
->
i_Æšk
 == 0)

2918 
”rÜ
 = -
ENOENT
;

2920 
”rÜ
 = 
dœ
->
i_İ
->
	`lšk
(
Şd_d’Œy
, dœ, 
Ãw_d’Œy
);

2921 
	`mu‹x_uÆock
(&
šode
->
i_mu‹x
);

2922 ià(!
”rÜ
)

2923 
	`f¢Ùify_lšk
(
dœ
, 
šode
, 
Ãw_d’Œy
);

2924  
”rÜ
;

2925 
	}
}

2936 
	$SYSCALL_DEFINE5
(
lšk©
, , 
Şddfd
, cÚ¡ 
__u£r
 *, 
ŞdÇme
,

2937 , 
Ãwdfd
, cÚ¡ 
__u£r
 *, 
ÃwÇme
, , 
æags
)

2939 
d’Œy
 *
Ãw_d’Œy
;

2940 
·th
 
Şd_·th
, 
Ãw_·th
;

2941 
how
 = 0;

2942 
”rÜ
;

2944 ià((
æags
 & ~(
AT_SYMLINK_FOLLOW
 | 
AT_EMPTY_PATH
)) != 0)

2945  -
EINVAL
;

2951 ià(
æags
 & 
AT_EMPTY_PATH
) {

2952 ià(!
	`ÿ·bË
(
CAP_DAC_READ_SEARCH
))

2953  -
ENOENT
;

2954 
how
 = 
LOOKUP_EMPTY
;

2957 ià(
æags
 & 
AT_SYMLINK_FOLLOW
)

2958 
how
 |ğ
LOOKUP_FOLLOW
;

2960 
”rÜ
 = 
	`u£r_·th_©
(
Şddfd
, 
ŞdÇme
, 
how
, &
Şd_·th
);

2961 ià(
”rÜ
)

2962  
”rÜ
;

2964 
Ãw_d’Œy
 = 
	`u£r_·th_ü—‹
(
Ãwdfd
, 
ÃwÇme
, &
Ãw_·th
, 0);

2965 
”rÜ
 = 
	`PTR_ERR
(
Ãw_d’Œy
);

2966 ià(
	`IS_ERR
(
Ãw_d’Œy
))

2967 
out
;

2969 
”rÜ
 = -
EXDEV
;

2970 ià(
Şd_·th
.
mÁ
 !ğ
Ãw_·th
.mnt)

2971 
out_dput
;

2972 
”rÜ
 = 
	`mÁ_wªt_wr™e
(
Ãw_·th
.
mÁ
);

2973 ià(
”rÜ
)

2974 
out_dput
;

2975 
”rÜ
 = 
	`£cur™y_·th_lšk
(
Şd_·th
.
d’Œy
, &
Ãw_·th
, 
Ãw_d’Œy
);

2976 ià(
”rÜ
)

2977 
out_drİ_wr™e
;

2978 
”rÜ
 = 
	`vfs_lšk
(
Şd_·th
.
d’Œy
, 
Ãw_·th
.d’Œy->
d_šode
, 
Ãw_d’Œy
);

2979 
out_drİ_wr™e
:

2980 
	`mÁ_drİ_wr™e
(
Ãw_·th
.
mÁ
);

2981 
out_dput
:

2982 
	`dput
(
Ãw_d’Œy
);

2983 
	`mu‹x_uÆock
(&
Ãw_·th
.
d’Œy
->
d_šode
->
i_mu‹x
);

2984 
	`·th_put
(&
Ãw_·th
);

2985 
out
:

2986 
	`·th_put
(&
Şd_·th
);

2988  
”rÜ
;

2989 
	}
}

2991 
	$SYSCALL_DEFINE2
(
lšk
, cÚ¡ 
__u£r
 *, 
ŞdÇme
, cÚ¡ __u£¸*, 
ÃwÇme
)

2993  
	`sys_lšk©
(
AT_FDCWD
, 
ŞdÇme
, AT_FDCWD, 
ÃwÇme
, 0);

2994 
	}
}

3023 
	$vfs_»Çme_dœ
(
šode
 *
Şd_dœ
, 
d’Œy
 *
Şd_d’Œy
,

3024 
šode
 *
Ãw_dœ
, 
d’Œy
 *
Ãw_d’Œy
)

3026 
”rÜ
 = 0;

3027 
šode
 *
rg‘
 = 
Ãw_d’Œy
->
d_šode
;

3033 ià(
Ãw_dœ
 !ğ
Şd_dœ
) {

3034 
”rÜ
 = 
	`šode_³rmissiÚ
(
Şd_d’Œy
->
d_šode
, 
MAY_WRITE
);

3035 ià(
”rÜ
)

3036  
”rÜ
;

3039 
”rÜ
 = 
	`£cur™y_šode_»Çme
(
Şd_dœ
, 
Şd_d’Œy
, 
Ãw_dœ
, 
Ãw_d’Œy
);

3040 ià(
”rÜ
)

3041  
”rÜ
;

3043 
	`dg‘
(
Ãw_d’Œy
);

3044 ià(
rg‘
)

3045 
	`mu‹x_lock
(&
rg‘
->
i_mu‹x
);

3047 
”rÜ
 = -
EBUSY
;

3048 ià(
	`d_mouÁpošt
(
Şd_d’Œy
è|| d_mouÁpošt(
Ãw_d’Œy
))

3049 
out
;

3051 ià(
rg‘
)

3052 
	`shršk_dÿche_·»Á
(
Ãw_d’Œy
);

3053 
”rÜ
 = 
Şd_dœ
->
i_İ
->
	`»Çme
(Şd_dœ, 
Şd_d’Œy
, 
Ãw_dœ
, 
Ãw_d’Œy
);

3054 ià(
”rÜ
)

3055 
out
;

3057 ià(
rg‘
) {

3058 
rg‘
->
i_æags
 |ğ
S_DEAD
;

3059 
	`dÚt_mouÁ
(
Ãw_d’Œy
);

3061 
out
:

3062 ià(
rg‘
)

3063 
	`mu‹x_uÆock
(&
rg‘
->
i_mu‹x
);

3064 
	`dput
(
Ãw_d’Œy
);

3065 ià(!
”rÜ
)

3066 ià(!(
Şd_dœ
->
i_sb
->
s_ty³
->
fs_æags
 & 
FS_RENAME_DOES_D_MOVE
))

3067 
	`d_move
(
Şd_d’Œy
,
Ãw_d’Œy
);

3068  
”rÜ
;

3069 
	}
}

3071 
	$vfs_»Çme_Ùh”
(
šode
 *
Şd_dœ
, 
d’Œy
 *
Şd_d’Œy
,

3072 
šode
 *
Ãw_dœ
, 
d’Œy
 *
Ãw_d’Œy
)

3074 
šode
 *
rg‘
 = 
Ãw_d’Œy
->
d_šode
;

3075 
”rÜ
;

3077 
”rÜ
 = 
	`£cur™y_šode_»Çme
(
Şd_dœ
, 
Şd_d’Œy
, 
Ãw_dœ
, 
Ãw_d’Œy
);

3078 ià(
”rÜ
)

3079  
”rÜ
;

3081 
	`dg‘
(
Ãw_d’Œy
);

3082 ià(
rg‘
)

3083 
	`mu‹x_lock
(&
rg‘
->
i_mu‹x
);

3085 
”rÜ
 = -
EBUSY
;

3086 ià(
	`d_mouÁpošt
(
Şd_d’Œy
)||d_mouÁpošt(
Ãw_d’Œy
))

3087 
out
;

3089 
”rÜ
 = 
Şd_dœ
->
i_İ
->
	`»Çme
(Şd_dœ, 
Şd_d’Œy
, 
Ãw_dœ
, 
Ãw_d’Œy
);

3090 ià(
”rÜ
)

3091 
out
;

3093 ià(
rg‘
)

3094 
	`dÚt_mouÁ
(
Ãw_d’Œy
);

3095 ià(!(
Şd_dœ
->
i_sb
->
s_ty³
->
fs_æags
 & 
FS_RENAME_DOES_D_MOVE
))

3096 
	`d_move
(
Şd_d’Œy
, 
Ãw_d’Œy
);

3097 
out
:

3098 ià(
rg‘
)

3099 
	`mu‹x_uÆock
(&
rg‘
->
i_mu‹x
);

3100 
	`dput
(
Ãw_d’Œy
);

3101  
”rÜ
;

3102 
	}
}

3104 
	$vfs_»Çme
(
šode
 *
Şd_dœ
, 
d’Œy
 *
Şd_d’Œy
,

3105 
šode
 *
Ãw_dœ
, 
d’Œy
 *
Ãw_d’Œy
)

3107 
”rÜ
;

3108 
is_dœ
 = 
	`S_ISDIR
(
Şd_d’Œy
->
d_šode
->
i_mode
);

3109 cÚ¡ *
Şd_Çme
;

3111 ià(
Şd_d’Œy
->
d_šode
 =ğ
Ãw_d’Œy
->d_inode)

3114 
”rÜ
 = 
	`may_d–‘e
(
Şd_dœ
, 
Şd_d’Œy
, 
is_dœ
);

3115 ià(
”rÜ
)

3116  
”rÜ
;

3118 ià(!
Ãw_d’Œy
->
d_šode
)

3119 
”rÜ
 = 
	`may_ü—‹
(
Ãw_dœ
, 
Ãw_d’Œy
);

3121 
”rÜ
 = 
	`may_d–‘e
(
Ãw_dœ
, 
Ãw_d’Œy
, 
is_dœ
);

3122 ià(
”rÜ
)

3123  
”rÜ
;

3125 ià(!
Şd_dœ
->
i_İ
->
»Çme
)

3126  -
EPERM
;

3128 
Şd_Çme
 = 
	`f¢Ùify_ŞdÇme_š™
(
Şd_d’Œy
->
d_Çme
.
Çme
);

3130 ià(
is_dœ
)

3131 
”rÜ
 = 
	`vfs_»Çme_dœ
(
Şd_dœ
,
Şd_d’Œy
,
Ãw_dœ
,
Ãw_d’Œy
);

3133 
”rÜ
 = 
	`vfs_»Çme_Ùh”
(
Şd_dœ
,
Şd_d’Œy
,
Ãw_dœ
,
Ãw_d’Œy
);

3134 ià(!
”rÜ
)

3135 
	`f¢Ùify_move
(
Şd_dœ
, 
Ãw_dœ
, 
Şd_Çme
, 
is_dœ
,

3136 
Ãw_d’Œy
->
d_šode
, 
Şd_d’Œy
);

3137 
	`f¢Ùify_ŞdÇme_ä“
(
Şd_Çme
);

3139  
”rÜ
;

3140 
	}
}

3142 
	$SYSCALL_DEFINE4
(
»Çm—t
, , 
Şddfd
, cÚ¡ 
__u£r
 *, 
ŞdÇme
,

3143 , 
Ãwdfd
, cÚ¡ 
__u£r
 *, 
ÃwÇme
)

3145 
d’Œy
 *
Şd_dœ
, *
Ãw_dœ
;

3146 
d’Œy
 *
Şd_d’Œy
, *
Ãw_d’Œy
;

3147 
d’Œy
 *
Œ­
;

3148 
Çmeid©a
 
Şdnd
, 
Ãwnd
;

3149 *
äom
;

3150 *
to
;

3151 
”rÜ
;

3153 
”rÜ
 = 
	`u£r_·th_·»Á
(
Şddfd
, 
ŞdÇme
, &
Şdnd
, &
äom
);

3154 ià(
”rÜ
)

3155 
ex™
;

3157 
”rÜ
 = 
	`u£r_·th_·»Á
(
Ãwdfd
, 
ÃwÇme
, &
Ãwnd
, &
to
);

3158 ià(
”rÜ
)

3159 
ex™1
;

3161 
”rÜ
 = -
EXDEV
;

3162 ià(
Şdnd
.
·th
.
mÁ
 !ğ
Ãwnd
.path.mnt)

3163 
ex™2
;

3165 
Şd_dœ
 = 
Şdnd
.
·th
.
d’Œy
;

3166 
”rÜ
 = -
EBUSY
;

3167 ià(
Şdnd
.
Ï¡_ty³
 !ğ
LAST_NORM
)

3168 
ex™2
;

3170 
Ãw_dœ
 = 
Ãwnd
.
·th
.
d’Œy
;

3171 ià(
Ãwnd
.
Ï¡_ty³
 !ğ
LAST_NORM
)

3172 
ex™2
;

3174 
Şdnd
.
æags
 &ğ~
LOOKUP_PARENT
;

3175 
Ãwnd
.
æags
 &ğ~
LOOKUP_PARENT
;

3176 
Ãwnd
.
æags
 |ğ
LOOKUP_RENAME_TARGET
;

3178 
Œ­
 = 
	`lock_»Çme
(
Ãw_dœ
, 
Şd_dœ
);

3180 
Şd_d’Œy
 = 
	`lookup_hash
(&
Şdnd
);

3181 
”rÜ
 = 
	`PTR_ERR
(
Şd_d’Œy
);

3182 ià(
	`IS_ERR
(
Şd_d’Œy
))

3183 
ex™3
;

3185 
”rÜ
 = -
ENOENT
;

3186 ià(!
Şd_d’Œy
->
d_šode
)

3187 
ex™4
;

3189 ià(!
	`S_ISDIR
(
Şd_d’Œy
->
d_šode
->
i_mode
)) {

3190 
”rÜ
 = -
ENOTDIR
;

3191 ià(
Şdnd
.
Ï¡
.
Çme
[Şdnd.Ï¡.
Ën
])

3192 
ex™4
;

3193 ià(
Ãwnd
.
Ï¡
.
Çme
[Ãwnd.Ï¡.
Ën
])

3194 
ex™4
;

3197 
”rÜ
 = -
EINVAL
;

3198 ià(
Şd_d’Œy
 =ğ
Œ­
)

3199 
ex™4
;

3200 
Ãw_d’Œy
 = 
	`lookup_hash
(&
Ãwnd
);

3201 
”rÜ
 = 
	`PTR_ERR
(
Ãw_d’Œy
);

3202 ià(
	`IS_ERR
(
Ãw_d’Œy
))

3203 
ex™4
;

3205 
”rÜ
 = -
ENOTEMPTY
;

3206 ià(
Ãw_d’Œy
 =ğ
Œ­
)

3207 
ex™5
;

3209 
”rÜ
 = 
	`mÁ_wªt_wr™e
(
Şdnd
.
·th
.
mÁ
);

3210 ià(
”rÜ
)

3211 
ex™5
;

3212 
”rÜ
 = 
	`£cur™y_·th_»Çme
(&
Şdnd
.
·th
, 
Şd_d’Œy
,

3213 &
Ãwnd
.
·th
, 
Ãw_d’Œy
);

3214 ià(
”rÜ
)

3215 
ex™6
;

3216 
”rÜ
 = 
	`vfs_»Çme
(
Şd_dœ
->
d_šode
, 
Şd_d’Œy
,

3217 
Ãw_dœ
->
d_šode
, 
Ãw_d’Œy
);

3218 
ex™6
:

3219 
	`mÁ_drİ_wr™e
(
Şdnd
.
·th
.
mÁ
);

3220 
ex™5
:

3221 
	`dput
(
Ãw_d’Œy
);

3222 
ex™4
:

3223 
	`dput
(
Şd_d’Œy
);

3224 
ex™3
:

3225 
	`uÆock_»Çme
(
Ãw_dœ
, 
Şd_dœ
);

3226 
ex™2
:

3227 
	`·th_put
(&
Ãwnd
.
·th
);

3228 
	`puŠame
(
to
);

3229 
ex™1
:

3230 
	`·th_put
(&
Şdnd
.
·th
);

3231 
	`puŠame
(
äom
);

3232 
ex™
:

3233  
”rÜ
;

3234 
	}
}

3236 
	$SYSCALL_DEFINE2
(
»Çme
, cÚ¡ 
__u£r
 *, 
ŞdÇme
, cÚ¡ __u£¸*, 
ÃwÇme
)

3238  
	`sys_»Çm—t
(
AT_FDCWD
, 
ŞdÇme
, AT_FDCWD, 
ÃwÇme
);

3239 
	}
}

3241 
	$vfs_»adlšk
(
d’Œy
 *d’Œy, 
__u£r
 *
bufãr
, 
buæ’
, cÚ¡ *
lšk
)

3243 
Ën
;

3245 
Ën
 = 
	`PTR_ERR
(
lšk
);

3246 ià(
	`IS_ERR
(
lšk
))

3247 
out
;

3249 
Ën
 = 
	`¡¾’
(
lšk
);

3250 ià(
Ën
 > (è
buæ’
)

3251 
Ën
 = 
buæ’
;

3252 ià(
	`cİy_to_u£r
(
bufãr
, 
lšk
, 
Ën
))

3253 
Ën
 = -
EFAULT
;

3254 
out
:

3255  
Ën
;

3256 
	}
}

3263 
	$g’”ic_»adlšk
(
d’Œy
 *d’Œy, 
__u£r
 *
bufãr
, 
buæ’
)

3265 
Çmeid©a
 
nd
;

3266 *
cook›
;

3267 
»s
;

3269 
nd
.
d•th
 = 0;

3270 
cook›
 = 
d’Œy
->
d_šode
->
i_İ
->
	`fŞlow_lšk
(d’Œy, &
nd
);

3271 ià(
	`IS_ERR
(
cook›
))

3272  
	`PTR_ERR
(
cook›
);

3274 
»s
 = 
	`vfs_»adlšk
(
d’Œy
, 
bufãr
, 
buæ’
, 
	`nd_g‘_lšk
(&
nd
));

3275 ià(
d’Œy
->
d_šode
->
i_İ
->
put_lšk
)

3276 
d’Œy
->
d_šode
->
i_İ
->
	`put_lšk
(d’Œy, &
nd
, 
cook›
);

3277  
»s
;

3278 
	}
}

3280 
	$vfs_fŞlow_lšk
(
Çmeid©a
 *
nd
, cÚ¡ *
lšk
)

3282  
	`__vfs_fŞlow_lšk
(
nd
, 
lšk
);

3283 
	}
}

3286 *
	$·ge_g‘lšk
(
d’Œy
 * d’Œy, 
·ge
 **
µage
)

3288 *
kaddr
;

3289 
·ge
 *page;

3290 
add»ss_¥aû
 *
m­pšg
 = 
d’Œy
->
d_šode
->
i_m­pšg
;

3291 
·ge
 = 
	`»ad_m­pšg_·ge
(
m­pšg
, 0, 
NULL
);

3292 ià(
	`IS_ERR
(
·ge
))

3293  (*)
·ge
;

3294 *
µage
 = 
·ge
;

3295 
kaddr
 = 
	`km­
(
·ge
);

3296 
	`nd_‹rmš©e_lšk
(
kaddr
, 
d’Œy
->
d_šode
->
i_size
, 
PAGE_SIZE
 - 1);

3297  
kaddr
;

3298 
	}
}

3300 
	$·ge_»adlšk
(
d’Œy
 *d’Œy, 
__u£r
 *
bufãr
, 
buæ’
)

3302 
·ge
 *·gğ
NULL
;

3303 *
s
 = 
	`·ge_g‘lšk
(
d’Œy
, &
·ge
);

3304 
»s
 = 
	`vfs_»adlšk
(
d’Œy
,
bufãr
,
buæ’
,
s
);

3305 ià(
·ge
) {

3306 
	`kunm­
(
·ge
);

3307 
	`·ge_ÿche_»Ëa£
(
·ge
);

3309  
»s
;

3310 
	}
}

3312 *
	$·ge_fŞlow_lšk_light
(
d’Œy
 *d’Œy, 
Çmeid©a
 *
nd
)

3314 
·ge
 *·gğ
NULL
;

3315 
	`nd_£t_lšk
(
nd
, 
	`·ge_g‘lšk
(
d’Œy
, &
·ge
));

3316  
·ge
;

3317 
	}
}

3319 
	$·ge_put_lšk
(
d’Œy
 *d’Œy, 
Çmeid©a
 *
nd
, *
cook›
)

3321 
·ge
 *·gğ
cook›
;

3323 ià(
·ge
) {

3324 
	`kunm­
(
·ge
);

3325 
	`·ge_ÿche_»Ëa£
(
·ge
);

3327 
	}
}

3332 
	$__·ge_symlšk
(
šode
 *šode, cÚ¡ *
symÇme
, 
Ën
, 
nofs
)

3334 
add»ss_¥aû
 *
m­pšg
 = 
šode
->
i_m­pšg
;

3335 
·ge
 *page;

3336 *
fsd©a
;

3337 
”r
;

3338 *
kaddr
;

3339 
æags
 = 
AOP_FLAG_UNINTERRUPTIBLE
;

3340 ià(
nofs
)

3341 
æags
 |ğ
AOP_FLAG_NOFS
;

3343 
»Œy
:

3344 
”r
 = 
	`·geÿche_wr™e_begš
(
NULL
, 
m­pšg
, 0, 
Ën
-1,

3345 
æags
, &
·ge
, &
fsd©a
);

3346 ià(
”r
)

3347 
ç
;

3349 
kaddr
 = 
	`km­_©omic
(
·ge
, 
KM_USER0
);

3350 
	`memıy
(
kaddr
, 
symÇme
, 
Ën
-1);

3351 
	`kunm­_©omic
(
kaddr
, 
KM_USER0
);

3353 
”r
 = 
	`·geÿche_wr™e_’d
(
NULL
, 
m­pšg
, 0, 
Ën
-1,†en-1,

3354 
·ge
, 
fsd©a
);

3355 ià(
”r
 < 0)

3356 
ç
;

3357 ià(
”r
 < 
Ën
-1)

3358 
»Œy
;

3360 
	`m¬k_šode_dœty
(
šode
);

3362 
ç
:

3363  
”r
;

3364 
	}
}

3366 
	$·ge_symlšk
(
šode
 *šode, cÚ¡ *
symÇme
, 
Ën
)

3368  
	`__·ge_symlšk
(
šode
, 
symÇme
, 
Ën
,

3369 !(
	`m­pšg_gå_mask
(
šode
->
i_m­pšg
è& 
__GFP_FS
));

3370 
	}
}

3372 cÚ¡ 
šode_İ”©iÚs
 
	g·ge_symlšk_šode_İ”©iÚs
 = {

3373 .
»adlšk
 = 
g’”ic_»adlšk
,

3374 .
	gfŞlow_lšk
 = 
·ge_fŞlow_lšk_light
,

3375 .
	gput_lšk
 = 
·ge_put_lšk
,

3378 
EXPORT_SYMBOL
(
u£r_·th_©
);

3379 
EXPORT_SYMBOL
(
fŞlow_down_Úe
);

3380 
EXPORT_SYMBOL
(
fŞlow_down
);

3381 
EXPORT_SYMBOL
(
fŞlow_up
);

3382 
EXPORT_SYMBOL
(
g‘_wr™e_acûss
);

3383 
EXPORT_SYMBOL
(
g‘Çme
);

3384 
EXPORT_SYMBOL
(
lock_»Çme
);

3385 
EXPORT_SYMBOL
(
lookup_Úe_Ën
);

3386 
EXPORT_SYMBOL
(
·ge_fŞlow_lšk_light
);

3387 
EXPORT_SYMBOL
(
·ge_put_lšk
);

3388 
EXPORT_SYMBOL
(
·ge_»adlšk
);

3389 
EXPORT_SYMBOL
(
__·ge_symlšk
);

3390 
EXPORT_SYMBOL
(
·ge_symlšk
);

3391 
EXPORT_SYMBOL
(
·ge_symlšk_šode_İ”©iÚs
);

3392 
EXPORT_SYMBOL
(
k”n_·th
);

3393 
EXPORT_SYMBOL
(
vfs_·th_lookup
);

3394 
EXPORT_SYMBOL
(
šode_³rmissiÚ
);

3395 
EXPORT_SYMBOL
(
uÆock_»Çme
);

3396 
EXPORT_SYMBOL
(
vfs_ü—‹
);

3397 
EXPORT_SYMBOL
(
vfs_fŞlow_lšk
);

3398 
EXPORT_SYMBOL
(
vfs_lšk
);

3399 
EXPORT_SYMBOL
(
vfs_mkdœ
);

3400 
EXPORT_SYMBOL
(
vfs_mknod
);

3401 
EXPORT_SYMBOL
(
g’”ic_³rmissiÚ
);

3402 
EXPORT_SYMBOL
(
vfs_»adlšk
);

3403 
EXPORT_SYMBOL
(
vfs_»Çme
);

3404 
EXPORT_SYMBOL
(
vfs_rmdœ
);

3405 
EXPORT_SYMBOL
(
vfs_symlšk
);

3406 
EXPORT_SYMBOL
(
vfs_uÆšk
);

3407 
EXPORT_SYMBOL
(
d’Œy_unhash
);

3408 
EXPORT_SYMBOL
(
g’”ic_»adlšk
);

	@namespace.c

11 
	~<lšux/sysÿÎs.h
>

12 
	~<lšux/¦ab.h
>

13 
	~<lšux/sched.h
>

14 
	~<lšux/¥šlock.h
>

15 
	~<lšux/³rıu.h
>

16 
	~<lšux/š™.h
>

17 
	~<lšux/k”Ãl.h
>

18 
	~<lšux/acù.h
>

19 
	~<lšux/ÿ·b™y.h
>

20 
	~<lšux/ıumask.h
>

21 
	~<lšux/moduË.h
>

22 
	~<lšux/sysfs.h
>

23 
	~<lšux/£q_fe.h
>

24 
	~<lšux/mÁ_Çme¥aû.h
>

25 
	~<lšux/Çmei.h
>

26 
	~<lšux/n¥roxy.h
>

27 
	~<lšux/£cur™y.h
>

28 
	~<lšux/mouÁ.h
>

29 
	~<lšux/¿mfs.h
>

30 
	~<lšux/log2.h
>

31 
	~<lšux/idr.h
>

32 
	~<lšux/fs_¡ruù.h
>

33 
	~<lšux/f¢Ùify.h
>

34 
	~<asm/uacûss.h
>

35 
	~<asm/uni¡d.h
>

36 
	~"²ode.h
"

37 
	~"š‹º®.h
"

39 
	#HASH_SHIFT
 
	`og2
(
PAGE_SIZE
 / (
li¡_h—d
))

	)

40 
	#HASH_SIZE
 (1UL << 
HASH_SHIFT
)

	)

42 
	gev’t
;

43 
DEFINE_IDA
(
mÁ_id_ida
);

44 
DEFINE_IDA
(
mÁ_group_ida
);

45 
DEFINE_SPINLOCK
(
mÁ_id_lock
);

46 
	gmÁ_id_¡¬t
 = 0;

47 
	gmÁ_group_¡¬t
 = 1;

49 
li¡_h—d
 *
mouÁ_hashbË
 
	g__»ad_mo¡ly
;

50 
kmem_ÿche
 *
mÁ_ÿche
 
	g__»ad_mo¡ly
;

51 
rw_£m­hÜe
 
	gÇme¥aû_£m
;

54 
kobjeù
 *
	gfs_kobj
;

55 
EXPORT_SYMBOL_GPL
(
fs_kobj
);

65 
DEFINE_BRLOCK
(
vfsmouÁ_lock
);

67 
šlše
 
	$hash
(
vfsmouÁ
 *
mÁ
, 
d’Œy
 *dentry)

69 
tmp
 = (()
mÁ
 / 
L1_CACHE_BYTES
);

70 
tmp
 +ğ(()
d’Œy
 / 
L1_CACHE_BYTES
);

71 
tmp
 =m°+ (tm°>> 
HASH_SHIFT
);

72  
tmp
 & (
HASH_SIZE
 - 1);

73 
	}
}

75 
	#MNT_WRITER_UNDERFLOW_LIMIT
 -(1<<16)

	)

81 
	$mÁ_®loc_id
(
vfsmouÁ
 *
mÁ
)

83 
»s
;

85 
»Œy
:

86 
	`ida_´e_g‘
(&
mÁ_id_ida
, 
GFP_KERNEL
);

87 
	`¥š_lock
(&
mÁ_id_lock
);

88 
»s
 = 
	`ida_g‘_Ãw_above
(&
mÁ_id_ida
, 
mÁ_id_¡¬t
, &
mÁ
->
mÁ_id
);

89 ià(!
»s
)

90 
mÁ_id_¡¬t
 = 
mÁ
->
mÁ_id
 + 1;

91 
	`¥š_uÆock
(&
mÁ_id_lock
);

92 ià(
»s
 =ğ-
EAGAIN
)

93 
»Œy
;

95  
»s
;

96 
	}
}

98 
	$mÁ_ä“_id
(
vfsmouÁ
 *
mÁ
)

100 
id
 = 
mÁ
->
mÁ_id
;

101 
	`¥š_lock
(&
mÁ_id_lock
);

102 
	`ida_»move
(&
mÁ_id_ida
, 
id
);

103 ià(
mÁ_id_¡¬t
 > 
id
)

104 
mÁ_id_¡¬t
 = 
id
;

105 
	`¥š_uÆock
(&
mÁ_id_lock
);

106 
	}
}

113 
	$mÁ_®loc_group_id
(
vfsmouÁ
 *
mÁ
)

115 
»s
;

117 ià(!
	`ida_´e_g‘
(&
mÁ_group_ida
, 
GFP_KERNEL
))

118  -
ENOMEM
;

120 
»s
 = 
	`ida_g‘_Ãw_above
(&
mÁ_group_ida
,

121 
mÁ_group_¡¬t
,

122 &
mÁ
->
mÁ_group_id
);

123 ià(!
»s
)

124 
mÁ_group_¡¬t
 = 
mÁ
->
mÁ_group_id
 + 1;

126  
»s
;

127 
	}
}

132 
	$mÁ_»Ëa£_group_id
(
vfsmouÁ
 *
mÁ
)

134 
id
 = 
mÁ
->
mÁ_group_id
;

135 
	`ida_»move
(&
mÁ_group_ida
, 
id
);

136 ià(
mÁ_group_¡¬t
 > 
id
)

137 
mÁ_group_¡¬t
 = 
id
;

138 
mÁ
->
mÁ_group_id
 = 0;

139 
	}
}

144 
šlše
 
	$mÁ_add_couÁ
(
vfsmouÁ
 *
mÁ
, 
n
)

146 #ifdeà
CONFIG_SMP


147 
	`this_ıu_add
(
mÁ
->
mÁ_pı
->
mÁ_couÁ
, 
n
);

149 
	`´“m±_di§bË
();

150 
mÁ
->
mÁ_couÁ
 +ğ
n
;

151 
	`´“m±_’abË
();

153 
	}
}

155 
šlše
 
	$mÁ_£t_couÁ
(
vfsmouÁ
 *
mÁ
, 
n
)

157 #ifdeà
CONFIG_SMP


158 
	`this_ıu_wr™e
(
mÁ
->
mÁ_pı
->
mÁ_couÁ
, 
n
);

160 
mÁ
->
mÁ_couÁ
 = 
n
;

162 
	}
}

167 
šlše
 
	$mÁ_šc_couÁ
(
vfsmouÁ
 *
mÁ
)

169 
	`mÁ_add_couÁ
(
mÁ
, 1);

170 
	}
}

175 
šlše
 
	$mÁ_dec_couÁ
(
vfsmouÁ
 *
mÁ
)

177 
	`mÁ_add_couÁ
(
mÁ
, -1);

178 
	}
}

183 
	$mÁ_g‘_couÁ
(
vfsmouÁ
 *
mÁ
)

185 #ifdeà
CONFIG_SMP


186 
couÁ
 = 0;

187 
ıu
;

189 
	`fÜ_—ch_possibË_ıu
(
ıu
) {

190 
couÁ
 +ğ
	`³r_ıu_±r
(
mÁ
->
mÁ_pı
, 
ıu
)->
mÁ_couÁ
;

193  
couÁ
;

195  
mÁ
->
mÁ_couÁ
;

197 
	}
}

199 
vfsmouÁ
 *
	$®loc_vfsmÁ
(cÚ¡ *
Çme
)

201 
vfsmouÁ
 *
mÁ
 = 
	`kmem_ÿche_z®loc
(
mÁ_ÿche
, 
GFP_KERNEL
);

202 ià(
mÁ
) {

203 
”r
;

205 
”r
 = 
	`mÁ_®loc_id
(
mÁ
);

206 ià(
”r
)

207 
out_ä“_ÿche
;

209 ià(
Çme
) {

210 
mÁ
->
mÁ_devÇme
 = 
	`k¡rdup
(
Çme
, 
GFP_KERNEL
);

211 ià(!
mÁ
->
mÁ_devÇme
)

212 
out_ä“_id
;

215 #ifdeà
CONFIG_SMP


216 
mÁ
->
mÁ_pı
 = 
	`®loc_³rıu
(mnt_pcp);

217 ià(!
mÁ
->
mÁ_pı
)

218 
out_ä“_devÇme
;

220 
	`this_ıu_add
(
mÁ
->
mÁ_pı
->
mÁ_couÁ
, 1);

222 
mÁ
->
mÁ_couÁ
 = 1;

223 
mÁ
->
mÁ_wr™”s
 = 0;

226 
	`INIT_LIST_HEAD
(&
mÁ
->
mÁ_hash
);

227 
	`INIT_LIST_HEAD
(&
mÁ
->
mÁ_chd
);

228 
	`INIT_LIST_HEAD
(&
mÁ
->
mÁ_mouÁs
);

229 
	`INIT_LIST_HEAD
(&
mÁ
->
mÁ_li¡
);

230 
	`INIT_LIST_HEAD
(&
mÁ
->
mÁ_expœe
);

231 
	`INIT_LIST_HEAD
(&
mÁ
->
mÁ_sh¬e
);

232 
	`INIT_LIST_HEAD
(&
mÁ
->
mÁ_¦ave_li¡
);

233 
	`INIT_LIST_HEAD
(&
mÁ
->
mÁ_¦ave
);

234 #ifdeà
CONFIG_FSNOTIFY


235 
	`INIT_HLIST_HEAD
(&
mÁ
->
mÁ_f¢Ùify_m¬ks
);

238  
mÁ
;

240 #ifdeà
CONFIG_SMP


241 
out_ä“_devÇme
:

242 
	`kä“
(
mÁ
->
mÁ_devÇme
);

244 
out_ä“_id
:

245 
	`mÁ_ä“_id
(
mÁ
);

246 
out_ä“_ÿche
:

247 
	`kmem_ÿche_ä“
(
mÁ_ÿche
, 
mÁ
);

248  
NULL
;

249 
	}
}

270 
	$__mÁ_is_»adÚly
(
vfsmouÁ
 *
mÁ
)

272 ià(
mÁ
->
mÁ_æags
 & 
MNT_READONLY
)

274 ià(
mÁ
->
mÁ_sb
->
s_æags
 & 
MS_RDONLY
)

277 
	}
}

278 
EXPORT_SYMBOL_GPL
(
__mÁ_is_»adÚly
);

280 
šlše
 
	$mÁ_šc_wr™”s
(
vfsmouÁ
 *
mÁ
)

282 #ifdeà
CONFIG_SMP


283 
	`this_ıu_šc
(
mÁ
->
mÁ_pı
->
mÁ_wr™”s
);

285 
mÁ
->
mÁ_wr™”s
++;

287 
	}
}

289 
šlše
 
	$mÁ_dec_wr™”s
(
vfsmouÁ
 *
mÁ
)

291 #ifdeà
CONFIG_SMP


292 
	`this_ıu_dec
(
mÁ
->
mÁ_pı
->
mÁ_wr™”s
);

294 
mÁ
->
mÁ_wr™”s
--;

296 
	}
}

298 
	$mÁ_g‘_wr™”s
(
vfsmouÁ
 *
mÁ
)

300 #ifdeà
CONFIG_SMP


301 
couÁ
 = 0;

302 
ıu
;

304 
	`fÜ_—ch_possibË_ıu
(
ıu
) {

305 
couÁ
 +ğ
	`³r_ıu_±r
(
mÁ
->
mÁ_pı
, 
ıu
)->
mÁ_wr™”s
;

308  
couÁ
;

310  
mÁ
->
mÁ_wr™”s
;

312 
	}
}

332 
	$mÁ_wªt_wr™e
(
vfsmouÁ
 *
mÁ
)

334 
»t
 = 0;

336 
	`´“m±_di§bË
();

337 
	`mÁ_šc_wr™”s
(
mÁ
);

343 
	`smp_mb
();

344 
mÁ
->
mÁ_æags
 & 
MNT_WRITE_HOLD
)

345 
	`ıu_»Ïx
();

351 
	`smp_rmb
();

352 ià(
	`__mÁ_is_»adÚly
(
mÁ
)) {

353 
	`mÁ_dec_wr™”s
(
mÁ
);

354 
»t
 = -
EROFS
;

355 
out
;

357 
out
:

358 
	`´“m±_’abË
();

359  
»t
;

360 
	}
}

361 
EXPORT_SYMBOL_GPL
(
mÁ_wªt_wr™e
);

375 
	$mÁ_şÚe_wr™e
(
vfsmouÁ
 *
mÁ
)

378 ià(
	`__mÁ_is_»adÚly
(
mÁ
))

379  -
EROFS
;

380 
	`´“m±_di§bË
();

381 
	`mÁ_šc_wr™”s
(
mÁ
);

382 
	`´“m±_’abË
();

384 
	}
}

385 
EXPORT_SYMBOL_GPL
(
mÁ_şÚe_wr™e
);

394 
	$mÁ_wªt_wr™e_fe
(
fe
 *file)

396 
šode
 *šodğ
fe
->
f_d’Œy
->
d_šode
;

397 ià(!(
fe
->
f_mode
 & 
FMODE_WRITE
è|| 
	`¥ecŸl_fe
(
šode
->
i_mode
))

398  
	`mÁ_wªt_wr™e
(
fe
->
f_·th
.
mÁ
);

400  
	`mÁ_şÚe_wr™e
(
fe
->
f_·th
.
mÁ
);

401 
	}
}

402 
EXPORT_SYMBOL_GPL
(
mÁ_wªt_wr™e_fe
);

412 
	$mÁ_drİ_wr™e
(
vfsmouÁ
 *
mÁ
)

414 
	`´“m±_di§bË
();

415 
	`mÁ_dec_wr™”s
(
mÁ
);

416 
	`´“m±_’abË
();

417 
	}
}

418 
EXPORT_SYMBOL_GPL
(
mÁ_drİ_wr™e
);

420 
	$mÁ_make_»adÚly
(
vfsmouÁ
 *
mÁ
)

422 
»t
 = 0;

424 
	`br_wr™e_lock
(
vfsmouÁ_lock
);

425 
mÁ
->
mÁ_æags
 |ğ
MNT_WRITE_HOLD
;

430 
	`smp_mb
();

448 ià(
	`mÁ_g‘_wr™”s
(
mÁ
) > 0)

449 
»t
 = -
EBUSY
;

451 
mÁ
->
mÁ_æags
 |ğ
MNT_READONLY
;

456 
	`smp_wmb
();

457 
mÁ
->
mÁ_æags
 &ğ~
MNT_WRITE_HOLD
;

458 
	`br_wr™e_uÆock
(
vfsmouÁ_lock
);

459  
»t
;

460 
	}
}

462 
	$__mÁ_unmake_»adÚly
(
vfsmouÁ
 *
mÁ
)

464 
	`br_wr™e_lock
(
vfsmouÁ_lock
);

465 
mÁ
->
mÁ_æags
 &ğ~
MNT_READONLY
;

466 
	`br_wr™e_uÆock
(
vfsmouÁ_lock
);

467 
	}
}

469 
	$ä“_vfsmÁ
(
vfsmouÁ
 *
mÁ
)

471 
	`kä“
(
mÁ
->
mÁ_devÇme
);

472 
	`mÁ_ä“_id
(
mÁ
);

473 #ifdeà
CONFIG_SMP


474 
	`ä“_³rıu
(
mÁ
->
mÁ_pı
);

476 
	`kmem_ÿche_ä“
(
mÁ_ÿche
, 
mÁ
);

477 
	}
}

484 
vfsmouÁ
 *
	$__lookup_mÁ
(
vfsmouÁ
 *
mÁ
, 
d’Œy
 *dentry,

485 
dœ
)

487 
li¡_h—d
 *
h—d
 = 
mouÁ_hashbË
 + 
	`hash
(
mÁ
, 
d’Œy
);

488 
li¡_h—d
 *
tmp
 = 
h—d
;

489 
vfsmouÁ
 *
p
, *
found
 = 
NULL
;

492 
tmp
 = 
dœ
 ?mp->
Ãxt
 :mp->
´ev
;

493 
p
 = 
NULL
;

494 ià(
tmp
 =ğ
h—d
)

496 
p
 = 
	`li¡_’Œy
(
tmp
, 
vfsmouÁ
, 
mÁ_hash
);

497 ià(
p
->
mÁ_·»Á
 =ğ
mÁ
 &&…->
mÁ_mouÁpošt
 =ğ
d’Œy
) {

498 
found
 = 
p
;

502  
found
;

503 
	}
}

509 
vfsmouÁ
 *
	$lookup_mÁ
(
·th
 *path)

511 
vfsmouÁ
 *
chd_mÁ
;

513 
	`br_»ad_lock
(
vfsmouÁ_lock
);

514 ià((
chd_mÁ
 = 
	`__lookup_mÁ
(
·th
->
mÁ
,…©h->
d’Œy
, 1)))

515 
	`mÁg‘
(
chd_mÁ
);

516 
	`br_»ad_uÆock
(
vfsmouÁ_lock
);

517  
chd_mÁ
;

518 
	}
}

520 
šlše
 
	$check_mÁ
(
vfsmouÁ
 *
mÁ
)

522  
mÁ
->
mÁ_ns
 =ğ
cu¼’t
->
n¥roxy
->mnt_ns;

523 
	}
}

528 
	$touch_mÁ_Çme¥aû
(
mÁ_Çme¥aû
 *
ns
)

530 ià(
ns
) {

531 
ns
->
ev’t
 = ++event;

532 
	`wake_up_š‹¼u±ibË
(&
ns
->
pŞl
);

534 
	}
}

539 
	$__touch_mÁ_Çme¥aû
(
mÁ_Çme¥aû
 *
ns
)

541 ià(
ns
 &&‚s->
ev’t
 !=ƒvent) {

542 
ns
->
ev’t
 =ƒvent;

543 
	`wake_up_š‹¼u±ibË
(&
ns
->
pŞl
);

545 
	}
}

551 
	$d’Œy_»£t_mouÁed
(
vfsmouÁ
 *
mÁ
, 
d’Œy
 *dentry)

553 
u
;

555 
u
 = 0; u < 
HASH_SIZE
; u++) {

556 
vfsmouÁ
 *
p
;

558 
	`li¡_fÜ_—ch_’Œy
(
p
, &
mouÁ_hashbË
[
u
], 
mÁ_hash
) {

559 ià(
p
->
mÁ_mouÁpošt
 =ğ
d’Œy
)

563 
	`¥š_lock
(&
d’Œy
->
d_lock
);

564 
d’Œy
->
d_æags
 &ğ~
DCACHE_MOUNTED
;

565 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

566 
	}
}

571 
	$d‘ach_mÁ
(
vfsmouÁ
 *
mÁ
, 
·th
 *
Şd_·th
)

573 
Şd_·th
->
d’Œy
 = 
mÁ
->
mÁ_mouÁpošt
;

574 
Şd_·th
->
mÁ
 = mÁ->
mÁ_·»Á
;

575 
mÁ
->
mÁ_·»Á
 = mnt;

576 
mÁ
->
mÁ_mouÁpošt
 = mÁ->
mÁ_roÙ
;

577 
	`li¡_d–_š™
(&
mÁ
->
mÁ_chd
);

578 
	`li¡_d–_š™
(&
mÁ
->
mÁ_hash
);

579 
	`d’Œy_»£t_mouÁed
(
Şd_·th
->
mÁ
, old_·th->
d’Œy
);

580 
	}
}

585 
	$mÁ_£t_mouÁpošt
(
vfsmouÁ
 *
mÁ
, 
d’Œy
 *dentry,

586 
vfsmouÁ
 *
chd_mÁ
)

588 
chd_mÁ
->
mÁ_·»Á
 = 
	`mÁg‘
(
mÁ
);

589 
chd_mÁ
->
mÁ_mouÁpošt
 = 
	`dg‘
(
d’Œy
);

590 
	`¥š_lock
(&
d’Œy
->
d_lock
);

591 
d’Œy
->
d_æags
 |ğ
DCACHE_MOUNTED
;

592 
	`¥š_uÆock
(&
d’Œy
->
d_lock
);

593 
	}
}

598 
	$©ch_mÁ
(
vfsmouÁ
 *
mÁ
, 
·th
 *path)

600 
	`mÁ_£t_mouÁpošt
(
·th
->
mÁ
,…©h->
d’Œy
, mnt);

601 
	`li¡_add_
(&
mÁ
->
mÁ_hash
, 
mouÁ_hashbË
 +

602 
	`hash
(
·th
->
mÁ
,…©h->
d’Œy
));

603 
	`li¡_add_
(&
mÁ
->
mÁ_chd
, &
·th
->mÁ->
mÁ_mouÁs
);

604 
	}
}

606 
šlše
 
	$__mÁ_make_lÚg‹rm
(
vfsmouÁ
 *
mÁ
)

608 #ifdeà
CONFIG_SMP


609 
	`©omic_šc
(&
mÁ
->
mÁ_lÚg‹rm
);

611 
	}
}

614 
šlše
 
	$__mÁ_make_shÜ‰”m
(
vfsmouÁ
 *
mÁ
)

616 #ifdeà
CONFIG_SMP


617 
	`©omic_dec
(&
mÁ
->
mÁ_lÚg‹rm
);

619 
	}
}

624 
	$comm™_Œ“
(
vfsmouÁ
 *
mÁ
)

626 
vfsmouÁ
 *
·»Á
 = 
mÁ
->
mÁ_·»Á
;

627 
vfsmouÁ
 *
m
;

628 
	`LIST_HEAD
(
h—d
);

629 
mÁ_Çme¥aû
 *
n
 = 
·»Á
->
mÁ_ns
;

631 
	`BUG_ON
(
·»Á
 =ğ
mÁ
);

633 
	`li¡_add_
(&
h—d
, &
mÁ
->
mÁ_li¡
);

634 
	`li¡_fÜ_—ch_’Œy
(
m
, &
h—d
, 
mÁ_li¡
) {

635 
m
->
mÁ_ns
 = 
n
;

636 
	`__mÁ_make_lÚg‹rm
(
m
);

639 
	`li¡_¥liû
(&
h—d
, 
n
->
li¡
.
´ev
);

641 
	`li¡_add_
(&
mÁ
->
mÁ_hash
, 
mouÁ_hashbË
 +

642 
	`hash
(
·»Á
, 
mÁ
->
mÁ_mouÁpošt
));

643 
	`li¡_add_
(&
mÁ
->
mÁ_chd
, &
·»Á
->
mÁ_mouÁs
);

644 
	`touch_mÁ_Çme¥aû
(
n
);

645 
	}
}

647 
vfsmouÁ
 *
	$Ãxt_mÁ
(
vfsmouÁ
 *
p
, vfsmouÁ *
roÙ
)

649 
li¡_h—d
 *
Ãxt
 = 
p
->
mÁ_mouÁs
.next;

650 ià(
Ãxt
 =ğ&
p
->
mÁ_mouÁs
) {

652 ià(
p
 =ğ
roÙ
)

653  
NULL
;

654 
Ãxt
 = 
p
->
mÁ_chd
.next;

655 ià(
Ãxt
 !ğ&
p
->
mÁ_·»Á
->
mÁ_mouÁs
)

657 
p
 =…->
mÁ_·»Á
;

660  
	`li¡_’Œy
(
Ãxt
, 
vfsmouÁ
, 
mÁ_chd
);

661 
	}
}

663 
vfsmouÁ
 *
	$sk_mÁ_Œ“
(
vfsmouÁ
 *
p
)

665 
li¡_h—d
 *
´ev
 = 
p
->
mÁ_mouÁs
.prev;

666 
´ev
 !ğ&
p
->
mÁ_mouÁs
) {

667 
p
 = 
	`li¡_’Œy
(
´ev
, 
vfsmouÁ
, 
mÁ_chd
);

668 
´ev
 = 
p
->
mÁ_mouÁs
.prev;

670  
p
;

671 
	}
}

673 
vfsmouÁ
 *

674 
	$vfs_k”n_mouÁ
(
fe_sy¡em_ty³
 *
ty³
, 
æags
, cÚ¡ *
Çme
, *
d©a
)

676 
vfsmouÁ
 *
mÁ
;

677 
d’Œy
 *
roÙ
;

679 ià(!
ty³
)

680  
	`ERR_PTR
(-
ENODEV
);

682 
mÁ
 = 
	`®loc_vfsmÁ
(
Çme
);

683 ià(!
mÁ
)

684  
	`ERR_PTR
(-
ENOMEM
);

686 ià(
æags
 & 
MS_KERNMOUNT
)

687 
mÁ
->
mÁ_æags
 = 
MNT_INTERNAL
;

689 
roÙ
 = 
	`mouÁ_fs
(
ty³
, 
æags
, 
Çme
, 
d©a
);

690 ià(
	`IS_ERR
(
roÙ
)) {

691 
	`ä“_vfsmÁ
(
mÁ
);

692  
	`ERR_CAST
(
roÙ
);

695 
mÁ
->
mÁ_roÙ
 = 
roÙ
;

696 
mÁ
->
mÁ_sb
 = 
roÙ
->
d_sb
;

697 
mÁ
->
mÁ_mouÁpošt
 = mÁ->
mÁ_roÙ
;

698 
mÁ
->
mÁ_·»Á
 = mnt;

699  
mÁ
;

700 
	}
}

701 
EXPORT_SYMBOL_GPL
(
vfs_k”n_mouÁ
);

703 
vfsmouÁ
 *
	$şÚe_mÁ
(
vfsmouÁ
 *
Şd
, 
d’Œy
 *
roÙ
,

704 
æag
)

706 
su³r_block
 *
sb
 = 
Şd
->
mÁ_sb
;

707 
vfsmouÁ
 *
mÁ
 = 
	`®loc_vfsmÁ
(
Şd
->
mÁ_devÇme
);

709 ià(
mÁ
) {

710 ià(
æag
 & (
CL_SLAVE
 | 
CL_PRIVATE
))

711 
mÁ
->
mÁ_group_id
 = 0;

713 
mÁ
->
mÁ_group_id
 = 
Şd
->mnt_group_id;

715 ià((
æag
 & 
CL_MAKE_SHARED
è&& !
mÁ
->
mÁ_group_id
) {

716 
”r
 = 
	`mÁ_®loc_group_id
(
mÁ
);

717 ià(
”r
)

718 
out_ä“
;

721 
mÁ
->
mÁ_æags
 = 
Şd
->mÁ_æag & ~
MNT_WRITE_HOLD
;

722 
	`©omic_šc
(&
sb
->
s_aùive
);

723 
mÁ
->
mÁ_sb
 = 
sb
;

724 
mÁ
->
mÁ_roÙ
 = 
	`dg‘
(
roÙ
);

725 
mÁ
->
mÁ_mouÁpošt
 = mÁ->
mÁ_roÙ
;

726 
mÁ
->
mÁ_·»Á
 = mnt;

728 ià(
æag
 & 
CL_SLAVE
) {

729 
	`li¡_add
(&
mÁ
->
mÁ_¦ave
, &
Şd
->
mÁ_¦ave_li¡
);

730 
mÁ
->
mÁ_ma¡”
 = 
Şd
;

731 
	`CLEAR_MNT_SHARED
(
mÁ
);

732 } ià(!(
æag
 & 
CL_PRIVATE
)) {

733 ià((
æag
 & 
CL_MAKE_SHARED
è|| 
	`IS_MNT_SHARED
(
Şd
))

734 
	`li¡_add
(&
mÁ
->
mÁ_sh¬e
, &
Şd
->mnt_share);

735 ià(
	`IS_MNT_SLAVE
(
Şd
))

736 
	`li¡_add
(&
mÁ
->
mÁ_¦ave
, &
Şd
->mnt_slave);

737 
mÁ
->
mÁ_ma¡”
 = 
Şd
->mnt_master;

739 ià(
æag
 & 
CL_MAKE_SHARED
)

740 
	`£t_mÁ_sh¬ed
(
mÁ
);

744 ià(
æag
 & 
CL_EXPIRE
) {

745 ià(!
	`li¡_em±y
(&
Şd
->
mÁ_expœe
))

746 
	`li¡_add
(&
mÁ
->
mÁ_expœe
, &
Şd
->mnt_expire);

749  
mÁ
;

751 
out_ä“
:

752 
	`ä“_vfsmÁ
(
mÁ
);

753  
NULL
;

754 
	}
}

756 
šlše
 
	$mÁä“
(
vfsmouÁ
 *
mÁ
)

758 
su³r_block
 *
sb
 = 
mÁ
->
mÁ_sb
;

770 
	`WARN_ON
(
	`mÁ_g‘_wr™”s
(
mÁ
));

771 
	`f¢Ùify_vfsmouÁ_d–‘e
(
mÁ
);

772 
	`dput
(
mÁ
->
mÁ_roÙ
);

773 
	`ä“_vfsmÁ
(
mÁ
);

774 
	`d—ùiv©e_su³r
(
sb
);

775 
	}
}

777 
	$mÁput_no_expœe
(
vfsmouÁ
 *
mÁ
)

779 
put_agaš
:

780 #ifdeà
CONFIG_SMP


781 
	`br_»ad_lock
(
vfsmouÁ_lock
);

782 ià(
	`lik–y
(
	`©omic_»ad
(&
mÁ
->
mÁ_lÚg‹rm
))) {

783 
	`mÁ_dec_couÁ
(
mÁ
);

784 
	`br_»ad_uÆock
(
vfsmouÁ_lock
);

787 
	`br_»ad_uÆock
(
vfsmouÁ_lock
);

789 
	`br_wr™e_lock
(
vfsmouÁ_lock
);

790 
	`mÁ_dec_couÁ
(
mÁ
);

791 ià(
	`mÁ_g‘_couÁ
(
mÁ
)) {

792 
	`br_wr™e_uÆock
(
vfsmouÁ_lock
);

796 
	`mÁ_dec_couÁ
(
mÁ
);

797 ià(
	`lik–y
(
	`mÁ_g‘_couÁ
(
mÁ
)))

799 
	`br_wr™e_lock
(
vfsmouÁ_lock
);

801 ià(
	`uÆik–y
(
mÁ
->
mÁ_pšÃd
)) {

802 
	`mÁ_add_couÁ
(
mÁ
, mÁ->
mÁ_pšÃd
 + 1);

803 
mÁ
->
mÁ_pšÃd
 = 0;

804 
	`br_wr™e_uÆock
(
vfsmouÁ_lock
);

805 
	`acù_auto_şo£_mÁ
(
mÁ
);

806 
put_agaš
;

808 
	`br_wr™e_uÆock
(
vfsmouÁ_lock
);

809 
	`mÁä“
(
mÁ
);

810 
	}
}

812 
	$mÁput
(
vfsmouÁ
 *
mÁ
)

814 ià(
mÁ
) {

816 ià(
	`uÆik–y
(
mÁ
->
mÁ_expœy_m¬k
))

817 
mÁ
->
mÁ_expœy_m¬k
 = 0;

818 
	`mÁput_no_expœe
(
mÁ
);

820 
	}
}

821 
EXPORT_SYMBOL
(
mÁput
);

823 
vfsmouÁ
 *
	$mÁg‘
(
vfsmouÁ
 *
mÁ
)

825 ià(
mÁ
)

826 
	`mÁ_šc_couÁ
(
mÁ
);

827  
mÁ
;

828 
	}
}

829 
EXPORT_SYMBOL
(
mÁg‘
);

831 
	$mÁ_pš
(
vfsmouÁ
 *
mÁ
)

833 
	`br_wr™e_lock
(
vfsmouÁ_lock
);

834 
mÁ
->
mÁ_pšÃd
++;

835 
	`br_wr™e_uÆock
(
vfsmouÁ_lock
);

836 
	}
}

837 
EXPORT_SYMBOL
(
mÁ_pš
);

839 
	$mÁ_uÅš
(
vfsmouÁ
 *
mÁ
)

841 
	`br_wr™e_lock
(
vfsmouÁ_lock
);

842 ià(
mÁ
->
mÁ_pšÃd
) {

843 
	`mÁ_šc_couÁ
(
mÁ
);

844 
mÁ
->
mÁ_pšÃd
--;

846 
	`br_wr™e_uÆock
(
vfsmouÁ_lock
);

847 
	}
}

848 
EXPORT_SYMBOL
(
mÁ_uÅš
);

850 
šlše
 
	$mªgË
(
£q_fe
 *
m
, cÚ¡ *
s
)

852 
	`£q_esÿ³
(
m
, 
s
, " \t\n\\");

853 
	}
}

861 
	$g’”ic_show_İtiÚs
(
£q_fe
 *
m
, 
vfsmouÁ
 *
mÁ
)

863 cÚ¡ *
İtiÚs
;

865 
	`rcu_»ad_lock
();

866 
İtiÚs
 = 
	`rcu_d”eã»nû
(
mÁ
->
mÁ_sb
->
s_İtiÚs
);

868 ià(
İtiÚs
 !ğ
NULL
 && options[0]) {

869 
	`£q_putc
(
m
, ',');

870 
	`mªgË
(
m
, 
İtiÚs
);

872 
	`rcu_»ad_uÆock
();

875 
	}
}

876 
EXPORT_SYMBOL
(
g’”ic_show_İtiÚs
);

891 
	$§ve_mouÁ_İtiÚs
(
su³r_block
 *
sb
, *
İtiÚs
)

893 
	`BUG_ON
(
sb
->
s_İtiÚs
);

894 
	`rcu_assign_poš‹r
(
sb
->
s_İtiÚs
, 
	`k¡rdup
(
İtiÚs
, 
GFP_KERNEL
));

895 
	}
}

896 
EXPORT_SYMBOL
(
§ve_mouÁ_İtiÚs
);

898 
	$»¶aû_mouÁ_İtiÚs
(
su³r_block
 *
sb
, *
İtiÚs
)

900 *
Şd
 = 
sb
->
s_İtiÚs
;

901 
	`rcu_assign_poš‹r
(
sb
->
s_İtiÚs
, 
İtiÚs
);

902 ià(
Şd
) {

903 
	`synchrÚize_rcu
();

904 
	`kä“
(
Şd
);

906 
	}
}

907 
EXPORT_SYMBOL
(
»¶aû_mouÁ_İtiÚs
);

909 #ifdeà
CONFIG_PROC_FS


911 *
	$m_¡¬t
(
£q_fe
 *
m
, 
loff_t
 *
pos
)

913 
´oc_mouÁs
 *
p
 = 
m
->
´iv©e
;

915 
	`down_»ad
(&
Çme¥aû_£m
);

916  
	`£q_li¡_¡¬t
(&
p
->
ns
->
li¡
, *
pos
);

917 
	}
}

919 *
	$m_Ãxt
(
£q_fe
 *
m
, *
v
, 
loff_t
 *
pos
)

921 
´oc_mouÁs
 *
p
 = 
m
->
´iv©e
;

923  
	`£q_li¡_Ãxt
(
v
, &
p
->
ns
->
li¡
, 
pos
);

924 
	}
}

926 
	$m_¡İ
(
£q_fe
 *
m
, *
v
)

928 
	`up_»ad
(&
Çme¥aû_£m
);

929 
	}
}

931 
	$mÁ_had_ev’ts
(
´oc_mouÁs
 *
p
)

933 
mÁ_Çme¥aû
 *
ns
 = 
p
->ns;

934 
»s
 = 0;

936 
	`br_»ad_lock
(
vfsmouÁ_lock
);

937 ià(
p
->
m
.
pŞl_ev’t
 !ğ
ns
->
ev’t
) {

938 
p
->
m
.
pŞl_ev’t
 = 
ns
->
ev’t
;

939 
»s
 = 1;

941 
	`br_»ad_uÆock
(
vfsmouÁ_lock
);

943  
»s
;

944 
	}
}

946 
	s´oc_fs_šfo
 {

947 
	mæag
;

948 cÚ¡ *
	m¡r
;

951 
	$show_sb_İts
(
£q_fe
 *
m
, 
su³r_block
 *
sb
)

953 cÚ¡ 
´oc_fs_šfo
 
fs_šfo
[] = {

954 { 
MS_SYNCHRONOUS
, ",sync" },

955 { 
MS_DIRSYNC
, ",dirsync" },

956 { 
MS_MANDLOCK
, ",mand" },

957 { 0, 
NULL
 }

959 cÚ¡ 
´oc_fs_šfo
 *
fs_šfİ
;

961 
fs_šfİ
 = 
fs_šfo
; fs_šfİ->
æag
; fs_infop++) {

962 ià(
sb
->
s_æags
 & 
fs_šfİ
->
æag
)

963 
	`£q_puts
(
m
, 
fs_šfİ
->
¡r
);

966  
	`£cur™y_sb_show_İtiÚs
(
m
, 
sb
);

967 
	}
}

969 
	$show_mÁ_İts
(
£q_fe
 *
m
, 
vfsmouÁ
 *
mÁ
)

971 cÚ¡ 
´oc_fs_šfo
 
mÁ_šfo
[] = {

972 { 
MNT_NOSUID
, ",nosuid" },

973 { 
MNT_NODEV
, ",nodev" },

974 { 
MNT_NOEXEC
, ",noexec" },

975 { 
MNT_NOATIME
, ",noatime" },

976 { 
MNT_NODIRATIME
, ",nodiratime" },

977 { 
MNT_RELATIME
, ",relatime" },

978 { 0, 
NULL
 }

980 cÚ¡ 
´oc_fs_šfo
 *
fs_šfİ
;

982 
fs_šfİ
 = 
mÁ_šfo
; fs_šfİ->
æag
; fs_infop++) {

983 ià(
mÁ
->
mÁ_æags
 & 
fs_šfİ
->
æag
)

984 
	`£q_puts
(
m
, 
fs_šfİ
->
¡r
);

986 
	}
}

988 
	$show_ty³
(
£q_fe
 *
m
, 
su³r_block
 *
sb
)

990 
	`mªgË
(
m
, 
sb
->
s_ty³
->
Çme
);

991 ià(
sb
->
s_subty³
 && sb->s_subtype[0]) {

992 
	`£q_putc
(
m
, '.');

993 
	`mªgË
(
m
, 
sb
->
s_subty³
);

995 
	}
}

997 
	$show_vfsmÁ
(
£q_fe
 *
m
, *
v
)

999 
vfsmouÁ
 *
mÁ
 = 
	`li¡_’Œy
(
v
, vfsmouÁ, 
mÁ_li¡
);

1000 
”r
 = 0;

1001 
·th
 
mÁ_·th
 = { .
d’Œy
 = 
mÁ
->
mÁ_roÙ
, .mnt = mnt };

1003 ià(
mÁ
->
mÁ_sb
->
s_İ
->
show_devÇme
) {

1004 
”r
 = 
mÁ
->
mÁ_sb
->
s_İ
->
	`show_devÇme
(
m
, mnt);

1005 ià(
”r
)

1006 
out
;

1008 
	`mªgË
(
m
, 
mÁ
->
mÁ_devÇme
 ? mnt->mnt_devname : "none");

1010 
	`£q_putc
(
m
, ' ');

1011 
	`£q_·th
(
m
, &
mÁ_·th
, " \t\n\\");

1012 
	`£q_putc
(
m
, ' ');

1013 
	`show_ty³
(
m
, 
mÁ
->
mÁ_sb
);

1014 
	`£q_puts
(
m
, 
	`__mÁ_is_»adÚly
(
mÁ
) ? "„o" : "„w");

1015 
”r
 = 
	`show_sb_İts
(
m
, 
mÁ
->
mÁ_sb
);

1016 ià(
”r
)

1017 
out
;

1018 
	`show_mÁ_İts
(
m
, 
mÁ
);

1019 ià(
mÁ
->
mÁ_sb
->
s_İ
->
show_İtiÚs
)

1020 
”r
 = 
mÁ
->
mÁ_sb
->
s_İ
->
	`show_İtiÚs
(
m
, mnt);

1021 
	`£q_puts
(
m
, " 0 0\n");

1022 
out
:

1023  
”r
;

1024 
	}
}

1026 cÚ¡ 
£q_İ”©iÚs
 
	gmouÁs_İ
 = {

1027 .
¡¬t
 = 
m_¡¬t
,

1028 .
	gÃxt
 = 
m_Ãxt
,

1029 .
	g¡İ
 = 
m_¡İ
,

1030 .
	gshow
 = 
show_vfsmÁ


1033 
	$show_mouÁšfo
(
£q_fe
 *
m
, *
v
)

1035 
´oc_mouÁs
 *
p
 = 
m
->
´iv©e
;

1036 
vfsmouÁ
 *
mÁ
 = 
	`li¡_’Œy
(
v
, vfsmouÁ, 
mÁ_li¡
);

1037 
su³r_block
 *
sb
 = 
mÁ
->
mÁ_sb
;

1038 
·th
 
mÁ_·th
 = { .
d’Œy
 = 
mÁ
->
mÁ_roÙ
, .mnt = mnt };

1039 
·th
 
roÙ
 = 
p
->root;

1040 
”r
 = 0;

1042 
	`£q_´štf
(
m
, "%˜%˜%u:%u ", 
mÁ
->
mÁ_id
, mÁ->
mÁ_·»Á
->mnt_id,

1043 
	`MAJOR
(
sb
->
s_dev
), 
	`MINOR
(sb->s_dev));

1044 ià(
sb
->
s_İ
->
show_·th
)

1045 
”r
 = 
sb
->
s_İ
->
	`show_·th
(
m
, 
mÁ
);

1047 
	`£q_d’Œy
(
m
, 
mÁ
->
mÁ_roÙ
, " \t\n\\");

1048 ià(
”r
)

1049 
out
;

1050 
	`£q_putc
(
m
, ' ');

1053 
”r
 = 
	`£q_·th_roÙ
(
m
, &
mÁ_·th
, &
roÙ
, " \t\n\\");

1054 ià(
”r
)

1055 
out
;

1057 
	`£q_puts
(
m
, 
mÁ
->
mÁ_æags
 & 
MNT_READONLY
 ? "„o" : "„w");

1058 
	`show_mÁ_İts
(
m
, 
mÁ
);

1061 ià(
	`IS_MNT_SHARED
(
mÁ
))

1062 
	`£q_´štf
(
m
, " sh¬ed:%i", 
mÁ
->
mÁ_group_id
);

1063 ià(
	`IS_MNT_SLAVE
(
mÁ
)) {

1064 
ma¡”
 = 
mÁ
->
mÁ_ma¡”
->
mÁ_group_id
;

1065 
dom
 = 
	`g‘_domš©šg_id
(
mÁ
, &
p
->
roÙ
);

1066 
	`£q_´štf
(
m
, " ma¡”:%i", 
ma¡”
);

1067 ià(
dom
 && dom !ğ
ma¡”
)

1068 
	`£q_´štf
(
m
, "…rİag©e_äom:%i", 
dom
);

1070 ià(
	`IS_MNT_UNBINDABLE
(
mÁ
))

1071 
	`£q_puts
(
m
, " unbindable");

1074 
	`£q_puts
(
m
, " - ");

1075 
	`show_ty³
(
m
, 
sb
);

1076 
	`£q_putc
(
m
, ' ');

1077 ià(
sb
->
s_İ
->
show_devÇme
)

1078 
”r
 = 
sb
->
s_İ
->
	`show_devÇme
(
m
, 
mÁ
);

1080 
	`mªgË
(
m
, 
mÁ
->
mÁ_devÇme
 ? mnt->mnt_devname : "none");

1081 ià(
”r
)

1082 
out
;

1083 
	`£q_puts
(
m
, 
sb
->
s_æags
 & 
MS_RDONLY
 ? "„o" : "„w");

1084 
”r
 = 
	`show_sb_İts
(
m
, 
sb
);

1085 ià(
”r
)

1086 
out
;

1087 ià(
sb
->
s_İ
->
show_İtiÚs
)

1088 
”r
 = 
sb
->
s_İ
->
	`show_İtiÚs
(
m
, 
mÁ
);

1089 
	`£q_putc
(
m
, '\n');

1090 
out
:

1091  
”r
;

1092 
	}
}

1094 cÚ¡ 
£q_İ”©iÚs
 
	gmouÁšfo_İ
 = {

1095 .
¡¬t
 = 
m_¡¬t
,

1096 .
	gÃxt
 = 
m_Ãxt
,

1097 .
	g¡İ
 = 
m_¡İ
,

1098 .
	gshow
 = 
show_mouÁšfo
,

1101 
	$show_vfs¡©
(
£q_fe
 *
m
, *
v
)

1103 
vfsmouÁ
 *
mÁ
 = 
	`li¡_’Œy
(
v
, vfsmouÁ, 
mÁ_li¡
);

1104 
·th
 
mÁ_·th
 = { .
d’Œy
 = 
mÁ
->
mÁ_roÙ
, .mnt = mnt };

1105 
”r
 = 0;

1108 ià(
mÁ
->
mÁ_sb
->
s_İ
->
show_devÇme
) {

1109 
	`£q_puts
(
m
, "device ");

1110 
”r
 = 
mÁ
->
mÁ_sb
->
s_İ
->
	`show_devÇme
(
m
, mnt);

1112 ià(
mÁ
->
mÁ_devÇme
) {

1113 
	`£q_puts
(
m
, "device ");

1114 
	`mªgË
(
m
, 
mÁ
->
mÁ_devÇme
);

1116 
	`£q_puts
(
m
, "no device");

1120 
	`£q_puts
(
m
, " mounted on ");

1121 
	`£q_·th
(
m
, &
mÁ_·th
, " \t\n\\");

1122 
	`£q_putc
(
m
, ' ');

1125 
	`£q_puts
(
m
, "with fstype ");

1126 
	`show_ty³
(
m
, 
mÁ
->
mÁ_sb
);

1129 ià(
mÁ
->
mÁ_sb
->
s_İ
->
show_¡©s
) {

1130 
	`£q_putc
(
m
, ' ');

1131 ià(!
”r
)

1132 
”r
 = 
mÁ
->
mÁ_sb
->
s_İ
->
	`show_¡©s
(
m
, mnt);

1135 
	`£q_putc
(
m
, '\n');

1136  
”r
;

1137 
	}
}

1139 cÚ¡ 
£q_İ”©iÚs
 
	gmouÁ¡©s_İ
 = {

1140 .
¡¬t
 = 
m_¡¬t
,

1141 .
	gÃxt
 = 
m_Ãxt
,

1142 .
	g¡İ
 = 
m_¡İ
,

1143 .
	gshow
 = 
show_vfs¡©
,

1155 
	$may_umouÁ_Œ“
(
vfsmouÁ
 *
mÁ
)

1157 
aùu®_»fs
 = 0;

1158 
mšimum_»fs
 = 0;

1159 
vfsmouÁ
 *
p
;

1162 
	`br_wr™e_lock
(
vfsmouÁ_lock
);

1163 
p
 = 
mÁ
;…;… = 
	`Ãxt_mÁ
(p, mnt)) {

1164 
aùu®_»fs
 +ğ
	`mÁ_g‘_couÁ
(
p
);

1165 
mšimum_»fs
 += 2;

1167 
	`br_wr™e_uÆock
(
vfsmouÁ_lock
);

1169 ià(
aùu®_»fs
 > 
mšimum_»fs
)

1173 
	}
}

1175 
EXPORT_SYMBOL
(
may_umouÁ_Œ“
);

1190 
	$may_umouÁ
(
vfsmouÁ
 *
mÁ
)

1192 
»t
 = 1;

1193 
	`down_»ad
(&
Çme¥aû_£m
);

1194 
	`br_wr™e_lock
(
vfsmouÁ_lock
);

1195 ià(
	`´İag©e_mouÁ_busy
(
mÁ
, 2))

1196 
»t
 = 0;

1197 
	`br_wr™e_uÆock
(
vfsmouÁ_lock
);

1198 
	`up_»ad
(&
Çme¥aû_£m
);

1199  
»t
;

1200 
	}
}

1202 
EXPORT_SYMBOL
(
may_umouÁ
);

1204 
	$»Ëa£_mouÁs
(
li¡_h—d
 *
h—d
)

1206 
vfsmouÁ
 *
mÁ
;

1207 !
	`li¡_em±y
(
h—d
)) {

1208 
mÁ
 = 
	`li¡_fœ¡_’Œy
(
h—d
, 
vfsmouÁ
, 
mÁ_hash
);

1209 
	`li¡_d–_š™
(&
mÁ
->
mÁ_hash
);

1210 ià(
mÁ
->
mÁ_·»Á
 != mnt) {

1211 
d’Œy
 *dentry;

1212 
vfsmouÁ
 *
m
;

1214 
	`br_wr™e_lock
(
vfsmouÁ_lock
);

1215 
d’Œy
 = 
mÁ
->
mÁ_mouÁpošt
;

1216 
m
 = 
mÁ
->
mÁ_·»Á
;

1217 
mÁ
->
mÁ_mouÁpošt
 = mÁ->
mÁ_roÙ
;

1218 
mÁ
->
mÁ_·»Á
 = mnt;

1219 
m
->
mÁ_gho¡s
--;

1220 
	`br_wr™e_uÆock
(
vfsmouÁ_lock
);

1221 
	`dput
(
d’Œy
);

1222 
	`mÁput
(
m
);

1224 
	`mÁput
(
mÁ
);

1226 
	}
}

1232 
	$umouÁ_Œ“
(
vfsmouÁ
 *
mÁ
, 
´İag©e
, 
li¡_h—d
 *
kl
)

1234 
	`LIST_HEAD
(
tmp_li¡
);

1235 
vfsmouÁ
 *
p
;

1237 
p
 = 
mÁ
;…;… = 
	`Ãxt_mÁ
(p, mnt))

1238 
	`li¡_move
(&
p
->
mÁ_hash
, &
tmp_li¡
);

1240 ià(
´İag©e
)

1241 
	`´İag©e_umouÁ
(&
tmp_li¡
);

1243 
	`li¡_fÜ_—ch_’Œy
(
p
, &
tmp_li¡
, 
mÁ_hash
) {

1244 
	`li¡_d–_š™
(&
p
->
mÁ_expœe
);

1245 
	`li¡_d–_š™
(&
p
->
mÁ_li¡
);

1246 
	`__touch_mÁ_Çme¥aû
(
p
->
mÁ_ns
);

1247 
p
->
mÁ_ns
 = 
NULL
;

1248 
	`__mÁ_make_shÜ‰”m
(
p
);

1249 
	`li¡_d–_š™
(&
p
->
mÁ_chd
);

1250 ià(
p
->
mÁ_·»Á
 !=…) {

1251 
p
->
mÁ_·»Á
->
mÁ_gho¡s
++;

1252 
	`d’Œy_»£t_mouÁed
(
p
->
mÁ_·»Á
,…->
mÁ_mouÁpošt
);

1254 
	`chªge_mÁ_´İag©iÚ
(
p
, 
MS_PRIVATE
);

1256 
	`li¡_¥liû
(&
tmp_li¡
, 
kl
);

1257 
	}
}

1259 
shršk_submouÁs
(
vfsmouÁ
 *
mÁ
, 
li¡_h—d
 *
umouÁs
);

1261 
	$do_umouÁ
(
vfsmouÁ
 *
mÁ
, 
æags
)

1263 
su³r_block
 *
sb
 = 
mÁ
->
mÁ_sb
;

1264 
»tv®
;

1265 
	`LIST_HEAD
(
umouÁ_li¡
);

1267 
»tv®
 = 
	`£cur™y_sb_umouÁ
(
mÁ
, 
æags
);

1268 ià(
»tv®
)

1269  
»tv®
;

1277 ià(
æags
 & 
MNT_EXPIRE
) {

1278 ià(
mÁ
 =ğ
cu¼’t
->
fs
->
roÙ
.mnt ||

1279 
æags
 & (
MNT_FORCE
 | 
MNT_DETACH
))

1280  -
EINVAL
;

1286 
	`br_wr™e_lock
(
vfsmouÁ_lock
);

1287 ià(
	`mÁ_g‘_couÁ
(
mÁ
) != 2) {

1288 
	`br_wr™e_uÆock
(
vfsmouÁ_lock
);

1289  -
EBUSY
;

1291 
	`br_wr™e_uÆock
(
vfsmouÁ_lock
);

1293 ià(!
	`xchg
(&
mÁ
->
mÁ_expœy_m¬k
, 1))

1294  -
EAGAIN
;

1307 ià(
æags
 & 
MNT_FORCE
 && 
sb
->
s_İ
->
umouÁ_begš
) {

1308 
sb
->
s_İ
->
	`umouÁ_begš
(sb);

1320 ià(
mÁ
 =ğ
cu¼’t
->
fs
->
roÙ
.mÁ && !(
æags
 & 
MNT_DETACH
)) {

1325 
	`down_wr™e
(&
sb
->
s_umouÁ
);

1326 ià(!(
sb
->
s_æags
 & 
MS_RDONLY
))

1327 
»tv®
 = 
	`do_»mouÁ_sb
(
sb
, 
MS_RDONLY
, 
NULL
, 0);

1328 
	`up_wr™e
(&
sb
->
s_umouÁ
);

1329  
»tv®
;

1332 
	`down_wr™e
(&
Çme¥aû_£m
);

1333 
	`br_wr™e_lock
(
vfsmouÁ_lock
);

1334 
ev’t
++;

1336 ià(!(
æags
 & 
MNT_DETACH
))

1337 
	`shršk_submouÁs
(
mÁ
, &
umouÁ_li¡
);

1339 
»tv®
 = -
EBUSY
;

1340 ià(
æags
 & 
MNT_DETACH
 || !
	`´İag©e_mouÁ_busy
(
mÁ
, 2)) {

1341 ià(!
	`li¡_em±y
(&
mÁ
->
mÁ_li¡
))

1342 
	`umouÁ_Œ“
(
mÁ
, 1, &
umouÁ_li¡
);

1343 
»tv®
 = 0;

1345 
	`br_wr™e_uÆock
(
vfsmouÁ_lock
);

1346 
	`up_wr™e
(&
Çme¥aû_£m
);

1347 
	`»Ëa£_mouÁs
(&
umouÁ_li¡
);

1348  
»tv®
;

1349 
	}
}

1359 
	$SYSCALL_DEFINE2
(
umouÁ
, 
__u£r
 *, 
Çme
, , 
æags
)

1361 
·th
…ath;

1362 
»tv®
;

1363 
lookup_æags
 = 0;

1365 ià(
æags
 & ~(
MNT_FORCE
 | 
MNT_DETACH
 | 
MNT_EXPIRE
 | 
UMOUNT_NOFOLLOW
))

1366  -
EINVAL
;

1368 ià(!(
æags
 & 
UMOUNT_NOFOLLOW
))

1369 
lookup_æags
 |ğ
LOOKUP_FOLLOW
;

1371 
»tv®
 = 
	`u£r_·th_©
(
AT_FDCWD
, 
Çme
, 
lookup_æags
, &
·th
);

1372 ià(
»tv®
)

1373 
out
;

1374 
»tv®
 = -
EINVAL
;

1375 ià(
·th
.
d’Œy
 !ğ·th.
mÁ
->
mÁ_roÙ
)

1376 
dput_ªd_out
;

1377 ià(!
	`check_mÁ
(
·th
.
mÁ
))

1378 
dput_ªd_out
;

1380 
»tv®
 = -
EPERM
;

1381 ià(!
	`ÿ·bË
(
CAP_SYS_ADMIN
))

1382 
dput_ªd_out
;

1384 
»tv®
 = 
	`do_umouÁ
(
·th
.
mÁ
, 
æags
);

1385 
dput_ªd_out
:

1387 
	`dput
(
·th
.
d’Œy
);

1388 
	`mÁput_no_expœe
(
·th
.
mÁ
);

1389 
out
:

1390  
»tv®
;

1391 
	}
}

1393 #ifdeà
__ARCH_WANT_SYS_OLDUMOUNT


1398 
	$SYSCALL_DEFINE1
(
ŞdumouÁ
, 
__u£r
 *, 
Çme
)

1400  
	`sys_umouÁ
(
Çme
, 0);

1401 
	}
}

1405 
	$mouÁ_is_§ã
(
·th
 *path)

1407 ià(
	`ÿ·bË
(
CAP_SYS_ADMIN
))

1409  -
EPERM
;

1410 #ifdeà
nÙy‘


1411 ià(
	`S_ISLNK
(
·th
->
d’Œy
->
d_šode
->
i_mode
))

1412  -
EPERM
;

1413 ià(
·th
->
d’Œy
->
d_šode
->
i_mode
 & 
S_ISVTX
) {

1414 ià(
	`cu¼’t_uid
(è!ğ
·th
->
d’Œy
->
d_šode
->
i_uid
)

1415  -
EPERM
;

1417 ià(
	`šode_³rmissiÚ
(
·th
->
d’Œy
->
d_šode
, 
MAY_WRITE
))

1418  -
EPERM
;

1421 
	}
}

1423 
vfsmouÁ
 *
	$cİy_Œ“
(
vfsmouÁ
 *
mÁ
, 
d’Œy
 *dentry,

1424 
æag
)

1426 
vfsmouÁ
 *
»s
, *
p
, *
q
, *
r
, *
s
;

1427 
·th
…ath;

1429 ià(!(
æag
 & 
CL_COPY_ALL
è&& 
	`IS_MNT_UNBINDABLE
(
mÁ
))

1430  
NULL
;

1432 
»s
 = 
q
 = 
	`şÚe_mÁ
(
mÁ
, 
d’Œy
, 
æag
);

1433 ià(!
q
)

1434 
Enomem
;

1435 
q
->
mÁ_mouÁpošt
 = 
mÁ
->mnt_mountpoint;

1437 
p
 = 
mÁ
;

1438 
	`li¡_fÜ_—ch_’Œy
(
r
, &
mÁ
->
mÁ_mouÁs
, 
mÁ_chd
) {

1439 ià(!
	`is_subdœ
(
r
->
mÁ_mouÁpošt
, 
d’Œy
))

1442 
s
 = 
r
; s; s = 
	`Ãxt_mÁ
(s,„)) {

1443 ià(!(
æag
 & 
CL_COPY_ALL
è&& 
	`IS_MNT_UNBINDABLE
(
s
)) {

1444 
s
 = 
	`sk_mÁ_Œ“
(s);

1447 
p
 !ğ
s
->
mÁ_·»Á
) {

1448 
p
 =…->
mÁ_·»Á
;

1449 
q
 = q->
mÁ_·»Á
;

1451 
p
 = 
s
;

1452 
·th
.
mÁ
 = 
q
;

1453 
·th
.
d’Œy
 = 
p
->
mÁ_mouÁpošt
;

1454 
q
 = 
	`şÚe_mÁ
(
p
,…->
mÁ_roÙ
, 
æag
);

1455 ià(!
q
)

1456 
Enomem
;

1457 
	`br_wr™e_lock
(
vfsmouÁ_lock
);

1458 
	`li¡_add_
(&
q
->
mÁ_li¡
, &
»s
->mnt_list);

1459 
	`©ch_mÁ
(
q
, &
·th
);

1460 
	`br_wr™e_uÆock
(
vfsmouÁ_lock
);

1463  
»s
;

1464 
Enomem
:

1465 ià(
»s
) {

1466 
	`LIST_HEAD
(
umouÁ_li¡
);

1467 
	`br_wr™e_lock
(
vfsmouÁ_lock
);

1468 
	`umouÁ_Œ“
(
»s
, 0, &
umouÁ_li¡
);

1469 
	`br_wr™e_uÆock
(
vfsmouÁ_lock
);

1470 
	`»Ëa£_mouÁs
(&
umouÁ_li¡
);

1472  
NULL
;

1473 
	}
}

1475 
vfsmouÁ
 *
	$cŞËù_mouÁs
(
·th
 *path)

1477 
vfsmouÁ
 *
Œ“
;

1478 
	`down_wr™e
(&
Çme¥aû_£m
);

1479 
Œ“
 = 
	`cİy_Œ“
(
·th
->
mÁ
,…©h->
d’Œy
, 
CL_COPY_ALL
 | 
CL_PRIVATE
);

1480 
	`up_wr™e
(&
Çme¥aû_£m
);

1481  
Œ“
;

1482 
	}
}

1484 
	$drİ_cŞËùed_mouÁs
(
vfsmouÁ
 *
mÁ
)

1486 
	`LIST_HEAD
(
umouÁ_li¡
);

1487 
	`down_wr™e
(&
Çme¥aû_£m
);

1488 
	`br_wr™e_lock
(
vfsmouÁ_lock
);

1489 
	`umouÁ_Œ“
(
mÁ
, 0, &
umouÁ_li¡
);

1490 
	`br_wr™e_uÆock
(
vfsmouÁ_lock
);

1491 
	`up_wr™e
(&
Çme¥aû_£m
);

1492 
	`»Ëa£_mouÁs
(&
umouÁ_li¡
);

1493 
	}
}

1495 
™”©e_mouÁs
((*
f
)(
vfsmouÁ
 *, *), *
¬g
,

1496 
vfsmouÁ
 *
roÙ
)

1498 
vfsmouÁ
 *
mÁ
;

1499 
»s
 = 
	`f
(
roÙ
, 
¬g
);

1500 ià(
»s
)

1501  
»s
;

1502 
	`li¡_fÜ_—ch_’Œy
(
mÁ
, &
roÙ
->
mÁ_li¡
, mnt_list) {

1503 
»s
 = 
	`f
(
mÁ
, 
¬g
);

1504 ià(
»s
)

1505  
»s
;

1508 
	}
}

1510 
	$ş—nup_group_ids
(
vfsmouÁ
 *
mÁ
, vfsmouÁ *
’d
)

1512 
vfsmouÁ
 *
p
;

1514 
p
 = 
mÁ
;… !ğ
’d
;… = 
	`Ãxt_mÁ
(p, mnt)) {

1515 ià(
p
->
mÁ_group_id
 && !
	`IS_MNT_SHARED
(p))

1516 
	`mÁ_»Ëa£_group_id
(
p
);

1518 
	}
}

1520 
	$šv’t_group_ids
(
vfsmouÁ
 *
mÁ
, 
boŞ
 
»cur£
)

1522 
vfsmouÁ
 *
p
;

1524 
p
 = 
mÁ
;…;… = 
»cur£
 ? 
	`Ãxt_mÁ
Õ, mÁè: 
NULL
) {

1525 ià(!
p
->
mÁ_group_id
 && !
	`IS_MNT_SHARED
(p)) {

1526 
”r
 = 
	`mÁ_®loc_group_id
(
p
);

1527 ià(
”r
) {

1528 
	`ş—nup_group_ids
(
mÁ
, 
p
);

1529  
”r
;

1535 
	}
}

1600 
	$©ch_»cursive_mÁ
(
vfsmouÁ
 *
sourû_mÁ
,

1601 
·th
 *·th, ·th *
·»Á_·th
)

1603 
	`LIST_HEAD
(
Œ“_li¡
);

1604 
vfsmouÁ
 *
de¡_mÁ
 = 
·th
->
mÁ
;

1605 
d’Œy
 *
de¡_d’Œy
 = 
·th
->dentry;

1606 
vfsmouÁ
 *
chd
, *
p
;

1607 
”r
;

1609 ià(
	`IS_MNT_SHARED
(
de¡_mÁ
)) {

1610 
”r
 = 
	`šv’t_group_ids
(
sourû_mÁ
, 
Œue
);

1611 ià(
”r
)

1612 
out
;

1614 
”r
 = 
	`´İag©e_mÁ
(
de¡_mÁ
, 
de¡_d’Œy
, 
sourû_mÁ
, &
Œ“_li¡
);

1615 ià(
”r
)

1616 
out_ş—nup_ids
;

1618 
	`br_wr™e_lock
(
vfsmouÁ_lock
);

1620 ià(
	`IS_MNT_SHARED
(
de¡_mÁ
)) {

1621 
p
 = 
sourû_mÁ
;…;… = 
	`Ãxt_mÁ
(p, source_mnt))

1622 
	`£t_mÁ_sh¬ed
(
p
);

1624 ià(
·»Á_·th
) {

1625 
	`d‘ach_mÁ
(
sourû_mÁ
, 
·»Á_·th
);

1626 
	`©ch_mÁ
(
sourû_mÁ
, 
·th
);

1627 
	`touch_mÁ_Çme¥aû
(
·»Á_·th
->
mÁ
->
mÁ_ns
);

1629 
	`mÁ_£t_mouÁpošt
(
de¡_mÁ
, 
de¡_d’Œy
, 
sourû_mÁ
);

1630 
	`comm™_Œ“
(
sourû_mÁ
);

1633 
	`li¡_fÜ_—ch_’Œy_§ã
(
chd
, 
p
, &
Œ“_li¡
, 
mÁ_hash
) {

1634 
	`li¡_d–_š™
(&
chd
->
mÁ_hash
);

1635 
	`comm™_Œ“
(
chd
);

1637 
	`br_wr™e_uÆock
(
vfsmouÁ_lock
);

1641 
out_ş—nup_ids
:

1642 ià(
	`IS_MNT_SHARED
(
de¡_mÁ
))

1643 
	`ş—nup_group_ids
(
sourû_mÁ
, 
NULL
);

1644 
out
:

1645  
”r
;

1646 
	}
}

1648 
	$lock_mouÁ
(
·th
 *path)

1650 
vfsmouÁ
 *
mÁ
;

1651 
»Œy
:

1652 
	`mu‹x_lock
(&
·th
->
d’Œy
->
d_šode
->
i_mu‹x
);

1653 ià(
	`uÆik–y
(
	`ÿÁ_mouÁ
(
·th
->
d’Œy
))) {

1654 
	`mu‹x_uÆock
(&
·th
->
d’Œy
->
d_šode
->
i_mu‹x
);

1655  -
ENOENT
;

1657 
	`down_wr™e
(&
Çme¥aû_£m
);

1658 
mÁ
 = 
	`lookup_mÁ
(
·th
);

1659 ià(
	`lik–y
(!
mÁ
))

1661 
	`up_wr™e
(&
Çme¥aû_£m
);

1662 
	`mu‹x_uÆock
(&
·th
->
d’Œy
->
d_šode
->
i_mu‹x
);

1663 
	`·th_put
(
·th
);

1664 
·th
->
mÁ
 = mnt;

1665 
·th
->
d’Œy
 = 
	`dg‘
(
mÁ
->
mÁ_roÙ
);

1666 
»Œy
;

1667 
	}
}

1669 
	$uÆock_mouÁ
(
·th
 *path)

1671 
	`up_wr™e
(&
Çme¥aû_£m
);

1672 
	`mu‹x_uÆock
(&
·th
->
d’Œy
->
d_šode
->
i_mu‹x
);

1673 
	}
}

1675 
	$g¿á_Œ“
(
vfsmouÁ
 *
mÁ
, 
·th
 *path)

1677 ià(
mÁ
->
mÁ_sb
->
s_æags
 & 
MS_NOUSER
)

1678  -
EINVAL
;

1680 ià(
	`S_ISDIR
(
·th
->
d’Œy
->
d_šode
->
i_mode
) !=

1681 
	`S_ISDIR
(
mÁ
->
mÁ_roÙ
->
d_šode
->
i_mode
))

1682  -
ENOTDIR
;

1684 ià(
	`d_uÆšked
(
·th
->
d’Œy
))

1685  -
ENOENT
;

1687  
	`©ch_»cursive_mÁ
(
mÁ
, 
·th
, 
NULL
);

1688 
	}
}

1694 
	$æags_to_´İag©iÚ_ty³
(
æags
)

1696 
ty³
 = 
æags
 & ~(
MS_REC
 | 
MS_SILENT
);

1699 ià(
ty³
 & ~(
MS_SHARED
 | 
MS_PRIVATE
 | 
MS_SLAVE
 | 
MS_UNBINDABLE
))

1702 ià(!
	`is_pow”_of_2
(
ty³
))

1704  
ty³
;

1705 
	}
}

1710 
	$do_chªge_ty³
(
·th
 *·th, 
æag
)

1712 
vfsmouÁ
 *
m
, *
mÁ
 = 
·th
->mnt;

1713 
»cur£
 = 
æag
 & 
MS_REC
;

1714 
ty³
;

1715 
”r
 = 0;

1717 ià(!
	`ÿ·bË
(
CAP_SYS_ADMIN
))

1718  -
EPERM
;

1720 ià(
·th
->
d’Œy
 !ğ·th->
mÁ
->
mÁ_roÙ
)

1721  -
EINVAL
;

1723 
ty³
 = 
	`æags_to_´İag©iÚ_ty³
(
æag
);

1724 ià(!
ty³
)

1725  -
EINVAL
;

1727 
	`down_wr™e
(&
Çme¥aû_£m
);

1728 ià(
ty³
 =ğ
MS_SHARED
) {

1729 
”r
 = 
	`šv’t_group_ids
(
mÁ
, 
»cur£
);

1730 ià(
”r
)

1731 
out_uÆock
;

1734 
	`br_wr™e_lock
(
vfsmouÁ_lock
);

1735 
m
 = 
mÁ
; m; m = (
»cur£
 ? 
	`Ãxt_mÁ
(m, mÁè: 
NULL
))

1736 
	`chªge_mÁ_´İag©iÚ
(
m
, 
ty³
);

1737 
	`br_wr™e_uÆock
(
vfsmouÁ_lock
);

1739 
out_uÆock
:

1740 
	`up_wr™e
(&
Çme¥aû_£m
);

1741  
”r
;

1742 
	}
}

1747 
	$do_loİback
(
·th
 *·th, *
Şd_Çme
,

1748 
»cur£
)

1750 
	`LIST_HEAD
(
umouÁ_li¡
);

1751 
·th
 
Şd_·th
;

1752 
vfsmouÁ
 *
mÁ
 = 
NULL
;

1753 
”r
 = 
	`mouÁ_is_§ã
(
·th
);

1754 ià(
”r
)

1755  
”r
;

1756 ià(!
Şd_Çme
 || !*old_name)

1757  -
EINVAL
;

1758 
”r
 = 
	`k”n_·th
(
Şd_Çme
, 
LOOKUP_FOLLOW
|
LOOKUP_AUTOMOUNT
, &
Şd_·th
);

1759 ià(
”r
)

1760  
”r
;

1762 
”r
 = 
	`lock_mouÁ
(
·th
);

1763 ià(
”r
)

1764 
out
;

1766 
”r
 = -
EINVAL
;

1767 ià(
	`IS_MNT_UNBINDABLE
(
Şd_·th
.
mÁ
))

1768 
out2
;

1770 ià(!
	`check_mÁ
(
·th
->
mÁ
è|| !check_mÁ(
Şd_·th
.mnt))

1771 
out2
;

1773 
”r
 = -
ENOMEM
;

1774 ià(
»cur£
)

1775 
mÁ
 = 
	`cİy_Œ“
(
Şd_·th
.mÁ, old_·th.
d’Œy
, 0);

1777 
mÁ
 = 
	`şÚe_mÁ
(
Şd_·th
.mÁ, old_·th.
d’Œy
, 0);

1779 ià(!
mÁ
)

1780 
out2
;

1782 
”r
 = 
	`g¿á_Œ“
(
mÁ
, 
·th
);

1783 ià(
”r
) {

1784 
	`br_wr™e_lock
(
vfsmouÁ_lock
);

1785 
	`umouÁ_Œ“
(
mÁ
, 0, &
umouÁ_li¡
);

1786 
	`br_wr™e_uÆock
(
vfsmouÁ_lock
);

1788 
out2
:

1789 
	`uÆock_mouÁ
(
·th
);

1790 
	`»Ëa£_mouÁs
(&
umouÁ_li¡
);

1791 
out
:

1792 
	`·th_put
(&
Şd_·th
);

1793  
”r
;

1794 
	}
}

1796 
	$chªge_mouÁ_æags
(
vfsmouÁ
 *
mÁ
, 
ms_æags
)

1798 
”rÜ
 = 0;

1799 
»adÚly_»que¡
 = 0;

1801 ià(
ms_æags
 & 
MS_RDONLY
)

1802 
»adÚly_»que¡
 = 1;

1803 ià(
»adÚly_»que¡
 =ğ
	`__mÁ_is_»adÚly
(
mÁ
))

1806 ià(
»adÚly_»que¡
)

1807 
”rÜ
 = 
	`mÁ_make_»adÚly
(
mÁ
);

1809 
	`__mÁ_unmake_»adÚly
(
mÁ
);

1810  
”rÜ
;

1811 
	}
}

1818 
	$do_»mouÁ
(
·th
 *·th, 
æags
, 
mÁ_æags
,

1819 *
d©a
)

1821 
”r
;

1822 
su³r_block
 *
sb
 = 
·th
->
mÁ
->
mÁ_sb
;

1824 ià(!
	`ÿ·bË
(
CAP_SYS_ADMIN
))

1825  -
EPERM
;

1827 ià(!
	`check_mÁ
(
·th
->
mÁ
))

1828  -
EINVAL
;

1830 ià(
·th
->
d’Œy
 !ğ·th->
mÁ
->
mÁ_roÙ
)

1831  -
EINVAL
;

1833 
”r
 = 
	`£cur™y_sb_»mouÁ
(
sb
, 
d©a
);

1834 ià(
”r
)

1835  
”r
;

1837 
	`down_wr™e
(&
sb
->
s_umouÁ
);

1838 ià(
æags
 & 
MS_BIND
)

1839 
”r
 = 
	`chªge_mouÁ_æags
(
·th
->
mÁ
, 
æags
);

1841 
”r
 = 
	`do_»mouÁ_sb
(
sb
, 
æags
, 
d©a
, 0);

1842 ià(!
”r
) {

1843 
	`br_wr™e_lock
(
vfsmouÁ_lock
);

1844 
mÁ_æags
 |ğ
·th
->
mÁ
->mÁ_æag & 
MNT_PROPAGATION_MASK
;

1845 
·th
->
mÁ
->
mÁ_æags
 = mnt_flags;

1846 
	`br_wr™e_uÆock
(
vfsmouÁ_lock
);

1848 
	`up_wr™e
(&
sb
->
s_umouÁ
);

1849 ià(!
”r
) {

1850 
	`br_wr™e_lock
(
vfsmouÁ_lock
);

1851 
	`touch_mÁ_Çme¥aû
(
·th
->
mÁ
->
mÁ_ns
);

1852 
	`br_wr™e_uÆock
(
vfsmouÁ_lock
);

1854  
”r
;

1855 
	}
}

1857 
šlše
 
	$Œ“_cÚšs_unbšdabË
(
vfsmouÁ
 *
mÁ
)

1859 
vfsmouÁ
 *
p
;

1860 
p
 = 
mÁ
;…;… = 
	`Ãxt_mÁ
(p, mnt)) {

1861 ià(
	`IS_MNT_UNBINDABLE
(
p
))

1865 
	}
}

1867 
	$do_move_mouÁ
(
·th
 *·th, *
Şd_Çme
)

1869 
·th
 
Şd_·th
, 
·»Á_·th
;

1870 
vfsmouÁ
 *
p
;

1871 
”r
 = 0;

1872 ià(!
	`ÿ·bË
(
CAP_SYS_ADMIN
))

1873  -
EPERM
;

1874 ià(!
Şd_Çme
 || !*old_name)

1875  -
EINVAL
;

1876 
”r
 = 
	`k”n_·th
(
Şd_Çme
, 
LOOKUP_FOLLOW
, &
Şd_·th
);

1877 ià(
”r
)

1878  
”r
;

1880 
”r
 = 
	`lock_mouÁ
(
·th
);

1881 ià(
”r
 < 0)

1882 
out
;

1884 
”r
 = -
EINVAL
;

1885 ià(!
	`check_mÁ
(
·th
->
mÁ
è|| !check_mÁ(
Şd_·th
.mnt))

1886 
out1
;

1888 ià(
	`d_uÆšked
(
·th
->
d’Œy
))

1889 
out1
;

1891 
”r
 = -
EINVAL
;

1892 ià(
Şd_·th
.
d’Œy
 !ğŞd_·th.
mÁ
->
mÁ_roÙ
)

1893 
out1
;

1895 ià(
Şd_·th
.
mÁ
 =ğŞd_·th.mÁ->
mÁ_·»Á
)

1896 
out1
;

1898 ià(
	`S_ISDIR
(
·th
->
d’Œy
->
d_šode
->
i_mode
) !=

1899 
	`S_ISDIR
(
Şd_·th
.
d’Œy
->
d_šode
->
i_mode
))

1900 
out1
;

1904 ià(
Şd_·th
.
mÁ
->
mÁ_·»Á
 &&

1905 
	`IS_MNT_SHARED
(
Şd_·th
.
mÁ
->
mÁ_·»Á
))

1906 
out1
;

1911 ià(
	`IS_MNT_SHARED
(
·th
->
mÁ
) &&

1912 
	`Œ“_cÚšs_unbšdabË
(
Şd_·th
.
mÁ
))

1913 
out1
;

1914 
”r
 = -
ELOOP
;

1915 
p
 = 
·th
->
mÁ
;…->
mÁ_·»Á
 !=…;… =…->mnt_parent)

1916 ià(
p
 =ğ
Şd_·th
.
mÁ
)

1917 
out1
;

1919 
”r
 = 
	`©ch_»cursive_mÁ
(
Şd_·th
.
mÁ
, 
·th
, &
·»Á_·th
);

1920 ià(
”r
)

1921 
out1
;

1925 
	`li¡_d–_š™
(&
Şd_·th
.
mÁ
->
mÁ_expœe
);

1926 
out1
:

1927 
	`uÆock_mouÁ
(
·th
);

1928 
out
:

1929 ià(!
”r
)

1930 
	`·th_put
(&
·»Á_·th
);

1931 
	`·th_put
(&
Şd_·th
);

1932  
”r
;

1933 
	}
}

1935 
vfsmouÁ
 *
	$fs_£t_subty³
(
vfsmouÁ
 *
mÁ
, cÚ¡ *
f¡y³
)

1937 
”r
;

1938 cÚ¡ *
subty³
 = 
	`¡rchr
(
f¡y³
, '.');

1939 ià(
subty³
) {

1940 
subty³
++;

1941 
”r
 = -
EINVAL
;

1942 ià(!
subty³
[0])

1943 
”r
;

1945 
subty³
 = "";

1947 
mÁ
->
mÁ_sb
->
s_subty³
 = 
	`k¡rdup
(
subty³
, 
GFP_KERNEL
);

1948 
”r
 = -
ENOMEM
;

1949 ià(!
mÁ
->
mÁ_sb
->
s_subty³
)

1950 
”r
;

1951  
mÁ
;

1953 
”r
:

1954 
	`mÁput
(
mÁ
);

1955  
	`ERR_PTR
(
”r
);

1956 
	}
}

1958 
vfsmouÁ
 *

1959 
	$do_k”n_mouÁ
(cÚ¡ *
f¡y³
, 
æags
, cÚ¡ *
Çme
, *
d©a
)

1961 
fe_sy¡em_ty³
 *
ty³
 = 
	`g‘_fs_ty³
(
f¡y³
);

1962 
vfsmouÁ
 *
mÁ
;

1963 ià(!
ty³
)

1964  
	`ERR_PTR
(-
ENODEV
);

1965 
mÁ
 = 
	`vfs_k”n_mouÁ
(
ty³
, 
æags
, 
Çme
, 
d©a
);

1966 ià(!
	`IS_ERR
(
mÁ
è&& (
ty³
->
fs_æags
 & 
FS_HAS_SUBTYPE
) &&

1967 !
mÁ
->
mÁ_sb
->
s_subty³
)

1968 
mÁ
 = 
	`fs_£t_subty³
(mÁ, 
f¡y³
);

1969 
	`put_fesy¡em
(
ty³
);

1970  
mÁ
;

1971 
	}
}

1972 
EXPORT_SYMBOL_GPL
(
do_k”n_mouÁ
);

1977 
	$do_add_mouÁ
(
vfsmouÁ
 *
ÃwmÁ
, 
·th
 *·th, 
mÁ_æags
)

1979 
”r
;

1981 
mÁ_æags
 &ğ~(
MNT_SHARED
 | 
MNT_WRITE_HOLD
 | 
MNT_INTERNAL
);

1983 
”r
 = 
	`lock_mouÁ
(
·th
);

1984 ià(
”r
)

1985  
”r
;

1987 
”r
 = -
EINVAL
;

1988 ià(!(
mÁ_æags
 & 
MNT_SHRINKABLE
è&& !
	`check_mÁ
(
·th
->
mÁ
))

1989 
uÆock
;

1992 
”r
 = -
EBUSY
;

1993 ià(
·th
->
mÁ
->
mÁ_sb
 =ğ
ÃwmÁ
->mnt_sb &&

1994 
·th
->
mÁ
->
mÁ_roÙ
 =ğ·th->
d’Œy
)

1995 
uÆock
;

1997 
”r
 = -
EINVAL
;

1998 ià(
	`S_ISLNK
(
ÃwmÁ
->
mÁ_roÙ
->
d_šode
->
i_mode
))

1999 
uÆock
;

2001 
ÃwmÁ
->
mÁ_æags
 = mnt_flags;

2002 
”r
 = 
	`g¿á_Œ“
(
ÃwmÁ
, 
·th
);

2004 
uÆock
:

2005 
	`uÆock_mouÁ
(
·th
);

2006  
”r
;

2007 
	}
}

2013 
	$do_Ãw_mouÁ
(
·th
 *·th, *
ty³
, 
æags
,

2014 
mÁ_æags
, *
Çme
, *
d©a
)

2016 
vfsmouÁ
 *
mÁ
;

2017 
”r
;

2019 ià(!
ty³
)

2020  -
EINVAL
;

2023 ià(!
	`ÿ·bË
(
CAP_SYS_ADMIN
))

2024  -
EPERM
;

2026 
mÁ
 = 
	`do_k”n_mouÁ
(
ty³
, 
æags
, 
Çme
, 
d©a
);

2027 ià(
	`IS_ERR
(
mÁ
))

2028  
	`PTR_ERR
(
mÁ
);

2030 
”r
 = 
	`do_add_mouÁ
(
mÁ
, 
·th
, 
mÁ_æags
);

2031 ià(
”r
)

2032 
	`mÁput
(
mÁ
);

2033  
”r
;

2034 
	}
}

2036 
	$fšish_automouÁ
(
vfsmouÁ
 *
m
, 
·th
 *path)

2038 
”r
;

2042 
	`BUG_ON
(
	`mÁ_g‘_couÁ
(
m
) < 2);

2044 ià(
m
->
mÁ_sb
 =ğ
·th
->
mÁ
->mnt_sb &&

2045 
m
->
mÁ_roÙ
 =ğ
·th
->
d’Œy
) {

2046 
”r
 = -
ELOOP
;

2047 
ç
;

2050 
”r
 = 
	`do_add_mouÁ
(
m
, 
·th
,…©h->
mÁ
->
mÁ_æags
 | 
MNT_SHRINKABLE
);

2051 ià(!
”r
)

2053 
ç
:

2055 ià(!
	`li¡_em±y
(&
m
->
mÁ_expœe
)) {

2056 
	`down_wr™e
(&
Çme¥aû_£m
);

2057 
	`br_wr™e_lock
(
vfsmouÁ_lock
);

2058 
	`li¡_d–_š™
(&
m
->
mÁ_expœe
);

2059 
	`br_wr™e_uÆock
(
vfsmouÁ_lock
);

2060 
	`up_wr™e
(&
Çme¥aû_£m
);

2062 
	`mÁput
(
m
);

2063 
	`mÁput
(
m
);

2064  
”r
;

2065 
	}
}

2072 
	$mÁ_£t_expœy
(
vfsmouÁ
 *
mÁ
, 
li¡_h—d
 *
expœy_li¡
)

2074 
	`down_wr™e
(&
Çme¥aû_£m
);

2075 
	`br_wr™e_lock
(
vfsmouÁ_lock
);

2077 
	`li¡_add_
(&
mÁ
->
mÁ_expœe
, 
expœy_li¡
);

2079 
	`br_wr™e_uÆock
(
vfsmouÁ_lock
);

2080 
	`up_wr™e
(&
Çme¥aû_£m
);

2081 
	}
}

2082 
EXPORT_SYMBOL
(
mÁ_£t_expœy
);

2089 
	$m¬k_mouÁs_fÜ_expœy
(
li¡_h—d
 *
mouÁs
)

2091 
vfsmouÁ
 *
mÁ
, *
Ãxt
;

2092 
	`LIST_HEAD
(
g¿vey¬d
);

2093 
	`LIST_HEAD
(
umouÁs
);

2095 ià(
	`li¡_em±y
(
mouÁs
))

2098 
	`down_wr™e
(&
Çme¥aû_£m
);

2099 
	`br_wr™e_lock
(
vfsmouÁ_lock
);

2107 
	`li¡_fÜ_—ch_’Œy_§ã
(
mÁ
, 
Ãxt
, 
mouÁs
, 
mÁ_expœe
) {

2108 ià(!
	`xchg
(&
mÁ
->
mÁ_expœy_m¬k
, 1) ||

2109 
	`´İag©e_mouÁ_busy
(
mÁ
, 1))

2111 
	`li¡_move
(&
mÁ
->
mÁ_expœe
, &
g¿vey¬d
);

2113 !
	`li¡_em±y
(&
g¿vey¬d
)) {

2114 
mÁ
 = 
	`li¡_fœ¡_’Œy
(&
g¿vey¬d
, 
vfsmouÁ
, 
mÁ_expœe
);

2115 
	`touch_mÁ_Çme¥aû
(
mÁ
->
mÁ_ns
);

2116 
	`umouÁ_Œ“
(
mÁ
, 1, &
umouÁs
);

2118 
	`br_wr™e_uÆock
(
vfsmouÁ_lock
);

2119 
	`up_wr™e
(&
Çme¥aû_£m
);

2121 
	`»Ëa£_mouÁs
(&
umouÁs
);

2122 
	}
}

2124 
EXPORT_SYMBOL_GPL
(
m¬k_mouÁs_fÜ_expœy
);

2132 
	$£Ëù_submouÁs
(
vfsmouÁ
 *
·»Á
, 
li¡_h—d
 *
g¿vey¬d
)

2134 
vfsmouÁ
 *
this_·»Á
 = 
·»Á
;

2135 
li¡_h—d
 *
Ãxt
;

2136 
found
 = 0;

2138 
»³©
:

2139 
Ãxt
 = 
this_·»Á
->
mÁ_mouÁs
.next;

2140 
»sume
:

2141 
Ãxt
 !ğ&
this_·»Á
->
mÁ_mouÁs
) {

2142 
li¡_h—d
 *
tmp
 = 
Ãxt
;

2143 
vfsmouÁ
 *
mÁ
 = 
	`li¡_’Œy
(
tmp
, vfsmouÁ, 
mÁ_chd
);

2145 
Ãxt
 = 
tmp
->next;

2146 ià(!(
mÁ
->
mÁ_æags
 & 
MNT_SHRINKABLE
))

2151 ià(!
	`li¡_em±y
(&
mÁ
->
mÁ_mouÁs
)) {

2152 
this_·»Á
 = 
mÁ
;

2153 
»³©
;

2156 ià(!
	`´İag©e_mouÁ_busy
(
mÁ
, 1)) {

2157 
	`li¡_move_
(&
mÁ
->
mÁ_expœe
, 
g¿vey¬d
);

2158 
found
++;

2164 ià(
this_·»Á
 !ğ
·»Á
) {

2165 
Ãxt
 = 
this_·»Á
->
mÁ_chd
.next;

2166 
this_·»Á
 =his_·»Á->
mÁ_·»Á
;

2167 
»sume
;

2169  
found
;

2170 
	}
}

2178 
	$shršk_submouÁs
(
vfsmouÁ
 *
mÁ
, 
li¡_h—d
 *
umouÁs
)

2180 
	`LIST_HEAD
(
g¿vey¬d
);

2181 
vfsmouÁ
 *
m
;

2184 
	`£Ëù_submouÁs
(
mÁ
, &
g¿vey¬d
)) {

2185 !
	`li¡_em±y
(&
g¿vey¬d
)) {

2186 
m
 = 
	`li¡_fœ¡_’Œy
(&
g¿vey¬d
, 
vfsmouÁ
,

2187 
mÁ_expœe
);

2188 
	`touch_mÁ_Çme¥aû
(
m
->
mÁ_ns
);

2189 
	`umouÁ_Œ“
(
m
, 1, 
umouÁs
);

2192 
	}
}

2200 
	$exaù_cİy_äom_u£r
(*
to
, cÚ¡ 
__u£r
 * 
äom
,

2201 
n
)

2203 *
t
 = 
to
;

2204 cÚ¡ 
__u£r
 *
f
 = 
äom
;

2205 
c
;

2207 ià(!
	`acûss_ok
(
VERIFY_READ
, 
äom
, 
n
))

2208  
n
;

2210 
n
) {

2211 ià(
	`__g‘_u£r
(
c
, 
f
)) {

2212 
	`mem£t
(
t
, 0, 
n
);

2215 *
t
++ = 
c
;

2216 
f
++;

2217 
n
--;

2219  
n
;

2220 
	}
}

2222 
	$cİy_mouÁ_İtiÚs
(cÚ¡ 
__u£r
 * 
d©a
, *
wh”e
)

2224 
i
;

2225 
·ge
;

2226 
size
;

2228 *
wh”e
 = 0;

2229 ià(!
d©a
)

2232 ià(!(
·ge
 = 
	`__g‘_ä“_·ge
(
GFP_KERNEL
)))

2233  -
ENOMEM
;

2240 
size
 = 
TASK_SIZE
 - ()
d©a
;

2241 ià(
size
 > 
PAGE_SIZE
)

2242 
size
 = 
PAGE_SIZE
;

2244 
i
 = 
size
 - 
	`exaù_cİy_äom_u£r
((*)
·ge
, 
d©a
, size);

2245 ià(!
i
) {

2246 
	`ä“_·ge
(
·ge
);

2247  -
EFAULT
;

2249 ià(
i
 !ğ
PAGE_SIZE
)

2250 
	`mem£t
((*)
·ge
 + 
i
, 0, 
PAGE_SIZE
 - i);

2251 *
wh”e
 = 
·ge
;

2253 
	}
}

2255 
	$cİy_mouÁ_¡ršg
(cÚ¡ 
__u£r
 *
d©a
, **
wh”e
)

2257 *
tmp
;

2259 ià(!
d©a
) {

2260 *
wh”e
 = 
NULL
;

2264 
tmp
 = 
	`¡ºdup_u£r
(
d©a
, 
PAGE_SIZE
);

2265 ià(
	`IS_ERR
(
tmp
))

2266  
	`PTR_ERR
(
tmp
);

2268 *
wh”e
 = 
tmp
;

2270 
	}
}

2286 
	$do_mouÁ
(*
dev_Çme
, *
dœ_Çme
, *
ty³_·ge
,

2287 
æags
, *
d©a_·ge
)

2289 
·th
…ath;

2290 
»tv®
 = 0;

2291 
mÁ_æags
 = 0;

2294 ià((
æags
 & 
MS_MGC_MSK
è=ğ
MS_MGC_VAL
)

2295 
æags
 &ğ~
MS_MGC_MSK
;

2299 ià(!
dœ_Çme
 || !*dœ_Çm|| !
	`memchr
(dœ_Çme, 0, 
PAGE_SIZE
))

2300  -
EINVAL
;

2302 ià(
d©a_·ge
)

2303 ((*)
d©a_·ge
)[
PAGE_SIZE
 - 1] = 0;

2306 
»tv®
 = 
	`k”n_·th
(
dœ_Çme
, 
LOOKUP_FOLLOW
, &
·th
);

2307 ià(
»tv®
)

2308  
»tv®
;

2310 
»tv®
 = 
	`£cur™y_sb_mouÁ
(
dev_Çme
, &
·th
,

2311 
ty³_·ge
, 
æags
, 
d©a_·ge
);

2312 ià(
»tv®
)

2313 
dput_out
;

2316 ià(!(
æags
 & 
MS_NOATIME
))

2317 
mÁ_æags
 |ğ
MNT_RELATIME
;

2320 ià(
æags
 & 
MS_NOSUID
)

2321 
mÁ_æags
 |ğ
MNT_NOSUID
;

2322 ià(
æags
 & 
MS_NODEV
)

2323 
mÁ_æags
 |ğ
MNT_NODEV
;

2324 ià(
æags
 & 
MS_NOEXEC
)

2325 
mÁ_æags
 |ğ
MNT_NOEXEC
;

2326 ià(
æags
 & 
MS_NOATIME
)

2327 
mÁ_æags
 |ğ
MNT_NOATIME
;

2328 ià(
æags
 & 
MS_NODIRATIME
)

2329 
mÁ_æags
 |ğ
MNT_NODIRATIME
;

2330 ià(
æags
 & 
MS_STRICTATIME
)

2331 
mÁ_æags
 &ğ~(
MNT_RELATIME
 | 
MNT_NOATIME
);

2332 ià(
æags
 & 
MS_RDONLY
)

2333 
mÁ_æags
 |ğ
MNT_READONLY
;

2335 
æags
 &ğ~(
MS_NOSUID
 | 
MS_NOEXEC
 | 
MS_NODEV
 | 
MS_ACTIVE
 | 
MS_BORN
 |

2336 
MS_NOATIME
 | 
MS_NODIRATIME
 | 
MS_RELATIME
| 
MS_KERNMOUNT
 |

2337 
MS_STRICTATIME
);

2339 ià(
æags
 & 
MS_REMOUNT
)

2340 
»tv®
 = 
	`do_»mouÁ
(&
·th
, 
æags
 & ~
MS_REMOUNT
, 
mÁ_æags
,

2341 
d©a_·ge
);

2342 ià(
æags
 & 
MS_BIND
)

2343 
»tv®
 = 
	`do_loİback
(&
·th
, 
dev_Çme
, 
æags
 & 
MS_REC
);

2344 ià(
æags
 & (
MS_SHARED
 | 
MS_PRIVATE
 | 
MS_SLAVE
 | 
MS_UNBINDABLE
))

2345 
»tv®
 = 
	`do_chªge_ty³
(&
·th
, 
æags
);

2346 ià(
æags
 & 
MS_MOVE
)

2347 
»tv®
 = 
	`do_move_mouÁ
(&
·th
, 
dev_Çme
);

2349 
»tv®
 = 
	`do_Ãw_mouÁ
(&
·th
, 
ty³_·ge
, 
æags
, 
mÁ_æags
,

2350 
dev_Çme
, 
d©a_·ge
);

2351 
dput_out
:

2352 
	`·th_put
(&
·th
);

2353  
»tv®
;

2354 
	}
}

2356 
mÁ_Çme¥aû
 *
	$®loc_mÁ_ns
()

2358 
mÁ_Çme¥aû
 *
Ãw_ns
;

2360 
Ãw_ns
 = 
	`km®loc
((
mÁ_Çme¥aû
), 
GFP_KERNEL
);

2361 ià(!
Ãw_ns
)

2362  
	`ERR_PTR
(-
ENOMEM
);

2363 
	`©omic_£t
(&
Ãw_ns
->
couÁ
, 1);

2364 
Ãw_ns
->
roÙ
 = 
NULL
;

2365 
	`INIT_LIST_HEAD
(&
Ãw_ns
->
li¡
);

2366 
	`š™_wa™queue_h—d
(&
Ãw_ns
->
pŞl
);

2367 
Ãw_ns
->
ev’t
 = 0;

2368  
Ãw_ns
;

2369 
	}
}

2371 
	$mÁ_make_lÚg‹rm
(
vfsmouÁ
 *
mÁ
)

2373 
	`__mÁ_make_lÚg‹rm
(
mÁ
);

2374 
	}
}

2376 
	$mÁ_make_shÜ‰”m
(
vfsmouÁ
 *
mÁ
)

2378 #ifdeà
CONFIG_SMP


2379 ià(
	`©omic_add_uÆess
(&
mÁ
->
mÁ_lÚg‹rm
, -1, 1))

2381 
	`br_wr™e_lock
(
vfsmouÁ_lock
);

2382 
	`©omic_dec
(&
mÁ
->
mÁ_lÚg‹rm
);

2383 
	`br_wr™e_uÆock
(
vfsmouÁ_lock
);

2385 
	}
}

2391 
mÁ_Çme¥aû
 *
	$dup_mÁ_ns
(
mÁ_Çme¥aû
 *
mÁ_ns
,

2392 
fs_¡ruù
 *
fs
)

2394 
mÁ_Çme¥aû
 *
Ãw_ns
;

2395 
vfsmouÁ
 *
roÙmÁ
 = 
NULL
, *
pwdmÁ
 = NULL;

2396 
vfsmouÁ
 *
p
, *
q
;

2398 
Ãw_ns
 = 
	`®loc_mÁ_ns
();

2399 ià(
	`IS_ERR
(
Ãw_ns
))

2400  
Ãw_ns
;

2402 
	`down_wr™e
(&
Çme¥aû_£m
);

2404 
Ãw_ns
->
roÙ
 = 
	`cİy_Œ“
(
mÁ_ns
->roÙ, mÁ_ns->roÙ->
mÁ_roÙ
,

2405 
CL_COPY_ALL
 | 
CL_EXPIRE
);

2406 ià(!
Ãw_ns
->
roÙ
) {

2407 
	`up_wr™e
(&
Çme¥aû_£m
);

2408 
	`kä“
(
Ãw_ns
);

2409  
	`ERR_PTR
(-
ENOMEM
);

2411 
	`br_wr™e_lock
(
vfsmouÁ_lock
);

2412 
	`li¡_add_
(&
Ãw_ns
->
li¡
, &Ãw_ns->
roÙ
->
mÁ_li¡
);

2413 
	`br_wr™e_uÆock
(
vfsmouÁ_lock
);

2420 
p
 = 
mÁ_ns
->
roÙ
;

2421 
q
 = 
Ãw_ns
->
roÙ
;

2422 
p
) {

2423 
q
->
mÁ_ns
 = 
Ãw_ns
;

2424 
	`__mÁ_make_lÚg‹rm
(
q
);

2425 ià(
fs
) {

2426 ià(
p
 =ğ
fs
->
roÙ
.
mÁ
) {

2427 
fs
->
roÙ
.
mÁ
 = 
	`mÁg‘
(
q
);

2428 
	`__mÁ_make_lÚg‹rm
(
q
);

2429 
	`mÁ_make_shÜ‰”m
(
p
);

2430 
roÙmÁ
 = 
p
;

2432 ià(
p
 =ğ
fs
->
pwd
.
mÁ
) {

2433 
fs
->
pwd
.
mÁ
 = 
	`mÁg‘
(
q
);

2434 
	`__mÁ_make_lÚg‹rm
(
q
);

2435 
	`mÁ_make_shÜ‰”m
(
p
);

2436 
pwdmÁ
 = 
p
;

2439 
p
 = 
	`Ãxt_mÁ
Õ, 
mÁ_ns
->
roÙ
);

2440 
q
 = 
	`Ãxt_mÁ
(q, 
Ãw_ns
->
roÙ
);

2442 
	`up_wr™e
(&
Çme¥aû_£m
);

2444 ià(
roÙmÁ
)

2445 
	`mÁput
(
roÙmÁ
);

2446 ià(
pwdmÁ
)

2447 
	`mÁput
(
pwdmÁ
);

2449  
Ãw_ns
;

2450 
	}
}

2452 
mÁ_Çme¥aû
 *
	$cİy_mÁ_ns
(
æags
, 
mÁ_Çme¥aû
 *
ns
,

2453 
fs_¡ruù
 *
Ãw_fs
)

2455 
mÁ_Çme¥aû
 *
Ãw_ns
;

2457 
	`BUG_ON
(!
ns
);

2458 
	`g‘_mÁ_ns
(
ns
);

2460 ià(!(
æags
 & 
CLONE_NEWNS
))

2461  
ns
;

2463 
Ãw_ns
 = 
	`dup_mÁ_ns
(
ns
, 
Ãw_fs
);

2465 
	`put_mÁ_ns
(
ns
);

2466  
Ãw_ns
;

2467 
	}
}

2473 
mÁ_Çme¥aû
 *
	$ü—‹_mÁ_ns
(
vfsmouÁ
 *
mÁ
)

2475 
mÁ_Çme¥aû
 *
Ãw_ns
;

2477 
Ãw_ns
 = 
	`®loc_mÁ_ns
();

2478 ià(!
	`IS_ERR
(
Ãw_ns
)) {

2479 
mÁ
->
mÁ_ns
 = 
Ãw_ns
;

2480 
	`__mÁ_make_lÚg‹rm
(
mÁ
);

2481 
Ãw_ns
->
roÙ
 = 
mÁ
;

2482 
	`li¡_add
(&
Ãw_ns
->
li¡
, &Ãw_ns->
roÙ
->
mÁ_li¡
);

2484 
	`mÁput
(
mÁ
);

2486  
Ãw_ns
;

2487 
	}
}

2488 
EXPORT_SYMBOL
(
ü—‹_mÁ_ns
);

2490 
d’Œy
 *
	$mouÁ_subŒ“
(
vfsmouÁ
 *
mÁ
, cÚ¡ *
Çme
)

2492 
mÁ_Çme¥aû
 *
ns
;

2493 
su³r_block
 *
s
;

2494 
·th
…ath;

2495 
”r
;

2497 
ns
 = 
	`ü—‹_mÁ_ns
(
mÁ
);

2498 ià(
	`IS_ERR
(
ns
))

2499  
	`ERR_CAST
(
ns
);

2501 
”r
 = 
	`vfs_·th_lookup
(
mÁ
->
mÁ_roÙ
, mnt,

2502 
Çme
, 
LOOKUP_FOLLOW
|
LOOKUP_AUTOMOUNT
, &
·th
);

2504 
	`put_mÁ_ns
(
ns
);

2506 ià(
”r
)

2507  
	`ERR_PTR
(
”r
);

2510 
s
 = 
·th
.
mÁ
->
mÁ_sb
;

2511 
	`©omic_šc
(&
s
->
s_aùive
);

2512 
	`mÁput
(
·th
.
mÁ
);

2514 
	`down_wr™e
(&
s
->
s_umouÁ
);

2516  
·th
.
d’Œy
;

2517 
	}
}

2518 
EXPORT_SYMBOL
(
mouÁ_subŒ“
);

2520 
	$SYSCALL_DEFINE5
(
mouÁ
, 
__u£r
 *, 
dev_Çme
, __u£¸*, 
dœ_Çme
,

2521 
__u£r
 *, 
ty³
, , 
æags
, __u£¸*, 
d©a
)

2523 
»t
;

2524 *
k”Ãl_ty³
;

2525 *
k”Ãl_dœ
;

2526 *
k”Ãl_dev
;

2527 
d©a_·ge
;

2529 
»t
 = 
	`cİy_mouÁ_¡ršg
(
ty³
, &
k”Ãl_ty³
);

2530 ià(
»t
 < 0)

2531 
out_ty³
;

2533 
k”Ãl_dœ
 = 
	`g‘Çme
(
dœ_Çme
);

2534 ià(
	`IS_ERR
(
k”Ãl_dœ
)) {

2535 
»t
 = 
	`PTR_ERR
(
k”Ãl_dœ
);

2536 
out_dœ
;

2539 
»t
 = 
	`cİy_mouÁ_¡ršg
(
dev_Çme
, &
k”Ãl_dev
);

2540 ià(
»t
 < 0)

2541 
out_dev
;

2543 
»t
 = 
	`cİy_mouÁ_İtiÚs
(
d©a
, &
d©a_·ge
);

2544 ià(
»t
 < 0)

2545 
out_d©a
;

2547 
»t
 = 
	`do_mouÁ
(
k”Ãl_dev
, 
k”Ãl_dœ
, 
k”Ãl_ty³
, 
æags
,

2548 (*è
d©a_·ge
);

2550 
	`ä“_·ge
(
d©a_·ge
);

2551 
out_d©a
:

2552 
	`kä“
(
k”Ãl_dev
);

2553 
out_dev
:

2554 
	`puŠame
(
k”Ãl_dœ
);

2555 
out_dœ
:

2556 
	`kä“
(
k”Ãl_ty³
);

2557 
out_ty³
:

2558  
»t
;

2559 
	}
}

2586 
	$SYSCALL_DEFINE2
(
pivÙ_roÙ
, cÚ¡ 
__u£r
 *, 
Ãw_roÙ
,

2587 cÚ¡ 
__u£r
 *, 
put_Şd
)

2589 
vfsmouÁ
 *
tmp
;

2590 
·th
 
Ãw
, 
Şd
, 
·»Á_·th
, 
roÙ_·»Á
, 
roÙ
;

2591 
”rÜ
;

2593 ià(!
	`ÿ·bË
(
CAP_SYS_ADMIN
))

2594  -
EPERM
;

2596 
”rÜ
 = 
	`u£r_·th_dœ
(
Ãw_roÙ
, &
Ãw
);

2597 ià(
”rÜ
)

2598 
out0
;

2600 
”rÜ
 = 
	`u£r_·th_dœ
(
put_Şd
, &
Şd
);

2601 ià(
”rÜ
)

2602 
out1
;

2604 
”rÜ
 = 
	`£cur™y_sb_pivÙroÙ
(&
Şd
, &
Ãw
);

2605 ià(
”rÜ
)

2606 
out2
;

2608 
	`g‘_fs_roÙ
(
cu¼’t
->
fs
, &
roÙ
);

2609 
”rÜ
 = 
	`lock_mouÁ
(&
Şd
);

2610 ià(
”rÜ
)

2611 
out3
;

2613 
”rÜ
 = -
EINVAL
;

2614 ià(
	`IS_MNT_SHARED
(
Şd
.
mÁ
) ||

2615 
	`IS_MNT_SHARED
(
Ãw
.
mÁ
->
mÁ_·»Á
) ||

2616 
	`IS_MNT_SHARED
(
roÙ
.
mÁ
->
mÁ_·»Á
))

2617 
out4
;

2618 ià(!
	`check_mÁ
(
roÙ
.
mÁ
è|| !check_mÁ(
Ãw
.mnt))

2619 
out4
;

2620 
”rÜ
 = -
ENOENT
;

2621 ià(
	`d_uÆšked
(
Ãw
.
d’Œy
))

2622 
out4
;

2623 ià(
	`d_uÆšked
(
Şd
.
d’Œy
))

2624 
out4
;

2625 
”rÜ
 = -
EBUSY
;

2626 ià(
Ãw
.
mÁ
 =ğ
roÙ
.mnt ||

2627 
Şd
.
mÁ
 =ğ
roÙ
.mnt)

2628 
out4
;

2629 
”rÜ
 = -
EINVAL
;

2630 ià(
roÙ
.
mÁ
->
mÁ_roÙ
 !ğroÙ.
d’Œy
)

2631 
out4
;

2632 ià(
roÙ
.
mÁ
->
mÁ_·»Á
 ==„oot.mnt)

2633 
out4
;

2634 ià(
Ãw
.
mÁ
->
mÁ_roÙ
 !ğÃw.
d’Œy
)

2635 
out4
;

2636 ià(
Ãw
.
mÁ
->
mÁ_·»Á
 ==‚ew.mnt)

2637 
out4
;

2639 
tmp
 = 
Şd
.
mÁ
;

2640 ià(
tmp
 !ğ
Ãw
.
mÁ
) {

2642 ià(
tmp
->
mÁ_·»Á
 ==mp)

2643 
out4
;

2644 ià(
tmp
->
mÁ_·»Á
 =ğ
Ãw
.
mÁ
)

2646 
tmp
 =mp->
mÁ_·»Á
;

2648 ià(!
	`is_subdœ
(
tmp
->
mÁ_mouÁpošt
, 
Ãw
.
d’Œy
))

2649 
out4
;

2650 } ià(!
	`is_subdœ
(
Şd
.
d’Œy
, 
Ãw
.dentry))

2651 
out4
;

2652 
	`br_wr™e_lock
(
vfsmouÁ_lock
);

2653 
	`d‘ach_mÁ
(
Ãw
.
mÁ
, &
·»Á_·th
);

2654 
	`d‘ach_mÁ
(
roÙ
.
mÁ
, &
roÙ_·»Á
);

2656 
	`©ch_mÁ
(
roÙ
.
mÁ
, &
Şd
);

2658 
	`©ch_mÁ
(
Ãw
.
mÁ
, &
roÙ_·»Á
);

2659 
	`touch_mÁ_Çme¥aû
(
cu¼’t
->
n¥roxy
->
mÁ_ns
);

2660 
	`br_wr™e_uÆock
(
vfsmouÁ_lock
);

2661 
	`chroÙ_fs_»fs
(&
roÙ
, &
Ãw
);

2662 
”rÜ
 = 0;

2663 
out4
:

2664 
	`uÆock_mouÁ
(&
Şd
);

2665 ià(!
”rÜ
) {

2666 
	`·th_put
(&
roÙ_·»Á
);

2667 
	`·th_put
(&
·»Á_·th
);

2669 
out3
:

2670 
	`·th_put
(&
roÙ
);

2671 
out2
:

2672 
	`·th_put
(&
Şd
);

2673 
out1
:

2674 
	`·th_put
(&
Ãw
);

2675 
out0
:

2676  
”rÜ
;

2677 
	}
}

2679 
__š™
 
	$š™_mouÁ_Œ“
()

2681 
vfsmouÁ
 *
mÁ
;

2682 
mÁ_Çme¥aû
 *
ns
;

2683 
·th
 
roÙ
;

2685 
mÁ
 = 
	`do_k”n_mouÁ
("roÙfs", 0, "roÙfs", 
NULL
);

2686 ià(
	`IS_ERR
(
mÁ
))

2687 
	`·nic
("Can't create„ootfs");

2689 
ns
 = 
	`ü—‹_mÁ_ns
(
mÁ
);

2690 ià(
	`IS_ERR
(
ns
))

2691 
	`·nic
("Can't‡llocate initial‚amespace");

2693 
š™_sk
.
n¥roxy
->
mÁ_ns
 = 
ns
;

2694 
	`g‘_mÁ_ns
(
ns
);

2696 
roÙ
.
mÁ
 = 
ns
->root;

2697 
roÙ
.
d’Œy
 = 
ns
->roÙ->
mÁ_roÙ
;

2699 
	`£t_fs_pwd
(
cu¼’t
->
fs
, &
roÙ
);

2700 
	`£t_fs_roÙ
(
cu¼’t
->
fs
, &
roÙ
);

2701 
	}
}

2703 
__š™
 
	$mÁ_š™
()

2705 
u
;

2706 
”r
;

2708 
	`š™_rw£m
(&
Çme¥aû_£m
);

2710 
mÁ_ÿche
 = 
	`kmem_ÿche_ü—‹
("mÁ_ÿche", (
vfsmouÁ
),

2711 0, 
SLAB_HWCACHE_ALIGN
 | 
SLAB_PANIC
, 
NULL
);

2713 
mouÁ_hashbË
 = (
li¡_h—d
 *)
	`__g‘_ä“_·ge
(
GFP_ATOMIC
);

2715 ià(!
mouÁ_hashbË
)

2716 
	`·nic
("Failedo‡llocate mount hashable\n");

2718 
	`´štk
(
KERN_INFO
 "MouÁ-ÿchhashabËƒÁr›s: %lu\n", 
HASH_SIZE
);

2720 
u
 = 0; u < 
HASH_SIZE
; u++)

2721 
	`INIT_LIST_HEAD
(&
mouÁ_hashbË
[
u
]);

2723 
	`br_lock_š™
(
vfsmouÁ_lock
);

2725 
”r
 = 
	`sysfs_š™
();

2726 ià(
”r
)

2727 
	`´štk
(
KERN_WARNING
 "%s: sysfs_initƒrror: %d\n",

2728 
__func__
, 
”r
);

2729 
fs_kobj
 = 
	`kobjeù_ü—‹_ªd_add
("fs", 
NULL
);

2730 ià(!
fs_kobj
)

2731 
	`´štk
(
KERN_WARNING
 "%s: kobj c»©”rÜ\n", 
__func__
);

2732 
	`š™_roÙfs
();

2733 
	`š™_mouÁ_Œ“
();

2734 
	}
}

2736 
	$put_mÁ_ns
(
mÁ_Çme¥aû
 *
ns
)

2738 
	`LIST_HEAD
(
umouÁ_li¡
);

2740 ià(!
	`©omic_dec_ªd_‹¡
(&
ns
->
couÁ
))

2742 
	`down_wr™e
(&
Çme¥aû_£m
);

2743 
	`br_wr™e_lock
(
vfsmouÁ_lock
);

2744 
	`umouÁ_Œ“
(
ns
->
roÙ
, 0, &
umouÁ_li¡
);

2745 
	`br_wr™e_uÆock
(
vfsmouÁ_lock
);

2746 
	`up_wr™e
(&
Çme¥aû_£m
);

2747 
	`»Ëa£_mouÁs
(&
umouÁ_li¡
);

2748 
	`kä“
(
ns
);

2749 
	}
}

2750 
EXPORT_SYMBOL
(
put_mÁ_ns
);

2752 
vfsmouÁ
 *
	$k”n_mouÁ_d©a
(
fe_sy¡em_ty³
 *
ty³
, *
d©a
)

2754 
vfsmouÁ
 *
mÁ
;

2755 
mÁ
 = 
	`vfs_k”n_mouÁ
(
ty³
, 
MS_KERNMOUNT
,y³->
Çme
, 
d©a
);

2756 ià(!
	`IS_ERR
(
mÁ
)) {

2761 
	`mÁ_make_lÚg‹rm
(
mÁ
);

2763  
mÁ
;

2764 
	}
}

2765 
EXPORT_SYMBOL_GPL
(
k”n_mouÁ_d©a
);

2767 
	$k”n_unmouÁ
(
vfsmouÁ
 *
mÁ
)

2770 ià(!
	`IS_ERR_OR_NULL
(
mÁ
)) {

2771 
	`mÁ_make_shÜ‰”m
(
mÁ
);

2772 
	`mÁput
(
mÁ
);

2774 
	}
}

2775 
EXPORT_SYMBOL
(
k”n_unmouÁ
);

2777 
boŞ
 
	$our_mÁ
(
vfsmouÁ
 *
mÁ
)

2779  
	`check_mÁ
(
mÁ
);

2780 
	}
}

	@no-block.c

12 
	~<lšux/k”Ãl.h
>

13 
	~<lšux/fs.h
>

15 
	$no_blkdev_İ’
(
šode
 * inode, 
fe
 * 
fp
)

17  -
ENODEV
;

18 
	}
}

20 cÚ¡ 
fe_İ”©iÚs
 
	gdef_blk_fİs
 = {

21 .
İ’
 = 
no_blkdev_İ’
,

22 .
	gÎ£ek
 = 
noİ_Î£ek
,

	@open.c

7 
	~<lšux/¡ršg.h
>

8 
	~<lšux/mm.h
>

9 
	~<lšux/fe.h
>

10 
	~<lšux/fdbË.h
>

11 
	~<lšux/f¢Ùify.h
>

12 
	~<lšux/moduË.h
>

13 
	~<lšux/‰y.h
>

14 
	~<lšux/Çmei.h
>

15 
	~<lšux/backšg-dev.h
>

16 
	~<lšux/ÿ·b™y.h
>

17 
	~<lšux/£cu»b™s.h
>

18 
	~<lšux/£cur™y.h
>

19 
	~<lšux/mouÁ.h
>

20 
	~<lšux/fú.h
>

21 
	~<lšux/¦ab.h
>

22 
	~<asm/uacûss.h
>

23 
	~<lšux/fs.h
>

24 
	~<lšux/³rsÚ®™y.h
>

25 
	~<lšux/·gem­.h
>

26 
	~<lšux/sysÿÎs.h
>

27 
	~<lšux/rcupd©e.h
>

28 
	~<lšux/aud™.h
>

29 
	~<lšux/çÎoc.h
>

30 
	~<lšux/fs_¡ruù.h
>

31 
	~<lšux/ima.h
>

32 
	~<lšux/dnÙify.h
>

34 
	~"š‹º®.h
"

36 
	$do_Œunÿ‹
(
d’Œy
 *d’Œy, 
loff_t
 
Ëngth
, 
time_©Œs
,

37 
fe
 *
fp
)

39 
»t
;

40 
Ÿ‰r
 
Ãw©Œs
;

43 ià(
Ëngth
 < 0)

44  -
EINVAL
;

46 
Ãw©Œs
.
Ÿ_size
 = 
Ëngth
;

47 
Ãw©Œs
.
Ÿ_v®id
 = 
ATTR_SIZE
 | 
time_©Œs
;

48 ià(
fp
) {

49 
Ãw©Œs
.
Ÿ_fe
 = 
fp
;

50 
Ãw©Œs
.
Ÿ_v®id
 |ğ
ATTR_FILE
;

54 
»t
 = 
	`should_»move_suid
(
d’Œy
);

55 ià(
»t
)

56 
Ãw©Œs
.
Ÿ_v®id
 |ğ
»t
 | 
ATTR_FORCE
;

58 
	`mu‹x_lock
(&
d’Œy
->
d_šode
->
i_mu‹x
);

59 
»t
 = 
	`nÙify_chªge
(
d’Œy
, &
Ãw©Œs
);

60 
	`mu‹x_uÆock
(&
d’Œy
->
d_šode
->
i_mu‹x
);

61  
»t
;

62 
	}
}

64 
	$do_sys_Œunÿ‹
(cÚ¡ 
__u£r
 *
·thÇme
, 
loff_t
 
Ëngth
)

66 
·th
…ath;

67 
šode
 *inode;

68 
”rÜ
;

70 
”rÜ
 = -
EINVAL
;

71 ià(
Ëngth
 < 0)

72 
out
;

74 
”rÜ
 = 
	`u£r_·th
(
·thÇme
, &
·th
);

75 ià(
”rÜ
)

76 
out
;

77 
šode
 = 
·th
.
d’Œy
->
d_šode
;

80 
”rÜ
 = -
EISDIR
;

81 ià(
	`S_ISDIR
(
šode
->
i_mode
))

82 
dput_ªd_out
;

84 
”rÜ
 = -
EINVAL
;

85 ià(!
	`S_ISREG
(
šode
->
i_mode
))

86 
dput_ªd_out
;

88 
”rÜ
 = 
	`mÁ_wªt_wr™e
(
·th
.
mÁ
);

89 ià(
”rÜ
)

90 
dput_ªd_out
;

92 
”rÜ
 = 
	`šode_³rmissiÚ
(
šode
, 
MAY_WRITE
);

93 ià(
”rÜ
)

94 
mÁ_drİ_wr™e_ªd_out
;

96 
”rÜ
 = -
EPERM
;

97 ià(
	`IS_APPEND
(
šode
))

98 
mÁ_drİ_wr™e_ªd_out
;

100 
”rÜ
 = 
	`g‘_wr™e_acûss
(
šode
);

101 ià(
”rÜ
)

102 
mÁ_drİ_wr™e_ªd_out
;

108 
”rÜ
 = 
	`b»ak_Ëa£
(
šode
, 
O_WRONLY
);

109 ià(
”rÜ
)

110 
put_wr™e_ªd_out
;

112 
”rÜ
 = 
	`locks_v”ify_Œunÿ‹
(
šode
, 
NULL
, 
Ëngth
);

113 ià(!
”rÜ
)

114 
”rÜ
 = 
	`£cur™y_·th_Œunÿ‹
(&
·th
);

115 ià(!
”rÜ
)

116 
”rÜ
 = 
	`do_Œunÿ‹
(
·th
.
d’Œy
, 
Ëngth
, 0, 
NULL
);

118 
put_wr™e_ªd_out
:

119 
	`put_wr™e_acûss
(
šode
);

120 
mÁ_drİ_wr™e_ªd_out
:

121 
	`mÁ_drİ_wr™e
(
·th
.
mÁ
);

122 
dput_ªd_out
:

123 
	`·th_put
(&
·th
);

124 
out
:

125  
”rÜ
;

126 
	}
}

128 
	$SYSCALL_DEFINE2
(
Œunÿ‹
, cÚ¡ 
__u£r
 *, 
·th
, , 
Ëngth
)

130  
	`do_sys_Œunÿ‹
(
·th
, 
Ëngth
);

131 
	}
}

133 
	$do_sys_árunÿ‹
(
fd
, 
loff_t
 
Ëngth
, 
sm®l
)

135 
šode
 * inode;

136 
d’Œy
 *dentry;

137 
fe
 * file;

138 
”rÜ
;

140 
”rÜ
 = -
EINVAL
;

141 ià(
Ëngth
 < 0)

142 
out
;

143 
”rÜ
 = -
EBADF
;

144 
fe
 = 
	`fg‘
(
fd
);

145 ià(!
fe
)

146 
out
;

149 ià(
fe
->
f_æags
 & 
O_LARGEFILE
)

150 
sm®l
 = 0;

152 
d’Œy
 = 
fe
->
f_·th
.dentry;

153 
šode
 = 
d’Œy
->
d_šode
;

154 
”rÜ
 = -
EINVAL
;

155 ià(!
	`S_ISREG
(
šode
->
i_mode
è|| !(
fe
->
f_mode
 & 
FMODE_WRITE
))

156 
out_putf
;

158 
”rÜ
 = -
EINVAL
;

160 ià(
sm®l
 && 
Ëngth
 > 
MAX_NON_LFS
)

161 
out_putf
;

163 
”rÜ
 = -
EPERM
;

164 ià(
	`IS_APPEND
(
šode
))

165 
out_putf
;

167 
”rÜ
 = 
	`locks_v”ify_Œunÿ‹
(
šode
, 
fe
, 
Ëngth
);

168 ià(!
”rÜ
)

169 
”rÜ
 = 
	`£cur™y_·th_Œunÿ‹
(&
fe
->
f_·th
);

170 ià(!
”rÜ
)

171 
”rÜ
 = 
	`do_Œunÿ‹
(
d’Œy
, 
Ëngth
, 
ATTR_MTIME
|
ATTR_CTIME
, 
fe
);

172 
out_putf
:

173 
	`åut
(
fe
);

174 
out
:

175  
”rÜ
;

176 
	}
}

178 
	$SYSCALL_DEFINE2
(
árunÿ‹
, , 
fd
, , 
Ëngth
)

180 
»t
 = 
	`do_sys_árunÿ‹
(
fd
, 
Ëngth
, 1);

182 
	`asmlškage_´Ùeù
(2, 
»t
, 
fd
, 
Ëngth
);

183  
»t
;

184 
	}
}

187 #ià
BITS_PER_LONG
 == 32

188 
	$SYSCALL_DEFINE
(
Œunÿ‹64
)(cÚ¡ 
__u£r
 * 
·th
, 
loff_t
 
Ëngth
)

190  
	`do_sys_Œunÿ‹
(
·th
, 
Ëngth
);

191 
	}
}

192 #ifdeà
CONFIG_HAVE_SYSCALL_WRAPPERS


193 
asmlškage
 
	$SyS_Œunÿ‹64
(
·th
, 
loff_t
 
Ëngth
)

195  
	`SYSC_Œunÿ‹64
((cÚ¡ 
__u£r
 *è
·th
, 
Ëngth
);

196 
	}
}

197 
SYSCALL_ALIAS
(
sys_Œunÿ‹64
, 
SyS_Œunÿ‹64
);

200 
	$SYSCALL_DEFINE
(
árunÿ‹64
)(
fd
, 
loff_t
 
Ëngth
)

202 
»t
 = 
	`do_sys_árunÿ‹
(
fd
, 
Ëngth
, 0);

204 
	`asmlškage_´Ùeù
(2, 
»t
, 
fd
, 
Ëngth
);

205  
»t
;

206 
	}
}

207 #ifdeà
CONFIG_HAVE_SYSCALL_WRAPPERS


208 
asmlškage
 
	$SyS_árunÿ‹64
(
fd
, 
loff_t
 
Ëngth
)

210  
	`SYSC_árunÿ‹64
((è
fd
, 
Ëngth
);

211 
	}
}

212 
SYSCALL_ALIAS
(
sys_árunÿ‹64
, 
SyS_árunÿ‹64
);

217 
	$do_çÎoÿ‹
(
fe
 *fe, 
mode
, 
loff_t
 
off£t
,†off_ˆ
Ën
)

219 
šode
 *šodğ
fe
->
f_·th
.
d’Œy
->
d_šode
;

220 
»t
;

222 ià(
off£t
 < 0 || 
Ën
 <= 0)

223  -
EINVAL
;

226 ià(
mode
 & ~(
FALLOC_FL_KEEP_SIZE
 | 
FALLOC_FL_PUNCH_HOLE
))

227  -
EOPNOTSUPP
;

230 ià((
mode
 & 
FALLOC_FL_PUNCH_HOLE
) &&

231 !(
mode
 & 
FALLOC_FL_KEEP_SIZE
))

232  -
EOPNOTSUPP
;

234 ià(!(
fe
->
f_mode
 & 
FMODE_WRITE
))

235  -
EBADF
;

238 ià(
mode
 & 
FALLOC_FL_PUNCH_HOLE
 && 
	`IS_APPEND
(
šode
))

239  -
EPERM
;

241 ià(
	`IS_IMMUTABLE
(
šode
))

242  -
EPERM
;

248 
»t
 = 
	`£cur™y_fe_³rmissiÚ
(
fe
, 
MAY_WRITE
);

249 ià(
»t
)

250  
»t
;

252 ià(
	`S_ISFIFO
(
šode
->
i_mode
))

253  -
ESPIPE
;

259 ià(!
	`S_ISREG
(
šode
->
i_mode
è&& !
	`S_ISDIR
(inode->i_mode))

260  -
ENODEV
;

263 ià(((
off£t
 + 
Ën
è> 
šode
->
i_sb
->
s_maxby‹s
) || ((offset +†en) < 0))

264  -
EFBIG
;

266 ià(!
fe
->
f_İ
->
çÎoÿ‹
)

267  -
EOPNOTSUPP
;

269  
fe
->
f_İ
->
	`çÎoÿ‹
(fe, 
mode
, 
off£t
, 
Ën
);

270 
	}
}

272 
	$SYSCALL_DEFINE
(
çÎoÿ‹
)(
fd
, 
mode
, 
loff_t
 
off£t
,†off_ˆ
Ën
)

274 
fe
 *file;

275 
”rÜ
 = -
EBADF
;

277 
fe
 = 
	`fg‘
(
fd
);

278 ià(
fe
) {

279 
”rÜ
 = 
	`do_çÎoÿ‹
(
fe
, 
mode
, 
off£t
, 
Ën
);

280 
	`åut
(
fe
);

283  
”rÜ
;

284 
	}
}

286 #ifdeà
CONFIG_HAVE_SYSCALL_WRAPPERS


287 
asmlškage
 
	$SyS_çÎoÿ‹
(
fd
, 
mode
, 
loff_t
 
off£t
,†off_ˆ
Ën
)

289  
	`SYSC_çÎoÿ‹
(()
fd
, ()
mode
, 
off£t
, 
Ën
);

290 
	}
}

291 
SYSCALL_ALIAS
(
sys_çÎoÿ‹
, 
SyS_çÎoÿ‹
);

299 
	$SYSCALL_DEFINE3
(
çcûs§t
, , 
dfd
, cÚ¡ 
__u£r
 *, 
f’ame
, , 
mode
)

301 cÚ¡ 
üed
 *
Şd_üed
;

302 
üed
 *
ov”ride_üed
;

303 
·th
…ath;

304 
šode
 *inode;

305 
»s
;

307 ià(
mode
 & ~
S_IRWXO
)

308  -
EINVAL
;

310 
ov”ride_üed
 = 
	`´•¬e_üeds
();

311 ià(!
ov”ride_üed
)

312  -
ENOMEM
;

314 
ov”ride_üed
->
fsuid
 = ov”ride_üed->
uid
;

315 
ov”ride_üed
->
fsgid
 = ov”ride_üed->
gid
;

317 ià(!
	`is£cu»
(
SECURE_NO_SETUID_FIXUP
)) {

319 ià(
ov”ride_üed
->
uid
)

320 
	`ÿp_ş—r
(
ov”ride_üed
->
ÿp_efãùive
);

322 
ov”ride_üed
->
ÿp_efãùive
 =

323 
ov”ride_üed
->
ÿp_³rm™‹d
;

326 
Şd_üed
 = 
	`ov”ride_üeds
(
ov”ride_üed
);

328 
»s
 = 
	`u£r_·th_©
(
dfd
, 
f’ame
, 
LOOKUP_FOLLOW
, &
·th
);

329 ià(
»s
)

330 
out
;

332 
šode
 = 
·th
.
d’Œy
->
d_šode
;

334 ià((
mode
 & 
MAY_EXEC
è&& 
	`S_ISREG
(
šode
->
i_mode
)) {

339 
»s
 = -
EACCES
;

340 ià(
·th
.
mÁ
->
mÁ_æags
 & 
MNT_NOEXEC
)

341 
out_·th_»Ëa£
;

344 
»s
 = 
	`šode_³rmissiÚ
(
šode
, 
mode
 | 
MAY_ACCESS
);

346 ià(
»s
 || !(
mode
 & 
S_IWOTH
è|| 
	`¥ecŸl_fe
(
šode
->
i_mode
))

347 
out_·th_»Ëa£
;

358 ià(
	`__mÁ_is_»adÚly
(
·th
.
mÁ
))

359 
»s
 = -
EROFS
;

361 
out_·th_»Ëa£
:

362 
	`·th_put
(&
·th
);

363 
out
:

364 
	`»v”t_üeds
(
Şd_üed
);

365 
	`put_üed
(
ov”ride_üed
);

366  
»s
;

367 
	}
}

369 
	$SYSCALL_DEFINE2
(
acûss
, cÚ¡ 
__u£r
 *, 
f’ame
, , 
mode
)

371  
	`sys_çcûs§t
(
AT_FDCWD
, 
f’ame
, 
mode
);

372 
	}
}

374 
	$SYSCALL_DEFINE1
(
chdœ
, cÚ¡ 
__u£r
 *, 
f’ame
)

376 
·th
…ath;

377 
”rÜ
;

379 
”rÜ
 = 
	`u£r_·th_dœ
(
f’ame
, &
·th
);

380 ià(
”rÜ
)

381 
out
;

383 
”rÜ
 = 
	`šode_³rmissiÚ
(
·th
.
d’Œy
->
d_šode
, 
MAY_EXEC
 | 
MAY_CHDIR
);

384 ià(
”rÜ
)

385 
dput_ªd_out
;

387 
	`£t_fs_pwd
(
cu¼’t
->
fs
, &
·th
);

389 
dput_ªd_out
:

390 
	`·th_put
(&
·th
);

391 
out
:

392  
”rÜ
;

393 
	}
}

395 
	$SYSCALL_DEFINE1
(
fchdœ
, , 
fd
)

397 
fe
 *file;

398 
šode
 *inode;

399 
”rÜ
;

401 
”rÜ
 = -
EBADF
;

402 
fe
 = 
	`fg‘
(
fd
);

403 ià(!
fe
)

404 
out
;

406 
šode
 = 
fe
->
f_·th
.
d’Œy
->
d_šode
;

408 
”rÜ
 = -
ENOTDIR
;

409 ià(!
	`S_ISDIR
(
šode
->
i_mode
))

410 
out_putf
;

412 
”rÜ
 = 
	`šode_³rmissiÚ
(
šode
, 
MAY_EXEC
 | 
MAY_CHDIR
);

413 ià(!
”rÜ
)

414 
	`£t_fs_pwd
(
cu¼’t
->
fs
, &
fe
->
f_·th
);

415 
out_putf
:

416 
	`åut
(
fe
);

417 
out
:

418  
”rÜ
;

419 
	}
}

421 
	$SYSCALL_DEFINE1
(
chroÙ
, cÚ¡ 
__u£r
 *, 
f’ame
)

423 
·th
…ath;

424 
”rÜ
;

426 
”rÜ
 = 
	`u£r_·th_dœ
(
f’ame
, &
·th
);

427 ià(
”rÜ
)

428 
out
;

430 
”rÜ
 = 
	`šode_³rmissiÚ
(
·th
.
d’Œy
->
d_šode
, 
MAY_EXEC
 | 
MAY_CHDIR
);

431 ià(
”rÜ
)

432 
dput_ªd_out
;

434 
”rÜ
 = -
EPERM
;

435 ià(!
	`ÿ·bË
(
CAP_SYS_CHROOT
))

436 
dput_ªd_out
;

437 
”rÜ
 = 
	`£cur™y_·th_chroÙ
(&
·th
);

438 ià(
”rÜ
)

439 
dput_ªd_out
;

441 
	`£t_fs_roÙ
(
cu¼’t
->
fs
, &
·th
);

442 
”rÜ
 = 0;

443 
dput_ªd_out
:

444 
	`·th_put
(&
·th
);

445 
out
:

446  
”rÜ
;

447 
	}
}

449 
	$chmod_commÚ
(
·th
 *·th, 
umode_t
 
mode
)

451 
šode
 *šodğ
·th
->
d’Œy
->
d_šode
;

452 
Ÿ‰r
 
Ãw©Œs
;

453 
”rÜ
;

455 
”rÜ
 = 
	`mÁ_wªt_wr™e
(
·th
->
mÁ
);

456 ià(
”rÜ
)

457  
”rÜ
;

458 
	`mu‹x_lock
(&
šode
->
i_mu‹x
);

459 
”rÜ
 = 
	`£cur™y_·th_chmod
(
·th
->
d’Œy
,…©h->
mÁ
, 
mode
);

460 ià(
”rÜ
)

461 
out_uÆock
;

462 
Ãw©Œs
.
Ÿ_mode
 = (
mode
 & 
S_IALLUGO
è| (
šode
->
i_mode
 & ~S_IALLUGO);

463 
Ãw©Œs
.
Ÿ_v®id
 = 
ATTR_MODE
 | 
ATTR_CTIME
;

464 
”rÜ
 = 
	`nÙify_chªge
(
·th
->
d’Œy
, &
Ãw©Œs
);

465 
out_uÆock
:

466 
	`mu‹x_uÆock
(&
šode
->
i_mu‹x
);

467 
	`mÁ_drİ_wr™e
(
·th
->
mÁ
);

468  
”rÜ
;

469 
	}
}

471 
	$SYSCALL_DEFINE2
(
fchmod
, , 
fd
, 
mode_t
, 
mode
)

473 
fe
 * file;

474 
”r
 = -
EBADF
;

476 
fe
 = 
	`fg‘
(
fd
);

477 ià(
fe
) {

478 
	`aud™_šode
(
NULL
, 
fe
->
f_·th
.
d’Œy
);

479 
”r
 = 
	`chmod_commÚ
(&
fe
->
f_·th
, 
mode
);

480 
	`åut
(
fe
);

482  
”r
;

483 
	}
}

485 
	$SYSCALL_DEFINE3
(
fchmod©
, , 
dfd
, cÚ¡ 
__u£r
 *, 
f’ame
, 
mode_t
, 
mode
)

487 
·th
…ath;

488 
”rÜ
;

490 
”rÜ
 = 
	`u£r_·th_©
(
dfd
, 
f’ame
, 
LOOKUP_FOLLOW
, &
·th
);

491 ià(!
”rÜ
) {

492 
”rÜ
 = 
	`chmod_commÚ
(&
·th
, 
mode
);

493 
	`·th_put
(&
·th
);

495  
”rÜ
;

496 
	}
}

498 
	$SYSCALL_DEFINE2
(
chmod
, cÚ¡ 
__u£r
 *, 
f’ame
, 
mode_t
, 
mode
)

500  
	`sys_fchmod©
(
AT_FDCWD
, 
f’ame
, 
mode
);

501 
	}
}

503 
	$chown_commÚ
(
·th
 *·th, 
uid_t
 
u£r
, 
gid_t
 
group
)

505 
šode
 *šodğ
·th
->
d’Œy
->
d_šode
;

506 
”rÜ
;

507 
Ÿ‰r
 
Ãw©Œs
;

509 
Ãw©Œs
.
Ÿ_v®id
 = 
ATTR_CTIME
;

510 ià(
u£r
 !ğ(
uid_t
) -1) {

511 
Ãw©Œs
.
Ÿ_v®id
 |ğ
ATTR_UID
;

512 
Ãw©Œs
.
Ÿ_uid
 = 
u£r
;

514 ià(
group
 !ğ(
gid_t
) -1) {

515 
Ãw©Œs
.
Ÿ_v®id
 |ğ
ATTR_GID
;

516 
Ãw©Œs
.
Ÿ_gid
 = 
group
;

518 ià(!
	`S_ISDIR
(
šode
->
i_mode
))

519 
Ãw©Œs
.
Ÿ_v®id
 |=

520 
ATTR_KILL_SUID
 | 
ATTR_KILL_SGID
 | 
ATTR_KILL_PRIV
;

521 
	`mu‹x_lock
(&
šode
->
i_mu‹x
);

522 
”rÜ
 = 
	`£cur™y_·th_chown
(
·th
, 
u£r
, 
group
);

523 ià(!
”rÜ
)

524 
”rÜ
 = 
	`nÙify_chªge
(
·th
->
d’Œy
, &
Ãw©Œs
);

525 
	`mu‹x_uÆock
(&
šode
->
i_mu‹x
);

527  
”rÜ
;

528 
	}
}

530 
	$SYSCALL_DEFINE3
(
chown
, cÚ¡ 
__u£r
 *, 
f’ame
, 
uid_t
, 
u£r
, 
gid_t
, 
group
)

532 
·th
…ath;

533 
”rÜ
;

535 
”rÜ
 = 
	`u£r_·th
(
f’ame
, &
·th
);

536 ià(
”rÜ
)

537 
out
;

538 
”rÜ
 = 
	`mÁ_wªt_wr™e
(
·th
.
mÁ
);

539 ià(
”rÜ
)

540 
out_»Ëa£
;

541 
”rÜ
 = 
	`chown_commÚ
(&
·th
, 
u£r
, 
group
);

542 
	`mÁ_drİ_wr™e
(
·th
.
mÁ
);

543 
out_»Ëa£
:

544 
	`·th_put
(&
·th
);

545 
out
:

546  
”rÜ
;

547 
	}
}

549 
	$SYSCALL_DEFINE5
(
fchowÇt
, , 
dfd
, cÚ¡ 
__u£r
 *, 
f’ame
, 
uid_t
, 
u£r
,

550 
gid_t
, 
group
, , 
æag
)

552 
·th
…ath;

553 
”rÜ
 = -
EINVAL
;

554 
lookup_æags
;

556 ià((
æag
 & ~(
AT_SYMLINK_NOFOLLOW
 | 
AT_EMPTY_PATH
)) != 0)

557 
out
;

559 
lookup_æags
 = (
æag
 & 
AT_SYMLINK_NOFOLLOW
è? 0 : 
LOOKUP_FOLLOW
;

560 ià(
æag
 & 
AT_EMPTY_PATH
)

561 
lookup_æags
 |ğ
LOOKUP_EMPTY
;

562 
”rÜ
 = 
	`u£r_·th_©
(
dfd
, 
f’ame
, 
lookup_æags
, &
·th
);

563 ià(
”rÜ
)

564 
out
;

565 
”rÜ
 = 
	`mÁ_wªt_wr™e
(
·th
.
mÁ
);

566 ià(
”rÜ
)

567 
out_»Ëa£
;

568 
”rÜ
 = 
	`chown_commÚ
(&
·th
, 
u£r
, 
group
);

569 
	`mÁ_drİ_wr™e
(
·th
.
mÁ
);

570 
out_»Ëa£
:

571 
	`·th_put
(&
·th
);

572 
out
:

573  
”rÜ
;

574 
	}
}

576 
	$SYSCALL_DEFINE3
(
lchown
, cÚ¡ 
__u£r
 *, 
f’ame
, 
uid_t
, 
u£r
, 
gid_t
, 
group
)

578 
·th
…ath;

579 
”rÜ
;

581 
”rÜ
 = 
	`u£r_Í©h
(
f’ame
, &
·th
);

582 ià(
”rÜ
)

583 
out
;

584 
”rÜ
 = 
	`mÁ_wªt_wr™e
(
·th
.
mÁ
);

585 ià(
”rÜ
)

586 
out_»Ëa£
;

587 
”rÜ
 = 
	`chown_commÚ
(&
·th
, 
u£r
, 
group
);

588 
	`mÁ_drİ_wr™e
(
·th
.
mÁ
);

589 
out_»Ëa£
:

590 
	`·th_put
(&
·th
);

591 
out
:

592  
”rÜ
;

593 
	}
}

595 
	$SYSCALL_DEFINE3
(
fchown
, , 
fd
, 
uid_t
, 
u£r
, 
gid_t
, 
group
)

597 
fe
 * file;

598 
”rÜ
 = -
EBADF
;

599 
d’Œy
 * dentry;

601 
fe
 = 
	`fg‘
(
fd
);

602 ià(!
fe
)

603 
out
;

605 
”rÜ
 = 
	`mÁ_wªt_wr™e_fe
(
fe
);

606 ià(
”rÜ
)

607 
out_åut
;

608 
d’Œy
 = 
fe
->
f_·th
.dentry;

609 
	`aud™_šode
(
NULL
, 
d’Œy
);

610 
”rÜ
 = 
	`chown_commÚ
(&
fe
->
f_·th
, 
u£r
, 
group
);

611 
	`mÁ_drİ_wr™e
(
fe
->
f_·th
.
mÁ
);

612 
out_åut
:

613 
	`åut
(
fe
);

614 
out
:

615  
”rÜ
;

616 
	}
}

624 
šlše
 
	$__g‘_fe_wr™e_acûss
(
šode
 *inode,

625 
vfsmouÁ
 *
mÁ
)

627 
”rÜ
;

628 
”rÜ
 = 
	`g‘_wr™e_acûss
(
šode
);

629 ià(
”rÜ
)

630  
”rÜ
;

636 ià(!
	`¥ecŸl_fe
(
šode
->
i_mode
)) {

640 
”rÜ
 = 
	`mÁ_wªt_wr™e
(
mÁ
);

641 ià(
”rÜ
)

642 
	`put_wr™e_acûss
(
šode
);

644  
”rÜ
;

645 
	}
}

647 
fe
 *
__d’Œy_İ’
(
d’Œy
 *d’Œy, 
vfsmouÁ
 *
mÁ
,

648 
fe
 *
f
,

649 (*
İ’
)(
šode
 *, 
fe
 *),

650 cÚ¡ 
üed
 *cred)

652 cÚ¡ 
fe_İ”©iÚs
 
em±y_fİs
 = {};

653 
šode
 *inode;

654 
”rÜ
;

656 
f
->
f_mode
 = 
	`OPEN_FMODE
(f->
f_æags
è| 
FMODE_LSEEK
 |

657 
FMODE_PREAD
 | 
FMODE_PWRITE
;

659 ià(
	`uÆik–y
(
f
->
f_æags
 & 
O_PATH
))

660 
f
->
f_mode
 = 
FMODE_PATH
;

662 
šode
 = 
d’Œy
->
d_šode
;

663 ià(
f
->
f_mode
 & 
FMODE_WRITE
) {

664 
”rÜ
 = 
	`__g‘_fe_wr™e_acûss
(
šode
, 
mÁ
);

665 ià(
”rÜ
)

666 
ş—nup_fe
;

667 ià(!
	`¥ecŸl_fe
(
šode
->
i_mode
))

668 
	`fe_ke_wr™e
(
f
);

671 
f
->
f_m­pšg
 = 
šode
->
i_m­pšg
;

672 
f
->
f_·th
.
d’Œy
 = dentry;

673 
f
->
f_·th
.
mÁ
 = mnt;

674 
f
->
f_pos
 = 0;

675 
	`fe_sb_li¡_add
(
f
, 
šode
->
i_sb
);

677 ià(
	`uÆik–y
(
f
->
f_mode
 & 
FMODE_PATH
)) {

678 
f
->
f_İ
 = &
em±y_fİs
;

679  
f
;

682 
f
->
f_İ
 = 
	`fİs_g‘
(
šode
->
i_fİ
);

684 
”rÜ
 = 
	`£cur™y_d’Œy_İ’
(
f
, 
üed
);

685 ià(
”rÜ
)

686 
ş—nup_®l
;

688 
”rÜ
 = 
	`b»ak_Ëa£
(
šode
, 
f
->
f_æags
);

689 ià(
”rÜ
)

690 
ş—nup_®l
;

692 ià(!
İ’
 && 
f
->
f_İ
)

693 
İ’
 = 
f
->
f_İ
->open;

694 ià(
İ’
) {

695 
”rÜ
 = 
	`İ’
(
šode
, 
f
);

696 ià(
”rÜ
)

697 
ş—nup_®l
;

699 ià((
f
->
f_mode
 & (
FMODE_READ
 | 
FMODE_WRITE
)) == FMODE_READ)

700 
	`i_»adcouÁ_šc
(
šode
);

702 
f
->
f_æags
 &ğ~(
O_CREAT
 | 
O_EXCL
 | 
O_NOCTTY
 | 
O_TRUNC
);

704 
	`fe_¿_¡©e_š™
(&
f
->
f_¿
, f->
f_m­pšg
->
ho¡
->
i_m­pšg
);

707 ià(
f
->
f_æags
 & 
O_DIRECT
) {

708 ià(!
f
->
f_m­pšg
->
a_İs
 ||

709 ((!
f
->
f_m­pšg
->
a_İs
->
dœeù_IO
) &&

710 (!
f
->
f_m­pšg
->
a_İs
->
g‘_x_mem
))) {

711 
	`åut
(
f
);

712 
f
 = 
	`ERR_PTR
(-
EINVAL
);

716  
f
;

718 
ş—nup_®l
:

719 
	`fİs_put
(
f
->
f_İ
);

720 ià(
f
->
f_mode
 & 
FMODE_WRITE
) {

721 
	`put_wr™e_acûss
(
šode
);

722 ià(!
	`¥ecŸl_fe
(
šode
->
i_mode
)) {

729 
	`fe_»£t_wr™e
(
f
);

730 
	`mÁ_drİ_wr™e
(
mÁ
);

733 
	`fe_sb_li¡_d–
(
f
);

734 
f
->
f_·th
.
d’Œy
 = 
NULL
;

735 
f
->
f_·th
.
mÁ
 = 
NULL
;

736 
ş—nup_fe
:

737 
	`put_fp
(
f
);

738 
	`dput
(
d’Œy
);

739 
	`mÁput
(
mÁ
);

740  
	`ERR_PTR
(
”rÜ
);

741 
	}
}

762 
fe
 *
lookup_š¡ªtŸ‹_fp
(
Çmeid©a
 *
nd
, 
d’Œy
 *dentry,

763 (*
İ’
)(
šode
 *, 
fe
 *))

765 cÚ¡ 
üed
 *üed = 
	`cu¼’t_üed
();

767 ià(
	`IS_ERR
(
nd
->
š‹Á
.
İ’
.
fe
))

768 
out
;

769 ià(
	`IS_ERR
(
d’Œy
))

770 
out_”r
;

771 
nd
->
š‹Á
.
İ’
.
fe
 = 
	`__d’Œy_İ’
(
	`dg‘
(
d’Œy
), 
	`mÁg‘
Òd->
·th
.
mÁ
),

772 
nd
->
š‹Á
.
İ’
.
fe
,

773 
İ’
, 
üed
);

774 
out
:

775  
nd
->
š‹Á
.
İ’
.
fe
;

776 
out_”r
:

777 
	`»Ëa£_İ’_š‹Á
(
nd
);

778 
nd
->
š‹Á
.
İ’
.
fe
 = 
	`ERR_CAST
(
d’Œy
);

779 
out
;

780 
	}
}

781 
EXPORT_SYMBOL_GPL
(
lookup_š¡ªtŸ‹_fp
);

790 
fe
 *
	$Çmeid©a_to_fp
(
Çmeid©a
 *
nd
)

792 cÚ¡ 
üed
 *üed = 
	`cu¼’t_üed
();

793 
fe
 *
fp
;

796 
fp
 = 
nd
->
š‹Á
.
İ’
.
fe
;

797 
nd
->
š‹Á
.
İ’
.
fe
 = 
NULL
;

800 ià(
fp
->
f_·th
.
d’Œy
 =ğ
NULL
) {

801 
	`·th_g‘
(&
nd
->
·th
);

802 
fp
 = 
	`__d’Œy_İ’
(
nd
->
·th
.
d’Œy
,‚d->·th.
mÁ
, filp,

803 
NULL
, 
üed
);

805  
fp
;

806 
	}
}

812 
fe
 *
	$d’Œy_İ’
(
d’Œy
 *d’Œy, 
vfsmouÁ
 *
mÁ
, 
æags
,

813 cÚ¡ 
üed
 *cred)

815 
”rÜ
;

816 
fe
 *
f
;

818 
	`v®id©e_üeds
(
üed
);

821 
	`BUG_ON
(!
mÁ
);

823 
”rÜ
 = -
ENFILE
;

824 
f
 = 
	`g‘_em±y_fp
();

825 ià(
f
 =ğ
NULL
) {

826 
	`dput
(
d’Œy
);

827 
	`mÁput
(
mÁ
);

828  
	`ERR_PTR
(
”rÜ
);

831 
f
->
f_æags
 = 
æags
;

832  
	`__d’Œy_İ’
(
d’Œy
, 
mÁ
, 
f
, 
NULL
, 
üed
);

833 
	}
}

834 
EXPORT_SYMBOL
(
d’Œy_İ’
);

836 
	$__put_unu£d_fd
(
fes_¡ruù
 *
fes
, 
fd
)

838 
fdbË
 *
fdt
 = 
	`fes_fdbË
(
fes
);

839 
	`__FD_CLR
(
fd
, 
fdt
->
İ’_fds
);

840 ià(
fd
 < 
fes
->
Ãxt_fd
)

841 
fes
->
Ãxt_fd
 = 
fd
;

842 
	}
}

844 
	$put_unu£d_fd
(
fd
)

846 
fes_¡ruù
 *
fes
 = 
cu¼’t
->files;

847 
	`¥š_lock
(&
fes
->
fe_lock
);

848 
	`__put_unu£d_fd
(
fes
, 
fd
);

849 
	`¥š_uÆock
(&
fes
->
fe_lock
);

850 
	}
}

852 
EXPORT_SYMBOL
(
put_unu£d_fd
);

867 
	$fd_š¡®l
(
fd
, 
fe
 *file)

869 
fes_¡ruù
 *
fes
 = 
cu¼’t
->files;

870 
fdbË
 *
fdt
;

871 
	`¥š_lock
(&
fes
->
fe_lock
);

872 
fdt
 = 
	`fes_fdbË
(
fes
);

873 
	`BUG_ON
(
fdt
->
fd
[fd] !ğ
NULL
);

874 
	`rcu_assign_poš‹r
(
fdt
->
fd
[fd], 
fe
);

875 
	`¥š_uÆock
(&
fes
->
fe_lock
);

876 
	}
}

878 
EXPORT_SYMBOL
(
fd_š¡®l
);

880 
šlše
 
	$bud_İ’_æags
(
æags
, 
mode
, 
İ’_æags
 *
İ
)

882 
lookup_æags
 = 0;

883 
acc_mode
;

885 ià(!(
æags
 & 
O_CREAT
))

886 
mode
 = 0;

887 
İ
->
mode
 = mode;

890 
æags
 &ğ~
FMODE_NONOTIFY
;

898 ià(
æags
 & 
__O_SYNC
)

899 
æags
 |ğ
O_DSYNC
;

905 ià(
æags
 & 
O_PATH
) {

906 
æags
 &ğ
O_DIRECTORY
 | 
O_NOFOLLOW
 | 
O_PATH
;

907 
acc_mode
 = 0;

909 
acc_mode
 = 
MAY_OPEN
 | 
	`ACC_MODE
(
æags
);

912 
İ
->
İ’_æag
 = 
æags
;

915 ià(
æags
 & 
O_TRUNC
)

916 
acc_mode
 |ğ
MAY_WRITE
;

920 ià(
æags
 & 
O_APPEND
)

921 
acc_mode
 |ğ
MAY_APPEND
;

923 
İ
->
acc_mode
 =‡cc_mode;

925 
İ
->
š‹Á
 = 
æags
 & 
O_PATH
 ? 0 : 
LOOKUP_OPEN
;

927 ià(
æags
 & 
O_CREAT
) {

928 
İ
->
š‹Á
 |ğ
LOOKUP_CREATE
;

929 ià(
æags
 & 
O_EXCL
)

930 
İ
->
š‹Á
 |ğ
LOOKUP_EXCL
;

933 ià(
æags
 & 
O_DIRECTORY
)

934 
lookup_æags
 |ğ
LOOKUP_DIRECTORY
;

935 ià(!(
æags
 & 
O_NOFOLLOW
))

936 
lookup_æags
 |ğ
LOOKUP_FOLLOW
;

937  
lookup_æags
;

938 
	}
}

951 
fe
 *
	$fp_İ’
(cÚ¡ *
f’ame
, 
æags
, 
mode
)

953 
İ’_æags
 
İ
;

954 
lookup
 = 
	`bud_İ’_æags
(
æags
, 
mode
, &
İ
);

955  
	`do_fp_İ’
(
AT_FDCWD
, 
f’ame
, &
İ
, 
lookup
);

956 
	}
}

957 
EXPORT_SYMBOL
(
fp_İ’
);

959 
fe
 *
	$fe_İ’_roÙ
(
d’Œy
 *d’Œy, 
vfsmouÁ
 *
mÁ
,

960 cÚ¡ *
f’ame
, 
æags
)

962 
İ’_æags
 
İ
;

963 
lookup
 = 
	`bud_İ’_æags
(
æags
, 0, &
İ
);

964 ià(
æags
 & 
O_CREAT
)

965  
	`ERR_PTR
(-
EINVAL
);

966 ià(!
f’ame
 && (
æags
 & 
O_DIRECTORY
))

967 ià(!
d’Œy
->
d_šode
->
i_İ
->
lookup
)

968  
	`ERR_PTR
(-
ENOTDIR
);

969  
	`do_fe_İ’_roÙ
(
d’Œy
, 
mÁ
, 
f’ame
, &
İ
, 
lookup
);

970 
	}
}

971 
EXPORT_SYMBOL
(
fe_İ’_roÙ
);

973 
	$do_sys_İ’
(
dfd
, cÚ¡ 
__u£r
 *
f’ame
, 
æags
, 
mode
)

975 
İ’_æags
 
İ
;

976 
lookup
 = 
	`bud_İ’_æags
(
æags
, 
mode
, &
İ
);

977 *
tmp
 = 
	`g‘Çme
(
f’ame
);

978 
fd
 = 
	`PTR_ERR
(
tmp
);

980 ià(!
	`IS_ERR
(
tmp
)) {

981 
fd
 = 
	`g‘_unu£d_fd_æags
(
æags
);

982 ià(
fd
 >= 0) {

983 
fe
 *
f
 = 
	`do_fp_İ’
(
dfd
, 
tmp
, &
İ
, 
lookup
);

984 ià(
	`IS_ERR
(
f
)) {

985 
	`put_unu£d_fd
(
fd
);

986 
fd
 = 
	`PTR_ERR
(
f
);

988 
	`f¢Ùify_İ’
(
f
);

989 
	`fd_š¡®l
(
fd
, 
f
);

992 
	`puŠame
(
tmp
);

994  
fd
;

995 
	}
}

997 
	$SYSCALL_DEFINE3
(
İ’
, cÚ¡ 
__u£r
 *, 
f’ame
, , 
æags
, , 
mode
)

999 
»t
;

1001 ià(
	`fÜû_o_Ïrgefe
())

1002 
æags
 |ğ
O_LARGEFILE
;

1004 
»t
 = 
	`do_sys_İ’
(
AT_FDCWD
, 
f’ame
, 
æags
, 
mode
);

1006 
	`asmlškage_´Ùeù
(3, 
»t
, 
f’ame
, 
æags
, 
mode
);

1007  
»t
;

1008 
	}
}

1010 
	$SYSCALL_DEFINE4
(
İ’©
, , 
dfd
, cÚ¡ 
__u£r
 *, 
f’ame
, , 
æags
,

1011 , 
mode
)

1013 
»t
;

1015 ià(
	`fÜû_o_Ïrgefe
())

1016 
æags
 |ğ
O_LARGEFILE
;

1018 
»t
 = 
	`do_sys_İ’
(
dfd
, 
f’ame
, 
æags
, 
mode
);

1020 
	`asmlškage_´Ùeù
(4, 
»t
, 
dfd
, 
f’ame
, 
æags
, 
mode
);

1021  
»t
;

1022 
	}
}

1024 #iâdeà
__®pha__


1030 
	$SYSCALL_DEFINE2
(
ü—t
, cÚ¡ 
__u£r
 *, 
·thÇme
, , 
mode
)

1032  
	`sys_İ’
(
·thÇme
, 
O_CREAT
 | 
O_WRONLY
 | 
O_TRUNC
, 
mode
);

1033 
	}
}

1041 
	$fp_şo£
(
fe
 *
fp
, 
æ_owÃr_t
 
id
)

1043 
»tv®
 = 0;

1045 ià(!
	`fe_couÁ
(
fp
)) {

1046 
	`´štk
(
KERN_ERR
 "VFS: Close: file count is 0\n");

1050 ià(
fp
->
f_İ
 && fp->f_İ->
æush
)

1051 
»tv®
 = 
fp
->
f_İ
->
	`æush
(fp, 
id
);

1053 ià(
	`lik–y
(!(
fp
->
f_mode
 & 
FMODE_PATH
))) {

1054 
	`dnÙify_æush
(
fp
, 
id
);

1055 
	`locks_»move_posix
(
fp
, 
id
);

1057 
	`åut
(
fp
);

1058  
»tv®
;

1059 
	}
}

1061 
EXPORT_SYMBOL
(
fp_şo£
);

1068 
	$SYSCALL_DEFINE1
(
şo£
, , 
fd
)

1070 
fe
 * 
fp
;

1071 
fes_¡ruù
 *
fes
 = 
cu¼’t
->files;

1072 
fdbË
 *
fdt
;

1073 
»tv®
;

1075 
	`¥š_lock
(&
fes
->
fe_lock
);

1076 
fdt
 = 
	`fes_fdbË
(
fes
);

1077 ià(
fd
 >ğ
fdt
->
max_fds
)

1078 
out_uÆock
;

1079 
fp
 = 
fdt
->
fd
[fd];

1080 ià(!
fp
)

1081 
out_uÆock
;

1082 
	`rcu_assign_poš‹r
(
fdt
->
fd
[fd], 
NULL
);

1083 
	`FD_CLR
(
fd
, 
fdt
->
şo£_Ú_exec
);

1084 
	`__put_unu£d_fd
(
fes
, 
fd
);

1085 
	`¥š_uÆock
(&
fes
->
fe_lock
);

1086 
»tv®
 = 
	`fp_şo£
(
fp
, 
fes
);

1089 ià(
	`uÆik–y
(
»tv®
 =ğ-
ERESTARTSYS
 ||

1090 
»tv®
 =ğ-
ERESTARTNOINTR
 ||

1091 
»tv®
 =ğ-
ERESTARTNOHAND
 ||

1092 
»tv®
 =ğ-
ERESTART_RESTARTBLOCK
))

1093 
»tv®
 = -
EINTR
;

1095  
»tv®
;

1097 
out_uÆock
:

1098 
	`¥š_uÆock
(&
fes
->
fe_lock
);

1099  -
EBADF
;

1100 
	}
}

1101 
EXPORT_SYMBOL
(
sys_şo£
);

1107 
	$SYSCALL_DEFINE0
(
vhªgup
)

1109 ià(
	`ÿ·bË
(
CAP_SYS_TTY_CONFIG
)) {

1110 
	`‰y_vhªgup_£lf
();

1113  -
EPERM
;

1114 
	}
}

1122 
	$g’”ic_fe_İ’
(
šode
 * inode, 
fe
 * 
fp
)

1124 ià(!(
fp
->
f_æags
 & 
O_LARGEFILE
è&& 
	`i_size_»ad
(
šode
è> 
MAX_NON_LFS
)

1125  -
EOVERFLOW
;

1127 
	}
}

1129 
EXPORT_SYMBOL
(
g’”ic_fe_İ’
);

1137 
	$nÚ£ekabË_İ’
(
šode
 *šode, 
fe
 *
fp
)

1139 
fp
->
f_mode
 &ğ~(
FMODE_LSEEK
 | 
FMODE_PREAD
 | 
FMODE_PWRITE
);

1141 
	}
}

1143 
EXPORT_SYMBOL
(
nÚ£ekabË_İ’
);

	@pipe.c

7 
	~<lšux/mm.h
>

8 
	~<lšux/fe.h
>

9 
	~<lšux/pŞl.h
>

10 
	~<lšux/¦ab.h
>

11 
	~<lšux/moduË.h
>

12 
	~<lšux/š™.h
>

13 
	~<lšux/fs.h
>

14 
	~<lšux/log2.h
>

15 
	~<lšux/mouÁ.h
>

16 
	~<lšux/pe_fs_i.h
>

17 
	~<lšux/uio.h
>

18 
	~<lšux/highmem.h
>

19 
	~<lšux/·gem­.h
>

20 
	~<lšux/aud™.h
>

21 
	~<lšux/sysÿÎs.h
>

22 
	~<lšux/fú.h
>

24 
	~<asm/uacûss.h
>

25 
	~<asm/ioùls.h
>

31 
	gpe_max_size
 = 1048576;

36 
	gpe_mš_size
 = 
PAGE_SIZE
;

53 
	$pe_lock_Ã¡ed
(
pe_šode_šfo
 *
pe
, 
subşass
)

55 ià(
pe
->
šode
)

56 
	`mu‹x_lock_Ã¡ed
(&
pe
->
šode
->
i_mu‹x
, 
subşass
);

57 
	}
}

59 
	$pe_lock
(
pe_šode_šfo
 *
pe
)

64 
	`pe_lock_Ã¡ed
(
pe
, 
I_MUTEX_PARENT
);

65 
	}
}

66 
EXPORT_SYMBOL
(
pe_lock
);

68 
	$pe_uÆock
(
pe_šode_šfo
 *
pe
)

70 ià(
pe
->
šode
)

71 
	`mu‹x_uÆock
(&
pe
->
šode
->
i_mu‹x
);

72 
	}
}

73 
EXPORT_SYMBOL
(
pe_uÆock
);

75 
	$pe_doubË_lock
(
pe_šode_šfo
 *
pe1
,

76 
pe_šode_šfo
 *
pe2
)

78 
	`BUG_ON
(
pe1
 =ğ
pe2
);

80 ià(
pe1
 < 
pe2
) {

81 
	`pe_lock_Ã¡ed
(
pe1
, 
I_MUTEX_PARENT
);

82 
	`pe_lock_Ã¡ed
(
pe2
, 
I_MUTEX_CHILD
);

84 
	`pe_lock_Ã¡ed
(
pe2
, 
I_MUTEX_PARENT
);

85 
	`pe_lock_Ã¡ed
(
pe1
, 
I_MUTEX_CHILD
);

87 
	}
}

90 
	$pe_wa™
(
pe_šode_šfo
 *
pe
)

92 
	`DEFINE_WAIT
(
wa™
);

98 
	`´•¬e_to_wa™
(&
pe
->
wa™
, &wa™, 
TASK_INTERRUPTIBLE
);

99 
	`pe_uÆock
(
pe
);

100 
	`scheduË
();

101 
	`fšish_wa™
(&
pe
->
wa™
, &wait);

102 
	`pe_lock
(
pe
);

103 
	}
}

106 
	$pe_iov_cİy_äom_u£r
(*
to
, 
iovec
 *
iov
, 
Ën
,

107 
©omic
)

109 
cİy
;

111 
Ën
 > 0) {

112 !
iov
->
iov_Ën
)

113 
iov
++;

114 
cİy
 = 
	`mš_t
(, 
Ën
, 
iov
->
iov_Ën
);

116 ià(
©omic
) {

117 ià(
	`__cİy_äom_u£r_š©omic
(
to
, 
iov
->
iov_ba£
, 
cİy
))

118  -
EFAULT
;

120 ià(
	`cİy_äom_u£r
(
to
, 
iov
->
iov_ba£
, 
cİy
))

121  -
EFAULT
;

123 
to
 +ğ
cİy
;

124 
Ën
 -ğ
cİy
;

125 
iov
->
iov_ba£
 +ğ
cİy
;

126 
iov
->
iov_Ën
 -ğ
cİy
;

129 
	}
}

132 
	$pe_iov_cİy_to_u£r
(
iovec
 *
iov
, cÚ¡ *
äom
, 
Ën
,

133 
©omic
)

135 
cİy
;

137 
Ën
 > 0) {

138 !
iov
->
iov_Ën
)

139 
iov
++;

140 
cİy
 = 
	`mš_t
(, 
Ën
, 
iov
->
iov_Ën
);

142 ià(
©omic
) {

143 ià(
	`__cİy_to_u£r_š©omic
(
iov
->
iov_ba£
, 
äom
, 
cİy
))

144  -
EFAULT
;

146 ià(
	`cİy_to_u£r
(
iov
->
iov_ba£
, 
äom
, 
cİy
))

147  -
EFAULT
;

149 
äom
 +ğ
cİy
;

150 
Ën
 -ğ
cİy
;

151 
iov
->
iov_ba£
 +ğ
cİy
;

152 
iov
->
iov_Ën
 -ğ
cİy
;

155 
	}
}

161 
	$iov_çuÉ_š_·ges_wr™e
(
iovec
 *
iov
, 
Ën
)

163 !
iov
->
iov_Ën
)

164 
iov
++;

166 
Ën
 > 0) {

167 
this_Ën
;

169 
this_Ën
 = 
	`mš_t
(, 
Ën
, 
iov
->
iov_Ën
);

170 ià(
	`çuÉ_š_·ges_wr™—bË
(
iov
->
iov_ba£
, 
this_Ën
))

173 
Ën
 -ğ
this_Ën
;

174 
iov
++;

177  
Ën
;

178 
	}
}

183 
	$iov_çuÉ_š_·ges_»ad
(
iovec
 *
iov
, 
Ën
)

185 !
iov
->
iov_Ën
)

186 
iov
++;

188 
Ën
 > 0) {

189 
this_Ën
;

191 
this_Ën
 = 
	`mš_t
(, 
Ën
, 
iov
->
iov_Ën
);

192 
	`çuÉ_š_·ges_»adabË
(
iov
->
iov_ba£
, 
this_Ën
);

193 
Ën
 -ğ
this_Ën
;

194 
iov
++;

196 
	}
}

198 
	$ªÚ_pe_buf_»Ëa£
(
pe_šode_šfo
 *
pe
,

199 
pe_bufãr
 *
buf
)

201 
·ge
 *·gğ
buf
->page;

208 ià(
	`·ge_couÁ
(
·ge
è=ğ1 && !
pe
->
tmp_·ge
)

209 
pe
->
tmp_·ge
 = 
·ge
;

211 
	`·ge_ÿche_»Ëa£
(
·ge
);

212 
	}
}

228 *
	$g’”ic_pe_buf_m­
(
pe_šode_šfo
 *
pe
,

229 
pe_bufãr
 *
buf
, 
©omic
)

231 ià(
©omic
) {

232 
buf
->
æags
 |ğ
PIPE_BUF_FLAG_ATOMIC
;

233  
	`km­_©omic
(
buf
->
·ge
, 
KM_USER0
);

236  
	`km­
(
buf
->
·ge
);

237 
	}
}

238 
EXPORT_SYMBOL
(
g’”ic_pe_buf_m­
);

249 
	$g’”ic_pe_buf_unm­
(
pe_šode_šfo
 *
pe
,

250 
pe_bufãr
 *
buf
, *
m­_d©a
)

252 ià(
buf
->
æags
 & 
PIPE_BUF_FLAG_ATOMIC
) {

253 
buf
->
æags
 &ğ~
PIPE_BUF_FLAG_ATOMIC
;

254 
	`kunm­_©omic
(
m­_d©a
, 
KM_USER0
);

256 
	`kunm­
(
buf
->
·ge
);

257 
	}
}

258 
EXPORT_SYMBOL
(
g’”ic_pe_buf_unm­
);

272 
	$g’”ic_pe_buf_¡—l
(
pe_šode_šfo
 *
pe
,

273 
pe_bufãr
 *
buf
)

275 
·ge
 *·gğ
buf
->page;

282 ià(
	`·ge_couÁ
(
·ge
) == 1) {

283 
	`lock_·ge
(
·ge
);

288 
	}
}

289 
EXPORT_SYMBOL
(
g’”ic_pe_buf_¡—l
);

301 
	$g’”ic_pe_buf_g‘
(
pe_šode_šfo
 *
pe
, 
pe_bufãr
 *
buf
)

303 
	`·ge_ÿche_g‘
(
buf
->
·ge
);

304 
	}
}

305 
EXPORT_SYMBOL
(
g’”ic_pe_buf_g‘
);

316 
	$g’”ic_pe_buf_cÚfœm
(
pe_šode_šfo
 *
šfo
,

317 
pe_bufãr
 *
buf
)

320 
	}
}

321 
EXPORT_SYMBOL
(
g’”ic_pe_buf_cÚfœm
);

331 
	$g’”ic_pe_buf_»Ëa£
(
pe_šode_šfo
 *
pe
,

332 
pe_bufãr
 *
buf
)

334 
	`·ge_ÿche_»Ëa£
(
buf
->
·ge
);

335 
	}
}

336 
EXPORT_SYMBOL
(
g’”ic_pe_buf_»Ëa£
);

338 cÚ¡ 
pe_buf_İ”©iÚs
 
	gªÚ_pe_buf_İs
 = {

339 .
ÿn_m”ge
 = 1,

340 .
	gm­
 = 
g’”ic_pe_buf_m­
,

341 .
	gunm­
 = 
g’”ic_pe_buf_unm­
,

342 .
	gcÚfœm
 = 
g’”ic_pe_buf_cÚfœm
,

343 .
	g»Ëa£
 = 
ªÚ_pe_buf_»Ëa£
,

344 .
	g¡—l
 = 
g’”ic_pe_buf_¡—l
,

345 .
	gg‘
 = 
g’”ic_pe_buf_g‘
,

348 
ssize_t


349 
	$pe_»ad
(
kiocb
 *
iocb
, cÚ¡ 
iovec
 *
_iov
,

350 
Ä_£gs
, 
loff_t
 
pos
)

352 
fe
 *
fp
 = 
iocb
->
ki_fp
;

353 
šode
 *šodğ
fp
->
f_·th
.
d’Œy
->
d_šode
;

354 
pe_šode_šfo
 *
pe
;

355 
do_wakeup
;

356 
ssize_t
 
»t
;

357 
iovec
 *
iov
 = (ioveø*)
_iov
;

358 
size_t
 
tÙ®_Ën
;

360 
tÙ®_Ën
 = 
	`iov_Ëngth
(
iov
, 
Ä_£gs
);

362 ià(
	`uÆik–y
(
tÙ®_Ën
 == 0))

365 
do_wakeup
 = 0;

366 
»t
 = 0;

367 
	`mu‹x_lock
(&
šode
->
i_mu‹x
);

368 
pe
 = 
šode
->
i_pe
;

370 
bufs
 = 
pe
->
Äbufs
;

371 ià(
bufs
) {

372 
curbuf
 = 
pe
->curbuf;

373 
pe_bufãr
 *
buf
 = 
pe
->
bufs
 + 
curbuf
;

374 cÚ¡ 
pe_buf_İ”©iÚs
 *
İs
 = 
buf
->ops;

375 *
addr
;

376 
size_t
 
ch¬s
 = 
buf
->
Ën
;

377 
”rÜ
, 
©omic
;

379 ià(
ch¬s
 > 
tÙ®_Ën
)

380 
ch¬s
 = 
tÙ®_Ën
;

382 
”rÜ
 = 
İs
->
	`cÚfœm
(
pe
, 
buf
);

383 ià(
”rÜ
) {

384 ià(!
»t
)

385 
»t
 = 
”rÜ
;

389 
©omic
 = !
	`iov_çuÉ_š_·ges_wr™e
(
iov
, 
ch¬s
);

390 
»do
:

391 
addr
 = 
İs
->
	`m­
(
pe
, 
buf
, 
©omic
);

392 
”rÜ
 = 
	`pe_iov_cİy_to_u£r
(
iov
, 
addr
 + 
buf
->
off£t
, 
ch¬s
, 
©omic
);

393 
İs
->
	`unm­
(
pe
, 
buf
, 
addr
);

394 ià(
	`uÆik–y
(
”rÜ
)) {

398 ià(
©omic
) {

399 
©omic
 = 0;

400 
»do
;

402 ià(!
»t
)

403 
»t
 = 
”rÜ
;

406 
»t
 +ğ
ch¬s
;

407 
buf
->
off£t
 +ğ
ch¬s
;

408 
buf
->
Ën
 -ğ
ch¬s
;

409 ià(!
buf
->
Ën
) {

410 
buf
->
İs
 = 
NULL
;

411 
İs
->
	`»Ëa£
(
pe
, 
buf
);

412 
curbuf
 = (curbuà+ 1è& (
pe
->
bufãrs
 - 1);

413 
pe
->
curbuf
 = curbuf;

414 
pe
->
Äbufs
 = --
bufs
;

415 
do_wakeup
 = 1;

417 
tÙ®_Ën
 -ğ
ch¬s
;

418 ià(!
tÙ®_Ën
)

421 ià(
bufs
)

423 ià(!
pe
->
wr™”s
)

425 ià(!
pe
->
wa™šg_wr™”s
) {

431 ià(
»t
)

433 ià(
fp
->
f_æags
 & 
O_NONBLOCK
) {

434 
»t
 = -
EAGAIN
;

438 ià(
	`sigÇl_³ndšg
(
cu¼’t
)) {

439 ià(!
»t
)

440 
»t
 = -
ERESTARTSYS
;

443 ià(
do_wakeup
) {

444 
	`wake_up_š‹¼u±ibË_sync_pŞl
(&
pe
->
wa™
, 
POLLOUT
 | 
POLLWRNORM
);

445 
	`kl_çsync
(&
pe
->
çsync_wr™”s
, 
SIGIO
, 
POLL_OUT
);

447 
	`pe_wa™
(
pe
);

449 
	`mu‹x_uÆock
(&
šode
->
i_mu‹x
);

452 ià(
do_wakeup
) {

453 
	`wake_up_š‹¼u±ibË_sync_pŞl
(&
pe
->
wa™
, 
POLLOUT
 | 
POLLWRNORM
);

454 
	`kl_çsync
(&
pe
->
çsync_wr™”s
, 
SIGIO
, 
POLL_OUT
);

456 ià(
»t
 > 0)

457 
	`fe_acûs£d
(
fp
);

458  
»t
;

459 
	}
}

461 
ssize_t


462 
	$pe_wr™e
(
kiocb
 *
iocb
, cÚ¡ 
iovec
 *
_iov
,

463 
Ä_£gs
, 
loff_t
 
µos
)

465 
fe
 *
fp
 = 
iocb
->
ki_fp
;

466 
šode
 *šodğ
fp
->
f_·th
.
d’Œy
->
d_šode
;

467 
pe_šode_šfo
 *
pe
;

468 
ssize_t
 
»t
;

469 
do_wakeup
;

470 
iovec
 *
iov
 = (ioveø*)
_iov
;

471 
size_t
 
tÙ®_Ën
;

472 
ssize_t
 
ch¬s
;

474 
tÙ®_Ën
 = 
	`iov_Ëngth
(
iov
, 
Ä_£gs
);

476 ià(
	`uÆik–y
(
tÙ®_Ën
 == 0))

479 
do_wakeup
 = 0;

480 
»t
 = 0;

481 
	`mu‹x_lock
(&
šode
->
i_mu‹x
);

482 
pe
 = 
šode
->
i_pe
;

484 ià(!
pe
->
»ad”s
) {

485 
	`£nd_sig
(
SIGPIPE
, 
cu¼’t
, 0);

486 
»t
 = -
EPIPE
;

487 
out
;

491 
ch¬s
 = 
tÙ®_Ën
 & (
PAGE_SIZE
-1);

492 ià(
pe
->
Äbufs
 && 
ch¬s
 != 0) {

493 
Ï¡buf
 = (
pe
->
curbuf
 +…e->
Äbufs
 - 1) &

494 (
pe
->
bufãrs
 - 1);

495 
pe_bufãr
 *
buf
 = 
pe
->
bufs
 + 
Ï¡buf
;

496 cÚ¡ 
pe_buf_İ”©iÚs
 *
İs
 = 
buf
->ops;

497 
off£t
 = 
buf
->off£ˆ+ buf->
Ën
;

499 ià(
İs
->
ÿn_m”ge
 && 
off£t
 + 
ch¬s
 <ğ
PAGE_SIZE
) {

500 
”rÜ
, 
©omic
 = 1;

501 *
addr
;

503 
”rÜ
 = 
İs
->
	`cÚfœm
(
pe
, 
buf
);

504 ià(
”rÜ
)

505 
out
;

507 
	`iov_çuÉ_š_·ges_»ad
(
iov
, 
ch¬s
);

508 
»do1
:

509 
addr
 = 
İs
->
	`m­
(
pe
, 
buf
, 
©omic
);

510 
”rÜ
 = 
	`pe_iov_cİy_äom_u£r
(
off£t
 + 
addr
, 
iov
,

511 
ch¬s
, 
©omic
);

512 
İs
->
	`unm­
(
pe
, 
buf
, 
addr
);

513 
»t
 = 
”rÜ
;

514 
do_wakeup
 = 1;

515 ià(
”rÜ
) {

516 ià(
©omic
) {

517 
©omic
 = 0;

518 
»do1
;

520 
out
;

522 
buf
->
Ën
 +ğ
ch¬s
;

523 
tÙ®_Ën
 -ğ
ch¬s
;

524 
»t
 = 
ch¬s
;

525 ià(!
tÙ®_Ën
)

526 
out
;

531 
bufs
;

533 ià(!
pe
->
»ad”s
) {

534 
	`£nd_sig
(
SIGPIPE
, 
cu¼’t
, 0);

535 ià(!
»t
)

536 
»t
 = -
EPIPE
;

539 
bufs
 = 
pe
->
Äbufs
;

540 ià(
bufs
 < 
pe
->
bufãrs
) {

541 
Ãwbuf
 = (
pe
->
curbuf
 + 
bufs
è& (pe->
bufãrs
-1);

542 
pe_bufãr
 *
buf
 = 
pe
->
bufs
 + 
Ãwbuf
;

543 
·ge
 *·gğ
pe
->
tmp_·ge
;

544 *
¤c
;

545 
”rÜ
, 
©omic
 = 1;

547 ià(!
·ge
) {

548 
·ge
 = 
	`®loc_·ge
(
GFP_HIGHUSER
);

549 ià(
	`uÆik–y
(!
·ge
)) {

550 
»t
 =„‘ ? : -
ENOMEM
;

553 
pe
->
tmp_·ge
 = 
·ge
;

560 
do_wakeup
 = 1;

561 
ch¬s
 = 
PAGE_SIZE
;

562 ià(
ch¬s
 > 
tÙ®_Ën
)

563 
ch¬s
 = 
tÙ®_Ën
;

565 
	`iov_çuÉ_š_·ges_»ad
(
iov
, 
ch¬s
);

566 
»do2
:

567 ià(
©omic
)

568 
¤c
 = 
	`km­_©omic
(
·ge
, 
KM_USER0
);

570 
¤c
 = 
	`km­
(
·ge
);

572 
”rÜ
 = 
	`pe_iov_cİy_äom_u£r
(
¤c
, 
iov
, 
ch¬s
,

573 
©omic
);

574 ià(
©omic
)

575 
	`kunm­_©omic
(
¤c
, 
KM_USER0
);

577 
	`kunm­
(
·ge
);

579 ià(
	`uÆik–y
(
”rÜ
)) {

580 ià(
©omic
) {

581 
©omic
 = 0;

582 
»do2
;

584 ià(!
»t
)

585 
»t
 = 
”rÜ
;

588 
»t
 +ğ
ch¬s
;

591 
buf
->
·ge
 =…age;

592 
buf
->
İs
 = &
ªÚ_pe_buf_İs
;

593 
buf
->
off£t
 = 0;

594 
buf
->
Ën
 = 
ch¬s
;

595 
pe
->
Äbufs
 = ++
bufs
;

596 
pe
->
tmp_·ge
 = 
NULL
;

598 
tÙ®_Ën
 -ğ
ch¬s
;

599 ià(!
tÙ®_Ën
)

602 ià(
bufs
 < 
pe
->
bufãrs
)

604 ià(
fp
->
f_æags
 & 
O_NONBLOCK
) {

605 ià(!
»t
)

606 
»t
 = -
EAGAIN
;

609 ià(
	`sigÇl_³ndšg
(
cu¼’t
)) {

610 ià(!
»t
)

611 
»t
 = -
ERESTARTSYS
;

614 ià(
do_wakeup
) {

615 
	`wake_up_š‹¼u±ibË_sync_pŞl
(&
pe
->
wa™
, 
POLLIN
 | 
POLLRDNORM
);

616 
	`kl_çsync
(&
pe
->
çsync_»ad”s
, 
SIGIO
, 
POLL_IN
);

617 
do_wakeup
 = 0;

619 
pe
->
wa™šg_wr™”s
++;

620 
	`pe_wa™
(
pe
);

621 
pe
->
wa™šg_wr™”s
--;

623 
out
:

624 
	`mu‹x_uÆock
(&
šode
->
i_mu‹x
);

625 ià(
do_wakeup
) {

626 
	`wake_up_š‹¼u±ibË_sync_pŞl
(&
pe
->
wa™
, 
POLLIN
 | 
POLLRDNORM
);

627 
	`kl_çsync
(&
pe
->
çsync_»ad”s
, 
SIGIO
, 
POLL_IN
);

629 ià(
»t
 > 0)

630 
	`fe_upd©e_time
(
fp
);

631  
»t
;

632 
	}
}

634 
ssize_t


635 
	$bad_pe_r
(
fe
 *
fp
, 
__u£r
 *
buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

637  -
EBADF
;

638 
	}
}

640 
ssize_t


641 
	$bad_pe_w
(
fe
 *
fp
, cÚ¡ 
__u£r
 *
buf
, 
size_t
 
couÁ
,

642 
loff_t
 *
µos
)

644  -
EBADF
;

645 
	}
}

647 
	$pe_ioùl
(
fe
 *
fp
, 
cmd
, 
¬g
)

649 
šode
 *šodğ
fp
->
f_·th
.
d’Œy
->
d_šode
;

650 
pe_šode_šfo
 *
pe
;

651 
couÁ
, 
buf
, 
Äbufs
;

653 
cmd
) {

654 
FIONREAD
:

655 
	`mu‹x_lock
(&
šode
->
i_mu‹x
);

656 
pe
 = 
šode
->
i_pe
;

657 
couÁ
 = 0;

658 
buf
 = 
pe
->
curbuf
;

659 
Äbufs
 = 
pe
->nrbufs;

660 --
Äbufs
 >= 0) {

661 
couÁ
 +ğ
pe
->
bufs
[
buf
].
Ën
;

662 
buf
 = (buf+1è& (
pe
->
bufãrs
 - 1);

664 
	`mu‹x_uÆock
(&
šode
->
i_mu‹x
);

666  
	`put_u£r
(
couÁ
, (
__u£r
 *)
¬g
);

668  -
EINVAL
;

670 
	}
}

674 
	$pe_pŞl
(
fe
 *
fp
, 
pŞl_bË
 *
wa™
)

676 
mask
;

677 
šode
 *šodğ
fp
->
f_·th
.
d’Œy
->
d_šode
;

678 
pe_šode_šfo
 *
pe
 = 
šode
->
i_pe
;

679 
Äbufs
;

681 
	`pŞl_wa™
(
fp
, &
pe
->
wa™
, wait);

684 
Äbufs
 = 
pe
->nrbufs;

685 
mask
 = 0;

686 ià(
fp
->
f_mode
 & 
FMODE_READ
) {

687 
mask
 = (
Äbufs
 > 0è? 
POLLIN
 | 
POLLRDNORM
 : 0;

688 ià(!
pe
->
wr™”s
 && 
fp
->
f_v”siÚ
 !ğpe->
w_couÁ”
)

689 
mask
 |ğ
POLLHUP
;

692 ià(
fp
->
f_mode
 & 
FMODE_WRITE
) {

693 
mask
 |ğ(
Äbufs
 < 
pe
->
bufãrs
è? 
POLLOUT
 | 
POLLWRNORM
 : 0;

698 ià(!
pe
->
»ad”s
)

699 
mask
 |ğ
POLLERR
;

702  
mask
;

703 
	}
}

706 
	$pe_»Ëa£
(
šode
 *šode, 
deü
, 
decw
)

708 
pe_šode_šfo
 *
pe
;

710 
	`mu‹x_lock
(&
šode
->
i_mu‹x
);

711 
pe
 = 
šode
->
i_pe
;

712 
pe
->
»ad”s
 -ğ
deü
;

713 
pe
->
wr™”s
 -ğ
decw
;

715 ià(!
pe
->
»ad”s
 && !pe->
wr™”s
) {

716 
	`ä“_pe_šfo
(
šode
);

718 
	`wake_up_š‹¼u±ibË_sync_pŞl
(&
pe
->
wa™
, 
POLLIN
 | 
POLLOUT
 | 
POLLRDNORM
 | 
POLLWRNORM
 | 
POLLERR
 | 
POLLHUP
);

719 
	`kl_çsync
(&
pe
->
çsync_»ad”s
, 
SIGIO
, 
POLL_IN
);

720 
	`kl_çsync
(&
pe
->
çsync_wr™”s
, 
SIGIO
, 
POLL_OUT
);

722 
	`mu‹x_uÆock
(&
šode
->
i_mu‹x
);

725 
	}
}

728 
	$pe_»ad_çsync
(
fd
, 
fe
 *
fp
, 
Ú
)

730 
šode
 *šodğ
fp
->
f_·th
.
d’Œy
->
d_šode
;

731 
»tv®
;

733 
	`mu‹x_lock
(&
šode
->
i_mu‹x
);

734 
»tv®
 = 
	`çsync_h–³r
(
fd
, 
fp
, 
Ú
, &
šode
->
i_pe
->
çsync_»ad”s
);

735 
	`mu‹x_uÆock
(&
šode
->
i_mu‹x
);

737  
»tv®
;

738 
	}
}

742 
	$pe_wr™e_çsync
(
fd
, 
fe
 *
fp
, 
Ú
)

744 
šode
 *šodğ
fp
->
f_·th
.
d’Œy
->
d_šode
;

745 
»tv®
;

747 
	`mu‹x_lock
(&
šode
->
i_mu‹x
);

748 
»tv®
 = 
	`çsync_h–³r
(
fd
, 
fp
, 
Ú
, &
šode
->
i_pe
->
çsync_wr™”s
);

749 
	`mu‹x_uÆock
(&
šode
->
i_mu‹x
);

751  
»tv®
;

752 
	}
}

756 
	$pe_rdwr_çsync
(
fd
, 
fe
 *
fp
, 
Ú
)

758 
šode
 *šodğ
fp
->
f_·th
.
d’Œy
->
d_šode
;

759 
pe_šode_šfo
 *
pe
 = 
šode
->
i_pe
;

760 
»tv®
;

762 
	`mu‹x_lock
(&
šode
->
i_mu‹x
);

763 
»tv®
 = 
	`çsync_h–³r
(
fd
, 
fp
, 
Ú
, &
pe
->
çsync_»ad”s
);

764 ià(
»tv®
 >= 0) {

765 
»tv®
 = 
	`çsync_h–³r
(
fd
, 
fp
, 
Ú
, &
pe
->
çsync_wr™”s
);

766 ià(
»tv®
 < 0)

767 
	`çsync_h–³r
(-1, 
fp
, 0, &
pe
->
çsync_»ad”s
);

769 
	`mu‹x_uÆock
(&
šode
->
i_mu‹x
);

770  
»tv®
;

771 
	}
}

775 
	$pe_»ad_»Ëa£
(
šode
 *šode, 
fe
 *
fp
)

777  
	`pe_»Ëa£
(
šode
, 1, 0);

778 
	}
}

781 
	$pe_wr™e_»Ëa£
(
šode
 *šode, 
fe
 *
fp
)

783  
	`pe_»Ëa£
(
šode
, 0, 1);

784 
	}
}

787 
	$pe_rdwr_»Ëa£
(
šode
 *šode, 
fe
 *
fp
)

789 
deü
, 
decw
;

791 
deü
 = (
fp
->
f_mode
 & 
FMODE_READ
) != 0;

792 
decw
 = (
fp
->
f_mode
 & 
FMODE_WRITE
) != 0;

793  
	`pe_»Ëa£
(
šode
, 
deü
, 
decw
);

794 
	}
}

797 
	$pe_»ad_İ’
(
šode
 *šode, 
fe
 *
fp
)

799 
»t
 = -
ENOENT
;

801 
	`mu‹x_lock
(&
šode
->
i_mu‹x
);

803 ià(
šode
->
i_pe
) {

804 
»t
 = 0;

805 
šode
->
i_pe
->
»ad”s
++;

808 
	`mu‹x_uÆock
(&
šode
->
i_mu‹x
);

810  
»t
;

811 
	}
}

814 
	$pe_wr™e_İ’
(
šode
 *šode, 
fe
 *
fp
)

816 
»t
 = -
ENOENT
;

818 
	`mu‹x_lock
(&
šode
->
i_mu‹x
);

820 ià(
šode
->
i_pe
) {

821 
»t
 = 0;

822 
šode
->
i_pe
->
wr™”s
++;

825 
	`mu‹x_uÆock
(&
šode
->
i_mu‹x
);

827  
»t
;

828 
	}
}

831 
	$pe_rdwr_İ’
(
šode
 *šode, 
fe
 *
fp
)

833 
»t
 = -
ENOENT
;

835 
	`mu‹x_lock
(&
šode
->
i_mu‹x
);

837 ià(
šode
->
i_pe
) {

838 
»t
 = 0;

839 ià(
fp
->
f_mode
 & 
FMODE_READ
)

840 
šode
->
i_pe
->
»ad”s
++;

841 ià(
fp
->
f_mode
 & 
FMODE_WRITE
)

842 
šode
->
i_pe
->
wr™”s
++;

845 
	`mu‹x_uÆock
(&
šode
->
i_mu‹x
);

847  
»t
;

848 
	}
}

856 cÚ¡ 
fe_İ”©iÚs
 
	g»ad_pefifo_fİs
 = {

857 .
Î£ek
 = 
no_Î£ek
,

858 .
	g»ad
 = 
do_sync_»ad
,

859 .
	gaio_»ad
 = 
pe_»ad
,

860 .
	gwr™e
 = 
bad_pe_w
,

861 .
	gpŞl
 = 
pe_pŞl
,

862 .
	guÆocked_ioùl
 = 
pe_ioùl
,

863 .
	gİ’
 = 
pe_»ad_İ’
,

864 .
	g»Ëa£
 = 
pe_»ad_»Ëa£
,

865 .
	gçsync
 = 
pe_»ad_çsync
,

868 cÚ¡ 
fe_İ”©iÚs
 
	gwr™e_pefifo_fİs
 = {

869 .
Î£ek
 = 
no_Î£ek
,

870 .
	g»ad
 = 
bad_pe_r
,

871 .
	gwr™e
 = 
do_sync_wr™e
,

872 .
	gaio_wr™e
 = 
pe_wr™e
,

873 .
	gpŞl
 = 
pe_pŞl
,

874 .
	guÆocked_ioùl
 = 
pe_ioùl
,

875 .
	gİ’
 = 
pe_wr™e_İ’
,

876 .
	g»Ëa£
 = 
pe_wr™e_»Ëa£
,

877 .
	gçsync
 = 
pe_wr™e_çsync
,

880 cÚ¡ 
fe_İ”©iÚs
 
	grdwr_pefifo_fİs
 = {

881 .
Î£ek
 = 
no_Î£ek
,

882 .
	g»ad
 = 
do_sync_»ad
,

883 .
	gaio_»ad
 = 
pe_»ad
,

884 .
	gwr™e
 = 
do_sync_wr™e
,

885 .
	gaio_wr™e
 = 
pe_wr™e
,

886 .
	gpŞl
 = 
pe_pŞl
,

887 .
	guÆocked_ioùl
 = 
pe_ioùl
,

888 .
	gİ’
 = 
pe_rdwr_İ’
,

889 .
	g»Ëa£
 = 
pe_rdwr_»Ëa£
,

890 .
	gçsync
 = 
pe_rdwr_çsync
,

893 
pe_šode_šfo
 * 
	$®loc_pe_šfo
(
šode
 *inode)

895 
pe_šode_šfo
 *
pe
;

897 
pe
 = 
	`kz®loc
((
pe_šode_šfo
), 
GFP_KERNEL
);

898 ià(
pe
) {

899 
pe
->
bufs
 = 
	`kz®loc
((
pe_bufãr
è* 
PIPE_DEF_BUFFERS
, 
GFP_KERNEL
);

900 ià(
pe
->
bufs
) {

901 
	`š™_wa™queue_h—d
(&
pe
->
wa™
);

902 
pe
->
r_couÁ”
 =…e->
w_couÁ”
 = 1;

903 
pe
->
šode
 = inode;

904 
pe
->
bufãrs
 = 
PIPE_DEF_BUFFERS
;

905  
pe
;

907 
	`kä“
(
pe
);

910  
NULL
;

911 
	}
}

913 
	$__ä“_pe_šfo
(
pe_šode_šfo
 *
pe
)

915 
i
;

917 
i
 = 0; i < 
pe
->
bufãrs
; i++) {

918 
pe_bufãr
 *
buf
 = 
pe
->
bufs
 + 
i
;

919 ià(
buf
->
İs
)

920 
buf
->
İs
->
	`»Ëa£
(
pe
, buf);

922 ià(
pe
->
tmp_·ge
)

923 
	`__ä“_·ge
(
pe
->
tmp_·ge
);

924 
	`kä“
(
pe
->
bufs
);

925 
	`kä“
(
pe
);

926 
	}
}

928 
	$ä“_pe_šfo
(
šode
 *inode)

930 
	`__ä“_pe_šfo
(
šode
->
i_pe
);

931 
šode
->
i_pe
 = 
NULL
;

932 
	}
}

934 
vfsmouÁ
 *
pe_mÁ
 
	g__»ad_mo¡ly
;

939 *
	$pefs_dÇme
(
d’Œy
 *d’Œy, *
bufãr
, 
buæ’
)

941  
	`dyÇmic_dÇme
(
d’Œy
, 
bufãr
, 
buæ’
, "pipe:[%lu]",

942 
d’Œy
->
d_šode
->
i_šo
);

943 
	}
}

945 cÚ¡ 
d’Œy_İ”©iÚs
 
	gpefs_d’Œy_İ”©iÚs
 = {

946 .
d_dÇme
 = 
pefs_dÇme
,

949 
šode
 * 
	$g‘_pe_šode
()

951 
šode
 *šodğ
	`Ãw_šode_p£udo
(
pe_mÁ
->
mÁ_sb
);

952 
pe_šode_šfo
 *
pe
;

954 ià(!
šode
)

955 
ç_šode
;

957 
šode
->
i_šo
 = 
	`g‘_Ãxt_šo
();

959 
pe
 = 
	`®loc_pe_šfo
(
šode
);

960 ià(!
pe
)

961 
ç_ut
;

962 
šode
->
i_pe
 = 
pe
;

964 
pe
->
»ad”s
 =…e->
wr™”s
 = 1;

965 
šode
->
i_fİ
 = &
rdwr_pefifo_fİs
;

973 
šode
->
i_¡©e
 = 
I_DIRTY
;

974 
šode
->
i_mode
 = 
S_IFIFO
 | 
S_IRUSR
 | 
S_IWUSR
;

975 
šode
->
i_uid
 = 
	`cu¼’t_fsuid
();

976 
šode
->
i_gid
 = 
	`cu¼’t_fsgid
();

977 
šode
->
i_©ime
 = inode->
i_mtime
 = inode->
i_ùime
 = 
CURRENT_TIME
;

979  
šode
;

981 
ç_ut
:

982 
	`ut
(
šode
);

984 
ç_šode
:

985  
NULL
;

986 
	}
}

988 
fe
 *
	$ü—‹_wr™e_pe
(
æags
)

990 
”r
;

991 
šode
 *inode;

992 
fe
 *
f
;

993 
·th
…ath;

994 
q¡r
 
Çme
 = { .name = "" };

996 
”r
 = -
ENFILE
;

997 
šode
 = 
	`g‘_pe_šode
();

998 ià(!
šode
)

999 
”r
;

1001 
”r
 = -
ENOMEM
;

1002 
·th
.
d’Œy
 = 
	`d_®loc_p£udo
(
pe_mÁ
->
mÁ_sb
, &
Çme
);

1003 ià(!
·th
.
d’Œy
)

1004 
”r_šode
;

1005 
·th
.
mÁ
 = 
	`mÁg‘
(
pe_mÁ
);

1007 
	`d_š¡ªtŸ‹
(
·th
.
d’Œy
, 
šode
);

1009 
”r
 = -
ENFILE
;

1010 
f
 = 
	`®loc_fe
(&
·th
, 
FMODE_WRITE
, &
wr™e_pefifo_fİs
);

1011 ià(!
f
)

1012 
”r_d’Œy
;

1013 
f
->
f_m­pšg
 = 
šode
->
i_m­pšg
;

1015 
f
->
f_æags
 = 
O_WRONLY
 | (
æags
 & 
O_NONBLOCK
);

1016 
f
->
f_v”siÚ
 = 0;

1018  
f
;

1020 
”r_d’Œy
:

1021 
	`ä“_pe_šfo
(
šode
);

1022 
	`·th_put
(&
·th
);

1023  
	`ERR_PTR
(
”r
);

1025 
”r_šode
:

1026 
	`ä“_pe_šfo
(
šode
);

1027 
	`ut
(
šode
);

1028 
”r
:

1029  
	`ERR_PTR
(
”r
);

1030 
	}
}

1032 
	$ä“_wr™e_pe
(
fe
 *
f
)

1034 
	`ä“_pe_šfo
(
f
->
f_d’Œy
->
d_šode
);

1035 
	`·th_put
(&
f
->
f_·th
);

1036 
	`put_fp
(
f
);

1037 
	}
}

1039 
fe
 *
	$ü—‹_»ad_pe
(
fe
 *
wrf
, 
æags
)

1042 
fe
 *
f
 = 
	`®loc_fe
(&
wrf
->
f_·th
, 
FMODE_READ
,

1043 &
»ad_pefifo_fİs
);

1044 ià(!
f
)

1045  
	`ERR_PTR
(-
ENFILE
);

1047 
	`·th_g‘
(&
wrf
->
f_·th
);

1048 
f
->
f_æags
 = 
O_RDONLY
 | (
æags
 & 
O_NONBLOCK
);

1050  
f
;

1051 
	}
}

1053 
	$do_pe_æags
(*
fd
, 
æags
)

1055 
fe
 *
fw
, *
ä
;

1056 
”rÜ
;

1057 
fdw
, 
fdr
;

1059 ià(
æags
 & ~(
O_CLOEXEC
 | 
O_NONBLOCK
))

1060  -
EINVAL
;

1062 
fw
 = 
	`ü—‹_wr™e_pe
(
æags
);

1063 ià(
	`IS_ERR
(
fw
))

1064  
	`PTR_ERR
(
fw
);

1065 
ä
 = 
	`ü—‹_»ad_pe
(
fw
, 
æags
);

1066 
”rÜ
 = 
	`PTR_ERR
(
ä
);

1067 ià(
	`IS_ERR
(
ä
))

1068 
”r_wr™e_pe
;

1070 
”rÜ
 = 
	`g‘_unu£d_fd_æags
(
æags
);

1071 ià(
”rÜ
 < 0)

1072 
”r_»ad_pe
;

1073 
fdr
 = 
”rÜ
;

1075 
”rÜ
 = 
	`g‘_unu£d_fd_æags
(
æags
);

1076 ià(
”rÜ
 < 0)

1077 
”r_fdr
;

1078 
fdw
 = 
”rÜ
;

1080 
	`aud™_fd_·œ
(
fdr
, 
fdw
);

1081 
	`fd_š¡®l
(
fdr
, 
ä
);

1082 
	`fd_š¡®l
(
fdw
, 
fw
);

1083 
fd
[0] = 
fdr
;

1084 
fd
[1] = 
fdw
;

1088 
”r_fdr
:

1089 
	`put_unu£d_fd
(
fdr
);

1090 
”r_»ad_pe
:

1091 
	`·th_put
(&
ä
->
f_·th
);

1092 
	`put_fp
(
ä
);

1093 
”r_wr™e_pe
:

1094 
	`ä“_wr™e_pe
(
fw
);

1095  
”rÜ
;

1096 
	}
}

1102 
	$SYSCALL_DEFINE2
(
pe2
, 
__u£r
 *, 
fdes
, , 
æags
)

1104 
fd
[2];

1105 
”rÜ
;

1107 
”rÜ
 = 
	`do_pe_æags
(
fd
, 
æags
);

1108 ià(!
”rÜ
) {

1109 ià(
	`cİy_to_u£r
(
fdes
, 
fd
, (fd))) {

1110 
	`sys_şo£
(
fd
[0]);

1111 
	`sys_şo£
(
fd
[1]);

1112 
”rÜ
 = -
EFAULT
;

1115  
”rÜ
;

1116 
	}
}

1118 
	$SYSCALL_DEFINE1
(
pe
, 
__u£r
 *, 
fdes
)

1120  
	`sys_pe2
(
fdes
, 0);

1121 
	}
}

1127 
	$pe_£t_size
(
pe_šode_šfo
 *
pe
, 
Ä_·ges
)

1129 
pe_bufãr
 *
bufs
;

1137 ià(
Ä_·ges
 < 
pe
->
Äbufs
)

1138  -
EBUSY
;

1140 
bufs
 = 
	`kÿÎoc
(
Ä_·ges
, (
pe_bufãr
), 
GFP_KERNEL
);

1141 ià(
	`uÆik–y
(!
bufs
))

1142  -
ENOMEM
;

1148 ià(
pe
->
Äbufs
) {

1149 

;

1150 
h—d
;

1152 

 = 
pe
->
curbuf
 +…e->
Äbufs
;

1153 ià(

 < 
pe
->
bufãrs
)

1154 

 = 0;

1156 

 &ğ(
pe
->
bufãrs
 - 1);

1158 
h—d
 = 
pe
->
Äbufs
 - 

;

1159 ià(
h—d
)

1160 
	`memıy
(
bufs
, 
pe
->buf +…e->
curbuf
, 
h—d
 * (
pe_bufãr
));

1161 ià(

)

1162 
	`memıy
(
bufs
 + 
h—d
, 
pe
->bufs, 

 * (
pe_bufãr
));

1165 
pe
->
curbuf
 = 0;

1166 
	`kä“
(
pe
->
bufs
);

1167 
pe
->
bufs
 = bufs;

1168 
pe
->
bufãrs
 = 
Ä_·ges
;

1169  
Ä_·ges
 * 
PAGE_SIZE
;

1170 
	}
}

1176 
šlše
 
	$round_pe_size
(
size
)

1178 
Ä_·ges
;

1180 
Ä_·ges
 = (
size
 + 
PAGE_SIZE
 - 1è>> 
PAGE_SHIFT
;

1181  
	`roundup_pow_of_two
(
Ä_·ges
è<< 
PAGE_SHIFT
;

1182 
	}
}

1188 
	$pe_´oc_â
(
ùl_bË
 *
bË
, 
wr™e
, 
__u£r
 *
buf
,

1189 
size_t
 *
ËÅ
, 
loff_t
 *
µos
)

1191 
»t
;

1193 
»t
 = 
	`´oc_doštvec_mšmax
(
bË
, 
wr™e
, 
buf
, 
ËÅ
, 
µos
);

1194 ià(
»t
 < 0 || !
wr™e
)

1195  
»t
;

1197 
pe_max_size
 = 
	`round_pe_size
(pipe_max_size);

1198  
»t
;

1199 
	}
}

1206 
pe_šode_šfo
 *
	$g‘_pe_šfo
(
fe
 *file)

1208 
šode
 *
i
 = 
fe
->
f_·th
.
d’Œy
->
d_šode
;

1210  
	`S_ISFIFO
(
i
->
i_mode
è? i->
i_pe
 : 
NULL
;

1211 
	}
}

1213 
	$pe_fú
(
fe
 *fe, 
cmd
, 
¬g
)

1215 
pe_šode_šfo
 *
pe
;

1216 
»t
;

1218 
pe
 = 
	`g‘_pe_šfo
(
fe
);

1219 ià(!
pe
)

1220  -
EBADF
;

1222 
	`mu‹x_lock
(&
pe
->
šode
->
i_mu‹x
);

1224 
cmd
) {

1225 
F_SETPIPE_SZ
: {

1226 
size
, 
Ä_·ges
;

1228 
size
 = 
	`round_pe_size
(
¬g
);

1229 
Ä_·ges
 = 
size
 >> 
PAGE_SHIFT
;

1231 
»t
 = -
EINVAL
;

1232 ià(!
Ä_·ges
)

1233 
out
;

1235 ià(!
	`ÿ·bË
(
CAP_SYS_RESOURCE
è&& 
size
 > 
pe_max_size
) {

1236 
»t
 = -
EPERM
;

1237 
out
;

1239 
»t
 = 
	`pe_£t_size
(
pe
, 
Ä_·ges
);

1242 
F_GETPIPE_SZ
:

1243 
»t
 = 
pe
->
bufãrs
 * 
PAGE_SIZE
;

1246 
»t
 = -
EINVAL
;

1250 
out
:

1251 
	`mu‹x_uÆock
(&
pe
->
šode
->
i_mu‹x
);

1252  
»t
;

1253 
	}
}

1255 cÚ¡ 
su³r_İ”©iÚs
 
	gpefs_İs
 = {

1256 .
de¡roy_šode
 = 
ä“_šode_nÚrcu
,

1257 .
	g¡©fs
 = 
sim¶e_¡©fs
,

1266 
d’Œy
 *
	$pefs_mouÁ
(
fe_sy¡em_ty³
 *
fs_ty³
,

1267 
æags
, cÚ¡ *
dev_Çme
, *
d©a
)

1269  
	`mouÁ_p£udo
(
fs_ty³
, "pe:", &
pefs_İs
,

1270 &
pefs_d’Œy_İ”©iÚs
, 
PIPEFS_MAGIC
);

1271 
	}
}

1273 
fe_sy¡em_ty³
 
	gpe_fs_ty³
 = {

1274 .
Çme
 = "pipefs",

1275 .
	gmouÁ
 = 
pefs_mouÁ
,

1276 .
	gkl_sb
 = 
kl_ªÚ_su³r
,

1279 
__š™
 
	$š™_pe_fs
()

1281 
”r
 = 
	`»gi¡”_fesy¡em
(&
pe_fs_ty³
);

1283 ià(!
”r
) {

1284 
pe_mÁ
 = 
	`k”n_mouÁ
(&
pe_fs_ty³
);

1285 ià(
	`IS_ERR
(
pe_mÁ
)) {

1286 
”r
 = 
	`PTR_ERR
(
pe_mÁ
);

1287 
	`uÄegi¡”_fesy¡em
(&
pe_fs_ty³
);

1290  
”r
;

1291 
	}
}

1293 
__ex™
 
	$ex™_pe_fs
()

1295 
	`k”n_unmouÁ
(
pe_mÁ
);

1296 
	`uÄegi¡”_fesy¡em
(&
pe_fs_ty³
);

1297 
	}
}

1299 
fs_š™ÿÎ
(
š™_pe_fs
);

1300 
moduË_ex™
(
ex™_pe_fs
);

	@pnode.c

9 
	~<lšux/mÁ_Çme¥aû.h
>

10 
	~<lšux/mouÁ.h
>

11 
	~<lšux/fs.h
>

12 
	~"š‹º®.h
"

13 
	~"²ode.h
"

16 
šlše
 
vfsmouÁ
 *
	$Ãxt_³”
(
vfsmouÁ
 *
p
)

18  
	`li¡_’Œy
(
p
->
mÁ_sh¬e
.
Ãxt
, 
vfsmouÁ
, mnt_share);

19 
	}
}

21 
šlše
 
vfsmouÁ
 *
	$fœ¡_¦ave
(
vfsmouÁ
 *
p
)

23  
	`li¡_’Œy
(
p
->
mÁ_¦ave_li¡
.
Ãxt
, 
vfsmouÁ
, 
mÁ_¦ave
);

24 
	}
}

26 
šlše
 
vfsmouÁ
 *
	$Ãxt_¦ave
(
vfsmouÁ
 *
p
)

28  
	`li¡_’Œy
(
p
->
mÁ_¦ave
.
Ãxt
, 
vfsmouÁ
, mnt_slave);

29 
	}
}

36 
boŞ
 
	$is_·th_»achabË
(
vfsmouÁ
 *
mÁ
, 
d’Œy
 *dentry,

37 cÚ¡ 
·th
 *
roÙ
)

39 
mÁ
 !ğ
roÙ
->mÁ && mÁ->
mÁ_·»Á
 != mnt) {

40 
d’Œy
 = 
mÁ
->
mÁ_mouÁpošt
;

41 
mÁ
 = mÁ->
mÁ_·»Á
;

43  
mÁ
 =ğ
roÙ
->mÁ && 
	`is_subdœ
(
d’Œy
,„oot->dentry);

44 
	}
}

46 
vfsmouÁ
 *
	$g‘_³”_und”_roÙ
(
vfsmouÁ
 *
mÁ
,

47 
mÁ_Çme¥aû
 *
ns
,

48 cÚ¡ 
·th
 *
roÙ
)

50 
vfsmouÁ
 *
m
 = 
mÁ
;

54 ià(
m
->
mÁ_ns
 =ğ
ns
 && 
	`is_·th_»achabË
(m, m->
mÁ_roÙ
, 
roÙ
))

55  
m
;

57 
m
 = 
	`Ãxt_³”
(m);

58 } 
m
 !ğ
mÁ
);

60  
NULL
;

61 
	}
}

69 
	$g‘_domš©šg_id
(
vfsmouÁ
 *
mÁ
, cÚ¡ 
·th
 *
roÙ
)

71 
vfsmouÁ
 *
m
;

73 
m
 = 
mÁ
->
mÁ_ma¡”
; m !ğ
NULL
; m = m->mnt_master) {

74 
vfsmouÁ
 *
d
 = 
	`g‘_³”_und”_roÙ
(
m
, 
mÁ
->
mÁ_ns
, 
roÙ
);

75 ià(
d
)

76  
d
->
mÁ_group_id
;

80 
	}
}

82 
	$do_make_¦ave
(
vfsmouÁ
 *
mÁ
)

84 
vfsmouÁ
 *
³”_mÁ
 = 
mÁ
, *
ma¡”
 = mÁ->
mÁ_ma¡”
;

85 
vfsmouÁ
 *
¦ave_mÁ
;

92 (
³”_mÁ
 = 
	`Ãxt_³”
Õ“r_mÁ)è!ğ
mÁ
 &&

93 
³”_mÁ
->
mÁ_roÙ
 !ğ
mÁ
->mnt_root) ;

95 ià(
³”_mÁ
 =ğ
mÁ
) {

96 
³”_mÁ
 = 
	`Ãxt_³”
(
mÁ
);

97 ià(
³”_mÁ
 =ğ
mÁ
)

98 
³”_mÁ
 = 
NULL
;

100 ià(
	`IS_MNT_SHARED
(
mÁ
è&& 
	`li¡_em±y
(&mÁ->
mÁ_sh¬e
))

101 
	`mÁ_»Ëa£_group_id
(
mÁ
);

103 
	`li¡_d–_š™
(&
mÁ
->
mÁ_sh¬e
);

104 
mÁ
->
mÁ_group_id
 = 0;

106 ià(
³”_mÁ
)

107 
ma¡”
 = 
³”_mÁ
;

109 ià(
ma¡”
) {

110 
	`li¡_fÜ_—ch_’Œy
(
¦ave_mÁ
, &
mÁ
->
mÁ_¦ave_li¡
, 
mÁ_¦ave
)

111 
¦ave_mÁ
->
mÁ_ma¡”
 = 
ma¡”
;

112 
	`li¡_move
(&
mÁ
->
mÁ_¦ave
, &
ma¡”
->
mÁ_¦ave_li¡
);

113 
	`li¡_¥liû
(&
mÁ
->
mÁ_¦ave_li¡
, 
ma¡”
->mÁ_¦ave_li¡.
´ev
);

114 
	`INIT_LIST_HEAD
(&
mÁ
->
mÁ_¦ave_li¡
);

116 
li¡_h—d
 *
p
 = &
mÁ
->
mÁ_¦ave_li¡
;

117 !
	`li¡_em±y
(
p
)) {

118 
¦ave_mÁ
 = 
	`li¡_fœ¡_’Œy
(
p
,

119 
vfsmouÁ
, 
mÁ_¦ave
);

120 
	`li¡_d–_š™
(&
¦ave_mÁ
->
mÁ_¦ave
);

121 
¦ave_mÁ
->
mÁ_ma¡”
 = 
NULL
;

124 
mÁ
->
mÁ_ma¡”
 = 
ma¡”
;

125 
	`CLEAR_MNT_SHARED
(
mÁ
);

127 
	}
}

132 
	$chªge_mÁ_´İag©iÚ
(
vfsmouÁ
 *
mÁ
, 
ty³
)

134 ià(
ty³
 =ğ
MS_SHARED
) {

135 
	`£t_mÁ_sh¬ed
(
mÁ
);

138 
	`do_make_¦ave
(
mÁ
);

139 ià(
ty³
 !ğ
MS_SLAVE
) {

140 
	`li¡_d–_š™
(&
mÁ
->
mÁ_¦ave
);

141 
mÁ
->
mÁ_ma¡”
 = 
NULL
;

142 ià(
ty³
 =ğ
MS_UNBINDABLE
)

143 
mÁ
->
mÁ_æags
 |ğ
MNT_UNBINDABLE
;

145 
mÁ
->
mÁ_æags
 &ğ~
MNT_UNBINDABLE
;

147 
	}
}

159 
vfsmouÁ
 *
	$´İag©iÚ_Ãxt
(
vfsmouÁ
 *
m
,

160 
vfsmouÁ
 *
Üigš
)

163 ià(!
	`IS_MNT_NEW
(
m
è&& !
	`li¡_em±y
(&m->
mÁ_¦ave_li¡
))

164  
	`fœ¡_¦ave
(
m
);

167 
vfsmouÁ
 *
Ãxt
;

168 
vfsmouÁ
 *
ma¡”
 = 
m
->
mÁ_ma¡”
;

170 ià(
ma¡”
 =ğ
Üigš
->
mÁ_ma¡”
) {

171 
Ãxt
 = 
	`Ãxt_³”
(
m
);

172  ((
Ãxt
 =ğ
Üigš
è? 
NULL
 :‚ext);

173 } ià(
m
->
mÁ_¦ave
.
Ãxt
 !ğ&
ma¡”
->
mÁ_¦ave_li¡
)

174  
	`Ãxt_¦ave
(
m
);

177 
m
 = 
ma¡”
;

179 
	}
}

190 
vfsmouÁ
 *
	$g‘_sourû
(
vfsmouÁ
 *
de¡
,

191 
vfsmouÁ
 *
Ï¡_de¡
,

192 
vfsmouÁ
 *
Ï¡_¤c
,

193 *
ty³
)

195 
vfsmouÁ
 *
p_Ï¡_¤c
 = 
NULL
;

196 
vfsmouÁ
 *
p_Ï¡_de¡
 = 
NULL
;

198 
Ï¡_de¡
 !ğ
de¡
->
mÁ_ma¡”
) {

199 
p_Ï¡_de¡
 = 
Ï¡_de¡
;

200 
p_Ï¡_¤c
 = 
Ï¡_¤c
;

201 
Ï¡_de¡
 =†a¡_de¡->
mÁ_ma¡”
;

202 
Ï¡_¤c
 =†a¡_¤c->
mÁ_ma¡”
;

205 ià(
p_Ï¡_de¡
) {

207 
p_Ï¡_de¡
 = 
	`Ãxt_³”
(p_last_dest);

208 } 
	`IS_MNT_NEW
(
p_Ï¡_de¡
));

210 ià(
de¡
 =ğ
p_Ï¡_de¡
) {

211 *
ty³
 = 
CL_MAKE_SHARED
;

212  
p_Ï¡_¤c
;

216 *
ty³
 = 
CL_SLAVE
;

218 ià(
	`IS_MNT_SHARED
(
de¡
))

219 *
ty³
 |ğ
CL_MAKE_SHARED
;

220  
Ï¡_¤c
;

221 
	}
}

236 
	$´İag©e_mÁ
(
vfsmouÁ
 *
de¡_mÁ
, 
d’Œy
 *
de¡_d’Œy
,

237 
vfsmouÁ
 *
sourû_mÁ
, 
li¡_h—d
 *
Œ“_li¡
)

239 
vfsmouÁ
 *
m
, *
chd
;

240 
»t
 = 0;

241 
vfsmouÁ
 *
´ev_de¡_mÁ
 = 
de¡_mÁ
;

242 
vfsmouÁ
 *
´ev_¤c_mÁ
 = 
sourû_mÁ
;

243 
	`LIST_HEAD
(
tmp_li¡
);

244 
	`LIST_HEAD
(
umouÁ_li¡
);

246 
m
 = 
	`´İag©iÚ_Ãxt
(
de¡_mÁ
, dest_mnt); m;

247 
m
 = 
	`´İag©iÚ_Ãxt
(m, 
de¡_mÁ
)) {

248 
ty³
;

249 
vfsmouÁ
 *
sourû
;

251 ià(
	`IS_MNT_NEW
(
m
))

254 
sourû
 = 
	`g‘_sourû
(
m
, 
´ev_de¡_mÁ
, 
´ev_¤c_mÁ
, &
ty³
);

256 ià(!(
chd
 = 
	`cİy_Œ“
(
sourû
, sourû->
mÁ_roÙ
, 
ty³
))) {

257 
»t
 = -
ENOMEM
;

258 
	`li¡_¥liû
(
Œ“_li¡
, 
tmp_li¡
.
´ev
);

259 
out
;

262 ià(
	`is_subdœ
(
de¡_d’Œy
, 
m
->
mÁ_roÙ
)) {

263 
	`mÁ_£t_mouÁpošt
(
m
, 
de¡_d’Œy
, 
chd
);

264 
	`li¡_add_
(&
chd
->
mÁ_hash
, 
Œ“_li¡
);

270 
	`li¡_add_
(&
chd
->
mÁ_hash
, &
tmp_li¡
);

272 
´ev_de¡_mÁ
 = 
m
;

273 
´ev_¤c_mÁ
 = 
chd
;

275 
out
:

276 
	`br_wr™e_lock
(
vfsmouÁ_lock
);

277 !
	`li¡_em±y
(&
tmp_li¡
)) {

278 
chd
 = 
	`li¡_fœ¡_’Œy
(&
tmp_li¡
, 
vfsmouÁ
, 
mÁ_hash
);

279 
	`umouÁ_Œ“
(
chd
, 0, &
umouÁ_li¡
);

281 
	`br_wr™e_uÆock
(
vfsmouÁ_lock
);

282 
	`»Ëa£_mouÁs
(&
umouÁ_li¡
);

283  
»t
;

284 
	}
}

289 
šlše
 
	$do_»fcouÁ_check
(
vfsmouÁ
 *
mÁ
, 
couÁ
)

291 
mycouÁ
 = 
	`mÁ_g‘_couÁ
(
mÁ
è- mÁ->
mÁ_gho¡s
;

292  (
mycouÁ
 > 
couÁ
);

293 
	}
}

305 
	$´İag©e_mouÁ_busy
(
vfsmouÁ
 *
mÁ
, 
»fút
)

307 
vfsmouÁ
 *
m
, *
chd
;

308 
vfsmouÁ
 *
·»Á
 = 
mÁ
->
mÁ_·»Á
;

309 
»t
 = 0;

311 ià(
mÁ
 =ğ
·»Á
)

312  
	`do_»fcouÁ_check
(
mÁ
, 
»fút
);

319 ià(!
	`li¡_em±y
(&
mÁ
->
mÁ_mouÁs
è|| 
	`do_»fcouÁ_check
(mÁ, 
»fút
))

322 
m
 = 
	`´İag©iÚ_Ãxt
(
·»Á
,…arent); m;

323 
m
 = 
	`´İag©iÚ_Ãxt
(m, 
·»Á
)) {

324 
chd
 = 
	`__lookup_mÁ
(
m
, 
mÁ
->
mÁ_mouÁpošt
, 0);

325 ià(
chd
 && 
	`li¡_em±y
(&chd->
mÁ_mouÁs
) &&

326 (
»t
 = 
	`do_»fcouÁ_check
(
chd
, 1)))

329  
»t
;

330 
	}
}

336 
	$__´İag©e_umouÁ
(
vfsmouÁ
 *
mÁ
)

338 
vfsmouÁ
 *
·»Á
 = 
mÁ
->
mÁ_·»Á
;

339 
vfsmouÁ
 *
m
;

341 
	`BUG_ON
(
·»Á
 =ğ
mÁ
);

343 
m
 = 
	`´İag©iÚ_Ãxt
(
·»Á
,…arent); m;

344 
m
 = 
	`´İag©iÚ_Ãxt
(m, 
·»Á
)) {

346 
vfsmouÁ
 *
chd
 = 
	`__lookup_mÁ
(
m
,

347 
mÁ
->
mÁ_mouÁpošt
, 0);

352 ià(
chd
 && 
	`li¡_em±y
(&chd->
mÁ_mouÁs
))

353 
	`li¡_move_
(&
chd
->
mÁ_hash
, &
mÁ
->mnt_hash);

355 
	}
}

364 
	$´İag©e_umouÁ
(
li¡_h—d
 *
li¡
)

366 
vfsmouÁ
 *
mÁ
;

368 
	`li¡_fÜ_—ch_’Œy
(
mÁ
, 
li¡
, 
mÁ_hash
)

369 
	`__´İag©e_umouÁ
(
mÁ
);

371 
	}
}

	@pnode.h

8 #iâdeà
_LINUX_PNODE_H


9 
	#_LINUX_PNODE_H


	)

11 
	~<lšux/li¡.h
>

12 
	~<lšux/mouÁ.h
>

14 
	#IS_MNT_SHARED
(
mÁ
è(mÁ->
mÁ_æags
 & 
MNT_SHARED
)

	)

15 
	#IS_MNT_SLAVE
(
mÁ
è(mÁ->
mÁ_ma¡”
)

	)

16 
	#IS_MNT_NEW
(
mÁ
è(!mÁ->
mÁ_ns
)

	)

17 
	#CLEAR_MNT_SHARED
(
mÁ
è(mÁ->
mÁ_æags
 &ğ~
MNT_SHARED
)

	)

18 
	#IS_MNT_UNBINDABLE
(
mÁ
è(mÁ->
mÁ_æags
 & 
MNT_UNBINDABLE
)

	)

20 
	#CL_EXPIRE
 0x01

	)

21 
	#CL_SLAVE
 0x02

	)

22 
	#CL_COPY_ALL
 0x04

	)

23 
	#CL_MAKE_SHARED
 0x08

	)

24 
	#CL_PRIVATE
 0x10

	)

26 
šlše
 
	$£t_mÁ_sh¬ed
(
vfsmouÁ
 *
mÁ
)

28 
mÁ
->
mÁ_æags
 &ğ~
MNT_SHARED_MASK
;

29 
mÁ
->
mÁ_æags
 |ğ
MNT_SHARED
;

30 
	}
}

32 
chªge_mÁ_´İag©iÚ
(
vfsmouÁ
 *, );

33 
´İag©e_mÁ
(
vfsmouÁ
 *, 
d’Œy
 *, vfsmount *,

34 
li¡_h—d
 *);

35 
´İag©e_umouÁ
(
li¡_h—d
 *);

36 
´İag©e_mouÁ_busy
(
vfsmouÁ
 *, );

37 
mÁ_»Ëa£_group_id
(
vfsmouÁ
 *);

38 
g‘_domš©šg_id
(
vfsmouÁ
 *
mÁ
, cÚ¡ 
·th
 *
roÙ
);

	@posix_acl.c

15 
	~<lšux/k”Ãl.h
>

16 
	~<lšux/¦ab.h
>

17 
	~<lšux/©omic.h
>

18 
	~<lšux/fs.h
>

19 
	~<lšux/sched.h
>

20 
	~<lšux/posix_aş.h
>

21 
	~<lšux/moduË.h
>

23 
	~<lšux/”ºo.h
>

25 
EXPORT_SYMBOL
(
posix_aş_š™
);

26 
EXPORT_SYMBOL
(
posix_aş_®loc
);

27 
EXPORT_SYMBOL
(
posix_aş_v®id
);

28 
EXPORT_SYMBOL
(
posix_aş_equiv_mode
);

29 
EXPORT_SYMBOL
(
posix_aş_äom_mode
);

35 
	$posix_aş_š™
(
posix_aş
 *
aş
, 
couÁ
)

37 
	`©omic_£t
(&
aş
->
a_»fcouÁ
, 1);

38 
aş
->
a_couÁ
 = 
couÁ
;

39 
	}
}

44 
posix_aş
 *

45 
	$posix_aş_®loc
(
couÁ
, 
gå_t
 
æags
)

47 cÚ¡ 
size_t
 
size
 = (
posix_aş
) +

48 
couÁ
 * (
posix_aş_’Œy
);

49 
posix_aş
 *
aş
 = 
	`km®loc
(
size
, 
æags
);

50 ià(
aş
)

51 
	`posix_aş_š™
(
aş
, 
couÁ
);

52  
aş
;

53 
	}
}

58 
posix_aş
 *

59 
	$posix_aş_şÚe
(cÚ¡ 
posix_aş
 *
aş
, 
gå_t
 
æags
)

61 
posix_aş
 *
şÚe
 = 
NULL
;

63 ià(
aş
) {

64 
size
 = (
posix_aş
è+ 
aş
->
a_couÁ
 *

65 (
posix_aş_’Œy
);

66 
şÚe
 = 
	`kmemdup
(
aş
, 
size
, 
æags
);

67 ià(
şÚe
)

68 
	`©omic_£t
(&
şÚe
->
a_»fcouÁ
, 1);

70  
şÚe
;

71 
	}
}

77 
	$posix_aş_v®id
(cÚ¡ 
posix_aş
 *
aş
)

79 cÚ¡ 
posix_aş_’Œy
 *
·
, *
³
;

80 
¡©e
 = 
ACL_USER_OBJ
;

81 
id
 = 0;

82 
Ãeds_mask
 = 0;

84 
	`FOREACH_ACL_ENTRY
(
·
, 
aş
, 
³
) {

85 ià(
·
->
e_³rm
 & ~(
ACL_READ
|
ACL_WRITE
|
ACL_EXECUTE
))

86  -
EINVAL
;

87 
·
->
e_g
) {

88 
ACL_USER_OBJ
:

89 ià(
¡©e
 =ğ
ACL_USER_OBJ
) {

90 
id
 = 0;

91 
¡©e
 = 
ACL_USER
;

94  -
EINVAL
;

96 
ACL_USER
:

97 ià(
¡©e
 !ğ
ACL_USER
)

98  -
EINVAL
;

99 ià(
·
->
e_id
 =ğ
ACL_UNDEFINED_ID
 ||

100 
·
->
e_id
 < 
id
)

101  -
EINVAL
;

102 
id
 = 
·
->
e_id
 + 1;

103 
Ãeds_mask
 = 1;

106 
ACL_GROUP_OBJ
:

107 ià(
¡©e
 =ğ
ACL_USER
) {

108 
id
 = 0;

109 
¡©e
 = 
ACL_GROUP
;

112  -
EINVAL
;

114 
ACL_GROUP
:

115 ià(
¡©e
 !ğ
ACL_GROUP
)

116  -
EINVAL
;

117 ià(
·
->
e_id
 =ğ
ACL_UNDEFINED_ID
 ||

118 
·
->
e_id
 < 
id
)

119  -
EINVAL
;

120 
id
 = 
·
->
e_id
 + 1;

121 
Ãeds_mask
 = 1;

124 
ACL_MASK
:

125 ià(
¡©e
 !ğ
ACL_GROUP
)

126  -
EINVAL
;

127 
¡©e
 = 
ACL_OTHER
;

130 
ACL_OTHER
:

131 ià(
¡©e
 =ğ
ACL_OTHER
 ||

132 (
¡©e
 =ğ
ACL_GROUP
 && !
Ãeds_mask
)) {

133 
¡©e
 = 0;

136  -
EINVAL
;

139  -
EINVAL
;

142 ià(
¡©e
 == 0)

144  -
EINVAL
;

145 
	}
}

152 
	$posix_aş_equiv_mode
(cÚ¡ 
posix_aş
 *
aş
, 
umode_t
 *
mode_p
)

154 cÚ¡ 
posix_aş_’Œy
 *
·
, *
³
;

155 
umode_t
 
mode
 = 0;

156 
nÙ_equiv
 = 0;

158 
	`FOREACH_ACL_ENTRY
(
·
, 
aş
, 
³
) {

159 
·
->
e_g
) {

160 
ACL_USER_OBJ
:

161 
mode
 |ğ(
·
->
e_³rm
 & 
S_IRWXO
) << 6;

163 
ACL_GROUP_OBJ
:

164 
mode
 |ğ(
·
->
e_³rm
 & 
S_IRWXO
) << 3;

166 
ACL_OTHER
:

167 
mode
 |ğ
·
->
e_³rm
 & 
S_IRWXO
;

169 
ACL_MASK
:

170 
mode
 = (mod& ~
S_IRWXG
) |

171 ((
·
->
e_³rm
 & 
S_IRWXO
) << 3);

172 
nÙ_equiv
 = 1;

174 
ACL_USER
:

175 
ACL_GROUP
:

176 
nÙ_equiv
 = 1;

179  -
EINVAL
;

182 ià(
mode_p
)

183 *
mode_p
 = (*mode_°& ~
S_IRWXUGO
è| 
mode
;

184  
nÙ_equiv
;

185 
	}
}

190 
posix_aş
 *

191 
	$posix_aş_äom_mode
(
umode_t
 
mode
, 
gå_t
 
æags
)

193 
posix_aş
 *
aş
 = 
	`posix_aş_®loc
(3, 
æags
);

194 ià(!
aş
)

195  
	`ERR_PTR
(-
ENOMEM
);

197 
aş
->
a_’Œ›s
[0].
e_g
 = 
ACL_USER_OBJ
;

198 
aş
->
a_’Œ›s
[0].
e_id
 = 
ACL_UNDEFINED_ID
;

199 
aş
->
a_’Œ›s
[0].
e_³rm
 = (
mode
 & 
S_IRWXU
) >> 6;

201 
aş
->
a_’Œ›s
[1].
e_g
 = 
ACL_GROUP_OBJ
;

202 
aş
->
a_’Œ›s
[1].
e_id
 = 
ACL_UNDEFINED_ID
;

203 
aş
->
a_’Œ›s
[1].
e_³rm
 = (
mode
 & 
S_IRWXG
) >> 3;

205 
aş
->
a_’Œ›s
[2].
e_g
 = 
ACL_OTHER
;

206 
aş
->
a_’Œ›s
[2].
e_id
 = 
ACL_UNDEFINED_ID
;

207 
aş
->
a_’Œ›s
[2].
e_³rm
 = (
mode
 & 
S_IRWXO
);

208  
aş
;

209 
	}
}

216 
	$posix_aş_³rmissiÚ
(
šode
 *šode, cÚ¡ 
posix_aş
 *
aş
, 
wªt
)

218 cÚ¡ 
posix_aş_’Œy
 *
·
, *
³
, *
mask_obj
;

219 
found
 = 0;

221 
wªt
 &ğ
MAY_READ
 | 
MAY_WRITE
 | 
MAY_EXEC
 | 
MAY_NOT_BLOCK
;

223 
	`FOREACH_ACL_ENTRY
(
·
, 
aş
, 
³
) {

224 
·
->
e_g
) {

225 
ACL_USER_OBJ
:

227 ià(
šode
->
i_uid
 =ğ
	`cu¼’t_fsuid
())

228 
check_³rm
;

230 
ACL_USER
:

231 ià(
·
->
e_id
 =ğ
	`cu¼’t_fsuid
())

232 
mask
;

234 
ACL_GROUP_OBJ
:

235 ià(
	`š_group_p
(
šode
->
i_gid
)) {

236 
found
 = 1;

237 ià((
·
->
e_³rm
 & 
wªt
) == want)

238 
mask
;

241 
ACL_GROUP
:

242 ià(
	`š_group_p
(
·
->
e_id
)) {

243 
found
 = 1;

244 ià((
·
->
e_³rm
 & 
wªt
) == want)

245 
mask
;

248 
ACL_MASK
:

250 
ACL_OTHER
:

251 ià(
found
)

252  -
EACCES
;

254 
check_³rm
;

256  -
EIO
;

259  -
EIO
;

261 
mask
:

262 
mask_obj
 = 
·
+1; mask_obj !ğ
³
; mask_obj++) {

263 ià(
mask_obj
->
e_g
 =ğ
ACL_MASK
) {

264 ià((
·
->
e_³rm
 & 
mask_obj
->e_³rm & 
wªt
) == want)

266  -
EACCES
;

270 
check_³rm
:

271 ià((
·
->
e_³rm
 & 
wªt
) == want)

273  -
EACCES
;

274 
	}
}

284 
	$posix_aş_ü—‹_masq
(
posix_aş
 *
aş
, 
umode_t
 *
mode_p
)

286 
posix_aş_’Œy
 *
·
, *
³
;

287 
posix_aş_’Œy
 *
group_obj
 = 
NULL
, *
mask_obj
 = NULL;

288 
umode_t
 
mode
 = *
mode_p
;

289 
nÙ_equiv
 = 0;

293 
	`FOREACH_ACL_ENTRY
(
·
, 
aş
, 
³
) {

294 
·
->
e_g
) {

295 
ACL_USER_OBJ
:

296 
·
->
e_³rm
 &ğ(
mode
 >> 6è| ~
S_IRWXO
;

297 
mode
 &ğ(
·
->
e_³rm
 << 6è| ~
S_IRWXU
;

300 
ACL_USER
:

301 
ACL_GROUP
:

302 
nÙ_equiv
 = 1;

305 
ACL_GROUP_OBJ
:

306 
group_obj
 = 
·
;

309 
ACL_OTHER
:

310 
·
->
e_³rm
 &ğ
mode
 | ~
S_IRWXO
;

311 
mode
 &ğ
·
->
e_³rm
 | ~
S_IRWXO
;

314 
ACL_MASK
:

315 
mask_obj
 = 
·
;

316 
nÙ_equiv
 = 1;

320  -
EIO
;

324 ià(
mask_obj
) {

325 
mask_obj
->
e_³rm
 &ğ(
mode
 >> 3è| ~
S_IRWXO
;

326 
mode
 &ğ(
mask_obj
->
e_³rm
 << 3è| ~
S_IRWXG
;

328 ià(!
group_obj
)

329  -
EIO
;

330 
group_obj
->
e_³rm
 &ğ(
mode
 >> 3è| ~
S_IRWXO
;

331 
mode
 &ğ(
group_obj
->
e_³rm
 << 3è| ~
S_IRWXG
;

334 *
mode_p
 = (*mode_°& ~
S_IRWXUGO
è| 
mode
;

335  
nÙ_equiv
;

336 
	}
}

341 
	$posix_aş_chmod_masq
(
posix_aş
 *
aş
, 
umode_t
 
mode
)

343 
posix_aş_’Œy
 *
group_obj
 = 
NULL
, *
mask_obj
 = NULL;

344 
posix_aş_’Œy
 *
·
, *
³
;

348 
	`FOREACH_ACL_ENTRY
(
·
, 
aş
, 
³
) {

349 
·
->
e_g
) {

350 
ACL_USER_OBJ
:

351 
·
->
e_³rm
 = (
mode
 & 
S_IRWXU
) >> 6;

354 
ACL_USER
:

355 
ACL_GROUP
:

358 
ACL_GROUP_OBJ
:

359 
group_obj
 = 
·
;

362 
ACL_MASK
:

363 
mask_obj
 = 
·
;

366 
ACL_OTHER
:

367 
·
->
e_³rm
 = (
mode
 & 
S_IRWXO
);

371  -
EIO
;

375 ià(
mask_obj
) {

376 
mask_obj
->
e_³rm
 = (
mode
 & 
S_IRWXG
) >> 3;

378 ià(!
group_obj
)

379  -
EIO
;

380 
group_obj
->
e_³rm
 = (
mode
 & 
S_IRWXG
) >> 3;

384 
	}
}

387 
	$posix_aş_ü—‹
(
posix_aş
 **
aş
, 
gå_t
 
gå
, 
umode_t
 *
mode_p
)

389 
posix_aş
 *
şÚe
 = 
	`posix_aş_şÚe
(*
aş
, 
gå
);

390 
”r
 = -
ENOMEM
;

391 ià(
şÚe
) {

392 
”r
 = 
	`posix_aş_ü—‹_masq
(
şÚe
, 
mode_p
);

393 ià(
”r
 < 0) {

394 
	`posix_aş_»Ëa£
(
şÚe
);

395 
şÚe
 = 
NULL
;

398 
	`posix_aş_»Ëa£
(*
aş
);

399 *
aş
 = 
şÚe
;

400  
”r
;

401 
	}
}

402 
EXPORT_SYMBOL
(
posix_aş_ü—‹
);

405 
	$posix_aş_chmod
(
posix_aş
 **
aş
, 
gå_t
 
gå
, 
umode_t
 
mode
)

407 
posix_aş
 *
şÚe
 = 
	`posix_aş_şÚe
(*
aş
, 
gå
);

408 
”r
 = -
ENOMEM
;

409 ià(
şÚe
) {

410 
”r
 = 
	`posix_aş_chmod_masq
(
şÚe
, 
mode
);

411 ià(
”r
) {

412 
	`posix_aş_»Ëa£
(
şÚe
);

413 
şÚe
 = 
NULL
;

416 
	`posix_aş_»Ëa£
(*
aş
);

417 *
aş
 = 
şÚe
;

418  
”r
;

419 
	}
}

420 
EXPORT_SYMBOL
(
posix_aş_chmod
);

	@read_write.c

7 
	~<lšux/¦ab.h
>

8 
	~<lšux/¡©.h
>

9 
	~<lšux/fú.h
>

10 
	~<lšux/fe.h
>

11 
	~<lšux/uio.h
>

12 
	~<lšux/f¢Ùify.h
>

13 
	~<lšux/£cur™y.h
>

14 
	~<lšux/moduË.h
>

15 
	~<lšux/sysÿÎs.h
>

16 
	~<lšux/·gem­.h
>

17 
	~<lšux/¥liû.h
>

18 
	~"»ad_wr™e.h
"

20 
	~<asm/uacûss.h
>

21 
	~<asm/uni¡d.h
>

23 cÚ¡ 
fe_İ”©iÚs
 
	gg’”ic_ro_fİs
 = {

24 .
Î£ek
 = 
g’”ic_fe_Î£ek
,

25 .
	g»ad
 = 
do_sync_»ad
,

26 .
	gaio_»ad
 = 
g’”ic_fe_aio_»ad
,

27 .
	gmm­
 = 
g’”ic_fe_»adÚly_mm­
,

28 .
	g¥liû_»ad
 = 
g’”ic_fe_¥liû_»ad
,

31 
EXPORT_SYMBOL
(
g’”ic_ro_fİs
);

33 
šlše
 
	$unsigÃd_off£ts
(
fe
 *file)

35  
fe
->
f_mode
 & 
FMODE_UNSIGNED_OFFSET
;

36 
	}
}

38 
loff_t
 
	$l£ek_execu‹
(
fe
 *fe, 
šode
 *inode,

39 
loff_t
 
off£t
,†off_ˆ
maxsize
)

41 ià(
off£t
 < 0 && !
	`unsigÃd_off£ts
(
fe
))

42  -
EINVAL
;

43 ià(
off£t
 > 
maxsize
)

44  -
EINVAL
;

46 ià(
off£t
 !ğ
fe
->
f_pos
) {

47 
fe
->
f_pos
 = 
off£t
;

48 
fe
->
f_v”siÚ
 = 0;

50  
off£t
;

51 
	}
}

68 
loff_t


69 
	$g’”ic_fe_Î£ek_size
(
fe
 *fe, 
loff_t
 
off£t
, 
Üigš
,

70 
loff_t
 
maxsize
)

72 
šode
 *šodğ
fe
->
f_m­pšg
->
ho¡
;

74 
Üigš
) {

75 
SEEK_END
:

76 
off£t
 +ğ
	`i_size_»ad
(
šode
);

78 
SEEK_CUR
:

85 ià(
off£t
 == 0)

86  
fe
->
f_pos
;

92 
	`¥š_lock
(&
fe
->
f_lock
);

93 
off£t
 = 
	`l£ek_execu‹
(
fe
, 
šode
, fe->
f_pos
 + offset,

94 
maxsize
);

95 
	`¥š_uÆock
(&
fe
->
f_lock
);

96  
off£t
;

97 
SEEK_DATA
:

102 ià(
off£t
 >ğ
	`i_size_»ad
(
šode
))

103  -
ENXIO
;

105 
SEEK_HOLE
:

110 ià(
off£t
 >ğ
	`i_size_»ad
(
šode
))

111  -
ENXIO
;

112 
off£t
 = 
	`i_size_»ad
(
šode
);

116  
	`l£ek_execu‹
(
fe
, 
šode
, 
off£t
, 
maxsize
);

117 
	}
}

118 
EXPORT_SYMBOL
(
g’”ic_fe_Î£ek_size
);

130 
loff_t
 
	$g’”ic_fe_Î£ek
(
fe
 *fe, 
loff_t
 
off£t
, 
Üigš
)

132 
šode
 *šodğ
fe
->
f_m­pšg
->
ho¡
;

134  
	`g’”ic_fe_Î£ek_size
(
fe
, 
off£t
, 
Üigš
,

135 
šode
->
i_sb
->
s_maxby‹s
);

136 
	}
}

137 
EXPORT_SYMBOL
(
g’”ic_fe_Î£ek
);

150 
loff_t
 
	$noİ_Î£ek
(
fe
 *fe, 
loff_t
 
off£t
, 
Üigš
)

152  
fe
->
f_pos
;

153 
	}
}

154 
EXPORT_SYMBOL
(
noİ_Î£ek
);

156 
loff_t
 
	$no_Î£ek
(
fe
 *fe, 
loff_t
 
off£t
, 
Üigš
)

158  -
ESPIPE
;

159 
	}
}

160 
EXPORT_SYMBOL
(
no_Î£ek
);

162 
loff_t
 
	$deçuÉ_Î£ek
(
fe
 *fe, 
loff_t
 
off£t
, 
Üigš
)

164 
šode
 *šodğ
fe
->
f_·th
.
d’Œy
->
d_šode
;

165 
loff_t
 
»tv®
;

167 
	`mu‹x_lock
(&
šode
->
i_mu‹x
);

168 
Üigš
) {

169 
SEEK_END
:

170 
off£t
 +ğ
	`i_size_»ad
(
šode
);

172 
SEEK_CUR
:

173 ià(
off£t
 == 0) {

174 
»tv®
 = 
fe
->
f_pos
;

175 
out
;

177 
off£t
 +ğ
fe
->
f_pos
;

179 
SEEK_DATA
:

185 ià(
off£t
 >ğ
šode
->
i_size
) {

186 
»tv®
 = -
ENXIO
;

187 
out
;

190 
SEEK_HOLE
:

196 ià(
off£t
 >ğ
šode
->
i_size
) {

197 
»tv®
 = -
ENXIO
;

198 
out
;

200 
off£t
 = 
šode
->
i_size
;

203 
»tv®
 = -
EINVAL
;

204 ià(
off£t
 >ğ0 || 
	`unsigÃd_off£ts
(
fe
)) {

205 ià(
off£t
 !ğ
fe
->
f_pos
) {

206 
fe
->
f_pos
 = 
off£t
;

207 
fe
->
f_v”siÚ
 = 0;

209 
»tv®
 = 
off£t
;

211 
out
:

212 
	`mu‹x_uÆock
(&
šode
->
i_mu‹x
);

213  
»tv®
;

214 
	}
}

215 
EXPORT_SYMBOL
(
deçuÉ_Î£ek
);

217 
loff_t
 
	$vfs_Î£ek
(
fe
 *fe, 
loff_t
 
off£t
, 
Üigš
)

219 
	`loff_t
 (*
â
)(
fe
 *, 
loff_t
, );

221 
â
 = 
no_Î£ek
;

222 ià(
fe
->
f_mode
 & 
FMODE_LSEEK
) {

223 ià(
fe
->
f_İ
 && fe->f_İ->
Î£ek
)

224 
â
 = 
fe
->
f_İ
->
Î£ek
;

226  
	`â
(
fe
, 
off£t
, 
Üigš
);

227 
	}
}

228 
EXPORT_SYMBOL
(
vfs_Î£ek
);

230 
	$SYSCALL_DEFINE3
(
l£ek
, , 
fd
, 
off_t
, 
off£t
, , 
Üigš
)

232 
off_t
 
»tv®
;

233 
fe
 * file;

234 
åut_Ãeded
;

236 
»tv®
 = -
EBADF
;

237 
fe
 = 
	`fg‘_light
(
fd
, &
åut_Ãeded
);

238 ià(!
fe
)

239 
bad
;

241 
»tv®
 = -
EINVAL
;

242 ià(
Üigš
 <ğ
SEEK_MAX
) {

243 
loff_t
 
»s
 = 
	`vfs_Î£ek
(
fe
, 
off£t
, 
Üigš
);

244 
»tv®
 = 
»s
;

245 ià(
»s
 !ğ(
loff_t
)
»tv®
)

246 
»tv®
 = -
EOVERFLOW
;

248 
	`åut_light
(
fe
, 
åut_Ãeded
);

249 
bad
:

250  
»tv®
;

251 
	}
}

253 #ifdeà
__ARCH_WANT_SYS_LLSEEK


254 
	$SYSCALL_DEFINE5
(
Î£ek
, , 
fd
, , 
off£t_high
,

255 , 
off£t_low
, 
loff_t
 
__u£r
 *, 
»suÉ
,

256 , 
Üigš
)

258 
»tv®
;

259 
fe
 * file;

260 
loff_t
 
off£t
;

261 
åut_Ãeded
;

263 
»tv®
 = -
EBADF
;

264 
fe
 = 
	`fg‘_light
(
fd
, &
åut_Ãeded
);

265 ià(!
fe
)

266 
bad
;

268 
»tv®
 = -
EINVAL
;

269 ià(
Üigš
 > 
SEEK_MAX
)

270 
out_putf
;

272 
off£t
 = 
	`vfs_Î£ek
(
fe
, ((
loff_t
è
off£t_high
 << 32è| 
off£t_low
,

273 
Üigš
);

275 
»tv®
 = ()
off£t
;

276 ià(
off£t
 >= 0) {

277 
»tv®
 = -
EFAULT
;

278 ià(!
	`cİy_to_u£r
(
»suÉ
, &
off£t
, (offset)))

279 
»tv®
 = 0;

281 
out_putf
:

282 
	`åut_light
(
fe
, 
åut_Ãeded
);

283 
bad
:

284  
»tv®
;

285 
	}
}

294 
	$rw_v”ify_¬—
(
»ad_wr™e
, 
fe
 *fe, 
loff_t
 *
µos
, 
size_t
 
couÁ
)

296 
šode
 *inode;

297 
loff_t
 
pos
;

298 
»tv®
 = -
EINVAL
;

300 
šode
 = 
fe
->
f_·th
.
d’Œy
->
d_šode
;

301 ià(
	`uÆik–y
((
ssize_t
è
couÁ
 < 0))

302  
»tv®
;

303 
pos
 = *
µos
;

304 ià(
	`uÆik–y
(
pos
 < 0)) {

305 ià(!
	`unsigÃd_off£ts
(
fe
))

306  
»tv®
;

307 ià(
couÁ
 >ğ-
pos
)

308  -
EOVERFLOW
;

309 } ià(
	`uÆik–y
((
loff_t
è(
pos
 + 
couÁ
) < 0)) {

310 ià(!
	`unsigÃd_off£ts
(
fe
))

311  
»tv®
;

314 ià(
	`uÆik–y
(
šode
->
i_æock
 && 
	`mªd©Üy_lock
(inode))) {

315 
»tv®
 = 
	`locks_mªd©Üy_¬—
(

316 
»ad_wr™e
 =ğ
READ
 ? 
FLOCK_VERIFY_READ
 : 
FLOCK_VERIFY_WRITE
,

317 
šode
, 
fe
, 
pos
, 
couÁ
);

318 ià(
»tv®
 < 0)

319  
»tv®
;

321 
»tv®
 = 
	`£cur™y_fe_³rmissiÚ
(
fe
,

322 
»ad_wr™e
 =ğ
READ
 ? 
MAY_READ
 : 
MAY_WRITE
);

323 ià(
»tv®
)

324  
»tv®
;

325  
couÁ
 > 
MAX_RW_COUNT
 ? MAX_RW_COUNT : count;

326 
	}
}

328 
	$wa™_Ú_»Œy_sync_kiocb
(
kiocb
 *
iocb
)

330 
	`£t_cu¼’t_¡©e
(
TASK_UNINTERRUPTIBLE
);

331 ià(!
	`kiocbIsKicked
(
iocb
))

332 
	`scheduË
();

334 
	`kiocbCË¬Kicked
(
iocb
);

335 
	`__£t_cu¼’t_¡©e
(
TASK_RUNNING
);

336 
	}
}

338 
ssize_t
 
	$do_sync_»ad
(
fe
 *
fp
, 
__u£r
 *
buf
, 
size_t
 
Ën
, 
loff_t
 *
µos
)

340 
iovec
 
iov
 = { .
iov_ba£
 = 
buf
, .
iov_Ën
 = 
Ën
 };

341 
kiocb
 kiocb;

342 
ssize_t
 
»t
;

344 
	`š™_sync_kiocb
(&
kiocb
, 
fp
);

345 
kiocb
.
ki_pos
 = *
µos
;

346 
kiocb
.
ki_Ëá
 = 
Ën
;

347 
kiocb
.
ki_nby‹s
 = 
Ën
;

350 
»t
 = 
fp
->
f_İ
->
	`aio_»ad
(&
kiocb
, &
iov
, 1, kiocb.
ki_pos
);

351 ià(
»t
 !ğ-
EIOCBRETRY
)

353 
	`wa™_Ú_»Œy_sync_kiocb
(&
kiocb
);

356 ià(-
EIOCBQUEUED
 =ğ
»t
)

357 
»t
 = 
	`wa™_Ú_sync_kiocb
(&
kiocb
);

358 *
µos
 = 
kiocb
.
ki_pos
;

359  
»t
;

360 
	}
}

362 
EXPORT_SYMBOL
(
do_sync_»ad
);

364 
ssize_t
 
	$vfs_»ad
(
fe
 *fe, 
__u£r
 *
buf
, 
size_t
 
couÁ
, 
loff_t
 *
pos
)

366 
ssize_t
 
»t
;

368 ià(!(
fe
->
f_mode
 & 
FMODE_READ
))

369  -
EBADF
;

370 ià(!
fe
->
f_İ
 || (!fe->f_İ->
»ad
 && !fe->f_İ->
aio_»ad
))

371  -
EINVAL
;

372 ià(
	`uÆik–y
(!
	`acûss_ok
(
VERIFY_WRITE
, 
buf
, 
couÁ
)))

373  -
EFAULT
;

375 
»t
 = 
	`rw_v”ify_¬—
(
READ
, 
fe
, 
pos
, 
couÁ
);

376 ià(
»t
 >= 0) {

377 
couÁ
 = 
»t
;

378 ià(
fe
->
f_İ
->
»ad
)

379 
»t
 = 
fe
->
f_İ
->
	`»ad
(fe, 
buf
, 
couÁ
, 
pos
);

381 
»t
 = 
	`do_sync_»ad
(
fe
, 
buf
, 
couÁ
, 
pos
);

382 ià(
»t
 > 0) {

383 
	`f¢Ùify_acûss
(
fe
);

384 
	`add_rch¬
(
cu¼’t
, 
»t
);

386 
	`šc_sysü
(
cu¼’t
);

389  
»t
;

390 
	}
}

392 
EXPORT_SYMBOL
(
vfs_»ad
);

394 
ssize_t
 
	$do_sync_wr™e
(
fe
 *
fp
, cÚ¡ 
__u£r
 *
buf
, 
size_t
 
Ën
, 
loff_t
 *
µos
)

396 
iovec
 
iov
 = { .
iov_ba£
 = (
__u£r
 *)
buf
, .
iov_Ën
 = 
Ën
 };

397 
kiocb
 kiocb;

398 
ssize_t
 
»t
;

400 
	`š™_sync_kiocb
(&
kiocb
, 
fp
);

401 
kiocb
.
ki_pos
 = *
µos
;

402 
kiocb
.
ki_Ëá
 = 
Ën
;

403 
kiocb
.
ki_nby‹s
 = 
Ën
;

406 
»t
 = 
fp
->
f_İ
->
	`aio_wr™e
(&
kiocb
, &
iov
, 1, kiocb.
ki_pos
);

407 ià(
»t
 !ğ-
EIOCBRETRY
)

409 
	`wa™_Ú_»Œy_sync_kiocb
(&
kiocb
);

412 ià(-
EIOCBQUEUED
 =ğ
»t
)

413 
»t
 = 
	`wa™_Ú_sync_kiocb
(&
kiocb
);

414 *
µos
 = 
kiocb
.
ki_pos
;

415  
»t
;

416 
	}
}

418 
EXPORT_SYMBOL
(
do_sync_wr™e
);

420 
ssize_t
 
	$vfs_wr™e
(
fe
 *fe, cÚ¡ 
__u£r
 *
buf
, 
size_t
 
couÁ
, 
loff_t
 *
pos
)

422 
ssize_t
 
»t
;

424 ià(!(
fe
->
f_mode
 & 
FMODE_WRITE
))

425  -
EBADF
;

426 ià(!
fe
->
f_İ
 || (!fe->f_İ->
wr™e
 && !fe->f_İ->
aio_wr™e
))

427  -
EINVAL
;

428 ià(
	`uÆik–y
(!
	`acûss_ok
(
VERIFY_READ
, 
buf
, 
couÁ
)))

429  -
EFAULT
;

431 
»t
 = 
	`rw_v”ify_¬—
(
WRITE
, 
fe
, 
pos
, 
couÁ
);

432 ià(
»t
 >= 0) {

433 
couÁ
 = 
»t
;

434 ià(
fe
->
f_İ
->
wr™e
)

435 
»t
 = 
fe
->
f_İ
->
	`wr™e
(fe, 
buf
, 
couÁ
, 
pos
);

437 
»t
 = 
	`do_sync_wr™e
(
fe
, 
buf
, 
couÁ
, 
pos
);

438 ià(
»t
 > 0) {

439 
	`f¢Ùify_modify
(
fe
);

440 
	`add_wch¬
(
cu¼’t
, 
»t
);

442 
	`šc_syscw
(
cu¼’t
);

445  
»t
;

446 
	}
}

448 
EXPORT_SYMBOL
(
vfs_wr™e
);

450 
šlše
 
loff_t
 
	$fe_pos_»ad
(
fe
 *file)

452  
fe
->
f_pos
;

453 
	}
}

455 
šlše
 
	$fe_pos_wr™e
(
fe
 *fe, 
loff_t
 
pos
)

457 
fe
->
f_pos
 = 
pos
;

458 
	}
}

460 
	$SYSCALL_DEFINE3
(
»ad
, , 
fd
, 
__u£r
 *, 
buf
, 
size_t
, 
couÁ
)

462 
fe
 *file;

463 
ssize_t
 
»t
 = -
EBADF
;

464 
åut_Ãeded
;

466 
fe
 = 
	`fg‘_light
(
fd
, &
åut_Ãeded
);

467 ià(
fe
) {

468 
loff_t
 
pos
 = 
	`fe_pos_»ad
(
fe
);

469 
»t
 = 
	`vfs_»ad
(
fe
, 
buf
, 
couÁ
, &
pos
);

470 
	`fe_pos_wr™e
(
fe
, 
pos
);

471 
	`åut_light
(
fe
, 
åut_Ãeded
);

474  
»t
;

475 
	}
}

477 
	$SYSCALL_DEFINE3
(
wr™e
, , 
fd
, cÚ¡ 
__u£r
 *, 
buf
,

478 
size_t
, 
couÁ
)

480 
fe
 *file;

481 
ssize_t
 
»t
 = -
EBADF
;

482 
åut_Ãeded
;

484 
fe
 = 
	`fg‘_light
(
fd
, &
åut_Ãeded
);

485 ià(
fe
) {

486 
loff_t
 
pos
 = 
	`fe_pos_»ad
(
fe
);

487 
»t
 = 
	`vfs_wr™e
(
fe
, 
buf
, 
couÁ
, &
pos
);

488 
	`fe_pos_wr™e
(
fe
, 
pos
);

489 
	`åut_light
(
fe
, 
åut_Ãeded
);

492  
»t
;

493 
	}
}

495 
	$SYSCALL_DEFINE
(
´—d64
)(
fd
, 
__u£r
 *
buf
,

496 
size_t
 
couÁ
, 
loff_t
 
pos
)

498 
fe
 *file;

499 
ssize_t
 
»t
 = -
EBADF
;

500 
åut_Ãeded
;

502 ià(
pos
 < 0)

503  -
EINVAL
;

505 
fe
 = 
	`fg‘_light
(
fd
, &
åut_Ãeded
);

506 ià(
fe
) {

507 
»t
 = -
ESPIPE
;

508 ià(
fe
->
f_mode
 & 
FMODE_PREAD
)

509 
»t
 = 
	`vfs_»ad
(
fe
, 
buf
, 
couÁ
, &
pos
);

510 
	`åut_light
(
fe
, 
åut_Ãeded
);

513  
»t
;

514 
	}
}

515 #ifdeà
CONFIG_HAVE_SYSCALL_WRAPPERS


516 
asmlškage
 
	$SyS_´—d64
(
fd
, 
buf
, 
couÁ
, 
loff_t
 
pos
)

518  
	`SYSC_´—d64
((è
fd
, (
__u£r
 *è
buf
,

519 (
size_t
è
couÁ
, 
pos
);

520 
	}
}

521 
SYSCALL_ALIAS
(
sys_´—d64
, 
SyS_´—d64
);

524 
	$SYSCALL_DEFINE
(
pwr™e64
)(
fd
, cÚ¡ 
__u£r
 *
buf
,

525 
size_t
 
couÁ
, 
loff_t
 
pos
)

527 
fe
 *file;

528 
ssize_t
 
»t
 = -
EBADF
;

529 
åut_Ãeded
;

531 ià(
pos
 < 0)

532  -
EINVAL
;

534 
fe
 = 
	`fg‘_light
(
fd
, &
åut_Ãeded
);

535 ià(
fe
) {

536 
»t
 = -
ESPIPE
;

537 ià(
fe
->
f_mode
 & 
FMODE_PWRITE
)

538 
»t
 = 
	`vfs_wr™e
(
fe
, 
buf
, 
couÁ
, &
pos
);

539 
	`åut_light
(
fe
, 
åut_Ãeded
);

542  
»t
;

543 
	}
}

544 #ifdeà
CONFIG_HAVE_SYSCALL_WRAPPERS


545 
asmlškage
 
	$SyS_pwr™e64
(
fd
, 
buf
, 
couÁ
, 
loff_t
 
pos
)

547  
	`SYSC_pwr™e64
((è
fd
, (cÚ¡ 
__u£r
 *è
buf
,

548 (
size_t
è
couÁ
, 
pos
);

549 
	}
}

550 
SYSCALL_ALIAS
(
sys_pwr™e64
, 
SyS_pwr™e64
);

556 
	$iov_shÜ‹n
(
iovec
 *
iov
, 
Ä_£gs
, 
size_t
 
to
)

558 
£g
 = 0;

559 
size_t
 
Ën
 = 0;

561 
£g
 < 
Ä_£gs
) {

562 
£g
++;

563 ià(
Ën
 + 
iov
->
iov_Ën
 >ğ
to
) {

564 
iov
->
iov_Ën
 = 
to
 - 
Ën
;

567 
Ën
 +ğ
iov
->
iov_Ën
;

568 
iov
++;

570  
£g
;

571 
	}
}

572 
EXPORT_SYMBOL
(
iov_shÜ‹n
);

574 
ssize_t
 
	$do_sync_»adv_wr™ev
(
fe
 *
fp
, cÚ¡ 
iovec
 *
iov
,

575 
Ä_£gs
, 
size_t
 
Ën
, 
loff_t
 *
µos
, 
iov_â_t
 
â
)

577 
kiocb
 kiocb;

578 
ssize_t
 
»t
;

580 
	`š™_sync_kiocb
(&
kiocb
, 
fp
);

581 
kiocb
.
ki_pos
 = *
µos
;

582 
kiocb
.
ki_Ëá
 = 
Ën
;

583 
kiocb
.
ki_nby‹s
 = 
Ën
;

586 
»t
 = 
	`â
(&
kiocb
, 
iov
, 
Ä_£gs
, kiocb.
ki_pos
);

587 ià(
»t
 !ğ-
EIOCBRETRY
)

589 
	`wa™_Ú_»Œy_sync_kiocb
(&
kiocb
);

592 ià(
»t
 =ğ-
EIOCBQUEUED
)

593 
»t
 = 
	`wa™_Ú_sync_kiocb
(&
kiocb
);

594 *
µos
 = 
kiocb
.
ki_pos
;

595  
»t
;

596 
	}
}

599 
ssize_t
 
	$do_loİ_»adv_wr™ev
(
fe
 *
fp
, 
iovec
 *
iov
,

600 
Ä_£gs
, 
loff_t
 *
µos
, 
io_â_t
 
â
)

602 
iovec
 *
veùÜ
 = 
iov
;

603 
ssize_t
 
»t
 = 0;

605 
Ä_£gs
 > 0) {

606 
__u£r
 *
ba£
;

607 
size_t
 
Ën
;

608 
ssize_t
 
Ä
;

610 
ba£
 = 
veùÜ
->
iov_ba£
;

611 
Ën
 = 
veùÜ
->
iov_Ën
;

612 
veùÜ
++;

613 
Ä_£gs
--;

615 
Ä
 = 
	`â
(
fp
, 
ba£
, 
Ën
, 
µos
);

617 ià(
Ä
 < 0) {

618 ià(!
»t
)

619 
»t
 = 
Ä
;

622 
»t
 +ğ
Ä
;

623 ià(
Ä
 !ğ
Ën
)

627  
»t
;

628 
	}
}

631 
	#vrfy_dœ
(
ty³
è(Ñy³è=ğ
READ
 ? 
VERIFY_WRITE
 : 
VERIFY_READ
)

	)

633 
ssize_t
 
	$rw_cİy_check_uveùÜ
(
ty³
, cÚ¡ 
iovec
 
__u£r
 * 
uveùÜ
,

634 
Ä_£gs
, 
ç¡_£gs
,

635 
iovec
 *
ç¡_poš‹r
,

636 
iovec
 **
»t_poš‹r
,

637 
check_acûss
)

639 
£g
;

640 
ssize_t
 
»t
;

641 
iovec
 *
iov
 = 
ç¡_poš‹r
;

648 ià(
Ä_£gs
 == 0) {

649 
»t
 = 0;

650 
out
;

657 ià(
Ä_£gs
 > 
UIO_MAXIOV
) {

658 
»t
 = -
EINVAL
;

659 
out
;

661 ià(
Ä_£gs
 > 
ç¡_£gs
) {

662 
iov
 = 
	`km®loc
(
Ä_£gs
*(
iovec
), 
GFP_KERNEL
);

663 ià(
iov
 =ğ
NULL
) {

664 
»t
 = -
ENOMEM
;

665 
out
;

668 ià(
	`cİy_äom_u£r
(
iov
, 
uveùÜ
, 
Ä_£gs
*(*uvector))) {

669 
»t
 = -
EFAULT
;

670 
out
;

682 
»t
 = 0;

683 
£g
 = 0; seg < 
Ä_£gs
; seg++) {

684 
__u£r
 *
buf
 = 
iov
[
£g
].
iov_ba£
;

685 
ssize_t
 
Ën
 = (ssize_t)
iov
[
£g
].
iov_Ën
;

689 ià(
Ën
 < 0) {

690 
»t
 = -
EINVAL
;

691 
out
;

693 ià(
check_acûss


694 && 
	`uÆik–y
(!
	`acûss_ok
(
	`vrfy_dœ
(
ty³
), 
buf
, 
Ën
))) {

695 
»t
 = -
EFAULT
;

696 
out
;

698 ià(
Ën
 > 
MAX_RW_COUNT
 - 
»t
) {

699 
Ën
 = 
MAX_RW_COUNT
 - 
»t
;

700 
iov
[
£g
].
iov_Ën
 = 
Ën
;

702 
»t
 +ğ
Ën
;

704 
out
:

705 *
»t_poš‹r
 = 
iov
;

706  
»t
;

707 
	}
}

709 
ssize_t
 
	$do_»adv_wr™ev
(
ty³
, 
fe
 *file,

710 cÚ¡ 
iovec
 
__u£r
 * 
uveùÜ
,

711 
Ä_£gs
, 
loff_t
 *
pos
)

713 
size_t
 
tÙ_Ën
;

714 
iovec
 
iov¡ack
[
UIO_FASTIOV
];

715 
iovec
 *
iov
 = 
iov¡ack
;

716 
ssize_t
 
»t
;

717 
io_â_t
 
â
;

718 
iov_â_t
 
âv
;

720 ià(!
fe
->
f_İ
) {

721 
»t
 = -
EINVAL
;

722 
out
;

725 
»t
 = 
	`rw_cİy_check_uveùÜ
(
ty³
, 
uveùÜ
, 
Ä_£gs
,

726 
	`ARRAY_SIZE
(
iov¡ack
), iov¡ack, &
iov
, 1);

727 ià(
»t
 <= 0)

728 
out
;

730 
tÙ_Ën
 = 
»t
;

731 
»t
 = 
	`rw_v”ify_¬—
(
ty³
, 
fe
, 
pos
, 
tÙ_Ën
);

732 ià(
»t
 < 0)

733 
out
;

735 
âv
 = 
NULL
;

736 ià(
ty³
 =ğ
READ
) {

737 
â
 = 
fe
->
f_İ
->
»ad
;

738 
âv
 = 
fe
->
f_İ
->
aio_»ad
;

740 
â
 = (
io_â_t
)
fe
->
f_İ
->
wr™e
;

741 
âv
 = 
fe
->
f_İ
->
aio_wr™e
;

744 ià(
âv
)

745 
»t
 = 
	`do_sync_»adv_wr™ev
(
fe
, 
iov
, 
Ä_£gs
, 
tÙ_Ën
,

746 
pos
, 
âv
);

748 
»t
 = 
	`do_loİ_»adv_wr™ev
(
fe
, 
iov
, 
Ä_£gs
, 
pos
, 
â
);

750 
out
:

751 ià(
iov
 !ğ
iov¡ack
)

752 
	`kä“
(
iov
);

753 ià((
»t
 + (
ty³
 =ğ
READ
)) > 0) {

754 ià(
ty³
 =ğ
READ
)

755 
	`f¢Ùify_acûss
(
fe
);

757 
	`f¢Ùify_modify
(
fe
);

759  
»t
;

760 
	}
}

762 
ssize_t
 
	$vfs_»adv
(
fe
 *fe, cÚ¡ 
iovec
 
__u£r
 *
vec
,

763 
vËn
, 
loff_t
 *
pos
)

765 ià(!(
fe
->
f_mode
 & 
FMODE_READ
))

766  -
EBADF
;

767 ià(!
fe
->
f_İ
 || (!fe->f_İ->
aio_»ad
 && !fe->f_İ->
»ad
))

768  -
EINVAL
;

770  
	`do_»adv_wr™ev
(
READ
, 
fe
, 
vec
, 
vËn
, 
pos
);

771 
	}
}

773 
EXPORT_SYMBOL
(
vfs_»adv
);

775 
ssize_t
 
	$vfs_wr™ev
(
fe
 *fe, cÚ¡ 
iovec
 
__u£r
 *
vec
,

776 
vËn
, 
loff_t
 *
pos
)

778 ià(!(
fe
->
f_mode
 & 
FMODE_WRITE
))

779  -
EBADF
;

780 ià(!
fe
->
f_İ
 || (!fe->f_İ->
aio_wr™e
 && !fe->f_İ->
wr™e
))

781  -
EINVAL
;

783  
	`do_»adv_wr™ev
(
WRITE
, 
fe
, 
vec
, 
vËn
, 
pos
);

784 
	}
}

786 
EXPORT_SYMBOL
(
vfs_wr™ev
);

788 
	$SYSCALL_DEFINE3
(
»adv
, , 
fd
, cÚ¡ 
iovec
 
__u£r
 *, 
vec
,

789 , 
vËn
)

791 
fe
 *file;

792 
ssize_t
 
»t
 = -
EBADF
;

793 
åut_Ãeded
;

795 
fe
 = 
	`fg‘_light
(
fd
, &
åut_Ãeded
);

796 ià(
fe
) {

797 
loff_t
 
pos
 = 
	`fe_pos_»ad
(
fe
);

798 
»t
 = 
	`vfs_»adv
(
fe
, 
vec
, 
vËn
, &
pos
);

799 
	`fe_pos_wr™e
(
fe
, 
pos
);

800 
	`åut_light
(
fe
, 
åut_Ãeded
);

803 ià(
»t
 > 0)

804 
	`add_rch¬
(
cu¼’t
, 
»t
);

805 
	`šc_sysü
(
cu¼’t
);

806  
»t
;

807 
	}
}

809 
	$SYSCALL_DEFINE3
(
wr™ev
, , 
fd
, cÚ¡ 
iovec
 
__u£r
 *, 
vec
,

810 , 
vËn
)

812 
fe
 *file;

813 
ssize_t
 
»t
 = -
EBADF
;

814 
åut_Ãeded
;

816 
fe
 = 
	`fg‘_light
(
fd
, &
åut_Ãeded
);

817 ià(
fe
) {

818 
loff_t
 
pos
 = 
	`fe_pos_»ad
(
fe
);

819 
»t
 = 
	`vfs_wr™ev
(
fe
, 
vec
, 
vËn
, &
pos
);

820 
	`fe_pos_wr™e
(
fe
, 
pos
);

821 
	`åut_light
(
fe
, 
åut_Ãeded
);

824 ià(
»t
 > 0)

825 
	`add_wch¬
(
cu¼’t
, 
»t
);

826 
	`šc_syscw
(
cu¼’t
);

827  
»t
;

828 
	}
}

830 
šlše
 
loff_t
 
	$pos_äom_ho
(
high
, 
low
)

832 
	#HALF_LONG_BITS
 (
BITS_PER_LONG
 / 2)

	)

833  (((
loff_t
)
high
 << 
HALF_LONG_BITS
è<< HALF_LONG_BITSè| 
low
;

834 
	}
}

836 
	$SYSCALL_DEFINE5
(
´—dv
, , 
fd
, cÚ¡ 
iovec
 
__u£r
 *, 
vec
,

837 , 
vËn
, , 
pos_l
, , 
pos_h
)

839 
loff_t
 
pos
 = 
	`pos_äom_ho
(
pos_h
, 
pos_l
);

840 
fe
 *file;

841 
ssize_t
 
»t
 = -
EBADF
;

842 
åut_Ãeded
;

844 ià(
pos
 < 0)

845  -
EINVAL
;

847 
fe
 = 
	`fg‘_light
(
fd
, &
åut_Ãeded
);

848 ià(
fe
) {

849 
»t
 = -
ESPIPE
;

850 ià(
fe
->
f_mode
 & 
FMODE_PREAD
)

851 
»t
 = 
	`vfs_»adv
(
fe
, 
vec
, 
vËn
, &
pos
);

852 
	`åut_light
(
fe
, 
åut_Ãeded
);

855 ià(
»t
 > 0)

856 
	`add_rch¬
(
cu¼’t
, 
»t
);

857 
	`šc_sysü
(
cu¼’t
);

858  
»t
;

859 
	}
}

861 
	$SYSCALL_DEFINE5
(
pwr™ev
, , 
fd
, cÚ¡ 
iovec
 
__u£r
 *, 
vec
,

862 , 
vËn
, , 
pos_l
, , 
pos_h
)

864 
loff_t
 
pos
 = 
	`pos_äom_ho
(
pos_h
, 
pos_l
);

865 
fe
 *file;

866 
ssize_t
 
»t
 = -
EBADF
;

867 
åut_Ãeded
;

869 ià(
pos
 < 0)

870  -
EINVAL
;

872 
fe
 = 
	`fg‘_light
(
fd
, &
åut_Ãeded
);

873 ià(
fe
) {

874 
»t
 = -
ESPIPE
;

875 ià(
fe
->
f_mode
 & 
FMODE_PWRITE
)

876 
»t
 = 
	`vfs_wr™ev
(
fe
, 
vec
, 
vËn
, &
pos
);

877 
	`åut_light
(
fe
, 
åut_Ãeded
);

880 ià(
»t
 > 0)

881 
	`add_wch¬
(
cu¼’t
, 
»t
);

882 
	`šc_syscw
(
cu¼’t
);

883  
»t
;

884 
	}
}

886 
ssize_t
 
	$do_£ndfe
(
out_fd
, 
š_fd
, 
loff_t
 *
µos
,

887 
size_t
 
couÁ
, 
loff_t
 
max
)

889 
fe
 * 
š_fe
, * 
out_fe
;

890 
šode
 * 
š_šode
, * 
out_šode
;

891 
loff_t
 
pos
;

892 
ssize_t
 
»tv®
;

893 
åut_Ãeded_š
, 
åut_Ãeded_out
, 
æ
;

898 
»tv®
 = -
EBADF
;

899 
š_fe
 = 
	`fg‘_light
(
š_fd
, &
åut_Ãeded_š
);

900 ià(!
š_fe
)

901 
out
;

902 ià(!(
š_fe
->
f_mode
 & 
FMODE_READ
))

903 
åut_š
;

904 
»tv®
 = -
ESPIPE
;

905 ià(!
µos
)

906 
µos
 = &
š_fe
->
f_pos
;

908 ià(!(
š_fe
->
f_mode
 & 
FMODE_PREAD
))

909 
åut_š
;

910 
»tv®
 = 
	`rw_v”ify_¬—
(
READ
, 
š_fe
, 
µos
, 
couÁ
);

911 ià(
»tv®
 < 0)

912 
åut_š
;

913 
couÁ
 = 
»tv®
;

918 
»tv®
 = -
EBADF
;

919 
out_fe
 = 
	`fg‘_light
(
out_fd
, &
åut_Ãeded_out
);

920 ià(!
out_fe
)

921 
åut_š
;

922 ià(!(
out_fe
->
f_mode
 & 
FMODE_WRITE
))

923 
åut_out
;

924 
»tv®
 = -
EINVAL
;

925 
š_šode
 = 
š_fe
->
f_·th
.
d’Œy
->
d_šode
;

926 
out_šode
 = 
out_fe
->
f_·th
.
d’Œy
->
d_šode
;

927 
»tv®
 = 
	`rw_v”ify_¬—
(
WRITE
, 
out_fe
, &out_fe->
f_pos
, 
couÁ
);

928 ià(
»tv®
 < 0)

929 
åut_out
;

930 
couÁ
 = 
»tv®
;

932 ià(!
max
)

933 
max
 = 
	`mš
(
š_šode
->
i_sb
->
s_maxby‹s
, 
out_šode
->i_sb->s_maxbytes);

935 
pos
 = *
µos
;

936 ià(
	`uÆik–y
(
pos
 + 
couÁ
 > 
max
)) {

937 
»tv®
 = -
EOVERFLOW
;

938 ià(
pos
 >ğ
max
)

939 
åut_out
;

940 
couÁ
 = 
max
 - 
pos
;

943 
æ
 = 0;

951 ià(
š_fe
->
f_æags
 & 
O_NONBLOCK
)

952 
æ
 = 
SPLICE_F_NONBLOCK
;

954 
»tv®
 = 
	`do_¥liû_dœeù
(
š_fe
, 
µos
, 
out_fe
, 
couÁ
, 
æ
);

956 ià(
»tv®
 > 0) {

957 
	`add_rch¬
(
cu¼’t
, 
»tv®
);

958 
	`add_wch¬
(
cu¼’t
, 
»tv®
);

961 
	`šc_sysü
(
cu¼’t
);

962 
	`šc_syscw
(
cu¼’t
);

963 ià(*
µos
 > 
max
)

964 
»tv®
 = -
EOVERFLOW
;

966 
åut_out
:

967 
	`åut_light
(
out_fe
, 
åut_Ãeded_out
);

968 
åut_š
:

969 
	`åut_light
(
š_fe
, 
åut_Ãeded_š
);

970 
out
:

971  
»tv®
;

972 
	}
}

974 
	$SYSCALL_DEFINE4
(
£ndfe
, , 
out_fd
, , 
š_fd
, 
off_t
 
__u£r
 *, 
off£t
, 
size_t
, 
couÁ
)

976 
loff_t
 
pos
;

977 
off_t
 
off
;

978 
ssize_t
 
»t
;

980 ià(
off£t
) {

981 ià(
	`uÆik–y
(
	`g‘_u£r
(
off
, 
off£t
)))

982  -
EFAULT
;

983 
pos
 = 
off
;

984 
»t
 = 
	`do_£ndfe
(
out_fd
, 
š_fd
, &
pos
, 
couÁ
, 
MAX_NON_LFS
);

985 ià(
	`uÆik–y
(
	`put_u£r
(
pos
, 
off£t
)))

986  -
EFAULT
;

987  
»t
;

990  
	`do_£ndfe
(
out_fd
, 
š_fd
, 
NULL
, 
couÁ
, 0);

991 
	}
}

993 
	$SYSCALL_DEFINE4
(
£ndfe64
, , 
out_fd
, , 
š_fd
, 
loff_t
 
__u£r
 *, 
off£t
, 
size_t
, 
couÁ
)

995 
loff_t
 
pos
;

996 
ssize_t
 
»t
;

998 ià(
off£t
) {

999 ià(
	`uÆik–y
(
	`cİy_äom_u£r
(&
pos
, 
off£t
, (
loff_t
))))

1000  -
EFAULT
;

1001 
»t
 = 
	`do_£ndfe
(
out_fd
, 
š_fd
, &
pos
, 
couÁ
, 0);

1002 ià(
	`uÆik–y
(
	`put_u£r
(
pos
, 
off£t
)))

1003  -
EFAULT
;

1004  
»t
;

1007  
	`do_£ndfe
(
out_fd
, 
š_fd
, 
NULL
, 
couÁ
, 0);

1008 
	}
}

	@read_write.h

7 
	$ssize_t
 (*
	tio_â_t
)(
	tfe
 *, 
	t__u£r
 *, 
	tsize_t
, 
	tloff_t
 *);

8 
	$ssize_t
 (*
	tiov_â_t
)(
	tkiocb
 *, cÚ¡ 
	tiovec
 *,

9 , 
	tloff_t
);

11 
ssize_t
 
	`do_sync_»adv_wr™ev
(
fe
 *
fp
, cÚ¡ 
iovec
 *
iov
,

12 
Ä_£gs
, 
size_t
 
Ën
, 
loff_t
 *
µos
, 
iov_â_t
 
â
);

13 
ssize_t
 
	`do_loİ_»adv_wr™ev
(
fe
 *
fp
, 
iovec
 *
iov
,

14 
Ä_£gs
, 
loff_t
 *
µos
, 
io_â_t
 
â
);

	@readdir.c

7 
	~<lšux/¡ddef.h
>

8 
	~<lšux/k”Ãl.h
>

9 
	~<lšux/moduË.h
>

10 
	~<lšux/time.h
>

11 
	~<lšux/mm.h
>

12 
	~<lšux/”ºo.h
>

13 
	~<lšux/¡©.h
>

14 
	~<lšux/fe.h
>

15 
	~<lšux/fs.h
>

16 
	~<lšux/dœ’t.h
>

17 
	~<lšux/£cur™y.h
>

18 
	~<lšux/sysÿÎs.h
>

19 
	~<lšux/uni¡d.h
>

21 
	~<asm/uacûss.h
>

23 
	$vfs_»addœ
(
fe
 *fe, 
fldœ_t
 
fËr
, *
buf
)

25 
šode
 *šodğ
fe
->
f_·th
.
d’Œy
->
d_šode
;

26 
»s
 = -
ENOTDIR
;

27 ià(!
fe
->
f_İ
 || !fe->f_İ->
»addœ
)

28 
out
;

30 
»s
 = 
	`£cur™y_fe_³rmissiÚ
(
fe
, 
MAY_READ
);

31 ià(
»s
)

32 
out
;

34 
»s
 = 
	`mu‹x_lock_kÏbË
(&
šode
->
i_mu‹x
);

35 ià(
»s
)

36 
out
;

38 
»s
 = -
ENOENT
;

39 ià(!
	`IS_DEADDIR
(
šode
)) {

40 
»s
 = 
fe
->
f_İ
->
	`»addœ
(fe, 
buf
, 
fËr
);

41 
	`fe_acûs£d
(
fe
);

43 
	`mu‹x_uÆock
(&
šode
->
i_mu‹x
);

44 
out
:

45  
»s
;

46 
	}
}

48 
EXPORT_SYMBOL
(
vfs_»addœ
);

59 #ifdeà
__ARCH_WANT_OLD_READDIR


61 
	sŞd_lšux_dœ’t
 {

62 
	md_šo
;

63 
	md_off£t
;

64 
	md_ÇmËn
;

65 
	md_Çme
[1];

68 
	s»addœ_ÿÎback
 {

69 
Şd_lšux_dœ’t
 
__u£r
 * 
	mdœ’t
;

70 
	m»suÉ
;

73 
	$flÚedœ
(* 
__buf
, cÚ¡ * 
Çme
, 
ÇmËn
, 
loff_t
 
off£t
,

74 
u64
 
šo
, 
d_ty³
)

76 
»addœ_ÿÎback
 * 
buf
 = (»addœ_ÿÎback *è
__buf
;

77 
Şd_lšux_dœ’t
 
__u£r
 * 
dœ’t
;

78 
d_šo
;

80 ià(
buf
->
»suÉ
)

81  -
EINVAL
;

82 
d_šo
 = 
šo
;

83 ià((
d_šo
è< (
šo
) && d_ino != ino) {

84 
buf
->
»suÉ
 = -
EOVERFLOW
;

85  -
EOVERFLOW
;

87 
buf
->
»suÉ
++;

88 
dœ’t
 = 
buf
->dirent;

89 ià(!
	`acûss_ok
(
VERIFY_WRITE
, 
dœ’t
,

90 ()(
dœ’t
->
d_Çme
 + 
ÇmËn
 + 1) -

91 ()
dœ’t
))

92 
eçuÉ
;

93 iàĞ
	`__put_u£r
(
d_šo
, &
dœ’t
->d_ino) ||

94 
	`__put_u£r
(
off£t
, &
dœ’t
->
d_off£t
) ||

95 
	`__put_u£r
(
ÇmËn
, &
dœ’t
->
d_ÇmËn
) ||

96 
	`__cİy_to_u£r
(
dœ’t
->
d_Çme
, 
Çme
, 
ÇmËn
) ||

97 
	`__put_u£r
(0, 
dœ’t
->
d_Çme
 + 
ÇmËn
))

98 
eçuÉ
;

100 
eçuÉ
:

101 
buf
->
»suÉ
 = -
EFAULT
;

102  -
EFAULT
;

103 
	}
}

105 
	$SYSCALL_DEFINE3
(
Şd_»addœ
, , 
fd
,

106 
Şd_lšux_dœ’t
 
__u£r
 *, 
dœ’t
, , 
couÁ
)

108 
”rÜ
;

109 
fe
 * file;

110 
»addœ_ÿÎback
 
buf
;

112 
”rÜ
 = -
EBADF
;

113 
fe
 = 
	`fg‘
(
fd
);

114 ià(!
fe
)

115 
out
;

117 
buf
.
»suÉ
 = 0;

118 
buf
.
dœ’t
 = dirent;

120 
”rÜ
 = 
	`vfs_»addœ
(
fe
, 
flÚedœ
, &
buf
);

121 ià(
buf
.
»suÉ
)

122 
”rÜ
 = 
buf
.
»suÉ
;

124 
	`åut
(
fe
);

125 
out
:

126  
”rÜ
;

127 
	}
}

135 
	slšux_dœ’t
 {

136 
	md_šo
;

137 
	md_off
;

138 
	md_»ş’
;

139 
	md_Çme
[1];

142 
	sg‘d’ts_ÿÎback
 {

143 
lšux_dœ’t
 
__u£r
 * 
	mcu¼’t_dœ
;

144 
lšux_dœ’t
 
__u£r
 * 
	m´evious
;

145 
	mcouÁ
;

146 
	m”rÜ
;

149 
	$fldœ
(* 
__buf
, cÚ¡ * 
Çme
, 
ÇmËn
, 
loff_t
 
off£t
,

150 
u64
 
šo
, 
d_ty³
)

152 
lšux_dœ’t
 
__u£r
 * 
dœ’t
;

153 
g‘d’ts_ÿÎback
 * 
buf
 = (g‘d’ts_ÿÎback *è
__buf
;

154 
d_šo
;

155 
»ş’
 = 
	`ALIGN
(
	`off£tof
(
lšux_dœ’t
, 
d_Çme
è+ 
ÇmËn
 + 2,

158 
buf
->
”rÜ
 = -
EINVAL
;

159 ià(
»ş’
 > 
buf
->
couÁ
)

160  -
EINVAL
;

161 
d_šo
 = 
šo
;

162 ià((
d_šo
è< (
šo
) && d_ino != ino) {

163 
buf
->
”rÜ
 = -
EOVERFLOW
;

164  -
EOVERFLOW
;

166 
dœ’t
 = 
buf
->
´evious
;

167 ià(
dœ’t
) {

168 ià(
	`__put_u£r
(
off£t
, &
dœ’t
->
d_off
))

169 
eçuÉ
;

171 
dœ’t
 = 
buf
->
cu¼’t_dœ
;

172 ià(
	`__put_u£r
(
d_šo
, &
dœ’t
->d_ino))

173 
eçuÉ
;

174 ià(
	`__put_u£r
(
»ş’
, &
dœ’t
->
d_»ş’
))

175 
eçuÉ
;

176 ià(
	`cİy_to_u£r
(
dœ’t
->
d_Çme
, 
Çme
, 
ÇmËn
))

177 
eçuÉ
;

178 ià(
	`__put_u£r
(0, 
dœ’t
->
d_Çme
 + 
ÇmËn
))

179 
eçuÉ
;

180 ià(
	`__put_u£r
(
d_ty³
, (
__u£r
 *è
dœ’t
 + 
»ş’
 - 1))

181 
eçuÉ
;

182 
buf
->
´evious
 = 
dœ’t
;

183 
dœ’t
 = (
__u£r
 *)dœ’ˆ+ 
»ş’
;

184 
buf
->
cu¼’t_dœ
 = 
dœ’t
;

185 
buf
->
couÁ
 -ğ
»ş’
;

187 
eçuÉ
:

188 
buf
->
”rÜ
 = -
EFAULT
;

189  -
EFAULT
;

190 
	}
}

192 
	$SYSCALL_DEFINE3
(
g‘d’ts
, , 
fd
,

193 
lšux_dœ’t
 
__u£r
 *, 
dœ’t
, , 
couÁ
)

195 
fe
 * file;

196 
lšux_dœ’t
 
__u£r
 * 
Ï¡dœ’t
;

197 
g‘d’ts_ÿÎback
 
buf
;

198 
”rÜ
;

200 
”rÜ
 = -
EFAULT
;

201 ià(!
	`acûss_ok
(
VERIFY_WRITE
, 
dœ’t
, 
couÁ
))

202 
out
;

204 
”rÜ
 = -
EBADF
;

205 
fe
 = 
	`fg‘
(
fd
);

206 ià(!
fe
)

207 
out
;

209 
buf
.
cu¼’t_dœ
 = 
dœ’t
;

210 
buf
.
´evious
 = 
NULL
;

211 
buf
.
couÁ
 = count;

212 
buf
.
”rÜ
 = 0;

214 
”rÜ
 = 
	`vfs_»addœ
(
fe
, 
fldœ
, &
buf
);

215 ià(
”rÜ
 >= 0)

216 
”rÜ
 = 
buf
.error;

217 
Ï¡dœ’t
 = 
buf
.
´evious
;

218 ià(
Ï¡dœ’t
) {

219 ià(
	`put_u£r
(
fe
->
f_pos
, &
Ï¡dœ’t
->
d_off
))

220 
”rÜ
 = -
EFAULT
;

222 
”rÜ
 = 
couÁ
 - 
buf
.count;

224 
	`åut
(
fe
);

225 
out
:

226  
”rÜ
;

227 
	}
}

229 
	sg‘d’ts_ÿÎback64
 {

230 
lšux_dœ’t64
 
__u£r
 * 
	mcu¼’t_dœ
;

231 
lšux_dœ’t64
 
__u£r
 * 
	m´evious
;

232 
	mcouÁ
;

233 
	m”rÜ
;

236 
	$fldœ64
(* 
__buf
, cÚ¡ * 
Çme
, 
ÇmËn
, 
loff_t
 
off£t
,

237 
u64
 
šo
, 
d_ty³
)

239 
lšux_dœ’t64
 
__u£r
 *
dœ’t
;

240 
g‘d’ts_ÿÎback64
 * 
buf
 = (g‘d’ts_ÿÎback64 *è
__buf
;

241 
»ş’
 = 
	`ALIGN
(
	`off£tof
(
lšux_dœ’t64
, 
d_Çme
è+ 
ÇmËn
 + 1,

242 (
u64
));

244 
buf
->
”rÜ
 = -
EINVAL
;

245 ià(
»ş’
 > 
buf
->
couÁ
)

246  -
EINVAL
;

247 
dœ’t
 = 
buf
->
´evious
;

248 ià(
dœ’t
) {

249 ià(
	`__put_u£r
(
off£t
, &
dœ’t
->
d_off
))

250 
eçuÉ
;

252 
dœ’t
 = 
buf
->
cu¼’t_dœ
;

253 ià(
	`__put_u£r
(
šo
, &
dœ’t
->
d_šo
))

254 
eçuÉ
;

255 ià(
	`__put_u£r
(0, &
dœ’t
->
d_off
))

256 
eçuÉ
;

257 ià(
	`__put_u£r
(
»ş’
, &
dœ’t
->
d_»ş’
))

258 
eçuÉ
;

259 ià(
	`__put_u£r
(
d_ty³
, &
dœ’t
->d_type))

260 
eçuÉ
;

261 ià(
	`cİy_to_u£r
(
dœ’t
->
d_Çme
, 
Çme
, 
ÇmËn
))

262 
eçuÉ
;

263 ià(
	`__put_u£r
(0, 
dœ’t
->
d_Çme
 + 
ÇmËn
))

264 
eçuÉ
;

265 
buf
->
´evious
 = 
dœ’t
;

266 
dœ’t
 = (
__u£r
 *)dœ’ˆ+ 
»ş’
;

267 
buf
->
cu¼’t_dœ
 = 
dœ’t
;

268 
buf
->
couÁ
 -ğ
»ş’
;

270 
eçuÉ
:

271 
buf
->
”rÜ
 = -
EFAULT
;

272  -
EFAULT
;

273 
	}
}

275 
	$SYSCALL_DEFINE3
(
g‘d’ts64
, , 
fd
,

276 
lšux_dœ’t64
 
__u£r
 *, 
dœ’t
, , 
couÁ
)

278 
fe
 * file;

279 
lšux_dœ’t64
 
__u£r
 * 
Ï¡dœ’t
;

280 
g‘d’ts_ÿÎback64
 
buf
;

281 
”rÜ
;

283 
”rÜ
 = -
EFAULT
;

284 ià(!
	`acûss_ok
(
VERIFY_WRITE
, 
dœ’t
, 
couÁ
))

285 
out
;

287 
”rÜ
 = -
EBADF
;

288 
fe
 = 
	`fg‘
(
fd
);

289 ià(!
fe
)

290 
out
;

292 
buf
.
cu¼’t_dœ
 = 
dœ’t
;

293 
buf
.
´evious
 = 
NULL
;

294 
buf
.
couÁ
 = count;

295 
buf
.
”rÜ
 = 0;

297 
”rÜ
 = 
	`vfs_»addœ
(
fe
, 
fldœ64
, &
buf
);

298 ià(
”rÜ
 >= 0)

299 
”rÜ
 = 
buf
.error;

300 
Ï¡dœ’t
 = 
buf
.
´evious
;

301 ià(
Ï¡dœ’t
) {

302 
	`ty³of
(
Ï¡dœ’t
->
d_off
èd_ofàğ
fe
->
f_pos
;

303 ià(
	`__put_u£r
(
d_off
, &
Ï¡dœ’t
->d_off))

304 
”rÜ
 = -
EFAULT
;

306 
”rÜ
 = 
couÁ
 - 
buf
.count;

308 
	`åut
(
fe
);

309 
out
:

310  
”rÜ
;

311 
	}
}

	@select.c

17 
	~<lšux/k”Ãl.h
>

18 
	~<lšux/sched.h
>

19 
	~<lšux/sysÿÎs.h
>

20 
	~<lšux/moduË.h
>

21 
	~<lšux/¦ab.h
>

22 
	~<lšux/pŞl.h
>

23 
	~<lšux/³rsÚ®™y.h
>

24 
	~<lšux/fe.h
>

25 
	~<lšux/fdbË.h
>

26 
	~<lšux/fs.h
>

27 
	~<lšux/rcupd©e.h
>

28 
	~<lšux/h¹im”.h
>

30 
	~<asm/uacûss.h
>

45 
	#MAX_SLACK
 (100 * 
NSEC_PER_MSEC
)

	)

47 
	$__e¡im©e_accu¿cy
(
time¥ec
 *
tv
)

49 
¦ack
;

50 
divçùÜ
 = 1000;

52 ià(
tv
->
tv_£c
 < 0)

55 ià(
	`sk_niû
(
cu¼’t
) > 0)

56 
divçùÜ
 = divfactor / 5;

58 ià(
tv
->
tv_£c
 > 
MAX_SLACK
 / (
NSEC_PER_SEC
/
divçùÜ
))

59  
MAX_SLACK
;

61 
¦ack
 = 
tv
->
tv_n£c
 / 
divçùÜ
;

62 
¦ack
 +ğ
tv
->
tv_£c
 * (
NSEC_PER_SEC
/
divçùÜ
);

64 ià(
¦ack
 > 
MAX_SLACK
)

65  
MAX_SLACK
;

67  
¦ack
;

68 
	}
}

70 
	$£Ëù_e¡im©e_accu¿cy
(
time¥ec
 *
tv
)

72 
»t
;

73 
time¥ec
 
now
;

79 ià(
	`¹_sk
(
cu¼’t
))

82 
	`ktime_g‘_ts
(&
now
);

83 
now
 = 
	`time¥ec_sub
(*
tv
,‚ow);

84 
»t
 = 
	`__e¡im©e_accu¿cy
(&
now
);

85 ià(
»t
 < 
cu¼’t
->
tim”_¦ack_ns
)

86  
cu¼’t
->
tim”_¦ack_ns
;

87  
»t
;

88 
	}
}

92 
	spŞl_bË_·ge
 {

93 
pŞl_bË_·ge
 * 
	mÃxt
;

94 
pŞl_bË_’Œy
 * 
	m’Œy
;

95 
pŞl_bË_’Œy
 
	m’Œ›s
[0];

98 
	#POLL_TABLE_FULL
(
bË
) \

99 (()((
bË
)->
’Œy
+1è> 
PAGE_SIZE
 + ()ÑabË))

	)

113 
__pŞlwa™
(
fe
 *
fp
, 
wa™_queue_h—d_t
 *
wa™_add»ss
,

114 
pŞl_bË
 *
p
);

116 
	$pŞl_š™wa™
(
pŞl_wqueues
 *
pwq
)

118 
	`š™_pŞl_funıŒ
(&
pwq
->
±
, 
__pŞlwa™
);

119 
pwq
->
pŞlšg_sk
 = 
cu¼’t
;

120 
pwq
->
Œigg”ed
 = 0;

121 
pwq
->
”rÜ
 = 0;

122 
pwq
->
bË
 = 
NULL
;

123 
pwq
->
šlše_šdex
 = 0;

124 
	}
}

125 
EXPORT_SYMBOL
(
pŞl_š™wa™
);

127 
	$ä“_pŞl_’Œy
(
pŞl_bË_’Œy
 *
’Œy
)

129 
	`»move_wa™_queue
(
’Œy
->
wa™_add»ss
, &’Œy->
wa™
);

130 
	`åut
(
’Œy
->
fp
);

131 
	}
}

133 
	$pŞl_ä“wa™
(
pŞl_wqueues
 *
pwq
)

135 
pŞl_bË_·ge
 * 
p
 = 
pwq
->
bË
;

136 
i
;

137 
i
 = 0; i < 
pwq
->
šlše_šdex
; i++)

138 
	`ä“_pŞl_’Œy
(
pwq
->
šlše_’Œ›s
 + 
i
);

139 
p
) {

140 
pŞl_bË_’Œy
 * 
’Œy
;

141 
pŞl_bË_·ge
 *
Şd
;

143 
’Œy
 = 
p
->entry;

145 
’Œy
--;

146 
	`ä“_pŞl_’Œy
(
’Œy
);

147 } 
’Œy
 > 
p
->
’Œ›s
);

148 
Şd
 = 
p
;

149 
p
 =…->
Ãxt
;

150 
	`ä“_·ge
((è
Şd
);

152 
	}
}

153 
EXPORT_SYMBOL
(
pŞl_ä“wa™
);

155 
pŞl_bË_’Œy
 *
	$pŞl_g‘_’Œy
(
pŞl_wqueues
 *
p
)

157 
pŞl_bË_·ge
 *
bË
 = 
p
->table;

159 ià(
p
->
šlše_šdex
 < 
N_INLINE_POLL_ENTRIES
)

160  
p
->
šlše_’Œ›s
 +…->
šlše_šdex
++;

162 ià(!
bË
 || 
	`POLL_TABLE_FULL
(table)) {

163 
pŞl_bË_·ge
 *
Ãw_bË
;

165 
Ãw_bË
 = (
pŞl_bË_·ge
 *è
	`__g‘_ä“_·ge
(
GFP_KERNEL
);

166 ià(!
Ãw_bË
) {

167 
p
->
”rÜ
 = -
ENOMEM
;

168  
NULL
;

170 
Ãw_bË
->
’Œy
 =‚ew_bË->
’Œ›s
;

171 
Ãw_bË
->
Ãxt
 = 
bË
;

172 
p
->
bË
 = 
Ãw_bË
;

173 
bË
 = 
Ãw_bË
;

176  
bË
->
’Œy
++;

177 
	}
}

179 
	$__pŞlwake
(
wa™_queue_t
 *
wa™
, 
mode
, 
sync
, *
key
)

181 
pŞl_wqueues
 *
pwq
 = 
wa™
->
´iv©e
;

182 
	`DECLARE_WAITQUEUE
(
dummy_wa™
, 
pwq
->
pŞlšg_sk
);

191 
	`smp_wmb
();

192 
pwq
->
Œigg”ed
 = 1;

202  
	`deçuÉ_wake_funùiÚ
(&
dummy_wa™
, 
mode
, 
sync
, 
key
);

203 
	}
}

205 
	$pŞlwake
(
wa™_queue_t
 *
wa™
, 
mode
, 
sync
, *
key
)

207 
pŞl_bË_’Œy
 *
’Œy
;

209 
’Œy
 = 
	`cÚš”_of
(
wa™
, 
pŞl_bË_’Œy
, wait);

210 ià(
key
 && !(()key & 
’Œy
->key))

212  
	`__pŞlwake
(
wa™
, 
mode
, 
sync
, 
key
);

213 
	}
}

216 
	$__pŞlwa™
(
fe
 *
fp
, 
wa™_queue_h—d_t
 *
wa™_add»ss
,

217 
pŞl_bË
 *
p
)

219 
pŞl_wqueues
 *
pwq
 = 
	`cÚš”_of
(
p
, pŞl_wqueues, 
±
);

220 
pŞl_bË_’Œy
 *
’Œy
 = 
	`pŞl_g‘_’Œy
(
pwq
);

221 ià(!
’Œy
)

223 
	`g‘_fe
(
fp
);

224 
’Œy
->
fp
 = filp;

225 
’Œy
->
wa™_add»ss
 = wait_address;

226 
’Œy
->
key
 = 
p
->key;

227 
	`š™_wa™queue_func_’Œy
(&
’Œy
->
wa™
, 
pŞlwake
);

228 
’Œy
->
wa™
.
´iv©e
 = 
pwq
;

229 
	`add_wa™_queue
(
wa™_add»ss
, &
’Œy
->
wa™
);

230 
	}
}

232 
	$pŞl_scheduË_timeout
(
pŞl_wqueues
 *
pwq
, 
¡©e
,

233 
ktime_t
 *
expœes
, 
¦ack
)

235 
rc
 = -
EINTR
;

237 
	`£t_cu¼’t_¡©e
(
¡©e
);

238 ià(!
pwq
->
Œigg”ed
)

239 
rc
 = 
	`scheduË_h¹imeout_¿nge
(
expœes
, 
¦ack
, 
HRTIMER_MODE_ABS
);

240 
	`__£t_cu¼’t_¡©e
(
TASK_RUNNING
);

253 
	`£t_mb
(
pwq
->
Œigg”ed
, 0);

255  
rc
;

256 
	}
}

257 
EXPORT_SYMBOL
(
pŞl_scheduË_timeout
);

270 
	$pŞl_£Ëù_£t_timeout
(
time¥ec
 *
to
, 
£c
, 
n£c
)

272 
time¥ec
 
ts
 = {.
tv_£c
 = 
£c
, .
tv_n£c
 = 
n£c
};

274 ià(!
	`time¥ec_v®id
(&
ts
))

275  -
EINVAL
;

278 ià(!
£c
 && !
n£c
) {

279 
to
->
tv_£c
 =o->
tv_n£c
 = 0;

281 
	`ktime_g‘_ts
(
to
);

282 *
to
 = 
	`time¥ec_add_§ã
(*to, 
ts
);

285 
	}
}

287 
	$pŞl_£Ëù_cİy_»maššg
(
time¥ec
 *
’d_time
, 
__u£r
 *
p
,

288 
timev®
, 
»t
)

290 
time¥ec
 
¹s
;

291 
timev®
 
¹v
;

293 ià(!
p
)

294  
»t
;

296 ià(
cu¼’t
->
³rsÚ®™y
 & 
STICKY_TIMEOUTS
)

297 
¡icky
;

300 ià(!
’d_time
->
tv_£c
 && !’d_time->
tv_n£c
)

301  
»t
;

303 
	`ktime_g‘_ts
(&
¹s
);

304 
¹s
 = 
	`time¥ec_sub
(*
’d_time
,„ts);

305 ià(
¹s
.
tv_£c
 < 0)

306 
¹s
.
tv_£c
 =„ts.
tv_n£c
 = 0;

308 ià(
timev®
) {

309 ià((
¹v
è> Ôtv.
tv_£c
è+ Ôtv.
tv_u£c
))

310 
	`mem£t
(&
¹v
, 0, (rtv));

311 
¹v
.
tv_£c
 = 
¹s
.tv_sec;

312 
¹v
.
tv_u£c
 = 
¹s
.
tv_n£c
 / 
NSEC_PER_USEC
;

314 ià(!
	`cİy_to_u£r
(
p
, &
¹v
, (rtv)))

315  
»t
;

317 } ià(!
	`cİy_to_u£r
(
p
, &
¹s
, (rts)))

318  
»t
;

328 
¡icky
:

329 ià(
»t
 =ğ-
ERESTARTNOHAND
)

330 
»t
 = -
EINTR
;

331  
»t
;

332 
	}
}

334 
	#FDS_IN
(
fds
, 
n
è(fds->
š
 +‚)

	)

335 
	#FDS_OUT
(
fds
, 
n
è(fds->
out
 +‚)

	)

336 
	#FDS_EX
(
fds
, 
n
è(fds->
ex
 +‚)

	)

338 
	#BITS
(
fds
, 
n
è(*
	`FDS_IN
(fds,‚)|*
	`FDS_OUT
(fds,‚)|*
	`FDS_EX
(fds,‚))

	)

340 
	$max_£Ëù_fd
(
n
, 
fd_£t_b™s
 *
fds
)

342 *
İ’_fds
;

343 
£t
;

344 
max
;

345 
fdbË
 *
fdt
;

348 
£t
 = ~(~0UL << (
n
 & (
__NFDBITS
-1)));

349 
n
 /ğ
__NFDBITS
;

350 
fdt
 = 
	`fes_fdbË
(
cu¼’t
->
fes
);

351 
İ’_fds
 = 
fdt
->İ’_fds->
fds_b™s
+
n
;

352 
max
 = 0;

353 ià(
£t
) {

354 
£t
 &ğ
	`BITS
(
fds
, 
n
);

355 ià(
£t
) {

356 ià(!(
£t
 & ~*
İ’_fds
))

357 
g‘_max
;

358  -
EBADF
;

361 
n
) {

362 
İ’_fds
--;

363 
n
--;

364 
£t
 = 
	`BITS
(
fds
, 
n
);

365 ià(!
£t
)

367 ià(
£t
 & ~*
İ’_fds
)

368  -
EBADF
;

369 ià(
max
)

371 
g‘_max
:

373 
max
++;

374 
£t
 >>= 1;

375 } 
£t
);

376 
max
 +ğ
n
 * 
__NFDBITS
;

379  
max
;

380 
	}
}

382 
	#POLLIN_SET
 (
POLLRDNORM
 | 
POLLRDBAND
 | 
POLLIN
 | 
POLLHUP
 | 
POLLERR
)

	)

383 
	#POLLOUT_SET
 (
POLLWRBAND
 | 
POLLWRNORM
 | 
POLLOUT
 | 
POLLERR
)

	)

384 
	#POLLEX_SET
 (
POLLPRI
)

	)

386 
šlše
 
	$wa™_key_£t
(
pŞl_bË
 *
wa™
, 
š
,

387 
out
, 
b™
)

389 ià(
wa™
) {

390 
wa™
->
key
 = 
POLLEX_SET
;

391 ià(
š
 & 
b™
)

392 
wa™
->
key
 |ğ
POLLIN_SET
;

393 ià(
out
 & 
b™
)

394 
wa™
->
key
 |ğ
POLLOUT_SET
;

396 
	}
}

398 
	$do_£Ëù
(
n
, 
fd_£t_b™s
 *
fds
, 
time¥ec
 *
’d_time
)

400 
ktime_t
 
expœe
, *
to
 = 
NULL
;

401 
pŞl_wqueues
 
bË
;

402 
pŞl_bË
 *
wa™
;

403 
»tv®
, 
i
, 
timed_out
 = 0;

404 
¦ack
 = 0;

406 
	`rcu_»ad_lock
();

407 
»tv®
 = 
	`max_£Ëù_fd
(
n
, 
fds
);

408 
	`rcu_»ad_uÆock
();

410 ià(
»tv®
 < 0)

411  
»tv®
;

412 
n
 = 
»tv®
;

414 
	`pŞl_š™wa™
(&
bË
);

415 
wa™
 = &
bË
.
±
;

416 ià(
’d_time
 && !’d_time->
tv_£c
 && !’d_time->
tv_n£c
) {

417 
wa™
 = 
NULL
;

418 
timed_out
 = 1;

421 ià(
’d_time
 && !
timed_out
)

422 
¦ack
 = 
	`£Ëù_e¡im©e_accu¿cy
(
’d_time
);

424 
»tv®
 = 0;

426 *
ršp
, *
rou
, *
»xp
, *
šp
, *
ou
, *
exp
;

428 
šp
 = 
fds
->
š
; 
ou
 = fds->
out
; 
exp
 = fds->
ex
;

429 
ršp
 = 
fds
->
»s_š
; 
rou
 = fds->
»s_out
; 
»xp
 = fds->
»s_ex
;

431 
i
 = 0; i < 
n
; ++
ršp
, ++
rou
, ++
»xp
) {

432 
š
, 
out
, 
ex
, 
®l_b™s
, 
b™
 = 1, 
mask
, 
j
;

433 
»s_š
 = 0, 
»s_out
 = 0, 
»s_ex
 = 0;

434 cÚ¡ 
fe_İ”©iÚs
 *
f_İ
 = 
NULL
;

435 
fe
 *fğ
NULL
;

437 
š
 = *
šp
++; 
out
 = *
ou
++; 
ex
 = *
exp
++;

438 
®l_b™s
 = 
š
 | 
out
 | 
ex
;

439 ià(
®l_b™s
 == 0) {

440 
i
 +ğ
__NFDBITS
;

444 
j
 = 0; j < 
__NFDBITS
; ++j, ++
i
, 
b™
 <<= 1) {

445 
åut_Ãeded
;

446 ià(
i
 >ğ
n
)

448 ià(!(
b™
 & 
®l_b™s
))

450 
fe
 = 
	`fg‘_light
(
i
, &
åut_Ãeded
);

451 ià(
fe
) {

452 
f_İ
 = 
fe
->f_op;

453 
mask
 = 
DEFAULT_POLLMASK
;

454 ià(
f_İ
 && f_İ->
pŞl
) {

455 
	`wa™_key_£t
(
wa™
, 
š
, 
out
, 
b™
);

456 
mask
 = (*
f_İ
->
pŞl
)(
fe
, 
wa™
);

458 
	`åut_light
(
fe
, 
åut_Ãeded
);

459 ià((
mask
 & 
POLLIN_SET
è&& (
š
 & 
b™
)) {

460 
»s_š
 |ğ
b™
;

461 
»tv®
++;

462 
wa™
 = 
NULL
;

464 ià((
mask
 & 
POLLOUT_SET
è&& (
out
 & 
b™
)) {

465 
»s_out
 |ğ
b™
;

466 
»tv®
++;

467 
wa™
 = 
NULL
;

469 ià((
mask
 & 
POLLEX_SET
è&& (
ex
 & 
b™
)) {

470 
»s_ex
 |ğ
b™
;

471 
»tv®
++;

472 
wa™
 = 
NULL
;

476 ià(
»s_š
)

477 *
ršp
 = 
»s_š
;

478 ià(
»s_out
)

479 *
rou
 = 
»s_out
;

480 ià(
»s_ex
)

481 *
»xp
 = 
»s_ex
;

482 
	`cÚd_»sched
();

484 
wa™
 = 
NULL
;

485 ià(
»tv®
 || 
timed_out
 || 
	`sigÇl_³ndšg
(
cu¼’t
))

487 ià(
bË
.
”rÜ
) {

488 
»tv®
 = 
bË
.
”rÜ
;

497 ià(
’d_time
 && !
to
) {

498 
expœe
 = 
	`time¥ec_to_ktime
(*
’d_time
);

499 
to
 = &
expœe
;

502 ià(!
	`pŞl_scheduË_timeout
(&
bË
, 
TASK_INTERRUPTIBLE
,

503 
to
, 
¦ack
))

504 
timed_out
 = 1;

507 
	`pŞl_ä“wa™
(&
bË
);

509  
»tv®
;

510 
	}
}

520 
	$cÜe_sys_£Ëù
(
n
, 
fd_£t
 
__u£r
 *
šp
, fd_£ˆ__u£¸*
ou
,

521 
fd_£t
 
__u£r
 *
exp
, 
time¥ec
 *
’d_time
)

523 
fd_£t_b™s
 
fds
;

524 *
b™s
;

525 
»t
, 
max_fds
;

526 
size
;

527 
fdbË
 *
fdt
;

529 
¡ack_fds
[
SELECT_STACK_ALLOC
/()];

531 
»t
 = -
EINVAL
;

532 ià(
n
 < 0)

533 
out_nofds
;

536 
	`rcu_»ad_lock
();

537 
fdt
 = 
	`fes_fdbË
(
cu¼’t
->
fes
);

538 
max_fds
 = 
fdt
->max_fds;

539 
	`rcu_»ad_uÆock
();

540 ià(
n
 > 
max_fds
)

541 
n
 = 
max_fds
;

548 
size
 = 
	`FDS_BYTES
(
n
);

549 
b™s
 = 
¡ack_fds
;

550 ià(
size
 > (
¡ack_fds
) / 6) {

552 
»t
 = -
ENOMEM
;

553 
b™s
 = 
	`km®loc
(6 * 
size
, 
GFP_KERNEL
);

554 ià(!
b™s
)

555 
out_nofds
;

557 
fds
.
š
 = 
b™s
;

558 
fds
.
out
 = 
b™s
 + 
size
;

559 
fds
.
ex
 = 
b™s
 + 2*
size
;

560 
fds
.
»s_š
 = 
b™s
 + 3*
size
;

561 
fds
.
»s_out
 = 
b™s
 + 4*
size
;

562 
fds
.
»s_ex
 = 
b™s
 + 5*
size
;

564 ià((
»t
 = 
	`g‘_fd_£t
(
n
, 
šp
, 
fds
.
š
)) ||

565 (
»t
 = 
	`g‘_fd_£t
(
n
, 
ou
, 
fds
.
out
)) ||

566 (
»t
 = 
	`g‘_fd_£t
(
n
, 
exp
, 
fds
.
ex
)))

567 
out
;

568 
	`z”o_fd_£t
(
n
, 
fds
.
»s_š
);

569 
	`z”o_fd_£t
(
n
, 
fds
.
»s_out
);

570 
	`z”o_fd_£t
(
n
, 
fds
.
»s_ex
);

572 
»t
 = 
	`do_£Ëù
(
n
, &
fds
, 
’d_time
);

574 ià(
»t
 < 0)

575 
out
;

576 ià(!
»t
) {

577 
»t
 = -
ERESTARTNOHAND
;

578 ià(
	`sigÇl_³ndšg
(
cu¼’t
))

579 
out
;

580 
»t
 = 0;

583 ià(
	`£t_fd_£t
(
n
, 
šp
, 
fds
.
»s_š
) ||

584 
	`£t_fd_£t
(
n
, 
ou
, 
fds
.
»s_out
) ||

585 
	`£t_fd_£t
(
n
, 
exp
, 
fds
.
»s_ex
))

586 
»t
 = -
EFAULT
;

588 
out
:

589 ià(
b™s
 !ğ
¡ack_fds
)

590 
	`kä“
(
b™s
);

591 
out_nofds
:

592  
»t
;

593 
	}
}

595 
	$SYSCALL_DEFINE5
(
£Ëù
, , 
n
, 
fd_£t
 
__u£r
 *, 
šp
, fd_£ˆ__u£¸*, 
ou
,

596 
fd_£t
 
__u£r
 *, 
exp
, 
timev®
 __u£¸*, 
tvp
)

598 
time¥ec
 
’d_time
, *
to
 = 
NULL
;

599 
timev®
 
tv
;

600 
»t
;

602 ià(
tvp
) {

603 ià(
	`cİy_äom_u£r
(&
tv
, 
tvp
, (tv)))

604  -
EFAULT
;

606 
to
 = &
’d_time
;

607 ià(
	`pŞl_£Ëù_£t_timeout
(
to
,

608 
tv
.
tv_£c
 + (tv.
tv_u£c
 / 
USEC_PER_SEC
),

609 (
tv
.
tv_u£c
 % 
USEC_PER_SEC
è* 
NSEC_PER_USEC
))

610  -
EINVAL
;

613 
»t
 = 
	`cÜe_sys_£Ëù
(
n
, 
šp
, 
ou
, 
exp
, 
to
);

614 
»t
 = 
	`pŞl_£Ëù_cİy_»maššg
(&
’d_time
, 
tvp
, 1,„et);

616  
»t
;

617 
	}
}

619 #ifdeà
HAVE_SET_RESTORE_SIGMASK


620 
	$do_p£Ëù
(
n
, 
fd_£t
 
__u£r
 *
šp
, fd_£ˆ__u£¸*
ou
,

621 
fd_£t
 
__u£r
 *
exp
, 
time¥ec
 __u£¸*
t¥
,

622 cÚ¡ 
sig£t_t
 
__u£r
 *
sigmask
, 
size_t
 
sig£tsize
)

624 
sig£t_t
 
ksigmask
, 
sig§ved
;

625 
time¥ec
 
ts
, 
’d_time
, *
to
 = 
NULL
;

626 
»t
;

628 ià(
t¥
) {

629 ià(
	`cİy_äom_u£r
(&
ts
, 
t¥
, (ts)))

630  -
EFAULT
;

632 
to
 = &
’d_time
;

633 ià(
	`pŞl_£Ëù_£t_timeout
(
to
, 
ts
.
tv_£c
,s.
tv_n£c
))

634  -
EINVAL
;

637 ià(
sigmask
) {

639 ià(
sig£tsize
 !ğ(
sig£t_t
))

640  -
EINVAL
;

641 ià(
	`cİy_äom_u£r
(&
ksigmask
, 
sigmask
, (ksigmask)))

642  -
EFAULT
;

644 
	`sigd–£tmask
(&
ksigmask
, 
	`sigmask
(
SIGKILL
)|sigmask(
SIGSTOP
));

645 
	`sig´ocmask
(
SIG_SETMASK
, &
ksigmask
, &
sig§ved
);

648 
»t
 = 
	`cÜe_sys_£Ëù
(
n
, 
šp
, 
ou
, 
exp
, 
to
);

649 
»t
 = 
	`pŞl_£Ëù_cİy_»maššg
(&
’d_time
, 
t¥
, 0,„et);

651 ià(
»t
 =ğ-
ERESTARTNOHAND
) {

657 ià(
sigmask
) {

658 
	`memıy
(&
cu¼’t
->
§ved_sigmask
, &
sig§ved
,

659 (
sig§ved
));

660 
	`£t_»¡Üe_sigmask
();

662 } ià(
sigmask
)

663 
	`sig´ocmask
(
SIG_SETMASK
, &
sig§ved
, 
NULL
);

665  
»t
;

666 
	}
}

674 
	$SYSCALL_DEFINE6
(
p£Ëù6
, , 
n
, 
fd_£t
 
__u£r
 *, 
šp
, fd_£ˆ__u£¸*, 
ou
,

675 
fd_£t
 
__u£r
 *, 
exp
, 
time¥ec
 __u£¸*, 
t¥
,

676 
__u£r
 *, 
sig
)

678 
size_t
 
sig£tsize
 = 0;

679 
sig£t_t
 
__u£r
 *
up
 = 
NULL
;

681 ià(
sig
) {

682 ià(!
	`acûss_ok
(
VERIFY_READ
, 
sig
, (*)+(
size_t
))

683 || 
	`__g‘_u£r
(
up
, (
sig£t_t
 
__u£r
 * __u£¸*)
sig
)

684 || 
	`__g‘_u£r
(
sig£tsize
,

685 (
size_t
 
__u£r
 *)(
sig
+(*))))

686  -
EFAULT
;

689  
	`do_p£Ëù
(
n
, 
šp
, 
ou
, 
exp
, 
t¥
, 
up
, 
sig£tsize
);

690 
	}
}

693 #ifdeà
__ARCH_WANT_SYS_OLD_SELECT


694 
	s£l_¬g_¡ruù
 {

695 
	mn
;

696 
fd_£t
 
__u£r
 *
	mšp
, *
	mou
, *
	mexp
;

697 
timev®
 
__u£r
 *
	mtvp
;

700 
	$SYSCALL_DEFINE1
(
Şd_£Ëù
, 
£l_¬g_¡ruù
 
__u£r
 *, 
¬g
)

702 
£l_¬g_¡ruù
 
a
;

704 ià(
	`cİy_äom_u£r
(&
a
, 
¬g
, (a)))

705  -
EFAULT
;

706  
	`sys_£Ëù
(
a
.
n
,‡.
šp
,‡.
ou
,‡.
exp
,‡.
tvp
);

707 
	}
}

710 
	spŞl_li¡
 {

711 
pŞl_li¡
 *
	mÃxt
;

712 
	mËn
;

713 
pŞlfd
 
	m’Œ›s
[0];

716 
	#POLLFD_PER_PAGE
 ((
PAGE_SIZE
-(
pŞl_li¡
)è/ (
pŞlfd
))

	)

725 
šlše
 
	$do_pŞlfd
(
pŞlfd
 *pŞlfd, 
pŞl_bË
 *
pwa™
)

727 
mask
;

728 
fd
;

730 
mask
 = 0;

731 
fd
 = 
pŞlfd
->fd;

732 ià(
fd
 >= 0) {

733 
åut_Ãeded
;

734 
fe
 * file;

736 
fe
 = 
	`fg‘_light
(
fd
, &
åut_Ãeded
);

737 
mask
 = 
POLLNVAL
;

738 ià(
fe
 !ğ
NULL
) {

739 
mask
 = 
DEFAULT_POLLMASK
;

740 ià(
fe
->
f_İ
 && fe->f_İ->
pŞl
) {

741 ià(
pwa™
)

742 
pwa™
->
key
 = 
pŞlfd
->
ev’ts
 |

743 
POLLERR
 | 
POLLHUP
;

744 
mask
 = 
fe
->
f_İ
->
	`pŞl
(fe, 
pwa™
);

747 
mask
 &ğ
pŞlfd
->
ev’ts
 | 
POLLERR
 | 
POLLHUP
;

748 
	`åut_light
(
fe
, 
åut_Ãeded
);

751 
pŞlfd
->
»v’ts
 = 
mask
;

753  
mask
;

754 
	}
}

756 
	$do_pŞl
(
nfds
, 
pŞl_li¡
 *
li¡
,

757 
pŞl_wqueues
 *
wa™
, 
time¥ec
 *
’d_time
)

759 
pŞl_bË
* 
±
 = &
wa™
->pt;

760 
ktime_t
 
expœe
, *
to
 = 
NULL
;

761 
timed_out
 = 0, 
couÁ
 = 0;

762 
¦ack
 = 0;

765 ià(
’d_time
 && !’d_time->
tv_£c
 && !’d_time->
tv_n£c
) {

766 
±
 = 
NULL
;

767 
timed_out
 = 1;

770 ià(
’d_time
 && !
timed_out
)

771 
¦ack
 = 
	`£Ëù_e¡im©e_accu¿cy
(
’d_time
);

774 
pŞl_li¡
 *
w®k
;

776 
w®k
 = 
li¡
; w®k !ğ
NULL
; w®k = w®k->
Ãxt
) {

777 
pŞlfd
 * 
pfd
, * 
pfd_’d
;

779 
pfd
 = 
w®k
->
’Œ›s
;

780 
pfd_’d
 = 
pfd
 + 
w®k
->
Ën
;

781 ; 
pfd
 !ğ
pfd_’d
;…fd++) {

789 ià(
	`do_pŞlfd
(
pfd
, 
±
)) {

790 
couÁ
++;

791 
±
 = 
NULL
;

799 
±
 = 
NULL
;

800 ià(!
couÁ
) {

801 
couÁ
 = 
wa™
->
”rÜ
;

802 ià(
	`sigÇl_³ndšg
(
cu¼’t
))

803 
couÁ
 = -
EINTR
;

805 ià(
couÁ
 || 
timed_out
)

813 ià(
’d_time
 && !
to
) {

814 
expœe
 = 
	`time¥ec_to_ktime
(*
’d_time
);

815 
to
 = &
expœe
;

818 ià(!
	`pŞl_scheduË_timeout
(
wa™
, 
TASK_INTERRUPTIBLE
, 
to
, 
¦ack
))

819 
timed_out
 = 1;

821  
couÁ
;

822 
	}
}

824 
	#N_STACK_PPS
 (((
¡ack_µs
è- (
pŞl_li¡
)) / \

825 (
pŞlfd
))

	)

827 
	$do_sys_pŞl
(
pŞlfd
 
__u£r
 *
ufds
, 
nfds
,

828 
time¥ec
 *
’d_time
)

830 
pŞl_wqueues
 
bË
;

831 
”r
 = -
EFAULT
, 
fdcouÁ
, 
Ën
, 
size
;

835 
¡ack_µs
[
POLL_STACK_ALLOC
/()];

836 
pŞl_li¡
 *cÚ¡ 
h—d
 = (pŞl_li¡ *)
¡ack_µs
;

837 
pŞl_li¡
 *
w®k
 = 
h—d
;

838 
todo
 = 
nfds
;

840 ià(
nfds
 > 
	`¾im™
(
RLIMIT_NOFILE
))

841  -
EINVAL
;

843 
Ën
 = 
	`mš_t
(, 
nfds
, 
N_STACK_PPS
);

845 
w®k
->
Ãxt
 = 
NULL
;

846 
w®k
->
Ën
 =†en;

847 ià(!
Ën
)

850 ià(
	`cİy_äom_u£r
(
w®k
->
’Œ›s
, 
ufds
 + 
nfds
-
todo
,

851 (
pŞlfd
è* 
w®k
->
Ën
))

852 
out_fds
;

854 
todo
 -ğ
w®k
->
Ën
;

855 ià(!
todo
)

858 
Ën
 = 
	`mš
(
todo
, 
POLLFD_PER_PAGE
);

859 
size
 = (
pŞl_li¡
è+ (
pŞlfd
è* 
Ën
;

860 
w®k
 = w®k->
Ãxt
 = 
	`km®loc
(
size
, 
GFP_KERNEL
);

861 ià(!
w®k
) {

862 
”r
 = -
ENOMEM
;

863 
out_fds
;

867 
	`pŞl_š™wa™
(&
bË
);

868 
fdcouÁ
 = 
	`do_pŞl
(
nfds
, 
h—d
, &
bË
, 
’d_time
);

869 
	`pŞl_ä“wa™
(&
bË
);

871 
w®k
 = 
h—d
; w®k; w®k = w®k->
Ãxt
) {

872 
pŞlfd
 *
fds
 = 
w®k
->
’Œ›s
;

873 
j
;

875 
j
 = 0; j < 
w®k
->
Ën
; j++, 
ufds
++)

876 ià(
	`__put_u£r
(
fds
[
j
].
»v’ts
, &
ufds
->revents))

877 
out_fds
;

880 
”r
 = 
fdcouÁ
;

881 
out_fds
:

882 
w®k
 = 
h—d
->
Ãxt
;

883 
w®k
) {

884 
pŞl_li¡
 *
pos
 = 
w®k
;

885 
w®k
 = w®k->
Ãxt
;

886 
	`kä“
(
pos
);

889  
”r
;

890 
	}
}

892 
	$do_»¡¬t_pŞl
(
»¡¬t_block
 *restart_block)

894 
pŞlfd
 
__u£r
 *
ufds
 = 
»¡¬t_block
->
pŞl
.ufds;

895 
nfds
 = 
»¡¬t_block
->
pŞl
.nfds;

896 
time¥ec
 *
to
 = 
NULL
, 
’d_time
;

897 
»t
;

899 ià(
»¡¬t_block
->
pŞl
.
has_timeout
) {

900 
’d_time
.
tv_£c
 = 
»¡¬t_block
->
pŞl
.tv_sec;

901 
’d_time
.
tv_n£c
 = 
»¡¬t_block
->
pŞl
.tv_nsec;

902 
to
 = &
’d_time
;

905 
»t
 = 
	`do_sys_pŞl
(
ufds
, 
nfds
, 
to
);

907 ià(
»t
 =ğ-
EINTR
) {

908 
»¡¬t_block
->
â
 = 
do_»¡¬t_pŞl
;

909 
»t
 = -
ERESTART_RESTARTBLOCK
;

911  
»t
;

912 
	}
}

914 
	$SYSCALL_DEFINE3
(
pŞl
, 
pŞlfd
 
__u£r
 *, 
ufds
, , 
nfds
,

915 , 
timeout_m£cs
)

917 
time¥ec
 
’d_time
, *
to
 = 
NULL
;

918 
»t
;

920 ià(
timeout_m£cs
 >= 0) {

921 
to
 = &
’d_time
;

922 
	`pŞl_£Ëù_£t_timeout
(
to
, 
timeout_m£cs
 / 
MSEC_PER_SEC
,

923 
NSEC_PER_MSEC
 * (
timeout_m£cs
 % 
MSEC_PER_SEC
));

926 
»t
 = 
	`do_sys_pŞl
(
ufds
, 
nfds
, 
to
);

928 ià(
»t
 =ğ-
EINTR
) {

929 
»¡¬t_block
 *restart_block;

931 
»¡¬t_block
 = &
	`cu¼’t_th»ad_šfo
()->restart_block;

932 
»¡¬t_block
->
â
 = 
do_»¡¬t_pŞl
;

933 
»¡¬t_block
->
pŞl
.
ufds
 = ufds;

934 
»¡¬t_block
->
pŞl
.
nfds
 =‚fds;

936 ià(
timeout_m£cs
 >= 0) {

937 
»¡¬t_block
->
pŞl
.
tv_£c
 = 
’d_time
.tv_sec;

938 
»¡¬t_block
->
pŞl
.
tv_n£c
 = 
’d_time
.tv_nsec;

939 
»¡¬t_block
->
pŞl
.
has_timeout
 = 1;

941 
»¡¬t_block
->
pŞl
.
has_timeout
 = 0;

943 
»t
 = -
ERESTART_RESTARTBLOCK
;

945  
»t
;

946 
	}
}

948 #ifdeà
HAVE_SET_RESTORE_SIGMASK


949 
	$SYSCALL_DEFINE5
(
µŞl
, 
pŞlfd
 
__u£r
 *, 
ufds
, , 
nfds
,

950 
time¥ec
 
__u£r
 *, 
t¥
, cÚ¡ 
sig£t_t
 __u£¸*, 
sigmask
,

951 
size_t
, 
sig£tsize
)

953 
sig£t_t
 
ksigmask
, 
sig§ved
;

954 
time¥ec
 
ts
, 
’d_time
, *
to
 = 
NULL
;

955 
»t
;

957 ià(
t¥
) {

958 ià(
	`cİy_äom_u£r
(&
ts
, 
t¥
, (ts)))

959  -
EFAULT
;

961 
to
 = &
’d_time
;

962 ià(
	`pŞl_£Ëù_£t_timeout
(
to
, 
ts
.
tv_£c
,s.
tv_n£c
))

963  -
EINVAL
;

966 ià(
sigmask
) {

968 ià(
sig£tsize
 !ğ(
sig£t_t
))

969  -
EINVAL
;

970 ià(
	`cİy_äom_u£r
(&
ksigmask
, 
sigmask
, (ksigmask)))

971  -
EFAULT
;

973 
	`sigd–£tmask
(&
ksigmask
, 
	`sigmask
(
SIGKILL
)|sigmask(
SIGSTOP
));

974 
	`sig´ocmask
(
SIG_SETMASK
, &
ksigmask
, &
sig§ved
);

977 
»t
 = 
	`do_sys_pŞl
(
ufds
, 
nfds
, 
to
);

980 ià(
»t
 =ğ-
EINTR
) {

986 ià(
sigmask
) {

987 
	`memıy
(&
cu¼’t
->
§ved_sigmask
, &
sig§ved
,

988 (
sig§ved
));

989 
	`£t_»¡Üe_sigmask
();

991 
»t
 = -
ERESTARTNOHAND
;

992 } ià(
sigmask
)

993 
	`sig´ocmask
(
SIG_SETMASK
, &
sig§ved
, 
NULL
);

995 
»t
 = 
	`pŞl_£Ëù_cİy_»maššg
(&
’d_time
, 
t¥
, 0,„et);

997  
»t
;

998 
	}
}

	@seq_file.c

8 
	~<lšux/fs.h
>

9 
	~<lšux/moduË.h
>

10 
	~<lšux/£q_fe.h
>

11 
	~<lšux/¦ab.h
>

13 
	~<asm/uacûss.h
>

14 
	~<asm/·ge.h
>

30 
	$£q_İ’
(
fe
 *fe, cÚ¡ 
£q_İ”©iÚs
 *
İ
)

32 
£q_fe
 *
p
 = 
fe
->
´iv©e_d©a
;

34 ià(!
p
) {

35 
p
 = 
	`km®loc
((*p), 
GFP_KERNEL
);

36 ià(!
p
)

37  -
ENOMEM
;

38 
fe
->
´iv©e_d©a
 = 
p
;

40 
	`mem£t
(
p
, 0, (*p));

41 
	`mu‹x_š™
(&
p
->
lock
);

42 
p
->
İ
 = op;

49 
fe
->
f_v”siÚ
 = 0;

60 
fe
->
f_mode
 &ğ~
FMODE_PWRITE
;

62 
	}
}

63 
EXPORT_SYMBOL
(
£q_İ’
);

65 
	$Œav”£
(
£q_fe
 *
m
, 
loff_t
 
off£t
)

67 
loff_t
 
pos
 = 0, 
šdex
;

68 
”rÜ
 = 0;

69 *
p
;

71 
m
->
v”siÚ
 = 0;

72 
šdex
 = 0;

73 
m
->
couÁ
 = m->
äom
 = 0;

74 ià(!
off£t
) {

75 
m
->
šdex
 = index;

78 ià(!
m
->
buf
) {

79 
m
->
buf
 = 
	`km®loc
(m->
size
 = 
PAGE_SIZE
, 
GFP_KERNEL
);

80 ià(!
m
->
buf
)

81  -
ENOMEM
;

83 
p
 = 
m
->
İ
->
	`¡¬t
(m, &
šdex
);

84 
p
) {

85 
”rÜ
 = 
	`PTR_ERR
(
p
);

86 ià(
	`IS_ERR
(
p
))

88 
”rÜ
 = 
m
->
İ
->
	`show
(m, 
p
);

89 ià(
”rÜ
 < 0)

91 ià(
	`uÆik–y
(
”rÜ
)) {

92 
”rÜ
 = 0;

93 
m
->
couÁ
 = 0;

95 ià(
m
->
couÁ
 =ğm->
size
)

96 
Eov”æow
;

97 ià(
pos
 + 
m
->
couÁ
 > 
off£t
) {

98 
m
->
äom
 = 
off£t
 - 
pos
;

99 
m
->
couÁ
 -ğm->
äom
;

100 
m
->
šdex
 = index;

103 
pos
 +ğ
m
->
couÁ
;

104 
m
->
couÁ
 = 0;

105 ià(
pos
 =ğ
off£t
) {

106 
šdex
++;

107 
m
->
šdex
 = index;

110 
p
 = 
m
->
İ
->
	`Ãxt
(m,…, &
šdex
);

112 
m
->
İ
->
	`¡İ
(m, 
p
);

113 
m
->
šdex
 = index;

114  
”rÜ
;

116 
Eov”æow
:

117 
m
->
İ
->
	`¡İ
(m, 
p
);

118 
	`kä“
(
m
->
buf
);

119 
m
->
buf
 = 
	`km®loc
(m->
size
 <<ğ1, 
GFP_KERNEL
);

120  !
m
->
buf
 ? -
ENOMEM
 : -
EAGAIN
;

121 
	}
}

132 
ssize_t
 
	$£q_»ad
(
fe
 *fe, 
__u£r
 *
buf
, 
size_t
 
size
, 
loff_t
 *
µos
)

134 
£q_fe
 *
m
 = 
fe
->
´iv©e_d©a
;

135 
size_t
 
cİ›d
 = 0;

136 
loff_t
 
pos
;

137 
size_t
 
n
;

138 *
p
;

139 
”r
 = 0;

141 
	`mu‹x_lock
(&
m
->
lock
);

144 ià(
	`uÆik–y
(*
µos
 !ğ
m
->
»ad_pos
)) {

145 
m
->
»ad_pos
 = *
µos
;

146 (
”r
 = 
	`Œav”£
(
m
, *
µos
)è=ğ-
EAGAIN
)

148 ià(
”r
) {

150 
m
->
»ad_pos
 = 0;

151 
m
->
v”siÚ
 = 0;

152 
m
->
šdex
 = 0;

153 
m
->
couÁ
 = 0;

154 
DÚe
;

169 
m
->
v”siÚ
 = 
fe
->
f_v”siÚ
;

171 ià(!
m
->
buf
) {

172 
m
->
buf
 = 
	`km®loc
(m->
size
 = 
PAGE_SIZE
, 
GFP_KERNEL
);

173 ià(!
m
->
buf
)

174 
Enomem
;

177 ià(
m
->
couÁ
) {

178 
n
 = 
	`mš
(
m
->
couÁ
, 
size
);

179 
”r
 = 
	`cİy_to_u£r
(
buf
, 
m
->buà+ m->
äom
, 
n
);

180 ià(
”r
)

181 
EçuÉ
;

182 
m
->
couÁ
 -ğ
n
;

183 
m
->
äom
 +ğ
n
;

184 
size
 -ğ
n
;

185 
buf
 +ğ
n
;

186 
cİ›d
 +ğ
n
;

187 ià(!
m
->
couÁ
)

188 
m
->
šdex
++;

189 ià(!
size
)

190 
DÚe
;

193 
pos
 = 
m
->
šdex
;

194 
p
 = 
m
->
İ
->
	`¡¬t
(m, &
pos
);

196 
”r
 = 
	`PTR_ERR
(
p
);

197 ià(!
p
 || 
	`IS_ERR
(p))

199 
”r
 = 
m
->
İ
->
	`show
(m, 
p
);

200 ià(
”r
 < 0)

202 ià(
	`uÆik–y
(
”r
))

203 
m
->
couÁ
 = 0;

204 ià(
	`uÆik–y
(!
m
->
couÁ
)) {

205 
p
 = 
m
->
İ
->
	`Ãxt
(m,…, &
pos
);

206 
m
->
šdex
 = 
pos
;

209 ià(
m
->
couÁ
 < m->
size
)

210 
Fl
;

211 
m
->
İ
->
	`¡İ
(m, 
p
);

212 
	`kä“
(
m
->
buf
);

213 
m
->
buf
 = 
	`km®loc
(m->
size
 <<ğ1, 
GFP_KERNEL
);

214 ià(!
m
->
buf
)

215 
Enomem
;

216 
m
->
couÁ
 = 0;

217 
m
->
v”siÚ
 = 0;

218 
pos
 = 
m
->
šdex
;

219 
p
 = 
m
->
İ
->
	`¡¬t
(m, &
pos
);

221 
m
->
İ
->
	`¡İ
(m, 
p
);

222 
m
->
couÁ
 = 0;

223 
DÚe
;

224 
Fl
:

226 
m
->
couÁ
 < 
size
) {

227 
size_t
 
offs
 = 
m
->
couÁ
;

228 
loff_t
 
Ãxt
 = 
pos
;

229 
p
 = 
m
->
İ
->
	`Ãxt
(m,…, &
Ãxt
);

230 ià(!
p
 || 
	`IS_ERR
(p)) {

231 
”r
 = 
	`PTR_ERR
(
p
);

234 
”r
 = 
m
->
İ
->
	`show
(m, 
p
);

235 ià(
m
->
couÁ
 =ğm->
size
 || 
”r
) {

236 
m
->
couÁ
 = 
offs
;

237 ià(
	`lik–y
(
”r
 <= 0))

240 
pos
 = 
Ãxt
;

242 
m
->
İ
->
	`¡İ
(m, 
p
);

243 
n
 = 
	`mš
(
m
->
couÁ
, 
size
);

244 
”r
 = 
	`cİy_to_u£r
(
buf
, 
m
->buf, 
n
);

245 ià(
”r
)

246 
EçuÉ
;

247 
cİ›d
 +ğ
n
;

248 
m
->
couÁ
 -ğ
n
;

249 ià(
m
->
couÁ
)

250 
m
->
äom
 = 
n
;

252 
pos
++;

253 
m
->
šdex
 = 
pos
;

254 
DÚe
:

255 ià(!
cİ›d
)

256 
cİ›d
 = 
”r
;

258 *
µos
 +ğ
cİ›d
;

259 
m
->
»ad_pos
 +ğ
cİ›d
;

261 
fe
->
f_v”siÚ
 = 
m
->
v”siÚ
;

262 
	`mu‹x_uÆock
(&
m
->
lock
);

263  
cİ›d
;

264 
Enomem
:

265 
”r
 = -
ENOMEM
;

266 
DÚe
;

267 
EçuÉ
:

268 
”r
 = -
EFAULT
;

269 
DÚe
;

270 
	}
}

271 
EXPORT_SYMBOL
(
£q_»ad
);

281 
loff_t
 
	$£q_l£ek
(
fe
 *fe, 
loff_t
 
off£t
, 
Üigš
)

283 
£q_fe
 *
m
 = 
fe
->
´iv©e_d©a
;

284 
loff_t
 
»tv®
 = -
EINVAL
;

286 
	`mu‹x_lock
(&
m
->
lock
);

287 
m
->
v”siÚ
 = 
fe
->
f_v”siÚ
;

288 
Üigš
) {

290 
off£t
 +ğ
fe
->
f_pos
;

292 ià(
off£t
 < 0)

294 
»tv®
 = 
off£t
;

295 ià(
off£t
 !ğ
m
->
»ad_pos
) {

296 (
»tv®
=
	`Œav”£
(
m
, 
off£t
)è=ğ-
EAGAIN
)

298 ià(
»tv®
) {

300 
fe
->
f_pos
 = 0;

301 
m
->
»ad_pos
 = 0;

302 
m
->
v”siÚ
 = 0;

303 
m
->
šdex
 = 0;

304 
m
->
couÁ
 = 0;

306 
m
->
»ad_pos
 = 
off£t
;

307 
»tv®
 = 
fe
->
f_pos
 = 
off£t
;

311 
fe
->
f_v”siÚ
 = 
m
->
v”siÚ
;

312 
	`mu‹x_uÆock
(&
m
->
lock
);

313  
»tv®
;

314 
	}
}

315 
EXPORT_SYMBOL
(
£q_l£ek
);

325 
	$£q_»Ëa£
(
šode
 *šode, 
fe
 *file)

327 
£q_fe
 *
m
 = 
fe
->
´iv©e_d©a
;

328 
	`kä“
(
m
->
buf
);

329 
	`kä“
(
m
);

331 
	}
}

332 
EXPORT_SYMBOL
(
£q_»Ëa£
);

344 
	$£q_esÿ³
(
£q_fe
 *
m
, cÚ¡ *
s
, cÚ¡ *
esc
)

346 *
’d
 = 
m
->
buf
 + m->
size
;

347 *
p
;

348 
c
;

350 
p
 = 
m
->
buf
 + m->
couÁ
; (
c
 = *
s
è!ğ'\0' &&… < 
’d
; s++) {

351 ià(!
	`¡rchr
(
esc
, 
c
)) {

352 *
p
++ = 
c
;

355 ià(
p
 + 3 < 
’d
) {

356 *
p
++ = '\\';

357 *
p
++ = '0' + ((
c
 & 0300) >> 6);

358 *
p
++ = '0' + ((
c
 & 070) >> 3);

359 *
p
++ = '0' + (
c
 & 07);

362 
m
->
couÁ
 = m->
size
;

365 
m
->
couÁ
 = 
p
 - m->
buf
;

367 
	}
}

368 
EXPORT_SYMBOL
(
£q_esÿ³
);

370 
	$£q_´štf
(
£q_fe
 *
m
, cÚ¡ *
f
, ...)

372 
va_li¡
 
¬gs
;

373 
Ën
;

375 ià(
m
->
couÁ
 < m->
size
) {

376 
	`va_¡¬t
(
¬gs
, 
f
);

377 
Ën
 = 
	`v¢´štf
(
m
->
buf
 + m->
couÁ
, m->
size
 - m->couÁ, 
f
, 
¬gs
);

378 
	`va_’d
(
¬gs
);

379 ià(
m
->
couÁ
 + 
Ën
 < m->
size
) {

380 
m
->
couÁ
 +ğ
Ën
;

384 
m
->
couÁ
 = m->
size
;

386 
	}
}

387 
EXPORT_SYMBOL
(
£q_´štf
);

400 *
	$mªgË_·th
(*
s
, *
p
, *
esc
)

402 
s
 <ğ
p
) {

403 
c
 = *
p
++;

404 ià(!
c
) {

405  
s
;

406 } ià(!
	`¡rchr
(
esc
, 
c
)) {

407 *
s
++ = 
c
;

408 } ià(
s
 + 4 > 
p
) {

411 *
s
++ = '\\';

412 *
s
++ = '0' + ((
c
 & 0300) >> 6);

413 *
s
++ = '0' + ((
c
 & 070) >> 3);

414 *
s
++ = '0' + (
c
 & 07);

417  
NULL
;

418 
	}
}

419 
EXPORT_SYMBOL
(
mªgË_·th
);

430 
	$£q_·th
(
£q_fe
 *
m
, 
·th
 *·th, *
esc
)

432 *
buf
;

433 
size_t
 
size
 = 
	`£q_g‘_buf
(
m
, &
buf
);

434 
»s
 = -1;

436 ià(
size
) {

437 *
p
 = 
	`d_·th
(
·th
, 
buf
, 
size
);

438 ià(!
	`IS_ERR
(
p
)) {

439 *
’d
 = 
	`mªgË_·th
(
buf
, 
p
, 
esc
);

440 ià(
’d
)

441 
»s
 = 
’d
 - 
buf
;

444 
	`£q_comm™
(
m
, 
»s
);

446  
»s
;

447 
	}
}

448 
EXPORT_SYMBOL
(
£q_·th
);

453 
	$£q_·th_roÙ
(
£q_fe
 *
m
, 
·th
 *·th, ·th *
roÙ
,

454 *
esc
)

456 *
buf
;

457 
size_t
 
size
 = 
	`£q_g‘_buf
(
m
, &
buf
);

458 
»s
 = -
ENAMETOOLONG
;

460 ià(
size
) {

461 *
p
;

463 
p
 = 
	`__d_·th
(
·th
, 
roÙ
, 
buf
, 
size
);

464 ià(!
p
)

465  
SEQ_SKIP
;

466 
»s
 = 
	`PTR_ERR
(
p
);

467 ià(!
	`IS_ERR
(
p
)) {

468 *
’d
 = 
	`mªgË_·th
(
buf
, 
p
, 
esc
);

469 ià(
’d
)

470 
»s
 = 
’d
 - 
buf
;

472 
»s
 = -
ENAMETOOLONG
;

475 
	`£q_comm™
(
m
, 
»s
);

477  
»s
 < 0 &&„e !ğ-
ENAMETOOLONG
 ?„es : 0;

478 
	}
}

483 
	$£q_d’Œy
(
£q_fe
 *
m
, 
d’Œy
 *d’Œy, *
esc
)

485 *
buf
;

486 
size_t
 
size
 = 
	`£q_g‘_buf
(
m
, &
buf
);

487 
»s
 = -1;

489 ià(
size
) {

490 *
p
 = 
	`d’Œy_·th
(
d’Œy
, 
buf
, 
size
);

491 ià(!
	`IS_ERR
(
p
)) {

492 *
’d
 = 
	`mªgË_·th
(
buf
, 
p
, 
esc
);

493 ià(
’d
)

494 
»s
 = 
’d
 - 
buf
;

497 
	`£q_comm™
(
m
, 
»s
);

499  
»s
;

500 
	}
}

502 
	$£q_b™m­
(
£q_fe
 *
m
, cÚ¡ *
b™s
,

503 
Ä_b™s
)

505 ià(
m
->
couÁ
 < m->
size
) {

506 
Ën
 = 
	`b™m­_sú´štf
(
m
->
buf
 + m->
couÁ
,

507 
m
->
size
 - m->
couÁ
, 
b™s
, 
Ä_b™s
);

508 ià(
m
->
couÁ
 + 
Ën
 < m->
size
) {

509 
m
->
couÁ
 +ğ
Ën
;

513 
m
->
couÁ
 = m->
size
;

515 
	}
}

516 
EXPORT_SYMBOL
(
£q_b™m­
);

518 
	$£q_b™m­_li¡
(
£q_fe
 *
m
, cÚ¡ *
b™s
,

519 
Ä_b™s
)

521 ià(
m
->
couÁ
 < m->
size
) {

522 
Ën
 = 
	`b™m­_súli¡´štf
(
m
->
buf
 + m->
couÁ
,

523 
m
->
size
 - m->
couÁ
, 
b™s
, 
Ä_b™s
);

524 ià(
m
->
couÁ
 + 
Ën
 < m->
size
) {

525 
m
->
couÁ
 +ğ
Ën
;

529 
m
->
couÁ
 = m->
size
;

531 
	}
}

532 
EXPORT_SYMBOL
(
£q_b™m­_li¡
);

534 *
	$sšgË_¡¬t
(
£q_fe
 *
p
, 
loff_t
 *
pos
)

536  
NULL
 + (*
pos
 == 0);

537 
	}
}

539 *
	$sšgË_Ãxt
(
£q_fe
 *
p
, *
v
, 
loff_t
 *
pos
)

541 ++*
pos
;

542  
NULL
;

543 
	}
}

545 
	$sšgË_¡İ
(
£q_fe
 *
p
, *
v
)

547 
	}
}

549 
sšgË_İ’
(
fe
 *fe, (*
show
)(
£q_fe
 *, *),

550 *
d©a
)

552 
£q_İ”©iÚs
 *
İ
 = 
	`km®loc
((*İ), 
GFP_KERNEL
);

553 
»s
 = -
ENOMEM
;

555 ià(
İ
) {

556 
İ
->
¡¬t
 = 
sšgË_¡¬t
;

557 
İ
->
Ãxt
 = 
sšgË_Ãxt
;

558 
İ
->
¡İ
 = 
sšgË_¡İ
;

559 
İ
->
show
 = show;

560 
»s
 = 
	`£q_İ’
(
fe
, 
İ
);

561 ià(!
»s
)

562 ((
£q_fe
 *)
fe
->
´iv©e_d©a
)->
´iv©e
 = 
d©a
;

564 
	`kä“
(
İ
);

566  
»s
;

567 
	}
}

568 
EXPORT_SYMBOL
(
sšgË_İ’
);

570 
	$sšgË_»Ëa£
(
šode
 *šode, 
fe
 *file)

572 cÚ¡ 
£q_İ”©iÚs
 *
İ
 = ((
£q_fe
 *)
fe
->
´iv©e_d©a
)->op;

573 
»s
 = 
	`£q_»Ëa£
(
šode
, 
fe
);

574 
	`kä“
(
İ
);

575  
»s
;

576 
	}
}

577 
EXPORT_SYMBOL
(
sšgË_»Ëa£
);

579 
	$£q_»Ëa£_´iv©e
(
šode
 *šode, 
fe
 *file)

581 
£q_fe
 *
£q
 = 
fe
->
´iv©e_d©a
;

583 
	`kä“
(
£q
->
´iv©e
);

584 
£q
->
´iv©e
 = 
NULL
;

585  
	`£q_»Ëa£
(
šode
, 
fe
);

586 
	}
}

587 
EXPORT_SYMBOL
(
£q_»Ëa£_´iv©e
);

589 *
	$__£q_İ’_´iv©e
(
fe
 *
f
, cÚ¡ 
£q_İ”©iÚs
 *
İs
,

590 
psize
)

592 
rc
;

593 *
´iv©e
;

594 
£q_fe
 *
£q
;

596 
´iv©e
 = 
	`kz®loc
(
psize
, 
GFP_KERNEL
);

597 ià(
´iv©e
 =ğ
NULL
)

598 
out
;

600 
rc
 = 
	`£q_İ’
(
f
, 
İs
);

601 ià(
rc
 < 0)

602 
out_ä“
;

604 
£q
 = 
f
->
´iv©e_d©a
;

605 
£q
->
´iv©e
 =…rivate;

606  
´iv©e
;

608 
out_ä“
:

609 
	`kä“
(
´iv©e
);

610 
out
:

611  
NULL
;

612 
	}
}

613 
EXPORT_SYMBOL
(
__£q_İ’_´iv©e
);

615 
	$£q_İ’_´iv©e
(
fe
 *
fp
, cÚ¡ 
£q_İ”©iÚs
 *
İs
,

616 
psize
)

618  
	`__£q_İ’_´iv©e
(
fp
, 
İs
, 
psize
è? 0 : -
ENOMEM
;

619 
	}
}

620 
EXPORT_SYMBOL
(
£q_İ’_´iv©e
);

622 
	$£q_putc
(
£q_fe
 *
m
, 
c
)

624 ià(
m
->
couÁ
 < m->
size
) {

625 
m
->
buf
[m->
couÁ
++] = 
c
;

629 
	}
}

630 
EXPORT_SYMBOL
(
£q_putc
);

632 
	$£q_puts
(
£q_fe
 *
m
, cÚ¡ *
s
)

634 
Ën
 = 
	`¡¾’
(
s
);

635 ià(
m
->
couÁ
 + 
Ën
 < m->
size
) {

636 
	`memıy
(
m
->
buf
 + m->
couÁ
, 
s
, 
Ën
);

637 
m
->
couÁ
 +ğ
Ën
;

640 
m
->
couÁ
 = m->
size
;

642 
	}
}

643 
EXPORT_SYMBOL
(
£q_puts
);

653 
	$£q_wr™e
(
£q_fe
 *
£q
, cÚ¡ *
d©a
, 
size_t
 
Ën
)

655 ià(
£q
->
couÁ
 + 
Ën
 < seq->
size
) {

656 
	`memıy
(
£q
->
buf
 + seq->
couÁ
, 
d©a
, 
Ën
);

657 
£q
->
couÁ
 +ğ
Ën
;

660 
£q
->
couÁ
 = seq->
size
;

662 
	}
}

663 
EXPORT_SYMBOL
(
£q_wr™e
);

665 
li¡_h—d
 *
	$£q_li¡_¡¬t
(
li¡_h—d
 *
h—d
, 
loff_t
 
pos
)

667 
li¡_h—d
 *
lh
;

669 
	`li¡_fÜ_—ch
(
lh
, 
h—d
)

670 ià(
pos
-- == 0)

671  
lh
;

673  
NULL
;

674 
	}
}

675 
EXPORT_SYMBOL
(
£q_li¡_¡¬t
);

677 
li¡_h—d
 *
	$£q_li¡_¡¬t_h—d
(
li¡_h—d
 *
h—d
, 
loff_t
 
pos
)

679 ià(!
pos
)

680  
h—d
;

682  
	`£q_li¡_¡¬t
(
h—d
, 
pos
 - 1);

683 
	}
}

684 
EXPORT_SYMBOL
(
£q_li¡_¡¬t_h—d
);

686 
li¡_h—d
 *
	$£q_li¡_Ãxt
(*
v
, 
li¡_h—d
 *
h—d
, 
loff_t
 *
µos
)

688 
li¡_h—d
 *
lh
;

690 
lh
 = ((
li¡_h—d
 *)
v
)->
Ãxt
;

691 ++*
µos
;

692  
lh
 =ğ
h—d
 ? 
NULL
 :†h;

693 
	}
}

694 
EXPORT_SYMBOL
(
£q_li¡_Ãxt
);

703 
hli¡_node
 *
	$£q_hli¡_¡¬t
(
hli¡_h—d
 *
h—d
, 
loff_t
 
pos
)

705 
hli¡_node
 *
node
;

707 
	`hli¡_fÜ_—ch
(
node
, 
h—d
)

708 ià(
pos
-- == 0)

709  
node
;

710  
NULL
;

711 
	}
}

712 
EXPORT_SYMBOL
(
£q_hli¡_¡¬t
);

722 
hli¡_node
 *
	$£q_hli¡_¡¬t_h—d
(
hli¡_h—d
 *
h—d
, 
loff_t
 
pos
)

724 ià(!
pos
)

725  
SEQ_START_TOKEN
;

727  
	`£q_hli¡_¡¬t
(
h—d
, 
pos
 - 1);

728 
	}
}

729 
EXPORT_SYMBOL
(
£q_hli¡_¡¬t_h—d
);

739 
hli¡_node
 *
	$£q_hli¡_Ãxt
(*
v
, 
hli¡_h—d
 *
h—d
,

740 
loff_t
 *
µos
)

742 
hli¡_node
 *
node
 = 
v
;

744 ++*
µos
;

745 ià(
v
 =ğ
SEQ_START_TOKEN
)

746  
h—d
->
fœ¡
;

748  
node
->
Ãxt
;

749 
	}
}

750 
EXPORT_SYMBOL
(
£q_hli¡_Ãxt
);

763 
hli¡_node
 *
	$£q_hli¡_¡¬t_rcu
(
hli¡_h—d
 *
h—d
,

764 
loff_t
 
pos
)

766 
hli¡_node
 *
node
;

768 
	`__hli¡_fÜ_—ch_rcu
(
node
, 
h—d
)

769 ià(
pos
-- == 0)

770  
node
;

771  
NULL
;

772 
	}
}

773 
EXPORT_SYMBOL
(
£q_hli¡_¡¬t_rcu
);

787 
hli¡_node
 *
	$£q_hli¡_¡¬t_h—d_rcu
(
hli¡_h—d
 *
h—d
,

788 
loff_t
 
pos
)

790 ià(!
pos
)

791  
SEQ_START_TOKEN
;

793  
	`£q_hli¡_¡¬t_rcu
(
h—d
, 
pos
 - 1);

794 
	}
}

795 
EXPORT_SYMBOL
(
£q_hli¡_¡¬t_h—d_rcu
);

809 
hli¡_node
 *
	$£q_hli¡_Ãxt_rcu
(*
v
,

810 
hli¡_h—d
 *
h—d
,

811 
loff_t
 *
µos
)

813 
hli¡_node
 *
node
 = 
v
;

815 ++*
µos
;

816 ià(
v
 =ğ
SEQ_START_TOKEN
)

817  
	`rcu_d”eã»nû
(
h—d
->
fœ¡
);

819  
	`rcu_d”eã»nû
(
node
->
Ãxt
);

820 
	}
}

821 
EXPORT_SYMBOL
(
£q_hli¡_Ãxt_rcu
);

	@signalfd.c

20 
	~<lšux/fe.h
>

21 
	~<lšux/pŞl.h
>

22 
	~<lšux/š™.h
>

23 
	~<lšux/fs.h
>

24 
	~<lšux/sched.h
>

25 
	~<lšux/¦ab.h
>

26 
	~<lšux/k”Ãl.h
>

27 
	~<lšux/sigÇl.h
>

28 
	~<lšux/li¡.h
>

29 
	~<lšux/ªÚ_šodes.h
>

30 
	~<lšux/sigÇlfd.h
>

31 
	~<lšux/sysÿÎs.h
>

33 
	ssigÇlfd_ùx
 {

34 
sig£t_t
 
	msigmask
;

37 
	$sigÇlfd_»Ëa£
(
šode
 *šode, 
fe
 *file)

39 
	`kä“
(
fe
->
´iv©e_d©a
);

41 
	}
}

43 
	$sigÇlfd_pŞl
(
fe
 *fe, 
pŞl_bË
 *
wa™
)

45 
sigÇlfd_ùx
 *
ùx
 = 
fe
->
´iv©e_d©a
;

46 
ev’ts
 = 0;

48 
	`pŞl_wa™
(
fe
, &
cu¼’t
->
sighªd
->
sigÇlfd_wqh
, 
wa™
);

50 
	`¥š_lock_œq
(&
cu¼’t
->
sighªd
->
siglock
);

51 ià(
	`Ãxt_sigÇl
(&
cu¼’t
->
³ndšg
, &
ùx
->
sigmask
) ||

52 
	`Ãxt_sigÇl
(&
cu¼’t
->
sigÇl
->
sh¬ed_³ndšg
,

53 &
ùx
->
sigmask
))

54 
ev’ts
 |ğ
POLLIN
;

55 
	`¥š_uÆock_œq
(&
cu¼’t
->
sighªd
->
siglock
);

57  
ev’ts
;

58 
	}
}

63 
	$sigÇlfd_cİyšfo
(
sigÇlfd_sigšfo
 
__u£r
 *
ušfo
,

64 
sigšfo_t
 cÚ¡ *
kšfo
)

66 
”r
;

68 
	`BUILD_BUG_ON
((
sigÇlfd_sigšfo
) != 128);

73 
”r
 = 
	`__ş—r_u£r
(
ušfo
, (*uinfo));

79 
”r
 |ğ
	`__put_u£r
(
kšfo
->
si_signo
, &
ušfo
->
ssi_signo
);

80 
”r
 |ğ
	`__put_u£r
(
kšfo
->
si_”ºo
, &
ušfo
->
ssi_”ºo
);

81 
”r
 |ğ
	`__put_u£r
((è
kšfo
->
si_code
, &
ušfo
->
ssi_code
);

82 
kšfo
->
si_code
 & 
__SI_MASK
) {

83 
__SI_KILL
:

84 
”r
 |ğ
	`__put_u£r
(
kšfo
->
si_pid
, &
ušfo
->
ssi_pid
);

85 
”r
 |ğ
	`__put_u£r
(
kšfo
->
si_uid
, &
ušfo
->
ssi_uid
);

87 
__SI_TIMER
:

88 
”r
 |ğ
	`__put_u£r
(
kšfo
->
si_tid
, &
ušfo
->
ssi_tid
);

89 
”r
 |ğ
	`__put_u£r
(
kšfo
->
si_ov”run
, &
ušfo
->
ssi_ov”run
);

90 
”r
 |ğ
	`__put_u£r
((è
kšfo
->
si_±r
, &
ušfo
->
ssi_±r
);

91 
”r
 |ğ
	`__put_u£r
(
kšfo
->
si_št
, &
ušfo
->
ssi_št
);

93 
__SI_POLL
:

94 
”r
 |ğ
	`__put_u£r
(
kšfo
->
si_bªd
, &
ušfo
->
ssi_bªd
);

95 
”r
 |ğ
	`__put_u£r
(
kšfo
->
si_fd
, &
ušfo
->
ssi_fd
);

97 
__SI_FAULT
:

98 
”r
 |ğ
	`__put_u£r
((è
kšfo
->
si_addr
, &
ušfo
->
ssi_addr
);

99 #ifdeà
__ARCH_SI_TRAPNO


100 
”r
 |ğ
	`__put_u£r
(
kšfo
->
si_Œ­no
, &
ušfo
->
ssi_Œ­no
);

102 #ifdeà
BUS_MCEERR_AO


107 ià(
kšfo
->
si_code
 =ğ
BUS_MCEERR_AR
 ||

108 
kšfo
->
si_code
 =ğ
BUS_MCEERR_AO
)

109 
”r
 |ğ
	`__put_u£r
((è
kšfo
->
si_addr_lsb
,

110 &
ušfo
->
ssi_addr_lsb
);

113 
__SI_CHLD
:

114 
”r
 |ğ
	`__put_u£r
(
kšfo
->
si_pid
, &
ušfo
->
ssi_pid
);

115 
”r
 |ğ
	`__put_u£r
(
kšfo
->
si_uid
, &
ušfo
->
ssi_uid
);

116 
”r
 |ğ
	`__put_u£r
(
kšfo
->
si_¡©us
, &
ušfo
->
ssi_¡©us
);

117 
”r
 |ğ
	`__put_u£r
(
kšfo
->
si_utime
, &
ušfo
->
ssi_utime
);

118 
”r
 |ğ
	`__put_u£r
(
kšfo
->
si_¡ime
, &
ušfo
->
ssi_¡ime
);

120 
__SI_RT
:

121 
__SI_MESGQ
:

122 
”r
 |ğ
	`__put_u£r
(
kšfo
->
si_pid
, &
ušfo
->
ssi_pid
);

123 
”r
 |ğ
	`__put_u£r
(
kšfo
->
si_uid
, &
ušfo
->
ssi_uid
);

124 
”r
 |ğ
	`__put_u£r
((è
kšfo
->
si_±r
, &
ušfo
->
ssi_±r
);

125 
”r
 |ğ
	`__put_u£r
(
kšfo
->
si_št
, &
ušfo
->
ssi_št
);

131 
”r
 |ğ
	`__put_u£r
(
kšfo
->
si_pid
, &
ušfo
->
ssi_pid
);

132 
”r
 |ğ
	`__put_u£r
(
kšfo
->
si_uid
, &
ušfo
->
ssi_uid
);

133 
”r
 |ğ
	`__put_u£r
((è
kšfo
->
si_±r
, &
ušfo
->
ssi_±r
);

134 
”r
 |ğ
	`__put_u£r
(
kšfo
->
si_št
, &
ušfo
->
ssi_št
);

138  
”r
 ? -
EFAULT
: (*
ušfo
);

139 
	}
}

141 
ssize_t
 
	$sigÇlfd_dequeue
(
sigÇlfd_ùx
 *
ùx
, 
sigšfo_t
 *
šfo
,

142 
nÚblock
)

144 
ssize_t
 
»t
;

145 
	`DECLARE_WAITQUEUE
(
wa™
, 
cu¼’t
);

147 
	`¥š_lock_œq
(&
cu¼’t
->
sighªd
->
siglock
);

148 
»t
 = 
	`dequeue_sigÇl
(
cu¼’t
, &
ùx
->
sigmask
, 
šfo
);

149 
»t
) {

151 ià(!
nÚblock
)

153 
»t
 = -
EAGAIN
;

155 
	`¥š_uÆock_œq
(&
cu¼’t
->
sighªd
->
siglock
);

156  
»t
;

159 
	`add_wa™_queue
(&
cu¼’t
->
sighªd
->
sigÇlfd_wqh
, &
wa™
);

161 
	`£t_cu¼’t_¡©e
(
TASK_INTERRUPTIBLE
);

162 
»t
 = 
	`dequeue_sigÇl
(
cu¼’t
, &
ùx
->
sigmask
, 
šfo
);

163 ià(
»t
 != 0)

165 ià(
	`sigÇl_³ndšg
(
cu¼’t
)) {

166 
»t
 = -
ERESTARTSYS
;

169 
	`¥š_uÆock_œq
(&
cu¼’t
->
sighªd
->
siglock
);

170 
	`scheduË
();

171 
	`¥š_lock_œq
(&
cu¼’t
->
sighªd
->
siglock
);

173 
	`¥š_uÆock_œq
(&
cu¼’t
->
sighªd
->
siglock
);

175 
	`»move_wa™_queue
(&
cu¼’t
->
sighªd
->
sigÇlfd_wqh
, &
wa™
);

176 
	`__£t_cu¼’t_¡©e
(
TASK_RUNNING
);

178  
»t
;

179 
	}
}

186 
ssize_t
 
	$sigÇlfd_»ad
(
fe
 *fe, 
__u£r
 *
buf
, 
size_t
 
couÁ
,

187 
loff_t
 *
µos
)

189 
sigÇlfd_ùx
 *
ùx
 = 
fe
->
´iv©e_d©a
;

190 
sigÇlfd_sigšfo
 
__u£r
 *
sigšfo
;

191 
nÚblock
 = 
fe
->
f_æags
 & 
O_NONBLOCK
;

192 
ssize_t
 
»t
, 
tÙ®
 = 0;

193 
sigšfo_t
 
šfo
;

195 
couÁ
 /ğ(
sigÇlfd_sigšfo
);

196 ià(!
couÁ
)

197  -
EINVAL
;

199 
sigšfo
 = (
sigÇlfd_sigšfo
 
__u£r
 *è
buf
;

201 
»t
 = 
	`sigÇlfd_dequeue
(
ùx
, &
šfo
, 
nÚblock
);

202 ià(
	`uÆik–y
(
»t
 <= 0))

204 
»t
 = 
	`sigÇlfd_cİyšfo
(
sigšfo
, &
šfo
);

205 ià(
»t
 < 0)

207 
sigšfo
++;

208 
tÙ®
 +ğ
»t
;

209 
nÚblock
 = 1;

210 } --
couÁ
);

212  
tÙ®
 ?Ù®: 
»t
;

213 
	}
}

215 cÚ¡ 
fe_İ”©iÚs
 
	gsigÇlfd_fİs
 = {

216 .
»Ëa£
 = 
sigÇlfd_»Ëa£
,

217 .
	gpŞl
 = 
sigÇlfd_pŞl
,

218 .
	g»ad
 = 
sigÇlfd_»ad
,

219 .
	gÎ£ek
 = 
noİ_Î£ek
,

222 
	$SYSCALL_DEFINE4
(
sigÇlfd4
, , 
ufd
, 
sig£t_t
 
__u£r
 *, 
u£r_mask
,

223 
size_t
, 
sizemask
, , 
æags
)

225 
sig£t_t
 
sigmask
;

226 
sigÇlfd_ùx
 *
ùx
;

229 
	`BUILD_BUG_ON
(
SFD_CLOEXEC
 !ğ
O_CLOEXEC
);

230 
	`BUILD_BUG_ON
(
SFD_NONBLOCK
 !ğ
O_NONBLOCK
);

232 ià(
æags
 & ~(
SFD_CLOEXEC
 | 
SFD_NONBLOCK
))

233  -
EINVAL
;

235 ià(
sizemask
 !ğ(
sig£t_t
) ||

236 
	`cİy_äom_u£r
(&
sigmask
, 
u£r_mask
, (sigmask)))

237  -
EINVAL
;

238 
	`sigd–£tmask
(&
sigmask
, 
	`sigmask
(
SIGKILL
è| sigmask(
SIGSTOP
));

239 
	`signÙ£t
(&
sigmask
);

241 ià(
ufd
 == -1) {

242 
ùx
 = 
	`km®loc
((*ùx), 
GFP_KERNEL
);

243 ià(!
ùx
)

244  -
ENOMEM
;

246 
ùx
->
sigmask
 = sigmask;

252 
ufd
 = 
	`ªÚ_šode_g‘fd
("[sigÇlfd]", &
sigÇlfd_fİs
, 
ùx
,

253 
O_RDWR
 | (
æags
 & (
O_CLOEXEC
 | 
O_NONBLOCK
)));

254 ià(
ufd
 < 0)

255 
	`kä“
(
ùx
);

257 
fe
 *fğ
	`fg‘
(
ufd
);

258 ià(!
fe
)

259  -
EBADF
;

260 
ùx
 = 
fe
->
´iv©e_d©a
;

261 ià(
fe
->
f_İ
 !ğ&
sigÇlfd_fİs
) {

262 
	`åut
(
fe
);

263  -
EINVAL
;

265 
	`¥š_lock_œq
(&
cu¼’t
->
sighªd
->
siglock
);

266 
ùx
->
sigmask
 = sigmask;

267 
	`¥š_uÆock_œq
(&
cu¼’t
->
sighªd
->
siglock
);

269 
	`wake_up
(&
cu¼’t
->
sighªd
->
sigÇlfd_wqh
);

270 
	`åut
(
fe
);

273  
ufd
;

274 
	}
}

276 
	$SYSCALL_DEFINE3
(
sigÇlfd
, , 
ufd
, 
sig£t_t
 
__u£r
 *, 
u£r_mask
,

277 
size_t
, 
sizemask
)

279  
	`sys_sigÇlfd4
(
ufd
, 
u£r_mask
, 
sizemask
, 0);

280 
	}
}

	@splice.c

20 
	~<lšux/fs.h
>

21 
	~<lšux/fe.h
>

22 
	~<lšux/·gem­.h
>

23 
	~<lšux/¥liû.h
>

24 
	~<lšux/memcÚŒŞ.h
>

25 
	~<lšux/mm_šlše.h
>

26 
	~<lšux/sw­.h
>

27 
	~<lšux/wr™eback.h
>

28 
	~<lšux/bufãr_h—d.h
>

29 
	~<lšux/moduË.h
>

30 
	~<lšux/sysÿÎs.h
>

31 
	~<lšux/uio.h
>

32 
	~<lšux/£cur™y.h
>

33 
	~<lšux/gå.h
>

41 
	$·ge_ÿche_pe_buf_¡—l
(
pe_šode_šfo
 *
pe
,

42 
pe_bufãr
 *
buf
)

44 
·ge
 *·gğ
buf
->page;

45 
add»ss_¥aû
 *
m­pšg
;

47 
	`lock_·ge
(
·ge
);

49 
m­pšg
 = 
	`·ge_m­pšg
(
·ge
);

50 ià(
m­pšg
) {

51 
	`WARN_ON
(!
	`PageU±od©e
(
·ge
));

61 
	`wa™_Ú_·ge_wr™eback
(
·ge
);

63 ià(
	`·ge_has_´iv©e
(
·ge
) &&

64 !
	`Œy_to_»Ëa£_·ge
(
·ge
, 
GFP_KERNEL
))

65 
out_uÆock
;

71 ià(
	`»move_m­pšg
(
m­pšg
, 
·ge
)) {

72 
buf
->
æags
 |ğ
PIPE_BUF_FLAG_LRU
;

81 
out_uÆock
:

82 
	`uÆock_·ge
(
·ge
);

84 
	}
}

86 
	$·ge_ÿche_pe_buf_»Ëa£
(
pe_šode_šfo
 *
pe
,

87 
pe_bufãr
 *
buf
)

89 
	`·ge_ÿche_»Ëa£
(
buf
->
·ge
);

90 
buf
->
æags
 &ğ~
PIPE_BUF_FLAG_LRU
;

91 
	}
}

97 
	$·ge_ÿche_pe_buf_cÚfœm
(
pe_šode_šfo
 *
pe
,

98 
pe_bufãr
 *
buf
)

100 
·ge
 *·gğ
buf
->page;

101 
”r
;

103 ià(!
	`PageU±od©e
(
·ge
)) {

104 
	`lock_·ge
(
·ge
);

110 ià(!
·ge
->
m­pšg
) {

111 
”r
 = -
ENODATA
;

112 
”rÜ
;

118 ià(!
	`PageU±od©e
(
·ge
)) {

119 
”r
 = -
EIO
;

120 
”rÜ
;

126 
	`uÆock_·ge
(
·ge
);

130 
”rÜ
:

131 
	`uÆock_·ge
(
·ge
);

132  
”r
;

133 
	}
}

135 cÚ¡ 
pe_buf_İ”©iÚs
 
	g·ge_ÿche_pe_buf_İs
 = {

136 .
ÿn_m”ge
 = 0,

137 .
	gm­
 = 
g’”ic_pe_buf_m­
,

138 .
	gunm­
 = 
g’”ic_pe_buf_unm­
,

139 .
	gcÚfœm
 = 
·ge_ÿche_pe_buf_cÚfœm
,

140 .
	g»Ëa£
 = 
·ge_ÿche_pe_buf_»Ëa£
,

141 .
	g¡—l
 = 
·ge_ÿche_pe_buf_¡—l
,

142 .
	gg‘
 = 
g’”ic_pe_buf_g‘
,

145 
	$u£r_·ge_pe_buf_¡—l
(
pe_šode_šfo
 *
pe
,

146 
pe_bufãr
 *
buf
)

148 ià(!(
buf
->
æags
 & 
PIPE_BUF_FLAG_GIFT
))

151 
buf
->
æags
 |ğ
PIPE_BUF_FLAG_LRU
;

152  
	`g’”ic_pe_buf_¡—l
(
pe
, 
buf
);

153 
	}
}

155 cÚ¡ 
pe_buf_İ”©iÚs
 
	gu£r_·ge_pe_buf_İs
 = {

156 .
ÿn_m”ge
 = 0,

157 .
	gm­
 = 
g’”ic_pe_buf_m­
,

158 .
	gunm­
 = 
g’”ic_pe_buf_unm­
,

159 .
	gcÚfœm
 = 
g’”ic_pe_buf_cÚfœm
,

160 .
	g»Ëa£
 = 
·ge_ÿche_pe_buf_»Ëa£
,

161 .
	g¡—l
 = 
u£r_·ge_pe_buf_¡—l
,

162 .
	gg‘
 = 
g’”ic_pe_buf_g‘
,

165 
	$wakeup_pe_»ad”s
(
pe_šode_šfo
 *
pe
)

167 
	`smp_mb
();

168 ià(
	`wa™queue_aùive
(&
pe
->
wa™
))

169 
	`wake_up_š‹¼u±ibË
(&
pe
->
wa™
);

170 
	`kl_çsync
(&
pe
->
çsync_»ad”s
, 
SIGIO
, 
POLL_IN
);

171 
	}
}

184 
ssize_t
 
	$¥liû_to_pe
(
pe_šode_šfo
 *
pe
,

185 
¥liû_pe_desc
 *
¥d
)

187 
¥d_·ges
 = 
¥d
->
Ä_·ges
;

188 
»t
, 
do_wakeup
, 
·ge_Ä
;

190 
»t
 = 0;

191 
do_wakeup
 = 0;

192 
·ge_Ä
 = 0;

194 
	`pe_lock
(
pe
);

197 ià(!
pe
->
»ad”s
) {

198 
	`£nd_sig
(
SIGPIPE
, 
cu¼’t
, 0);

199 ià(!
»t
)

200 
»t
 = -
EPIPE
;

204 ià(
pe
->
Äbufs
 <…e->
bufãrs
) {

205 
Ãwbuf
 = (
pe
->
curbuf
 +…e->
Äbufs
è& (pe->
bufãrs
 - 1);

206 
pe_bufãr
 *
buf
 = 
pe
->
bufs
 + 
Ãwbuf
;

208 
buf
->
·ge
 = 
¥d
->
·ges
[
·ge_Ä
];

209 
buf
->
off£t
 = 
¥d
->
·¹Ÿl
[
·ge_Ä
].offset;

210 
buf
->
Ën
 = 
¥d
->
·¹Ÿl
[
·ge_Ä
].len;

211 
buf
->
´iv©e
 = 
¥d
->
·¹Ÿl
[
·ge_Ä
].private;

212 
buf
->
İs
 = 
¥d
->ops;

213 ià(
¥d
->
æags
 & 
SPLICE_F_GIFT
)

214 
buf
->
æags
 |ğ
PIPE_BUF_FLAG_GIFT
;

216 
pe
->
Äbufs
++;

217 
·ge_Ä
++;

218 
»t
 +ğ
buf
->
Ën
;

220 ià(
pe
->
šode
)

221 
do_wakeup
 = 1;

223 ià(!--
¥d
->
Ä_·ges
)

225 ià(
pe
->
Äbufs
 <…e->
bufãrs
)

231 ià(
¥d
->
æags
 & 
SPLICE_F_NONBLOCK
) {

232 ià(!
»t
)

233 
»t
 = -
EAGAIN
;

237 ià(
	`sigÇl_³ndšg
(
cu¼’t
)) {

238 ià(!
»t
)

239 
»t
 = -
ERESTARTSYS
;

243 ià(
do_wakeup
) {

244 
	`smp_mb
();

245 ià(
	`wa™queue_aùive
(&
pe
->
wa™
))

246 
	`wake_up_š‹¼u±ibË_sync
(&
pe
->
wa™
);

247 
	`kl_çsync
(&
pe
->
çsync_»ad”s
, 
SIGIO
, 
POLL_IN
);

248 
do_wakeup
 = 0;

251 
pe
->
wa™šg_wr™”s
++;

252 
	`pe_wa™
(
pe
);

253 
pe
->
wa™šg_wr™”s
--;

256 
	`pe_uÆock
(
pe
);

258 ià(
do_wakeup
)

259 
	`wakeup_pe_»ad”s
(
pe
);

261 
·ge_Ä
 < 
¥d_·ges
)

262 
¥d
->
	`¥d_»Ëa£
(¥d, 
·ge_Ä
++);

264  
»t
;

265 
	}
}

267 
	$¥d_»Ëa£_·ge
(
¥liû_pe_desc
 *
¥d
, 
i
)

269 
	`·ge_ÿche_»Ëa£
(
¥d
->
·ges
[
i
]);

270 
	}
}

276 
	$¥liû_grow_¥d
(
pe_šode_šfo
 *
pe
, 
¥liû_pe_desc
 *
¥d
)

278 ià(
pe
->
bufãrs
 <ğ
PIPE_DEF_BUFFERS
)

281 
¥d
->
·ges
 = 
	`km®loc
(
pe
->
bufãrs
 * (
·ge
 *), 
GFP_KERNEL
);

282 
¥d
->
·¹Ÿl
 = 
	`km®loc
(
pe
->
bufãrs
 * (
·¹Ÿl_·ge
), 
GFP_KERNEL
);

284 ià(
¥d
->
·ges
 && spd->
·¹Ÿl
)

287 
	`kä“
(
¥d
->
·ges
);

288 
	`kä“
(
¥d
->
·¹Ÿl
);

289  -
ENOMEM
;

290 
	}
}

292 
	$¥liû_shršk_¥d
(
pe_šode_šfo
 *
pe
,

293 
¥liû_pe_desc
 *
¥d
)

295 ià(
pe
->
bufãrs
 <ğ
PIPE_DEF_BUFFERS
)

298 
	`kä“
(
¥d
->
·ges
);

299 
	`kä“
(
¥d
->
·¹Ÿl
);

300 
	}
}

303 
	$__g’”ic_fe_¥liû_»ad
(
fe
 *
š
, 
loff_t
 *
µos
,

304 
pe_šode_šfo
 *
pe
, 
size_t
 
Ën
,

305 
æags
)

307 
add»ss_¥aû
 *
m­pšg
 = 
š
->
f_m­pšg
;

308 
loff
, 
Ä_·ges
, 
»q_·ges
;

309 
·ge
 *
·ges
[
PIPE_DEF_BUFFERS
];

310 
·¹Ÿl_·ge
 
·¹Ÿl
[
PIPE_DEF_BUFFERS
];

311 
·ge
 *page;

312 
pgoff_t
 
šdex
, 
’d_šdex
;

313 
loff_t
 
isize
;

314 
”rÜ
, 
·ge_Ä
;

315 
¥liû_pe_desc
 
¥d
 = {

316 .
·ges
 =…ages,

317 .
·¹Ÿl
 =…artial,

318 .
æags
 = flags,

319 .
İs
 = &
·ge_ÿche_pe_buf_İs
,

320 .
¥d_»Ëa£
 = 
¥d_»Ëa£_·ge
,

323 ià(
	`¥liû_grow_¥d
(
pe
, &
¥d
))

324  -
ENOMEM
;

326 
šdex
 = *
µos
 >> 
PAGE_CACHE_SHIFT
;

327 
loff
 = *
µos
 & ~
PAGE_CACHE_MASK
;

328 
»q_·ges
 = (
Ën
 + 
loff
 + 
PAGE_CACHE_SIZE
 - 1è>> 
PAGE_CACHE_SHIFT
;

329 
Ä_·ges
 = 
	`mš
(
»q_·ges
, 
pe
->
bufãrs
);

334 
¥d
.
Ä_·ges
 = 
	`fšd_g‘_·ges_cÚtig
(
m­pšg
, 
šdex
,‚r_·ges, spd.
·ges
);

335 
šdex
 +ğ
¥d
.
Ä_·ges
;

341 ià(
¥d
.
Ä_·ges
 <‚r_pages)

342 
	`·ge_ÿche_sync_»adah—d
(
m­pšg
, &
š
->
f_¿
, in,

343 
šdex
, 
»q_·ges
 - 
¥d
.
Ä_·ges
);

345 
”rÜ
 = 0;

346 
¥d
.
Ä_·ges
 <‚r_pages) {

351 
·ge
 = 
	`fšd_g‘_·ge
(
m­pšg
, 
šdex
);

352 ià(!
·ge
) {

356 
·ge
 = 
	`·ge_ÿche_®loc_cŞd
(
m­pšg
);

357 ià(!
·ge
)

360 
”rÜ
 = 
	`add_to_·ge_ÿche_Ìu
(
·ge
, 
m­pšg
, 
šdex
,

361 
GFP_KERNEL
);

362 ià(
	`uÆik–y
(
”rÜ
)) {

363 
	`·ge_ÿche_»Ëa£
(
·ge
);

364 ià(
”rÜ
 =ğ-
EEXIST
)

372 
	`uÆock_·ge
(
·ge
);

375 
¥d
.
·ges
[¥d.
Ä_·ges
++] = 
·ge
;

376 
šdex
++;

383 
šdex
 = *
µos
 >> 
PAGE_CACHE_SHIFT
;

384 
Ä_·ges
 = 
¥d
.nr_pages;

385 
¥d
.
Ä_·ges
 = 0;

386 
·ge_Ä
 = 0;…age_Ä < 
Ä_·ges
;…age_nr++) {

387 
this_Ën
;

389 ià(!
Ën
)

395 
this_Ën
 = 
	`mš_t
(, 
Ën
, 
PAGE_CACHE_SIZE
 - 
loff
);

396 
·ge
 = 
¥d
.
·ges
[
·ge_Ä
];

398 ià(
	`PageR—dah—d
(
·ge
))

399 
	`·ge_ÿche_async_»adah—d
(
m­pšg
, &
š
->
f_¿
, in,

400 
·ge
, 
šdex
, 
»q_·ges
 - 
·ge_Ä
);

405 ià(!
	`PageU±od©e
(
·ge
)) {

406 
	`lock_·ge
(
·ge
);

414 ià(!
·ge
->
m­pšg
) {

415 
	`uÆock_·ge
(
·ge
);

416 
·ge
 = 
	`fšd_Ü_ü—‹_·ge
(
m­pšg
, 
šdex
,

417 
	`m­pšg_gå_mask
(
m­pšg
));

419 ià(!
·ge
) {

420 
”rÜ
 = -
ENOMEM
;

423 
	`·ge_ÿche_»Ëa£
(
¥d
.
·ges
[
·ge_Ä
]);

424 
¥d
.
·ges
[
·ge_Ä
] = 
·ge
;

429 ià(
	`PageU±od©e
(
·ge
)) {

430 
	`uÆock_·ge
(
·ge
);

431 
fl_™
;

437 
”rÜ
 = 
m­pšg
->
a_İs
->
	`»ad·ge
(
š
, 
·ge
);

438 ià(
	`uÆik–y
(
”rÜ
)) {

445 ià(
”rÜ
 =ğ
AOP_TRUNCATED_PAGE
)

446 
”rÜ
 = 0;

451 
fl_™
:

455 
isize
 = 
	`i_size_»ad
(
m­pšg
->
ho¡
);

456 
’d_šdex
 = (
isize
 - 1è>> 
PAGE_CACHE_SHIFT
;

457 ià(
	`uÆik–y
(!
isize
 || 
šdex
 > 
’d_šdex
))

464 ià(
’d_šdex
 =ğ
šdex
) {

465 
¶’
;

470 
¶’
 = ((
isize
 - 1è& ~
PAGE_CACHE_MASK
) + 1;

471 ià(
¶’
 <ğ
loff
)

477 
this_Ën
 = 
	`mš
Ñhis_Ën, 
¶’
 - 
loff
);

478 
Ën
 = 
this_Ën
;

481 
¥d
.
·¹Ÿl
[
·ge_Ä
].
off£t
 = 
loff
;

482 
¥d
.
·¹Ÿl
[
·ge_Ä
].
Ën
 = 
this_Ën
;

483 
Ën
 -ğ
this_Ën
;

484 
loff
 = 0;

485 
¥d
.
Ä_·ges
++;

486 
šdex
++;

493 
·ge_Ä
 < 
Ä_·ges
)

494 
	`·ge_ÿche_»Ëa£
(
¥d
.
·ges
[
·ge_Ä
++]);

495 
š
->
f_¿
.
´ev_pos
 = (
loff_t
)
šdex
 << 
PAGE_CACHE_SHIFT
;

497 ià(
¥d
.
Ä_·ges
)

498 
”rÜ
 = 
	`¥liû_to_pe
(
pe
, &
¥d
);

500 
	`¥liû_shršk_¥d
(
pe
, &
¥d
);

501  
”rÜ
;

502 
	}
}

518 
ssize_t
 
	$g’”ic_fe_¥liû_»ad
(
fe
 *
š
, 
loff_t
 *
µos
,

519 
pe_šode_šfo
 *
pe
, 
size_t
 
Ën
,

520 
æags
)

522 
loff_t
 
isize
, 
Ëá
;

523 
»t
;

525 
isize
 = 
	`i_size_»ad
(
š
->
f_m­pšg
->
ho¡
);

526 ià(
	`uÆik–y
(*
µos
 >ğ
isize
))

529 
Ëá
 = 
isize
 - *
µos
;

530 ià(
	`uÆik–y
(
Ëá
 < 
Ën
))

531 
Ën
 = 
Ëá
;

533 
»t
 = 
	`__g’”ic_fe_¥liû_»ad
(
š
, 
µos
, 
pe
, 
Ën
, 
æags
);

534 ià(
»t
 > 0) {

535 *
µos
 +ğ
»t
;

536 
	`fe_acûs£d
(
š
);

539  
»t
;

540 
	}
}

541 
EXPORT_SYMBOL
(
g’”ic_fe_¥liû_»ad
);

543 cÚ¡ 
pe_buf_İ”©iÚs
 
	gdeçuÉ_pe_buf_İs
 = {

544 .
ÿn_m”ge
 = 0,

545 .
	gm­
 = 
g’”ic_pe_buf_m­
,

546 .
	gunm­
 = 
g’”ic_pe_buf_unm­
,

547 .
	gcÚfœm
 = 
g’”ic_pe_buf_cÚfœm
,

548 .
	g»Ëa£
 = 
g’”ic_pe_buf_»Ëa£
,

549 .
	g¡—l
 = 
g’”ic_pe_buf_¡—l
,

550 .
	gg‘
 = 
g’”ic_pe_buf_g‘
,

553 
ssize_t
 
	$k”Ãl_»adv
(
fe
 *fe, cÚ¡ 
iovec
 *
vec
,

554 
vËn
, 
loff_t
 
off£t
)

556 
mm_£gm’t_t
 
Şd_fs
;

557 
loff_t
 
pos
 = 
off£t
;

558 
ssize_t
 
»s
;

560 
Şd_fs
 = 
	`g‘_fs
();

561 
	`£t_fs
(
	`g‘_ds
());

563 
»s
 = 
	`vfs_»adv
(
fe
, (cÚ¡ 
iovec
 
__u£r
 *)
vec
, 
vËn
, &
pos
);

564 
	`£t_fs
(
Şd_fs
);

566  
»s
;

567 
	}
}

569 
ssize_t
 
	$k”Ãl_wr™e
(
fe
 *fe, cÚ¡ *
buf
, 
size_t
 
couÁ
,

570 
loff_t
 
pos
)

572 
mm_£gm’t_t
 
Şd_fs
;

573 
ssize_t
 
»s
;

575 
Şd_fs
 = 
	`g‘_fs
();

576 
	`£t_fs
(
	`g‘_ds
());

578 
»s
 = 
	`vfs_wr™e
(
fe
, (cÚ¡ 
__u£r
 *)
buf
, 
couÁ
, &
pos
);

579 
	`£t_fs
(
Şd_fs
);

581  
»s
;

582 
	}
}

584 
ssize_t
 
	$deçuÉ_fe_¥liû_»ad
(
fe
 *
š
, 
loff_t
 *
µos
,

585 
pe_šode_šfo
 *
pe
, 
size_t
 
Ën
,

586 
æags
)

588 
Ä_·ges
;

589 
Ä_ä“d
;

590 
size_t
 
off£t
;

591 
·ge
 *
·ges
[
PIPE_DEF_BUFFERS
];

592 
·¹Ÿl_·ge
 
·¹Ÿl
[
PIPE_DEF_BUFFERS
];

593 
iovec
 *
vec
, 
__vec
[
PIPE_DEF_BUFFERS
];

594 
ssize_t
 
»s
;

595 
size_t
 
this_Ën
;

596 
”rÜ
;

597 
i
;

598 
¥liû_pe_desc
 
¥d
 = {

599 .
·ges
 =…ages,

600 .
·¹Ÿl
 =…artial,

601 .
æags
 = flags,

602 .
İs
 = &
deçuÉ_pe_buf_İs
,

603 .
¥d_»Ëa£
 = 
¥d_»Ëa£_·ge
,

606 ià(
	`¥liû_grow_¥d
(
pe
, &
¥d
))

607  -
ENOMEM
;

609 
»s
 = -
ENOMEM
;

610 
vec
 = 
__vec
;

611 ià(
pe
->
bufãrs
 > 
PIPE_DEF_BUFFERS
) {

612 
vec
 = 
	`km®loc
(
pe
->
bufãrs
 * (
iovec
), 
GFP_KERNEL
);

613 ià(!
vec
)

614 
shršk_»t
;

617 
off£t
 = *
µos
 & ~
PAGE_CACHE_MASK
;

618 
Ä_·ges
 = (
Ën
 + 
off£t
 + 
PAGE_CACHE_SIZE
 - 1è>> 
PAGE_CACHE_SHIFT
;

620 
i
 = 0; i < 
Ä_·ges
 && i < 
pe
->
bufãrs
 && 
Ën
; i++) {

621 
·ge
 *page;

623 
·ge
 = 
	`®loc_·ge
(
GFP_USER
);

624 
”rÜ
 = -
ENOMEM
;

625 ià(!
·ge
)

626 
”r
;

628 
this_Ën
 = 
	`mš_t
(
size_t
, 
Ën
, 
PAGE_CACHE_SIZE
 - 
off£t
);

629 
vec
[
i
].
iov_ba£
 = (
__u£r
 *è
	`·ge_add»ss
(
·ge
);

630 
vec
[
i
].
iov_Ën
 = 
this_Ën
;

631 
¥d
.
·ges
[
i
] = 
·ge
;

632 
¥d
.
Ä_·ges
++;

633 
Ën
 -ğ
this_Ën
;

634 
off£t
 = 0;

637 
»s
 = 
	`k”Ãl_»adv
(
š
, 
vec
, 
¥d
.
Ä_·ges
, *
µos
);

638 ià(
»s
 < 0) {

639 
”rÜ
 = 
»s
;

640 
”r
;

643 
”rÜ
 = 0;

644 ià(!
»s
)

645 
”r
;

647 
Ä_ä“d
 = 0;

648 
i
 = 0; i < 
¥d
.
Ä_·ges
; i++) {

649 
this_Ën
 = 
	`mš_t
(
size_t
, 
vec
[
i
].
iov_Ën
, 
»s
);

650 
¥d
.
·¹Ÿl
[
i
].
off£t
 = 0;

651 
¥d
.
·¹Ÿl
[
i
].
Ën
 = 
this_Ën
;

652 ià(!
this_Ën
) {

653 
	`__ä“_·ge
(
¥d
.
·ges
[
i
]);

654 
¥d
.
·ges
[
i
] = 
NULL
;

655 
Ä_ä“d
++;

657 
»s
 -ğ
this_Ën
;

659 
¥d
.
Ä_·ges
 -ğ
Ä_ä“d
;

661 
»s
 = 
	`¥liû_to_pe
(
pe
, &
¥d
);

662 ià(
»s
 > 0)

663 *
µos
 +ğ
»s
;

665 
shršk_»t
:

666 ià(
vec
 !ğ
__vec
)

667 
	`kä“
(
vec
);

668 
	`¥liû_shršk_¥d
(
pe
, &
¥d
);

669  
»s
;

671 
”r
:

672 
i
 = 0; i < 
¥d
.
Ä_·ges
; i++)

673 
	`__ä“_·ge
(
¥d
.
·ges
[
i
]);

675 
»s
 = 
”rÜ
;

676 
shršk_»t
;

677 
	}
}

678 
EXPORT_SYMBOL
(
deçuÉ_fe_¥liû_»ad
);

684 
	$pe_to_£nd·ge
(
pe_šode_šfo
 *
pe
,

685 
pe_bufãr
 *
buf
, 
¥liû_desc
 *
sd
)

687 
fe
 *fğ
sd
->
u
.file;

688 
loff_t
 
pos
 = 
sd
->pos;

689 
mÜe
;

691 ià(!
	`lik–y
(
fe
->
f_İ
 && fe->f_İ->
£nd·ge
))

692  -
EINVAL
;

694 
mÜe
 = (
sd
->
æags
 & 
SPLICE_F_MORE
è|| sd->
Ën
 < sd->
tÙ®_Ën
;

695  
fe
->
f_İ
->
	`£nd·ge
(fe, 
buf
->
·ge
, buf->
off£t
,

696 
sd
->
Ën
, &
pos
, 
mÜe
);

697 
	}
}

719 
	$pe_to_fe
(
pe_šode_šfo
 *
pe
, 
pe_bufãr
 *
buf
,

720 
¥liû_desc
 *
sd
)

722 
fe
 *fğ
sd
->
u
.file;

723 
add»ss_¥aû
 *
m­pšg
 = 
fe
->
f_m­pšg
;

724 
off£t
, 
this_Ën
;

725 
·ge
 *page;

726 *
fsd©a
;

727 
»t
;

729 
off£t
 = 
sd
->
pos
 & ~
PAGE_CACHE_MASK
;

731 
this_Ën
 = 
sd
->
Ën
;

732 ià(
this_Ën
 + 
off£t
 > 
PAGE_CACHE_SIZE
)

733 
this_Ën
 = 
PAGE_CACHE_SIZE
 - 
off£t
;

735 
»t
 = 
	`·geÿche_wr™e_begš
(
fe
, 
m­pšg
, 
sd
->
pos
, 
this_Ën
,

736 
AOP_FLAG_UNINTERRUPTIBLE
, &
·ge
, &
fsd©a
);

737 ià(
	`uÆik–y
(
»t
))

738 
out
;

740 ià(
buf
->
·ge
 !=…age) {

744 *
¤c
 = 
buf
->
İs
->
	`m­
(
pe
, buf, 1);

745 *
d¡
 = 
	`km­_©omic
(
·ge
, 
KM_USER1
);

747 
	`memıy
(
d¡
 + 
off£t
, 
¤c
 + 
buf
->off£t, 
this_Ën
);

748 
	`æush_dÿche_·ge
(
·ge
);

749 
	`kunm­_©omic
(
d¡
, 
KM_USER1
);

750 
buf
->
İs
->
	`unm­
(
pe
, buf, 
¤c
);

752 
»t
 = 
	`·geÿche_wr™e_’d
(
fe
, 
m­pšg
, 
sd
->
pos
, 
this_Ën
,his_len,

753 
·ge
, 
fsd©a
);

754 
out
:

755  
»t
;

756 
	}
}

757 
EXPORT_SYMBOL
(
pe_to_fe
);

759 
	$wakeup_pe_wr™”s
(
pe_šode_šfo
 *
pe
)

761 
	`smp_mb
();

762 ià(
	`wa™queue_aùive
(&
pe
->
wa™
))

763 
	`wake_up_š‹¼u±ibË
(&
pe
->
wa™
);

764 
	`kl_çsync
(&
pe
->
çsync_wr™”s
, 
SIGIO
, 
POLL_OUT
);

765 
	}
}

787 
	$¥liû_äom_pe_ãed
(
pe_šode_šfo
 *
pe
, 
¥liû_desc
 *
sd
,

788 
¥liû_aùÜ
 *
aùÜ
)

790 
»t
;

792 
pe
->
Äbufs
) {

793 
pe_bufãr
 *
buf
 = 
pe
->
bufs
 +…e->
curbuf
;

794 cÚ¡ 
pe_buf_İ”©iÚs
 *
İs
 = 
buf
->ops;

796 
sd
->
Ën
 = 
buf
->len;

797 ià(
sd
->
Ën
 > sd->
tÙ®_Ën
)

798 
sd
->
Ën
 = sd->
tÙ®_Ën
;

800 
»t
 = 
buf
->
İs
->
	`cÚfœm
(
pe
, buf);

801 ià(
	`uÆik–y
(
»t
)) {

802 ià(
»t
 =ğ-
ENODATA
)

803 
»t
 = 0;

804  
»t
;

807 
»t
 = 
	`aùÜ
(
pe
, 
buf
, 
sd
);

808 ià(
»t
 <= 0)

809  
»t
;

811 
buf
->
off£t
 +ğ
»t
;

812 
buf
->
Ën
 -ğ
»t
;

814 
sd
->
num_¥liûd
 +ğ
»t
;

815 
sd
->
Ën
 -ğ
»t
;

816 
sd
->
pos
 +ğ
»t
;

817 
sd
->
tÙ®_Ën
 -ğ
»t
;

819 ià(!
buf
->
Ën
) {

820 
buf
->
İs
 = 
NULL
;

821 
İs
->
	`»Ëa£
(
pe
, 
buf
);

822 
pe
->
curbuf
 = (pe->curbuà+ 1è& (pe->
bufãrs
 - 1);

823 
pe
->
Äbufs
--;

824 ià(
pe
->
šode
)

825 
sd
->
Ãed_wakeup
 = 
Œue
;

828 ià(!
sd
->
tÙ®_Ën
)

833 
	}
}

834 
EXPORT_SYMBOL
(
¥liû_äom_pe_ãed
);

846 
	$¥liû_äom_pe_Ãxt
(
pe_šode_šfo
 *
pe
, 
¥liû_desc
 *
sd
)

848 !
pe
->
Äbufs
) {

849 ià(!
pe
->
wr™”s
)

852 ià(!
pe
->
wa™šg_wr™”s
 && 
sd
->
num_¥liûd
)

855 ià(
sd
->
æags
 & 
SPLICE_F_NONBLOCK
)

856  -
EAGAIN
;

858 ià(
	`sigÇl_³ndšg
(
cu¼’t
))

859  -
ERESTARTSYS
;

861 ià(
sd
->
Ãed_wakeup
) {

862 
	`wakeup_pe_wr™”s
(
pe
);

863 
sd
->
Ãed_wakeup
 = 
çl£
;

866 
	`pe_wa™
(
pe
);

870 
	}
}

871 
EXPORT_SYMBOL
(
¥liû_äom_pe_Ãxt
);

882 
	$¥liû_äom_pe_begš
(
¥liû_desc
 *
sd
)

884 
sd
->
num_¥liûd
 = 0;

885 
sd
->
Ãed_wakeup
 = 
çl£
;

886 
	}
}

887 
EXPORT_SYMBOL
(
¥liû_äom_pe_begš
);

899 
	$¥liû_äom_pe_’d
(
pe_šode_šfo
 *
pe
, 
¥liû_desc
 *
sd
)

901 ià(
sd
->
Ãed_wakeup
)

902 
	`wakeup_pe_wr™”s
(
pe
);

903 
	}
}

904 
EXPORT_SYMBOL
(
¥liû_äom_pe_’d
);

919 
ssize_t
 
	$__¥liû_äom_pe
(
pe_šode_šfo
 *
pe
, 
¥liû_desc
 *
sd
,

920 
¥liû_aùÜ
 *
aùÜ
)

922 
»t
;

924 
	`¥liû_äom_pe_begš
(
sd
);

926 
»t
 = 
	`¥liû_äom_pe_Ãxt
(
pe
, 
sd
);

927 ià(
»t
 > 0)

928 
»t
 = 
	`¥liû_äom_pe_ãed
(
pe
, 
sd
, 
aùÜ
);

929 } 
»t
 > 0);

930 
	`¥liû_äom_pe_’d
(
pe
, 
sd
);

932  
sd
->
num_¥liûd
 ? sd->num_¥liûd : 
»t
;

933 
	}
}

934 
EXPORT_SYMBOL
(
__¥liû_äom_pe
);

950 
ssize_t
 
	$¥liû_äom_pe
(
pe_šode_šfo
 *
pe
, 
fe
 *
out
,

951 
loff_t
 *
µos
, 
size_t
 
Ën
, 
æags
,

952 
¥liû_aùÜ
 *
aùÜ
)

954 
ssize_t
 
»t
;

955 
¥liû_desc
 
sd
 = {

956 .
tÙ®_Ën
 = 
Ën
,

957 .
æags
 = flags,

958 .
pos
 = *
µos
,

959 .
u
.
fe
 = 
out
,

962 
	`pe_lock
(
pe
);

963 
»t
 = 
	`__¥liû_äom_pe
(
pe
, &
sd
, 
aùÜ
);

964 
	`pe_uÆock
(
pe
);

966  
»t
;

967 
	}
}

982 
ssize_t


983 
	$g’”ic_fe_¥liû_wr™e
(
pe_šode_šfo
 *
pe
, 
fe
 *
out
,

984 
loff_t
 *
µos
, 
size_t
 
Ën
, 
æags
)

986 
add»ss_¥aû
 *
m­pšg
 = 
out
->
f_m­pšg
;

987 
šode
 *šodğ
m­pšg
->
ho¡
;

988 
¥liû_desc
 
sd
 = {

989 .
tÙ®_Ën
 = 
Ën
,

990 .
æags
 = flags,

991 .
pos
 = *
µos
,

992 .
u
.
fe
 = 
out
,

994 
ssize_t
 
»t
;

996 
	`pe_lock
(
pe
);

998 
	`¥liû_äom_pe_begš
(&
sd
);

1000 
»t
 = 
	`¥liû_äom_pe_Ãxt
(
pe
, &
sd
);

1001 ià(
»t
 <= 0)

1004 
	`mu‹x_lock_Ã¡ed
(&
šode
->
i_mu‹x
, 
I_MUTEX_CHILD
);

1005 
»t
 = 
	`fe_»move_suid
(
out
);

1006 ià(!
»t
) {

1007 
	`fe_upd©e_time
(
out
);

1008 
»t
 = 
	`¥liû_äom_pe_ãed
(
pe
, &
sd
, 
pe_to_fe
);

1010 
	`mu‹x_uÆock
(&
šode
->
i_mu‹x
);

1011 } 
»t
 > 0);

1012 
	`¥liû_äom_pe_’d
(
pe
, &
sd
);

1014 
	`pe_uÆock
(
pe
);

1016 ià(
sd
.
num_¥liûd
)

1017 
»t
 = 
sd
.
num_¥liûd
;

1019 ià(
»t
 > 0) {

1020 
Ä_·ges
;

1021 
”r
;

1023 
Ä_·ges
 = (
»t
 + 
PAGE_CACHE_SIZE
 - 1è>> 
PAGE_CACHE_SHIFT
;

1025 
”r
 = 
	`g’”ic_wr™e_sync
(
out
, *
µos
, 
»t
);

1026 ià(
”r
)

1027 
»t
 = 
”r
;

1029 *
µos
 +ğ
»t
;

1030 
	`b®ªû_dœty_·ges_¿‹lim™ed_Ä
(
m­pšg
, 
Ä_·ges
);

1033  
»t
;

1034 
	}
}

1036 
EXPORT_SYMBOL
(
g’”ic_fe_¥liû_wr™e
);

1038 
	$wr™e_pe_buf
(
pe_šode_šfo
 *
pe
, 
pe_bufãr
 *
buf
,

1039 
¥liû_desc
 *
sd
)

1041 
»t
;

1042 *
d©a
;

1044 
d©a
 = 
buf
->
İs
->
	`m­
(
pe
, buf, 0);

1045 
»t
 = 
	`k”Ãl_wr™e
(
sd
->
u
.
fe
, 
d©a
 + 
buf
->
off£t
, sd->
Ën
, sd->
pos
);

1046 
buf
->
İs
->
	`unm­
(
pe
, buf, 
d©a
);

1048  
»t
;

1049 
	}
}

1051 
ssize_t
 
	$deçuÉ_fe_¥liû_wr™e
(
pe_šode_šfo
 *
pe
,

1052 
fe
 *
out
, 
loff_t
 *
µos
,

1053 
size_t
 
Ën
, 
æags
)

1055 
ssize_t
 
»t
;

1057 
»t
 = 
	`¥liû_äom_pe
(
pe
, 
out
, 
µos
, 
Ën
, 
æags
, 
wr™e_pe_buf
);

1058 ià(
»t
 > 0)

1059 *
µos
 +ğ
»t
;

1061  
»t
;

1062 
	}
}

1077 
ssize_t
 
	$g’”ic_¥liû_£nd·ge
(
pe_šode_šfo
 *
pe
, 
fe
 *
out
,

1078 
loff_t
 *
µos
, 
size_t
 
Ën
, 
æags
)

1080  
	`¥liû_äom_pe
(
pe
, 
out
, 
µos
, 
Ën
, 
æags
, 
pe_to_£nd·ge
);

1081 
	}
}

1083 
EXPORT_SYMBOL
(
g’”ic_¥liû_£nd·ge
);

1088 
	$do_¥liû_äom
(
pe_šode_šfo
 *
pe
, 
fe
 *
out
,

1089 
loff_t
 *
µos
, 
size_t
 
Ën
, 
æags
)

1091 
	`ssize_t
 (*
¥liû_wr™e
)(
pe_šode_šfo
 *, 
fe
 *,

1092 
loff_t
 *, 
size_t
, );

1093 
»t
;

1095 ià(
	`uÆik–y
(!(
out
->
f_mode
 & 
FMODE_WRITE
)))

1096  -
EBADF
;

1098 ià(
	`uÆik–y
(
out
->
f_æags
 & 
O_APPEND
))

1099  -
EINVAL
;

1101 
»t
 = 
	`rw_v”ify_¬—
(
WRITE
, 
out
, 
µos
, 
Ën
);

1102 ià(
	`uÆik–y
(
»t
 < 0))

1103  
»t
;

1105 ià(
out
->
f_İ
 && out->f_İ->
¥liû_wr™e
)

1106 
¥liû_wr™e
 = 
out
->
f_İ
->splice_write;

1108 
¥liû_wr™e
 = 
deçuÉ_fe_¥liû_wr™e
;

1110  
	`¥liû_wr™e
(
pe
, 
out
, 
µos
, 
Ën
, 
æags
);

1111 
	}
}

1116 
	$do_¥liû_to
(
fe
 *
š
, 
loff_t
 *
µos
,

1117 
pe_šode_šfo
 *
pe
, 
size_t
 
Ën
,

1118 
æags
)

1120 
	`ssize_t
 (*
¥liû_»ad
)(
fe
 *, 
loff_t
 *,

1121 
pe_šode_šfo
 *, 
size_t
, );

1122 
»t
;

1124 ià(
	`uÆik–y
(!(
š
->
f_mode
 & 
FMODE_READ
)))

1125  -
EBADF
;

1127 
»t
 = 
	`rw_v”ify_¬—
(
READ
, 
š
, 
µos
, 
Ën
);

1128 ià(
	`uÆik–y
(
»t
 < 0))

1129  
»t
;

1131 ià(
š
->
f_İ
 && in->f_İ->
¥liû_»ad
)

1132 
¥liû_»ad
 = 
š
->
f_İ
->splice_read;

1134 
¥liû_»ad
 = 
deçuÉ_fe_¥liû_»ad
;

1136  
	`¥liû_»ad
(
š
, 
µos
, 
pe
, 
Ën
, 
æags
);

1137 
	}
}

1152 
ssize_t
 
	$¥liû_dœeù_to_aùÜ
(
fe
 *
š
, 
¥liû_desc
 *
sd
,

1153 
¥liû_dœeù_aùÜ
 *
aùÜ
)

1155 
pe_šode_šfo
 *
pe
;

1156 
»t
, 
by‹s
;

1157 
umode_t
 
i_mode
;

1158 
size_t
 
Ën
;

1159 
i
, 
æags
;

1166 
i_mode
 = 
š
->
f_·th
.
d’Œy
->
d_šode
->i_mode;

1167 ià(
	`uÆik–y
(!
	`S_ISREG
(
i_mode
è&& !
	`S_ISBLK
(i_mode)))

1168  -
EINVAL
;

1174 
pe
 = 
cu¼’t
->
¥liû_pe
;

1175 ià(
	`uÆik–y
(!
pe
)) {

1176 
pe
 = 
	`®loc_pe_šfo
(
NULL
);

1177 ià(!
pe
)

1178  -
ENOMEM
;

1185 
pe
->
»ad”s
 = 1;

1187 
cu¼’t
->
¥liû_pe
 = 
pe
;

1193 
»t
 = 0;

1194 
by‹s
 = 0;

1195 
Ën
 = 
sd
->
tÙ®_Ën
;

1196 
æags
 = 
sd
->flags;

1201 
sd
->
æags
 &ğ~
SPLICE_F_NONBLOCK
;

1203 
Ën
) {

1204 
size_t
 
»ad_Ën
;

1205 
loff_t
 
pos
 = 
sd
->pos, 
´ev_pos
 =…os;

1207 
»t
 = 
	`do_¥liû_to
(
š
, &
pos
, 
pe
, 
Ën
, 
æags
);

1208 ià(
	`uÆik–y
(
»t
 <= 0))

1209 
out_»Ëa£
;

1211 
»ad_Ën
 = 
»t
;

1212 
sd
->
tÙ®_Ën
 = 
»ad_Ën
;

1219 
»t
 = 
	`aùÜ
(
pe
, 
sd
);

1220 ià(
	`uÆik–y
(
»t
 <= 0)) {

1221 
sd
->
pos
 = 
´ev_pos
;

1222 
out_»Ëa£
;

1225 
by‹s
 +ğ
»t
;

1226 
Ën
 -ğ
»t
;

1227 
sd
->
pos
 =…os;

1229 ià(
»t
 < 
»ad_Ën
) {

1230 
sd
->
pos
 = 
´ev_pos
 + 
»t
;

1231 
out_»Ëa£
;

1235 
dÚe
:

1236 
pe
->
Äbufs
 =…e->
curbuf
 = 0;

1237 
	`fe_acûs£d
(
š
);

1238  
by‹s
;

1240 
out_»Ëa£
:

1245 
i
 = 0; i < 
pe
->
bufãrs
; i++) {

1246 
pe_bufãr
 *
buf
 = 
pe
->
bufs
 + 
i
;

1248 ià(
buf
->
İs
) {

1249 
buf
->
İs
->
	`»Ëa£
(
pe
, buf);

1250 
buf
->
İs
 = 
NULL
;

1254 ià(!
by‹s
)

1255 
by‹s
 = 
»t
;

1257 
dÚe
;

1258 
	}
}

1259 
EXPORT_SYMBOL
(
¥liû_dœeù_to_aùÜ
);

1261 
	$dœeù_¥liû_aùÜ
(
pe_šode_šfo
 *
pe
,

1262 
¥liû_desc
 *
sd
)

1264 
fe
 *fğ
sd
->
u
.file;

1266  
	`do_¥liû_äom
(
pe
, 
fe
, &fe->
f_pos
, 
sd
->
tÙ®_Ën
,

1267 
sd
->
æags
);

1268 
	}
}

1285 
	$do_¥liû_dœeù
(
fe
 *
š
, 
loff_t
 *
µos
, f*
out
,

1286 
size_t
 
Ën
, 
æags
)

1288 
¥liû_desc
 
sd
 = {

1289 .
Ën
 =†en,

1290 .
tÙ®_Ën
 = 
Ën
,

1291 .
æags
 = flags,

1292 .
pos
 = *
µos
,

1293 .
u
.
fe
 = 
out
,

1295 
»t
;

1297 
»t
 = 
	`¥liû_dœeù_to_aùÜ
(
š
, &
sd
, 
dœeù_¥liû_aùÜ
);

1298 ià(
»t
 > 0)

1299 *
µos
 = 
sd
.
pos
;

1301  
»t
;

1302 
	}
}

1304 
¥liû_pe_to_pe
(
pe_šode_šfo
 *
e
,

1305 
pe_šode_šfo
 *
İe
,

1306 
size_t
 
Ën
, 
æags
);

1311 
	$do_¥liû
(
fe
 *
š
, 
loff_t
 
__u£r
 *
off_š
,

1312 
fe
 *
out
, 
loff_t
 
__u£r
 *
off_out
,

1313 
size_t
 
Ën
, 
æags
)

1315 
pe_šode_šfo
 *
e
;

1316 
pe_šode_šfo
 *
İe
;

1317 
loff_t
 
off£t
, *
off
;

1318 
»t
;

1320 
e
 = 
	`g‘_pe_šfo
(
š
);

1321 
İe
 = 
	`g‘_pe_šfo
(
out
);

1323 ià(
e
 && 
İe
) {

1324 ià(
off_š
 || 
off_out
)

1325  -
ESPIPE
;

1327 ià(!(
š
->
f_mode
 & 
FMODE_READ
))

1328  -
EBADF
;

1330 ià(!(
out
->
f_mode
 & 
FMODE_WRITE
))

1331  -
EBADF
;

1334 ià(
e
 =ğ
İe
)

1335  -
EINVAL
;

1337  
	`¥liû_pe_to_pe
(
e
, 
İe
, 
Ën
, 
æags
);

1340 ià(
e
) {

1341 ià(
off_š
)

1342  -
ESPIPE
;

1343 ià(
off_out
) {

1344 ià(!(
out
->
f_mode
 & 
FMODE_PWRITE
))

1345  -
EINVAL
;

1346 ià(
	`cİy_äom_u£r
(&
off£t
, 
off_out
, (
loff_t
)))

1347  -
EFAULT
;

1348 
off
 = &
off£t
;

1350 
off
 = &
out
->
f_pos
;

1352 
»t
 = 
	`do_¥liû_äom
(
e
, 
out
, 
off
, 
Ën
, 
æags
);

1354 ià(
off_out
 && 
	`cİy_to_u£r
(off_out, 
off
, (
loff_t
)))

1355 
»t
 = -
EFAULT
;

1357  
»t
;

1360 ià(
İe
) {

1361 ià(
off_out
)

1362  -
ESPIPE
;

1363 ià(
off_š
) {

1364 ià(!(
š
->
f_mode
 & 
FMODE_PREAD
))

1365  -
EINVAL
;

1366 ià(
	`cİy_äom_u£r
(&
off£t
, 
off_š
, (
loff_t
)))

1367  -
EFAULT
;

1368 
off
 = &
off£t
;

1370 
off
 = &
š
->
f_pos
;

1372 
»t
 = 
	`do_¥liû_to
(
š
, 
off
, 
İe
, 
Ën
, 
æags
);

1374 ià(
off_š
 && 
	`cİy_to_u£r
(off_š, 
off
, (
loff_t
)))

1375 
»t
 = -
EFAULT
;

1377  
»t
;

1380  -
EINVAL
;

1381 
	}
}

1390 
	$g‘_iovec_·ge_¬¿y
(cÚ¡ 
iovec
 
__u£r
 *
iov
,

1391 
Ä_vecs
, 
·ge
 **
·ges
,

1392 
·¹Ÿl_·ge
 *
·¹Ÿl
, 
®igÃd
,

1393 
pe_bufãrs
)

1395 
bufãrs
 = 0, 
”rÜ
 = 0;

1397 
Ä_vecs
) {

1398 
off
, 
Åages
;

1399 
iovec
 
’Œy
;

1400 
__u£r
 *
ba£
;

1401 
size_t
 
Ën
;

1402 
i
;

1404 
”rÜ
 = -
EFAULT
;

1405 ià(
	`cİy_äom_u£r
(&
’Œy
, 
iov
, (entry)))

1408 
ba£
 = 
’Œy
.
iov_ba£
;

1409 
Ën
 = 
’Œy
.
iov_Ën
;

1414 
”rÜ
 = 0;

1415 ià(
	`uÆik–y
(!
Ën
))

1417 
”rÜ
 = -
EFAULT
;

1418 ià(!
	`acûss_ok
(
VERIFY_READ
, 
ba£
, 
Ën
))

1425 
off
 = (è
ba£
 & ~
PAGE_MASK
;

1431 
”rÜ
 = -
EINVAL
;

1432 ià(
®igÃd
 && (
off
 || 
Ën
 & ~
PAGE_MASK
))

1435 
Åages
 = (
off
 + 
Ën
 + 
PAGE_SIZE
 - 1è>> 
PAGE_SHIFT
;

1436 ià(
Åages
 > 
pe_bufãrs
 - 
bufãrs
)

1437 
Åages
 = 
pe_bufãrs
 - 
bufãrs
;

1439 
”rÜ
 = 
	`g‘_u£r_·ges_ç¡
(()
ba£
, 
Åages
,

1440 0, &
·ges
[
bufãrs
]);

1442 ià(
	`uÆik–y
(
”rÜ
 <= 0))

1448 
i
 = 0; i < 
”rÜ
; i++) {

1449 cÚ¡ 
¶’
 = 
	`mš_t
(
size_t
, 
Ën
, 
PAGE_SIZE
 - 
off
);

1451 
·¹Ÿl
[
bufãrs
].
off£t
 = 
off
;

1452 
·¹Ÿl
[
bufãrs
].
Ën
 = 
¶’
;

1454 
off
 = 0;

1455 
Ën
 -ğ
¶’
;

1456 
bufãrs
++;

1464 ià(
Ën
)

1472 ià(
”rÜ
 < 
Åages
 || 
bufãrs
 =ğ
pe_bufãrs
)

1475 
Ä_vecs
--;

1476 
iov
++;

1479 ià(
bufãrs
)

1480  
bufãrs
;

1482  
”rÜ
;

1483 
	}
}

1485 
	$pe_to_u£r
(
pe_šode_šfo
 *
pe
, 
pe_bufãr
 *
buf
,

1486 
¥liû_desc
 *
sd
)

1488 *
¤c
;

1489 
»t
;

1495 ià(!
	`çuÉ_š_·ges_wr™—bË
(
sd
->
u
.
u£½Œ
, sd->
Ën
)) {

1496 
¤c
 = 
buf
->
İs
->
	`m­
(
pe
, buf, 1);

1497 
»t
 = 
	`__cİy_to_u£r_š©omic
(
sd
->
u
.
u£½Œ
, 
¤c
 + 
buf
->
off£t
,

1498 
sd
->
Ën
);

1499 
buf
->
İs
->
	`unm­
(
pe
, buf, 
¤c
);

1500 ià(!
»t
) {

1501 
»t
 = 
sd
->
Ën
;

1502 
out
;

1509 
¤c
 = 
buf
->
İs
->
	`m­
(
pe
, buf, 0);

1511 
»t
 = 
sd
->
Ën
;

1512 ià(
	`cİy_to_u£r
(
sd
->
u
.
u£½Œ
, 
¤c
 + 
buf
->
off£t
, sd->
Ën
))

1513 
»t
 = -
EFAULT
;

1515 
buf
->
İs
->
	`unm­
(
pe
, buf, 
¤c
);

1516 
out
:

1517 ià(
»t
 > 0)

1518 
sd
->
u
.
u£½Œ
 +ğ
»t
;

1519  
»t
;

1520 
	}
}

1526 
	$vm¥liû_to_u£r
(
fe
 *fe, cÚ¡ 
iovec
 
__u£r
 *
iov
,

1527 
Ä_£gs
, 
æags
)

1529 
pe_šode_šfo
 *
pe
;

1530 
¥liû_desc
 
sd
;

1531 
ssize_t
 
size
;

1532 
”rÜ
;

1533 
»t
;

1535 
pe
 = 
	`g‘_pe_šfo
(
fe
);

1536 ià(!
pe
)

1537  -
EBADF
;

1539 
	`pe_lock
(
pe
);

1541 
”rÜ
 = 
»t
 = 0;

1542 
Ä_£gs
) {

1543 
__u£r
 *
ba£
;

1544 
size_t
 
Ën
;

1549 
”rÜ
 = 
	`g‘_u£r
(
ba£
, &
iov
->
iov_ba£
);

1550 ià(
	`uÆik–y
(
”rÜ
))

1552 
”rÜ
 = 
	`g‘_u£r
(
Ën
, &
iov
->
iov_Ën
);

1553 ià(
	`uÆik–y
(
”rÜ
))

1559 ià(
	`uÆik–y
(!
Ën
))

1561 ià(
	`uÆik–y
(!
ba£
)) {

1562 
”rÜ
 = -
EFAULT
;

1566 ià(
	`uÆik–y
(!
	`acûss_ok
(
VERIFY_WRITE
, 
ba£
, 
Ën
))) {

1567 
”rÜ
 = -
EFAULT
;

1571 
sd
.
Ën
 = 0;

1572 
sd
.
tÙ®_Ën
 = 
Ën
;

1573 
sd
.
æags
 = flags;

1574 
sd
.
u
.
u£½Œ
 = 
ba£
;

1575 
sd
.
pos
 = 0;

1577 
size
 = 
	`__¥liû_äom_pe
(
pe
, &
sd
, 
pe_to_u£r
);

1578 ià(
size
 < 0) {

1579 ià(!
»t
)

1580 
»t
 = 
size
;

1585 
»t
 +ğ
size
;

1587 ià(
size
 < 
Ën
)

1590 
Ä_£gs
--;

1591 
iov
++;

1594 
	`pe_uÆock
(
pe
);

1596 ià(!
»t
)

1597 
»t
 = 
”rÜ
;

1599  
»t
;

1600 
	}
}

1607 
	$vm¥liû_to_pe
(
fe
 *fe, cÚ¡ 
iovec
 
__u£r
 *
iov
,

1608 
Ä_£gs
, 
æags
)

1610 
pe_šode_šfo
 *
pe
;

1611 
·ge
 *
·ges
[
PIPE_DEF_BUFFERS
];

1612 
·¹Ÿl_·ge
 
·¹Ÿl
[
PIPE_DEF_BUFFERS
];

1613 
¥liû_pe_desc
 
¥d
 = {

1614 .
·ges
 =…ages,

1615 .
·¹Ÿl
 =…artial,

1616 .
æags
 = flags,

1617 .
İs
 = &
u£r_·ge_pe_buf_İs
,

1618 .
¥d_»Ëa£
 = 
¥d_»Ëa£_·ge
,

1620 
»t
;

1622 
pe
 = 
	`g‘_pe_šfo
(
fe
);

1623 ià(!
pe
)

1624  -
EBADF
;

1626 ià(
	`¥liû_grow_¥d
(
pe
, &
¥d
))

1627  -
ENOMEM
;

1629 
¥d
.
Ä_·ges
 = 
	`g‘_iovec_·ge_¬¿y
(
iov
, 
Ä_£gs
, spd.
·ges
,

1630 
¥d
.
·¹Ÿl
, 
æags
 & 
SPLICE_F_GIFT
,

1631 
pe
->
bufãrs
);

1632 ià(
¥d
.
Ä_·ges
 <= 0)

1633 
»t
 = 
¥d
.
Ä_·ges
;

1635 
»t
 = 
	`¥liû_to_pe
(
pe
, &
¥d
);

1637 
	`¥liû_shršk_¥d
(
pe
, &
¥d
);

1638  
»t
;

1639 
	}
}

1657 
	$SYSCALL_DEFINE4
(
vm¥liû
, , 
fd
, cÚ¡ 
iovec
 
__u£r
 *, 
iov
,

1658 , 
Ä_£gs
, , 
æags
)

1660 
fe
 *file;

1661 
”rÜ
;

1662 
åut
;

1664 ià(
	`uÆik–y
(
Ä_£gs
 > 
UIO_MAXIOV
))

1665  -
EINVAL
;

1666 ià(
	`uÆik–y
(!
Ä_£gs
))

1669 
”rÜ
 = -
EBADF
;

1670 
fe
 = 
	`fg‘_light
(
fd
, &
åut
);

1671 ià(
fe
) {

1672 ià(
fe
->
f_mode
 & 
FMODE_WRITE
)

1673 
”rÜ
 = 
	`vm¥liû_to_pe
(
fe
, 
iov
, 
Ä_£gs
, 
æags
);

1674 ià(
fe
->
f_mode
 & 
FMODE_READ
)

1675 
”rÜ
 = 
	`vm¥liû_to_u£r
(
fe
, 
iov
, 
Ä_£gs
, 
æags
);

1677 
	`åut_light
(
fe
, 
åut
);

1680  
”rÜ
;

1681 
	}
}

1683 
	$SYSCALL_DEFINE6
(
¥liû
, , 
fd_š
, 
loff_t
 
__u£r
 *, 
off_š
,

1684 , 
fd_out
, 
loff_t
 
__u£r
 *, 
off_out
,

1685 
size_t
, 
Ën
, , 
æags
)

1687 
”rÜ
;

1688 
fe
 *
š
, *
out
;

1689 
åut_š
, 
åut_out
;

1691 ià(
	`uÆik–y
(!
Ën
))

1694 
”rÜ
 = -
EBADF
;

1695 
š
 = 
	`fg‘_light
(
fd_š
, &
åut_š
);

1696 ià(
š
) {

1697 ià(
š
->
f_mode
 & 
FMODE_READ
) {

1698 
out
 = 
	`fg‘_light
(
fd_out
, &
åut_out
);

1699 ià(
out
) {

1700 ià(
out
->
f_mode
 & 
FMODE_WRITE
)

1701 
”rÜ
 = 
	`do_¥liû
(
š
, 
off_š
,

1702 
out
, 
off_out
,

1703 
Ën
, 
æags
);

1704 
	`åut_light
(
out
, 
åut_out
);

1708 
	`åut_light
(
š
, 
åut_š
);

1711  
”rÜ
;

1712 
	}
}

1718 
	$e_´•
(
pe_šode_šfo
 *
pe
, 
æags
)

1720 
»t
;

1726 ià(
pe
->
Äbufs
)

1729 
»t
 = 0;

1730 
	`pe_lock
(
pe
);

1732 !
pe
->
Äbufs
) {

1733 ià(
	`sigÇl_³ndšg
(
cu¼’t
)) {

1734 
»t
 = -
ERESTARTSYS
;

1737 ià(!
pe
->
wr™”s
)

1739 ià(!
pe
->
wa™šg_wr™”s
) {

1740 ià(
æags
 & 
SPLICE_F_NONBLOCK
) {

1741 
»t
 = -
EAGAIN
;

1745 
	`pe_wa™
(
pe
);

1748 
	`pe_uÆock
(
pe
);

1749  
»t
;

1750 
	}
}

1756 
	$İe_´•
(
pe_šode_šfo
 *
pe
, 
æags
)

1758 
»t
;

1764 ià(
pe
->
Äbufs
 <…e->
bufãrs
)

1767 
»t
 = 0;

1768 
	`pe_lock
(
pe
);

1770 
pe
->
Äbufs
 >ğpe->
bufãrs
) {

1771 ià(!
pe
->
»ad”s
) {

1772 
	`£nd_sig
(
SIGPIPE
, 
cu¼’t
, 0);

1773 
»t
 = -
EPIPE
;

1776 ià(
æags
 & 
SPLICE_F_NONBLOCK
) {

1777 
»t
 = -
EAGAIN
;

1780 ià(
	`sigÇl_³ndšg
(
cu¼’t
)) {

1781 
»t
 = -
ERESTARTSYS
;

1784 
pe
->
wa™šg_wr™”s
++;

1785 
	`pe_wa™
(
pe
);

1786 
pe
->
wa™šg_wr™”s
--;

1789 
	`pe_uÆock
(
pe
);

1790  
»t
;

1791 
	}
}

1796 
	$¥liû_pe_to_pe
(
pe_šode_šfo
 *
e
,

1797 
pe_šode_šfo
 *
İe
,

1798 
size_t
 
Ën
, 
æags
)

1800 
pe_bufãr
 *
ibuf
, *
obuf
;

1801 
»t
 = 0, 
nbuf
;

1802 
boŞ
 
šput_wakeup
 = 
çl£
;

1805 
»Œy
:

1806 
»t
 = 
	`e_´•
(
e
, 
æags
);

1807 ià(
»t
)

1808  
»t
;

1810 
»t
 = 
	`İe_´•
(
İe
, 
æags
);

1811 ià(
»t
)

1812  
»t
;

1819 
	`pe_doubË_lock
(
e
, 
İe
);

1822 ià(!
İe
->
»ad”s
) {

1823 
	`£nd_sig
(
SIGPIPE
, 
cu¼’t
, 0);

1824 ià(!
»t
)

1825 
»t
 = -
EPIPE
;

1829 ià(!
e
->
Äbufs
 && !e->
wr™”s
)

1836 ià(!
e
->
Äbufs
 || 
İe
->Äbuf >ğİe->
bufãrs
) {

1838 ià(
»t
)

1841 ià(
æags
 & 
SPLICE_F_NONBLOCK
) {

1842 
»t
 = -
EAGAIN
;

1851 
	`pe_uÆock
(
e
);

1852 
	`pe_uÆock
(
İe
);

1853 
»Œy
;

1856 
ibuf
 = 
e
->
bufs
 + ipe->
curbuf
;

1857 
nbuf
 = (
İe
->
curbuf
 + ope->
Äbufs
è& (İe->
bufãrs
 - 1);

1858 
obuf
 = 
İe
->
bufs
 + 
nbuf
;

1860 ià(
Ën
 >ğ
ibuf
->len) {

1864 *
obuf
 = *
ibuf
;

1865 
ibuf
->
İs
 = 
NULL
;

1866 
İe
->
Äbufs
++;

1867 
e
->
curbuf
 = (e->curbuà+ 1è& (e->
bufãrs
 - 1);

1868 
e
->
Äbufs
--;

1869 
šput_wakeup
 = 
Œue
;

1875 
ibuf
->
İs
->
	`g‘
(
e
, ibuf);

1876 *
obuf
 = *
ibuf
;

1882 
obuf
->
æags
 &ğ~
PIPE_BUF_FLAG_GIFT
;

1884 
obuf
->
Ën
 =†en;

1885 
İe
->
Äbufs
++;

1886 
ibuf
->
off£t
 +ğ
obuf
->
Ën
;

1887 
ibuf
->
Ën
 -ğ
obuf
->len;

1889 
»t
 +ğ
obuf
->
Ën
;

1890 
Ën
 -ğ
obuf
->len;

1891 } 
Ën
);

1893 
	`pe_uÆock
(
e
);

1894 
	`pe_uÆock
(
İe
);

1899 ià(
»t
 > 0)

1900 
	`wakeup_pe_»ad”s
(
İe
);

1902 ià(
šput_wakeup
)

1903 
	`wakeup_pe_wr™”s
(
e
);

1905  
»t
;

1906 
	}
}

1911 
	$lšk_pe
(
pe_šode_šfo
 *
e
,

1912 
pe_šode_šfo
 *
İe
,

1913 
size_t
 
Ën
, 
æags
)

1915 
pe_bufãr
 *
ibuf
, *
obuf
;

1916 
»t
 = 0, 
i
 = 0, 
nbuf
;

1923 
	`pe_doubË_lock
(
e
, 
İe
);

1926 ià(!
İe
->
»ad”s
) {

1927 
	`£nd_sig
(
SIGPIPE
, 
cu¼’t
, 0);

1928 ià(!
»t
)

1929 
»t
 = -
EPIPE
;

1937 ià(
i
 >ğ
e
->
Äbufs
 || 
İe
->Äbuf >ğİe->
bufãrs
)

1940 
ibuf
 = 
e
->
bufs
 + ((e->
curbuf
 + 
i
è& (e->
bufãrs
-1));

1941 
nbuf
 = (
İe
->
curbuf
 + ope->
Äbufs
è& (İe->
bufãrs
 - 1);

1947 
ibuf
->
İs
->
	`g‘
(
e
, ibuf);

1949 
obuf
 = 
İe
->
bufs
 + 
nbuf
;

1950 *
obuf
 = *
ibuf
;

1956 
obuf
->
æags
 &ğ~
PIPE_BUF_FLAG_GIFT
;

1958 ià(
obuf
->
Ën
 >†en)

1959 
obuf
->
Ën
 =†en;

1961 
İe
->
Äbufs
++;

1962 
»t
 +ğ
obuf
->
Ën
;

1963 
Ën
 -ğ
obuf
->len;

1964 
i
++;

1965 } 
Ën
);

1971 ià(!
»t
 && 
e
->
wa™šg_wr™”s
 && (
æags
 & 
SPLICE_F_NONBLOCK
))

1972 
»t
 = -
EAGAIN
;

1974 
	`pe_uÆock
(
e
);

1975 
	`pe_uÆock
(
İe
);

1980 ià(
»t
 > 0)

1981 
	`wakeup_pe_»ad”s
(
İe
);

1983  
»t
;

1984 
	}
}

1992 
	$do_‹e
(
fe
 *
š
, f*
out
, 
size_t
 
Ën
,

1993 
æags
)

1995 
pe_šode_šfo
 *
e
 = 
	`g‘_pe_šfo
(
š
);

1996 
pe_šode_šfo
 *
İe
 = 
	`g‘_pe_šfo
(
out
);

1997 
»t
 = -
EINVAL
;

2003 ià(
e
 && 
İe
 && ipipe != opipe) {

2008 
»t
 = 
	`e_´•
(
e
, 
æags
);

2009 ià(!
»t
) {

2010 
»t
 = 
	`İe_´•
(
İe
, 
æags
);

2011 ià(!
»t
)

2012 
»t
 = 
	`lšk_pe
(
e
, 
İe
, 
Ën
, 
æags
);

2016  
»t
;

2017 
	}
}

2019 
	$SYSCALL_DEFINE4
(
‹e
, , 
fdš
, , 
fdout
, 
size_t
, 
Ën
, , 
æags
)

2021 
fe
 *
š
;

2022 
”rÜ
, 
åut_š
;

2024 ià(
	`uÆik–y
(!
Ën
))

2027 
”rÜ
 = -
EBADF
;

2028 
š
 = 
	`fg‘_light
(
fdš
, &
åut_š
);

2029 ià(
š
) {

2030 ià(
š
->
f_mode
 & 
FMODE_READ
) {

2031 
åut_out
;

2032 
fe
 *
out
 = 
	`fg‘_light
(
fdout
, &
åut_out
);

2034 ià(
out
) {

2035 ià(
out
->
f_mode
 & 
FMODE_WRITE
)

2036 
”rÜ
 = 
	`do_‹e
(
š
, 
out
, 
Ën
, 
æags
);

2037 
	`åut_light
(
out
, 
åut_out
);

2040 
	`åut_light
(
š
, 
åut_š
);

2043  
”rÜ
;

2044 
	}
}

	@stack.c

1 
	~<lšux/moduË.h
>

2 
	~<lšux/fs.h
>

3 
	~<lšux/fs_¡ack.h
>

10 
	$fs¡ack_cİy_šode_size
(
šode
 *
d¡
, šod*
¤c
)

12 
loff_t
 
i_size
;

13 
blkút_t
 
i_blocks
;

21 
i_size
 = 
	`i_size_»ad
(
¤c
);

34 ià((
i_blocks
) > ())

35 
	`¥š_lock
(&
¤c
->
i_lock
);

36 
i_blocks
 = 
¤c
->i_blocks;

37 ià((
i_blocks
) > ())

38 
	`¥š_uÆock
(&
¤c
->
i_lock
);

53 ià((
i_size
è> (è|| (
i_blocks
) > ())

54 
	`¥š_lock
(&
d¡
->
i_lock
);

55 
	`i_size_wr™e
(
d¡
, 
i_size
);

56 
d¡
->
i_blocks
 = i_blocks;

57 ià((
i_size
è> (è|| (
i_blocks
) > ())

58 
	`¥š_uÆock
(&
d¡
->
i_lock
);

59 
	}
}

60 
EXPORT_SYMBOL_GPL
(
fs¡ack_cİy_šode_size
);

63 
	$fs¡ack_cİy_©Œ_®l
(
šode
 *
de¡
, cÚ¡ šod*
¤c
)

65 
de¡
->
i_mode
 = 
¤c
->i_mode;

66 
de¡
->
i_uid
 = 
¤c
->i_uid;

67 
de¡
->
i_gid
 = 
¤c
->i_gid;

68 
de¡
->
i_rdev
 = 
¤c
->i_rdev;

69 
de¡
->
i_©ime
 = 
¤c
->i_atime;

70 
de¡
->
i_mtime
 = 
¤c
->i_mtime;

71 
de¡
->
i_ùime
 = 
¤c
->i_ctime;

72 
de¡
->
i_blkb™s
 = 
¤c
->i_blkbits;

73 
de¡
->
i_æags
 = 
¤c
->i_flags;

74 
	`£t_Æšk
(
de¡
, 
¤c
->
i_Æšk
);

75 
	}
}

76 
EXPORT_SYMBOL_GPL
(
fs¡ack_cİy_©Œ_®l
);

	@stat.c

7 
	~<lšux/moduË.h
>

8 
	~<lšux/mm.h
>

9 
	~<lšux/”ºo.h
>

10 
	~<lšux/fe.h
>

11 
	~<lšux/highuid.h
>

12 
	~<lšux/fs.h
>

13 
	~<lšux/Çmei.h
>

14 
	~<lšux/£cur™y.h
>

15 
	~<lšux/sysÿÎs.h
>

16 
	~<lšux/·gem­.h
>

18 
	~<asm/uacûss.h
>

19 
	~<asm/uni¡d.h
>

21 
	$g’”ic_fÏ‰r
(
šode
 *šode, 
k¡©
 *
¡©
)

23 
¡©
->
dev
 = 
šode
->
i_sb
->
s_dev
;

24 
¡©
->
šo
 = 
šode
->
i_šo
;

25 
¡©
->
mode
 = 
šode
->
i_mode
;

26 
¡©
->
Æšk
 = 
šode
->
i_Æšk
;

27 
¡©
->
uid
 = 
šode
->
i_uid
;

28 
¡©
->
gid
 = 
šode
->
i_gid
;

29 
¡©
->
rdev
 = 
šode
->
i_rdev
;

30 
¡©
->
size
 = 
	`i_size_»ad
(
šode
);

31 
¡©
->
©ime
 = 
šode
->
i_©ime
;

32 
¡©
->
mtime
 = 
šode
->
i_mtime
;

33 
¡©
->
ùime
 = 
šode
->
i_ùime
;

34 
¡©
->
blksize
 = (1 << 
šode
->
i_blkb™s
);

35 
¡©
->
blocks
 = 
šode
->
i_blocks
;

36 
	}
}

38 
EXPORT_SYMBOL
(
g’”ic_fÏ‰r
);

40 
	$vfs_g‘©Œ
(
vfsmouÁ
 *
mÁ
, 
d’Œy
 *d’Œy, 
k¡©
 *
¡©
)

42 
šode
 *šodğ
d’Œy
->
d_šode
;

43 
»tv®
;

45 
»tv®
 = 
	`£cur™y_šode_g‘©Œ
(
mÁ
, 
d’Œy
);

46 ià(
»tv®
)

47  
»tv®
;

49 ià(
šode
->
i_İ
->
g‘©Œ
)

50  
šode
->
i_İ
->
	`g‘©Œ
(
mÁ
, 
d’Œy
, 
¡©
);

52 
	`g’”ic_fÏ‰r
(
šode
, 
¡©
);

54 
	}
}

56 
EXPORT_SYMBOL
(
vfs_g‘©Œ
);

58 
	$vfs_f¡©
(
fd
, 
k¡©
 *
¡©
)

60 
fe
 *
f
 = 
	`fg‘
(
fd
);

61 
”rÜ
 = -
EBADF
;

63 ià(
f
) {

64 
”rÜ
 = 
	`vfs_g‘©Œ
(
f
->
f_·th
.
mÁ
, f->f_·th.
d’Œy
, 
¡©
);

65 
	`åut
(
f
);

67  
”rÜ
;

68 
	}
}

69 
EXPORT_SYMBOL
(
vfs_f¡©
);

71 
	$vfs_f¡©©
(
dfd
, cÚ¡ 
__u£r
 *
f’ame
, 
k¡©
 *
¡©
,

72 
æag
)

74 
·th
…ath;

75 
”rÜ
 = -
EINVAL
;

76 
lookup_æags
 = 0;

78 ià((
æag
 & ~(
AT_SYMLINK_NOFOLLOW
 | 
AT_NO_AUTOMOUNT
 |

79 
AT_EMPTY_PATH
)) != 0)

80 
out
;

82 ià(!(
æag
 & 
AT_SYMLINK_NOFOLLOW
))

83 
lookup_æags
 |ğ
LOOKUP_FOLLOW
;

84 ià(
æag
 & 
AT_EMPTY_PATH
)

85 
lookup_æags
 |ğ
LOOKUP_EMPTY
;

87 
”rÜ
 = 
	`u£r_·th_©
(
dfd
, 
f’ame
, 
lookup_æags
, &
·th
);

88 ià(
”rÜ
)

89 
out
;

91 
”rÜ
 = 
	`vfs_g‘©Œ
(
·th
.
mÁ
,…©h.
d’Œy
, 
¡©
);

92 
	`·th_put
(&
·th
);

93 
out
:

94  
”rÜ
;

95 
	}
}

96 
EXPORT_SYMBOL
(
vfs_f¡©©
);

98 
	$vfs_¡©
(cÚ¡ 
__u£r
 *
Çme
, 
k¡©
 *
¡©
)

100  
	`vfs_f¡©©
(
AT_FDCWD
, 
Çme
, 
¡©
, 0);

101 
	}
}

102 
EXPORT_SYMBOL
(
vfs_¡©
);

104 
	$vfs_l¡©
(cÚ¡ 
__u£r
 *
Çme
, 
k¡©
 *
¡©
)

106  
	`vfs_f¡©©
(
AT_FDCWD
, 
Çme
, 
¡©
, 
AT_SYMLINK_NOFOLLOW
);

107 
	}
}

108 
EXPORT_SYMBOL
(
vfs_l¡©
);

111 #ifdeà
__ARCH_WANT_OLD_STAT


117 
	$ı_Şd_¡©
(
k¡©
 *
¡©
, 
__Şd_k”Ãl_¡©
 
__u£r
 * 
¡©buf
)

119 
w¬ncouÁ
 = 5;

120 
__Şd_k”Ãl_¡©
 
tmp
;

122 ià(
w¬ncouÁ
 > 0) {

123 
w¬ncouÁ
--;

124 
	`´štk
(
KERN_WARNING
 "VFS: Warning: %s using old stat() call. Recompile your binary.\n",

125 
cu¼’t
->
comm
);

126 } ià(
w¬ncouÁ
 < 0) {

128 
w¬ncouÁ
 = 0;

131 
	`mem£t
(&
tmp
, 0, (
__Şd_k”Ãl_¡©
));

132 
tmp
.
¡_dev
 = 
	`Şd_’code_dev
(
¡©
->
dev
);

133 
tmp
.
¡_šo
 = 
¡©
->
šo
;

134 ià((
tmp
.
¡_šo
è< (
¡©
->
šo
) &&mp.st_ino != stat->ino)

135  -
EOVERFLOW
;

136 
tmp
.
¡_mode
 = 
¡©
->
mode
;

137 
tmp
.
¡_Æšk
 = 
¡©
->
Æšk
;

138 ià(
tmp
.
¡_Æšk
 !ğ
¡©
->
Æšk
)

139  -
EOVERFLOW
;

140 
	`SET_UID
(
tmp
.
¡_uid
, 
¡©
->
uid
);

141 
	`SET_GID
(
tmp
.
¡_gid
, 
¡©
->
gid
);

142 
tmp
.
¡_rdev
 = 
	`Şd_’code_dev
(
¡©
->
rdev
);

143 #ià
BITS_PER_LONG
 == 32

144 ià(
¡©
->
size
 > 
MAX_NON_LFS
)

145  -
EOVERFLOW
;

147 
tmp
.
¡_size
 = 
¡©
->
size
;

148 
tmp
.
¡_©ime
 = 
¡©
->
©ime
.
tv_£c
;

149 
tmp
.
¡_mtime
 = 
¡©
->
mtime
.
tv_£c
;

150 
tmp
.
¡_ùime
 = 
¡©
->
ùime
.
tv_£c
;

151  
	`cİy_to_u£r
(
¡©buf
,&
tmp
,Ñmp)è? -
EFAULT
 : 0;

152 
	}
}

154 
	$SYSCALL_DEFINE2
(
¡©
, cÚ¡ 
__u£r
 *, 
f’ame
,

155 
__Şd_k”Ãl_¡©
 
__u£r
 *, 
¡©buf
)

157 
k¡©
 
¡©
;

158 
”rÜ
;

160 
”rÜ
 = 
	`vfs_¡©
(
f’ame
, &
¡©
);

161 ià(
”rÜ
)

162  
”rÜ
;

164  
	`ı_Şd_¡©
(&
¡©
, 
¡©buf
);

165 
	}
}

167 
	$SYSCALL_DEFINE2
(
l¡©
, cÚ¡ 
__u£r
 *, 
f’ame
,

168 
__Şd_k”Ãl_¡©
 
__u£r
 *, 
¡©buf
)

170 
k¡©
 
¡©
;

171 
”rÜ
;

173 
”rÜ
 = 
	`vfs_l¡©
(
f’ame
, &
¡©
);

174 ià(
”rÜ
)

175  
”rÜ
;

177  
	`ı_Şd_¡©
(&
¡©
, 
¡©buf
);

178 
	}
}

180 
	$SYSCALL_DEFINE2
(
f¡©
, , 
fd
, 
__Şd_k”Ãl_¡©
 
__u£r
 *, 
¡©buf
)

182 
k¡©
 
¡©
;

183 
”rÜ
 = 
	`vfs_f¡©
(
fd
, &
¡©
);

185 ià(!
”rÜ
)

186 
”rÜ
 = 
	`ı_Şd_¡©
(&
¡©
, 
¡©buf
);

188  
”rÜ
;

189 
	}
}

193 
	$ı_Ãw_¡©
(
k¡©
 *
¡©
, ¡© 
__u£r
 *
¡©buf
)

195 
¡©
 
tmp
;

197 #ià
BITS_PER_LONG
 == 32

198 ià(!
	`Şd_v®id_dev
(
¡©
->
dev
è|| !Şd_v®id_dev(¡©->
rdev
))

199  -
EOVERFLOW
;

201 ià(!
	`Ãw_v®id_dev
(
¡©
->
dev
è|| !Ãw_v®id_dev(¡©->
rdev
))

202  -
EOVERFLOW
;

205 
	`mem£t
(&
tmp
, 0, (tmp));

206 #ià
BITS_PER_LONG
 == 32

207 
tmp
.
¡_dev
 = 
	`Şd_’code_dev
(
¡©
->
dev
);

209 
tmp
.
¡_dev
 = 
	`Ãw_’code_dev
(
¡©
->
dev
);

211 
tmp
.
¡_šo
 = 
¡©
->
šo
;

212 ià((
tmp
.
¡_šo
è< (
¡©
->
šo
) &&mp.st_ino != stat->ino)

213  -
EOVERFLOW
;

214 
tmp
.
¡_mode
 = 
¡©
->
mode
;

215 
tmp
.
¡_Æšk
 = 
¡©
->
Æšk
;

216 ià(
tmp
.
¡_Æšk
 !ğ
¡©
->
Æšk
)

217  -
EOVERFLOW
;

218 
	`SET_UID
(
tmp
.
¡_uid
, 
¡©
->
uid
);

219 
	`SET_GID
(
tmp
.
¡_gid
, 
¡©
->
gid
);

220 #ià
BITS_PER_LONG
 == 32

221 
tmp
.
¡_rdev
 = 
	`Şd_’code_dev
(
¡©
->
rdev
);

223 
tmp
.
¡_rdev
 = 
	`Ãw_’code_dev
(
¡©
->
rdev
);

225 #ià
BITS_PER_LONG
 == 32

226 ià(
¡©
->
size
 > 
MAX_NON_LFS
)

227  -
EOVERFLOW
;

229 
tmp
.
¡_size
 = 
¡©
->
size
;

230 
tmp
.
¡_©ime
 = 
¡©
->
©ime
.
tv_£c
;

231 
tmp
.
¡_mtime
 = 
¡©
->
mtime
.
tv_£c
;

232 
tmp
.
¡_ùime
 = 
¡©
->
ùime
.
tv_£c
;

233 #ifdeà
STAT_HAVE_NSEC


234 
tmp
.
¡_©ime_n£c
 = 
¡©
->
©ime
.
tv_n£c
;

235 
tmp
.
¡_mtime_n£c
 = 
¡©
->
mtime
.
tv_n£c
;

236 
tmp
.
¡_ùime_n£c
 = 
¡©
->
ùime
.
tv_n£c
;

238 
tmp
.
¡_blocks
 = 
¡©
->
blocks
;

239 
tmp
.
¡_blksize
 = 
¡©
->
blksize
;

240  
	`cİy_to_u£r
(
¡©buf
,&
tmp
,Ñmp)è? -
EFAULT
 : 0;

241 
	}
}

243 
	$SYSCALL_DEFINE2
(
Ãw¡©
, cÚ¡ 
__u£r
 *, 
f’ame
,

244 
¡©
 
__u£r
 *, 
¡©buf
)

246 
k¡©
 
¡©
;

247 
”rÜ
 = 
	`vfs_¡©
(
f’ame
, &
¡©
);

249 ià(
”rÜ
)

250  
”rÜ
;

251  
	`ı_Ãw_¡©
(&
¡©
, 
¡©buf
);

252 
	}
}

254 
	$SYSCALL_DEFINE2
(
Ãwl¡©
, cÚ¡ 
__u£r
 *, 
f’ame
,

255 
¡©
 
__u£r
 *, 
¡©buf
)

257 
k¡©
 
¡©
;

258 
”rÜ
;

260 
”rÜ
 = 
	`vfs_l¡©
(
f’ame
, &
¡©
);

261 ià(
”rÜ
)

262  
”rÜ
;

264  
	`ı_Ãw_¡©
(&
¡©
, 
¡©buf
);

265 
	}
}

267 #ià!
defšed
(
__ARCH_WANT_STAT64
è|| defšed(
__ARCH_WANT_SYS_NEWFSTATAT
)

268 
	$SYSCALL_DEFINE4
(
Ãwf¡©©
, , 
dfd
, cÚ¡ 
__u£r
 *, 
f’ame
,

269 
¡©
 
__u£r
 *, 
¡©buf
, , 
æag
)

271 
k¡©
 
¡©
;

272 
”rÜ
;

274 
”rÜ
 = 
	`vfs_f¡©©
(
dfd
, 
f’ame
, &
¡©
, 
æag
);

275 ià(
”rÜ
)

276  
”rÜ
;

277  
	`ı_Ãw_¡©
(&
¡©
, 
¡©buf
);

278 
	}
}

281 
	$SYSCALL_DEFINE2
(
Ãwf¡©
, , 
fd
, 
¡©
 
__u£r
 *, 
¡©buf
)

283 
k¡©
 
¡©
;

284 
”rÜ
 = 
	`vfs_f¡©
(
fd
, &
¡©
);

286 ià(!
”rÜ
)

287 
”rÜ
 = 
	`ı_Ãw_¡©
(&
¡©
, 
¡©buf
);

289  
”rÜ
;

290 
	}
}

292 
	$SYSCALL_DEFINE4
(
»adlšk©
, , 
dfd
, cÚ¡ 
__u£r
 *, 
·thÇme
,

293 
__u£r
 *, 
buf
, , 
bufsiz
)

295 
·th
…ath;

296 
”rÜ
;

297 
em±y
 = 0;

299 ià(
bufsiz
 <= 0)

300  -
EINVAL
;

302 
”rÜ
 = 
	`u£r_·th_©_em±y
(
dfd
, 
·thÇme
, 
LOOKUP_EMPTY
, &
·th
, &
em±y
);

303 ià(!
”rÜ
) {

304 
šode
 *šodğ
·th
.
d’Œy
->
d_šode
;

306 
”rÜ
 = 
em±y
 ? -
ENOENT
 : -
EINVAL
;

307 ià(
šode
->
i_İ
->
»adlšk
) {

308 
”rÜ
 = 
	`£cur™y_šode_»adlšk
(
·th
.
d’Œy
);

309 ià(!
”rÜ
) {

310 
	`touch_©ime
(
·th
.
mÁ
,…©h.
d’Œy
);

311 
”rÜ
 = 
šode
->
i_İ
->
	`»adlšk
(
·th
.
d’Œy
,

312 
buf
, 
bufsiz
);

315 
	`·th_put
(&
·th
);

317  
”rÜ
;

318 
	}
}

320 
	$SYSCALL_DEFINE3
(
»adlšk
, cÚ¡ 
__u£r
 *, 
·th
, __u£¸*, 
buf
,

321 , 
bufsiz
)

323  
	`sys_»adlšk©
(
AT_FDCWD
, 
·th
, 
buf
, 
bufsiz
);

324 
	}
}

328 #ifdeà
__ARCH_WANT_STAT64


330 
	$ı_Ãw_¡©64
(
k¡©
 *
¡©
, 
¡©64
 
__u£r
 *
¡©buf
)

332 
¡©64
 
tmp
;

334 
	`mem£t
(&
tmp
, 0, (
¡©64
));

335 #ifdeà
CONFIG_MIPS


337 ià(!
	`Ãw_v®id_dev
(
¡©
->
dev
è|| !Ãw_v®id_dev(¡©->
rdev
))

338  -
EOVERFLOW
;

339 
tmp
.
¡_dev
 = 
	`Ãw_’code_dev
(
¡©
->
dev
);

340 
tmp
.
¡_rdev
 = 
	`Ãw_’code_dev
(
¡©
->
rdev
);

342 
tmp
.
¡_dev
 = 
	`huge_’code_dev
(
¡©
->
dev
);

343 
tmp
.
¡_rdev
 = 
	`huge_’code_dev
(
¡©
->
rdev
);

345 
tmp
.
¡_šo
 = 
¡©
->
šo
;

346 ià((
tmp
.
¡_šo
è< (
¡©
->
šo
) &&mp.st_ino != stat->ino)

347  -
EOVERFLOW
;

348 #ifdeà
STAT64_HAS_BROKEN_ST_INO


349 
tmp
.
__¡_šo
 = 
¡©
->
šo
;

351 
tmp
.
¡_mode
 = 
¡©
->
mode
;

352 
tmp
.
¡_Æšk
 = 
¡©
->
Æšk
;

353 
tmp
.
¡_uid
 = 
¡©
->
uid
;

354 
tmp
.
¡_gid
 = 
¡©
->
gid
;

355 
tmp
.
¡_©ime
 = 
¡©
->
©ime
.
tv_£c
;

356 
tmp
.
¡_©ime_n£c
 = 
¡©
->
©ime
.
tv_n£c
;

357 
tmp
.
¡_mtime
 = 
¡©
->
mtime
.
tv_£c
;

358 
tmp
.
¡_mtime_n£c
 = 
¡©
->
mtime
.
tv_n£c
;

359 
tmp
.
¡_ùime
 = 
¡©
->
ùime
.
tv_£c
;

360 
tmp
.
¡_ùime_n£c
 = 
¡©
->
ùime
.
tv_n£c
;

361 
tmp
.
¡_size
 = 
¡©
->
size
;

362 
tmp
.
¡_blocks
 = 
¡©
->
blocks
;

363 
tmp
.
¡_blksize
 = 
¡©
->
blksize
;

364  
	`cİy_to_u£r
(
¡©buf
,&
tmp
,Ñmp)è? -
EFAULT
 : 0;

365 
	}
}

367 
	$SYSCALL_DEFINE2
(
¡©64
, cÚ¡ 
__u£r
 *, 
f’ame
,

368 
¡©64
 
__u£r
 *, 
¡©buf
)

370 
k¡©
 
¡©
;

371 
”rÜ
 = 
	`vfs_¡©
(
f’ame
, &
¡©
);

373 ià(!
”rÜ
)

374 
”rÜ
 = 
	`ı_Ãw_¡©64
(&
¡©
, 
¡©buf
);

376  
”rÜ
;

377 
	}
}

379 
	$SYSCALL_DEFINE2
(
l¡©64
, cÚ¡ 
__u£r
 *, 
f’ame
,

380 
¡©64
 
__u£r
 *, 
¡©buf
)

382 
k¡©
 
¡©
;

383 
”rÜ
 = 
	`vfs_l¡©
(
f’ame
, &
¡©
);

385 ià(!
”rÜ
)

386 
”rÜ
 = 
	`ı_Ãw_¡©64
(&
¡©
, 
¡©buf
);

388  
”rÜ
;

389 
	}
}

391 
	$SYSCALL_DEFINE2
(
f¡©64
, , 
fd
, 
¡©64
 
__u£r
 *, 
¡©buf
)

393 
k¡©
 
¡©
;

394 
”rÜ
 = 
	`vfs_f¡©
(
fd
, &
¡©
);

396 ià(!
”rÜ
)

397 
”rÜ
 = 
	`ı_Ãw_¡©64
(&
¡©
, 
¡©buf
);

399  
”rÜ
;

400 
	}
}

402 
	$SYSCALL_DEFINE4
(
f¡©©64
, , 
dfd
, cÚ¡ 
__u£r
 *, 
f’ame
,

403 
¡©64
 
__u£r
 *, 
¡©buf
, , 
æag
)

405 
k¡©
 
¡©
;

406 
”rÜ
;

408 
”rÜ
 = 
	`vfs_f¡©©
(
dfd
, 
f’ame
, &
¡©
, 
æag
);

409 ià(
”rÜ
)

410  
”rÜ
;

411  
	`ı_Ãw_¡©64
(&
¡©
, 
¡©buf
);

412 
	}
}

416 
	$__šode_add_by‹s
(
šode
 *šode, 
loff_t
 
by‹s
)

418 
šode
->
i_blocks
 +ğ
by‹s
 >> 9;

419 
by‹s
 &= 511;

420 
šode
->
i_by‹s
 +ğ
by‹s
;

421 ià(
šode
->
i_by‹s
 >= 512) {

422 
šode
->
i_blocks
++;

423 
šode
->
i_by‹s
 -= 512;

425 
	}
}

427 
	$šode_add_by‹s
(
šode
 *šode, 
loff_t
 
by‹s
)

429 
	`¥š_lock
(&
šode
->
i_lock
);

430 
	`__šode_add_by‹s
(
šode
, 
by‹s
);

431 
	`¥š_uÆock
(&
šode
->
i_lock
);

432 
	}
}

434 
EXPORT_SYMBOL
(
šode_add_by‹s
);

436 
	$šode_sub_by‹s
(
šode
 *šode, 
loff_t
 
by‹s
)

438 
	`¥š_lock
(&
šode
->
i_lock
);

439 
šode
->
i_blocks
 -ğ
by‹s
 >> 9;

440 
by‹s
 &= 511;

441 ià(
šode
->
i_by‹s
 < 
by‹s
) {

442 
šode
->
i_blocks
--;

443 
šode
->
i_by‹s
 += 512;

445 
šode
->
i_by‹s
 -ğ
by‹s
;

446 
	`¥š_uÆock
(&
šode
->
i_lock
);

447 
	}
}

449 
EXPORT_SYMBOL
(
šode_sub_by‹s
);

451 
loff_t
 
	$šode_g‘_by‹s
(
šode
 *inode)

453 
loff_t
 
»t
;

455 
	`¥š_lock
(&
šode
->
i_lock
);

456 
»t
 = (((
loff_t
)
šode
->
i_blocks
è<< 9è+ inode->
i_by‹s
;

457 
	`¥š_uÆock
(&
šode
->
i_lock
);

458  
»t
;

459 
	}
}

461 
EXPORT_SYMBOL
(
šode_g‘_by‹s
);

463 
	$šode_£t_by‹s
(
šode
 *šode, 
loff_t
 
by‹s
)

467 
šode
->
i_blocks
 = 
by‹s
 >> 9;

468 
šode
->
i_by‹s
 = 
by‹s
 & 511;

469 
	}
}

471 
EXPORT_SYMBOL
(
šode_£t_by‹s
);

	@statfs.c

1 
	~<lšux/sysÿÎs.h
>

2 
	~<lšux/moduË.h
>

3 
	~<lšux/fs.h
>

4 
	~<lšux/fe.h
>

5 
	~<lšux/mouÁ.h
>

6 
	~<lšux/Çmei.h
>

7 
	~<lšux/¡©fs.h
>

8 
	~<lšux/£cur™y.h
>

9 
	~<lšux/uacûss.h
>

11 
	$æags_by_mÁ
(
mÁ_æags
)

13 
æags
 = 0;

15 ià(
mÁ_æags
 & 
MNT_READONLY
)

16 
æags
 |ğ
ST_RDONLY
;

17 ià(
mÁ_æags
 & 
MNT_NOSUID
)

18 
æags
 |ğ
ST_NOSUID
;

19 ià(
mÁ_æags
 & 
MNT_NODEV
)

20 
æags
 |ğ
ST_NODEV
;

21 ià(
mÁ_æags
 & 
MNT_NOEXEC
)

22 
æags
 |ğ
ST_NOEXEC
;

23 ià(
mÁ_æags
 & 
MNT_NOATIME
)

24 
æags
 |ğ
ST_NOATIME
;

25 ià(
mÁ_æags
 & 
MNT_NODIRATIME
)

26 
æags
 |ğ
ST_NODIRATIME
;

27 ià(
mÁ_æags
 & 
MNT_RELATIME
)

28 
æags
 |ğ
ST_RELATIME
;

29  
æags
;

30 
	}
}

32 
	$æags_by_sb
(
s_æags
)

34 
æags
 = 0;

35 ià(
s_æags
 & 
MS_SYNCHRONOUS
)

36 
æags
 |ğ
ST_SYNCHRONOUS
;

37 ià(
s_æags
 & 
MS_MANDLOCK
)

38 
æags
 |ğ
ST_MANDLOCK
;

39  
æags
;

40 
	}
}

42 
	$ÿlcuÏ‹_f_æags
(
vfsmouÁ
 *
mÁ
)

44  
ST_VALID
 | 
	`æags_by_mÁ
(
mÁ
->
mÁ_æags
) |

45 
	`æags_by_sb
(
mÁ
->
mÁ_sb
->
s_æags
);

46 
	}
}

48 
	$¡©fs_by_d’Œy
(
d’Œy
 *d’Œy, 
k¡©fs
 *
buf
)

50 
»tv®
;

52 ià(!
d’Œy
->
d_sb
->
s_İ
->
¡©fs
)

53  -
ENOSYS
;

55 
	`mem£t
(
buf
, 0, (*buf));

56 
»tv®
 = 
	`£cur™y_sb_¡©fs
(
d’Œy
);

57 ià(
»tv®
)

58  
»tv®
;

59 
»tv®
 = 
d’Œy
->
d_sb
->
s_İ
->
	`¡©fs
(d’Œy, 
buf
);

60 ià(
»tv®
 =ğ0 && 
buf
->
f_äsize
 == 0)

61 
buf
->
f_äsize
 = buf->
f_bsize
;

62  
»tv®
;

63 
	}
}

65 
	$vfs_¡©fs
(
·th
 *·th, 
k¡©fs
 *
buf
)

67 
”rÜ
;

69 
”rÜ
 = 
	`¡©fs_by_d’Œy
(
·th
->
d’Œy
, 
buf
);

70 ià(!
”rÜ
)

71 
buf
->
f_æags
 = 
	`ÿlcuÏ‹_f_æags
(
·th
->
mÁ
);

72  
”rÜ
;

73 
	}
}

74 
EXPORT_SYMBOL
(
vfs_¡©fs
);

76 
	$u£r_¡©fs
(cÚ¡ 
__u£r
 *
·thÇme
, 
k¡©fs
 *
¡
)

78 
·th
…ath;

79 
”rÜ
 = 
	`u£r_·th_©
(
AT_FDCWD
, 
·thÇme
, 
LOOKUP_FOLLOW
|
LOOKUP_AUTOMOUNT
, &
·th
);

80 ià(!
”rÜ
) {

81 
”rÜ
 = 
	`vfs_¡©fs
(&
·th
, 
¡
);

82 
	`·th_put
(&
·th
);

84  
”rÜ
;

85 
	}
}

87 
	$fd_¡©fs
(
fd
, 
k¡©fs
 *
¡
)

89 
fe
 *fğ
	`fg‘
(
fd
);

90 
”rÜ
 = -
EBADF
;

91 ià(
fe
) {

92 
”rÜ
 = 
	`vfs_¡©fs
(&
fe
->
f_·th
, 
¡
);

93 
	`åut
(
fe
);

95  
”rÜ
;

96 
	}
}

98 
	$do_¡©fs_Çtive
(
k¡©fs
 *
¡
, 
¡©fs
 
__u£r
 *
p
)

100 
¡©fs
 
buf
;

102 ià((
buf
è=ğ(*
¡
))

103 
	`memıy
(&
buf
, 
¡
, (*st));

105 ià( 
buf
.
f_blocks
 == 4) {

106 ià((
¡
->
f_blocks
 | st->
f_bä“
 | st->
f_bava
 |

107 
¡
->
f_bsize
 | st->
f_äsize
) &

109  -
EOVERFLOW
;

114 ià(
¡
->
f_fes
 != -1 &&

115 (
¡
->
f_fes
 & 0xffffffff00000000ULL))

116  -
EOVERFLOW
;

117 ià(
¡
->
f_fä“
 != -1 &&

118 (
¡
->
f_fä“
 & 0xffffffff00000000ULL))

119  -
EOVERFLOW
;

122 
buf
.
f_ty³
 = 
¡
->f_type;

123 
buf
.
f_bsize
 = 
¡
->f_bsize;

124 
buf
.
f_blocks
 = 
¡
->f_blocks;

125 
buf
.
f_bä“
 = 
¡
->f_bfree;

126 
buf
.
f_bava
 = 
¡
->f_bavail;

127 
buf
.
f_fes
 = 
¡
->f_files;

128 
buf
.
f_fä“
 = 
¡
->f_ffree;

129 
buf
.
f_fsid
 = 
¡
->f_fsid;

130 
buf
.
f_Çm–’
 = 
¡
->f_namelen;

131 
buf
.
f_äsize
 = 
¡
->f_frsize;

132 
buf
.
f_æags
 = 
¡
->f_flags;

133 
	`mem£t
(
buf
.
f_¥¬e
, 0, (buf.f_spare));

135 ià(
	`cİy_to_u£r
(
p
, &
buf
, (buf)))

136  -
EFAULT
;

138 
	}
}

140 
	$do_¡©fs64
(
k¡©fs
 *
¡
, 
¡©fs64
 
__u£r
 *
p
)

142 
¡©fs64
 
buf
;

143 ià((
buf
è=ğ(*
¡
))

144 
	`memıy
(&
buf
, 
¡
, (*st));

146 
buf
.
f_ty³
 = 
¡
->f_type;

147 
buf
.
f_bsize
 = 
¡
->f_bsize;

148 
buf
.
f_blocks
 = 
¡
->f_blocks;

149 
buf
.
f_bä“
 = 
¡
->f_bfree;

150 
buf
.
f_bava
 = 
¡
->f_bavail;

151 
buf
.
f_fes
 = 
¡
->f_files;

152 
buf
.
f_fä“
 = 
¡
->f_ffree;

153 
buf
.
f_fsid
 = 
¡
->f_fsid;

154 
buf
.
f_Çm–’
 = 
¡
->f_namelen;

155 
buf
.
f_äsize
 = 
¡
->f_frsize;

156 
buf
.
f_æags
 = 
¡
->f_flags;

157 
	`mem£t
(
buf
.
f_¥¬e
, 0, (buf.f_spare));

159 ià(
	`cİy_to_u£r
(
p
, &
buf
, (buf)))

160  -
EFAULT
;

162 
	}
}

164 
	$SYSCALL_DEFINE2
(
¡©fs
, cÚ¡ 
__u£r
 *, 
·thÇme
, ¡©f __u£¸*, 
buf
)

166 
k¡©fs
 
¡
;

167 
”rÜ
 = 
	`u£r_¡©fs
(
·thÇme
, &
¡
);

168 ià(!
”rÜ
)

169 
”rÜ
 = 
	`do_¡©fs_Çtive
(&
¡
, 
buf
);

170  
”rÜ
;

171 
	}
}

173 
	$SYSCALL_DEFINE3
(
¡©fs64
, cÚ¡ 
__u£r
 *, 
·thÇme
, 
size_t
, 
sz
, ¡©fs64 __u£¸*, 
buf
)

175 
k¡©fs
 
¡
;

176 
”rÜ
;

177 ià(
sz
 !ğ(*
buf
))

178  -
EINVAL
;

179 
”rÜ
 = 
	`u£r_¡©fs
(
·thÇme
, &
¡
);

180 ià(!
”rÜ
)

181 
”rÜ
 = 
	`do_¡©fs64
(&
¡
, 
buf
);

182  
”rÜ
;

183 
	}
}

185 
	$SYSCALL_DEFINE2
(
f¡©fs
, , 
fd
, 
¡©fs
 
__u£r
 *, 
buf
)

187 
k¡©fs
 
¡
;

188 
”rÜ
 = 
	`fd_¡©fs
(
fd
, &
¡
);

189 ià(!
”rÜ
)

190 
”rÜ
 = 
	`do_¡©fs_Çtive
(&
¡
, 
buf
);

191  
”rÜ
;

192 
	}
}

194 
	$SYSCALL_DEFINE3
(
f¡©fs64
, , 
fd
, 
size_t
, 
sz
, 
¡©fs64
 
__u£r
 *, 
buf
)

196 
k¡©fs
 
¡
;

197 
”rÜ
;

199 ià(
sz
 !ğ(*
buf
))

200  -
EINVAL
;

202 
”rÜ
 = 
	`fd_¡©fs
(
fd
, &
¡
);

203 ià(!
”rÜ
)

204 
”rÜ
 = 
	`do_¡©fs64
(&
¡
, 
buf
);

205  
”rÜ
;

206 
	}
}

208 
	$SYSCALL_DEFINE2
(
u¡©
, , 
dev
, u¡© 
__u£r
 *, 
ubuf
)

210 
su³r_block
 *
s
;

211 
u¡©
 
tmp
;

212 
k¡©fs
 
sbuf
;

213 
”r
;

215 
s
 = 
	`u£r_g‘_su³r
(
	`Ãw_decode_dev
(
dev
));

216 ià(!
s
)

217  -
EINVAL
;

219 
”r
 = 
	`¡©fs_by_d’Œy
(
s
->
s_roÙ
, &
sbuf
);

220 
	`drİ_su³r
(
s
);

221 ià(
”r
)

222  
”r
;

224 
	`mem£t
(&
tmp
,0,(
u¡©
));

225 
tmp
.
f_tä“
 = 
sbuf
.
f_bä“
;

226 
tmp
.
f_tšode
 = 
sbuf
.
f_fä“
;

228  
	`cİy_to_u£r
(
ubuf
, &
tmp
, (
u¡©
)è? -
EFAULT
 : 0;

229 
	}
}

	@super.c

23 
	~<lšux/moduË.h
>

24 
	~<lšux/¦ab.h
>

25 
	~<lšux/acù.h
>

26 
	~<lšux/blkdev.h
>

27 
	~<lšux/mouÁ.h
>

28 
	~<lšux/£cur™y.h
>

29 
	~<lšux/wr™eback.h
>

30 
	~<lšux/idr.h
>

31 
	~<lšux/mu‹x.h
>

32 
	~<lšux/backšg-dev.h
>

33 
	~<lšux/rculi¡_bl.h
>

34 
	~<lšux/ş—nÿche.h
>

35 
	~"š‹º®.h
"

38 
LIST_HEAD
(
su³r_blocks
);

39 
DEFINE_SPINLOCK
(
sb_lock
);

48 
	$´uÃ_su³r
(
shršk”
 *
shršk
, 
shršk_cÚŒŞ
 *
sc
)

50 
su³r_block
 *
sb
;

51 
fs_objeùs
 = 0;

52 
tÙ®_objeùs
;

54 
sb
 = 
	`cÚš”_of
(
shršk
, 
su³r_block
, 
s_shršk
);

60 ià(
sc
->
Ä_to_sÿn
 && !(sc->
gå_mask
 & 
__GFP_FS
))

63 ià(!
	`g¿b_su³r_·ssive
(
sb
))

64  !
sc
->
Ä_to_sÿn
 ? 0 : -1;

66 ià(
sb
->
s_İ
 && sb->s_İ->
Ä_ÿched_objeùs
)

67 
fs_objeùs
 = 
sb
->
s_İ
->
	`Ä_ÿched_objeùs
(sb);

69 
tÙ®_objeùs
 = 
sb
->
s_Ä_d’Œy_unu£d
 +

70 
sb
->
s_Ä_šodes_unu£d
 + 
fs_objeùs
 + 1;

72 ià(
sc
->
Ä_to_sÿn
) {

73 
d’Œ›s
;

74 
šodes
;

77 
d’Œ›s
 = (
sc
->
Ä_to_sÿn
 * 
sb
->
s_Ä_d’Œy_unu£d
) /

78 
tÙ®_objeùs
;

79 
šodes
 = (
sc
->
Ä_to_sÿn
 * 
sb
->
s_Ä_šodes_unu£d
) /

80 
tÙ®_objeùs
;

81 ià(
fs_objeùs
)

82 
fs_objeùs
 = (
sc
->
Ä_to_sÿn
 * fs_objects) /

83 
tÙ®_objeùs
;

88 
	`´uÃ_dÿche_sb
(
sb
, 
d’Œ›s
);

89 
	`´uÃ_iÿche_sb
(
sb
, 
šodes
);

91 ià(
fs_objeùs
 && 
sb
->
s_İ
->
ä“_ÿched_objeùs
) {

92 
sb
->
s_İ
->
	`ä“_ÿched_objeùs
(sb, 
fs_objeùs
);

93 
fs_objeùs
 = 
sb
->
s_İ
->
	`Ä_ÿched_objeùs
(sb);

95 
tÙ®_objeùs
 = 
sb
->
s_Ä_d’Œy_unu£d
 +

96 
sb
->
s_Ä_šodes_unu£d
 + 
fs_objeùs
;

99 
tÙ®_objeùs
 = (tÙ®_objeù / 100è* 
sysùl_vfs_ÿche_´essu»
;

100 
	`drİ_su³r
(
sb
);

101  
tÙ®_objeùs
;

102 
	}
}

111 
su³r_block
 *
	$®loc_su³r
(
fe_sy¡em_ty³
 *
ty³
)

113 
su³r_block
 *
s
 = 
	`kz®loc
((su³r_block), 
GFP_USER
);

114 cÚ¡ 
su³r_İ”©iÚs
 
deçuÉ_İ
;

116 ià(
s
) {

117 ià(
	`£cur™y_sb_®loc
(
s
)) {

118 
	`kä“
(
s
);

119 
s
 = 
NULL
;

120 
out
;

122 #ifdeà
CONFIG_SMP


123 
s
->
s_fes
 = 
	`®loc_³rıu
(
li¡_h—d
);

124 ià(!
s
->
s_fes
) {

125 
	`£cur™y_sb_ä“
(
s
);

126 
	`kä“
(
s
);

127 
s
 = 
NULL
;

128 
out
;

130 
i
;

132 
	`fÜ_—ch_possibË_ıu
(
i
)

133 
	`INIT_LIST_HEAD
(
	`³r_ıu_±r
(
s
->
s_fes
, 
i
));

136 
	`INIT_LIST_HEAD
(&
s
->
s_fes
);

138 
s
->
s_bdi
 = &
deçuÉ_backšg_dev_šfo
;

139 
	`INIT_LIST_HEAD
(&
s
->
s_š¡ªûs
);

140 
	`INIT_HLIST_BL_HEAD
(&
s
->
s_ªÚ
);

141 
	`INIT_LIST_HEAD
(&
s
->
s_šodes
);

142 
	`INIT_LIST_HEAD
(&
s
->
s_d’Œy_Ìu
);

143 
	`INIT_LIST_HEAD
(&
s
->
s_šode_Ìu
);

144 
	`¥š_lock_š™
(&
s
->
s_šode_Ìu_lock
);

145 
	`š™_rw£m
(&
s
->
s_umouÁ
);

146 
	`mu‹x_š™
(&
s
->
s_lock
);

147 
	`lockd•_£t_şass
(&
s
->
s_umouÁ
, &
ty³
->
s_umouÁ_key
);

153 
	`lockd•_£t_şass
(&
s
->
s_lock
, &
ty³
->
s_lock_key
);

169 
	`down_wr™e_Ã¡ed
(&
s
->
s_umouÁ
, 
SINGLE_DEPTH_NESTING
);

170 
s
->
s_couÁ
 = 1;

171 
	`©omic_£t
(&
s
->
s_aùive
, 1);

172 
	`mu‹x_š™
(&
s
->
s_vfs_»Çme_mu‹x
);

173 
	`lockd•_£t_şass
(&
s
->
s_vfs_»Çme_mu‹x
, &
ty³
->
s_vfs_»Çme_key
);

174 
	`mu‹x_š™
(&
s
->
s_dquÙ
.
dqio_mu‹x
);

175 
	`mu‹x_š™
(&
s
->
s_dquÙ
.
dqÚoff_mu‹x
);

176 
	`š™_rw£m
(&
s
->
s_dquÙ
.
dq±r_£m
);

177 
	`š™_wa™queue_h—d
(&
s
->
s_wa™_unäoz’
);

178 
s
->
s_maxby‹s
 = 
MAX_NON_LFS
;

179 
s
->
s_İ
 = &
deçuÉ_İ
;

180 
s
->
s_time_g¿n
 = 1000000000;

181 
s
->
ş—nÿche_poŞid
 = -1;

183 
s
->
s_shršk
.
£eks
 = 
DEFAULT_SEEKS
;

184 
s
->
s_shršk
.
shršk
 = 
´uÃ_su³r
;

185 
s
->
s_shršk
.
b©ch
 = 1024;

187 
out
:

188  
s
;

189 
	}
}

197 
šlše
 
	$de¡roy_su³r
(
su³r_block
 *
s
)

199 #ifdeà
CONFIG_SMP


200 
	`ä“_³rıu
(
s
->
s_fes
);

202 
	`£cur™y_sb_ä“
(
s
);

203 
	`kä“
(
s
->
s_subty³
);

204 
	`kä“
(
s
->
s_İtiÚs
);

205 
	`kä“
(
s
);

206 
	}
}

213 
	$__put_su³r
(
su³r_block
 *
sb
)

215 ià(!--
sb
->
s_couÁ
) {

216 
	`li¡_d–_š™
(&
sb
->
s_li¡
);

217 
	`de¡roy_su³r
(
sb
);

219 
	}
}

228 
	$put_su³r
(
su³r_block
 *
sb
)

230 
	`¥š_lock
(&
sb_lock
);

231 
	`__put_su³r
(
sb
);

232 
	`¥š_uÆock
(&
sb_lock
);

233 
	}
}

247 
	$d—ùiv©e_locked_su³r
(
su³r_block
 *
s
)

249 
fe_sy¡em_ty³
 *
fs
 = 
s
->
s_ty³
;

250 ià(
	`©omic_dec_ªd_‹¡
(&
s
->
s_aùive
)) {

251 
	`ş—nÿche_æush_fs
(
s
);

252 
fs
->
	`kl_sb
(
s
);

255 
	`uÄegi¡”_shršk”
(&
s
->
s_shršk
);

261 
	`rcu_b¬r›r
();

262 
	`put_fesy¡em
(
fs
);

263 
	`put_su³r
(
s
);

265 
	`up_wr™e
(&
s
->
s_umouÁ
);

267 
	}
}

269 
EXPORT_SYMBOL
(
d—ùiv©e_locked_su³r
);

279 
	$d—ùiv©e_su³r
(
su³r_block
 *
s
)

281 ià(!
	`©omic_add_uÆess
(&
s
->
s_aùive
, -1, 1)) {

282 
	`down_wr™e
(&
s
->
s_umouÁ
);

283 
	`d—ùiv©e_locked_su³r
(
s
);

285 
	}
}

287 
EXPORT_SYMBOL
(
d—ùiv©e_su³r
);

300 
	$g¿b_su³r
(
su³r_block
 *
s
è
	$__»Ëa£s
(
sb_lock
)

302 ià(
	`©omic_šc_nÙ_z”o
(&
s
->
s_aùive
)) {

303 
	`¥š_uÆock
(&
sb_lock
);

307 
s
->
s_couÁ
++;

308 
	`¥š_uÆock
(&
sb_lock
);

310 
	`down_wr™e
(&
s
->
s_umouÁ
);

311 
	`up_wr™e
(&
s
->
s_umouÁ
);

312 
	`put_su³r
(
s
);

314 
	}
}

328 
boŞ
 
	$g¿b_su³r_·ssive
(
su³r_block
 *
sb
)

330 
	`¥š_lock
(&
sb_lock
);

331 ià(
	`li¡_em±y
(&
sb
->
s_š¡ªûs
)) {

332 
	`¥š_uÆock
(&
sb_lock
);

333  
çl£
;

336 
sb
->
s_couÁ
++;

337 
	`¥š_uÆock
(&
sb_lock
);

339 ià(
	`down_»ad_Œylock
(&
sb
->
s_umouÁ
)) {

340 ià(
sb
->
s_roÙ
)

341  
Œue
;

342 
	`up_»ad
(&
sb
->
s_umouÁ
);

345 
	`put_su³r
(
sb
);

346  
çl£
;

347 
	}
}

352 
	$lock_su³r
(
su³r_block
 * 
sb
)

354 
	`mu‹x_lock
(&
sb
->
s_lock
);

355 
	}
}

357 
	$uÆock_su³r
(
su³r_block
 * 
sb
)

359 
	`mu‹x_uÆock
(&
sb
->
s_lock
);

360 
	}
}

362 
EXPORT_SYMBOL
(
lock_su³r
);

363 
EXPORT_SYMBOL
(
uÆock_su³r
);

379 
	$g’”ic_shutdown_su³r
(
su³r_block
 *
sb
)

381 cÚ¡ 
su³r_İ”©iÚs
 *
sİ
 = 
sb
->
s_İ
;

383 ià(
sb
->
s_roÙ
) {

384 
	`shršk_dÿche_fÜ_umouÁ
(
sb
);

385 
	`sync_fesy¡em
(
sb
);

386 
sb
->
s_æags
 &ğ~
MS_ACTIVE
;

388 
	`f¢Ùify_unmouÁ_šodes
(&
sb
->
s_šodes
);

390 
	`eviù_šodes
(
sb
);

392 ià(
sİ
->
put_su³r
)

393 
sİ
->
	`put_su³r
(
sb
);

395 ià(!
	`li¡_em±y
(&
sb
->
s_šodes
)) {

396 
	`´štk
("VFS: Busy inodes‡fter unmount of %s. "

398 
sb
->
s_id
);

401 
	`¥š_lock
(&
sb_lock
);

403 
	`li¡_d–_š™
(&
sb
->
s_š¡ªûs
);

404 
	`¥š_uÆock
(&
sb_lock
);

405 
	`up_wr™e
(&
sb
->
s_umouÁ
);

406 
	}
}

408 
EXPORT_SYMBOL
(
g’”ic_shutdown_su³r
);

417 
su³r_block
 *
sg‘
(
fe_sy¡em_ty³
 *
ty³
,

418 (*
‹¡
)(
su³r_block
 *,*),

419 (*
£t
)(
su³r_block
 *,*),

420 *
d©a
)

422 
su³r_block
 *
s
 = 
NULL
;

423 
su³r_block
 *
Şd
;

424 
”r
;

426 
»Œy
:

427 
	`¥š_lock
(&
sb_lock
);

428 ià(
‹¡
) {

429 
	`li¡_fÜ_—ch_’Œy
(
Şd
, &
ty³
->
fs_su³rs
, 
s_š¡ªûs
) {

430 ià(!
	`‹¡
(
Şd
, 
d©a
))

432 ià(!
	`g¿b_su³r
(
Şd
))

433 
»Œy
;

434 ià(
s
) {

435 
	`up_wr™e
(&
s
->
s_umouÁ
);

436 
	`de¡roy_su³r
(
s
);

437 
s
 = 
NULL
;

439 
	`down_wr™e
(&
Şd
->
s_umouÁ
);

440 ià(
	`uÆik–y
(!(
Şd
->
s_æags
 & 
MS_BORN
))) {

441 
	`d—ùiv©e_locked_su³r
(
Şd
);

442 
»Œy
;

444  
Şd
;

447 ià(!
s
) {

448 
	`¥š_uÆock
(&
sb_lock
);

449 
s
 = 
	`®loc_su³r
(
ty³
);

450 ià(!
s
)

451  
	`ERR_PTR
(-
ENOMEM
);

452 
»Œy
;

455 
”r
 = 
	`£t
(
s
, 
d©a
);

456 ià(
”r
) {

457 
	`¥š_uÆock
(&
sb_lock
);

458 
	`up_wr™e
(&
s
->
s_umouÁ
);

459 
	`de¡roy_su³r
(
s
);

460  
	`ERR_PTR
(
”r
);

462 
s
->
s_ty³
 = 
ty³
;

463 
	`¡¾ıy
(
s
->
s_id
, 
ty³
->
Çme
, (s->s_id));

464 
	`li¡_add_
(&
s
->
s_li¡
, &
su³r_blocks
);

465 
	`li¡_add
(&
s
->
s_š¡ªûs
, &
ty³
->
fs_su³rs
);

466 
	`¥š_uÆock
(&
sb_lock
);

467 
	`g‘_fesy¡em
(
ty³
);

468 
	`»gi¡”_shršk”
(&
s
->
s_shršk
);

469  
s
;

470 
	}
}

472 
EXPORT_SYMBOL
(
sg‘
);

474 
	$drİ_su³r
(
su³r_block
 *
sb
)

476 
	`up_»ad
(&
sb
->
s_umouÁ
);

477 
	`put_su³r
(
sb
);

478 
	}
}

480 
EXPORT_SYMBOL
(
drİ_su³r
);

494 
	$sync_su³rs
()

496 
su³r_block
 *
sb
, *
p
 = 
NULL
;

498 
	`¥š_lock
(&
sb_lock
);

499 
	`li¡_fÜ_—ch_’Œy
(
sb
, &
su³r_blocks
, 
s_li¡
) {

500 ià(
	`li¡_em±y
(&
sb
->
s_š¡ªûs
))

502 ià(
sb
->
s_İ
->
wr™e_su³r
 && sb->
s_dœt
) {

503 
sb
->
s_couÁ
++;

504 
	`¥š_uÆock
(&
sb_lock
);

506 
	`down_»ad
(&
sb
->
s_umouÁ
);

507 ià(
sb
->
s_roÙ
 && sb->
s_dœt
)

508 
sb
->
s_İ
->
	`wr™e_su³r
(sb);

509 
	`up_»ad
(&
sb
->
s_umouÁ
);

511 
	`¥š_lock
(&
sb_lock
);

512 ià(
p
)

513 
	`__put_su³r
(
p
);

514 
p
 = 
sb
;

517 ià(
p
)

518 
	`__put_su³r
(
p
);

519 
	`¥š_uÆock
(&
sb_lock
);

520 
	}
}

530 
™”©e_su³rs
((*
f
)(
su³r_block
 *, *), *
¬g
)

532 
su³r_block
 *
sb
, *
p
 = 
NULL
;

534 
	`¥š_lock
(&
sb_lock
);

535 
	`li¡_fÜ_—ch_’Œy
(
sb
, &
su³r_blocks
, 
s_li¡
) {

536 ià(
	`li¡_em±y
(&
sb
->
s_š¡ªûs
))

538 
sb
->
s_couÁ
++;

539 
	`¥š_uÆock
(&
sb_lock
);

541 
	`down_»ad
(&
sb
->
s_umouÁ
);

542 ià(
sb
->
s_roÙ
)

543 
	`f
(
sb
, 
¬g
);

544 
	`up_»ad
(&
sb
->
s_umouÁ
);

546 
	`¥š_lock
(&
sb_lock
);

547 ià(
p
)

548 
	`__put_su³r
(
p
);

549 
p
 = 
sb
;

551 ià(
p
)

552 
	`__put_su³r
(
p
);

553 
	`¥š_uÆock
(&
sb_lock
);

554 
	}
}

565 
™”©e_su³rs_ty³
(
fe_sy¡em_ty³
 *
ty³
,

566 (*
f
)(
su³r_block
 *, *), *
¬g
)

568 
su³r_block
 *
sb
, *
p
 = 
NULL
;

570 
	`¥š_lock
(&
sb_lock
);

571 
	`li¡_fÜ_—ch_’Œy
(
sb
, &
ty³
->
fs_su³rs
, 
s_š¡ªûs
) {

572 
sb
->
s_couÁ
++;

573 
	`¥š_uÆock
(&
sb_lock
);

575 
	`down_»ad
(&
sb
->
s_umouÁ
);

576 ià(
sb
->
s_roÙ
)

577 
	`f
(
sb
, 
¬g
);

578 
	`up_»ad
(&
sb
->
s_umouÁ
);

580 
	`¥š_lock
(&
sb_lock
);

581 ià(
p
)

582 
	`__put_su³r
(
p
);

583 
p
 = 
sb
;

585 ià(
p
)

586 
	`__put_su³r
(
p
);

587 
	`¥š_uÆock
(&
sb_lock
);

588 
	}
}

590 
EXPORT_SYMBOL
(
™”©e_su³rs_ty³
);

600 
su³r_block
 *
	$g‘_su³r
(
block_deviû
 *
bdev
)

602 
su³r_block
 *
sb
;

604 ià(!
bdev
)

605  
NULL
;

607 
	`¥š_lock
(&
sb_lock
);

608 
»sÿn
:

609 
	`li¡_fÜ_—ch_’Œy
(
sb
, &
su³r_blocks
, 
s_li¡
) {

610 ià(
	`li¡_em±y
(&
sb
->
s_š¡ªûs
))

612 ià(
sb
->
s_bdev
 =ğ
bdev
) {

613 
sb
->
s_couÁ
++;

614 
	`¥š_uÆock
(&
sb_lock
);

615 
	`down_»ad
(&
sb
->
s_umouÁ
);

617 ià(
sb
->
s_roÙ
)

618  
sb
;

619 
	`up_»ad
(&
sb
->
s_umouÁ
);

621 
	`¥š_lock
(&
sb_lock
);

622 
	`__put_su³r
(
sb
);

623 
»sÿn
;

626 
	`¥š_uÆock
(&
sb_lock
);

627  
NULL
;

628 
	}
}

630 
EXPORT_SYMBOL
(
g‘_su³r
);

640 
su³r_block
 *
	$g‘_aùive_su³r
(
block_deviû
 *
bdev
)

642 
su³r_block
 *
sb
;

644 ià(!
bdev
)

645  
NULL
;

647 
»¡¬t
:

648 
	`¥š_lock
(&
sb_lock
);

649 
	`li¡_fÜ_—ch_’Œy
(
sb
, &
su³r_blocks
, 
s_li¡
) {

650 ià(
	`li¡_em±y
(&
sb
->
s_š¡ªûs
))

652 ià(
sb
->
s_bdev
 =ğ
bdev
) {

653 ià(
	`g¿b_su³r
(
sb
))

654  
sb
;

656 
»¡¬t
;

659 
	`¥š_uÆock
(&
sb_lock
);

660  
NULL
;

661 
	}
}

663 
su³r_block
 *
	$u£r_g‘_su³r
(
dev_t
 
dev
)

665 
su³r_block
 *
sb
;

667 
	`¥š_lock
(&
sb_lock
);

668 
»sÿn
:

669 
	`li¡_fÜ_—ch_’Œy
(
sb
, &
su³r_blocks
, 
s_li¡
) {

670 ià(
	`li¡_em±y
(&
sb
->
s_š¡ªûs
))

672 ià(
sb
->
s_dev
 =ğ
dev
) {

673 
sb
->
s_couÁ
++;

674 
	`¥š_uÆock
(&
sb_lock
);

675 
	`down_»ad
(&
sb
->
s_umouÁ
);

677 ià(
sb
->
s_roÙ
)

678  
sb
;

679 
	`up_»ad
(&
sb
->
s_umouÁ
);

681 
	`¥š_lock
(&
sb_lock
);

682 
	`__put_su³r
(
sb
);

683 
»sÿn
;

686 
	`¥š_uÆock
(&
sb_lock
);

687  
NULL
;

688 
	}
}

699 
	$do_»mouÁ_sb
(
su³r_block
 *
sb
, 
æags
, *
d©a
, 
fÜû
)

701 
»tv®
;

702 
»mouÁ_ro
;

704 ià(
sb
->
s_äoz’
 !ğ
SB_UNFROZEN
)

705  -
EBUSY
;

707 #ifdeà
CONFIG_BLOCK


708 ià(!(
æags
 & 
MS_RDONLY
è&& 
	`bdev_»ad_Úly
(
sb
->
s_bdev
))

709  -
EACCES
;

712 ià(
æags
 & 
MS_RDONLY
)

713 
	`acù_auto_şo£
(
sb
);

714 
	`shršk_dÿche_sb
(
sb
);

715 
	`sync_fesy¡em
(
sb
);

717 
»mouÁ_ro
 = (
æags
 & 
MS_RDONLY
è&& !(
sb
->
s_æags
 & MS_RDONLY);

721 ià(
»mouÁ_ro
) {

722 ià(
fÜû
)

723 
	`m¬k_fes_ro
(
sb
);

724 ià(!
	`fs_may_»mouÁ_ro
(
sb
))

725  -
EBUSY
;

728 ià(
sb
->
s_İ
->
»mouÁ_fs
) {

729 
»tv®
 = 
sb
->
s_İ
->
	`»mouÁ_fs
(sb, &
æags
, 
d©a
);

730 ià(
»tv®
) {

731 ià(!
fÜû
)

732  
»tv®
;

734 
	`WARN
(1, "forced„emount of‡ %s fs„eturned %i\n",

735 
sb
->
s_ty³
->
Çme
, 
»tv®
);

738 
sb
->
s_æags
 = (sb->s_æag & ~
MS_RMT_MASK
è| (
æags
 & MS_RMT_MASK);

748 ià(
»mouÁ_ro
 && 
sb
->
s_bdev
)

749 
	`šv®id©e_bdev
(
sb
->
s_bdev
);

751 
	}
}

753 
	$do_em”g’cy_»mouÁ
(
wÜk_¡ruù
 *
wÜk
)

755 
su³r_block
 *
sb
, *
p
 = 
NULL
;

757 
	`¥š_lock
(&
sb_lock
);

758 
	`li¡_fÜ_—ch_’Œy
(
sb
, &
su³r_blocks
, 
s_li¡
) {

759 ià(
	`li¡_em±y
(&
sb
->
s_š¡ªûs
))

761 
sb
->
s_couÁ
++;

762 
	`¥š_uÆock
(&
sb_lock
);

763 
	`down_wr™e
(&
sb
->
s_umouÁ
);

764 ià(
sb
->
s_roÙ
 && sb->
s_bdev
 && !(sb->
s_æags
 & 
MS_RDONLY
)) {

768 
	`do_»mouÁ_sb
(
sb
, 
MS_RDONLY
, 
NULL
, 1);

770 
	`up_wr™e
(&
sb
->
s_umouÁ
);

771 
	`¥š_lock
(&
sb_lock
);

772 ià(
p
)

773 
	`__put_su³r
(
p
);

774 
p
 = 
sb
;

776 ià(
p
)

777 
	`__put_su³r
(
p
);

778 
	`¥š_uÆock
(&
sb_lock
);

779 
	`kä“
(
wÜk
);

780 
	`´štk
("Emergency Remount complete\n");

781 
	}
}

783 
	$em”g’cy_»mouÁ
()

785 
wÜk_¡ruù
 *
wÜk
;

787 
wÜk
 = 
	`km®loc
((*wÜk), 
GFP_ATOMIC
);

788 ià(
wÜk
) {

789 
	`INIT_WORK
(
wÜk
, 
do_em”g’cy_»mouÁ
);

790 
	`scheduË_wÜk
(
wÜk
);

792 
	}
}

799 
DEFINE_IDA
(
uÂamed_dev_ida
);

800 
DEFINE_SPINLOCK
(
uÂamed_dev_lock
);

801 
	guÂamed_dev_¡¬t
 = 0;

803 
	$g‘_ªÚ_bdev
(
dev_t
 *
p
)

805 
dev
;

806 
”rÜ
;

808 
»Œy
:

809 ià(
	`ida_´e_g‘
(&
uÂamed_dev_ida
, 
GFP_ATOMIC
) == 0)

810  -
ENOMEM
;

811 
	`¥š_lock
(&
uÂamed_dev_lock
);

812 
”rÜ
 = 
	`ida_g‘_Ãw_above
(&
uÂamed_dev_ida
, 
uÂamed_dev_¡¬t
, &
dev
);

813 ià(!
”rÜ
)

814 
uÂamed_dev_¡¬t
 = 
dev
 + 1;

815 
	`¥š_uÆock
(&
uÂamed_dev_lock
);

816 ià(
”rÜ
 =ğ-
EAGAIN
)

818 
»Œy
;

819 ià(
”rÜ
)

820  -
EAGAIN
;

822 ià((
dev
 & 
MAX_ID_MASK
è=ğ(1 << 
MINORBITS
)) {

823 
	`¥š_lock
(&
uÂamed_dev_lock
);

824 
	`ida_»move
(&
uÂamed_dev_ida
, 
dev
);

825 ià(
uÂamed_dev_¡¬t
 > 
dev
)

826 
uÂamed_dev_¡¬t
 = 
dev
;

827 
	`¥š_uÆock
(&
uÂamed_dev_lock
);

828  -
EMFILE
;

830 *
p
 = 
	`MKDEV
(0, 
dev
 & 
MINORMASK
);

832 
	}
}

833 
EXPORT_SYMBOL
(
g‘_ªÚ_bdev
);

835 
	$ä“_ªÚ_bdev
(
dev_t
 
dev
)

837 
¦Ù
 = 
	`MINOR
(
dev
);

838 
	`¥š_lock
(&
uÂamed_dev_lock
);

839 
	`ida_»move
(&
uÂamed_dev_ida
, 
¦Ù
);

840 ià(
¦Ù
 < 
uÂamed_dev_¡¬t
)

841 
uÂamed_dev_¡¬t
 = 
¦Ù
;

842 
	`¥š_uÆock
(&
uÂamed_dev_lock
);

843 
	}
}

844 
EXPORT_SYMBOL
(
ä“_ªÚ_bdev
);

846 
	$£t_ªÚ_su³r
(
su³r_block
 *
s
, *
d©a
)

848 
”rÜ
 = 
	`g‘_ªÚ_bdev
(&
s
->
s_dev
);

849 ià(!
”rÜ
)

850 
s
->
s_bdi
 = &
noİ_backšg_dev_šfo
;

851  
”rÜ
;

852 
	}
}

854 
EXPORT_SYMBOL
(
£t_ªÚ_su³r
);

856 
	$kl_ªÚ_su³r
(
su³r_block
 *
sb
)

858 
dev_t
 
dev
 = 
sb
->
s_dev
;

859 
	`g’”ic_shutdown_su³r
(
sb
);

860 
	`ä“_ªÚ_bdev
(
dev
);

861 
	}
}

863 
EXPORT_SYMBOL
(
kl_ªÚ_su³r
);

865 
	$kl_l™‹r_su³r
(
su³r_block
 *
sb
)

867 ià(
sb
->
s_roÙ
)

868 
	`d_g’ocide
(
sb
->
s_roÙ
);

869 
	`kl_ªÚ_su³r
(
sb
);

870 
	}
}

872 
EXPORT_SYMBOL
(
kl_l™‹r_su³r
);

874 
	$ns_‹¡_su³r
(
su³r_block
 *
sb
, *
d©a
)

876  
sb
->
s_fs_šfo
 =ğ
d©a
;

877 
	}
}

879 
	$ns_£t_su³r
(
su³r_block
 *
sb
, *
d©a
)

881 
sb
->
s_fs_šfo
 = 
d©a
;

882  
	`£t_ªÚ_su³r
(
sb
, 
NULL
);

883 
	}
}

885 
d’Œy
 *
mouÁ_ns
(
fe_sy¡em_ty³
 *
fs_ty³
, 
æags
,

886 *
d©a
, (*
fl_su³r
)(
su³r_block
 *, *, ))

888 
su³r_block
 *
sb
;

890 
sb
 = 
	`sg‘
(
fs_ty³
, 
ns_‹¡_su³r
, 
ns_£t_su³r
, 
d©a
);

891 ià(
	`IS_ERR
(
sb
))

892  
	`ERR_CAST
(
sb
);

894 ià(!
sb
->
s_roÙ
) {

895 
”r
;

896 
sb
->
s_æags
 = 
æags
;

897 
”r
 = 
	`fl_su³r
(
sb
, 
d©a
, 
æags
 & 
MS_SILENT
 ? 1 : 0);

898 ià(
”r
) {

899 
	`d—ùiv©e_locked_su³r
(
sb
);

900  
	`ERR_PTR
(
”r
);

903 
sb
->
s_æags
 |ğ
MS_ACTIVE
;

906  
	`dg‘
(
sb
->
s_roÙ
);

907 
	}
}

909 
EXPORT_SYMBOL
(
mouÁ_ns
);

911 #ifdeà
CONFIG_BLOCK


912 
	$£t_bdev_su³r
(
su³r_block
 *
s
, *
d©a
)

914 
s
->
s_bdev
 = 
d©a
;

915 
s
->
s_dev
 = s->
s_bdev
->
bd_dev
;

921 
s
->
s_bdi
 = &
	`bdev_g‘_queue
(s->
s_bdev
)->
backšg_dev_šfo
;

923 
	}
}

925 
	$‹¡_bdev_su³r
(
su³r_block
 *
s
, *
d©a
)

927  (*)
s
->
s_bdev
 =ğ
d©a
;

928 
	}
}

930 
d’Œy
 *
mouÁ_bdev
(
fe_sy¡em_ty³
 *
fs_ty³
,

931 
æags
, cÚ¡ *
dev_Çme
, *
d©a
,

932 (*
fl_su³r
)(
su³r_block
 *, *, ))

934 
block_deviû
 *
bdev
;

935 
su³r_block
 *
s
;

936 
fmode_t
 
mode
 = 
FMODE_READ
 | 
FMODE_EXCL
;

937 
”rÜ
 = 0;

939 ià(!(
æags
 & 
MS_RDONLY
))

940 
mode
 |ğ
FMODE_WRITE
;

942 
bdev
 = 
	`blkdev_g‘_by_·th
(
dev_Çme
, 
mode
, 
fs_ty³
);

943 ià(
	`IS_ERR
(
bdev
))

944  
	`ERR_CAST
(
bdev
);

951 
	`mu‹x_lock
(&
bdev
->
bd_fsä“ze_mu‹x
);

952 ià(
bdev
->
bd_fsä“ze_couÁ
 > 0) {

953 
	`mu‹x_uÆock
(&
bdev
->
bd_fsä“ze_mu‹x
);

954 
”rÜ
 = -
EBUSY
;

955 
”rÜ_bdev
;

957 
s
 = 
	`sg‘
(
fs_ty³
, 
‹¡_bdev_su³r
, 
£t_bdev_su³r
, 
bdev
);

958 
	`mu‹x_uÆock
(&
bdev
->
bd_fsä“ze_mu‹x
);

959 ià(
	`IS_ERR
(
s
))

960 
”rÜ_s
;

962 ià(
s
->
s_roÙ
) {

963 ià((
æags
 ^ 
s
->
s_æags
è& 
MS_RDONLY
) {

964 
	`d—ùiv©e_locked_su³r
(
s
);

965 
”rÜ
 = -
EBUSY
;

966 
”rÜ_bdev
;

976 
	`up_wr™e
(&
s
->
s_umouÁ
);

977 
	`blkdev_put
(
bdev
, 
mode
);

978 
	`down_wr™e
(&
s
->
s_umouÁ
);

980 
b
[
BDEVNAME_SIZE
];

982 
s
->
s_æags
 = 
æags
 | 
MS_NOSEC
;

983 
s
->
s_mode
 = 
mode
;

984 
	`¡¾ıy
(
s
->
s_id
, 
	`bdevÇme
(
bdev
, 
b
), (s->s_id));

985 
	`sb_£t_blocksize
(
s
, 
	`block_size
(
bdev
));

986 
”rÜ
 = 
	`fl_su³r
(
s
, 
d©a
, 
æags
 & 
MS_SILENT
 ? 1 : 0);

987 ià(
”rÜ
) {

988 
	`d—ùiv©e_locked_su³r
(
s
);

989 
”rÜ
;

992 
s
->
s_æags
 |ğ
MS_ACTIVE
;

993 
bdev
->
bd_su³r
 = 
s
;

996  
	`dg‘
(
s
->
s_roÙ
);

998 
”rÜ_s
:

999 
”rÜ
 = 
	`PTR_ERR
(
s
);

1000 
”rÜ_bdev
:

1001 
	`blkdev_put
(
bdev
, 
mode
);

1002 
”rÜ
:

1003  
	`ERR_PTR
(
”rÜ
);

1004 
	}
}

1005 
EXPORT_SYMBOL
(
mouÁ_bdev
);

1007 
	$kl_block_su³r
(
su³r_block
 *
sb
)

1009 
block_deviû
 *
bdev
 = 
sb
->
s_bdev
;

1010 
fmode_t
 
mode
 = 
sb
->
s_mode
;

1012 
bdev
->
bd_su³r
 = 
NULL
;

1013 
	`g’”ic_shutdown_su³r
(
sb
);

1014 
	`sync_blockdev
(
bdev
);

1015 
	`WARN_ON_ONCE
(!(
mode
 & 
FMODE_EXCL
));

1016 
	`blkdev_put
(
bdev
, 
mode
 | 
FMODE_EXCL
);

1017 
	}
}

1019 
EXPORT_SYMBOL
(
kl_block_su³r
);

1022 
d’Œy
 *
mouÁ_nodev
(
fe_sy¡em_ty³
 *
fs_ty³
,

1023 
æags
, *
d©a
,

1024 (*
fl_su³r
)(
su³r_block
 *, *, ))

1026 
”rÜ
;

1027 
su³r_block
 *
s
 = 
	`sg‘
(
fs_ty³
, 
NULL
, 
£t_ªÚ_su³r
, NULL);

1029 ià(
	`IS_ERR
(
s
))

1030  
	`ERR_CAST
(
s
);

1032 
s
->
s_æags
 = 
æags
;

1034 
”rÜ
 = 
	`fl_su³r
(
s
, 
d©a
, 
æags
 & 
MS_SILENT
 ? 1 : 0);

1035 ià(
”rÜ
) {

1036 
	`d—ùiv©e_locked_su³r
(
s
);

1037  
	`ERR_PTR
(
”rÜ
);

1039 
s
->
s_æags
 |ğ
MS_ACTIVE
;

1040  
	`dg‘
(
s
->
s_roÙ
);

1041 
	}
}

1042 
EXPORT_SYMBOL
(
mouÁ_nodev
);

1044 
	$com·»_sšgË
(
su³r_block
 *
s
, *
p
)

1047 
	}
}

1049 
d’Œy
 *
mouÁ_sšgË
(
fe_sy¡em_ty³
 *
fs_ty³
,

1050 
æags
, *
d©a
,

1051 (*
fl_su³r
)(
su³r_block
 *, *, ))

1053 
su³r_block
 *
s
;

1054 
”rÜ
;

1056 
s
 = 
	`sg‘
(
fs_ty³
, 
com·»_sšgË
, 
£t_ªÚ_su³r
, 
NULL
);

1057 ià(
	`IS_ERR
(
s
))

1058  
	`ERR_CAST
(
s
);

1059 ià(!
s
->
s_roÙ
) {

1060 
s
->
s_æags
 = 
æags
;

1061 
”rÜ
 = 
	`fl_su³r
(
s
, 
d©a
, 
æags
 & 
MS_SILENT
 ? 1 : 0);

1062 ià(
”rÜ
) {

1063 
	`d—ùiv©e_locked_su³r
(
s
);

1064  
	`ERR_PTR
(
”rÜ
);

1066 
s
->
s_æags
 |ğ
MS_ACTIVE
;

1068 
	`do_»mouÁ_sb
(
s
, 
æags
, 
d©a
, 0);

1070  
	`dg‘
(
s
->
s_roÙ
);

1071 
	}
}

1072 
EXPORT_SYMBOL
(
mouÁ_sšgË
);

1074 
d’Œy
 *

1075 
	$mouÁ_fs
(
fe_sy¡em_ty³
 *
ty³
, 
æags
, cÚ¡ *
Çme
, *
d©a
)

1077 
d’Œy
 *
roÙ
;

1078 
su³r_block
 *
sb
;

1079 *
£cd©a
 = 
NULL
;

1080 
”rÜ
 = -
ENOMEM
;

1082 ià(
d©a
 && !(
ty³
->
fs_æags
 & 
FS_BINARY_MOUNTDATA
)) {

1083 
£cd©a
 = 
	`®loc_£cd©a
();

1084 ià(!
£cd©a
)

1085 
out
;

1087 
”rÜ
 = 
	`£cur™y_sb_cİy_d©a
(
d©a
, 
£cd©a
);

1088 ià(
”rÜ
)

1089 
out_ä“_£cd©a
;

1092 
roÙ
 = 
ty³
->
	`mouÁ
Ñy³, 
æags
, 
Çme
, 
d©a
);

1093 ià(
	`IS_ERR
(
roÙ
)) {

1094 
”rÜ
 = 
	`PTR_ERR
(
roÙ
);

1095 
out_ä“_£cd©a
;

1097 
sb
 = 
roÙ
->
d_sb
;

1098 
	`BUG_ON
(!
sb
);

1099 
	`WARN_ON
(!
sb
->
s_bdi
);

1100 
	`WARN_ON
(
sb
->
s_bdi
 =ğ&
deçuÉ_backšg_dev_šfo
);

1101 
sb
->
s_æags
 |ğ
MS_BORN
;

1103 
”rÜ
 = 
	`£cur™y_sb_k”n_mouÁ
(
sb
, 
æags
, 
£cd©a
);

1104 ià(
”rÜ
)

1105 
out_sb
;

1113 
	`WARN
((
sb
->
s_maxby‹s
 < 0), "%s set sb->s_maxbyteso "

1114 "Ãg©ivv®u(%Îd)\n", 
ty³
->
Çme
, 
sb
->
s_maxby‹s
);

1116 
	`up_wr™e
(&
sb
->
s_umouÁ
);

1117 
	`ä“_£cd©a
(
£cd©a
);

1118  
roÙ
;

1119 
out_sb
:

1120 
	`dput
(
roÙ
);

1121 
	`d—ùiv©e_locked_su³r
(
sb
);

1122 
out_ä“_£cd©a
:

1123 
	`ä“_£cd©a
(
£cd©a
);

1124 
out
:

1125  
	`ERR_PTR
(
”rÜ
);

1126 
	}
}

1136 
	$ä“ze_su³r
(
su³r_block
 *
sb
)

1138 
»t
;

1140 
	`©omic_šc
(&
sb
->
s_aùive
);

1141 
	`down_wr™e
(&
sb
->
s_umouÁ
);

1142 ià(
sb
->
s_äoz’
) {

1143 
	`d—ùiv©e_locked_su³r
(
sb
);

1144  -
EBUSY
;

1147 ià(
sb
->
s_æags
 & 
MS_RDONLY
) {

1148 
sb
->
s_äoz’
 = 
SB_FREEZE_TRANS
;

1149 
	`smp_wmb
();

1150 
	`up_wr™e
(&
sb
->
s_umouÁ
);

1154 
sb
->
s_äoz’
 = 
SB_FREEZE_WRITE
;

1155 
	`smp_wmb
();

1157 
	`sync_fesy¡em
(
sb
);

1159 
sb
->
s_äoz’
 = 
SB_FREEZE_TRANS
;

1160 
	`smp_wmb
();

1162 
	`sync_blockdev
(
sb
->
s_bdev
);

1163 ià(
sb
->
s_İ
->
ä“ze_fs
) {

1164 
»t
 = 
sb
->
s_İ
->
	`ä“ze_fs
(sb);

1165 ià(
»t
) {

1166 
	`´štk
(
KERN_ERR


1168 
sb
->
s_äoz’
 = 
SB_UNFROZEN
;

1169 
	`d—ùiv©e_locked_su³r
(
sb
);

1170  
»t
;

1173 
	`up_wr™e
(&
sb
->
s_umouÁ
);

1175 
	}
}

1176 
EXPORT_SYMBOL
(
ä“ze_su³r
);

1184 
	$thaw_su³r
(
su³r_block
 *
sb
)

1186 
”rÜ
;

1188 
	`down_wr™e
(&
sb
->
s_umouÁ
);

1189 ià(
sb
->
s_äoz’
 =ğ
SB_UNFROZEN
) {

1190 
	`up_wr™e
(&
sb
->
s_umouÁ
);

1191  -
EINVAL
;

1194 ià(
sb
->
s_æags
 & 
MS_RDONLY
)

1195 
out
;

1197 ià(
sb
->
s_İ
->
unä“ze_fs
) {

1198 
”rÜ
 = 
sb
->
s_İ
->
	`unä“ze_fs
(sb);

1199 ià(
”rÜ
) {

1200 
	`´štk
(
KERN_ERR


1202 
sb
->
s_äoz’
 = 
SB_FREEZE_TRANS
;

1203 
	`up_wr™e
(&
sb
->
s_umouÁ
);

1204  
”rÜ
;

1208 
out
:

1209 
sb
->
s_äoz’
 = 
SB_UNFROZEN
;

1210 
	`smp_wmb
();

1211 
	`wake_up
(&
sb
->
s_wa™_unäoz’
);

1212 
	`d—ùiv©e_locked_su³r
(
sb
);

1215 
	}
}

1216 
EXPORT_SYMBOL
(
thaw_su³r
);

	@sync.c

5 
	~<lšux/k”Ãl.h
>

6 
	~<lšux/fe.h
>

7 
	~<lšux/fs.h
>

8 
	~<lšux/¦ab.h
>

9 
	~<lšux/moduË.h
>

10 
	~<lšux/Çmei.h
>

11 
	~<lšux/sched.h
>

12 
	~<lšux/wr™eback.h
>

13 
	~<lšux/sysÿÎs.h
>

14 
	~<lšux/lškage.h
>

15 
	~<lšux/·gem­.h
>

16 
	~<lšux/quÙaİs.h
>

17 
	~<lšux/bufãr_h—d.h
>

18 
	~<lšux/backšg-dev.h
>

19 
	~"š‹º®.h
"

21 
	#VALID_FLAGS
 (
SYNC_FILE_RANGE_WAIT_BEFORE
|
SYNC_FILE_RANGE_WRITE
| \

22 
SYNC_FILE_RANGE_WAIT_AFTER
)

	)

31 
	$__sync_fesy¡em
(
su³r_block
 *
sb
, 
wa™
)

37 ià(
sb
->
s_bdi
 =ğ&
noİ_backšg_dev_šfo
)

40 ià(
sb
->
s_qcİ
 && sb->s_qcİ->
quÙa_sync
)

41 
sb
->
s_qcİ
->
	`quÙa_sync
(sb, -1, 
wa™
);

43 ià(
wa™
)

44 
	`sync_šodes_sb
(
sb
);

46 
	`wr™eback_šodes_sb
(
sb
, 
WB_REASON_SYNC
);

48 ià(
sb
->
s_İ
->
sync_fs
)

49 
sb
->
s_İ
->
	`sync_fs
(sb, 
wa™
);

50  
	`__sync_blockdev
(
sb
->
s_bdev
, 
wa™
);

51 
	}
}

58 
	$sync_fesy¡em
(
su³r_block
 *
sb
)

60 
»t
;

66 
	`WARN_ON
(!
	`rw£m_is_locked
(&
sb
->
s_umouÁ
));

71 ià(
sb
->
s_æags
 & 
MS_RDONLY
)

74 
»t
 = 
	`__sync_fesy¡em
(
sb
, 0);

75 ià(
»t
 < 0)

76  
»t
;

77  
	`__sync_fesy¡em
(
sb
, 1);

78 
	}
}

79 
EXPORT_SYMBOL_GPL
(
sync_fesy¡em
);

81 
	$sync_Úe_sb
(
su³r_block
 *
sb
, *
¬g
)

83 ià(!(
sb
->
s_æags
 & 
MS_RDONLY
))

84 
	`__sync_fesy¡em
(
sb
, *(*)
¬g
);

85 
	}
}

90 
	$sync_fesy¡ems
(
wa™
)

92 
	`™”©e_su³rs
(
sync_Úe_sb
, &
wa™
);

93 
	}
}

99 
	$SYSCALL_DEFINE0
(
sync
)

101 
	`wakeup_æush”_th»ads
(0, 
WB_REASON_SYNC
);

102 
	`sync_fesy¡ems
(0);

103 
	`sync_fesy¡ems
(1);

104 ià(
	`uÆik–y
(
Ï±İ_mode
))

105 
	`Ï±İ_sync_com¶‘iÚ
();

107 
	}
}

109 
	$do_sync_wÜk
(
wÜk_¡ruù
 *
wÜk
)

115 
	`sync_fesy¡ems
(0);

116 
	`sync_fesy¡ems
(0);

117 
	`´štk
("Emergency Sync complete\n");

118 
	`kä“
(
wÜk
);

119 
	}
}

121 
	$em”g’cy_sync
()

123 
wÜk_¡ruù
 *
wÜk
;

125 
wÜk
 = 
	`km®loc
((*wÜk), 
GFP_ATOMIC
);

126 ià(
wÜk
) {

127 
	`INIT_WORK
(
wÜk
, 
do_sync_wÜk
);

128 
	`scheduË_wÜk
(
wÜk
);

130 
	}
}

135 
	$SYSCALL_DEFINE1
(
syncfs
, , 
fd
)

137 
fe
 *file;

138 
su³r_block
 *
sb
;

139 
»t
;

140 
åut_Ãeded
;

142 
fe
 = 
	`fg‘_light
(
fd
, &
åut_Ãeded
);

143 ià(!
fe
)

144  -
EBADF
;

145 
sb
 = 
fe
->
f_d’Œy
->
d_sb
;

147 
	`down_»ad
(&
sb
->
s_umouÁ
);

148 
»t
 = 
	`sync_fesy¡em
(
sb
);

149 
	`up_»ad
(&
sb
->
s_umouÁ
);

151 
	`åut_light
(
fe
, 
åut_Ãeded
);

152  
»t
;

153 
	}
}

166 
	$vfs_fsync_¿nge
(
fe
 *fe, 
loff_t
 
¡¬t
,†off_ˆ
’d
, 
d©async
)

168 ià(!
fe
->
f_İ
 || !fe->f_İ->
fsync
)

169  -
EINVAL
;

170  
fe
->
f_İ
->
	`fsync
(fe, 
¡¬t
, 
’d
, 
d©async
);

171 
	}
}

172 
EXPORT_SYMBOL
(
vfs_fsync_¿nge
);

182 
	$vfs_fsync
(
fe
 *fe, 
d©async
)

184  
	`vfs_fsync_¿nge
(
fe
, 0, 
LLONG_MAX
, 
d©async
);

185 
	}
}

186 
EXPORT_SYMBOL
(
vfs_fsync
);

188 
	$do_fsync
(
fd
, 
d©async
)

190 
fe
 *file;

191 
»t
 = -
EBADF
;

193 
fe
 = 
	`fg‘
(
fd
);

194 ià(
fe
) {

195 
»t
 = 
	`vfs_fsync
(
fe
, 
d©async
);

196 
	`åut
(
fe
);

198  
»t
;

199 
	}
}

201 
	$SYSCALL_DEFINE1
(
fsync
, , 
fd
)

203  
	`do_fsync
(
fd
, 0);

204 
	}
}

206 
	$SYSCALL_DEFINE1
(
fd©async
, , 
fd
)

208  
	`do_fsync
(
fd
, 1);

209 
	}
}

219 
	$g’”ic_wr™e_sync
(
fe
 *fe, 
loff_t
 
pos
,†off_ˆ
couÁ
)

221 ià(!(
fe
->
f_æags
 & 
O_DSYNC
è&& !
	`IS_SYNC
(fe->
f_m­pšg
->
ho¡
))

223  
	`vfs_fsync_¿nge
(
fe
, 
pos
,…o + 
couÁ
 - 1,

224 (
fe
->
f_æags
 & 
__O_SYNC
) ? 0 : 1);

225 
	}
}

226 
EXPORT_SYMBOL
(
g’”ic_wr™e_sync
);

275 
	$SYSCALL_DEFINE
(
sync_fe_¿nge
)(
fd
, 
loff_t
 
off£t
,†off_ˆ
nby‹s
,

276 
æags
)

278 
»t
;

279 
fe
 *file;

280 
add»ss_¥aû
 *
m­pšg
;

281 
loff_t
 
’dby‹
;

282 
åut_Ãeded
;

283 
umode_t
 
i_mode
;

285 
»t
 = -
EINVAL
;

286 ià(
æags
 & ~
VALID_FLAGS
)

287 
out
;

289 
’dby‹
 = 
off£t
 + 
nby‹s
;

291 ià((
s64
)
off£t
 < 0)

292 
out
;

293 ià((
s64
)
’dby‹
 < 0)

294 
out
;

295 ià(
’dby‹
 < 
off£t
)

296 
out
;

298 ià((
pgoff_t
) == 4) {

299 ià(
off£t
 >ğ(0x100000000ULL << 
PAGE_CACHE_SHIFT
)) {

304 
»t
 = 0;

305 
out
;

307 ià(
’dby‹
 >ğ(0x100000000ULL << 
PAGE_CACHE_SHIFT
)) {

311 
nby‹s
 = 0;

315 ià(
nby‹s
 == 0)

316 
’dby‹
 = 
LLONG_MAX
;

318 
’dby‹
--;

320 
»t
 = -
EBADF
;

321 
fe
 = 
	`fg‘_light
(
fd
, &
åut_Ãeded
);

322 ià(!
fe
)

323 
out
;

325 
i_mode
 = 
fe
->
f_·th
.
d’Œy
->
d_šode
->i_mode;

326 
»t
 = -
ESPIPE
;

327 ià(!
	`S_ISREG
(
i_mode
è&& !
	`S_ISBLK
(i_modeè&& !
	`S_ISDIR
(i_mode) &&

328 !
	`S_ISLNK
(
i_mode
))

329 
out_put
;

331 
m­pšg
 = 
fe
->
f_m­pšg
;

332 ià(!
m­pšg
) {

333 
»t
 = -
EINVAL
;

334 
out_put
;

337 
»t
 = 0;

338 ià(
æags
 & 
SYNC_FILE_RANGE_WAIT_BEFORE
) {

339 
»t
 = 
	`fem­_fd©awa™_¿nge
(
m­pšg
, 
off£t
, 
’dby‹
);

340 ià(
»t
 < 0)

341 
out_put
;

344 ià(
æags
 & 
SYNC_FILE_RANGE_WRITE
) {

345 
»t
 = 
	`fem­_fd©awr™e_¿nge
(
m­pšg
, 
off£t
, 
’dby‹
);

346 ià(
»t
 < 0)

347 
out_put
;

350 ià(
æags
 & 
SYNC_FILE_RANGE_WAIT_AFTER
)

351 
»t
 = 
	`fem­_fd©awa™_¿nge
(
m­pšg
, 
off£t
, 
’dby‹
);

353 
out_put
:

354 
	`åut_light
(
fe
, 
åut_Ãeded
);

355 
out
:

356  
»t
;

357 
	}
}

358 #ifdeà
CONFIG_HAVE_SYSCALL_WRAPPERS


359 
asmlškage
 
	$SyS_sync_fe_¿nge
(
fd
, 
loff_t
 
off£t
,†off_ˆ
nby‹s
,

360 
æags
)

362  
	`SYSC_sync_fe_¿nge
((è
fd
, 
off£t
, 
nby‹s
,

363 (è
æags
);

364 
	}
}

365 
SYSCALL_ALIAS
(
sys_sync_fe_¿nge
, 
SyS_sync_fe_¿nge
);

370 
	$SYSCALL_DEFINE
(
sync_fe_¿nge2
)(
fd
, 
æags
,

371 
loff_t
 
off£t
,†off_ˆ
nby‹s
)

373  
	`sys_sync_fe_¿nge
(
fd
, 
off£t
, 
nby‹s
, 
æags
);

374 
	}
}

375 #ifdeà
CONFIG_HAVE_SYSCALL_WRAPPERS


376 
asmlškage
 
	$SyS_sync_fe_¿nge2
(
fd
, 
æags
,

377 
loff_t
 
off£t
,†off_ˆ
nby‹s
)

379  
	`SYSC_sync_fe_¿nge2
((è
fd
, (è
æags
,

380 
off£t
, 
nby‹s
);

381 
	}
}

382 
SYSCALL_ALIAS
(
sys_sync_fe_¿nge2
, 
SyS_sync_fe_¿nge2
);

	@timerfd.c

11 
	~<lšux/fe.h
>

12 
	~<lšux/pŞl.h
>

13 
	~<lšux/š™.h
>

14 
	~<lšux/fs.h
>

15 
	~<lšux/sched.h
>

16 
	~<lšux/k”Ãl.h
>

17 
	~<lšux/¦ab.h
>

18 
	~<lšux/li¡.h
>

19 
	~<lšux/¥šlock.h
>

20 
	~<lšux/time.h
>

21 
	~<lšux/h¹im”.h
>

22 
	~<lšux/ªÚ_šodes.h
>

23 
	~<lšux/tim”fd.h
>

24 
	~<lšux/sysÿÎs.h
>

25 
	~<lšux/rcupd©e.h
>

27 
	stim”fd_ùx
 {

28 
h¹im”
 
	mtmr
;

29 
ktime_t
 
	mtštv
;

30 
ktime_t
 
	mmoffs
;

31 
wa™_queue_h—d_t
 
	mwqh
;

32 
u64
 
	mticks
;

33 
	mexpœed
;

34 
	mşockid
;

35 
rcu_h—d
 
	mrcu
;

36 
li¡_h—d
 
	mşi¡
;

37 
boŞ
 
	mmight_ÿnûl
;

40 
LIST_HEAD
(
ÿnûl_li¡
);

41 
DEFINE_SPINLOCK
(
ÿnûl_lock
);

48 
h¹im”_»¡¬t
 
	$tim”fd_tm½roc
(
h¹im”
 *
htmr
)

50 
tim”fd_ùx
 *
ùx
 = 
	`cÚš”_of
(
htmr
, tim”fd_ùx, 
tmr
);

51 
æags
;

53 
	`¥š_lock_œq§ve
(&
ùx
->
wqh
.
lock
, 
æags
);

54 
ùx
->
expœed
 = 1;

55 
ùx
->
ticks
++;

56 
	`wake_up_locked
(&
ùx
->
wqh
);

57 
	`¥š_uÆock_œq»¡Üe
(&
ùx
->
wqh
.
lock
, 
æags
);

59  
HRTIMER_NORESTART
;

60 
	}
}

68 
	$tim”fd_şock_was_£t
()

70 
ktime_t
 
moffs
 = 
	`ktime_g‘_mÚÙÚic_off£t
();

71 
tim”fd_ùx
 *
ùx
;

72 
æags
;

74 
	`rcu_»ad_lock
();

75 
	`li¡_fÜ_—ch_’Œy_rcu
(
ùx
, &
ÿnûl_li¡
, 
şi¡
) {

76 ià(!
ùx
->
might_ÿnûl
)

78 
	`¥š_lock_œq§ve
(&
ùx
->
wqh
.
lock
, 
æags
);

79 ià(
ùx
->
moffs
.
tv64
 != moffs.tv64) {

80 
ùx
->
moffs
.
tv64
 = 
KTIME_MAX
;

81 
ùx
->
ticks
++;

82 
	`wake_up_locked
(&
ùx
->
wqh
);

84 
	`¥š_uÆock_œq»¡Üe
(&
ùx
->
wqh
.
lock
, 
æags
);

86 
	`rcu_»ad_uÆock
();

87 
	}
}

89 
	$tim”fd_»move_ÿnûl
(
tim”fd_ùx
 *
ùx
)

91 ià(
ùx
->
might_ÿnûl
) {

92 
ùx
->
might_ÿnûl
 = 
çl£
;

93 
	`¥š_lock
(&
ÿnûl_lock
);

94 
	`li¡_d–_rcu
(&
ùx
->
şi¡
);

95 
	`¥š_uÆock
(&
ÿnûl_lock
);

97 
	}
}

99 
boŞ
 
	$tim”fd_ÿnûËd
(
tim”fd_ùx
 *
ùx
)

101 ià(!
ùx
->
might_ÿnûl
 || ctx->
moffs
.
tv64
 !ğ
KTIME_MAX
)

102  
çl£
;

103 
ùx
->
moffs
 = 
	`ktime_g‘_mÚÙÚic_off£t
();

104  
Œue
;

105 
	}
}

107 
	$tim”fd_£tup_ÿnûl
(
tim”fd_ùx
 *
ùx
, 
æags
)

109 ià(
ùx
->
şockid
 =ğ
CLOCK_REALTIME
 && (
æags
 & 
TFD_TIMER_ABSTIME
) &&

110 (
æags
 & 
TFD_TIMER_CANCEL_ON_SET
)) {

111 ià(!
ùx
->
might_ÿnûl
) {

112 
ùx
->
might_ÿnûl
 = 
Œue
;

113 
	`¥š_lock
(&
ÿnûl_lock
);

114 
	`li¡_add_rcu
(&
ùx
->
şi¡
, &
ÿnûl_li¡
);

115 
	`¥š_uÆock
(&
ÿnûl_lock
);

117 } ià(
ùx
->
might_ÿnûl
) {

118 
	`tim”fd_»move_ÿnûl
(
ùx
);

120 
	}
}

122 
ktime_t
 
	$tim”fd_g‘_»maššg
(
tim”fd_ùx
 *
ùx
)

124 
ktime_t
 
»maššg
;

126 
»maššg
 = 
	`h¹im”_expœes_»maššg
(&
ùx
->
tmr
);

127  
»maššg
.
tv64
 < 0 ? 
	`ktime_£t
(0, 0):„emaining;

128 
	}
}

130 
	$tim”fd_£tup
(
tim”fd_ùx
 *
ùx
, 
æags
,

131 cÚ¡ 
™im”¥ec
 *
ktmr
)

133 
h¹im”_mode
 
htmode
;

134 
ktime_t
 
‹xp
;

135 
şockid
 = 
ùx
->clockid;

137 
htmode
 = (
æags
 & 
TFD_TIMER_ABSTIME
) ?

138 
HRTIMER_MODE_ABS
: 
HRTIMER_MODE_REL
;

140 
‹xp
 = 
	`time¥ec_to_ktime
(
ktmr
->
™_v®ue
);

141 
ùx
->
expœed
 = 0;

142 
ùx
->
ticks
 = 0;

143 
ùx
->
tštv
 = 
	`time¥ec_to_ktime
(
ktmr
->
™_š‹rv®
);

144 
	`h¹im”_š™
(&
ùx
->
tmr
, 
şockid
, 
htmode
);

145 
	`h¹im”_£t_expœes
(&
ùx
->
tmr
, 
‹xp
);

146 
ùx
->
tmr
.
funùiÚ
 = 
tim”fd_tm½roc
;

147 ià(
‹xp
.
tv64
 != 0) {

148 
	`h¹im”_¡¬t
(&
ùx
->
tmr
, 
‹xp
, 
htmode
);

149 ià(
	`tim”fd_ÿnûËd
(
ùx
))

150  -
ECANCELED
;

153 
	}
}

155 
	$tim”fd_»Ëa£
(
šode
 *šode, 
fe
 *file)

157 
tim”fd_ùx
 *
ùx
 = 
fe
->
´iv©e_d©a
;

159 
	`tim”fd_»move_ÿnûl
(
ùx
);

160 
	`h¹im”_ÿnûl
(&
ùx
->
tmr
);

161 
	`kä“_rcu
(
ùx
, 
rcu
);

163 
	}
}

165 
	$tim”fd_pŞl
(
fe
 *fe, 
pŞl_bË
 *
wa™
)

167 
tim”fd_ùx
 *
ùx
 = 
fe
->
´iv©e_d©a
;

168 
ev’ts
 = 0;

169 
æags
;

171 
	`pŞl_wa™
(
fe
, &
ùx
->
wqh
, 
wa™
);

173 
	`¥š_lock_œq§ve
(&
ùx
->
wqh
.
lock
, 
æags
);

174 ià(
ùx
->
ticks
)

175 
ev’ts
 |ğ
POLLIN
;

176 
	`¥š_uÆock_œq»¡Üe
(&
ùx
->
wqh
.
lock
, 
æags
);

178  
ev’ts
;

179 
	}
}

181 
ssize_t
 
	$tim”fd_»ad
(
fe
 *fe, 
__u£r
 *
buf
, 
size_t
 
couÁ
,

182 
loff_t
 *
µos
)

184 
tim”fd_ùx
 *
ùx
 = 
fe
->
´iv©e_d©a
;

185 
ssize_t
 
»s
;

186 
u64
 
ticks
 = 0;

188 ià(
couÁ
 < (
ticks
))

189  -
EINVAL
;

190 
	`¥š_lock_œq
(&
ùx
->
wqh
.
lock
);

191 ià(
fe
->
f_æags
 & 
O_NONBLOCK
)

192 
»s
 = -
EAGAIN
;

194 
»s
 = 
	`wa™_ev’t_š‹¼u±ibË_locked_œq
(
ùx
->
wqh
, ctx->
ticks
);

201 ià(
	`tim”fd_ÿnûËd
(
ùx
)) {

202 
ùx
->
ticks
 = 0;

203 
ùx
->
expœed
 = 0;

204 
»s
 = -
ECANCELED
;

207 ià(
ùx
->
ticks
) {

208 
ticks
 = 
ùx
->ticks;

210 ià(
ùx
->
expœed
 && ctx->
tštv
.
tv64
) {

217 
ticks
 +ğ
	`h¹im”_fÜw¬d_now
(&
ùx
->
tmr
,

218 
ùx
->
tštv
) - 1;

219 
	`h¹im”_»¡¬t
(&
ùx
->
tmr
);

221 
ùx
->
expœed
 = 0;

222 
ùx
->
ticks
 = 0;

224 
	`¥š_uÆock_œq
(&
ùx
->
wqh
.
lock
);

225 ià(
ticks
)

226 
»s
 = 
	`put_u£r
(
ticks
, (
u64
 
__u£r
 *è
buf
è? -
EFAULT
: (ticks);

227  
»s
;

228 
	}
}

230 cÚ¡ 
fe_İ”©iÚs
 
	gtim”fd_fİs
 = {

231 .
»Ëa£
 = 
tim”fd_»Ëa£
,

232 .
	gpŞl
 = 
tim”fd_pŞl
,

233 .
	g»ad
 = 
tim”fd_»ad
,

234 .
	gÎ£ek
 = 
noİ_Î£ek
,

237 
fe
 *
	$tim”fd_fg‘
(
fd
)

239 
fe
 *file;

241 
fe
 = 
	`fg‘
(
fd
);

242 ià(!
fe
)

243  
	`ERR_PTR
(-
EBADF
);

244 ià(
fe
->
f_İ
 !ğ&
tim”fd_fİs
) {

245 
	`åut
(
fe
);

246  
	`ERR_PTR
(-
EINVAL
);

249  
fe
;

250 
	}
}

252 
	$SYSCALL_DEFINE2
(
tim”fd_ü—‹
, , 
şockid
, , 
æags
)

254 
ufd
;

255 
tim”fd_ùx
 *
ùx
;

258 
	`BUILD_BUG_ON
(
TFD_CLOEXEC
 !ğ
O_CLOEXEC
);

259 
	`BUILD_BUG_ON
(
TFD_NONBLOCK
 !ğ
O_NONBLOCK
);

261 ià((
æags
 & ~
TFD_CREATE_FLAGS
) ||

262 (
şockid
 !ğ
CLOCK_MONOTONIC
 &&

263 
şockid
 !ğ
CLOCK_REALTIME
))

264  -
EINVAL
;

266 
ùx
 = 
	`kz®loc
((*ùx), 
GFP_KERNEL
);

267 ià(!
ùx
)

268  -
ENOMEM
;

270 
	`š™_wa™queue_h—d
(&
ùx
->
wqh
);

271 
ùx
->
şockid
 = clockid;

272 
	`h¹im”_š™
(&
ùx
->
tmr
, 
şockid
, 
HRTIMER_MODE_ABS
);

273 
ùx
->
moffs
 = 
	`ktime_g‘_mÚÙÚic_off£t
();

275 
ufd
 = 
	`ªÚ_šode_g‘fd
("[tim”fd]", &
tim”fd_fİs
, 
ùx
,

276 
O_RDWR
 | (
æags
 & 
TFD_SHARED_FCNTL_FLAGS
));

277 ià(
ufd
 < 0)

278 
	`kä“
(
ùx
);

280  
ufd
;

281 
	}
}

283 
	$SYSCALL_DEFINE4
(
tim”fd_£‰ime
, , 
ufd
, , 
æags
,

284 cÚ¡ 
™im”¥ec
 
__u£r
 *, 
utmr
,

285 
™im”¥ec
 
__u£r
 *, 
Ùmr
)

287 
fe
 *file;

288 
tim”fd_ùx
 *
ùx
;

289 
™im”¥ec
 
ktmr
, 
kÙmr
;

290 
»t
;

292 ià(
	`cİy_äom_u£r
(&
ktmr
, 
utmr
, (ktmr)))

293  -
EFAULT
;

295 ià((
æags
 & ~
TFD_SETTIME_FLAGS
) ||

296 !
	`time¥ec_v®id
(&
ktmr
.
™_v®ue
) ||

297 !
	`time¥ec_v®id
(&
ktmr
.
™_š‹rv®
))

298  -
EINVAL
;

300 
fe
 = 
	`tim”fd_fg‘
(
ufd
);

301 ià(
	`IS_ERR
(
fe
))

302  
	`PTR_ERR
(
fe
);

303 
ùx
 = 
fe
->
´iv©e_d©a
;

305 
	`tim”fd_£tup_ÿnûl
(
ùx
, 
æags
);

312 
	`¥š_lock_œq
(&
ùx
->
wqh
.
lock
);

313 ià(
	`h¹im”_Œy_to_ÿnûl
(&
ùx
->
tmr
) >= 0)

315 
	`¥š_uÆock_œq
(&
ùx
->
wqh
.
lock
);

316 
	`ıu_»Ïx
();

325 ià(
ùx
->
expœed
 && ctx->
tštv
.
tv64
)

326 
	`h¹im”_fÜw¬d_now
(&
ùx
->
tmr
, ctx->
tštv
);

328 
kÙmr
.
™_v®ue
 = 
	`ktime_to_time¥ec
(
	`tim”fd_g‘_»maššg
(
ùx
));

329 
kÙmr
.
™_š‹rv®
 = 
	`ktime_to_time¥ec
(
ùx
->
tštv
);

334 
»t
 = 
	`tim”fd_£tup
(
ùx
, 
æags
, &
ktmr
);

336 
	`¥š_uÆock_œq
(&
ùx
->
wqh
.
lock
);

337 
	`åut
(
fe
);

338 ià(
Ùmr
 && 
	`cİy_to_u£r
(Ùmr, &
kÙmr
, (kotmr)))

339  -
EFAULT
;

341  
»t
;

342 
	}
}

344 
	$SYSCALL_DEFINE2
(
tim”fd_g‘time
, , 
ufd
, 
™im”¥ec
 
__u£r
 *, 
Ùmr
)

346 
fe
 *file;

347 
tim”fd_ùx
 *
ùx
;

348 
™im”¥ec
 
kÙmr
;

350 
fe
 = 
	`tim”fd_fg‘
(
ufd
);

351 ià(
	`IS_ERR
(
fe
))

352  
	`PTR_ERR
(
fe
);

353 
ùx
 = 
fe
->
´iv©e_d©a
;

355 
	`¥š_lock_œq
(&
ùx
->
wqh
.
lock
);

356 ià(
ùx
->
expœed
 && ctx->
tštv
.
tv64
) {

357 
ùx
->
expœed
 = 0;

358 
ùx
->
ticks
 +=

359 
	`h¹im”_fÜw¬d_now
(&
ùx
->
tmr
, ctx->
tštv
) - 1;

360 
	`h¹im”_»¡¬t
(&
ùx
->
tmr
);

362 
kÙmr
.
™_v®ue
 = 
	`ktime_to_time¥ec
(
	`tim”fd_g‘_»maššg
(
ùx
));

363 
kÙmr
.
™_š‹rv®
 = 
	`ktime_to_time¥ec
(
ùx
->
tštv
);

364 
	`¥š_uÆock_œq
(&
ùx
->
wqh
.
lock
);

365 
	`åut
(
fe
);

367  
	`cİy_to_u£r
(
Ùmr
, &
kÙmr
, (kÙmr)è? -
EFAULT
: 0;

368 
	}
}

	@utimes.c

1 
	~<lšux/comp”.h
>

2 
	~<lšux/fe.h
>

3 
	~<lšux/fs.h
>

4 
	~<lšux/lškage.h
>

5 
	~<lšux/mouÁ.h
>

6 
	~<lšux/Çmei.h
>

7 
	~<lšux/sched.h
>

8 
	~<lšux/¡©.h
>

9 
	~<lšux/utime.h
>

10 
	~<lšux/sysÿÎs.h
>

11 
	~<asm/uacûss.h
>

12 
	~<asm/uni¡d.h
>

14 #ifdeà
__ARCH_WANT_SYS_UTIME


27 
	$SYSCALL_DEFINE2
(
utime
, 
__u£r
 *, 
f’ame
, 
utimbuf
 __u£¸*, 
times
)

29 
time¥ec
 
tv
[2];

31 ià(
times
) {

32 ià(
	`g‘_u£r
(
tv
[0].
tv_£c
, &
times
->
aùime
) ||

33 
	`g‘_u£r
(
tv
[1].
tv_£c
, &
times
->
modtime
))

34  -
EFAULT
;

35 
tv
[0].
tv_n£c
 = 0;

36 
tv
[1].
tv_n£c
 = 0;

38  
	`do_utimes
(
AT_FDCWD
, 
f’ame
, 
times
 ? 
tv
 : 
NULL
, 0);

39 
	}
}

43 
boŞ
 
	$n£c_v®id
(
n£c
)

45 ià(
n£c
 =ğ
UTIME_OMIT
 ||‚£ø=ğ
UTIME_NOW
)

46  
Œue
;

48  
n£c
 >= 0 &&‚sec <= 999999999;

49 
	}
}

51 
	$utimes_commÚ
(
·th
 *·th, 
time¥ec
 *
times
)

53 
”rÜ
;

54 
Ÿ‰r
 
Ãw©Œs
;

55 
šode
 *šodğ
·th
->
d’Œy
->
d_šode
;

57 
”rÜ
 = 
	`mÁ_wªt_wr™e
(
·th
->
mÁ
);

58 ià(
”rÜ
)

59 
out
;

61 ià(
times
 &&imes[0].
tv_n£c
 =ğ
UTIME_NOW
 &&

62 
times
[1].
tv_n£c
 =ğ
UTIME_NOW
)

63 
times
 = 
NULL
;

65 
Ãw©Œs
.
Ÿ_v®id
 = 
ATTR_CTIME
 | 
ATTR_MTIME
 | 
ATTR_ATIME
;

66 ià(
times
) {

67 ià(
times
[0].
tv_n£c
 =ğ
UTIME_OMIT
)

68 
Ãw©Œs
.
Ÿ_v®id
 &ğ~
ATTR_ATIME
;

69 ià(
times
[0].
tv_n£c
 !ğ
UTIME_NOW
) {

70 
Ãw©Œs
.
Ÿ_©ime
.
tv_£c
 = 
times
[0].tv_sec;

71 
Ãw©Œs
.
Ÿ_©ime
.
tv_n£c
 = 
times
[0].tv_nsec;

72 
Ãw©Œs
.
Ÿ_v®id
 |ğ
ATTR_ATIME_SET
;

75 ià(
times
[1].
tv_n£c
 =ğ
UTIME_OMIT
)

76 
Ãw©Œs
.
Ÿ_v®id
 &ğ~
ATTR_MTIME
;

77 ià(
times
[1].
tv_n£c
 !ğ
UTIME_NOW
) {

78 
Ãw©Œs
.
Ÿ_mtime
.
tv_£c
 = 
times
[1].tv_sec;

79 
Ãw©Œs
.
Ÿ_mtime
.
tv_n£c
 = 
times
[1].tv_nsec;

80 
Ãw©Œs
.
Ÿ_v®id
 |ğ
ATTR_MTIME_SET
;

87 
Ãw©Œs
.
Ÿ_v®id
 |ğ
ATTR_TIMES_SET
;

94 
”rÜ
 = -
EACCES
;

95 ià(
	`IS_IMMUTABLE
(
šode
))

96 
mÁ_drİ_wr™e_ªd_out
;

98 ià(!
	`šode_owÃr_Ü_ÿ·bË
(
šode
)) {

99 
”rÜ
 = 
	`šode_³rmissiÚ
(
šode
, 
MAY_WRITE
);

100 ià(
”rÜ
)

101 
mÁ_drİ_wr™e_ªd_out
;

104 
	`mu‹x_lock
(&
šode
->
i_mu‹x
);

105 
”rÜ
 = 
	`nÙify_chªge
(
·th
->
d’Œy
, &
Ãw©Œs
);

106 
	`mu‹x_uÆock
(&
šode
->
i_mu‹x
);

108 
mÁ_drİ_wr™e_ªd_out
:

109 
	`mÁ_drİ_wr™e
(
·th
->
mÁ
);

110 
out
:

111  
”rÜ
;

112 
	}
}

129 
	$do_utimes
(
dfd
, cÚ¡ 
__u£r
 *
f’ame
, 
time¥ec
 *
times
,

130 
æags
)

132 
”rÜ
 = -
EINVAL
;

134 ià(
times
 && (!
	`n£c_v®id
Ñimes[0].
tv_n£c
) ||

135 !
	`n£c_v®id
(
times
[1].
tv_n£c
))) {

136 
out
;

139 ià(
æags
 & ~
AT_SYMLINK_NOFOLLOW
)

140 
out
;

142 ià(
f’ame
 =ğ
NULL
 && 
dfd
 !ğ
AT_FDCWD
) {

143 
fe
 *file;

145 ià(
æags
 & 
AT_SYMLINK_NOFOLLOW
)

146 
out
;

148 
fe
 = 
	`fg‘
(
dfd
);

149 
”rÜ
 = -
EBADF
;

150 ià(!
fe
)

151 
out
;

153 
”rÜ
 = 
	`utimes_commÚ
(&
fe
->
f_·th
, 
times
);

154 
	`åut
(
fe
);

156 
·th
…ath;

157 
lookup_æags
 = 0;

159 ià(!(
æags
 & 
AT_SYMLINK_NOFOLLOW
))

160 
lookup_æags
 |ğ
LOOKUP_FOLLOW
;

162 
”rÜ
 = 
	`u£r_·th_©
(
dfd
, 
f’ame
, 
lookup_æags
, &
·th
);

163 ià(
”rÜ
)

164 
out
;

166 
”rÜ
 = 
	`utimes_commÚ
(&
·th
, 
times
);

167 
	`·th_put
(&
·th
);

170 
out
:

171  
”rÜ
;

172 
	}
}

174 
	$SYSCALL_DEFINE4
(
utim’§t
, , 
dfd
, cÚ¡ 
__u£r
 *, 
f’ame
,

175 
time¥ec
 
__u£r
 *, 
utimes
, , 
æags
)

177 
time¥ec
 
t¡imes
[2];

179 ià(
utimes
) {

180 ià(
	`cİy_äom_u£r
(&
t¡imes
, 
utimes
, (tstimes)))

181  -
EFAULT
;

184 ià(
t¡imes
[0].
tv_n£c
 =ğ
UTIME_OMIT
 &&

185 
t¡imes
[1].
tv_n£c
 =ğ
UTIME_OMIT
)

189  
	`do_utimes
(
dfd
, 
f’ame
, 
utimes
 ? 
t¡imes
 : 
NULL
, 
æags
);

190 
	}
}

192 
	$SYSCALL_DEFINE3
(
futime§t
, , 
dfd
, cÚ¡ 
__u£r
 *, 
f’ame
,

193 
timev®
 
__u£r
 *, 
utimes
)

195 
timev®
 
times
[2];

196 
time¥ec
 
t¡imes
[2];

198 ià(
utimes
) {

199 ià(
	`cİy_äom_u£r
(&
times
, 
utimes
, (times)))

200  -
EFAULT
;

207 ià(
times
[0].
tv_u£c
 >= 1000000 ||imes[0].tv_usec < 0 ||

208 
times
[1].
tv_u£c
 >= 1000000 ||imes[1].tv_usec < 0)

209  -
EINVAL
;

211 
t¡imes
[0].
tv_£c
 = 
times
[0].tv_sec;

212 
t¡imes
[0].
tv_n£c
 = 1000 * 
times
[0].
tv_u£c
;

213 
t¡imes
[1].
tv_£c
 = 
times
[1].tv_sec;

214 
t¡imes
[1].
tv_n£c
 = 1000 * 
times
[1].
tv_u£c
;

217  
	`do_utimes
(
dfd
, 
f’ame
, 
utimes
 ? 
t¡imes
 : 
NULL
, 0);

218 
	}
}

220 
	$SYSCALL_DEFINE2
(
utimes
, 
__u£r
 *, 
f’ame
,

221 
timev®
 
__u£r
 *, 
utimes
)

223  
	`sys_futime§t
(
AT_FDCWD
, 
f’ame
, 
utimes
);

224 
	}
}

	@xattr.c

10 
	~<lšux/fs.h
>

11 
	~<lšux/¦ab.h
>

12 
	~<lšux/fe.h
>

13 
	~<lšux/x©Œ.h
>

14 
	~<lšux/mouÁ.h
>

15 
	~<lšux/Çmei.h
>

16 
	~<lšux/£cur™y.h
>

17 
	~<lšux/evm.h
>

18 
	~<lšux/sysÿÎs.h
>

19 
	~<lšux/moduË.h
>

20 
	~<lšux/f¢Ùify.h
>

21 
	~<lšux/aud™.h
>

22 
	~<asm/uacûss.h
>

30 
	$x©Œ_³rmissiÚ
(
šode
 *šode, cÚ¡ *
Çme
, 
mask
)

36 ià(
mask
 & 
MAY_WRITE
) {

37 ià(
	`IS_IMMUTABLE
(
šode
è|| 
	`IS_APPEND
(inode))

38  -
EPERM
;

45 ià(!
	`¡ºcmp
(
Çme
, 
XATTR_SECURITY_PREFIX
, 
XATTR_SECURITY_PREFIX_LEN
) ||

46 !
	`¡ºcmp
(
Çme
, 
XATTR_SYSTEM_PREFIX
, 
XATTR_SYSTEM_PREFIX_LEN
))

52 ià(!
	`¡ºcmp
(
Çme
, 
XATTR_TRUSTED_PREFIX
, 
XATTR_TRUSTED_PREFIX_LEN
)) {

53 ià(!
	`ÿ·bË
(
CAP_SYS_ADMIN
))

54  (
mask
 & 
MAY_WRITE
è? -
EPERM
 : -
ENODATA
;

63 ià(!
	`¡ºcmp
(
Çme
, 
XATTR_USER_PREFIX
, 
XATTR_USER_PREFIX_LEN
)) {

64 ià(!
	`S_ISREG
(
šode
->
i_mode
è&& !
	`S_ISDIR
(inode->i_mode))

65  (
mask
 & 
MAY_WRITE
è? -
EPERM
 : -
ENODATA
;

66 ià(
	`S_ISDIR
(
šode
->
i_mode
è&& (šode->i_mod& 
S_ISVTX
) &&

67 (
mask
 & 
MAY_WRITE
è&& !
	`šode_owÃr_Ü_ÿ·bË
(
šode
))

68  -
EPERM
;

71  
	`šode_³rmissiÚ
(
šode
, 
mask
);

72 
	}
}

90 
	$__vfs_£tx©Œ_nİ”m
(
d’Œy
 *d’Œy, cÚ¡ *
Çme
,

91 cÚ¡ *
v®ue
, 
size_t
 
size
, 
æags
)

93 
šode
 *šodğ
d’Œy
->
d_šode
;

94 
”rÜ
 = -
EOPNOTSUPP
;

95 
is£c
 = !
	`¡ºcmp
(
Çme
, 
XATTR_SECURITY_PREFIX
,

96 
XATTR_SECURITY_PREFIX_LEN
);

98 ià(
is£c
)

99 
šode
->
i_æags
 &ğ~
S_NOSEC
;

100 ià(
šode
->
i_İ
->
£tx©Œ
) {

101 
”rÜ
 = 
šode
->
i_İ
->
	`£tx©Œ
(
d’Œy
, 
Çme
, 
v®ue
, 
size
, 
æags
);

102 ià(!
”rÜ
) {

103 
	`f¢Ùify_x©Œ
(
d’Œy
);

104 
	`£cur™y_šode_po¡_£tx©Œ
(
d’Œy
, 
Çme
, 
v®ue
,

105 
size
, 
æags
);

107 } ià(
is£c
) {

108 cÚ¡ *
suffix
 = 
Çme
 + 
XATTR_SECURITY_PREFIX_LEN
;

109 
”rÜ
 = 
	`£cur™y_šode_£t£cur™y
(
šode
, 
suffix
, 
v®ue
,

110 
size
, 
æags
);

111 ià(!
”rÜ
)

112 
	`f¢Ùify_x©Œ
(
d’Œy
);

115  
”rÜ
;

116 
	}
}

120 
	$vfs_£tx©Œ
(
d’Œy
 *d’Œy, cÚ¡ *
Çme
, cÚ¡ *
v®ue
,

121 
size_t
 
size
, 
æags
)

123 
šode
 *šodğ
d’Œy
->
d_šode
;

124 
”rÜ
;

126 
”rÜ
 = 
	`x©Œ_³rmissiÚ
(
šode
, 
Çme
, 
MAY_WRITE
);

127 ià(
”rÜ
)

128  
”rÜ
;

130 
	`mu‹x_lock
(&
šode
->
i_mu‹x
);

131 
”rÜ
 = 
	`£cur™y_šode_£tx©Œ
(
d’Œy
, 
Çme
, 
v®ue
, 
size
, 
æags
);

132 ià(
”rÜ
)

133 
out
;

135 
”rÜ
 = 
	`__vfs_£tx©Œ_nİ”m
(
d’Œy
, 
Çme
, 
v®ue
, 
size
, 
æags
);

137 
out
:

138 
	`mu‹x_uÆock
(&
šode
->
i_mu‹x
);

139  
”rÜ
;

140 
	}
}

141 
EXPORT_SYMBOL_GPL
(
vfs_£tx©Œ
);

143 
ssize_t


144 
	$x©Œ_g‘£cur™y
(
šode
 *šode, cÚ¡ *
Çme
, *
v®ue
,

145 
size_t
 
size
)

147 *
bufãr
 = 
NULL
;

148 
ssize_t
 
Ën
;

150 ià(!
v®ue
 || !
size
) {

151 
Ën
 = 
	`£cur™y_šode_g‘£cur™y
(
šode
, 
Çme
, &
bufãr
, 
çl£
);

152 
out_nßÎoc
;

155 
Ën
 = 
	`£cur™y_šode_g‘£cur™y
(
šode
, 
Çme
, &
bufãr
, 
Œue
);

156 ià(
Ën
 < 0)

157  
Ën
;

158 ià(
size
 < 
Ën
) {

159 
Ën
 = -
ERANGE
;

160 
out
;

162 
	`memıy
(
v®ue
, 
bufãr
, 
Ën
);

163 
out
:

164 
	`£cur™y_»Ëa£_£cùx
(
bufãr
, 
Ën
);

165 
out_nßÎoc
:

166  
Ën
;

167 
	}
}

168 
EXPORT_SYMBOL_GPL
(
x©Œ_g‘£cur™y
);

178 
ssize_t


179 
	$vfs_g‘x©Œ_®loc
(
d’Œy
 *d’Œy, cÚ¡ *
Çme
, **
x©Œ_v®ue
,

180 
size_t
 
x©Œ_size
, 
gå_t
 
æags
)

182 
šode
 *šodğ
d’Œy
->
d_šode
;

183 *
v®ue
 = *
x©Œ_v®ue
;

184 
”rÜ
;

186 
”rÜ
 = 
	`x©Œ_³rmissiÚ
(
šode
, 
Çme
, 
MAY_READ
);

187 ià(
”rÜ
)

188  
”rÜ
;

190 ià(!
šode
->
i_İ
->
g‘x©Œ
)

191  -
EOPNOTSUPP
;

193 
”rÜ
 = 
šode
->
i_İ
->
	`g‘x©Œ
(
d’Œy
, 
Çme
, 
NULL
, 0);

194 ià(
”rÜ
 < 0)

195  
”rÜ
;

197 ià(!
v®ue
 || (
”rÜ
 > 
x©Œ_size
)) {

198 
v®ue
 = 
	`k»®loc
(*
x©Œ_v®ue
, 
”rÜ
 + 1, 
æags
);

199 ià(!
v®ue
)

200  -
ENOMEM
;

201 
	`mem£t
(
v®ue
, 0, 
”rÜ
 + 1);

204 
”rÜ
 = 
šode
->
i_İ
->
	`g‘x©Œ
(
d’Œy
, 
Çme
, 
v®ue
,ƒrror);

205 *
x©Œ_v®ue
 = 
v®ue
;

206  
”rÜ
;

207 
	}
}

210 
	$vfs_x©Œ_cmp
(
d’Œy
 *d’Œy, cÚ¡ *
x©Œ_Çme
,

211 cÚ¡ *
v®ue
, 
size_t
 
size
, 
gå_t
 
æags
)

213 *
x©Œ_v®ue
 = 
NULL
;

214 
rc
;

216 
rc
 = 
	`vfs_g‘x©Œ_®loc
(
d’Œy
, 
x©Œ_Çme
, &
x©Œ_v®ue
, 0, 
æags
);

217 ià(
rc
 < 0)

218  
rc
;

220 ià((
rc
 !ğ
size
è|| (
	`memcmp
(
x©Œ_v®ue
, 
v®ue
,„c) != 0))

221 
rc
 = -
EINVAL
;

223 
rc
 = 0;

224 
	`kä“
(
x©Œ_v®ue
);

225  
rc
;

226 
	}
}

228 
ssize_t


229 
	$vfs_g‘x©Œ
(
d’Œy
 *d’Œy, cÚ¡ *
Çme
, *
v®ue
, 
size_t
 
size
)

231 
šode
 *šodğ
d’Œy
->
d_šode
;

232 
”rÜ
;

234 
”rÜ
 = 
	`x©Œ_³rmissiÚ
(
šode
, 
Çme
, 
MAY_READ
);

235 ià(
”rÜ
)

236  
”rÜ
;

238 
”rÜ
 = 
	`£cur™y_šode_g‘x©Œ
(
d’Œy
, 
Çme
);

239 ià(
”rÜ
)

240  
”rÜ
;

242 ià(!
	`¡ºcmp
(
Çme
, 
XATTR_SECURITY_PREFIX
,

243 
XATTR_SECURITY_PREFIX_LEN
)) {

244 cÚ¡ *
suffix
 = 
Çme
 + 
XATTR_SECURITY_PREFIX_LEN
;

245 
»t
 = 
	`x©Œ_g‘£cur™y
(
šode
, 
suffix
, 
v®ue
, 
size
);

250 ià(
»t
 =ğ-
EOPNOTSUPP
)

251 
nŞsm
;

252  
»t
;

254 
nŞsm
:

255 ià(
šode
->
i_İ
->
g‘x©Œ
)

256 
”rÜ
 = 
šode
->
i_İ
->
	`g‘x©Œ
(
d’Œy
, 
Çme
, 
v®ue
, 
size
);

258 
”rÜ
 = -
EOPNOTSUPP
;

260  
”rÜ
;

261 
	}
}

262 
EXPORT_SYMBOL_GPL
(
vfs_g‘x©Œ
);

264 
ssize_t


265 
	$vfs_li¡x©Œ
(
d’Œy
 *
d
, *
li¡
, 
size_t
 
size
)

267 
ssize_t
 
”rÜ
;

269 
”rÜ
 = 
	`£cur™y_šode_li¡x©Œ
(
d
);

270 ià(
”rÜ
)

271  
”rÜ
;

272 
”rÜ
 = -
EOPNOTSUPP
;

273 ià(
d
->
d_šode
->
i_İ
->
li¡x©Œ
) {

274 
”rÜ
 = 
d
->
d_šode
->
i_İ
->
	`li¡x©Œ
(d, 
li¡
, 
size
);

276 
”rÜ
 = 
	`£cur™y_šode_li¡£cur™y
(
d
->
d_šode
, 
li¡
, 
size
);

277 ià(
size
 && 
”rÜ
 > size)

278 
”rÜ
 = -
ERANGE
;

280  
”rÜ
;

281 
	}
}

282 
EXPORT_SYMBOL_GPL
(
vfs_li¡x©Œ
);

285 
	$vfs_»movex©Œ
(
d’Œy
 *d’Œy, cÚ¡ *
Çme
)

287 
šode
 *šodğ
d’Œy
->
d_šode
;

288 
”rÜ
;

290 ià(!
šode
->
i_İ
->
»movex©Œ
)

291  -
EOPNOTSUPP
;

293 
”rÜ
 = 
	`x©Œ_³rmissiÚ
(
šode
, 
Çme
, 
MAY_WRITE
);

294 ià(
”rÜ
)

295  
”rÜ
;

297 
”rÜ
 = 
	`£cur™y_šode_»movex©Œ
(
d’Œy
, 
Çme
);

298 ià(
”rÜ
)

299  
”rÜ
;

301 
	`mu‹x_lock
(&
šode
->
i_mu‹x
);

302 
”rÜ
 = 
šode
->
i_İ
->
	`»movex©Œ
(
d’Œy
, 
Çme
);

303 
	`mu‹x_uÆock
(&
šode
->
i_mu‹x
);

305 ià(!
”rÜ
) {

306 
	`f¢Ùify_x©Œ
(
d’Œy
);

307 
	`evm_šode_po¡_»movex©Œ
(
d’Œy
, 
Çme
);

309  
”rÜ
;

310 
	}
}

311 
EXPORT_SYMBOL_GPL
(
vfs_»movex©Œ
);

318 
	$£tx©Œ
(
d’Œy
 *
d
, cÚ¡ 
__u£r
 *
Çme
, cÚ¡ __u£¸*
v®ue
,

319 
size_t
 
size
, 
æags
)

321 
”rÜ
;

322 *
kv®ue
 = 
NULL
;

323 
kÇme
[
XATTR_NAME_MAX
 + 1];

325 ià(
æags
 & ~(
XATTR_CREATE
|
XATTR_REPLACE
))

326  -
EINVAL
;

328 
”rÜ
 = 
	`¡ºıy_äom_u£r
(
kÇme
, 
Çme
, (kname));

329 ià(
”rÜ
 =ğ0 ||ƒ¼Ü =ğ(
kÇme
))

330 
”rÜ
 = -
ERANGE
;

331 ià(
”rÜ
 < 0)

332  
”rÜ
;

334 ià(
size
) {

335 ià(
size
 > 
XATTR_SIZE_MAX
)

336  -
E2BIG
;

337 
kv®ue
 = 
	`memdup_u£r
(
v®ue
, 
size
);

338 ià(
	`IS_ERR
(
kv®ue
))

339  
	`PTR_ERR
(
kv®ue
);

342 
”rÜ
 = 
	`vfs_£tx©Œ
(
d
, 
kÇme
, 
kv®ue
, 
size
, 
æags
);

343 
	`kä“
(
kv®ue
);

344  
”rÜ
;

345 
	}
}

347 
	$SYSCALL_DEFINE5
(
£tx©Œ
, cÚ¡ 
__u£r
 *, 
·thÇme
,

348 cÚ¡ 
__u£r
 *, 
Çme
, cÚ¡ __u£¸*, 
v®ue
,

349 
size_t
, 
size
, , 
æags
)

351 
·th
…ath;

352 
”rÜ
;

354 
”rÜ
 = 
	`u£r_·th
(
·thÇme
, &
·th
);

355 ià(
”rÜ
)

356  
”rÜ
;

357 
”rÜ
 = 
	`mÁ_wªt_wr™e
(
·th
.
mÁ
);

358 ià(!
”rÜ
) {

359 
”rÜ
 = 
	`£tx©Œ
(
·th
.
d’Œy
, 
Çme
, 
v®ue
, 
size
, 
æags
);

360 
	`mÁ_drİ_wr™e
(
·th
.
mÁ
);

362 
	`·th_put
(&
·th
);

363  
”rÜ
;

364 
	}
}

366 
	$SYSCALL_DEFINE5
(
l£tx©Œ
, cÚ¡ 
__u£r
 *, 
·thÇme
,

367 cÚ¡ 
__u£r
 *, 
Çme
, cÚ¡ __u£¸*, 
v®ue
,

368 
size_t
, 
size
, , 
æags
)

370 
·th
…ath;

371 
”rÜ
;

373 
”rÜ
 = 
	`u£r_Í©h
(
·thÇme
, &
·th
);

374 ià(
”rÜ
)

375  
”rÜ
;

376 
”rÜ
 = 
	`mÁ_wªt_wr™e
(
·th
.
mÁ
);

377 ià(!
”rÜ
) {

378 
”rÜ
 = 
	`£tx©Œ
(
·th
.
d’Œy
, 
Çme
, 
v®ue
, 
size
, 
æags
);

379 
	`mÁ_drİ_wr™e
(
·th
.
mÁ
);

381 
	`·th_put
(&
·th
);

382  
”rÜ
;

383 
	}
}

385 
	$SYSCALL_DEFINE5
(
f£tx©Œ
, , 
fd
, cÚ¡ 
__u£r
 *, 
Çme
,

386 cÚ¡ 
__u£r
 *,
v®ue
, 
size_t
, 
size
, , 
æags
)

388 
fe
 *
f
;

389 
d’Œy
 *dentry;

390 
”rÜ
 = -
EBADF
;

392 
f
 = 
	`fg‘
(
fd
);

393 ià(!
f
)

394  
”rÜ
;

395 
d’Œy
 = 
f
->
f_·th
.dentry;

396 
	`aud™_šode
(
NULL
, 
d’Œy
);

397 
”rÜ
 = 
	`mÁ_wªt_wr™e_fe
(
f
);

398 ià(!
”rÜ
) {

399 
”rÜ
 = 
	`£tx©Œ
(
d’Œy
, 
Çme
, 
v®ue
, 
size
, 
æags
);

400 
	`mÁ_drİ_wr™e
(
f
->
f_·th
.
mÁ
);

402 
	`åut
(
f
);

403  
”rÜ
;

404 
	}
}

409 
ssize_t


410 
	$g‘x©Œ
(
d’Œy
 *
d
, cÚ¡ 
__u£r
 *
Çme
, __u£¸*
v®ue
,

411 
size_t
 
size
)

413 
ssize_t
 
”rÜ
;

414 *
kv®ue
 = 
NULL
;

415 
kÇme
[
XATTR_NAME_MAX
 + 1];

417 
”rÜ
 = 
	`¡ºıy_äom_u£r
(
kÇme
, 
Çme
, (kname));

418 ià(
”rÜ
 =ğ0 ||ƒ¼Ü =ğ(
kÇme
))

419 
”rÜ
 = -
ERANGE
;

420 ià(
”rÜ
 < 0)

421  
”rÜ
;

423 ià(
size
) {

424 ià(
size
 > 
XATTR_SIZE_MAX
)

425 
size
 = 
XATTR_SIZE_MAX
;

426 
kv®ue
 = 
	`kz®loc
(
size
, 
GFP_KERNEL
);

427 ià(!
kv®ue
)

428  -
ENOMEM
;

431 
”rÜ
 = 
	`vfs_g‘x©Œ
(
d
, 
kÇme
, 
kv®ue
, 
size
);

432 ià(
”rÜ
 > 0) {

433 ià(
size
 && 
	`cİy_to_u£r
(
v®ue
, 
kv®ue
, 
”rÜ
))

434 
”rÜ
 = -
EFAULT
;

435 } ià(
”rÜ
 =ğ-
ERANGE
 && 
size
 >ğ
XATTR_SIZE_MAX
) {

438 
”rÜ
 = -
E2BIG
;

440 
	`kä“
(
kv®ue
);

441  
”rÜ
;

442 
	}
}

444 
	$SYSCALL_DEFINE4
(
g‘x©Œ
, cÚ¡ 
__u£r
 *, 
·thÇme
,

445 cÚ¡ 
__u£r
 *, 
Çme
, __u£¸*, 
v®ue
, 
size_t
, 
size
)

447 
·th
…ath;

448 
ssize_t
 
”rÜ
;

450 
”rÜ
 = 
	`u£r_·th
(
·thÇme
, &
·th
);

451 ià(
”rÜ
)

452  
”rÜ
;

453 
”rÜ
 = 
	`g‘x©Œ
(
·th
.
d’Œy
, 
Çme
, 
v®ue
, 
size
);

454 
	`·th_put
(&
·th
);

455  
”rÜ
;

456 
	}
}

458 
	$SYSCALL_DEFINE4
(
lg‘x©Œ
, cÚ¡ 
__u£r
 *, 
·thÇme
,

459 cÚ¡ 
__u£r
 *, 
Çme
, __u£¸*, 
v®ue
, 
size_t
, 
size
)

461 
·th
…ath;

462 
ssize_t
 
”rÜ
;

464 
”rÜ
 = 
	`u£r_Í©h
(
·thÇme
, &
·th
);

465 ià(
”rÜ
)

466  
”rÜ
;

467 
”rÜ
 = 
	`g‘x©Œ
(
·th
.
d’Œy
, 
Çme
, 
v®ue
, 
size
);

468 
	`·th_put
(&
·th
);

469  
”rÜ
;

470 
	}
}

472 
	$SYSCALL_DEFINE4
(
fg‘x©Œ
, , 
fd
, cÚ¡ 
__u£r
 *, 
Çme
,

473 
__u£r
 *, 
v®ue
, 
size_t
, 
size
)

475 
fe
 *
f
;

476 
ssize_t
 
”rÜ
 = -
EBADF
;

478 
f
 = 
	`fg‘
(
fd
);

479 ià(!
f
)

480  
”rÜ
;

481 
	`aud™_šode
(
NULL
, 
f
->
f_·th
.
d’Œy
);

482 
”rÜ
 = 
	`g‘x©Œ
(
f
->
f_·th
.
d’Œy
, 
Çme
, 
v®ue
, 
size
);

483 
	`åut
(
f
);

484  
”rÜ
;

485 
	}
}

490 
ssize_t


491 
	$li¡x©Œ
(
d’Œy
 *
d
, 
__u£r
 *
li¡
, 
size_t
 
size
)

493 
ssize_t
 
”rÜ
;

494 *
kli¡
 = 
NULL
;

496 ià(
size
) {

497 ià(
size
 > 
XATTR_LIST_MAX
)

498 
size
 = 
XATTR_LIST_MAX
;

499 
kli¡
 = 
	`km®loc
(
size
, 
GFP_KERNEL
);

500 ià(!
kli¡
)

501  -
ENOMEM
;

504 
”rÜ
 = 
	`vfs_li¡x©Œ
(
d
, 
kli¡
, 
size
);

505 ià(
”rÜ
 > 0) {

506 ià(
size
 && 
	`cİy_to_u£r
(
li¡
, 
kli¡
, 
”rÜ
))

507 
”rÜ
 = -
EFAULT
;

508 } ià(
”rÜ
 =ğ-
ERANGE
 && 
size
 >ğ
XATTR_LIST_MAX
) {

511 
”rÜ
 = -
E2BIG
;

513 
	`kä“
(
kli¡
);

514  
”rÜ
;

515 
	}
}

517 
	$SYSCALL_DEFINE3
(
li¡x©Œ
, cÚ¡ 
__u£r
 *, 
·thÇme
, __u£¸*, 
li¡
,

518 
size_t
, 
size
)

520 
·th
…ath;

521 
ssize_t
 
”rÜ
;

523 
”rÜ
 = 
	`u£r_·th
(
·thÇme
, &
·th
);

524 ià(
”rÜ
)

525  
”rÜ
;

526 
”rÜ
 = 
	`li¡x©Œ
(
·th
.
d’Œy
, 
li¡
, 
size
);

527 
	`·th_put
(&
·th
);

528  
”rÜ
;

529 
	}
}

531 
	$SYSCALL_DEFINE3
(
Îi¡x©Œ
, cÚ¡ 
__u£r
 *, 
·thÇme
, __u£¸*, 
li¡
,

532 
size_t
, 
size
)

534 
·th
…ath;

535 
ssize_t
 
”rÜ
;

537 
”rÜ
 = 
	`u£r_Í©h
(
·thÇme
, &
·th
);

538 ià(
”rÜ
)

539  
”rÜ
;

540 
”rÜ
 = 
	`li¡x©Œ
(
·th
.
d’Œy
, 
li¡
, 
size
);

541 
	`·th_put
(&
·th
);

542  
”rÜ
;

543 
	}
}

545 
	$SYSCALL_DEFINE3
(
æi¡x©Œ
, , 
fd
, 
__u£r
 *, 
li¡
, 
size_t
, 
size
)

547 
fe
 *
f
;

548 
ssize_t
 
”rÜ
 = -
EBADF
;

550 
f
 = 
	`fg‘
(
fd
);

551 ià(!
f
)

552  
”rÜ
;

553 
	`aud™_šode
(
NULL
, 
f
->
f_·th
.
d’Œy
);

554 
”rÜ
 = 
	`li¡x©Œ
(
f
->
f_·th
.
d’Œy
, 
li¡
, 
size
);

555 
	`åut
(
f
);

556  
”rÜ
;

557 
	}
}

563 
	$»movex©Œ
(
d’Œy
 *
d
, cÚ¡ 
__u£r
 *
Çme
)

565 
”rÜ
;

566 
kÇme
[
XATTR_NAME_MAX
 + 1];

568 
”rÜ
 = 
	`¡ºıy_äom_u£r
(
kÇme
, 
Çme
, (kname));

569 ià(
”rÜ
 =ğ0 ||ƒ¼Ü =ğ(
kÇme
))

570 
”rÜ
 = -
ERANGE
;

571 ià(
”rÜ
 < 0)

572  
”rÜ
;

574  
	`vfs_»movex©Œ
(
d
, 
kÇme
);

575 
	}
}

577 
	$SYSCALL_DEFINE2
(
»movex©Œ
, cÚ¡ 
__u£r
 *, 
·thÇme
,

578 cÚ¡ 
__u£r
 *, 
Çme
)

580 
·th
…ath;

581 
”rÜ
;

583 
”rÜ
 = 
	`u£r_·th
(
·thÇme
, &
·th
);

584 ià(
”rÜ
)

585  
”rÜ
;

586 
”rÜ
 = 
	`mÁ_wªt_wr™e
(
·th
.
mÁ
);

587 ià(!
”rÜ
) {

588 
”rÜ
 = 
	`»movex©Œ
(
·th
.
d’Œy
, 
Çme
);

589 
	`mÁ_drİ_wr™e
(
·th
.
mÁ
);

591 
	`·th_put
(&
·th
);

592  
”rÜ
;

593 
	}
}

595 
	$SYSCALL_DEFINE2
(
Ìemovex©Œ
, cÚ¡ 
__u£r
 *, 
·thÇme
,

596 cÚ¡ 
__u£r
 *, 
Çme
)

598 
·th
…ath;

599 
”rÜ
;

601 
”rÜ
 = 
	`u£r_Í©h
(
·thÇme
, &
·th
);

602 ià(
”rÜ
)

603  
”rÜ
;

604 
”rÜ
 = 
	`mÁ_wªt_wr™e
(
·th
.
mÁ
);

605 ià(!
”rÜ
) {

606 
”rÜ
 = 
	`»movex©Œ
(
·th
.
d’Œy
, 
Çme
);

607 
	`mÁ_drİ_wr™e
(
·th
.
mÁ
);

609 
	`·th_put
(&
·th
);

610  
”rÜ
;

611 
	}
}

613 
	$SYSCALL_DEFINE2
(
äemovex©Œ
, , 
fd
, cÚ¡ 
__u£r
 *, 
Çme
)

615 
fe
 *
f
;

616 
d’Œy
 *dentry;

617 
”rÜ
 = -
EBADF
;

619 
f
 = 
	`fg‘
(
fd
);

620 ià(!
f
)

621  
”rÜ
;

622 
d’Œy
 = 
f
->
f_·th
.dentry;

623 
	`aud™_šode
(
NULL
, 
d’Œy
);

624 
”rÜ
 = 
	`mÁ_wªt_wr™e_fe
(
f
);

625 ià(!
”rÜ
) {

626 
”rÜ
 = 
	`»movex©Œ
(
d’Œy
, 
Çme
);

627 
	`mÁ_drİ_wr™e
(
f
->
f_·th
.
mÁ
);

629 
	`åut
(
f
);

630  
”rÜ
;

631 
	}
}

635 
	$¡rcmp_´efix
(cÚ¡ *
a
, cÚ¡ *
a_´efix
)

637 *
a_´efix
 && *
a
 == *a_prefix) {

638 
a
++;

639 
a_´efix
++;

641  *
a_´efix
 ? 
NULL
 : 
a
;

642 
	}
}

653 
	#fÜ_—ch_x©Œ_hªdËr
(
hªdËrs
, 
hªdËr
) \

654 (
hªdËr
èğ*(
hªdËrs
)++; \

655 (
hªdËr
è!ğ
NULL
; \

656 (
hªdËr
èğ*(
hªdËrs
)++)

	)

661 cÚ¡ 
x©Œ_hªdËr
 *

662 
	$x©Œ_»sŞve_Çme
(cÚ¡ 
x©Œ_hªdËr
 **
hªdËrs
, cÚ¡ **
Çme
)

664 cÚ¡ 
x©Œ_hªdËr
 *
hªdËr
;

666 ià(!*
Çme
)

667  
NULL
;

669 
	`fÜ_—ch_x©Œ_hªdËr
(
hªdËrs
, 
hªdËr
) {

670 cÚ¡ *
n
 = 
	`¡rcmp_´efix
(*
Çme
, 
hªdËr
->
´efix
);

671 ià(
n
) {

672 *
Çme
 = 
n
;

676  
hªdËr
;

677 
	}
}

682 
ssize_t


683 
	$g’”ic_g‘x©Œ
(
d’Œy
 *d’Œy, cÚ¡ *
Çme
, *
bufãr
, 
size_t
 
size
)

685 cÚ¡ 
x©Œ_hªdËr
 *
hªdËr
;

687 
hªdËr
 = 
	`x©Œ_»sŞve_Çme
(
d’Œy
->
d_sb
->
s_x©Œ
, &
Çme
);

688 ià(!
hªdËr
)

689  -
EOPNOTSUPP
;

690  
hªdËr
->
	`g‘
(
d’Œy
, 
Çme
, 
bufãr
, 
size
, hªdËr->
æags
);

691 
	}
}

697 
ssize_t


698 
	$g’”ic_li¡x©Œ
(
d’Œy
 *d’Œy, *
bufãr
, 
size_t
 
bufãr_size
)

700 cÚ¡ 
x©Œ_hªdËr
 *
hªdËr
, **
hªdËrs
 = 
d’Œy
->
d_sb
->
s_x©Œ
;

701 
size
 = 0;

703 ià(!
bufãr
) {

704 
	`fÜ_—ch_x©Œ_hªdËr
(
hªdËrs
, 
hªdËr
) {

705 
size
 +ğ
hªdËr
->
	`li¡
(
d’Œy
, 
NULL
, 0, NULL, 0,

706 
hªdËr
->
æags
);

709 *
buf
 = 
bufãr
;

711 
	`fÜ_—ch_x©Œ_hªdËr
(
hªdËrs
, 
hªdËr
) {

712 
size
 = 
hªdËr
->
	`li¡
(
d’Œy
, 
buf
, 
bufãr_size
,

713 
NULL
, 0, 
hªdËr
->
æags
);

714 ià(
size
 > 
bufãr_size
)

715  -
ERANGE
;

716 
buf
 +ğ
size
;

717 
bufãr_size
 -ğ
size
;

719 
size
 = 
buf
 - 
bufãr
;

721  
size
;

722 
	}
}

728 
	$g’”ic_£tx©Œ
(
d’Œy
 *d’Œy, cÚ¡ *
Çme
, cÚ¡ *
v®ue
, 
size_t
 
size
, 
æags
)

730 cÚ¡ 
x©Œ_hªdËr
 *
hªdËr
;

732 ià(
size
 == 0)

733 
v®ue
 = "";

734 
hªdËr
 = 
	`x©Œ_»sŞve_Çme
(
d’Œy
->
d_sb
->
s_x©Œ
, &
Çme
);

735 ià(!
hªdËr
)

736  -
EOPNOTSUPP
;

737  
hªdËr
->
	`£t
(
d’Œy
, 
Çme
, 
v®ue
, 
size
, 
æags
, handler->flags);

738 
	}
}

745 
	$g’”ic_»movex©Œ
(
d’Œy
 *d’Œy, cÚ¡ *
Çme
)

747 cÚ¡ 
x©Œ_hªdËr
 *
hªdËr
;

749 
hªdËr
 = 
	`x©Œ_»sŞve_Çme
(
d’Œy
->
d_sb
->
s_x©Œ
, &
Çme
);

750 ià(!
hªdËr
)

751  -
EOPNOTSUPP
;

752  
hªdËr
->
	`£t
(
d’Œy
, 
Çme
, 
NULL
, 0,

753 
XATTR_REPLACE
, 
hªdËr
->
æags
);

754 
	}
}

756 
EXPORT_SYMBOL
(
g’”ic_g‘x©Œ
);

757 
EXPORT_SYMBOL
(
g’”ic_li¡x©Œ
);

758 
EXPORT_SYMBOL
(
g’”ic_£tx©Œ
);

759 
EXPORT_SYMBOL
(
g’”ic_»movex©Œ
);

	@xattr_acl.c

8 
	~<lšux/moduË.h
>

9 
	~<lšux/fs.h
>

10 
	~<lšux/posix_aş_x©Œ.h
>

11 
	~<lšux/gå.h
>

17 
posix_aş
 *

18 
	$posix_aş_äom_x©Œ
(cÚ¡ *
v®ue
, 
size_t
 
size
)

20 
posix_aş_x©Œ_h—d”
 *
h—d”
 = (posix_aş_x©Œ_h—d” *)
v®ue
;

21 
posix_aş_x©Œ_’Œy
 *
’Œy
 = (posix_aş_x©Œ_’Œy *)(
h—d”
+1), *
’d
;

22 
couÁ
;

23 
posix_aş
 *
aş
;

24 
posix_aş_’Œy
 *
aş_e
;

26 ià(!
v®ue
)

27  
NULL
;

28 ià(
size
 < (
posix_aş_x©Œ_h—d”
))

29  
	`ERR_PTR
(-
EINVAL
);

30 ià(
h—d”
->
a_v”siÚ
 !ğ
	`ıu_to_Ë32
(
POSIX_ACL_XATTR_VERSION
))

31  
	`ERR_PTR
(-
EOPNOTSUPP
);

33 
couÁ
 = 
	`posix_aş_x©Œ_couÁ
(
size
);

34 ià(
couÁ
 < 0)

35  
	`ERR_PTR
(-
EINVAL
);

36 ià(
couÁ
 == 0)

37  
NULL
;

39 
aş
 = 
	`posix_aş_®loc
(
couÁ
, 
GFP_NOFS
);

40 ià(!
aş
)

41  
	`ERR_PTR
(-
ENOMEM
);

42 
aş_e
 = 
aş
->
a_’Œ›s
;

44 
’d
 = 
’Œy
 + 
couÁ
;ƒÁry !ğ’d; 
aş_e
++,ƒntry++) {

45 
aş_e
->
e_g
 = 
	`Ë16_to_ıu
(
’Œy
->e_tag);

46 
aş_e
->
e_³rm
 = 
	`Ë16_to_ıu
(
’Œy
->e_perm);

48 
aş_e
->
e_g
) {

49 
ACL_USER_OBJ
:

50 
ACL_GROUP_OBJ
:

51 
ACL_MASK
:

52 
ACL_OTHER
:

53 
aş_e
->
e_id
 = 
ACL_UNDEFINED_ID
;

56 
ACL_USER
:

57 
ACL_GROUP
:

58 
aş_e
->
e_id
 = 
	`Ë32_to_ıu
(
’Œy
->e_id);

62 
ç
;

65  
aş
;

67 
ç
:

68 
	`posix_aş_»Ëa£
(
aş
);

69  
	`ERR_PTR
(-
EINVAL
);

70 
	}
}

71 
EXPORT_SYMBOL
 (
posix_aş_äom_x©Œ
);

77 
	$posix_aş_to_x©Œ
(cÚ¡ 
posix_aş
 *
aş
, *
bufãr
, 
size_t
 
size
)

79 
posix_aş_x©Œ_h—d”
 *
ext_aş
 = (posix_aş_x©Œ_h—d” *)
bufãr
;

80 
posix_aş_x©Œ_’Œy
 *
ext_’Œy
 = 
ext_aş
->
a_’Œ›s
;

81 
»®_size
, 
n
;

83 
»®_size
 = 
	`posix_aş_x©Œ_size
(
aş
->
a_couÁ
);

84 ià(!
bufãr
)

85  
»®_size
;

86 ià(
»®_size
 > 
size
)

87  -
ERANGE
;

89 
ext_aş
->
a_v”siÚ
 = 
	`ıu_to_Ë32
(
POSIX_ACL_XATTR_VERSION
);

91 
n
=0;‚ < 
aş
->
a_couÁ
;‚++, 
ext_’Œy
++) {

92 
ext_’Œy
->
e_g
 = 
	`ıu_to_Ë16
(
aş
->
a_’Œ›s
[
n
].e_tag);

93 
ext_’Œy
->
e_³rm
 = 
	`ıu_to_Ë16
(
aş
->
a_’Œ›s
[
n
].e_perm);

94 
ext_’Œy
->
e_id
 = 
	`ıu_to_Ë32
(
aş
->
a_’Œ›s
[
n
].e_id);

96  
»®_size
;

97 
	}
}

98 
EXPORT_SYMBOL
 (
posix_aş_to_x©Œ
);

	@/usr/include/asm/byteorder.h

1 #iâdeà
_ASM_X86_BYTEORDER_H


2 
	#_ASM_X86_BYTEORDER_H


	)

4 
	~<lšux/by‹Üd”/l™e_’dŸn.h
>

	@/usr/include/asm/ioctls.h

1 
	~<asm-g’”ic/ioùls.h
>

	@/usr/include/asm/mman.h

1 #iâdeà
_ASM_X86_MMAN_H


2 
	#_ASM_X86_MMAN_H


	)

4 
	#MAP_32BIT
 0x40

	)

6 
	~<asm-g’”ic/mmª.h
>

	@/usr/include/asm/param.h

1 
	~<asm-g’”ic/·¿m.h
>

	@/usr/include/asm/poll.h

1 
	~<asm-g’”ic/pŞl.h
>

	@/usr/include/asm/siginfo.h

1 #iâdeà
_ASM_X86_SIGINFO_H


2 
	#_ASM_X86_SIGINFO_H


	)

4 #ifdeà
__x86_64__


5 
	#__ARCH_SI_PREAMBLE_SIZE
 (4 * ())

	)

8 
	~<asm-g’”ic/sigšfo.h
>

	@/usr/include/asm/unistd.h

1 #ifdeà
__i386__


2 
	~<asm/uni¡d_32.h
>

4 
	~<asm/uni¡d_64.h
>

	@/usr/include/linux/a.out.h

1 #iâdeà
__A_OUT_GNU_H__


2 
	#__A_OUT_GNU_H__


	)

4 
	#__GNU_EXEC_MACROS__


	)

6 #iâdeà
__STRUCT_EXEC_OVERRIDE__


8 
	~<asm/a.out.h
>

12 #iâdeà
__ASSEMBLY__


15 
	emachše_ty³
 {

16 #ià
defšed
 (
M_OLDSUN2
)

17 
	mM__OLDSUN2
 = 
M_OLDSUN2
,

19 
	mM_OLDSUN2
 = 0,

21 #ià
defšed
 (
M_68010
)

22 
	mM__68010
 = 
M_68010
,

24 
	mM_68010
 = 1,

26 #ià
defšed
 (
M_68020
)

27 
	mM__68020
 = 
M_68020
,

29 
	mM_68020
 = 2,

31 #ià
defšed
 (
M_SPARC
)

32 
	mM__SPARC
 = 
M_SPARC
,

34 
	mM_SPARC
 = 3,

37 
	mM_386
 = 100,

38 
	mM_MIPS1
 = 151,

39 
	mM_MIPS2
 = 152

42 #ià!
defšed
 (
N_MAGIC
)

43 
	#N_MAGIC
(
exec
è(Óxec).
a_šfo
 & 0xffff)

	)

45 
	#N_MACHTYPE
(
exec
è((
machše_ty³
)((Óxec).
a_šfo
 >> 16è& 0xff))

	)

46 
	#N_FLAGS
(
exec
è((Óxec).
a_šfo
 >> 24è& 0xff)

	)

47 
	#N_SET_INFO
(
exec
, 
magic
, 
ty³
, 
æags
) \

48 ((
exec
).
a_šfo
 = ((
magic
) & 0xffff) \

49 | ((()(
ty³
) & 0xff) << 16) \

50 | (((
æags
è& 0xffè<< 24))

	)

51 
	#N_SET_MAGIC
(
exec
, 
magic
) \

52 ((
exec
).
a_šfo
 = ((Óxec).a_šfØ& 0xffff0000è| ((
magic
è& 0xffff)))

	)

54 
	#N_SET_MACHTYPE
(
exec
, 
machty³
) \

55 ((
exec
).
a_šfo
 = \

56 ((
exec
).
a_šfo
&0xff00ffffè| (((()(
machty³
))&0xffè<< 16))

	)

58 
	#N_SET_FLAGS
(
exec
, 
æags
) \

59 ((
exec
).
a_šfo
 = \

60 ((
exec
).
a_šfo
&0x00ffffffè| (((
æags
è& 0xffè<< 24))

	)

63 
	#OMAGIC
 0407

	)

65 
	#NMAGIC
 0410

	)

67 
	#ZMAGIC
 0413

	)

70 
	#QMAGIC
 0314

	)

73 
	#CMAGIC
 0421

	)

75 #ià!
defšed
 (
N_BADMAG
)

76 
	#N_BADMAG
(
x
è(
	`N_MAGIC
(xè!ğ
OMAGIC
 \

77 && 
	`N_MAGIC
(
x
è!ğ
NMAGIC
 \

78 && 
	`N_MAGIC
(
x
è!ğ
ZMAGIC
 \

79 && 
	`N_MAGIC
(
x
è!ğ
QMAGIC
)

	)

82 
	#_N_HDROFF
(
x
è(1024 -  (
exec
))

	)

84 #ià!
defšed
 (
N_TXTOFF
)

85 
	#N_TXTOFF
(
x
) \

86 (
	`N_MAGIC
(
x
è=ğ
ZMAGIC
 ? 
	`_N_HDROFF
((x)è+  (
exec
) : \

87 (
	`N_MAGIC
(
x
è=ğ
QMAGIC
 ? 0 :  (
exec
)))

	)

90 #ià!
defšed
 (
N_DATOFF
)

91 
	#N_DATOFF
(
x
è(
	`N_TXTOFF
(xè+ (x).
a_‹xt
)

	)

94 #ià!
defšed
 (
N_TRELOFF
)

95 
	#N_TRELOFF
(
x
è(
	`N_DATOFF
(xè+ (x).
a_d©a
)

	)

98 #ià!
defšed
 (
N_DRELOFF
)

99 
	#N_DRELOFF
(
x
è(
	`N_TRELOFF
(xè+ 
	`N_TRSIZE
(x))

	)

102 #ià!
defšed
 (
N_SYMOFF
)

103 
	#N_SYMOFF
(
x
è(
	`N_DRELOFF
(xè+ 
	`N_DRSIZE
(x))

	)

106 #ià!
defšed
 (
N_STROFF
)

107 
	#N_STROFF
(
x
è(
	`N_SYMOFF
(xè+ 
	`N_SYMSIZE
(x))

	)

111 #ià!
defšed
 (
N_TXTADDR
)

112 
	#N_TXTADDR
(
x
è(
	`N_MAGIC
(xè=ğ
QMAGIC
 ? 
PAGE_SIZE
 : 0)

	)

118 #ià
defšed
(
vax
è|| defšed(
hp300
è|| defšed(
pyr
)

119 
	#SEGMENT_SIZE
 
·ge_size


	)

121 #ifdef 
sÚy


122 
	#SEGMENT_SIZE
 0x2000

	)

124 #ifdeà
is68k


125 
	#SEGMENT_SIZE
 0x20000

	)

127 #ià
defšed
(
m68k
è&& defšed(
PORTAR
)

128 
	#PAGE_SIZE
 0x400

	)

129 
	#SEGMENT_SIZE
 
PAGE_SIZE


	)

132 #ifdeà
lšux


133 
	~<uni¡d.h
>

134 #ià
defšed
(
__i386__
è|| defšed(
__mc68000__
)

135 
	#SEGMENT_SIZE
 1024

	)

137 #iâdeà
SEGMENT_SIZE


138 
	#SEGMENT_SIZE
 
	`g‘·gesize
()

	)

143 
	#_N_SEGMENT_ROUND
(
x
è
	`ALIGN
(x, 
SEGMENT_SIZE
)

	)

145 
	#_N_TXTENDADDR
(
x
è(
	`N_TXTADDR
(x)+(x).
a_‹xt
)

	)

147 #iâdeà
N_DATADDR


148 
	#N_DATADDR
(
x
) \

149 (
	`N_MAGIC
(
x
)==
OMAGIC
? (
	`_N_TXTENDADDR
(x)) \

150 : (
	`_N_SEGMENT_ROUND
 (
	`_N_TXTENDADDR
(
x
))))

	)

154 #ià!
defšed
 (
N_BSSADDR
)

155 
	#N_BSSADDR
(
x
è(
	`N_DATADDR
(xè+ (x).
a_d©a
)

	)

158 #ià!
defšed
 (
N_NLIST_DECLARED
)

159 
	sÆi¡
 {

161 *
	mn_Çme
;

162 
Æi¡
 *
	mn_Ãxt
;

163 
	mn_¡rx
;

164 } 
	mn_un
;

165 
	mn_ty³
;

166 
	mn_Ùh”
;

167 
	mn_desc
;

168 
	mn_v®ue
;

172 #ià!
defšed
 (
N_UNDF
)

173 
	#N_UNDF
 0

	)

175 #ià!
defšed
 (
N_ABS
)

176 
	#N_ABS
 2

	)

178 #ià!
defšed
 (
N_TEXT
)

179 
	#N_TEXT
 4

	)

181 #ià!
defšed
 (
N_DATA
)

182 
	#N_DATA
 6

	)

184 #ià!
defšed
 (
N_BSS
)

185 
	#N_BSS
 8

	)

187 #ià!
defšed
 (
N_FN
)

188 
	#N_FN
 15

	)

191 #ià!
defšed
 (
N_EXT
)

192 
	#N_EXT
 1

	)

194 #ià!
defšed
 (
N_TYPE
)

195 
	#N_TYPE
 036

	)

197 #ià!
defšed
 (
N_STAB
)

198 
	#N_STAB
 0340

	)

209 
	#N_INDR
 0xa

	)

223 
	#N_SETA
 0x14

	)

224 
	#N_SETT
 0x16

	)

225 
	#N_SETD
 0x18

	)

226 
	#N_SETB
 0x1A

	)

229 
	#N_SETV
 0x1C

	)

231 #ià!
defšed
 (
N_RELOCATION_INFO_DECLARED
)

237 
	s»loÿtiÚ_šfo


240 
	mr_add»ss
;

242 
	mr_symbŞnum
:24;

246 
	mr_pü–
:1;

249 
	mr_Ëngth
:2;

256 
	mr_ex‹º
:1;

259 #ifdeà
NS32K


260 
	mr_b¤
:1;

261 
	mr_di¥
:1;

262 
	mr_·d
:2;

264 
	mr_·d
:4;

	@/usr/include/linux/acct.h

15 #iâdeà
_LINUX_ACCT_H


16 
	#_LINUX_ACCT_H


	)

18 
	~<lšux/ty³s.h
>

20 
	~<asm/·¿m.h
>

21 
	~<asm/by‹Üd”.h
>

31 
__u16
 
	tcomp_t
;

32 
__u32
 
	tcomp2_t
;

41 
	#ACCT_COMM
 16

	)

43 
	sacù


45 
	mac_æag
;

46 
	mac_v”siÚ
;

48 
__u16
 
	mac_uid16
;

49 
__u16
 
	mac_gid16
;

50 
__u16
 
	mac_‰y
;

51 
__u32
 
	mac_btime
;

52 
comp_t
 
	mac_utime
;

53 
comp_t
 
	mac_¡ime
;

54 
comp_t
 
	mac_‘ime
;

55 
comp_t
 
	mac_mem
;

56 
comp_t
 
	mac_io
;

57 
comp_t
 
	mac_rw
;

58 
comp_t
 
	mac_mšæt
;

59 
comp_t
 
	mac_majæt
;

60 
comp_t
 
	mac_sw­s
;

62 
__u16
 
	mac_ahz
;

63 
__u32
 
	mac_ex™code
;

64 
	mac_comm
[
ACCT_COMM
 + 1];

65 
__u8
 
	mac_‘ime_hi
;

66 
__u16
 
	mac_‘ime_lo
;

67 
__u32
 
	mac_uid
;

68 
__u32
 
	mac_gid
;

71 
	sacù_v3


73 
	mac_æag
;

74 
	mac_v”siÚ
;

75 
__u16
 
	mac_‰y
;

76 
__u32
 
	mac_ex™code
;

77 
__u32
 
	mac_uid
;

78 
__u32
 
	mac_gid
;

79 
__u32
 
	mac_pid
;

80 
__u32
 
	mac_µid
;

81 
__u32
 
	mac_btime
;

82 
	mac_‘ime
;

83 
comp_t
 
	mac_utime
;

84 
comp_t
 
	mac_¡ime
;

85 
comp_t
 
	mac_mem
;

86 
comp_t
 
	mac_io
;

87 
comp_t
 
	mac_rw
;

88 
comp_t
 
	mac_mšæt
;

89 
comp_t
 
	mac_majæt
;

90 
comp_t
 
	mac_sw­s
;

91 
	mac_comm
[
ACCT_COMM
];

98 
	#AFORK
 0x01

	)

99 
	#ASU
 0x02

	)

100 
	#ACOMPAT
 0x04

	)

101 
	#ACORE
 0x08

	)

102 
	#AXSIG
 0x10

	)

104 #ifdeà
__BIG_ENDIAN


105 
	#ACCT_BYTEORDER
 0x80

	)

107 
	#ACCT_BYTEORDER
 0x00

	)

110 
	#ACCT_VERSION
 2

	)

111 
	#AHZ
 (
HZ
)

	)

	@/usr/include/linux/aio_abi.h

27 #iâdeà
__LINUX__AIO_ABI_H


28 
	#__LINUX__AIO_ABI_H


	)

30 
	~<lšux/ty³s.h
>

31 
	~<asm/by‹Üd”.h
>

33 
	taio_cÚ‹xt_t
;

36 
	mIOCB_CMD_PREAD
 = 0,

37 
	mIOCB_CMD_PWRITE
 = 1,

38 
	mIOCB_CMD_FSYNC
 = 2,

39 
	mIOCB_CMD_FDSYNC
 = 3,

44 
	mIOCB_CMD_NOOP
 = 6,

45 
	mIOCB_CMD_PREADV
 = 7,

46 
	mIOCB_CMD_PWRITEV
 = 8,

55 
	#IOCB_FLAG_RESFD
 (1 << 0)

	)

58 
	sio_ev’t
 {

59 
__u64
 
	md©a
;

60 
__u64
 
	mobj
;

61 
__s64
 
	m»s
;

62 
__s64
 
	m»s2
;

65 #ià
defšed
(
__LITTLE_ENDIAN
)

66 
	#PADDED
(
x
,
y
èx, 
	)
y

67 #–ià
defšed
(
__BIG_ENDIAN
)

68 
	#PADDED
(
x
,
y
èy, 
	)
x

70 #”rÜ 
ed™
 
your
 
odd
 
by‹Üd”
.

79 
	siocb
 {

81 
__u64
 
	maio_d©a
;

82 
__u32
 
PADDED
(
aio_key
, 
aio_»£rved1
);

86 
__u16
 
	maio_lio_İcode
;

87 
__s16
 
	maio_»q´io
;

88 
__u32
 
	maio_fdes
;

90 
__u64
 
	maio_buf
;

91 
__u64
 
	maio_nby‹s
;

92 
__s64
 
	maio_off£t
;

95 
__u64
 
	maio_»£rved2
;

98 
__u32
 
	maio_æags
;

104 
__u32
 
	maio_»sfd
;

107 #undeà
IFBIG


108 #undeà
IFLITTLE


	@/usr/include/linux/atalk.h

1 #iâdeà
__LINUX_ATALK_H__


2 
	#__LINUX_ATALK_H__


	)

4 
	~<lšux/ty³s.h
>

5 
	~<asm/by‹Üd”.h
>

6 
	~<lšux/sock‘.h
>

14 
	#ATPORT_FIRST
 1

	)

15 
	#ATPORT_RESERVED
 128

	)

16 
	#ATPORT_LAST
 254

	)

17 
	#ATADDR_ANYNET
 (
__u16
)0

	)

18 
	#ATADDR_ANYNODE
 (
__u8
)0

	)

19 
	#ATADDR_ANYPORT
 (
__u8
)0

	)

20 
	#ATADDR_BCAST
 (
__u8
)255

	)

21 
	#DDP_MAXSZ
 587

	)

22 
	#DDP_MAXHOPS
 15

	)

24 
	#SIOCATALKDIFADDR
 (
SIOCPROTOPRIVATE
 + 0)

	)

26 
	s©®k_addr
 {

27 
__be16
 
	ms_Ãt
;

28 
__u8
 
	ms_node
;

31 
	ssockaddr_©
 {

32 
__k”Ãl_§_çmy_t
 
	m§t_çmy
;

33 
__u8
 
	m§t_pÜt
;

34 
©®k_addr
 
	m§t_addr
;

35 
	m§t_z”o
[8];

38 
	s©®k_ÃŒªge
 {

39 
__u8
 
	mÄ_pha£
;

40 
__be16
 
	mÄ_fœ¡Ãt
;

41 
__be16
 
	mÄ_Ï¡Ãt
;

	@/usr/include/linux/atm.h

11 #iâdeà
_LINUX_ATM_H


12 
	#_LINUX_ATM_H


	)

20 
	~<lšux/©m­i.h
>

21 
	~<lšux/©m§p.h
>

22 
	~<lšux/©mioc.h
>

23 
	~<lšux/ty³s.h
>

27 
	#ATM_CELL_SIZE
 53

	)

28 
	#ATM_CELL_PAYLOAD
 48

	)

29 
	#ATM_AAL0_SDU
 52

	)

30 
	#ATM_MAX_AAL34_PDU
 65535

	)

31 
	#ATM_AAL5_TRAILER
 8

	)

32 
	#ATM_MAX_AAL5_PDU
 65535

	)

33 
	#ATM_MAX_CDV
 9999

	)

34 
	#ATM_NOT_RSV_VCI
 32

	)

36 
	#ATM_MAX_VPI
 255

	)

37 
	#ATM_MAX_VPI_NNI
 4096

	)

38 
	#ATM_MAX_VCI
 65535

	)

42 
	#ATM_NO_AAL
 0

	)

43 
	#ATM_AAL0
 13

	)

44 
	#ATM_AAL1
 1

	)

45 
	#ATM_AAL2
 2

	)

46 
	#ATM_AAL34
 3

	)

47 
	#ATM_AAL5
 5

	)

57 
	#__SO_ENCODE
(
l
,
n
,
t
) ((((l) & 0x1FF) << 22) | ((n) << 16) | \

58 (
t
))

	)

59 
	#__SO_LEVEL_MATCH
(
c
,
m
è(((cè>> 22è=ğ((mè& 0x1FF))

	)

60 
	#__SO_NUMBER
(
c
è(((cè>> 16è& 0x3f)

	)

61 
	#__SO_SIZE
(
c
è((cè& 0x3fff)

	)

67 
	#SO_SETCLP
 
	`__SO_ENCODE
(
SOL_ATM
,0,)

	)

69 
	#SO_CIRANGE
 
	`__SO_ENCODE
(
SOL_ATM
,1,
©m_cœªge
)

	)

72 
	#SO_ATMQOS
 
	`__SO_ENCODE
(
SOL_ATM
,2,
©m_qos
)

	)

74 
	#SO_ATMSAP
 
	`__SO_ENCODE
(
SOL_ATM
,3,
©m_§p
)

	)

76 
	#SO_ATMPVC
 
	`__SO_ENCODE
(
SOL_ATM
,4,
sockaddr_©mpvc
)

	)

78 
	#SO_MULTIPOINT
 
	`__SO_ENCODE
(
SOL_ATM
, 5, )

	)

93 
	#ATM_HDR_GFC_MASK
 0xf0000000

	)

94 
	#ATM_HDR_GFC_SHIFT
 28

	)

95 
	#ATM_HDR_VPI_MASK
 0x0ff00000

	)

96 
	#ATM_HDR_VPI_SHIFT
 20

	)

97 
	#ATM_HDR_VCI_MASK
 0x000ffff0

	)

98 
	#ATM_HDR_VCI_SHIFT
 4

	)

99 
	#ATM_HDR_PTI_MASK
 0x0000000e

	)

100 
	#ATM_HDR_PTI_SHIFT
 1

	)

101 
	#ATM_HDR_CLP
 0x00000001

	)

108 
	#ATM_PTI_US0
 0

	)

109 
	#ATM_PTI_US1
 1

	)

110 
	#ATM_PTI_UCES0
 2

	)

111 
	#ATM_PTI_UCES1
 3

	)

112 
	#ATM_PTI_SEGF5
 4

	)

113 
	#ATM_PTI_E2EF5
 5

	)

114 
	#ATM_PTI_RSV_RM
 6

	)

115 
	#ATM_PTI_RSV
 7

	)

126 
	#ATM_NONE
 0

	)

127 
	#ATM_UBR
 1

	)

128 
	#ATM_CBR
 2

	)

129 
	#ATM_VBR
 3

	)

130 
	#ATM_ABR
 4

	)

131 
	#ATM_ANYCLASS
 5

	)

133 
	#ATM_MAX_PCR
 -1

	)

135 
	s©m_Œaårm
 {

136 
	mŒaffic_şass
;

137 
	mmax_pü
;

138 
	mpü
;

139 
	mmš_pü
;

140 
	mmax_cdv
;

141 
	mmax_sdu
;

143 
	miü
;

144 
	mtbe
;

145 
	mä‰
 : 24;

146 
	mrif
 : 4;

147 
	mrdf
 : 4;

148 
	mÄm_´es
 :1;

149 
	mŒm_´es
 :1;

150 
	madtf_´es
 :1;

151 
	mcdf_´es
 :1;

152 
	mÄm
 :3;

153 
	mŒm
 :3;

154 
	madtf
 :10;

155 
	mcdf
 :3;

156 
	m¥¬e
 :9;

159 
	s©m_qos
 {

160 
©m_Œaårm
 
	mtx
;

161 
©m_Œaårm
 
rx
 
	m__ATM_API_ALIGN
;

163 
¯l
 
	m__ATM_API_ALIGN
;

168 
	#ATM_ITF_ANY
 -1

	)

169 
	#ATM_VPI_ANY
 -1

	)

170 
	#ATM_VCI_ANY
 -1

	)

171 
	#ATM_VPI_UNSPEC
 -2

	)

172 
	#ATM_VCI_UNSPEC
 -2

	)

175 
	ssockaddr_©mpvc
 {

176 
	m§p_çmy
;

178 
	m™f
;

179 
	mvpi
;

180 
	mvci
;

181 } 
§p_addr
 
	m__ATM_API_ALIGN
;

186 
	#ATM_ESA_LEN
 20

	)

187 
	#ATM_E164_LEN
 12

	)

189 
	#ATM_AFI_DCC
 0x39

	)

190 
	#ATM_AFI_ICD
 0x47

	)

191 
	#ATM_AFI_E164
 0x45

	)

192 
	#ATM_AFI_LOCAL
 0x49

	)

194 
	#ATM_AFI_DCC_GROUP
 0xBD

	)

195 
	#ATM_AFI_ICD_GROUP
 0xC5

	)

196 
	#ATM_AFI_E164_GROUP
 0xC3

	)

197 
	#ATM_AFI_LOCAL_GROUP
 0xC7

	)

199 
	#ATM_LIJ_NONE
 0

	)

200 
	#ATM_LIJ
 1

	)

201 
	#ATM_LIJ_RPJ
 2

	)

202 
	#ATM_LIJ_NJ
 3

	)

205 
	ssockaddr_©msvc
 {

206 
	m§s_çmy
;

208 
	m´v
[
ATM_ESA_LEN
];

209 
	mpub
[
ATM_E164_LEN
+1];

211 
	mlij_ty³
;

212 
__u32
 
	mlij_id
;

213 } 
§s_addr
 
	m__ATM_API_ALIGN
;

217 
__šlše__
 
	$©msvc_addr_š_u£
(
sockaddr_©msvc
 
addr
)

219  *
addr
.
§s_addr
.
´v
 || *addr.§s_addr.
pub
;

220 
	}
}

223 
__šlše__
 
	$©mpvc_addr_š_u£
(
sockaddr_©mpvc
 
addr
)

225  
addr
.
§p_addr
.
™f
 ||‡ddr.§p_addr.
vpi
 ||‡ddr.§p_addr.
vci
;

226 
	}
}

233 
	s©mif_sioc
 {

234 
	mnumb”
;

235 
	mËngth
;

236 *
	m¬g
;

240 
	t©m_back’d_t
;

	@/usr/include/linux/atm_tcp.h

7 #iâdeà
LINUX_ATM_TCP_H


8 
	#LINUX_ATM_TCP_H


	)

10 
	~<lšux/©m­i.h
>

11 
	~<lšux/©m.h
>

12 
	~<lšux/©mioc.h
>

13 
	~<lšux/ty³s.h
>

20 
	s©mtı_hdr
 {

21 
__u16
 
	mvpi
;

22 
__u16
 
	mvci
;

23 
__u32
 
	mËngth
;

30 
	#ATMTCP_HDR_MAGIC
 (~0è

	)

31 
	#ATMTCP_CTRL_OPEN
 1

	)

32 
	#ATMTCP_CTRL_CLOSE
 2

	)

34 
	s©mtı_cÚŒŞ
 {

35 
©mtı_hdr
 
	mhdr
;

36 
	mty³
;

37 
©m_k±r_t
 
	mvcc
;

38 
sockaddr_©mpvc
 
	maddr
;

39 
©m_qos
 
	mqos
;

40 
	m»suÉ
;

41 } 
	g__ATM_API_ALIGN
;

53 
	#SIOCSIFATMTCP
 
	`_IO
('a',
ATMIOC_ITF
è

	)

54 
	#ATMTCP_CREATE
 
	`_IO
('a',
ATMIOC_ITF
+14è

	)

56 
	#ATMTCP_REMOVE
 
	`_IO
('a',
ATMIOC_ITF
+15è

	)

	@/usr/include/linux/atmarp.h

6 #iâdeà
_LINUX_ATMARP_H


7 
	#_LINUX_ATMARP_H


	)

9 
	~<lšux/ty³s.h
>

10 
	~<lšux/©m­i.h
>

11 
	~<lšux/©mioc.h
>

14 
	#ATMARP_RETRY_DELAY
 30

	)

17 
	#ATMARP_MAX_UNRES_PACKETS
 5

	)

21 
	#ATMARPD_CTRL
 
	`_IO
('a',
ATMIOC_CLIP
+1è

	)

22 
	#ATMARP_MKIP
 
	`_IO
('a',
ATMIOC_CLIP
+2è

	)

23 
	#ATMARP_SETENTRY
 
	`_IO
('a',
ATMIOC_CLIP
+3è

	)

24 
	#ATMARP_ENCAP
 
	`_IO
('a',
ATMIOC_CLIP
+5è

	)

27 
	e©m¬p_ù¾_ty³
 {

28 
	maù_šv®id
,

29 
	maù_Ãed
,

30 
	maù_up
,

31 
	maù_down
,

32 
	maù_chªge


35 
	s©m¬p_ù¾
 {

36 
©m¬p_ù¾_ty³
 
	mty³
;

37 
	m™f_num
;

38 
__be32
 
	m
;

	@/usr/include/linux/atmclip.h

6 #iâdeà
LINUX_ATMCLIP_H


7 
	#LINUX_ATMCLIP_H


	)

9 
	~<lšux/sockios.h
>

10 
	~<lšux/©mioc.h
>

13 
	#RFC1483LLC_LEN
 8

	)

14 
	#RFC1626_MTU
 9180

	)

16 
	#CLIP_DEFAULT_IDLETIMER
 1200

	)

17 
	#CLIP_CHECK_INTERVAL
 10

	)

19 
	#SIOCMKCLIP
 
	`_IO
('a',
ATMIOC_CLIP
è

	)

	@/usr/include/linux/atmdev.h

6 #iâdeà
LINUX_ATMDEV_H


7 
	#LINUX_ATMDEV_H


	)

10 
	~<lšux/©m­i.h
>

11 
	~<lšux/©m.h
>

12 
	~<lšux/©mioc.h
>

15 
	#ESI_LEN
 6

	)

17 
	#ATM_OC3_PCR
 (155520000/270*260/8/53)

	)

22 
	#ATM_25_PCR
 ((25600000/8-8000)/54)

	)

24 
	#ATM_OC12_PCR
 (622080000/1080*1040/8/53)

	)

29 
	#ATM_DS3_PCR
 (8000*12)

	)

33 
	#__AAL_STAT_ITEMS
 \

34 
	`__HANDLE_ITEM
(
tx
); \

35 
	`__HANDLE_ITEM
(
tx_”r
); \

36 
	`__HANDLE_ITEM
(
rx
); \

37 
	`__HANDLE_ITEM
(
rx_”r
); \

38 
	`__HANDLE_ITEM
(
rx_drİ
);

	)

40 
	s©m_¯l_¡©s
 {

41 
	#__HANDLE_ITEM
(
i
è
	)
i

42 
	m__AAL_STAT_ITEMS


43 #undeà
__HANDLE_ITEM


47 
	s©m_dev_¡©s
 {

48 
©m_¯l_¡©s
 
	m¯l0
;

49 
©m_¯l_¡©s
 
	m¯l34
;

50 
©m_¯l_¡©s
 
	m¯l5
;

51 } 
	g__ATM_API_ALIGN
;

54 
	#ATM_GETLINKRATE
 
	`_IOW
('a',
ATMIOC_ITF
+1,
©mif_sioc
)

	)

56 
	#ATM_GETNAMES
 
	`_IOW
('a',
ATMIOC_ITF
+3,
©m_iobuf
)

	)

58 
	#ATM_GETTYPE
 
	`_IOW
('a',
ATMIOC_ITF
+4,
©mif_sioc
)

	)

60 
	#ATM_GETESI
 
	`_IOW
('a',
ATMIOC_ITF
+5,
©mif_sioc
)

	)

62 
	#ATM_GETADDR
 
	`_IOW
('a',
ATMIOC_ITF
+6,
©mif_sioc
)

	)

64 
	#ATM_RSTADDR
 
	`_IOW
('a',
ATMIOC_ITF
+7,
©mif_sioc
)

	)

66 
	#ATM_ADDADDR
 
	`_IOW
('a',
ATMIOC_ITF
+8,
©mif_sioc
)

	)

68 
	#ATM_DELADDR
 
	`_IOW
('a',
ATMIOC_ITF
+9,
©mif_sioc
)

	)

70 
	#ATM_GETCIRANGE
 
	`_IOW
('a',
ATMIOC_ITF
+10,
©mif_sioc
)

	)

72 
	#ATM_SETCIRANGE
 
	`_IOW
('a',
ATMIOC_ITF
+11,
©mif_sioc
)

	)

74 
	#ATM_SETESI
 
	`_IOW
('a',
ATMIOC_ITF
+12,
©mif_sioc
)

	)

76 
	#ATM_SETESIF
 
	`_IOW
('a',
ATMIOC_ITF
+13,
©mif_sioc
)

	)

78 
	#ATM_ADDLECSADDR
 
	`_IOW
('a', 
ATMIOC_ITF
+14, 
©mif_sioc
)

	)

80 
	#ATM_DELLECSADDR
 
	`_IOW
('a', 
ATMIOC_ITF
+15, 
©mif_sioc
)

	)

82 
	#ATM_GETLECSADDR
 
	`_IOW
('a', 
ATMIOC_ITF
+16, 
©mif_sioc
)

	)

85 
	#ATM_GETSTAT
 
	`_IOW
('a',
ATMIOC_SARCOM
+0,
©mif_sioc
)

	)

87 
	#ATM_GETSTATZ
 
	`_IOW
('a',
ATMIOC_SARCOM
+1,
©mif_sioc
)

	)

89 
	#ATM_GETLOOP
 
	`_IOW
('a',
ATMIOC_SARCOM
+2,
©mif_sioc
)

	)

91 
	#ATM_SETLOOP
 
	`_IOW
('a',
ATMIOC_SARCOM
+3,
©mif_sioc
)

	)

93 
	#ATM_QUERYLOOP
 
	`_IOW
('a',
ATMIOC_SARCOM
+4,
©mif_sioc
)

	)

95 
	#ATM_SETSC
 
	`_IOW
('a',
ATMIOC_SPECIAL
+1,)

	)

97 
	#ATM_SETBACKEND
 
	`_IOW
('a',
ATMIOC_SPECIAL
+2,
©m_back’d_t
)

	)

99 
	#ATM_NEWBACKENDIF
 
	`_IOW
('a',
ATMIOC_SPECIAL
+3,
©m_back’d_t
)

	)

101 
	#ATM_ADDPARTY
 
	`_IOW
('a', 
ATMIOC_SPECIAL
+4,
©m_iobuf
)

	)

103 #ifdeà
CONFIG_COMPAT


105 
	#COMPAT_ATM_ADDPARTY
 
	`_IOW
('a', 
ATMIOC_SPECIAL
+4,
com·t_©m_iobuf
)

	)

107 
	#ATM_DROPPARTY
 
	`_IOW
('a', 
ATMIOC_SPECIAL
+5,)

	)

115 
	#ATM_BACKEND_RAW
 0

	)

116 
	#ATM_BACKEND_PPP
 1

	)

117 
	#ATM_BACKEND_BR2684
 2

	)

120 
	#ATM_ITFTYP_LEN
 8

	)

127 
	#__ATM_LM_NONE
 0

	)

128 
	#__ATM_LM_AAL
 1

	)

129 
	#__ATM_LM_ATM
 2

	)

131 
	#__ATM_LM_PHY
 8

	)

132 
	#__ATM_LM_ANALOG
 16

	)

135 
	#__ATM_LM_MKLOC
(
n
è(Ò)è

	)

136 
	#__ATM_LM_MKRMT
(
n
è(Òè<< 8è

	)

138 
	#__ATM_LM_XTLOC
(
n
è(Òè& 0xff)

	)

139 
	#__ATM_LM_XTRMT
(
n
è((Òè>> 8è& 0xff)

	)

141 
	#ATM_LM_NONE
 0

	)

143 
	#ATM_LM_LOC_AAL
 
	`__ATM_LM_MKLOC
(
__ATM_LM_AAL
)

	)

144 
	#ATM_LM_LOC_ATM
 
	`__ATM_LM_MKLOC
(
__ATM_LM_ATM
)

	)

145 
	#ATM_LM_LOC_PHY
 
	`__ATM_LM_MKLOC
(
__ATM_LM_PHY
)

	)

146 
	#ATM_LM_LOC_ANALOG
 
	`__ATM_LM_MKLOC
(
__ATM_LM_ANALOG
)

	)

148 
	#ATM_LM_RMT_AAL
 
	`__ATM_LM_MKRMT
(
__ATM_LM_AAL
)

	)

149 
	#ATM_LM_RMT_ATM
 
	`__ATM_LM_MKRMT
(
__ATM_LM_ATM
)

	)

150 
	#ATM_LM_RMT_PHY
 
	`__ATM_LM_MKRMT
(
__ATM_LM_PHY
)

	)

151 
	#ATM_LM_RMT_ANALOG
 
	`__ATM_LM_MKRMT
(
__ATM_LM_ANALOG
)

	)

159 
	s©m_iobuf
 {

160 
	mËngth
;

161 *
	mbufãr
;

166 
	#ATM_CI_MAX
 -1

	)

168 
	s©m_cœªge
 {

169 sigÃd 
	mvpi_b™s
;

170 sigÃd 
	mvci_b™s
;

175 
	#ATM_SC_RX
 1024

	)

176 
	#ATM_SC_TX
 2048

	)

178 
	#ATM_BACKLOG_DEFAULT
 32

	)

183 
	#ATM_MF_IMMED
 1

	)

184 
	#ATM_MF_INC_RSV
 2

	)

185 
	#ATM_MF_INC_SHP
 4

	)

186 
	#ATM_MF_DEC_RSV
 8

	)

187 
	#ATM_MF_DEC_SHP
 16

	)

188 
	#ATM_MF_BWD
 32

	)

190 
	#ATM_MF_SET
 (
ATM_MF_INC_RSV
 | 
ATM_MF_INC_SHP
 | 
ATM_MF_DEC_RSV
 | \

191 
ATM_MF_DEC_SHP
 | 
ATM_MF_BWD
)

	)

197 
	#ATM_VS_IDLE
 0

	)

198 
	#ATM_VS_CONNECTED
 1

	)

199 
	#ATM_VS_CLOSING
 2

	)

200 
	#ATM_VS_LISTEN
 3

	)

201 
	#ATM_VS_INUSE
 4

	)

202 
	#ATM_VS_BOUND
 5

	)

204 
	#ATM_VS2TXT_MAP
 \

205 "IDLE", "CONNECTED", "CLOSING", "LISTEN", "INUSE", "BOUND"

	)

207 
	#ATM_VF2TXT_MAP
 \

211 "SESSION", "HASSAP", "BOUND", "CLOSE"

	)

	@/usr/include/linux/atmioc.h

12 #iâdeà
_LINUX_ATMIOC_H


13 
	#_LINUX_ATMIOC_H


	)

15 
	~<asm/ioùl.h
>

18 
	#ATMIOC_PHYCOM
 0x00

	)

19 
	#ATMIOC_PHYCOM_END
 0x0f

	)

20 
	#ATMIOC_PHYTYP
 0x10

	)

21 
	#ATMIOC_PHYTYP_END
 0x2f

	)

22 
	#ATMIOC_PHYPRV
 0x30

	)

23 
	#ATMIOC_PHYPRV_END
 0x4f

	)

24 
	#ATMIOC_SARCOM
 0x50

	)

25 
	#ATMIOC_SARCOM_END
 0x50

	)

26 
	#ATMIOC_SARPRV
 0x60

	)

27 
	#ATMIOC_SARPRV_END
 0x7f

	)

28 
	#ATMIOC_ITF
 0x80

	)

29 
	#ATMIOC_ITF_END
 0x8f

	)

30 
	#ATMIOC_BACKEND
 0x90

	)

31 
	#ATMIOC_BACKEND_END
 0xaf

	)

33 
	#ATMIOC_AREQUIPA
 0xc0

	)

34 
	#ATMIOC_LANE
 0xd0

	)

35 
	#ATMIOC_MPOA
 0xd8

	)

36 
	#ATMIOC_CLIP
 0xe0

	)

37 
	#ATMIOC_CLIP_END
 0xef

	)

38 
	#ATMIOC_SPECIAL
 0xf0

	)

39 
	#ATMIOC_SPECIAL_END
 0xff

	)

	@/usr/include/linux/atmlec.h

7 #iâdeà
_ATMLEC_H_


8 
	#_ATMLEC_H_


	)

10 
	~<lšux/©m­i.h
>

11 
	~<lšux/©mioc.h
>

12 
	~<lšux/©m.h
>

13 
	~<lšux/if_‘h”.h
>

14 
	~<lšux/ty³s.h
>

17 
	#ATMLEC_CTRL
 
	`_IO
('a', 
ATMIOC_LANE
)

	)

18 
	#ATMLEC_DATA
 
	`_IO
('a', 
ATMIOC_LANE
+1)

	)

19 
	#ATMLEC_MCAST
 
	`_IO
('a', 
ATMIOC_LANE
+2)

	)

22 
	#MAX_LEC_ITF
 48

	)

29 
	#NUM_TR_DEVS
 8

	)

32 
	ml_£t_mac_addr
,

33 
	ml_d–_mac_addr
,

34 
	ml_svc_£tup
,

35 
	ml_addr_d–‘e
,

36 
	ml_tİŞogy_chªge
,

37 
	ml_æush_com¶‘e
,

38 
	ml_¬p_upd©e
,

39 
	ml_Ç½_»q
,

40 
	ml_cÚfig
,

41 
	ml_æush_Œª_id
,

42 
	ml_£t_Ëcid
,

43 
	ml_¬p_xmt
,

44 
	ml_rdesc_¬p_xmt
,

45 
	ml_assocŸ‹_»q
,

46 
	ml_should_bridge


47 } 
	t©mËc_msg_ty³
;

49 
	#ATMLEC_MSG_TYPE_MAX
 
l_should_bridge


	)

51 
	s©mËc_cÚfig_msg
 {

52 
	mmaximum_unknown_äame_couÁ
;

53 
	mmax_unknown_äame_time
;

54 
	mmax_»Œy_couÁ
;

55 
	magšg_time
;

56 
	mfÜw¬d_d–ay_time
;

57 
	m¬p_»¥Ú£_time
;

58 
	mæush_timeout
;

59 
	m·th_sw™chšg_d–ay
;

60 
	mÏÃ_v”siÚ
;

61 
	mmtu
;

62 
	mis_´oxy
;

65 
	s©mËc_msg
 {

66 
©mËc_msg_ty³
 
	mty³
;

67 
	msizeoálvs
;

70 
	mmac_addr
[
ETH_ALEN
];

71 
	m©m_addr
[
ATM_ESA_LEN
];

72 
	mæag
;

77 
	mrg‘Ëss_Ë_¬p
;

78 
	mno_sourû_Ë_Ç½
;

79 } 
	mnÜm®
;

80 
©mËc_cÚfig_msg
 
	mcÚfig
;

82 
__u16
 
	mËc_id
;

83 
__u32
 
	mŒª_id
;

84 
	mmac_addr
[
ETH_ALEN
];

85 
	m©m_addr
[
ATM_ESA_LEN
];

86 } 
	m´oxy
;

90 } 
	mcÚ‹Á
;

91 } 
	g__ATM_API_ALIGN
;

93 
	s©mËc_ioc
 {

94 
	mdev_num
;

95 
	m©m_addr
[
ATM_ESA_LEN
];

96 
	m»ûive
;

	@/usr/include/linux/atmmpc.h

1 #iâdeà
_ATMMPC_H_


2 
	#_ATMMPC_H_


	)

4 
	~<lšux/©m­i.h
>

5 
	~<lšux/©mioc.h
>

6 
	~<lšux/©m.h
>

7 
	~<lšux/ty³s.h
>

9 
	#ATMMPC_CTRL
 
	`_IO
('a', 
ATMIOC_MPOA
)

	)

10 
	#ATMMPC_DATA
 
	`_IO
('a', 
ATMIOC_MPOA
+1)

	)

12 
	#MPC_SOCKET_INGRESS
 1

	)

13 
	#MPC_SOCKET_EGRESS
 2

	)

15 
	s©mmpc_ioc
 {

16 
	mdev_num
;

17 
__be32
 
	maddr
;

18 
	mty³
;

21 
	sš_ù¾_šfo
 {

22 
__u8
 
	mLa¡_NHRP_CIE_code
;

23 
__u8
 
	mLa¡_Q2931_ÿu£_v®ue
;

24 
__u8
 
	meg_MPC_ATM_addr
[
ATM_ESA_LEN
];

25 
__be32
 
	mg
;

26 
__be32
 
	mš_d¡_
;

27 
__u16
 
	mhŞdšg_time
;

28 
__u32
 
	m»que¡_id
;

29 } 
	tš_ù¾_šfo
;

31 
	seg_ù¾_šfo
 {

32 
__u8
 
	mDLL_h—d”
[256];

33 
__u8
 
	mDH_Ëngth
;

34 
__be32
 
	mÿche_id
;

35 
__be32
 
	mg
;

36 
__be32
 
	mmps_
;

37 
__be32
 
	meg_d¡_
;

38 
__u8
 
	mš_MPC_d©a_ATM_addr
[
ATM_ESA_LEN
];

39 
__u16
 
	mhŞdšg_time
;

40 } 
	teg_ù¾_šfo
;

42 
	smpc_·¿m‘”s
 {

43 
__u16
 
	mmpc_p1
;

44 
__u16
 
	mmpc_p2
;

45 
__u8
 
	mmpc_p3
[8];

46 
__u16
 
	mmpc_p4
;

47 
__u16
 
	mmpc_p5
;

48 
__u16
 
	mmpc_p6
;

51 
	sk_mes§ge
 {

52 
__u16
 
	mty³
;

53 
__be32
 
	m_mask
;

54 
__u8
 
	mMPS_ù¾
[
ATM_ESA_LEN
];

56 
š_ù¾_šfo
 
	mš_šfo
;

57 
eg_ù¾_šfo
 
	meg_šfo
;

58 
mpc_·¿m‘”s
 
	m·¿ms
;

59 } 
	mcÚ‹Á
;

60 
©m_qos
 
	mqos
;

61 } 
	g__ATM_API_ALIGN
;

63 
	sÎc_¢­_hdr
 {

65 
__u8
 
	md§p
;

66 
__u8
 
	ms§p
;

67 
__u8
 
	mui
;

68 
__u8
 
	mÜg
[3];

69 
__u8
 
	mty³
[2];

73 
	#TLV_MPOA_DEVICE_TYPE
 0x00a03e2a

	)

76 
	#NON_MPOA
 0

	)

77 
	#MPS
 1

	)

78 
	#MPC
 2

	)

79 
	#MPS_AND_MPC
 3

	)

84 
	#MPC_P1
 10

	)

85 
	#MPC_P2
 1

	)

86 
	#MPC_P3
 0

	)

87 
	#MPC_P4
 5

	)

88 
	#MPC_P5
 40

	)

89 
	#MPC_P6
 160

	)

90 
	#HOLDING_TIME_DEFAULT
 1200

	)

94 
	#MPC_C1
 2

	)

95 
	#MPC_C2
 60

	)

99 
	#SND_MPOA_RES_RQST
 201

	)

100 
	#SET_MPS_CTRL_ADDR
 202

	)

101 
	#SND_MPOA_RES_RTRY
 203

	)

102 
	#STOP_KEEP_ALIVE_SM
 204

	)

103 
	#EGRESS_ENTRY_REMOVED
 205

	)

104 
	#SND_EGRESS_PURGE
 206

	)

105 
	#DIE
 207

	)

106 
	#DATA_PLANE_PURGE
 208

	)

107 
	#OPEN_INGRESS_SVC
 209

	)

111 
	#MPOA_TRIGGER_RCVD
 101

	)

112 
	#MPOA_RES_REPLY_RCVD
 102

	)

113 
	#INGRESS_PURGE_RCVD
 103

	)

114 
	#EGRESS_PURGE_RCVD
 104

	)

115 
	#MPS_DEATH
 105

	)

116 
	#CACHE_IMPOS_RCVD
 106

	)

117 
	#SET_MPC_CTRL_ADDR
 107

	)

118 
	#SET_MPS_MAC_ADDR
 108

	)

119 
	#CLEAN_UP_AND_EXIT
 109

	)

120 
	#SET_MPC_PARAMS
 110

	)

124 
	#RELOAD
 301

	)

	@/usr/include/linux/atmsvc.h

6 #iâdeà
_LINUX_ATMSVC_H


7 
	#_LINUX_ATMSVC_H


	)

9 
	~<lšux/©m­i.h
>

10 
	~<lšux/©m.h
>

11 
	~<lšux/©mioc.h
>

14 
	#ATMSIGD_CTRL
 
	`_IO
('a',
ATMIOC_SPECIAL
)

	)

17 
	e©msvc_msg_ty³
 { 
	mas_ÿtch_nuÎ
, 
	mas_bšd
, 
	mas_cÚÃù
, 
	mas_acû±
, 
	mas_»jeù
,

18 
	mas_li¡’
, 
	mas_okay
, 
	mas_”rÜ
, 
	mas_šdiÿ‹
, 
	mas_şo£
,

19 
	mas_™f_nÙify
, 
	mas_modify
, 
	mas_id’tify
, 
	mas_‹rmš©e
,

20 
	mas_add·¹y
, 
	mas_drİ·¹y
 };

22 
	s©msvc_msg
 {

23 
©msvc_msg_ty³
 
	mty³
;

24 
©m_k±r_t
 
	mvcc
;

25 
©m_k±r_t
 
	mli¡’_vcc
;

26 
	m»¶y
;

32 
sockaddr_©mpvc
 
	mpvc
;

33 
sockaddr_©msvc
 
	mloÿl
;

34 
©m_qos
 
	mqos
;

35 
©m_§p
 
	m§p
;

36 
	m£ssiÚ
;

37 
sockaddr_©msvc
 
	msvc
;

38 } 
	g__ATM_API_ALIGN
;

51 
	#SELECT_TOP_PCR
(

è(Ñp).
pü
 ? (tp).pcr : \

52 (

).
max_pü
 && ().max_pü !ğ
ATM_MAX_PCR
 ? (tp).max_pcr : \

53 (

).
mš_pü
 ? ().mš_pü : 
ATM_MAX_PCR
)

	)

	@/usr/include/linux/audit.h

24 #iâdeà
_LINUX_AUDIT_H_


25 
	#_LINUX_AUDIT_H_


	)

27 
	~<lšux/ty³s.h
>

28 
	~<lšux/–f-em.h
>

53 
	#AUDIT_GET
 1000

	)

54 
	#AUDIT_SET
 1001

	)

55 
	#AUDIT_LIST
 1002

	)

56 
	#AUDIT_ADD
 1003

	)

57 
	#AUDIT_DEL
 1004

	)

58 
	#AUDIT_USER
 1005

	)

59 
	#AUDIT_LOGIN
 1006

	)

60 
	#AUDIT_WATCH_INS
 1007

	)

61 
	#AUDIT_WATCH_REM
 1008

	)

62 
	#AUDIT_WATCH_LIST
 1009

	)

63 
	#AUDIT_SIGNAL_INFO
 1010

	)

64 
	#AUDIT_ADD_RULE
 1011

	)

65 
	#AUDIT_DEL_RULE
 1012

	)

66 
	#AUDIT_LIST_RULES
 1013

	)

67 
	#AUDIT_TRIM
 1014

	)

68 
	#AUDIT_MAKE_EQUIV
 1015

	)

69 
	#AUDIT_TTY_GET
 1016

	)

70 
	#AUDIT_TTY_SET
 1017

	)

72 
	#AUDIT_FIRST_USER_MSG
 1100

	)

73 
	#AUDIT_USER_AVC
 1107

	)

74 
	#AUDIT_USER_TTY
 1124

	)

75 
	#AUDIT_LAST_USER_MSG
 1199

	)

76 
	#AUDIT_FIRST_USER_MSG2
 2100

	)

77 
	#AUDIT_LAST_USER_MSG2
 2999

	)

79 
	#AUDIT_DAEMON_START
 1200

	)

80 
	#AUDIT_DAEMON_END
 1201

	)

81 
	#AUDIT_DAEMON_ABORT
 1202

	)

82 
	#AUDIT_DAEMON_CONFIG
 1203

	)

84 
	#AUDIT_SYSCALL
 1300

	)

86 
	#AUDIT_PATH
 1302

	)

87 
	#AUDIT_IPC
 1303

	)

88 
	#AUDIT_SOCKETCALL
 1304

	)

89 
	#AUDIT_CONFIG_CHANGE
 1305

	)

90 
	#AUDIT_SOCKADDR
 1306

	)

91 
	#AUDIT_CWD
 1307

	)

92 
	#AUDIT_EXECVE
 1309

	)

93 
	#AUDIT_IPC_SET_PERM
 1311

	)

94 
	#AUDIT_MQ_OPEN
 1312

	)

95 
	#AUDIT_MQ_SENDRECV
 1313

	)

96 
	#AUDIT_MQ_NOTIFY
 1314

	)

97 
	#AUDIT_MQ_GETSETATTR
 1315

	)

98 
	#AUDIT_KERNEL_OTHER
 1316

	)

99 
	#AUDIT_FD_PAIR
 1317

	)

100 
	#AUDIT_OBJ_PID
 1318

	)

101 
	#AUDIT_TTY
 1319

	)

102 
	#AUDIT_EOE
 1320

	)

103 
	#AUDIT_BPRM_FCAPS
 1321

	)

104 
	#AUDIT_CAPSET
 1322

	)

105 
	#AUDIT_MMAP
 1323

	)

106 
	#AUDIT_NETFILTER_PKT
 1324

	)

107 
	#AUDIT_NETFILTER_CFG
 1325

	)

109 
	#AUDIT_AVC
 1400

	)

110 
	#AUDIT_SELINUX_ERR
 1401

	)

111 
	#AUDIT_AVC_PATH
 1402

	)

112 
	#AUDIT_MAC_POLICY_LOAD
 1403

	)

113 
	#AUDIT_MAC_STATUS
 1404

	)

114 
	#AUDIT_MAC_CONFIG_CHANGE
 1405

	)

115 
	#AUDIT_MAC_UNLBL_ALLOW
 1406

	)

116 
	#AUDIT_MAC_CIPSOV4_ADD
 1407

	)

117 
	#AUDIT_MAC_CIPSOV4_DEL
 1408

	)

118 
	#AUDIT_MAC_MAP_ADD
 1409

	)

119 
	#AUDIT_MAC_MAP_DEL
 1410

	)

120 
	#AUDIT_MAC_IPSEC_ADDSA
 1411

	)

121 
	#AUDIT_MAC_IPSEC_DELSA
 1412

	)

122 
	#AUDIT_MAC_IPSEC_ADDSPD
 1413

	)

123 
	#AUDIT_MAC_IPSEC_DELSPD
 1414

	)

124 
	#AUDIT_MAC_IPSEC_EVENT
 1415

	)

125 
	#AUDIT_MAC_UNLBL_STCADD
 1416

	)

126 
	#AUDIT_MAC_UNLBL_STCDEL
 1417

	)

128 
	#AUDIT_FIRST_KERN_ANOM_MSG
 1700

	)

129 
	#AUDIT_LAST_KERN_ANOM_MSG
 1799

	)

130 
	#AUDIT_ANOM_PROMISCUOUS
 1700

	)

131 
	#AUDIT_ANOM_ABEND
 1701

	)

132 
	#AUDIT_INTEGRITY_DATA
 1800

	)

133 
	#AUDIT_INTEGRITY_METADATA
 1801

	)

134 
	#AUDIT_INTEGRITY_STATUS
 1802

	)

135 
	#AUDIT_INTEGRITY_HASH
 1803

	)

136 
	#AUDIT_INTEGRITY_PCR
 1804

	)

137 
	#AUDIT_INTEGRITY_RULE
 1805

	)

139 
	#AUDIT_KERNEL
 2000

	)

142 
	#AUDIT_FILTER_USER
 0x00

	)

143 
	#AUDIT_FILTER_TASK
 0x01

	)

144 
	#AUDIT_FILTER_ENTRY
 0x02

	)

145 
	#AUDIT_FILTER_WATCH
 0x03

	)

146 
	#AUDIT_FILTER_EXIT
 0x04

	)

147 
	#AUDIT_FILTER_TYPE
 0x05

	)

149 
	#AUDIT_NR_FILTERS
 6

	)

151 
	#AUDIT_FILTER_PREPEND
 0x10

	)

154 
	#AUDIT_NEVER
 0

	)

155 
	#AUDIT_POSSIBLE
 1

	)

156 
	#AUDIT_ALWAYS
 2

	)

160 
	#AUDIT_MAX_FIELDS
 64

	)

161 
	#AUDIT_MAX_KEY_LEN
 256

	)

162 
	#AUDIT_BITMASK_SIZE
 64

	)

163 
	#AUDIT_WORD
(
Ä
è((
__u32
)(Òr)/32))

	)

164 
	#AUDIT_BIT
(
Ä
è(1 << (Òrè- 
	`AUDIT_WORD
Òr)*32))

	)

166 
	#AUDIT_SYSCALL_CLASSES
 16

	)

167 
	#AUDIT_CLASS_DIR_WRITE
 0

	)

168 
	#AUDIT_CLASS_DIR_WRITE_32
 1

	)

169 
	#AUDIT_CLASS_CHATTR
 2

	)

170 
	#AUDIT_CLASS_CHATTR_32
 3

	)

171 
	#AUDIT_CLASS_READ
 4

	)

172 
	#AUDIT_CLASS_READ_32
 5

	)

173 
	#AUDIT_CLASS_WRITE
 6

	)

174 
	#AUDIT_CLASS_WRITE_32
 7

	)

175 
	#AUDIT_CLASS_SIGNAL
 8

	)

176 
	#AUDIT_CLASS_SIGNAL_32
 9

	)

182 
	#AUDIT_UNUSED_BITS
 0x07FFFC00

	)

189 
	#AUDIT_PID
 0

	)

190 
	#AUDIT_UID
 1

	)

191 
	#AUDIT_EUID
 2

	)

192 
	#AUDIT_SUID
 3

	)

193 
	#AUDIT_FSUID
 4

	)

194 
	#AUDIT_GID
 5

	)

195 
	#AUDIT_EGID
 6

	)

196 
	#AUDIT_SGID
 7

	)

197 
	#AUDIT_FSGID
 8

	)

198 
	#AUDIT_LOGINUID
 9

	)

199 
	#AUDIT_PERS
 10

	)

200 
	#AUDIT_ARCH
 11

	)

201 
	#AUDIT_MSGTYPE
 12

	)

202 
	#AUDIT_SUBJ_USER
 13

	)

203 
	#AUDIT_SUBJ_ROLE
 14

	)

204 
	#AUDIT_SUBJ_TYPE
 15

	)

205 
	#AUDIT_SUBJ_SEN
 16

	)

206 
	#AUDIT_SUBJ_CLR
 17

	)

207 
	#AUDIT_PPID
 18

	)

208 
	#AUDIT_OBJ_USER
 19

	)

209 
	#AUDIT_OBJ_ROLE
 20

	)

210 
	#AUDIT_OBJ_TYPE
 21

	)

211 
	#AUDIT_OBJ_LEV_LOW
 22

	)

212 
	#AUDIT_OBJ_LEV_HIGH
 23

	)

216 
	#AUDIT_DEVMAJOR
 100

	)

217 
	#AUDIT_DEVMINOR
 101

	)

218 
	#AUDIT_INODE
 102

	)

219 
	#AUDIT_EXIT
 103

	)

220 
	#AUDIT_SUCCESS
 104

	)

221 
	#AUDIT_WATCH
 105

	)

222 
	#AUDIT_PERM
 106

	)

223 
	#AUDIT_DIR
 107

	)

224 
	#AUDIT_FILETYPE
 108

	)

226 
	#AUDIT_ARG0
 200

	)

227 
	#AUDIT_ARG1
 (
AUDIT_ARG0
+1)

	)

228 
	#AUDIT_ARG2
 (
AUDIT_ARG0
+2)

	)

229 
	#AUDIT_ARG3
 (
AUDIT_ARG0
+3)

	)

231 
	#AUDIT_FILTERKEY
 210

	)

233 
	#AUDIT_NEGATE
 0x80000000

	)

250 
	#AUDIT_BIT_MASK
 0x08000000

	)

251 
	#AUDIT_LESS_THAN
 0x10000000

	)

252 
	#AUDIT_GREATER_THAN
 0x20000000

	)

253 
	#AUDIT_NOT_EQUAL
 0x30000000

	)

254 
	#AUDIT_EQUAL
 0x40000000

	)

255 
	#AUDIT_BIT_TEST
 (
AUDIT_BIT_MASK
|
AUDIT_EQUAL
)

	)

256 
	#AUDIT_LESS_THAN_OR_EQUAL
 (
AUDIT_LESS_THAN
|
AUDIT_EQUAL
)

	)

257 
	#AUDIT_GREATER_THAN_OR_EQUAL
 (
AUDIT_GREATER_THAN
|
AUDIT_EQUAL
)

	)

258 
	#AUDIT_OPERATORS
 (
AUDIT_EQUAL
|
AUDIT_NOT_EQUAL
|
AUDIT_BIT_MASK
)

	)

261 
	mAud™_equ®
,

262 
	mAud™_nÙ_equ®
,

263 
	mAud™_b™mask
,

264 
	mAud™_b™‹¡
,

265 
	mAud™_É
,

266 
	mAud™_gt
,

267 
	mAud™_Ë
,

268 
	mAud™_ge
,

269 
	mAud™_bad


274 
	#AUDIT_STATUS_ENABLED
 0x0001

	)

275 
	#AUDIT_STATUS_FAILURE
 0x0002

	)

276 
	#AUDIT_STATUS_PID
 0x0004

	)

277 
	#AUDIT_STATUS_RATE_LIMIT
 0x0008

	)

278 
	#AUDIT_STATUS_BACKLOG_LIMIT
 0x0010

	)

280 
	#AUDIT_FAIL_SILENT
 0

	)

281 
	#AUDIT_FAIL_PRINTK
 1

	)

282 
	#AUDIT_FAIL_PANIC
 2

	)

285 
	#__AUDIT_ARCH_64BIT
 0x80000000

	)

286 
	#__AUDIT_ARCH_LE
 0x40000000

	)

287 
	#AUDIT_ARCH_ALPHA
 (
EM_ALPHA
|
__AUDIT_ARCH_64BIT
|
__AUDIT_ARCH_LE
)

	)

288 
	#AUDIT_ARCH_ARM
 (
EM_ARM
|
__AUDIT_ARCH_LE
)

	)

289 
	#AUDIT_ARCH_ARMEB
 (
EM_ARM
)

	)

290 
	#AUDIT_ARCH_CRIS
 (
EM_CRIS
|
__AUDIT_ARCH_LE
)

	)

291 
	#AUDIT_ARCH_FRV
 (
EM_FRV
)

	)

292 
	#AUDIT_ARCH_H8300
 (
EM_H8_300
)

	)

293 
	#AUDIT_ARCH_I386
 (
EM_386
|
__AUDIT_ARCH_LE
)

	)

294 
	#AUDIT_ARCH_IA64
 (
EM_IA_64
|
__AUDIT_ARCH_64BIT
|
__AUDIT_ARCH_LE
)

	)

295 
	#AUDIT_ARCH_M32R
 (
EM_M32R
)

	)

296 
	#AUDIT_ARCH_M68K
 (
EM_68K
)

	)

297 
	#AUDIT_ARCH_MIPS
 (
EM_MIPS
)

	)

298 
	#AUDIT_ARCH_MIPSEL
 (
EM_MIPS
|
__AUDIT_ARCH_LE
)

	)

299 
	#AUDIT_ARCH_MIPS64
 (
EM_MIPS
|
__AUDIT_ARCH_64BIT
)

	)

300 
	#AUDIT_ARCH_MIPSEL64
 (
EM_MIPS
|
__AUDIT_ARCH_64BIT
|
__AUDIT_ARCH_LE
)

	)

301 
	#AUDIT_ARCH_PARISC
 (
EM_PARISC
)

	)

302 
	#AUDIT_ARCH_PARISC64
 (
EM_PARISC
|
__AUDIT_ARCH_64BIT
)

	)

303 
	#AUDIT_ARCH_PPC
 (
EM_PPC
)

	)

304 
	#AUDIT_ARCH_PPC64
 (
EM_PPC64
|
__AUDIT_ARCH_64BIT
)

	)

305 
	#AUDIT_ARCH_S390
 (
EM_S390
)

	)

306 
	#AUDIT_ARCH_S390X
 (
EM_S390
|
__AUDIT_ARCH_64BIT
)

	)

307 
	#AUDIT_ARCH_SH
 (
EM_SH
)

	)

308 
	#AUDIT_ARCH_SHEL
 (
EM_SH
|
__AUDIT_ARCH_LE
)

	)

309 
	#AUDIT_ARCH_SH64
 (
EM_SH
|
__AUDIT_ARCH_64BIT
)

	)

310 
	#AUDIT_ARCH_SHEL64
 (
EM_SH
|
__AUDIT_ARCH_64BIT
|
__AUDIT_ARCH_LE
)

	)

311 
	#AUDIT_ARCH_SPARC
 (
EM_SPARC
)

	)

312 
	#AUDIT_ARCH_SPARC64
 (
EM_SPARCV9
|
__AUDIT_ARCH_64BIT
)

	)

313 
	#AUDIT_ARCH_X86_64
 (
EM_X86_64
|
__AUDIT_ARCH_64BIT
|
__AUDIT_ARCH_LE
)

	)

315 
	#AUDIT_PERM_EXEC
 1

	)

316 
	#AUDIT_PERM_WRITE
 2

	)

317 
	#AUDIT_PERM_READ
 4

	)

318 
	#AUDIT_PERM_ATTR
 8

	)

320 
	saud™_¡©us
 {

321 
__u32
 
	mmask
;

322 
__u32
 
	m’abËd
;

323 
__u32
 
	mçu»
;

324 
__u32
 
	mpid
;

325 
__u32
 
	m¿‹_lim™
;

326 
__u32
 
	mbacklog_lim™
;

327 
__u32
 
	mlo¡
;

328 
__u32
 
	mbacklog
;

331 
	saud™_‰y_¡©us
 {

332 
__u32
 
	m’abËd
;

339 
	saud™_ruË_d©a
 {

340 
__u32
 
	mæags
;

341 
__u32
 
	maùiÚ
;

342 
__u32
 
	mf›ld_couÁ
;

343 
__u32
 
	mmask
[
AUDIT_BITMASK_SIZE
];

344 
__u32
 
	mf›lds
[
AUDIT_MAX_FIELDS
];

345 
__u32
 
	mv®ues
[
AUDIT_MAX_FIELDS
];

346 
__u32
 
	mf›ldæags
[
AUDIT_MAX_FIELDS
];

347 
__u32
 
	mbuæ’
;

348 
	mbuf
[0];

355 
	saud™_ruË
 {

356 
__u32
 
	mæags
;

357 
__u32
 
	maùiÚ
;

358 
__u32
 
	mf›ld_couÁ
;

359 
__u32
 
	mmask
[
AUDIT_BITMASK_SIZE
];

360 
__u32
 
	mf›lds
[
AUDIT_MAX_FIELDS
];

361 
__u32
 
	mv®ues
[
AUDIT_MAX_FIELDS
];

	@/usr/include/linux/auto_fs.h

14 #iâdeà
_LINUX_AUTO_FS_H


15 
	#_LINUX_AUTO_FS_H


	)

17 
	~<lšux/ty³s.h
>

18 
	~<sys/ioùl.h
>

21 
	#AUTOFS_PROTO_VERSION
 3

	)

24 
	#AUTOFS_MAX_PROTO_VERSION
 
AUTOFS_PROTO_VERSION


	)

25 
	#AUTOFS_MIN_PROTO_VERSION
 
AUTOFS_PROTO_VERSION


	)

34 #ià
defšed
(
__Ÿ64__
è|| defšed(
__®pha__
)

35 
	tautofs_wqt_t
;

37 
	tautofs_wqt_t
;

41 
	#autofs_±y³_missšg
 0

	)

42 
	#autofs_±y³_expœe
 1

	)

44 
	sautofs_·ck‘_hdr
 {

45 
	m´Ùo_v”siÚ
;

46 
	mty³
;

49 
	sautofs_·ck‘_missšg
 {

50 
autofs_·ck‘_hdr
 
	mhdr
;

51 
autofs_wqt_t
 
	mwa™_queue_tok’
;

52 
	mËn
;

53 
	mÇme
[
NAME_MAX
+1];

57 
	sautofs_·ck‘_expœe
 {

58 
autofs_·ck‘_hdr
 
	mhdr
;

59 
	mËn
;

60 
	mÇme
[
NAME_MAX
+1];

63 
	#AUTOFS_IOC_READY
 
	`_IO
(0x93,0x60)

	)

64 
	#AUTOFS_IOC_FAIL
 
	`_IO
(0x93,0x61)

	)

65 
	#AUTOFS_IOC_CATATONIC
 
	`_IO
(0x93,0x62)

	)

66 
	#AUTOFS_IOC_PROTOVER
 
	`_IOR
(0x93,0x63,)

	)

67 
	#AUTOFS_IOC_SETTIMEOUT32
 
	`_IOWR
(0x93,0x64,
com·t_ulÚg_t
)

	)

68 
	#AUTOFS_IOC_SETTIMEOUT
 
	`_IOWR
(0x93,0x64,)

	)

69 
	#AUTOFS_IOC_EXPIRE
 
	`_IOR
(0x93,0x65,
autofs_·ck‘_expœe
)

	)

	@/usr/include/linux/auto_fs4.h

11 #iâdeà
_LINUX_AUTO_FS4_H


12 
	#_LINUX_AUTO_FS4_H


	)

15 
	~<lšux/ty³s.h
>

16 
	~<lšux/auto_fs.h
>

19 #undeà
AUTOFS_PROTO_VERSION


20 #undeà
AUTOFS_MIN_PROTO_VERSION


21 #undeà
AUTOFS_MAX_PROTO_VERSION


23 
	#AUTOFS_PROTO_VERSION
 5

	)

24 
	#AUTOFS_MIN_PROTO_VERSION
 3

	)

25 
	#AUTOFS_MAX_PROTO_VERSION
 5

	)

27 
	#AUTOFS_PROTO_SUBVERSION
 2

	)

30 
	#AUTOFS_EXP_IMMEDIATE
 1

	)

31 
	#AUTOFS_EXP_LEAVES
 2

	)

33 
	#AUTOFS_TYPE_ANY
 0U

	)

34 
	#AUTOFS_TYPE_INDIRECT
 1U

	)

35 
	#AUTOFS_TYPE_DIRECT
 2U

	)

36 
	#AUTOFS_TYPE_OFFSET
 4U

	)

38 
__šlše__
 
	$£t_autofs_ty³_šdœeù
(*
ty³
)

40 *
ty³
 = 
AUTOFS_TYPE_INDIRECT
;

42 
	}
}

44 
__šlše__
 
	$autofs_ty³_šdœeù
(
ty³
)

46  (
ty³
 =ğ
AUTOFS_TYPE_INDIRECT
);

47 
	}
}

49 
__šlše__
 
	$£t_autofs_ty³_dœeù
(*
ty³
)

51 *
ty³
 = 
AUTOFS_TYPE_DIRECT
;

53 
	}
}

55 
__šlše__
 
	$autofs_ty³_dœeù
(
ty³
)

57  (
ty³
 =ğ
AUTOFS_TYPE_DIRECT
);

58 
	}
}

60 
__šlše__
 
	$£t_autofs_ty³_off£t
(*
ty³
)

62 *
ty³
 = 
AUTOFS_TYPE_OFFSET
;

64 
	}
}

66 
__šlše__
 
	$autofs_ty³_off£t
(
ty³
)

68  (
ty³
 =ğ
AUTOFS_TYPE_OFFSET
);

69 
	}
}

71 
__šlše__
 
	$autofs_ty³_Œigg”
(
ty³
)

73  (
ty³
 =ğ
AUTOFS_TYPE_DIRECT
 ||y³ =ğ
AUTOFS_TYPE_OFFSET
);

74 
	}
}

81 
__šlše__
 
	$£t_autofs_ty³_ªy
(*
ty³
)

83 *
ty³
 = 
AUTOFS_TYPE_ANY
;

85 
	}
}

87 
__šlše__
 
	$autofs_ty³_ªy
(
ty³
)

89  (
ty³
 =ğ
AUTOFS_TYPE_ANY
);

90 
	}
}

93 
	eautofs_nÙify
 {

94 
	mNFY_NONE
,

95 
	mNFY_MOUNT
,

96 
	mNFY_EXPIRE


102 
	#autofs_±y³_expœe_muÉi
 2

	)

107 
	#autofs_±y³_missšg_šdœeù
 3

	)

108 
	#autofs_±y³_expœe_šdœeù
 4

	)

111 
	#autofs_±y³_missšg_dœeù
 5

	)

112 
	#autofs_±y³_expœe_dœeù
 6

	)

115 
	sautofs_·ck‘_expœe_muÉi
 {

116 
autofs_·ck‘_hdr
 
	mhdr
;

117 
autofs_wqt_t
 
	mwa™_queue_tok’
;

118 
	mËn
;

119 
	mÇme
[
NAME_MAX
+1];

122 
	uautofs_·ck‘_uniÚ
 {

123 
autofs_·ck‘_hdr
 
	mhdr
;

124 
autofs_·ck‘_missšg
 
	mmissšg
;

125 
autofs_·ck‘_expœe
 
	mexpœe
;

126 
autofs_·ck‘_expœe_muÉi
 
	mexpœe_muÉi
;

130 
	sautofs_v5_·ck‘
 {

131 
autofs_·ck‘_hdr
 
	mhdr
;

132 
autofs_wqt_t
 
	mwa™_queue_tok’
;

133 
__u32
 
	mdev
;

134 
__u64
 
	mšo
;

135 
__u32
 
	muid
;

136 
__u32
 
	mgid
;

137 
__u32
 
	mpid
;

138 
__u32
 
	mtgid
;

139 
__u32
 
	mËn
;

140 
	mÇme
[
NAME_MAX
+1];

143 
autofs_v5_·ck‘
 
	tautofs_·ck‘_missšg_šdœeù_t
;

144 
autofs_v5_·ck‘
 
	tautofs_·ck‘_expœe_šdœeù_t
;

145 
autofs_v5_·ck‘
 
	tautofs_·ck‘_missšg_dœeù_t
;

146 
autofs_v5_·ck‘
 
	tautofs_·ck‘_expœe_dœeù_t
;

148 
	uautofs_v5_·ck‘_uniÚ
 {

149 
autofs_·ck‘_hdr
 
	mhdr
;

150 
autofs_v5_·ck‘
 
	mv5_·ck‘
;

151 
autofs_·ck‘_missšg_šdœeù_t
 
	mmissšg_šdœeù
;

152 
autofs_·ck‘_expœe_šdœeù_t
 
	mexpœe_šdœeù
;

153 
autofs_·ck‘_missšg_dœeù_t
 
	mmissšg_dœeù
;

154 
autofs_·ck‘_expœe_dœeù_t
 
	mexpœe_dœeù
;

157 
	#AUTOFS_IOC_EXPIRE_MULTI
 
	`_IOW
(0x93,0x66,)

	)

158 
	#AUTOFS_IOC_EXPIRE_INDIRECT
 
AUTOFS_IOC_EXPIRE_MULTI


	)

159 
	#AUTOFS_IOC_EXPIRE_DIRECT
 
AUTOFS_IOC_EXPIRE_MULTI


	)

160 
	#AUTOFS_IOC_PROTOSUBVER
 
	`_IOR
(0x93,0x67,)

	)

161 
	#AUTOFS_IOC_ASKUMOUNT
 
	`_IOR
(0x93,0x70,)

	)

	@/usr/include/linux/binfmts.h

1 #iâdeà
_LINUX_BINFMTS_H


2 
	#_LINUX_BINFMTS_H


	)

4 
	~<lšux/ÿ·b™y.h
>

6 
	g±_»gs
;

14 
	#MAX_ARG_STRLEN
 (
PAGE_SIZE
 * 32)

	)

15 
	#MAX_ARG_STRINGS
 0x7FFFFFFF

	)

18 
	#BINPRM_BUF_SIZE
 128

	)

	@/usr/include/linux/blkpg.h

1 #iâdeà
_LINUX_BLKPG_H


2 
	#_LINUX_BLKPG_H


	)

28 
	~<lšux/ioùl.h
>

30 
	#BLKPG
 
	`_IO
(0x12,105)

	)

33 
	sblkpg_ioùl_¬g
 {

34 
	mİ
;

35 
	mæags
;

36 
	md©®’
;

37 *
	md©a
;

41 
	#BLKPG_ADD_PARTITION
 1

	)

42 
	#BLKPG_DEL_PARTITION
 2

	)

45 
	#BLKPG_DEVNAMELTH
 64

	)

46 
	#BLKPG_VOLNAMELTH
 64

	)

49 
	sblkpg_·¹™iÚ
 {

50 
	m¡¬t
;

51 
	mËngth
;

52 
	m²o
;

53 
	mdevÇme
[
BLKPG_DEVNAMELTH
];

55 
	mvŞÇme
[
BLKPG_VOLNAMELTH
];

	@/usr/include/linux/capability.h

13 #iâdeà
_LINUX_CAPABILITY_H


14 
	#_LINUX_CAPABILITY_H


	)

16 
	~<lšux/ty³s.h
>

18 
	gsk_¡ruù
;

31 
	#_LINUX_CAPABILITY_VERSION_1
 0x19980330

	)

32 
	#_LINUX_CAPABILITY_U32S_1
 1

	)

34 
	#_LINUX_CAPABILITY_VERSION_2
 0x20071026

	)

35 
	#_LINUX_CAPABILITY_U32S_2
 2

	)

37 
	#_LINUX_CAPABILITY_VERSION_3
 0x20080522

	)

38 
	#_LINUX_CAPABILITY_U32S_3
 2

	)

40 
	s__u£r_ÿp_h—d”_¡ruù
 {

41 
__u32
 
	mv”siÚ
;

42 
	mpid
;

43 } *
	tÿp_u£r_h—d”_t
;

45 
	s__u£r_ÿp_d©a_¡ruù
 {

46 
__u32
 
	mefãùive
;

47 
__u32
 
	m³rm™‹d
;

48 
__u32
 
	mšh”™abË
;

49 } *
	tÿp_u£r_d©a_t
;

52 
	#VFS_CAP_REVISION_MASK
 0xFF000000

	)

53 
	#VFS_CAP_REVISION_SHIFT
 24

	)

54 
	#VFS_CAP_FLAGS_MASK
 ~
VFS_CAP_REVISION_MASK


	)

55 
	#VFS_CAP_FLAGS_EFFECTIVE
 0x000001

	)

57 
	#VFS_CAP_REVISION_1
 0x01000000

	)

58 
	#VFS_CAP_U32_1
 1

	)

59 
	#XATTR_CAPS_SZ_1
 ((
__Ë32
)*(1 + 2*
VFS_CAP_U32_1
))

	)

61 
	#VFS_CAP_REVISION_2
 0x02000000

	)

62 
	#VFS_CAP_U32_2
 2

	)

63 
	#XATTR_CAPS_SZ_2
 ((
__Ë32
)*(1 + 2*
VFS_CAP_U32_2
))

	)

65 
	#XATTR_CAPS_SZ
 
XATTR_CAPS_SZ_2


	)

66 
	#VFS_CAP_U32
 
VFS_CAP_U32_2


	)

67 
	#VFS_CAP_REVISION
 
VFS_CAP_REVISION_2


	)

69 
	svfs_ÿp_d©a
 {

70 
__Ë32
 
	mmagic_‘c
;

72 
__Ë32
 
	m³rm™‹d
;

73 
__Ë32
 
	mšh”™abË
;

74 } 
	md©a
[
VFS_CAP_U32
];

83 
	#_LINUX_CAPABILITY_VERSION
 
_LINUX_CAPABILITY_VERSION_1


	)

84 
	#_LINUX_CAPABILITY_U32S
 
_LINUX_CAPABILITY_U32S_1


	)

96 
	#CAP_CHOWN
 0

	)

102 
	#CAP_DAC_OVERRIDE
 1

	)

108 
	#CAP_DAC_READ_SEARCH
 2

	)

114 
	#CAP_FOWNER
 3

	)

123 
	#CAP_FSETID
 4

	)

129 
	#CAP_KILL
 5

	)

135 
	#CAP_SETGID
 6

	)

140 
	#CAP_SETUID
 7

	)

157 
	#CAP_SETPCAP
 8

	)

161 
	#CAP_LINUX_IMMUTABLE
 9

	)

166 
	#CAP_NET_BIND_SERVICE
 10

	)

170 
	#CAP_NET_BROADCAST
 11

	)

186 
	#CAP_NET_ADMIN
 12

	)

192 
	#CAP_NET_RAW
 13

	)

198 
	#CAP_IPC_LOCK
 14

	)

202 
	#CAP_IPC_OWNER
 15

	)

205 
	#CAP_SYS_MODULE
 16

	)

210 
	#CAP_SYS_RAWIO
 17

	)

214 
	#CAP_SYS_CHROOT
 18

	)

218 
	#CAP_SYS_PTRACE
 19

	)

222 
	#CAP_SYS_PACCT
 20

	)

261 
	#CAP_SYS_ADMIN
 21

	)

265 
	#CAP_SYS_BOOT
 22

	)

274 
	#CAP_SYS_NICE
 23

	)

288 
	#CAP_SYS_RESOURCE
 24

	)

294 
	#CAP_SYS_TIME
 25

	)

299 
	#CAP_SYS_TTY_CONFIG
 26

	)

303 
	#CAP_MKNOD
 27

	)

307 
	#CAP_LEASE
 28

	)

309 
	#CAP_AUDIT_WRITE
 29

	)

311 
	#CAP_AUDIT_CONTROL
 30

	)

313 
	#CAP_SETFCAP
 31

	)

321 
	#CAP_MAC_OVERRIDE
 32

	)

330 
	#CAP_MAC_ADMIN
 33

	)

334 
	#CAP_SYSLOG
 34

	)

338 
	#CAP_WAKE_ALARM
 35

	)

341 
	#CAP_LAST_CAP
 
CAP_WAKE_ALARM


	)

343 
	#ÿp_v®id
(
x
è((xè>ğ0 && (xè<ğ
CAP_LAST_CAP
)

	)

349 
	#CAP_TO_INDEX
(
x
è((xè>> 5è

	)

350 
	#CAP_TO_MASK
(
x
è(1 << ((xè& 31)è

	)

	@/usr/include/linux/capi.h

12 #iâdeà
__LINUX_CAPI_H__


13 
	#__LINUX_CAPI_H__


	)

15 
	~<lšux/ty³s.h
>

16 
	~<lšux/ioùl.h
>

17 
	~<lšux/k”Ãlÿpi.h
>

23 
	sÿpi_»gi¡”_·¿ms
 {

24 
__u32
 
	mËv–3út
;

25 
__u32
 
	md©ablkút
;

26 
__u32
 
	md©ablkËn
;

27 } 
	tÿpi_»gi¡”_·¿ms
;

29 
	#CAPI_REGISTER
 
	`_IOW
('C',0x01,
ÿpi_»gi¡”_·¿ms
)

	)

35 
	#CAPI_MANUFACTURER_LEN
 64

	)

37 
	#CAPI_GET_MANUFACTURER
 
	`_IOWR
('C',0x06,è

	)

43 
	sÿpi_v”siÚ
 {

44 
__u32
 
	mmajÜv”siÚ
;

45 
__u32
 
	mmšÜv”siÚ
;

46 
__u32
 
	mmajÜmªuv”siÚ
;

47 
__u32
 
	mmšÜmªuv”siÚ
;

48 } 
	tÿpi_v”siÚ
;

50 
	#CAPI_GET_VERSION
 
	`_IOWR
('C',0x07,
ÿpi_v”siÚ
)

	)

56 
	#CAPI_SERIAL_LEN
 8

	)

57 
	#CAPI_GET_SERIAL
 
	`_IOWR
('C',0x08,è

	)

63 
	sÿpi_´ofe
 {

64 
__u16
 
	mncÚŒŞËr
;

65 
__u16
 
	mnbchªÃl
;

66 
__u32
 
	mgİtiÚs
;

67 
__u32
 
	msuµÜt1
;

68 
__u32
 
	msuµÜt2
;

69 
__u32
 
	msuµÜt3
;

70 
__u32
 
	m»£rved
[6];

71 
__u32
 
	mmªu
[5];

72 } 
	tÿpi_´ofe
;

74 
	#CAPI_GET_PROFILE
 
	`_IOWR
('C',0x09,
ÿpi_´ofe
)

	)

76 
	sÿpi_mªuçùu»r_cmd
 {

77 
	mcmd
;

78 *
	md©a
;

79 } 
	tÿpi_mªuçùu»r_cmd
;

85 
	#CAPI_MANUFACTURER_CMD
 
	`_IOWR
('C',0x20, 
ÿpi_mªuçùu»r_cmd
)

	)

93 
	#CAPI_GET_ERRCODE
 
	`_IOR
('C',0x21, 
__u16
)

	)

98 
	#CAPI_INSTALLED
 
	`_IOR
('C',0x22, 
__u16
)

	)

106 
	uÿpi_ioùl_¡ruù
 {

107 
__u32
 
	mcÚŒ
;

108 
ÿpi_»gi¡”_·¿ms
 
	m½¬ams
;

109 
__u8
 
	mmªuçùu»r
[
CAPI_MANUFACTURER_LEN
];

110 
ÿpi_v”siÚ
 
	mv”siÚ
;

111 
__u8
 
	m£rŸl
[
CAPI_SERIAL_LEN
];

112 
ÿpi_´ofe
 
	m´ofe
;

113 
ÿpi_mªuçùu»r_cmd
 
	mcmd
;

114 
__u16
 
	m”rcode
;

115 } 
	tÿpi_ioùl_¡ruù
;

121 
	#CAPIFLAG_HIGHJACKING
 0x0001

	)

123 
	#CAPI_GET_FLAGS
 
	`_IOR
('C',0x23, )

	)

124 
	#CAPI_SET_FLAGS
 
	`_IOR
('C',0x24, )

	)

125 
	#CAPI_CLR_FLAGS
 
	`_IOR
('C',0x25, )

	)

127 
	#CAPI_NCCI_OPENCOUNT
 
	`_IOR
('C',0x26, )

	)

129 
	#CAPI_NCCI_GETUNIT
 
	`_IOR
('C',0x27, )

	)

	@/usr/include/linux/cdrom.h

11 #iâdef 
_LINUX_CDROM_H


12 
	#_LINUX_CDROM_H


	)

14 
	~<lšux/ty³s.h
>

15 
	~<asm/by‹Üd”.h
>

46 
	#EDRIVE_CANT_DO_THIS
 
EOPNOTSUPP


	)

53 
	#CDROMPAUSE
 0x5301

	)

54 
	#CDROMRESUME
 0x5302

	)

55 
	#CDROMPLAYMSF
 0x5303

	)

56 
	#CDROMPLAYTRKIND
 0x5304

	)

58 
	#CDROMREADTOCHDR
 0x5305

	)

60 
	#CDROMREADTOCENTRY
 0x5306

	)

62 
	#CDROMSTOP
 0x5307

	)

63 
	#CDROMSTART
 0x5308

	)

64 
	#CDROMEJECT
 0x5309

	)

65 
	#CDROMVOLCTRL
 0x530¨

	)

67 
	#CDROMSUBCHNL
 0x530b

	)

69 
	#CDROMREADMODE2
 0x530ø

	)

71 
	#CDROMREADMODE1
 0x530d

	)

73 
	#CDROMREADAUDIO
 0x530

	)

74 
	#CDROMEJECT_SW
 0x530à

	)

75 
	#CDROMMULTISESSION
 0x5310

	)

78 
	#CDROM_GET_MCN
 0x5311

	)

80 
	#CDROM_GET_UPC
 
CDROM_GET_MCN


	)

82 
	#CDROMRESET
 0x5312

	)

83 
	#CDROMVOLREAD
 0x5313

	)

85 
	#CDROMREADRAW
 0x5314

	)

90 
	#CDROMREADCOOKED
 0x5315

	)

91 
	#CDROMSEEK
 0x5316

	)

97 
	#CDROMPLAYBLK
 0x5317

	)

102 
	#CDROMREADALL
 0x5318

	)

111 
	#CDROMGETSPINDOWN
 0x531d

	)

112 
	#CDROMSETSPINDOWN
 0x531e

	)

119 
	#CDROMCLOSETRAY
 0x5319

	)

120 
	#CDROM_SET_OPTIONS
 0x5320

	)

121 
	#CDROM_CLEAR_OPTIONS
 0x5321

	)

122 
	#CDROM_SELECT_SPEED
 0x5322

	)

123 
	#CDROM_SELECT_DISC
 0x5323

	)

124 
	#CDROM_MEDIA_CHANGED
 0x5325

	)

125 
	#CDROM_DRIVE_STATUS
 0x5326

	)

126 
	#CDROM_DISC_STATUS
 0x5327

	)

127 
	#CDROM_CHANGER_NSLOTS
 0x5328

	)

128 
	#CDROM_LOCKDOOR
 0x5329

	)

129 
	#CDROM_DEBUG
 0x5330

	)

130 
	#CDROM_GET_CAPABILITY
 0x5331

	)

137 
	#CDROMAUDIOBUFSIZ
 0x5382

	)

141 
	#DVD_READ_STRUCT
 0x5390

	)

142 
	#DVD_WRITE_STRUCT
 0x5391

	)

143 
	#DVD_AUTH
 0x5392

	)

145 
	#CDROM_SEND_PACKET
 0x5393

	)

146 
	#CDROM_NEXT_WRITABLE
 0x5394

	)

147 
	#CDROM_LAST_WRITTEN
 0x5395

	)

154 
	scdrom_msf0


156 
__u8
 
	mmšu‹
;

157 
__u8
 
	m£cÚd
;

158 
__u8
 
	mäame
;

162 
	ucdrom_addr


164 
cdrom_msf0
 
	mmsf
;

165 
	mlba
;

169 
	scdrom_msf


171 
__u8
 
	mcdmsf_mš0
;

172 
__u8
 
	mcdmsf_£c0
;

173 
__u8
 
	mcdmsf_äame0
;

174 
__u8
 
	mcdmsf_mš1
;

175 
__u8
 
	mcdmsf_£c1
;

176 
__u8
 
	mcdmsf_äame1
;

180 
	scdrom_ti


182 
__u8
 
	mcdti_Œk0
;

183 
__u8
 
	mcdti_šd0
;

184 
__u8
 
	mcdti_Œk1
;

185 
__u8
 
	mcdti_šd1
;

189 
	scdrom_tochdr


191 
__u8
 
	mcdth_Œk0
;

192 
__u8
 
	mcdth_Œk1
;

196 
	scdrom_vŞù¾


198 
__u8
 
	mchªÃl0
;

199 
__u8
 
	mchªÃl1
;

200 
__u8
 
	mchªÃl2
;

201 
__u8
 
	mchªÃl3
;

205 
	scdrom_subchÆ


207 
__u8
 
	mcdsc_fÜm©
;

208 
__u8
 
	mcdsc_audio¡©us
;

209 
__u8
 
	mcdsc_adr
: 4;

210 
__u8
 
	mcdsc_ù¾
: 4;

211 
__u8
 
	mcdsc_Œk
;

212 
__u8
 
	mcdsc_šd
;

213 
cdrom_addr
 
	mcdsc_ab§ddr
;

214 
cdrom_addr
 
	mcdsc_»Ïddr
;

219 
	scdrom_toûÁry


221 
__u8
 
	mcd‹_Œack
;

222 
__u8
 
	mcd‹_adr
 :4;

223 
__u8
 
	mcd‹_ù¾
 :4;

224 
__u8
 
	mcd‹_fÜm©
;

225 
cdrom_addr
 
	mcd‹_addr
;

226 
__u8
 
	mcd‹_d©amode
;

230 
	scdrom_»ad


232 
	mcd»ad_lba
;

233 *
	mcd»ad_buçddr
;

234 
	mcd»ad_buæ’
;

238 
	scdrom_»ad_audio


240 
cdrom_addr
 
	maddr
;

241 
__u8
 
	maddr_fÜm©
;

242 
	mnäames
;

243 
__u8
 *
	mbuf
;

247 
	scdrom_muÉi£ssiÚ


249 
cdrom_addr
 
	maddr
;

252 
__u8
 
	mxa_æag
;

253 
__u8
 
	maddr_fÜm©
;

261 
	scdrom_mú


263 
__u8
 
	mmedium_ÿlog_numb”
[14];

267 
	scdrom_blk


269 
	mäom
;

270 
	mËn
;

273 
	#CDROM_PACKET_SIZE
 12

	)

275 
	#CGC_DATA_UNKNOWN
 0

	)

276 
	#CGC_DATA_WRITE
 1

	)

277 
	#CGC_DATA_READ
 2

	)

278 
	#CGC_DATA_NONE
 3

	)

281 
	scdrom_g’”ic_commªd


283 
	mcmd
[
CDROM_PACKET_SIZE
];

284 *
	mbufãr
;

285 
	mbuæ’
;

286 
	m¡©
;

287 
»que¡_£n£
 *
	m£n£
;

288 
	md©a_dœeùiÚ
;

289 
	mqu›t
;

290 
	mtimeout
;

291 *
	m»£rved
[1];

329 
	#CD_MINS
 74

	)

330 
	#CD_SECS
 60

	)

331 
	#CD_FRAMES
 75

	)

332 
	#CD_SYNC_SIZE
 12

	)

333 
	#CD_MSF_OFFSET
 150

	)

334 
	#CD_CHUNK_SIZE
 24

	)

335 
	#CD_NUM_OF_CHUNKS
 98

	)

336 
	#CD_FRAMESIZE_SUB
 96

	)

337 
	#CD_HEAD_SIZE
 4

	)

338 
	#CD_SUBHEAD_SIZE
 8

	)

339 
	#CD_EDC_SIZE
 4

	)

340 
	#CD_ZERO_SIZE
 8

	)

341 
	#CD_ECC_SIZE
 276

	)

342 
	#CD_FRAMESIZE
 2048

	)

343 
	#CD_FRAMESIZE_RAW
 2352

	)

344 
	#CD_FRAMESIZE_RAWER
 2646

	)

346 
	#CD_FRAMESIZE_RAW1
 (
CD_FRAMESIZE_RAW
-
CD_SYNC_SIZE
è

	)

347 
	#CD_FRAMESIZE_RAW0
 (
CD_FRAMESIZE_RAW
-
CD_SYNC_SIZE
-
CD_HEAD_SIZE
è

	)

349 
	#CD_XA_HEAD
 (
CD_HEAD_SIZE
+
CD_SUBHEAD_SIZE
è

	)

350 
	#CD_XA_TAIL
 (
CD_EDC_SIZE
+
CD_ECC_SIZE
è

	)

351 
	#CD_XA_SYNC_HEAD
 (
CD_SYNC_SIZE
+
CD_XA_HEAD
è

	)

354 
	#CDROM_LBA
 0x01

	)

355 
	#CDROM_MSF
 0x02

	)

358 
	#CDROM_DATA_TRACK
 0x04

	)

361 
	#CDROM_LEADOUT
 0xAA

	)

364 
	#CDROM_AUDIO_INVALID
 0x00

	)

365 
	#CDROM_AUDIO_PLAY
 0x11

	)

366 
	#CDROM_AUDIO_PAUSED
 0x12

	)

367 
	#CDROM_AUDIO_COMPLETED
 0x13

	)

368 
	#CDROM_AUDIO_ERROR
 0x14

	)

369 
	#CDROM_AUDIO_NO_STATUS
 0x15

	)

372 
	#CDC_CLOSE_TRAY
 0x1

	)

373 
	#CDC_OPEN_TRAY
 0x2

	)

374 
	#CDC_LOCK
 0x4

	)

375 
	#CDC_SELECT_SPEED
 0x8

	)

376 
	#CDC_SELECT_DISC
 0x10

	)

377 
	#CDC_MULTI_SESSION
 0x20

	)

378 
	#CDC_MCN
 0x40

	)

379 
	#CDC_MEDIA_CHANGED
 0x80

	)

380 
	#CDC_PLAY_AUDIO
 0x100

	)

381 
	#CDC_RESET
 0x200

	)

382 
	#CDC_DRIVE_STATUS
 0x800

	)

383 
	#CDC_GENERIC_PACKET
 0x1000

	)

384 
	#CDC_CD_R
 0x2000

	)

385 
	#CDC_CD_RW
 0x4000

	)

386 
	#CDC_DVD
 0x8000

	)

387 
	#CDC_DVD_R
 0x10000

	)

388 
	#CDC_DVD_RAM
 0x20000

	)

389 
	#CDC_MO_DRIVE
 0x40000

	)

390 
	#CDC_MRW
 0x80000

	)

391 
	#CDC_MRW_W
 0x100000

	)

392 
	#CDC_RAM
 0x200000

	)

395 
	#CDS_NO_INFO
 0

	)

396 
	#CDS_NO_DISC
 1

	)

397 
	#CDS_TRAY_OPEN
 2

	)

398 
	#CDS_DRIVE_NOT_READY
 3

	)

399 
	#CDS_DISC_OK
 4

	)

403 
	#CDS_AUDIO
 100

	)

404 
	#CDS_DATA_1
 101

	)

405 
	#CDS_DATA_2
 102

	)

406 
	#CDS_XA_2_1
 103

	)

407 
	#CDS_XA_2_2
 104

	)

408 
	#CDS_MIXED
 105

	)

411 
	#CDO_AUTO_CLOSE
 0x1

	)

412 
	#CDO_AUTO_EJECT
 0x2

	)

413 
	#CDO_USE_FFLAGS
 0x4

	)

414 
	#CDO_LOCK
 0x8

	)

415 
	#CDO_CHECK_TYPE
 0x10

	)

418 
	#CDSL_NONE
 (
INT_MAX
-1)

	)

419 
	#CDSL_CURRENT
 
INT_MAX


	)

426 
	#CD_PART_MAX
 64

	)

427 
	#CD_PART_MASK
 (
CD_PART_MAX
 - 1)

	)

435 
	#GPCMD_BLANK
 0xa1

	)

436 
	#GPCMD_CLOSE_TRACK
 0x5b

	)

437 
	#GPCMD_FLUSH_CACHE
 0x35

	)

438 
	#GPCMD_FORMAT_UNIT
 0x04

	)

439 
	#GPCMD_GET_CONFIGURATION
 0x46

	)

440 
	#GPCMD_GET_EVENT_STATUS_NOTIFICATION
 0x4a

	)

441 
	#GPCMD_GET_PERFORMANCE
 0xac

	)

442 
	#GPCMD_INQUIRY
 0x12

	)

443 
	#GPCMD_LOAD_UNLOAD
 0xa6

	)

444 
	#GPCMD_MECHANISM_STATUS
 0xbd

	)

445 
	#GPCMD_MODE_SELECT_10
 0x55

	)

446 
	#GPCMD_MODE_SENSE_10
 0x5a

	)

447 
	#GPCMD_PAUSE_RESUME
 0x4b

	)

448 
	#GPCMD_PLAY_AUDIO_10
 0x45

	)

449 
	#GPCMD_PLAY_AUDIO_MSF
 0x47

	)

450 
	#GPCMD_PLAY_AUDIO_TI
 0x48

	)

451 
	#GPCMD_PLAY_CD
 0xbc

	)

452 
	#GPCMD_PREVENT_ALLOW_MEDIUM_REMOVAL
 0x1e

	)

453 
	#GPCMD_READ_10
 0x28

	)

454 
	#GPCMD_READ_12
 0xa8

	)

455 
	#GPCMD_READ_BUFFER
 0x3c

	)

456 
	#GPCMD_READ_BUFFER_CAPACITY
 0x5c

	)

457 
	#GPCMD_READ_CDVD_CAPACITY
 0x25

	)

458 
	#GPCMD_READ_CD
 0xbe

	)

459 
	#GPCMD_READ_CD_MSF
 0xb9

	)

460 
	#GPCMD_READ_DISC_INFO
 0x51

	)

461 
	#GPCMD_READ_DVD_STRUCTURE
 0xad

	)

462 
	#GPCMD_READ_FORMAT_CAPACITIES
 0x23

	)

463 
	#GPCMD_READ_HEADER
 0x44

	)

464 
	#GPCMD_READ_TRACK_RZONE_INFO
 0x52

	)

465 
	#GPCMD_READ_SUBCHANNEL
 0x42

	)

466 
	#GPCMD_READ_TOC_PMA_ATIP
 0x43

	)

467 
	#GPCMD_REPAIR_RZONE_TRACK
 0x58

	)

468 
	#GPCMD_REPORT_KEY
 0xa4

	)

469 
	#GPCMD_REQUEST_SENSE
 0x03

	)

470 
	#GPCMD_RESERVE_RZONE_TRACK
 0x53

	)

471 
	#GPCMD_SEND_CUE_SHEET
 0x5d

	)

472 
	#GPCMD_SCAN
 0xba

	)

473 
	#GPCMD_SEEK
 0x2b

	)

474 
	#GPCMD_SEND_DVD_STRUCTURE
 0xbf

	)

475 
	#GPCMD_SEND_EVENT
 0xa2

	)

476 
	#GPCMD_SEND_KEY
 0xa3

	)

477 
	#GPCMD_SEND_OPC
 0x54

	)

478 
	#GPCMD_SET_READ_AHEAD
 0xa7

	)

479 
	#GPCMD_SET_STREAMING
 0xb6

	)

480 
	#GPCMD_START_STOP_UNIT
 0x1b

	)

481 
	#GPCMD_STOP_PLAY_SCAN
 0x4e

	)

482 
	#GPCMD_TEST_UNIT_READY
 0x00

	)

483 
	#GPCMD_VERIFY_10
 0x2f

	)

484 
	#GPCMD_WRITE_10
 0x2a

	)

485 
	#GPCMD_WRITE_12
 0x¯

	)

486 
	#GPCMD_WRITE_AND_VERIFY_10
 0x2e

	)

487 
	#GPCMD_WRITE_BUFFER
 0x3b

	)

492 
	#GPCMD_SET_SPEED
 0xbb

	)

495 
	#GPCMD_PLAYAUDIO_TI
 0x48

	)

500 
	#GPCMD_GET_MEDIA_STATUS
 0xda

	)

503 
	#GPMODE_VENDOR_PAGE
 0x00

	)

504 
	#GPMODE_R_W_ERROR_PAGE
 0x01

	)

505 
	#GPMODE_WRITE_PARMS_PAGE
 0x05

	)

506 
	#GPMODE_WCACHING_PAGE
 0x08

	)

507 
	#GPMODE_AUDIO_CTL_PAGE
 0x0e

	)

508 
	#GPMODE_POWER_PAGE
 0x1a

	)

509 
	#GPMODE_FAULT_FAIL_PAGE
 0x1c

	)

510 
	#GPMODE_TO_PROTECT_PAGE
 0x1d

	)

511 
	#GPMODE_CAPABILITIES_PAGE
 0x2a

	)

512 
	#GPMODE_ALL_PAGES
 0x3f

	)

515 
	#GPMODE_CDROM_PAGE
 0x0d

	)

520 
	#DVD_STRUCT_PHYSICAL
 0x00

	)

521 
	#DVD_STRUCT_COPYRIGHT
 0x01

	)

522 
	#DVD_STRUCT_DISCKEY
 0x02

	)

523 
	#DVD_STRUCT_BCA
 0x03

	)

524 
	#DVD_STRUCT_MANUFACT
 0x04

	)

526 
	sdvd_Ïy”
 {

527 
__u8
 
	mbook_v”siÚ
 : 4;

528 
__u8
 
	mbook_ty³
 : 4;

529 
__u8
 
	mmš_¿‹
 : 4;

530 
__u8
 
	mdisc_size
 : 4;

531 
__u8
 
	mÏy”_ty³
 : 4;

532 
__u8
 
	mŒack_·th
 : 1;

533 
__u8
 
	mÆay”s
 : 2;

534 
__u8
 
	mŒack_d’s™y
 : 4;

535 
__u8
 
	mlš—r_d’s™y
 : 4;

536 
__u8
 
	mbÿ
 : 1;

537 
__u32
 
	m¡¬t_£ùÜ
;

538 
__u32
 
	m’d_£ùÜ
;

539 
__u32
 
	m’d_£ùÜ_l0
;

542 
	#DVD_LAYERS
 4

	)

544 
	sdvd_physiÿl
 {

545 
__u8
 
	mty³
;

546 
__u8
 
	mÏy”_num
;

547 
dvd_Ïy”
 
	mÏy”
[
DVD_LAYERS
];

550 
	sdvd_cİyright
 {

551 
__u8
 
	mty³
;

553 
__u8
 
	mÏy”_num
;

554 
__u8
 
	mı¡
;

555 
__u8
 
	mrmi
;

558 
	sdvd_disckey
 {

559 
__u8
 
	mty³
;

561 
	magid
 : 2;

562 
__u8
 
	mv®ue
[2048];

565 
	sdvd_bÿ
 {

566 
__u8
 
	mty³
;

568 
	mËn
;

569 
__u8
 
	mv®ue
[188];

572 
	sdvd_mªuçù
 {

573 
__u8
 
	mty³
;

575 
__u8
 
	mÏy”_num
;

576 
	mËn
;

577 
__u8
 
	mv®ue
[2048];

581 
__u8
 
	mty³
;

583 
dvd_physiÿl
 
	mphysiÿl
;

584 
dvd_cİyright
 
	mcİyright
;

585 
dvd_disckey
 
	mdisckey
;

586 
dvd_bÿ
 
	mbÿ
;

587 
dvd_mªuçù
 
	mmªuçù
;

588 } 
	tdvd_¡ruù
;

595 
	#DVD_LU_SEND_AGID
 0

	)

596 
	#DVD_HOST_SEND_CHALLENGE
 1

	)

597 
	#DVD_LU_SEND_KEY1
 2

	)

598 
	#DVD_LU_SEND_CHALLENGE
 3

	)

599 
	#DVD_HOST_SEND_KEY2
 4

	)

602 
	#DVD_AUTH_ESTABLISHED
 5

	)

603 
	#DVD_AUTH_FAILURE
 6

	)

606 
	#DVD_LU_SEND_TITLE_KEY
 7

	)

607 
	#DVD_LU_SEND_ASF
 8

	)

608 
	#DVD_INVALIDATE_AGID
 9

	)

609 
	#DVD_LU_SEND_RPC_STATE
 10

	)

610 
	#DVD_HOST_SEND_RPC_STATE
 11

	)

613 
__u8
 
	tdvd_key
[5];

614 
__u8
 
	tdvd_ch®Ënge
[10];

616 
	sdvd_lu_£nd_agid
 {

617 
__u8
 
	mty³
;

618 
	magid
 : 2;

621 
	sdvd_ho¡_£nd_ch®Ënge
 {

622 
__u8
 
	mty³
;

623 
	magid
 : 2;

625 
dvd_ch®Ënge
 
	mch®
;

628 
	sdvd_£nd_key
 {

629 
__u8
 
	mty³
;

630 
	magid
 : 2;

632 
dvd_key
 
	mkey
;

635 
	sdvd_lu_£nd_ch®Ënge
 {

636 
__u8
 
	mty³
;

637 
	magid
 : 2;

639 
dvd_ch®Ënge
 
	mch®
;

642 
	#DVD_CPM_NO_COPYRIGHT
 0

	)

643 
	#DVD_CPM_COPYRIGHTED
 1

	)

645 
	#DVD_CP_SEC_NONE
 0

	)

646 
	#DVD_CP_SEC_EXIST
 1

	)

648 
	#DVD_CGMS_UNRESTRICTED
 0

	)

649 
	#DVD_CGMS_SINGLE
 2

	)

650 
	#DVD_CGMS_RESTRICTED
 3

	)

652 
	sdvd_lu_£nd_t™Ë_key
 {

653 
__u8
 
	mty³
;

654 
	magid
 : 2;

656 
dvd_key
 
	mt™Ë_key
;

657 
	mlba
;

658 
	mım
 : 1;

659 
	mı_£c
 : 1;

660 
	mcgms
 : 2;

663 
	sdvd_lu_£nd_asf
 {

664 
__u8
 
	mty³
;

665 
	magid
 : 2;

667 
	masf
 : 1;

670 
	sdvd_ho¡_£nd_½c¡©e
 {

671 
__u8
 
	mty³
;

672 
__u8
 
	mpdrc
;

675 
	sdvd_lu_£nd_½c¡©e
 {

676 
__u8
 
	mty³
 : 2;

677 
__u8
 
	mv¿
 : 3;

678 
__u8
 
	mucÿ
 : 3;

679 
__u8
 
	m»giÚ_mask
;

680 
__u8
 
	m½c_scheme
;

684 
__u8
 
	mty³
;

686 
dvd_lu_£nd_agid
 
	ml§
;

687 
dvd_ho¡_£nd_ch®Ënge
 
	mhsc
;

688 
dvd_£nd_key
 
	mlsk
;

689 
dvd_lu_£nd_ch®Ënge
 
	mlsc
;

690 
dvd_£nd_key
 
	mhsk
;

691 
dvd_lu_£nd_t™Ë_key
 
	ml¡k
;

692 
dvd_lu_£nd_asf
 
	ml§sf
;

693 
dvd_ho¡_£nd_½c¡©e
 
	mh½cs
;

694 
dvd_lu_£nd_½c¡©e
 
	mÌpcs
;

695 } 
	tdvd_authšfo
;

697 
	s»que¡_£n£
 {

698 #ià
defšed
(
__BIG_ENDIAN_BITFIELD
)

699 
__u8
 
	mv®id
 : 1;

700 
__u8
 
	m”rÜ_code
 : 7;

701 #–ià
defšed
(
__LITTLE_ENDIAN_BITFIELD
)

702 
__u8
 
	m”rÜ_code
 : 7;

703 
__u8
 
	mv®id
 : 1;

705 
__u8
 
	m£gm’t_numb”
;

706 #ià
defšed
(
__BIG_ENDIAN_BITFIELD
)

707 
__u8
 
	m»£rved1
 : 2;

708 
__u8
 
	mi
 : 1;

709 
__u8
 
	m»£rved2
 : 1;

710 
__u8
 
	m£n£_key
 : 4;

711 #–ià
defšed
(
__LITTLE_ENDIAN_BITFIELD
)

712 
__u8
 
	m£n£_key
 : 4;

713 
__u8
 
	m»£rved2
 : 1;

714 
__u8
 
	mi
 : 1;

715 
__u8
 
	m»£rved1
 : 2;

717 
__u8
 
	mšfÜm©iÚ
[4];

718 
__u8
 
	madd_£n£_Ën
;

719 
__u8
 
	mcommªd_šfo
[4];

720 
__u8
 
	masc
;

721 
__u8
 
	mascq
;

722 
__u8
 
	mäuc
;

723 
__u8
 
	msks
[3];

724 
__u8
 
	masb
[46];

730 
	#CDF_RWRT
 0x0020

	)

731 
	#CDF_HWDM
 0x0024

	)

732 
	#CDF_MRW
 0x0028

	)

737 
	#CDM_MRW_NOTMRW
 0

	)

738 
	#CDM_MRW_BGFORMAT_INACTIVE
 1

	)

739 
	#CDM_MRW_BGFORMAT_ACTIVE
 2

	)

740 
	#CDM_MRW_BGFORMAT_COMPLETE
 3

	)

745 
	#MRW_LBA_DMA
 0

	)

746 
	#MRW_LBA_GAA
 1

	)

752 
	#MRW_MODE_PC_PRE1
 0x2c

	)

753 
	#MRW_MODE_PC
 0x03

	)

755 
	smrw_ã©u»_desc
 {

756 
__be16
 
	mã©u»_code
;

757 #ià
defšed
(
__BIG_ENDIAN_BITFIELD
)

758 
__u8
 
	m»£rved1
 : 2;

759 
__u8
 
	mã©u»_v”siÚ
 : 4;

760 
__u8
 
	m³rsi¡’t
 : 1;

761 
__u8
 
	mcu¼
 : 1;

762 #–ià
defšed
(
__LITTLE_ENDIAN_BITFIELD
)

763 
__u8
 
	mcu¼
 : 1;

764 
__u8
 
	m³rsi¡’t
 : 1;

765 
__u8
 
	mã©u»_v”siÚ
 : 4;

766 
__u8
 
	m»£rved1
 : 2;

768 
__u8
 
	madd_Ën
;

769 #ià
defšed
(
__BIG_ENDIAN_BITFIELD
)

770 
__u8
 
	m»£rved2
 : 7;

771 
__u8
 
	mwr™e
 : 1;

772 #–ià
defšed
(
__LITTLE_ENDIAN_BITFIELD
)

773 
__u8
 
	mwr™e
 : 1;

774 
__u8
 
	m»£rved2
 : 7;

776 
__u8
 
	m»£rved3
;

777 
__u8
 
	m»£rved4
;

778 
__u8
 
	m»£rved5
;

782 
	srw¹_ã©u»_desc
 {

783 
__be16
 
	mã©u»_code
;

784 #ià
defšed
(
__BIG_ENDIAN_BITFIELD
)

785 
__u8
 
	m»£rved1
 : 2;

786 
__u8
 
	mã©u»_v”siÚ
 : 4;

787 
__u8
 
	m³rsi¡’t
 : 1;

788 
__u8
 
	mcu¼
 : 1;

789 #–ià
defšed
(
__LITTLE_ENDIAN_BITFIELD
)

790 
__u8
 
	mcu¼
 : 1;

791 
__u8
 
	m³rsi¡’t
 : 1;

792 
__u8
 
	mã©u»_v”siÚ
 : 4;

793 
__u8
 
	m»£rved1
 : 2;

795 
__u8
 
	madd_Ën
;

796 
__u32
 
	mÏ¡_lba
;

797 
__u32
 
	mblock_size
;

798 
__u16
 
	mblockšg
;

799 #ià
defšed
(
__BIG_ENDIAN_BITFIELD
)

800 
__u8
 
	m»£rved2
 : 7;

801 
__u8
 
	m·ge_´e£Á
 : 1;

802 #–ià
defšed
(
__LITTLE_ENDIAN_BITFIELD
)

803 
__u8
 
	m·ge_´e£Á
 : 1;

804 
__u8
 
	m»£rved2
 : 7;

806 
__u8
 
	m»£rved3
;

810 
__be16
 
	mdisc_šfÜm©iÚ_Ëngth
;

811 #ià
defšed
(
__BIG_ENDIAN_BITFIELD
)

812 
__u8
 
	m»£rved1
 : 3;

813 
__u8
 
	m”a§bË
 : 1;

814 
__u8
 
	mbÜd”_¡©us
 : 2;

815 
__u8
 
	mdisc_¡©us
 : 2;

816 #–ià
defšed
(
__LITTLE_ENDIAN_BITFIELD
)

817 
__u8
 
	mdisc_¡©us
 : 2;

818 
__u8
 
	mbÜd”_¡©us
 : 2;

819 
__u8
 
	m”a§bË
 : 1;

820 
__u8
 
	m»£rved1
 : 3;

824 
__u8
 
	mn_fœ¡_Œack
;

825 
__u8
 
	mn_£ssiÚs_lsb
;

826 
__u8
 
	mfœ¡_Œack_lsb
;

827 
__u8
 
	mÏ¡_Œack_lsb
;

828 #ià
defšed
(
__BIG_ENDIAN_BITFIELD
)

829 
__u8
 
	mdid_v
 : 1;

830 
__u8
 
	mdbc_v
 : 1;

831 
__u8
 
	muru
 : 1;

832 
__u8
 
	m»£rved2
 : 2;

833 
__u8
 
	mdb™
 : 1;

834 
__u8
 
	mmrw_¡©us
 : 2;

835 #–ià
defšed
(
__LITTLE_ENDIAN_BITFIELD
)

836 
__u8
 
	mmrw_¡©us
 : 2;

837 
__u8
 
	mdb™
 : 1;

838 
__u8
 
	m»£rved2
 : 2;

839 
__u8
 
	muru
 : 1;

840 
__u8
 
	mdbc_v
 : 1;

841 
__u8
 
	mdid_v
 : 1;

843 
__u8
 
	mdisc_ty³
;

844 
__u8
 
	mn_£ssiÚs_msb
;

845 
__u8
 
	mfœ¡_Œack_msb
;

846 
__u8
 
	mÏ¡_Œack_msb
;

847 
__u32
 
	mdisc_id
;

848 
__u32
 
	mËad_š
;

849 
__u32
 
	mËad_out
;

850 
__u8
 
	mdisc_b¬_code
[8];

851 
__u8
 
	m»£rved3
;

852 
__u8
 
	mn_İc
;

853 } 
	tdisc_šfÜm©iÚ
;

856 
__be16
 
	mŒack_šfÜm©iÚ_Ëngth
;

857 
__u8
 
	mŒack_lsb
;

858 
__u8
 
	m£ssiÚ_lsb
;

859 
__u8
 
	m»£rved1
;

860 #ià
defšed
(
__BIG_ENDIAN_BITFIELD
)

861 
__u8
 
	m»£rved2
 : 2;

862 
__u8
 
	mdamage
 : 1;

863 
__u8
 
	mcİy
 : 1;

864 
__u8
 
	mŒack_mode
 : 4;

865 
__u8
 
	m¹
 : 1;

866 
__u8
 
	mbÏnk
 : 1;

867 
__u8
 
	m·ck‘
 : 1;

868 
__u8
 
	må
 : 1;

869 
__u8
 
	md©a_mode
 : 4;

870 
__u8
 
	m»£rved3
 : 6;

871 
__u8
 
	mÌa_v
 : 1;

872 
__u8
 
	mnwa_v
 : 1;

873 #–ià
defšed
(
__LITTLE_ENDIAN_BITFIELD
)

874 
__u8
 
	mŒack_mode
 : 4;

875 
__u8
 
	mcİy
 : 1;

876 
__u8
 
	mdamage
 : 1;

877 
__u8
 
	m»£rved2
 : 2;

878 
__u8
 
	md©a_mode
 : 4;

879 
__u8
 
	må
 : 1;

880 
__u8
 
	m·ck‘
 : 1;

881 
__u8
 
	mbÏnk
 : 1;

882 
__u8
 
	m¹
 : 1;

883 
__u8
 
	mnwa_v
 : 1;

884 
__u8
 
	mÌa_v
 : 1;

885 
__u8
 
	m»£rved3
 : 6;

887 
__be32
 
	mŒack_¡¬t
;

888 
__be32
 
	mÃxt_wr™abË
;

889 
__be32
 
	mä“_blocks
;

890 
__be32
 
	mfixed_·ck‘_size
;

891 
__be32
 
	mŒack_size
;

892 
__be32
 
	mÏ¡_»c_add»ss
;

893 } 
	tŒack_šfÜm©iÚ
;

895 
	sã©u»_h—d”
 {

896 
__u32
 
	md©a_Ën
;

897 
__u8
 
	m»£rved1
;

898 
__u8
 
	m»£rved2
;

899 
__u16
 
	mcu¼_´ofe
;

902 
	smode_·ge_h—d”
 {

903 
__be16
 
	mmode_d©a_Ëngth
;

904 
__u8
 
	mmedium_ty³
;

905 
__u8
 
	m»£rved1
;

906 
__u8
 
	m»£rved2
;

907 
__u8
 
	m»£rved3
;

908 
__be16
 
	mdesc_Ëngth
;

	@/usr/include/linux/cn_proc.h

18 #iâdeà
CN_PROC_H


19 
	#CN_PROC_H


	)

21 
	~<lšux/ty³s.h
>

27 
	e´oc_ú_mÿ¡_İ
 {

28 
	mPROC_CN_MCAST_LISTEN
 = 1,

29 
	mPROC_CN_MCAST_IGNORE
 = 2

45 
	s´oc_ev’t
 {

46 
	ewh©
 {

50 
	mPROC_EVENT_NONE
 = 0x00000000,

51 
	mPROC_EVENT_FORK
 = 0x00000001,

52 
	mPROC_EVENT_EXEC
 = 0x00000002,

53 
	mPROC_EVENT_UID
 = 0x00000004,

54 
	mPROC_EVENT_GID
 = 0x00000040,

55 
	mPROC_EVENT_SID
 = 0x00000080,

56 
	mPROC_EVENT_PTRACE
 = 0x00000100,

57 
	mPROC_EVENT_COMM
 = 0x00000200,

60 
	mPROC_EVENT_EXIT
 = 0x80000000

61 } 
	mwh©
;

62 
__u32
 
	mıu
;

63 
__u64
 
__©Œibu‹__
((
®igÃd
(8))è
	mtime¡amp_ns
;

67 
__u32
 
	m”r
;

68 } 
	mack
;

70 
	sfÜk_´oc_ev’t
 {

71 
__k”Ãl_pid_t
 
	m·»Á_pid
;

72 
__k”Ãl_pid_t
 
	m·»Á_tgid
;

73 
__k”Ãl_pid_t
 
	mchd_pid
;

74 
__k”Ãl_pid_t
 
	mchd_tgid
;

75 } 
	mfÜk
;

77 
	sexec_´oc_ev’t
 {

78 
__k”Ãl_pid_t
 
	m´oûss_pid
;

79 
__k”Ãl_pid_t
 
	m´oûss_tgid
;

80 } 
	mexec
;

82 
	sid_´oc_ev’t
 {

83 
__k”Ãl_pid_t
 
	m´oûss_pid
;

84 
__k”Ãl_pid_t
 
	m´oûss_tgid
;

86 
__u32
 
	mruid
;

87 
__u32
 
	mrgid
;

88 } 
	mr
;

90 
__u32
 
	meuid
;

91 
__u32
 
	megid
;

92 } 
	me
;

93 } 
	mid
;

95 
	ssid_´oc_ev’t
 {

96 
__k”Ãl_pid_t
 
	m´oûss_pid
;

97 
__k”Ãl_pid_t
 
	m´oûss_tgid
;

98 } 
	msid
;

100 
	s±¿û_´oc_ev’t
 {

101 
__k”Ãl_pid_t
 
	m´oûss_pid
;

102 
__k”Ãl_pid_t
 
	m´oûss_tgid
;

103 
__k”Ãl_pid_t
 
	mŒaûr_pid
;

104 
__k”Ãl_pid_t
 
	mŒaûr_tgid
;

105 } 
	m±¿û
;

107 
	scomm_´oc_ev’t
 {

108 
__k”Ãl_pid_t
 
	m´oûss_pid
;

109 
__k”Ãl_pid_t
 
	m´oûss_tgid
;

110 
	mcomm
[16];

111 } 
	mcomm
;

113 
	sex™_´oc_ev’t
 {

114 
__k”Ãl_pid_t
 
	m´oûss_pid
;

115 
__k”Ãl_pid_t
 
	m´oûss_tgid
;

116 
__u32
 
	mex™_code
, 
	mex™_sigÇl
;

117 } 
	mex™
;

118 } 
	mev’t_d©a
;

	@/usr/include/linux/dvb/audio.h

24 #iâdeà
_DVBAUDIO_H_


25 
	#_DVBAUDIO_H_


	)

27 
	~<lšux/ty³s.h
>

30 
	mAUDIO_SOURCE_DEMUX
,

31 
	mAUDIO_SOURCE_MEMORY


32 } 
	taudio_¡»am_sourû_t
;

36 
	mAUDIO_STOPPED
,

37 
	mAUDIO_PLAYING
,

38 
	mAUDIO_PAUSED


39 } 
	taudio_¶ay_¡©e_t
;

43 
	mAUDIO_STEREO
,

44 
	mAUDIO_MONO_LEFT
,

45 
	mAUDIO_MONO_RIGHT
,

46 
	mAUDIO_MONO
,

47 
	mAUDIO_STEREO_SWAPPED


48 } 
	taudio_chªÃl_£Ëù_t
;

51 
	saudio_mix”
 {

52 
	mvŞume_Ëá
;

53 
	mvŞume_right
;

55 } 
	taudio_mix”_t
;

58 
	saudio_¡©us
 {

59 
	mAV_sync_¡©e
;

60 
	mmu‹_¡©e
;

61 
audio_¶ay_¡©e_t
 
	m¶ay_¡©e
;

62 
audio_¡»am_sourû_t
 
	m¡»am_sourû
;

63 
audio_chªÃl_£Ëù_t
 
	mchªÃl_£Ëù
;

64 
	mby·ss_mode
;

65 
audio_mix”_t
 
	mmix”_¡©e
;

66 } 
	taudio_¡©us_t
;

70 
	saudio_k¬aoke
 {

71 
	mvoÿl1
;

72 
	mvoÿl2
;

73 
	mm–ody
;

76 } 
	taudio_k¬aoke_t
;

79 
__u16
 
	taudio_©Œibu‹s_t
;

91 
	#AUDIO_CAP_DTS
 1

	)

92 
	#AUDIO_CAP_LPCM
 2

	)

93 
	#AUDIO_CAP_MP1
 4

	)

94 
	#AUDIO_CAP_MP2
 8

	)

95 
	#AUDIO_CAP_MP3
 16

	)

96 
	#AUDIO_CAP_AAC
 32

	)

97 
	#AUDIO_CAP_OGG
 64

	)

98 
	#AUDIO_CAP_SDDS
 128

	)

99 
	#AUDIO_CAP_AC3
 256

	)

101 
	#AUDIO_STOP
 
	`_IO
('o', 1)

	)

102 
	#AUDIO_PLAY
 
	`_IO
('o', 2)

	)

103 
	#AUDIO_PAUSE
 
	`_IO
('o', 3)

	)

104 
	#AUDIO_CONTINUE
 
	`_IO
('o', 4)

	)

105 
	#AUDIO_SELECT_SOURCE
 
	`_IO
('o', 5)

	)

106 
	#AUDIO_SET_MUTE
 
	`_IO
('o', 6)

	)

107 
	#AUDIO_SET_AV_SYNC
 
	`_IO
('o', 7)

	)

108 
	#AUDIO_SET_BYPASS_MODE
 
	`_IO
('o', 8)

	)

109 
	#AUDIO_CHANNEL_SELECT
 
	`_IO
('o', 9)

	)

110 
	#AUDIO_GET_STATUS
 
	`_IOR
('o', 10, 
audio_¡©us_t
)

	)

112 
	#AUDIO_GET_CAPABILITIES
 
	`_IOR
('o', 11, )

	)

113 
	#AUDIO_CLEAR_BUFFER
 
	`_IO
('o', 12)

	)

114 
	#AUDIO_SET_ID
 
	`_IO
('o', 13)

	)

115 
	#AUDIO_SET_MIXER
 
	`_IOW
('o', 14, 
audio_mix”_t
)

	)

116 
	#AUDIO_SET_STREAMTYPE
 
	`_IO
('o', 15)

	)

117 
	#AUDIO_SET_EXT_ID
 
	`_IO
('o', 16)

	)

118 
	#AUDIO_SET_ATTRIBUTES
 
	`_IOW
('o', 17, 
audio_©Œibu‹s_t
)

	)

119 
	#AUDIO_SET_KARAOKE
 
	`_IOW
('o', 18, 
audio_k¬aoke_t
)

	)

132 
	#AUDIO_GET_PTS
 
	`_IOR
('o', 19, 
__u64
)

	)

133 
	#AUDIO_BILINGUAL_CHANNEL_SELECT
 
	`_IO
('o', 20)

	)

	@/usr/include/linux/dvb/dmx.h

24 #iâdeà
_DVBDMX_H_


25 
	#_DVBDMX_H_


	)

27 
	~<lšux/ty³s.h
>

28 
	~<time.h
>

31 
	#DMX_FILTER_SIZE
 16

	)

35 
	mDMX_OUT_DECODER
,

36 
	mDMX_OUT_TAP
,

38 
	mDMX_OUT_TS_TAP
,

41 
	mDMX_OUT_TSDEMUX_TAP


42 } 
	tdmx_ouut_t
;

47 
	mDMX_IN_FRONTEND
,

48 
	mDMX_IN_DVR


49 } 
	tdmx_šput_t
;

54 
	mDMX_PES_AUDIO0
,

55 
	mDMX_PES_VIDEO0
,

56 
	mDMX_PES_TELETEXT0
,

57 
	mDMX_PES_SUBTITLE0
,

58 
	mDMX_PES_PCR0
,

60 
	mDMX_PES_AUDIO1
,

61 
	mDMX_PES_VIDEO1
,

62 
	mDMX_PES_TELETEXT1
,

63 
	mDMX_PES_SUBTITLE1
,

64 
	mDMX_PES_PCR1
,

66 
	mDMX_PES_AUDIO2
,

67 
	mDMX_PES_VIDEO2
,

68 
	mDMX_PES_TELETEXT2
,

69 
	mDMX_PES_SUBTITLE2
,

70 
	mDMX_PES_PCR2
,

72 
	mDMX_PES_AUDIO3
,

73 
	mDMX_PES_VIDEO3
,

74 
	mDMX_PES_TELETEXT3
,

75 
	mDMX_PES_SUBTITLE3
,

76 
	mDMX_PES_PCR3
,

78 
	mDMX_PES_OTHER


79 } 
	tdmx_³s_ty³_t
;

81 
	#DMX_PES_AUDIO
 
DMX_PES_AUDIO0


	)

82 
	#DMX_PES_VIDEO
 
DMX_PES_VIDEO0


	)

83 
	#DMX_PES_TELETEXT
 
DMX_PES_TELETEXT0


	)

84 
	#DMX_PES_SUBTITLE
 
DMX_PES_SUBTITLE0


	)

85 
	#DMX_PES_PCR
 
DMX_PES_PCR0


	)

88 
	sdmx_f‹r


90 
__u8
 
	mf‹r
[
DMX_FILTER_SIZE
];

91 
__u8
 
	mmask
[
DMX_FILTER_SIZE
];

92 
__u8
 
	mmode
[
DMX_FILTER_SIZE
];

93 } 
	tdmx_f‹r_t
;

96 
	sdmx_sù_f‹r_·¿ms


98 
__u16
 
	mpid
;

99 
dmx_f‹r_t
 
	mf‹r
;

100 
__u32
 
	mtimeout
;

101 
__u32
 
	mæags
;

102 
	#DMX_CHECK_CRC
 1

	)

103 
	#DMX_ONESHOT
 2

	)

104 
	#DMX_IMMEDIATE_START
 4

	)

105 
	#DMX_KERNEL_CLIENT
 0x8000

	)

109 
	sdmx_³s_f‹r_·¿ms


111 
__u16
 
	mpid
;

112 
dmx_šput_t
 
	mšput
;

113 
dmx_ouut_t
 
	mouut
;

114 
dmx_³s_ty³_t
 
	m³s_ty³
;

115 
__u32
 
	mæags
;

118 
	sdmx_ÿps
 {

119 
__u32
 
	mÿps
;

120 
	mnum_decod”s
;

121 } 
	tdmx_ÿps_t
;

124 
	mDMX_SOURCE_FRONT0
 = 0,

125 
	mDMX_SOURCE_FRONT1
,

126 
	mDMX_SOURCE_FRONT2
,

127 
	mDMX_SOURCE_FRONT3
,

128 
	mDMX_SOURCE_DVR0
 = 16,

129 
	mDMX_SOURCE_DVR1
,

130 
	mDMX_SOURCE_DVR2
,

131 
	mDMX_SOURCE_DVR3


132 } 
	tdmx_sourû_t
;

134 
	sdmx_¡c
 {

135 
	mnum
;

136 
	mba£
;

137 
__u64
 
	m¡c
;

141 
	#DMX_START
 
	`_IO
('o', 41)

	)

142 
	#DMX_STOP
 
	`_IO
('o', 42)

	)

143 
	#DMX_SET_FILTER
 
	`_IOW
('o', 43, 
dmx_sù_f‹r_·¿ms
)

	)

144 
	#DMX_SET_PES_FILTER
 
	`_IOW
('o', 44, 
dmx_³s_f‹r_·¿ms
)

	)

145 
	#DMX_SET_BUFFER_SIZE
 
	`_IO
('o', 45)

	)

146 
	#DMX_GET_PES_PIDS
 
	`_IOR
('o', 47, 
__u16
[5])

	)

147 
	#DMX_GET_CAPS
 
	`_IOR
('o', 48, 
dmx_ÿps_t
)

	)

148 
	#DMX_SET_SOURCE
 
	`_IOW
('o', 49, 
dmx_sourû_t
)

	)

149 
	#DMX_GET_STC
 
	`_IOWR
('o', 50, 
dmx_¡c
)

	)

150 
	#DMX_ADD_PID
 
	`_IOW
('o', 51, 
__u16
)

	)

151 
	#DMX_REMOVE_PID
 
	`_IOW
('o', 52, 
__u16
)

	)

	@/usr/include/linux/dvb/frontend.h

26 #iâdeà
_DVBFRONTEND_H_


27 
	#_DVBFRONTEND_H_


	)

29 
	~<lšux/ty³s.h
>

31 
	eã_ty³
 {

32 
	mFE_QPSK
,

33 
	mFE_QAM
,

34 
	mFE_OFDM
,

35 
	mFE_ATSC


36 } 
	tã_ty³_t
;

39 
	eã_ÿps
 {

40 
	mFE_IS_STUPID
 = 0,

41 
	mFE_CAN_INVERSION_AUTO
 = 0x1,

42 
	mFE_CAN_FEC_1_2
 = 0x2,

43 
	mFE_CAN_FEC_2_3
 = 0x4,

44 
	mFE_CAN_FEC_3_4
 = 0x8,

45 
	mFE_CAN_FEC_4_5
 = 0x10,

46 
	mFE_CAN_FEC_5_6
 = 0x20,

47 
	mFE_CAN_FEC_6_7
 = 0x40,

48 
	mFE_CAN_FEC_7_8
 = 0x80,

49 
	mFE_CAN_FEC_8_9
 = 0x100,

50 
	mFE_CAN_FEC_AUTO
 = 0x200,

51 
	mFE_CAN_QPSK
 = 0x400,

52 
	mFE_CAN_QAM_16
 = 0x800,

53 
	mFE_CAN_QAM_32
 = 0x1000,

54 
	mFE_CAN_QAM_64
 = 0x2000,

55 
	mFE_CAN_QAM_128
 = 0x4000,

56 
	mFE_CAN_QAM_256
 = 0x8000,

57 
	mFE_CAN_QAM_AUTO
 = 0x10000,

58 
	mFE_CAN_TRANSMISSION_MODE_AUTO
 = 0x20000,

59 
	mFE_CAN_BANDWIDTH_AUTO
 = 0x40000,

60 
	mFE_CAN_GUARD_INTERVAL_AUTO
 = 0x80000,

61 
	mFE_CAN_HIERARCHY_AUTO
 = 0x100000,

62 
	mFE_CAN_8VSB
 = 0x200000,

63 
	mFE_CAN_16VSB
 = 0x400000,

64 
	mFE_HAS_EXTENDED_CAPS
 = 0x800000,

65 
	mFE_CAN_TURBO_FEC
 = 0x8000000,

66 
	mFE_CAN_2G_MODULATION
 = 0x10000000,

67 
	mFE_NEEDS_BENDING
 = 0x20000000,

68 
	mFE_CAN_RECOVER
 = 0x40000000,

69 
	mFE_CAN_MUTE_TS
 = 0x80000000

70 } 
	tã_ÿps_t
;

73 
	sdvb_äÚ‹nd_šfo
 {

74 
	mÇme
[128];

75 
ã_ty³_t
 
	mty³
;

76 
__u32
 
	mäequ’cy_mš
;

77 
__u32
 
	mäequ’cy_max
;

78 
__u32
 
	mäequ’cy_¡•size
;

79 
__u32
 
	mäequ’cy_tŞ”ªû
;

80 
__u32
 
	msymbŞ_¿‹_mš
;

81 
__u32
 
	msymbŞ_¿‹_max
;

82 
__u32
 
	msymbŞ_¿‹_tŞ”ªû
;

83 
__u32
 
	mnÙif›r_d–ay
;

84 
ã_ÿps_t
 
	mÿps
;

92 
	sdvb_di£qc_ma¡”_cmd
 {

93 
__u8
 
	mmsg
 [6];

94 
__u8
 
	mmsg_Ën
;

98 
	sdvb_di£qc_¦ave_»¶y
 {

99 
__u8
 
	mmsg
 [4];

100 
__u8
 
	mmsg_Ën
;

101 
	mtimeout
;

105 
	eã_£c_vŞge
 {

106 
	mSEC_VOLTAGE_13
,

107 
	mSEC_VOLTAGE_18
,

108 
	mSEC_VOLTAGE_OFF


109 } 
	tã_£c_vŞge_t
;

112 
	eã_£c_tÚe_mode
 {

113 
	mSEC_TONE_ON
,

114 
	mSEC_TONE_OFF


115 } 
	tã_£c_tÚe_mode_t
;

118 
	eã_£c_mši_cmd
 {

119 
	mSEC_MINI_A
,

120 
	mSEC_MINI_B


121 } 
	tã_£c_mši_cmd_t
;

124 
	eã_¡©us
 {

125 
	mFE_HAS_SIGNAL
 = 0x01,

126 
	mFE_HAS_CARRIER
 = 0x02,

127 
	mFE_HAS_VITERBI
 = 0x04,

128 
	mFE_HAS_SYNC
 = 0x08,

129 
	mFE_HAS_LOCK
 = 0x10,

130 
	mFE_TIMEDOUT
 = 0x20,

131 
	mFE_REINIT
 = 0x40

132 } 
	tã_¡©us_t
;

135 
	eã_¥eù¿l_šv”siÚ
 {

136 
	mINVERSION_OFF
,

137 
	mINVERSION_ON
,

138 
	mINVERSION_AUTO


139 } 
	tã_¥eù¿l_šv”siÚ_t
;

142 
	eã_code_¿‹
 {

143 
	mFEC_NONE
 = 0,

144 
	mFEC_1_2
,

145 
	mFEC_2_3
,

146 
	mFEC_3_4
,

147 
	mFEC_4_5
,

148 
	mFEC_5_6
,

149 
	mFEC_6_7
,

150 
	mFEC_7_8
,

151 
	mFEC_8_9
,

152 
	mFEC_AUTO
,

153 
	mFEC_3_5
,

154 
	mFEC_9_10
,

155 } 
	tã_code_¿‹_t
;

158 
	eã_moduÏtiÚ
 {

159 
	mQPSK
,

160 
	mQAM_16
,

161 
	mQAM_32
,

162 
	mQAM_64
,

163 
	mQAM_128
,

164 
	mQAM_256
,

165 
	mQAM_AUTO
,

166 
	mVSB_8
,

167 
	mVSB_16
,

168 
	mPSK_8
,

169 
	mAPSK_16
,

170 
	mAPSK_32
,

171 
	mDQPSK
,

172 } 
	tã_moduÏtiÚ_t
;

174 
	eã_Œªsm™_mode
 {

175 
	mTRANSMISSION_MODE_2K
,

176 
	mTRANSMISSION_MODE_8K
,

177 
	mTRANSMISSION_MODE_AUTO
,

178 
	mTRANSMISSION_MODE_4K
,

179 
	mTRANSMISSION_MODE_1K
,

180 
	mTRANSMISSION_MODE_16K
,

181 
	mTRANSMISSION_MODE_32K
,

182 } 
	tã_Œªsm™_mode_t
;

184 
	eã_bªdwidth
 {

185 
	mBANDWIDTH_8_MHZ
,

186 
	mBANDWIDTH_7_MHZ
,

187 
	mBANDWIDTH_6_MHZ
,

188 
	mBANDWIDTH_AUTO
,

189 
	mBANDWIDTH_5_MHZ
,

190 
	mBANDWIDTH_10_MHZ
,

191 
	mBANDWIDTH_1_712_MHZ
,

192 } 
	tã_bªdwidth_t
;

195 
	eã_gu¬d_š‹rv®
 {

196 
	mGUARD_INTERVAL_1_32
,

197 
	mGUARD_INTERVAL_1_16
,

198 
	mGUARD_INTERVAL_1_8
,

199 
	mGUARD_INTERVAL_1_4
,

200 
	mGUARD_INTERVAL_AUTO
,

201 
	mGUARD_INTERVAL_1_128
,

202 
	mGUARD_INTERVAL_19_128
,

203 
	mGUARD_INTERVAL_19_256
,

204 } 
	tã_gu¬d_š‹rv®_t
;

207 
	eã_h›¿rchy
 {

208 
	mHIERARCHY_NONE
,

209 
	mHIERARCHY_1
,

210 
	mHIERARCHY_2
,

211 
	mHIERARCHY_4
,

212 
	mHIERARCHY_AUTO


213 } 
	tã_h›¿rchy_t
;

216 
	sdvb_qpsk_·¿m‘”s
 {

217 
__u32
 
	msymbŞ_¿‹
;

218 
ã_code_¿‹_t
 
	mãc_šÃr
;

221 
	sdvb_qam_·¿m‘”s
 {

222 
__u32
 
	msymbŞ_¿‹
;

223 
ã_code_¿‹_t
 
	mãc_šÃr
;

224 
ã_moduÏtiÚ_t
 
	mmoduÏtiÚ
;

227 
	sdvb_vsb_·¿m‘”s
 {

228 
ã_moduÏtiÚ_t
 
	mmoduÏtiÚ
;

231 
	sdvb_ofdm_·¿m‘”s
 {

232 
ã_bªdwidth_t
 
	mbªdwidth
;

233 
ã_code_¿‹_t
 
	mcode_¿‹_HP
;

234 
ã_code_¿‹_t
 
	mcode_¿‹_LP
;

235 
ã_moduÏtiÚ_t
 
	mcÚ¡–ÏtiÚ
;

236 
ã_Œªsm™_mode_t
 
	mŒªsmissiÚ_mode
;

237 
ã_gu¬d_š‹rv®_t
 
	mgu¬d_š‹rv®
;

238 
ã_h›¿rchy_t
 
	mh›¿rchy_šfÜm©iÚ
;

242 
	sdvb_äÚ‹nd_·¿m‘”s
 {

243 
__u32
 
	mäequ’cy
;

245 
ã_¥eù¿l_šv”siÚ_t
 
	mšv”siÚ
;

247 
dvb_qpsk_·¿m‘”s
 
	mqpsk
;

248 
dvb_qam_·¿m‘”s
 
	mqam
;

249 
dvb_ofdm_·¿m‘”s
 
	mofdm
;

250 
dvb_vsb_·¿m‘”s
 
	mvsb
;

251 } 
	mu
;

255 
	sdvb_äÚ‹nd_ev’t
 {

256 
ã_¡©us_t
 
	m¡©us
;

257 
dvb_äÚ‹nd_·¿m‘”s
 
	m·¿m‘”s
;

261 
	#DTV_UNDEFINED
 0

	)

262 
	#DTV_TUNE
 1

	)

263 
	#DTV_CLEAR
 2

	)

264 
	#DTV_FREQUENCY
 3

	)

265 
	#DTV_MODULATION
 4

	)

266 
	#DTV_BANDWIDTH_HZ
 5

	)

267 
	#DTV_INVERSION
 6

	)

268 
	#DTV_DISEQC_MASTER
 7

	)

269 
	#DTV_SYMBOL_RATE
 8

	)

270 
	#DTV_INNER_FEC
 9

	)

271 
	#DTV_VOLTAGE
 10

	)

272 
	#DTV_TONE
 11

	)

273 
	#DTV_PILOT
 12

	)

274 
	#DTV_ROLLOFF
 13

	)

275 
	#DTV_DISEQC_SLAVE_REPLY
 14

	)

278 
	#DTV_FE_CAPABILITY_COUNT
 15

	)

279 
	#DTV_FE_CAPABILITY
 16

	)

280 
	#DTV_DELIVERY_SYSTEM
 17

	)

283 
	#DTV_ISDBT_PARTIAL_RECEPTION
 18

	)

284 
	#DTV_ISDBT_SOUND_BROADCASTING
 19

	)

286 
	#DTV_ISDBT_SB_SUBCHANNEL_ID
 20

	)

287 
	#DTV_ISDBT_SB_SEGMENT_IDX
 21

	)

288 
	#DTV_ISDBT_SB_SEGMENT_COUNT
 22

	)

290 
	#DTV_ISDBT_LAYERA_FEC
 23

	)

291 
	#DTV_ISDBT_LAYERA_MODULATION
 24

	)

292 
	#DTV_ISDBT_LAYERA_SEGMENT_COUNT
 25

	)

293 
	#DTV_ISDBT_LAYERA_TIME_INTERLEAVING
 26

	)

295 
	#DTV_ISDBT_LAYERB_FEC
 27

	)

296 
	#DTV_ISDBT_LAYERB_MODULATION
 28

	)

297 
	#DTV_ISDBT_LAYERB_SEGMENT_COUNT
 29

	)

298 
	#DTV_ISDBT_LAYERB_TIME_INTERLEAVING
 30

	)

300 
	#DTV_ISDBT_LAYERC_FEC
 31

	)

301 
	#DTV_ISDBT_LAYERC_MODULATION
 32

	)

302 
	#DTV_ISDBT_LAYERC_SEGMENT_COUNT
 33

	)

303 
	#DTV_ISDBT_LAYERC_TIME_INTERLEAVING
 34

	)

305 
	#DTV_API_VERSION
 35

	)

307 
	#DTV_CODE_RATE_HP
 36

	)

308 
	#DTV_CODE_RATE_LP
 37

	)

309 
	#DTV_GUARD_INTERVAL
 38

	)

310 
	#DTV_TRANSMISSION_MODE
 39

	)

311 
	#DTV_HIERARCHY
 40

	)

313 
	#DTV_ISDBT_LAYER_ENABLED
 41

	)

315 
	#DTV_ISDBS_TS_ID
 42

	)

317 
	#DTV_DVBT2_PLP_ID
 43

	)

319 
	#DTV_MAX_COMMAND
 
DTV_DVBT2_PLP_ID


	)

321 
	eã_pÙ
 {

322 
	mPILOT_ON
,

323 
	mPILOT_OFF
,

324 
	mPILOT_AUTO
,

325 } 
	tã_pÙ_t
;

327 
	eã_rŞloff
 {

328 
	mROLLOFF_35
,

329 
	mROLLOFF_20
,

330 
	mROLLOFF_25
,

331 
	mROLLOFF_AUTO
,

332 } 
	tã_rŞloff_t
;

334 
	eã_d–iv”y_sy¡em
 {

335 
	mSYS_UNDEFINED
,

336 
	mSYS_DVBC_ANNEX_AC
,

337 
	mSYS_DVBC_ANNEX_B
,

338 
	mSYS_DVBT
,

339 
	mSYS_DSS
,

340 
	mSYS_DVBS
,

341 
	mSYS_DVBS2
,

342 
	mSYS_DVBH
,

343 
	mSYS_ISDBT
,

344 
	mSYS_ISDBS
,

345 
	mSYS_ISDBC
,

346 
	mSYS_ATSC
,

347 
	mSYS_ATSCMH
,

348 
	mSYS_DMBTH
,

349 
	mSYS_CMMB
,

350 
	mSYS_DAB
,

351 
	mSYS_DVBT2
,

352 
	mSYS_TURBO
,

353 } 
	tã_d–iv”y_sy¡em_t
;

355 
	sdtv_cmds_h
 {

356 *
	mÇme
;

358 
__u32
 
	mcmd
;

361 
__u32
 
	m£t
:1;

362 
__u32
 
	mbufãr
:1;

363 
__u32
 
	m»£rved
:30;

366 
	sdtv_´İ”ty
 {

367 
__u32
 
	mcmd
;

368 
__u32
 
	m»£rved
[3];

370 
__u32
 
	md©a
;

372 
__u8
 
	md©a
[32];

373 
__u32
 
	mËn
;

374 
__u32
 
	m»£rved1
[3];

375 *
	m»£rved2
;

376 } 
	mbufãr
;

377 } 
	mu
;

378 
	m»suÉ
;

379 } 
__©Œibu‹__
 ((
·cked
));

382 
	#DTV_IOCTL_MAX_MSGS
 64

	)

384 
	sdtv_´İ”t›s
 {

385 
__u32
 
	mnum
;

386 
dtv_´İ”ty
 *
	m´İs
;

389 
	#FE_SET_PROPERTY
 
	`_IOW
('o', 82, 
dtv_´İ”t›s
)

	)

390 
	#FE_GET_PROPERTY
 
	`_IOR
('o', 83, 
dtv_´İ”t›s
)

	)

400 
	#FE_TUNE_MODE_ONESHOT
 0x01

	)

403 
	#FE_GET_INFO
 
	`_IOR
('o', 61, 
dvb_äÚ‹nd_šfo
)

	)

405 
	#FE_DISEQC_RESET_OVERLOAD
 
	`_IO
('o', 62)

	)

406 
	#FE_DISEQC_SEND_MASTER_CMD
 
	`_IOW
('o', 63, 
dvb_di£qc_ma¡”_cmd
)

	)

407 
	#FE_DISEQC_RECV_SLAVE_REPLY
 
	`_IOR
('o', 64, 
dvb_di£qc_¦ave_»¶y
)

	)

408 
	#FE_DISEQC_SEND_BURST
 
	`_IO
('o', 65è

	)

410 
	#FE_SET_TONE
 
	`_IO
('o', 66è

	)

411 
	#FE_SET_VOLTAGE
 
	`_IO
('o', 67è

	)

412 
	#FE_ENABLE_HIGH_LNB_VOLTAGE
 
	`_IO
('o', 68è

	)

414 
	#FE_READ_STATUS
 
	`_IOR
('o', 69, 
ã_¡©us_t
)

	)

415 
	#FE_READ_BER
 
	`_IOR
('o', 70, 
__u32
)

	)

416 
	#FE_READ_SIGNAL_STRENGTH
 
	`_IOR
('o', 71, 
__u16
)

	)

417 
	#FE_READ_SNR
 
	`_IOR
('o', 72, 
__u16
)

	)

418 
	#FE_READ_UNCORRECTED_BLOCKS
 
	`_IOR
('o', 73, 
__u32
)

	)

420 
	#FE_SET_FRONTEND
 
	`_IOW
('o', 76, 
dvb_äÚ‹nd_·¿m‘”s
)

	)

421 
	#FE_GET_FRONTEND
 
	`_IOR
('o', 77, 
dvb_äÚ‹nd_·¿m‘”s
)

	)

422 
	#FE_SET_FRONTEND_TUNE_MODE
 
	`_IO
('o', 81è

	)

423 
	#FE_GET_EVENT
 
	`_IOR
('o', 78, 
dvb_äÚ‹nd_ev’t
)

	)

425 
	#FE_DISHNETWORK_SEND_LEGACY_CMD
 
	`_IO
('o', 80è

	)

	@/usr/include/linux/dvb/video.h

24 #iâdeà
_DVBVIDEO_H_


25 
	#_DVBVIDEO_H_


	)

27 
	~<lšux/ty³s.h
>

28 
	~<¡dšt.h
>

29 
	~<time.h
>

32 
	mVIDEO_FORMAT_4_3
,

33 
	mVIDEO_FORMAT_16_9
,

34 
	mVIDEO_FORMAT_221_1


35 } 
	tvideo_fÜm©_t
;

39 
	mVIDEO_SYSTEM_PAL
,

40 
	mVIDEO_SYSTEM_NTSC
,

41 
	mVIDEO_SYSTEM_PALN
,

42 
	mVIDEO_SYSTEM_PALNc
,

43 
	mVIDEO_SYSTEM_PALM
,

44 
	mVIDEO_SYSTEM_NTSC60
,

45 
	mVIDEO_SYSTEM_PAL60
,

46 
	mVIDEO_SYSTEM_PALM60


47 } 
	tvideo_sy¡em_t
;

51 
	mVIDEO_PAN_SCAN
,

52 
	mVIDEO_LETTER_BOX
,

53 
	mVIDEO_CENTER_CUT_OUT


54 } 
	tvideo_di¥ÏyfÜm©_t
;

57 
	mw
;

58 
	mh
;

59 
video_fÜm©_t
 
	ma¥eù_¿tio
;

60 } 
	tvideo_size_t
;

63 
	mVIDEO_SOURCE_DEMUX
,

64 
	mVIDEO_SOURCE_MEMORY


67 } 
	tvideo_¡»am_sourû_t
;

71 
	mVIDEO_STOPPED
,

72 
	mVIDEO_PLAYING
,

73 
	mVIDEO_FREEZED


74 } 
	tvideo_¶ay_¡©e_t
;

78 
	#VIDEO_CMD_PLAY
 (0)

	)

79 
	#VIDEO_CMD_STOP
 (1)

	)

80 
	#VIDEO_CMD_FREEZE
 (2)

	)

81 
	#VIDEO_CMD_CONTINUE
 (3)

	)

84 
	#VIDEO_CMD_FREEZE_TO_BLACK
 (1 << 0)

	)

87 
	#VIDEO_CMD_STOP_TO_BLACK
 (1 << 0)

	)

88 
	#VIDEO_CMD_STOP_IMMEDIATELY
 (1 << 1)

	)

92 
	#VIDEO_PLAY_FMT_NONE
 (0)

	)

94 
	#VIDEO_PLAY_FMT_GOP
 (1)

	)

98 
	svideo_commªd
 {

99 
__u32
 
	mcmd
;

100 
__u32
 
	mæags
;

103 
__u64
 
	m±s
;

104 } 
	m¡İ
;

112 
__s32
 
	m¥“d
;

113 
__u32
 
	mfÜm©
;

114 } 
	m¶ay
;

117 
__u32
 
	md©a
[16];

118 } 
	m¿w
;

125 
	#VIDEO_VSYNC_FIELD_UNKNOWN
 (0)

	)

126 
	#VIDEO_VSYNC_FIELD_ODD
 (1)

	)

127 
	#VIDEO_VSYNC_FIELD_EVEN
 (2)

	)

128 
	#VIDEO_VSYNC_FIELD_PROGRESSIVE
 (3)

	)

130 
	svideo_ev’t
 {

131 
__s32
 
	mty³
;

132 
	#VIDEO_EVENT_SIZE_CHANGED
 1

	)

133 
	#VIDEO_EVENT_FRAME_RATE_CHANGED
 2

	)

134 
	#VIDEO_EVENT_DECODER_STOPPED
 3

	)

135 
	#VIDEO_EVENT_VSYNC
 4

	)

136 
__k”Ãl_time_t
 
	mtime¡amp
;

138 
video_size_t
 
	msize
;

139 
	mäame_¿‹
;

140 
	mvsync_f›ld
;

141 } 
	mu
;

145 
	svideo_¡©us
 {

146 
	mvideo_bÏnk
;

147 
video_¶ay_¡©e_t
 
	m¶ay_¡©e
;

148 
video_¡»am_sourû_t
 
	m¡»am_sourû
;

149 
video_fÜm©_t
 
	mvideo_fÜm©
;

150 
video_di¥ÏyfÜm©_t
 
	mdi¥Ïy_fÜm©
;

154 
	svideo_¡l_piùu»
 {

155 *
	miF¿me
;

156 
__s32
 
	msize
;

161 
	svideo_highlight
 {

162 
	maùive
;

163 
__u8
 
	mcÚŒa¡1
;

165 
__u8
 
	mcÚŒa¡2
;

167 
__u8
 
	mcŞÜ1
;

169 
__u8
 
	mcŞÜ2
;

171 
__u32
 
	mypos
;

174 
__u32
 
	mxpos
;

177 } 
	tvideo_highlight_t
;

180 
	svideo_¥u
 {

181 
	maùive
;

182 
	m¡»am_id
;

183 } 
	tvideo_¥u_t
;

186 
	svideo_¥u_·Ë‰e
 {

187 
	mËngth
;

188 
__u8
 *
	m·Ë‰e
;

189 } 
	tvideo_¥u_·Ë‰e_t
;

192 
	svideo_Çvi_·ck
 {

193 
	mËngth
;

194 
__u8
 
	md©a
[1024];

195 } 
	tvideo_Çvi_·ck_t
;

198 
__u16
 
	tvideo_©Œibu‹s_t
;

213 
	#VIDEO_CAP_MPEG1
 1

	)

214 
	#VIDEO_CAP_MPEG2
 2

	)

218 
	#VIDEO_CAP_SYS
 4

	)

219 
	#VIDEO_CAP_PROG
 8

	)

222 
	#VIDEO_CAP_SPU
 16

	)

223 
	#VIDEO_CAP_NAVI
 32

	)

224 
	#VIDEO_CAP_CSS
 64

	)

227 
	#VIDEO_STOP
 
	`_IO
('o', 21)

	)

228 
	#VIDEO_PLAY
 
	`_IO
('o', 22)

	)

229 
	#VIDEO_FREEZE
 
	`_IO
('o', 23)

	)

230 
	#VIDEO_CONTINUE
 
	`_IO
('o', 24)

	)

231 
	#VIDEO_SELECT_SOURCE
 
	`_IO
('o', 25)

	)

232 
	#VIDEO_SET_BLANK
 
	`_IO
('o', 26)

	)

233 
	#VIDEO_GET_STATUS
 
	`_IOR
('o', 27, 
video_¡©us
)

	)

234 
	#VIDEO_GET_EVENT
 
	`_IOR
('o', 28, 
video_ev’t
)

	)

235 
	#VIDEO_SET_DISPLAY_FORMAT
 
	`_IO
('o', 29)

	)

236 
	#VIDEO_STILLPICTURE
 
	`_IOW
('o', 30, 
video_¡l_piùu»
)

	)

237 
	#VIDEO_FAST_FORWARD
 
	`_IO
('o', 31)

	)

238 
	#VIDEO_SLOWMOTION
 
	`_IO
('o', 32)

	)

239 
	#VIDEO_GET_CAPABILITIES
 
	`_IOR
('o', 33, )

	)

240 
	#VIDEO_CLEAR_BUFFER
 
	`_IO
('o', 34)

	)

241 
	#VIDEO_SET_ID
 
	`_IO
('o', 35)

	)

242 
	#VIDEO_SET_STREAMTYPE
 
	`_IO
('o', 36)

	)

243 
	#VIDEO_SET_FORMAT
 
	`_IO
('o', 37)

	)

244 
	#VIDEO_SET_SYSTEM
 
	`_IO
('o', 38)

	)

245 
	#VIDEO_SET_HIGHLIGHT
 
	`_IOW
('o', 39, 
video_highlight_t
)

	)

246 
	#VIDEO_SET_SPU
 
	`_IOW
('o', 50, 
video_¥u_t
)

	)

247 
	#VIDEO_SET_SPU_PALETTE
 
	`_IOW
('o', 51, 
video_¥u_·Ë‰e_t
)

	)

248 
	#VIDEO_GET_NAVI
 
	`_IOR
('o', 52, 
video_Çvi_·ck_t
)

	)

249 
	#VIDEO_SET_ATTRIBUTES
 
	`_IO
('o', 53)

	)

250 
	#VIDEO_GET_SIZE
 
	`_IOR
('o', 55, 
video_size_t
)

	)

251 
	#VIDEO_GET_FRAME_RATE
 
	`_IOR
('o', 56, )

	)

264 
	#VIDEO_GET_PTS
 
	`_IOR
('o', 57, 
__u64
)

	)

267 
	#VIDEO_GET_FRAME_COUNT
 
	`_IOR
('o', 58, 
__u64
)

	)

269 
	#VIDEO_COMMAND
 
	`_IOWR
('o', 59, 
video_commªd
)

	)

270 
	#VIDEO_TRY_COMMAND
 
	`_IOWR
('o', 60, 
video_commªd
)

	)

	@/usr/include/linux/elf-fdpic.h

12 #iâdeà
_LINUX_ELF_FDPIC_H


13 
	#_LINUX_ELF_FDPIC_H


	)

15 
	~<lšux/–f.h
>

17 
	#PT_GNU_STACK
 (
PT_LOOS
 + 0x474e551)

	)

20 
	s–f32_fdpic_lßd£g
 {

21 
Elf32_Addr
 
	maddr
;

22 
Elf32_Addr
 
	mp_vaddr
;

23 
Elf32_WÜd
 
	mp_memsz
;

26 
	s–f32_fdpic_lßdm­
 {

27 
Elf32_H®f
 
	mv”siÚ
;

28 
Elf32_H®f
 
	mn£gs
;

29 
–f32_fdpic_lßd£g
 
	m£gs
[];

32 
	#ELF32_FDPIC_LOADMAP_VERSION
 0x0000

	)

37 
	s–f_fdpic_·¿ms
 {

38 
–fhdr
 
	mhdr
;

39 
–f_phdr
 *
	mphdrs
;

40 
–f32_fdpic_lßdm­
 *
	mlßdm­
;

41 
	m–fhdr_addr
;

42 
	mph_addr
;

43 
	mm­_addr
;

44 
	m’Œy_addr
;

45 
	m¡ack_size
;

46 
	mdyÇmic_addr
;

47 
	mlßd_addr
;

48 
	mæags
;

49 
	#ELF_FDPIC_FLAG_ARRANGEMENT
 0x0000000à

	)

50 
	#ELF_FDPIC_FLAG_INDEPENDENT
 0x00000000

	)

51 
	#ELF_FDPIC_FLAG_HONOURVADDR
 0x00000001

	)

52 
	#ELF_FDPIC_FLAG_CONSTDISP
 0x00000002

	)

54 
	#ELF_FDPIC_FLAG_CONTIGUOUS
 0x00000003

	)

55 
	#ELF_FDPIC_FLAG_EXEC_STACK
 0x00000010

	)

56 
	#ELF_FDPIC_FLAG_NOEXEC_STACK
 0x00000020

	)

57 
	#ELF_FDPIC_FLAG_EXECUTABLE
 0x00000040

	)

58 
	#ELF_FDPIC_FLAG_PRESENT
 0x80000000

	)

	@/usr/include/linux/elf.h

1 #iâdeà
_LINUX_ELF_H


2 
	#_LINUX_ELF_H


	)

4 
	~<lšux/ty³s.h
>

5 
	~<lšux/–f-em.h
>

7 
	gfe
;

9 #iâdeà
–f_»ad_im¶›s_exec


13 
	#–f_»ad_im¶›s_exec
(
ex
, 
have_±_gnu_¡ack
è0

	)

17 
__u32
 
	tElf32_Addr
;

18 
__u16
 
	tElf32_H®f
;

19 
__u32
 
	tElf32_Off
;

20 
__s32
 
	tElf32_SwÜd
;

21 
__u32
 
	tElf32_WÜd
;

24 
__u64
 
	tElf64_Addr
;

25 
__u16
 
	tElf64_H®f
;

26 
__s16
 
	tElf64_SH®f
;

27 
__u64
 
	tElf64_Off
;

28 
__s32
 
	tElf64_SwÜd
;

29 
__u32
 
	tElf64_WÜd
;

30 
__u64
 
	tElf64_XwÜd
;

31 
__s64
 
	tElf64_SxwÜd
;

34 
	#PT_NULL
 0

	)

35 
	#PT_LOAD
 1

	)

36 
	#PT_DYNAMIC
 2

	)

37 
	#PT_INTERP
 3

	)

38 
	#PT_NOTE
 4

	)

39 
	#PT_SHLIB
 5

	)

40 
	#PT_PHDR
 6

	)

41 
	#PT_TLS
 7

	)

42 
	#PT_LOOS
 0x60000000

	)

43 
	#PT_HIOS
 0x6ffffffà

	)

44 
	#PT_LOPROC
 0x70000000

	)

45 
	#PT_HIPROC
 0x7fffffff

	)

46 
	#PT_GNU_EH_FRAME
 0x6474e550

	)

48 
	#PT_GNU_STACK
 (
PT_LOOS
 + 0x474e551)

	)

70 
	#PN_XNUM
 0xffff

	)

73 
	#ET_NONE
 0

	)

74 
	#ET_REL
 1

	)

75 
	#ET_EXEC
 2

	)

76 
	#ET_DYN
 3

	)

77 
	#ET_CORE
 4

	)

78 
	#ET_LOPROC
 0xff00

	)

79 
	#ET_HIPROC
 0xffff

	)

82 
	#DT_NULL
 0

	)

83 
	#DT_NEEDED
 1

	)

84 
	#DT_PLTRELSZ
 2

	)

85 
	#DT_PLTGOT
 3

	)

86 
	#DT_HASH
 4

	)

87 
	#DT_STRTAB
 5

	)

88 
	#DT_SYMTAB
 6

	)

89 
	#DT_RELA
 7

	)

90 
	#DT_RELASZ
 8

	)

91 
	#DT_RELAENT
 9

	)

92 
	#DT_STRSZ
 10

	)

93 
	#DT_SYMENT
 11

	)

94 
	#DT_INIT
 12

	)

95 
	#DT_FINI
 13

	)

96 
	#DT_SONAME
 14

	)

97 
	#DT_RPATH
 15

	)

98 
	#DT_SYMBOLIC
 16

	)

99 
	#DT_REL
 17

	)

100 
	#DT_RELSZ
 18

	)

101 
	#DT_RELENT
 19

	)

102 
	#DT_PLTREL
 20

	)

103 
	#DT_DEBUG
 21

	)

104 
	#DT_TEXTREL
 22

	)

105 
	#DT_JMPREL
 23

	)

106 
	#DT_ENCODING
 32

	)

107 
	#OLD_DT_LOOS
 0x60000000

	)

108 
	#DT_LOOS
 0x6000000d

	)

109 
	#DT_HIOS
 0x6ffff000

	)

110 
	#DT_VALRNGLO
 0x6ffffd00

	)

111 
	#DT_VALRNGHI
 0x6ffffdff

	)

112 
	#DT_ADDRRNGLO
 0x6fffã00

	)

113 
	#DT_ADDRRNGHI
 0x6fffãff

	)

114 
	#DT_VERSYM
 0x6ffffff0

	)

115 
	#DT_RELACOUNT
 0x6ffffff9

	)

116 
	#DT_RELCOUNT
 0x6fffffç

	)

117 
	#DT_FLAGS_1
 0x6ffffffb

	)

118 
	#DT_VERDEF
 0x6ffffffc

	)

119 
	#DT_VERDEFNUM
 0x6ffffffd

	)

120 
	#DT_VERNEED
 0x6fffffã

	)

121 
	#DT_VERNEEDNUM
 0x6fffffff

	)

122 
	#OLD_DT_HIOS
 0x6fffffff

	)

123 
	#DT_LOPROC
 0x70000000

	)

124 
	#DT_HIPROC
 0x7fffffff

	)

127 
	#STB_LOCAL
 0

	)

128 
	#STB_GLOBAL
 1

	)

129 
	#STB_WEAK
 2

	)

131 
	#STT_NOTYPE
 0

	)

132 
	#STT_OBJECT
 1

	)

133 
	#STT_FUNC
 2

	)

134 
	#STT_SECTION
 3

	)

135 
	#STT_FILE
 4

	)

136 
	#STT_COMMON
 5

	)

137 
	#STT_TLS
 6

	)

139 
	#ELF_ST_BIND
(
x
è((xè>> 4)

	)

140 
	#ELF_ST_TYPE
(
x
è(((èxè& 0xf)

	)

141 
	#ELF32_ST_BIND
(
x
è
	`ELF_ST_BIND
(x)

	)

142 
	#ELF32_ST_TYPE
(
x
è
	`ELF_ST_TYPE
(x)

	)

143 
	#ELF64_ST_BIND
(
x
è
	`ELF_ST_BIND
(x)

	)

144 
	#ELF64_ST_TYPE
(
x
è
	`ELF_ST_TYPE
(x)

	)

146 
	sdyÇmic
{

147 
Elf32_SwÜd
 
	md_g
;

149 
Elf32_SwÜd
 
	md_v®
;

150 
Elf32_Addr
 
	md_±r
;

151 } 
	md_un
;

152 } 
	tElf32_Dyn
;

155 
Elf64_SxwÜd
 
	md_g
;

157 
Elf64_XwÜd
 
	md_v®
;

158 
Elf64_Addr
 
	md_±r
;

159 } 
	md_un
;

160 } 
	tElf64_Dyn
;

163 
	#ELF32_R_SYM
(
x
è((xè>> 8)

	)

164 
	#ELF32_R_TYPE
(
x
è((xè& 0xff)

	)

166 
	#ELF64_R_SYM
(
i
è((iè>> 32)

	)

167 
	#ELF64_R_TYPE
(
i
è((iè& 0xffffffff)

	)

169 
	s–f32_»l
 {

170 
Elf32_Addr
 
	mr_off£t
;

171 
Elf32_WÜd
 
	mr_šfo
;

172 } 
	tElf32_R–
;

174 
	s–f64_»l
 {

175 
Elf64_Addr
 
	mr_off£t
;

176 
Elf64_XwÜd
 
	mr_šfo
;

177 } 
	tElf64_R–
;

179 
	s–f32_»Ï
{

180 
Elf32_Addr
 
	mr_off£t
;

181 
Elf32_WÜd
 
	mr_šfo
;

182 
Elf32_SwÜd
 
	mr_add’d
;

183 } 
	tElf32_R–a
;

185 
	s–f64_»Ï
 {

186 
Elf64_Addr
 
	mr_off£t
;

187 
Elf64_XwÜd
 
	mr_šfo
;

188 
Elf64_SxwÜd
 
	mr_add’d
;

189 } 
	tElf64_R–a
;

191 
	s–f32_sym
{

192 
Elf32_WÜd
 
	m¡_Çme
;

193 
Elf32_Addr
 
	m¡_v®ue
;

194 
Elf32_WÜd
 
	m¡_size
;

195 
	m¡_šfo
;

196 
	m¡_Ùh”
;

197 
Elf32_H®f
 
	m¡_shndx
;

198 } 
	tElf32_Sym
;

200 
	s–f64_sym
 {

201 
Elf64_WÜd
 
	m¡_Çme
;

202 
	m¡_šfo
;

203 
	m¡_Ùh”
;

204 
Elf64_H®f
 
	m¡_shndx
;

205 
Elf64_Addr
 
	m¡_v®ue
;

206 
Elf64_XwÜd
 
	m¡_size
;

207 } 
	tElf64_Sym
;

210 
	#EI_NIDENT
 16

	)

212 
	s–f32_hdr
{

213 
	me_id’t
[
EI_NIDENT
];

214 
Elf32_H®f
 
	me_ty³
;

215 
Elf32_H®f
 
	me_machše
;

216 
Elf32_WÜd
 
	me_v”siÚ
;

217 
Elf32_Addr
 
	me_’Œy
;

218 
Elf32_Off
 
	me_phoff
;

219 
Elf32_Off
 
	me_shoff
;

220 
Elf32_WÜd
 
	me_æags
;

221 
Elf32_H®f
 
	me_ehsize
;

222 
Elf32_H®f
 
	me_ph’tsize
;

223 
Elf32_H®f
 
	me_phnum
;

224 
Elf32_H®f
 
	me_sh’tsize
;

225 
Elf32_H®f
 
	me_shnum
;

226 
Elf32_H®f
 
	me_sh¡ºdx
;

227 } 
	tElf32_Ehdr
;

229 
	s–f64_hdr
 {

230 
	me_id’t
[
EI_NIDENT
];

231 
Elf64_H®f
 
	me_ty³
;

232 
Elf64_H®f
 
	me_machše
;

233 
Elf64_WÜd
 
	me_v”siÚ
;

234 
Elf64_Addr
 
	me_’Œy
;

235 
Elf64_Off
 
	me_phoff
;

236 
Elf64_Off
 
	me_shoff
;

237 
Elf64_WÜd
 
	me_æags
;

238 
Elf64_H®f
 
	me_ehsize
;

239 
Elf64_H®f
 
	me_ph’tsize
;

240 
Elf64_H®f
 
	me_phnum
;

241 
Elf64_H®f
 
	me_sh’tsize
;

242 
Elf64_H®f
 
	me_shnum
;

243 
Elf64_H®f
 
	me_sh¡ºdx
;

244 } 
	tElf64_Ehdr
;

248 
	#PF_R
 0x4

	)

249 
	#PF_W
 0x2

	)

250 
	#PF_X
 0x1

	)

252 
	s–f32_phdr
{

253 
Elf32_WÜd
 
	mp_ty³
;

254 
Elf32_Off
 
	mp_off£t
;

255 
Elf32_Addr
 
	mp_vaddr
;

256 
Elf32_Addr
 
	mp_·ddr
;

257 
Elf32_WÜd
 
	mp_fesz
;

258 
Elf32_WÜd
 
	mp_memsz
;

259 
Elf32_WÜd
 
	mp_æags
;

260 
Elf32_WÜd
 
	mp_®ign
;

261 } 
	tElf32_Phdr
;

263 
	s–f64_phdr
 {

264 
Elf64_WÜd
 
	mp_ty³
;

265 
Elf64_WÜd
 
	mp_æags
;

266 
Elf64_Off
 
	mp_off£t
;

267 
Elf64_Addr
 
	mp_vaddr
;

268 
Elf64_Addr
 
	mp_·ddr
;

269 
Elf64_XwÜd
 
	mp_fesz
;

270 
Elf64_XwÜd
 
	mp_memsz
;

271 
Elf64_XwÜd
 
	mp_®ign
;

272 } 
	tElf64_Phdr
;

275 
	#SHT_NULL
 0

	)

276 
	#SHT_PROGBITS
 1

	)

277 
	#SHT_SYMTAB
 2

	)

278 
	#SHT_STRTAB
 3

	)

279 
	#SHT_RELA
 4

	)

280 
	#SHT_HASH
 5

	)

281 
	#SHT_DYNAMIC
 6

	)

282 
	#SHT_NOTE
 7

	)

283 
	#SHT_NOBITS
 8

	)

284 
	#SHT_REL
 9

	)

285 
	#SHT_SHLIB
 10

	)

286 
	#SHT_DYNSYM
 11

	)

287 
	#SHT_NUM
 12

	)

288 
	#SHT_LOPROC
 0x70000000

	)

289 
	#SHT_HIPROC
 0x7fffffff

	)

290 
	#SHT_LOUSER
 0x80000000

	)

291 
	#SHT_HIUSER
 0xffffffff

	)

294 
	#SHF_WRITE
 0x1

	)

295 
	#SHF_ALLOC
 0x2

	)

296 
	#SHF_EXECINSTR
 0x4

	)

297 
	#SHF_MASKPROC
 0xf0000000

	)

300 
	#SHN_UNDEF
 0

	)

301 
	#SHN_LORESERVE
 0xff00

	)

302 
	#SHN_LOPROC
 0xff00

	)

303 
	#SHN_HIPROC
 0xff1f

	)

304 
	#SHN_ABS
 0xfff1

	)

305 
	#SHN_COMMON
 0xfff2

	)

306 
	#SHN_HIRESERVE
 0xffff

	)

308 
	s–f32_shdr
 {

309 
Elf32_WÜd
 
	msh_Çme
;

310 
Elf32_WÜd
 
	msh_ty³
;

311 
Elf32_WÜd
 
	msh_æags
;

312 
Elf32_Addr
 
	msh_addr
;

313 
Elf32_Off
 
	msh_off£t
;

314 
Elf32_WÜd
 
	msh_size
;

315 
Elf32_WÜd
 
	msh_lšk
;

316 
Elf32_WÜd
 
	msh_šfo
;

317 
Elf32_WÜd
 
	msh_add¿lign
;

318 
Elf32_WÜd
 
	msh_’tsize
;

319 } 
	tElf32_Shdr
;

321 
	s–f64_shdr
 {

322 
Elf64_WÜd
 
	msh_Çme
;

323 
Elf64_WÜd
 
	msh_ty³
;

324 
Elf64_XwÜd
 
	msh_æags
;

325 
Elf64_Addr
 
	msh_addr
;

326 
Elf64_Off
 
	msh_off£t
;

327 
Elf64_XwÜd
 
	msh_size
;

328 
Elf64_WÜd
 
	msh_lšk
;

329 
Elf64_WÜd
 
	msh_šfo
;

330 
Elf64_XwÜd
 
	msh_add¿lign
;

331 
Elf64_XwÜd
 
	msh_’tsize
;

332 } 
	tElf64_Shdr
;

334 
	#EI_MAG0
 0

	)

335 
	#EI_MAG1
 1

	)

336 
	#EI_MAG2
 2

	)

337 
	#EI_MAG3
 3

	)

338 
	#EI_CLASS
 4

	)

339 
	#EI_DATA
 5

	)

340 
	#EI_VERSION
 6

	)

341 
	#EI_OSABI
 7

	)

342 
	#EI_PAD
 8

	)

344 
	#ELFMAG0
 0x7à

	)

345 
	#ELFMAG1
 'E'

	)

346 
	#ELFMAG2
 'L'

	)

347 
	#ELFMAG3
 'F'

	)

348 
	#ELFMAG
 "\177ELF"

	)

349 
	#SELFMAG
 4

	)

351 
	#ELFCLASSNONE
 0

	)

352 
	#ELFCLASS32
 1

	)

353 
	#ELFCLASS64
 2

	)

354 
	#ELFCLASSNUM
 3

	)

356 
	#ELFDATANONE
 0

	)

357 
	#ELFDATA2LSB
 1

	)

358 
	#ELFDATA2MSB
 2

	)

360 
	#EV_NONE
 0

	)

361 
	#EV_CURRENT
 1

	)

362 
	#EV_NUM
 2

	)

364 
	#ELFOSABI_NONE
 0

	)

365 
	#ELFOSABI_LINUX
 3

	)

367 #iâdeà
ELF_OSABI


368 
	#ELF_OSABI
 
ELFOSABI_NONE


	)

376 
	#NT_PRSTATUS
 1

	)

377 
	#NT_PRFPREG
 2

	)

378 
	#NT_PRPSINFO
 3

	)

379 
	#NT_TASKSTRUCT
 4

	)

380 
	#NT_AUXV
 6

	)

381 
	#NT_PRXFPREG
 0x46e62b7à

	)

382 
	#NT_PPC_VMX
 0x100

	)

383 
	#NT_PPC_SPE
 0x101

	)

384 
	#NT_PPC_VSX
 0x102

	)

385 
	#NT_386_TLS
 0x200

	)

386 
	#NT_386_IOPERM
 0x201

	)

387 
	#NT_X86_XSTATE
 0x202

	)

388 
	#NT_S390_HIGH_GPRS
 0x300

	)

389 
	#NT_S390_TIMER
 0x301

	)

390 
	#NT_S390_TODCMP
 0x302

	)

391 
	#NT_S390_TODPREG
 0x303

	)

392 
	#NT_S390_CTRS
 0x304

	)

393 
	#NT_S390_PREFIX
 0x305

	)

394 
	#NT_S390_LAST_BREAK
 0x306

	)

395 
	#NT_S390_SYSTEM_CALL
 0x307

	)

396 
	#NT_ARM_VFP
 0x400

	)

400 
	s–f32_nÙe
 {

401 
Elf32_WÜd
 
	mn_Çmesz
;

402 
Elf32_WÜd
 
	mn_descsz
;

403 
Elf32_WÜd
 
	mn_ty³
;

404 } 
	tElf32_Nhdr
;

407 
	s–f64_nÙe
 {

408 
Elf64_WÜd
 
	mn_Çmesz
;

409 
Elf64_WÜd
 
	mn_descsz
;

410 
Elf64_WÜd
 
	mn_ty³
;

411 } 
	tElf64_Nhdr
;

	@/usr/include/linux/elfcore.h

1 #iâdeà
_LINUX_ELFCORE_H


2 
	#_LINUX_ELFCORE_H


	)

4 
	~<lšux/ty³s.h
>

5 
	~<lšux/sigÇl.h
>

6 
	~<lšux/time.h
>

7 
	~<lšux/±¿û.h
>

8 
	~<lšux/–f.h
>

9 
	~<lšux/fs.h
>

11 
	s–f_sigšfo


13 
	msi_signo
;

14 
	msi_code
;

15 
	msi_”ºo
;

19 
–f_g»g_t
 
	tg»g_t
;

20 
–f_g»g£t_t
 
	tg»g£t_t
;

21 
–f_å»g£t_t
 
	tå»g£t_t
;

22 
–f_åx»g£t_t
 
	tåx»g£t_t
;

23 
	#NGREG
 
ELF_NGREG


	)

34 
	s–f_´¡©us


37 
	m´_æags
;

38 
	m´_why
;

39 
	m´_wh©
;

41 
–f_sigšfo
 
	m´_šfo
;

42 
	m´_cursig
;

43 
	m´_sig³nd
;

44 
	m´_sighŞd
;

46 
sig®t¡ack
 
	m´_®t¡ack
;

47 
sigaùiÚ
 
	m´_aùiÚ
;

49 
pid_t
 
	m´_pid
;

50 
pid_t
 
	m´_µid
;

51 
pid_t
 
	m´_pg½
;

52 
pid_t
 
	m´_sid
;

53 
timev®
 
	m´_utime
;

54 
timev®
 
	m´_¡ime
;

55 
timev®
 
	m´_cutime
;

56 
timev®
 
	m´_c¡ime
;

58 
	m´_š¡r
;

60 
–f_g»g£t_t
 
	m´_»g
;

61 #ifdeà
CONFIG_BINFMT_ELF_FDPIC


68 
	m´_exec_fdpic_lßdm­
;

69 
	m´_š‹½_fdpic_lßdm­
;

71 
	m´_åv®id
;

74 
	#ELF_PRARGSZ
 (80è

	)

76 
	s–f_´psšfo


78 
	m´_¡©e
;

79 
	m´_¢ame
;

80 
	m´_zomb
;

81 
	m´_niû
;

82 
	m´_æag
;

83 
__k”Ãl_uid_t
 
	m´_uid
;

84 
__k”Ãl_gid_t
 
	m´_gid
;

85 
pid_t
 
	m´_pid
, 
	m´_µid
, 
	m´_pg½
, 
	m´_sid
;

87 
	m´_âame
[16];

88 
	m´_p§rgs
[
ELF_PRARGSZ
];

91 
–f_´¡©us
 
	t´¡©us_t
;

92 
–f_´psšfo
 
	t´psšfo_t
;

93 
	#PRARGSZ
 
ELF_PRARGSZ


	)

	@/usr/include/linux/errno.h

1 #iâdeà
_LINUX_ERRNO_H


2 
	#_LINUX_ERRNO_H


	)

4 
	~<asm/”ºo.h
>

	@/usr/include/linux/ethtool.h

13 #iâdeà
_LINUX_ETHTOOL_H


14 
	#_LINUX_ETHTOOL_H


	)

16 
	~<lšux/ty³s.h
>

17 
	~<lšux/if_‘h”.h
>

20 
	s‘htoŞ_cmd
 {

21 
__u32
 
	mcmd
;

22 
__u32
 
	msuµÜ‹d
;

23 
__u32
 
	madv”tisšg
;

24 
__u16
 
	m¥“d
;

28 
__u8
 
	mdu¶ex
;

29 
__u8
 
	mpÜt
;

30 
__u8
 
	mphy_add»ss
;

31 
__u8
 
	mŒªsûiv”
;

32 
__u8
 
	mautÚeg
;

33 
__u8
 
	mmdio_suµÜt
;

34 
__u32
 
	mmaxtxpkt
;

35 
__u32
 
	mmaxrxpkt
;

36 
__u16
 
	m¥“d_hi
;

40 
__u8
 
	m‘h__mdix
;

41 
__u8
 
	m»£rved2
;

42 
__u32
 
	mÍ_adv”tisšg
;

43 
__u32
 
	m»£rved
[2];

46 
__šlše__
 
	$‘htoŞ_cmd_¥“d_£t
(
‘htoŞ_cmd
 *
•
,

47 
__u32
 
¥“d
)

50 
•
->
¥“d
 = (
__u16
)speed;

51 
•
->
¥“d_hi
 = (
__u16
)(
¥“d
 >> 16);

52 
	}
}

54 
__šlše__
 
__u32
 
	$‘htoŞ_cmd_¥“d
(cÚ¡ 
‘htoŞ_cmd
 *
•
)

56  (
•
->
¥“d_hi
 << 16è|ƒp->
¥“d
;

57 
	}
}

59 
	#ETHTOOL_FWVERS_LEN
 32

	)

60 
	#ETHTOOL_BUSINFO_LEN
 32

	)

62 
	s‘htoŞ_drvšfo
 {

63 
__u32
 
	mcmd
;

64 
	mdriv”
[32];

65 
	mv”siÚ
[32];

66 
	mfw_v”siÚ
[
ETHTOOL_FWVERS_LEN
];

67 
	mbus_šfo
[
ETHTOOL_BUSINFO_LEN
];

69 
	m»£rved1
[32];

70 
	m»£rved2
[12];

78 
__u32
 
	mn_´iv_æags
;

79 
__u32
 
	mn_¡©s
;

80 
__u32
 
	m‹¡šfo_Ën
;

81 
__u32
 
	m“dump_Ën
;

82 
__u32
 
	m»gdump_Ën
;

85 
	#SOPASS_MAX
 6

	)

87 
	s‘htoŞ_wŞšfo
 {

88 
__u32
 
	mcmd
;

89 
__u32
 
	msuµÜ‹d
;

90 
__u32
 
	mwŞİts
;

91 
__u8
 
	msİass
[
SOPASS_MAX
];

95 
	s‘htoŞ_v®ue
 {

96 
__u32
 
	mcmd
;

97 
__u32
 
	md©a
;

101 
	s‘htoŞ_»gs
 {

102 
__u32
 
	mcmd
;

103 
__u32
 
	mv”siÚ
;

104 
__u32
 
	mËn
;

105 
__u8
 
	md©a
[0];

109 
	s‘htoŞ_“´om
 {

110 
__u32
 
	mcmd
;

111 
__u32
 
	mmagic
;

112 
__u32
 
	moff£t
;

113 
__u32
 
	mËn
;

114 
__u8
 
	md©a
[0];

189 
	s‘htoŞ_cßËsû
 {

190 
__u32
 
	mcmd
;

191 
__u32
 
	mrx_cßËsû_u£cs
;

192 
__u32
 
	mrx_max_cßËsûd_äames
;

193 
__u32
 
	mrx_cßËsû_u£cs_œq
;

194 
__u32
 
	mrx_max_cßËsûd_äames_œq
;

195 
__u32
 
	mtx_cßËsû_u£cs
;

196 
__u32
 
	mtx_max_cßËsûd_äames
;

197 
__u32
 
	mtx_cßËsû_u£cs_œq
;

198 
__u32
 
	mtx_max_cßËsûd_äames_œq
;

199 
__u32
 
	m¡©s_block_cßËsû_u£cs
;

200 
__u32
 
	mu£_ad­tive_rx_cßËsû
;

201 
__u32
 
	mu£_ad­tive_tx_cßËsû
;

202 
__u32
 
	mpkt_¿‹_low
;

203 
__u32
 
	mrx_cßËsû_u£cs_low
;

204 
__u32
 
	mrx_max_cßËsûd_äames_low
;

205 
__u32
 
	mtx_cßËsû_u£cs_low
;

206 
__u32
 
	mtx_max_cßËsûd_äames_low
;

207 
__u32
 
	mpkt_¿‹_high
;

208 
__u32
 
	mrx_cßËsû_u£cs_high
;

209 
__u32
 
	mrx_max_cßËsûd_äames_high
;

210 
__u32
 
	mtx_cßËsû_u£cs_high
;

211 
__u32
 
	mtx_max_cßËsûd_äames_high
;

212 
__u32
 
	m¿‹_§m¶e_š‹rv®
;

216 
	s‘htoŞ_ršg·¿m
 {

217 
__u32
 
	mcmd
;

223 
__u32
 
	mrx_max_³ndšg
;

224 
__u32
 
	mrx_mši_max_³ndšg
;

225 
__u32
 
	mrx_jumbo_max_³ndšg
;

226 
__u32
 
	mtx_max_³ndšg
;

231 
__u32
 
	mrx_³ndšg
;

232 
__u32
 
	mrx_mši_³ndšg
;

233 
__u32
 
	mrx_jumbo_³ndšg
;

234 
__u32
 
	mtx_³ndšg
;

253 
	s‘htoŞ_chªÃls
 {

254 
__u32
 
	mcmd
;

255 
__u32
 
	mmax_rx
;

256 
__u32
 
	mmax_tx
;

257 
__u32
 
	mmax_Ùh”
;

258 
__u32
 
	mmax_combšed
;

259 
__u32
 
	mrx_couÁ
;

260 
__u32
 
	mtx_couÁ
;

261 
__u32
 
	mÙh”_couÁ
;

262 
__u32
 
	mcombšed_couÁ
;

266 
	s‘htoŞ_·u£·¿m
 {

267 
__u32
 
	mcmd
;

279 
__u32
 
	mautÚeg
;

280 
__u32
 
	mrx_·u£
;

281 
__u32
 
	mtx_·u£
;

284 
	#ETH_GSTRING_LEN
 32

	)

285 
	e‘htoŞ_¡ršg£t
 {

286 
	mETH_SS_TEST
 = 0,

287 
	mETH_SS_STATS
,

288 
	mETH_SS_PRIV_FLAGS
,

289 
	mETH_SS_NTUPLE_FILTERS
,

290 
	mETH_SS_FEATURES
,

294 
	s‘htoŞ_g¡ršgs
 {

295 
__u32
 
	mcmd
;

296 
__u32
 
	m¡ršg_£t
;

297 
__u32
 
	mËn
;

298 
__u8
 
	md©a
[0];

301 
	s‘htoŞ_s£t_šfo
 {

302 
__u32
 
	mcmd
;

303 
__u32
 
	m»£rved
;

304 
__u64
 
	ms£t_mask
;

306 
__u32
 
	md©a
[0];

322 
	e‘htoŞ_‹¡_æags
 {

323 
	mETH_TEST_FL_OFFLINE
 = (1 << 0),

324 
	mETH_TEST_FL_FAILED
 = (1 << 1),

325 
	mETH_TEST_FL_EXTERNAL_LB
 = (1 << 2),

326 
	mETH_TEST_FL_EXTERNAL_LB_DONE
 = (1 << 3),

330 
	s‘htoŞ_‹¡
 {

331 
__u32
 
	mcmd
;

332 
__u32
 
	mæags
;

333 
__u32
 
	m»£rved
;

334 
__u32
 
	mËn
;

335 
__u64
 
	md©a
[0];

339 
	s‘htoŞ_¡©s
 {

340 
__u32
 
	mcmd
;

341 
__u32
 
	mn_¡©s
;

342 
__u64
 
	md©a
[0];

345 
	s‘htoŞ_³rm_addr
 {

346 
__u32
 
	mcmd
;

347 
__u32
 
	msize
;

348 
__u8
 
	md©a
[0];

360 
	e‘htoŞ_æags
 {

361 
	mETH_FLAG_TXVLAN
 = (1 << 7),

362 
	mETH_FLAG_RXVLAN
 = (1 << 8),

363 
	mETH_FLAG_LRO
 = (1 << 15),

364 
	mETH_FLAG_NTUPLE
 = (1 << 27),

365 
	mETH_FLAG_RXHASH
 = (1 << 28),

384 
	s‘htoŞ_tı4_¥ec
 {

385 
__be32
 
	m4¤c
;

386 
__be32
 
	m4d¡
;

387 
__be16
 
	mp¤c
;

388 
__be16
 
	mpd¡
;

389 
__u8
 
	mtos
;

401 
	s‘htoŞ_ah_e¥4_¥ec
 {

402 
__be32
 
	m4¤c
;

403 
__be32
 
	m4d¡
;

404 
__be32
 
	m¥i
;

405 
__u8
 
	mtos
;

408 
	#ETH_RX_NFC_IP4
 1

	)

419 
	s‘htoŞ_u¤4_¥ec
 {

420 
__be32
 
	m4¤c
;

421 
__be32
 
	m4d¡
;

422 
__be32
 
	ml4_4_by‹s
;

423 
__u8
 
	mtos
;

424 
__u8
 
	m_v”
;

425 
__u8
 
	m´Ùo
;

428 
	u‘htoŞ_æow_uniÚ
 {

429 
‘htoŞ_tı4_¥ec
 
	mtı_4_¥ec
;

430 
‘htoŞ_tı4_¥ec
 
	mudp_4_¥ec
;

431 
‘htoŞ_tı4_¥ec
 
	msùp_4_¥ec
;

432 
‘htoŞ_ah_e¥4_¥ec
 
	mah_4_¥ec
;

433 
‘htoŞ_ah_e¥4_¥ec
 
	me¥_4_¥ec
;

434 
‘htoŞ_u¤4_¥ec
 
	mu¤_4_¥ec
;

435 
‘hhdr
 
	m‘h”_¥ec
;

436 
__u8
 
	mhd©a
[60];

439 
	s‘htoŞ_æow_ext
 {

440 
__be16
 
	mvÏn_‘y³
;

441 
__be16
 
	mvÏn_tci
;

442 
__be32
 
	md©a
[2];

460 
	s‘htoŞ_rx_æow_¥ec
 {

461 
__u32
 
	mæow_ty³
;

462 
‘htoŞ_æow_uniÚ
 
	mh_u
;

463 
‘htoŞ_æow_ext
 
	mh_ext
;

464 
‘htoŞ_æow_uniÚ
 
	mm_u
;

465 
‘htoŞ_æow_ext
 
	mm_ext
;

466 
__u64
 
	mršg_cook›
;

467 
__u32
 
	mloÿtiÚ
;

506 
	s‘htoŞ_rxnfc
 {

507 
__u32
 
	mcmd
;

508 
__u32
 
	mæow_ty³
;

509 
__u64
 
	md©a
;

510 
‘htoŞ_rx_æow_¥ec
 
	mfs
;

511 
__u32
 
	mruË_út
;

512 
__u32
 
	mruË_locs
[0];

523 
	s‘htoŞ_rxfh_šdœ
 {

524 
__u32
 
	mcmd
;

525 
__u32
 
	msize
;

526 
__u32
 
	mršg_šdex
[0];

545 
	s‘htoŞ_rx_Áu¶e_æow_¥ec
 {

546 
__u32
 
	mæow_ty³
;

548 
‘htoŞ_tı4_¥ec
 
	mtı_4_¥ec
;

549 
‘htoŞ_tı4_¥ec
 
	mudp_4_¥ec
;

550 
‘htoŞ_tı4_¥ec
 
	msùp_4_¥ec
;

551 
‘htoŞ_ah_e¥4_¥ec
 
	mah_4_¥ec
;

552 
‘htoŞ_ah_e¥4_¥ec
 
	me¥_4_¥ec
;

553 
‘htoŞ_u¤4_¥ec
 
	mu¤_4_¥ec
;

554 
‘hhdr
 
	m‘h”_¥ec
;

555 
__u8
 
	mhd©a
[72];

556 } 
	mh_u
, 
	mm_u
;

558 
__u16
 
	mvÏn_g
;

559 
__u16
 
	mvÏn_g_mask
;

560 
__u64
 
	md©a
;

561 
__u64
 
	md©a_mask
;

563 
__s32
 
	maùiÚ
;

564 
	#ETHTOOL_RXNTUPLE_ACTION_DROP
 (-1è

	)

565 
	#ETHTOOL_RXNTUPLE_ACTION_CLEAR
 (-2è

	)

573 
	s‘htoŞ_rx_Áu¶e
 {

574 
__u32
 
	mcmd
;

575 
‘htoŞ_rx_Áu¶e_æow_¥ec
 
	mfs
;

578 
	#ETHTOOL_FLASH_MAX_FILENAME
 128

	)

579 
	e‘htoŞ_æash_İ_ty³
 {

580 
	mETHTOOL_FLASH_ALL_REGIONS
 = 0,

584 
	s‘htoŞ_æash
 {

585 
__u32
 
	mcmd
;

586 
__u32
 
	m»giÚ
;

587 
	md©a
[
ETHTOOL_FLASH_MAX_FILENAME
];

602 
	s‘htoŞ_dump
 {

603 
__u32
 
	mcmd
;

604 
__u32
 
	mv”siÚ
;

605 
__u32
 
	mæag
;

606 
__u32
 
	mËn
;

607 
__u8
 
	md©a
[0];

619 
	s‘htoŞ_g‘_ã©u»s_block
 {

620 
__u32
 
	mavaabË
;

621 
__u32
 
	m»que¡ed
;

622 
__u32
 
	maùive
;

623 
__u32
 
	mÃv”_chªged
;

633 
	s‘htoŞ_gã©u»s
 {

634 
__u32
 
	mcmd
;

635 
__u32
 
	msize
;

636 
‘htoŞ_g‘_ã©u»s_block
 
	mã©u»s
[0];

644 
	s‘htoŞ_£t_ã©u»s_block
 {

645 
__u32
 
	mv®id
;

646 
__u32
 
	m»que¡ed
;

655 
	s‘htoŞ_sã©u»s
 {

656 
__u32
 
	mcmd
;

657 
__u32
 
	msize
;

658 
‘htoŞ_£t_ã©u»s_block
 
	mã©u»s
[0];

686 
	e‘htoŞ_sã©u»s_»tv®_b™s
 {

687 
	mETHTOOL_F_UNSUPPORTED__BIT
,

688 
	mETHTOOL_F_WISH__BIT
,

689 
	mETHTOOL_F_COMPAT__BIT
,

692 
	#ETHTOOL_F_UNSUPPORTED
 (1 << 
ETHTOOL_F_UNSUPPORTED__BIT
)

	)

693 
	#ETHTOOL_F_WISH
 (1 << 
ETHTOOL_F_WISH__BIT
)

	)

694 
	#ETHTOOL_F_COMPAT
 (1 << 
ETHTOOL_F_COMPAT__BIT
)

	)

698 
	#ETHTOOL_GSET
 0x00000001

	)

699 
	#ETHTOOL_SSET
 0x00000002

	)

700 
	#ETHTOOL_GDRVINFO
 0x00000003

	)

701 
	#ETHTOOL_GREGS
 0x00000004

	)

702 
	#ETHTOOL_GWOL
 0x00000005

	)

703 
	#ETHTOOL_SWOL
 0x00000006

	)

704 
	#ETHTOOL_GMSGLVL
 0x00000007

	)

705 
	#ETHTOOL_SMSGLVL
 0x00000008

	)

706 
	#ETHTOOL_NWAY_RST
 0x00000009

	)

709 
	#ETHTOOL_GLINK
 0x0000000a

	)

710 
	#ETHTOOL_GEEPROM
 0x0000000b

	)

711 
	#ETHTOOL_SEEPROM
 0x0000000ø

	)

712 
	#ETHTOOL_GCOALESCE
 0x0000000

	)

713 
	#ETHTOOL_SCOALESCE
 0x0000000à

	)

714 
	#ETHTOOL_GRINGPARAM
 0x00000010

	)

715 
	#ETHTOOL_SRINGPARAM
 0x00000011

	)

716 
	#ETHTOOL_GPAUSEPARAM
 0x00000012

	)

717 
	#ETHTOOL_SPAUSEPARAM
 0x00000013

	)

718 
	#ETHTOOL_GRXCSUM
 0x00000014

	)

719 
	#ETHTOOL_SRXCSUM
 0x00000015

	)

720 
	#ETHTOOL_GTXCSUM
 0x00000016

	)

721 
	#ETHTOOL_STXCSUM
 0x00000017

	)

722 
	#ETHTOOL_GSG
 0x00000018

	)

724 
	#ETHTOOL_SSG
 0x00000019

	)

726 
	#ETHTOOL_TEST
 0x0000001¨

	)

727 
	#ETHTOOL_GSTRINGS
 0x0000001b

	)

728 
	#ETHTOOL_PHYS_ID
 0x0000001ø

	)

729 
	#ETHTOOL_GSTATS
 0x0000001d

	)

730 
	#ETHTOOL_GTSO
 0x0000001

	)

731 
	#ETHTOOL_STSO
 0x0000001à

	)

732 
	#ETHTOOL_GPERMADDR
 0x00000020

	)

733 
	#ETHTOOL_GUFO
 0x00000021

	)

734 
	#ETHTOOL_SUFO
 0x00000022

	)

735 
	#ETHTOOL_GGSO
 0x00000023

	)

736 
	#ETHTOOL_SGSO
 0x00000024

	)

737 
	#ETHTOOL_GFLAGS
 0x00000025

	)

738 
	#ETHTOOL_SFLAGS
 0x00000026

	)

739 
	#ETHTOOL_GPFLAGS
 0x00000027

	)

740 
	#ETHTOOL_SPFLAGS
 0x00000028

	)

742 
	#ETHTOOL_GRXFH
 0x00000029

	)

743 
	#ETHTOOL_SRXFH
 0x0000002¨

	)

744 
	#ETHTOOL_GGRO
 0x0000002b

	)

745 
	#ETHTOOL_SGRO
 0x0000002ø

	)

746 
	#ETHTOOL_GRXRINGS
 0x0000002d

	)

747 
	#ETHTOOL_GRXCLSRLCNT
 0x0000002

	)

748 
	#ETHTOOL_GRXCLSRULE
 0x0000002à

	)

749 
	#ETHTOOL_GRXCLSRLALL
 0x00000030

	)

750 
	#ETHTOOL_SRXCLSRLDEL
 0x00000031

	)

751 
	#ETHTOOL_SRXCLSRLINS
 0x00000032

	)

752 
	#ETHTOOL_FLASHDEV
 0x00000033

	)

753 
	#ETHTOOL_RESET
 0x00000034

	)

754 
	#ETHTOOL_SRXNTUPLE
 0x00000035

	)

755 
	#ETHTOOL_GRXNTUPLE
 0x00000036

	)

756 
	#ETHTOOL_GSSET_INFO
 0x00000037

	)

757 
	#ETHTOOL_GRXFHINDIR
 0x00000038

	)

758 
	#ETHTOOL_SRXFHINDIR
 0x00000039

	)

760 
	#ETHTOOL_GFEATURES
 0x0000003¨

	)

761 
	#ETHTOOL_SFEATURES
 0x0000003b

	)

762 
	#ETHTOOL_GCHANNELS
 0x0000003ø

	)

763 
	#ETHTOOL_SCHANNELS
 0x0000003d

	)

764 
	#ETHTOOL_SET_DUMP
 0x0000003

	)

765 
	#ETHTOOL_GET_DUMP_FLAG
 0x0000003à

	)

766 
	#ETHTOOL_GET_DUMP_DATA
 0x00000040

	)

769 
	#SPARC_ETH_GSET
 
ETHTOOL_GSET


	)

770 
	#SPARC_ETH_SSET
 
ETHTOOL_SSET


	)

773 
	#SUPPORTED_10ba£T_H®f
 (1 << 0)

	)

774 
	#SUPPORTED_10ba£T_FuÎ
 (1 << 1)

	)

775 
	#SUPPORTED_100ba£T_H®f
 (1 << 2)

	)

776 
	#SUPPORTED_100ba£T_FuÎ
 (1 << 3)

	)

777 
	#SUPPORTED_1000ba£T_H®f
 (1 << 4)

	)

778 
	#SUPPORTED_1000ba£T_FuÎ
 (1 << 5)

	)

779 
	#SUPPORTED_AutÚeg
 (1 << 6)

	)

780 
	#SUPPORTED_TP
 (1 << 7)

	)

781 
	#SUPPORTED_AUI
 (1 << 8)

	)

782 
	#SUPPORTED_MII
 (1 << 9)

	)

783 
	#SUPPORTED_FIBRE
 (1 << 10)

	)

784 
	#SUPPORTED_BNC
 (1 << 11)

	)

785 
	#SUPPORTED_10000ba£T_FuÎ
 (1 << 12)

	)

786 
	#SUPPORTED_Pau£
 (1 << 13)

	)

787 
	#SUPPORTED_Asym_Pau£
 (1 << 14)

	)

788 
	#SUPPORTED_2500ba£X_FuÎ
 (1 << 15)

	)

789 
	#SUPPORTED_Back¶ªe
 (1 << 16)

	)

790 
	#SUPPORTED_1000ba£KX_FuÎ
 (1 << 17)

	)

791 
	#SUPPORTED_10000ba£KX4_FuÎ
 (1 << 18)

	)

792 
	#SUPPORTED_10000ba£KR_FuÎ
 (1 << 19)

	)

793 
	#SUPPORTED_10000ba£R_FEC
 (1 << 20)

	)

794 
	#SUPPORTED_20000ba£MLD2_FuÎ
 (1 << 21)

	)

795 
	#SUPPORTED_20000ba£KR2_FuÎ
 (1 << 22)

	)

798 
	#ADVERTISED_10ba£T_H®f
 (1 << 0)

	)

799 
	#ADVERTISED_10ba£T_FuÎ
 (1 << 1)

	)

800 
	#ADVERTISED_100ba£T_H®f
 (1 << 2)

	)

801 
	#ADVERTISED_100ba£T_FuÎ
 (1 << 3)

	)

802 
	#ADVERTISED_1000ba£T_H®f
 (1 << 4)

	)

803 
	#ADVERTISED_1000ba£T_FuÎ
 (1 << 5)

	)

804 
	#ADVERTISED_AutÚeg
 (1 << 6)

	)

805 
	#ADVERTISED_TP
 (1 << 7)

	)

806 
	#ADVERTISED_AUI
 (1 << 8)

	)

807 
	#ADVERTISED_MII
 (1 << 9)

	)

808 
	#ADVERTISED_FIBRE
 (1 << 10)

	)

809 
	#ADVERTISED_BNC
 (1 << 11)

	)

810 
	#ADVERTISED_10000ba£T_FuÎ
 (1 << 12)

	)

811 
	#ADVERTISED_Pau£
 (1 << 13)

	)

812 
	#ADVERTISED_Asym_Pau£
 (1 << 14)

	)

813 
	#ADVERTISED_2500ba£X_FuÎ
 (1 << 15)

	)

814 
	#ADVERTISED_Back¶ªe
 (1 << 16)

	)

815 
	#ADVERTISED_1000ba£KX_FuÎ
 (1 << 17)

	)

816 
	#ADVERTISED_10000ba£KX4_FuÎ
 (1 << 18)

	)

817 
	#ADVERTISED_10000ba£KR_FuÎ
 (1 << 19)

	)

818 
	#ADVERTISED_10000ba£R_FEC
 (1 << 20)

	)

819 
	#ADVERTISED_20000ba£MLD2_FuÎ
 (1 << 21)

	)

820 
	#ADVERTISED_20000ba£KR2_FuÎ
 (1 << 22)

	)

829 
	#SPEED_10
 10

	)

830 
	#SPEED_100
 100

	)

831 
	#SPEED_1000
 1000

	)

832 
	#SPEED_2500
 2500

	)

833 
	#SPEED_10000
 10000

	)

834 
	#SPEED_UNKNOWN
 -1

	)

837 
	#DUPLEX_HALF
 0x00

	)

838 
	#DUPLEX_FULL
 0x01

	)

839 
	#DUPLEX_UNKNOWN
 0xff

	)

842 
	#PORT_TP
 0x00

	)

843 
	#PORT_AUI
 0x01

	)

844 
	#PORT_MII
 0x02

	)

845 
	#PORT_FIBRE
 0x03

	)

846 
	#PORT_BNC
 0x04

	)

847 
	#PORT_DA
 0x05

	)

848 
	#PORT_NONE
 0xef

	)

849 
	#PORT_OTHER
 0xff

	)

852 
	#XCVR_INTERNAL
 0x00

	)

853 
	#XCVR_EXTERNAL
 0x01

	)

854 
	#XCVR_DUMMY1
 0x02

	)

855 
	#XCVR_DUMMY2
 0x03

	)

856 
	#XCVR_DUMMY3
 0x04

	)

861 
	#AUTONEG_DISABLE
 0x00

	)

862 
	#AUTONEG_ENABLE
 0x01

	)

865 
	#ETH_TP_MDI_INVALID
 0x00

	)

866 
	#ETH_TP_MDI
 0x01

	)

867 
	#ETH_TP_MDI_X
 0x02

	)

870 
	#WAKE_PHY
 (1 << 0)

	)

871 
	#WAKE_UCAST
 (1 << 1)

	)

872 
	#WAKE_MCAST
 (1 << 2)

	)

873 
	#WAKE_BCAST
 (1 << 3)

	)

874 
	#WAKE_ARP
 (1 << 4)

	)

875 
	#WAKE_MAGIC
 (1 << 5)

	)

876 
	#WAKE_MAGICSECURE
 (1 << 6è

	)

879 
	#TCP_V4_FLOW
 0x01

	)

880 
	#UDP_V4_FLOW
 0x02

	)

881 
	#SCTP_V4_FLOW
 0x03

	)

882 
	#AH_ESP_V4_FLOW
 0x04

	)

883 
	#TCP_V6_FLOW
 0x05

	)

884 
	#UDP_V6_FLOW
 0x06

	)

885 
	#SCTP_V6_FLOW
 0x07

	)

886 
	#AH_ESP_V6_FLOW
 0x08

	)

887 
	#AH_V4_FLOW
 0x09

	)

888 
	#ESP_V4_FLOW
 0x0¨

	)

889 
	#AH_V6_FLOW
 0x0b

	)

890 
	#ESP_V6_FLOW
 0x0ø

	)

891 
	#IP_USER_FLOW
 0x0d

	)

892 
	#IPV4_FLOW
 0x10

	)

893 
	#IPV6_FLOW
 0x11

	)

894 
	#ETHER_FLOW
 0x12

	)

896 
	#FLOW_EXT
 0x80000000

	)

899 
	#RXH_L2DA
 (1 << 1)

	)

900 
	#RXH_VLAN
 (1 << 2)

	)

901 
	#RXH_L3_PROTO
 (1 << 3)

	)

902 
	#RXH_IP_SRC
 (1 << 4)

	)

903 
	#RXH_IP_DST
 (1 << 5)

	)

904 
	#RXH_L4_B_0_1
 (1 << 6è

	)

905 
	#RXH_L4_B_2_3
 (1 << 7è

	)

906 
	#RXH_DISCARD
 (1 << 31)

	)

908 
	#RX_CLS_FLOW_DISC
 0xffffffffffffffffULL

	)

917 
	e‘htoŞ_»£t_æags
 {

923 
	mETH_RESET_MGMT
 = 1 << 0,

924 
	mETH_RESET_IRQ
 = 1 << 1,

925 
	mETH_RESET_DMA
 = 1 << 2,

926 
	mETH_RESET_FILTER
 = 1 << 3,

927 
	mETH_RESET_OFFLOAD
 = 1 << 4,

928 
	mETH_RESET_MAC
 = 1 << 5,

929 
	mETH_RESET_PHY
 = 1 << 6,

930 
	mETH_RESET_RAM
 = 1 << 7,

933 
	mETH_RESET_DEDICATED
 = 0x0000ffff,

935 
	mETH_RESET_ALL
 = 0xffffffff,

938 
	#ETH_RESET_SHARED_SHIFT
 16

	)

	@/usr/include/linux/eventpoll.h

14 #iâdeà
_LINUX_EVENTPOLL_H


15 
	#_LINUX_EVENTPOLL_H


	)

18 
	~<lšux/fú.h
>

19 
	~<lšux/ty³s.h
>

22 
	#EPOLL_CLOEXEC
 
O_CLOEXEC


	)

25 
	#EPOLL_CTL_ADD
 1

	)

26 
	#EPOLL_CTL_DEL
 2

	)

27 
	#EPOLL_CTL_MOD
 3

	)

30 
	#EPOLLONESHOT
 (1 << 30)

	)

33 
	#EPOLLET
 (1 << 31)

	)

41 #ifdeà
__x86_64__


42 
	#EPOLL_PACKED
 
	`__©Œibu‹__
((
·cked
))

	)

44 
	#EPOLL_PACKED


	)

47 
	s•Şl_ev’t
 {

48 
__u32
 
	mev’ts
;

49 
__u64
 
	md©a
;

50 } 
	gEPOLL_PACKED
;

	@/usr/include/linux/falloc.h

1 #iâdeà
_FALLOC_H_


2 
	#_FALLOC_H_


	)

4 
	#FALLOC_FL_KEEP_SIZE
 0x01

	)

5 
	#FALLOC_FL_PUNCH_HOLE
 0x02

	)

	@/usr/include/linux/fb.h

1 #iâdeà
_LINUX_FB_H


2 
	#_LINUX_FB_H


	)

4 
	~<lšux/ty³s.h
>

5 
	~<lšux/i2c.h
>

9 
	#FB_MAX
 32

	)

13 
	#FBIOGET_VSCREENINFO
 0x4600

	)

14 
	#FBIOPUT_VSCREENINFO
 0x4601

	)

15 
	#FBIOGET_FSCREENINFO
 0x4602

	)

16 
	#FBIOGETCMAP
 0x4604

	)

17 
	#FBIOPUTCMAP
 0x4605

	)

18 
	#FBIOPAN_DISPLAY
 0x4606

	)

19 
	#FBIO_CURSOR
 
	`_IOWR
('F', 0x08, 
fb_cursÜ
)

	)

24 
	#FBIOGET_CON2FBMAP
 0x460F

	)

25 
	#FBIOPUT_CON2FBMAP
 0x4610

	)

26 
	#FBIOBLANK
 0x4611

	)

27 
	#FBIOGET_VBLANK
 
	`_IOR
('F', 0x12, 
fb_vbÏnk
)

	)

28 
	#FBIO_ALLOC
 0x4613

	)

29 
	#FBIO_FREE
 0x4614

	)

30 
	#FBIOGET_GLYPH
 0x4615

	)

31 
	#FBIOGET_HWCINFO
 0x4616

	)

32 
	#FBIOPUT_MODEINFO
 0x4617

	)

33 
	#FBIOGET_DISPINFO
 0x4618

	)

34 
	#FBIO_WAITFORVSYNC
 
	`_IOW
('F', 0x20, 
__u32
)

	)

36 
	#FB_TYPE_PACKED_PIXELS
 0

	)

37 
	#FB_TYPE_PLANES
 1

	)

38 
	#FB_TYPE_INTERLEAVED_PLANES
 2

	)

39 
	#FB_TYPE_TEXT
 3

	)

40 
	#FB_TYPE_VGA_PLANES
 4

	)

42 
	#FB_AUX_TEXT_MDA
 0

	)

43 
	#FB_AUX_TEXT_CGA
 1

	)

44 
	#FB_AUX_TEXT_S3_MMIO
 2

	)

45 
	#FB_AUX_TEXT_MGA_STEP16
 3

	)

46 
	#FB_AUX_TEXT_MGA_STEP8
 4

	)

47 
	#FB_AUX_TEXT_SVGA_GROUP
 8

	)

48 
	#FB_AUX_TEXT_SVGA_MASK
 7

	)

49 
	#FB_AUX_TEXT_SVGA_STEP2
 8

	)

50 
	#FB_AUX_TEXT_SVGA_STEP4
 9

	)

51 
	#FB_AUX_TEXT_SVGA_STEP8
 10

	)

52 
	#FB_AUX_TEXT_SVGA_STEP16
 11

	)

53 
	#FB_AUX_TEXT_SVGA_LAST
 15

	)

55 
	#FB_AUX_VGA_PLANES_VGA4
 0

	)

56 
	#FB_AUX_VGA_PLANES_CFB4
 1

	)

57 
	#FB_AUX_VGA_PLANES_CFB8
 2

	)

59 
	#FB_VISUAL_MONO01
 0

	)

60 
	#FB_VISUAL_MONO10
 1

	)

61 
	#FB_VISUAL_TRUECOLOR
 2

	)

62 
	#FB_VISUAL_PSEUDOCOLOR
 3

	)

63 
	#FB_VISUAL_DIRECTCOLOR
 4

	)

64 
	#FB_VISUAL_STATIC_PSEUDOCOLOR
 5

	)

66 
	#FB_ACCEL_NONE
 0

	)

67 
	#FB_ACCEL_ATARIBLITT
 1

	)

68 
	#FB_ACCEL_AMIGABLITT
 2

	)

69 
	#FB_ACCEL_S3_TRIO64
 3

	)

70 
	#FB_ACCEL_NCR_77C32BLT
 4

	)

71 
	#FB_ACCEL_S3_VIRGE
 5

	)

72 
	#FB_ACCEL_ATI_MACH64GX
 6

	)

73 
	#FB_ACCEL_DEC_TGA
 7

	)

74 
	#FB_ACCEL_ATI_MACH64CT
 8

	)

75 
	#FB_ACCEL_ATI_MACH64VT
 9

	)

76 
	#FB_ACCEL_ATI_MACH64GT
 10

	)

77 
	#FB_ACCEL_SUN_CREATOR
 11

	)

78 
	#FB_ACCEL_SUN_CGSIX
 12

	)

79 
	#FB_ACCEL_SUN_LEO
 13

	)

80 
	#FB_ACCEL_IMS_TWINTURBO
 14

	)

81 
	#FB_ACCEL_3DLABS_PERMEDIA2
 15

	)

82 
	#FB_ACCEL_MATROX_MGA2064W
 16

	)

83 
	#FB_ACCEL_MATROX_MGA1064SG
 17

	)

84 
	#FB_ACCEL_MATROX_MGA2164W
 18

	)

85 
	#FB_ACCEL_MATROX_MGA2164W_AGP
 19

	)

86 
	#FB_ACCEL_MATROX_MGAG100
 20

	)

87 
	#FB_ACCEL_MATROX_MGAG200
 21

	)

88 
	#FB_ACCEL_SUN_CG14
 22

	)

89 
	#FB_ACCEL_SUN_BWTWO
 23

	)

90 
	#FB_ACCEL_SUN_CGTHREE
 24

	)

91 
	#FB_ACCEL_SUN_TCX
 25

	)

92 
	#FB_ACCEL_MATROX_MGAG400
 26

	)

93 
	#FB_ACCEL_NV3
 27

	)

94 
	#FB_ACCEL_NV4
 28

	)

95 
	#FB_ACCEL_NV5
 29

	)

96 
	#FB_ACCEL_CT_6555x
 30

	)

97 
	#FB_ACCEL_3DFX_BANSHEE
 31

	)

98 
	#FB_ACCEL_ATI_RAGE128
 32

	)

99 
	#FB_ACCEL_IGS_CYBER2000
 33

	)

100 
	#FB_ACCEL_IGS_CYBER2010
 34

	)

101 
	#FB_ACCEL_IGS_CYBER5000
 35

	)

102 
	#FB_ACCEL_SIS_GLAMOUR
 36

	)

103 
	#FB_ACCEL_3DLABS_PERMEDIA3
 37

	)

104 
	#FB_ACCEL_ATI_RADEON
 38

	)

105 
	#FB_ACCEL_I810
 39

	)

106 
	#FB_ACCEL_SIS_GLAMOUR_2
 40

	)

107 
	#FB_ACCEL_SIS_XABRE
 41

	)

108 
	#FB_ACCEL_I830
 42

	)

109 
	#FB_ACCEL_NV_10
 43

	)

110 
	#FB_ACCEL_NV_20
 44

	)

111 
	#FB_ACCEL_NV_30
 45

	)

112 
	#FB_ACCEL_NV_40
 46

	)

113 
	#FB_ACCEL_XGI_VOLARI_V
 47

	)

114 
	#FB_ACCEL_XGI_VOLARI_Z
 48

	)

115 
	#FB_ACCEL_OMAP1610
 49

	)

116 
	#FB_ACCEL_TRIDENT_TGUI
 50

	)

117 
	#FB_ACCEL_TRIDENT_3DIMAGE
 51

	)

118 
	#FB_ACCEL_TRIDENT_BLADE3D
 52

	)

119 
	#FB_ACCEL_TRIDENT_BLADEXP
 53

	)

120 
	#FB_ACCEL_CIRRUS_ALPINE
 53

	)

121 
	#FB_ACCEL_NEOMAGIC_NM2070
 90

	)

122 
	#FB_ACCEL_NEOMAGIC_NM2090
 91

	)

123 
	#FB_ACCEL_NEOMAGIC_NM2093
 92

	)

124 
	#FB_ACCEL_NEOMAGIC_NM2097
 93

	)

125 
	#FB_ACCEL_NEOMAGIC_NM2160
 94

	)

126 
	#FB_ACCEL_NEOMAGIC_NM2200
 95

	)

127 
	#FB_ACCEL_NEOMAGIC_NM2230
 96

	)

128 
	#FB_ACCEL_NEOMAGIC_NM2360
 97

	)

129 
	#FB_ACCEL_NEOMAGIC_NM2380
 98

	)

130 
	#FB_ACCEL_PXA3XX
 99

	)

132 
	#FB_ACCEL_SAVAGE4
 0x80

	)

133 
	#FB_ACCEL_SAVAGE3D
 0x81

	)

134 
	#FB_ACCEL_SAVAGE3D_MV
 0x82

	)

135 
	#FB_ACCEL_SAVAGE2000
 0x83

	)

136 
	#FB_ACCEL_SAVAGE_MX_MV
 0x84

	)

137 
	#FB_ACCEL_SAVAGE_MX
 0x85

	)

138 
	#FB_ACCEL_SAVAGE_IX_MV
 0x86

	)

139 
	#FB_ACCEL_SAVAGE_IX
 0x87

	)

140 
	#FB_ACCEL_PROSAVAGE_PM
 0x88

	)

141 
	#FB_ACCEL_PROSAVAGE_KM
 0x89

	)

142 
	#FB_ACCEL_S3TWISTER_P
 0x8¨

	)

143 
	#FB_ACCEL_S3TWISTER_K
 0x8b

	)

144 
	#FB_ACCEL_SUPERSAVAGE
 0x8ø

	)

145 
	#FB_ACCEL_PROSAVAGE_DDR
 0x8d

	)

146 
	#FB_ACCEL_PROSAVAGE_DDRK
 0x8

	)

148 
	#FB_ACCEL_PUV3_UNIGFX
 0xa0

	)

150 
	sfb_fix_sü“nšfo
 {

151 
	mid
[16];

152 
	msmem_¡¬t
;

154 
__u32
 
	msmem_Ën
;

155 
__u32
 
	mty³
;

156 
__u32
 
	mty³_aux
;

157 
__u32
 
	mvisu®
;

158 
__u16
 
	mx·n¡•
;

159 
__u16
 
	my·n¡•
;

160 
__u16
 
	myw¿p¡•
;

161 
__u32
 
	mlše_Ëngth
;

162 
	mmmio_¡¬t
;

164 
__u32
 
	mmmio_Ën
;

165 
__u32
 
	macûl
;

167 
__u16
 
	m»£rved
[3];

180 
	sfb_b™f›ld
 {

181 
__u32
 
	moff£t
;

182 
__u32
 
	mËngth
;

183 
__u32
 
	mmsb_right
;

187 
	#FB_NONSTD_HAM
 1

	)

188 
	#FB_NONSTD_REV_PIX_IN_B
 2

	)

190 
	#FB_ACTIVATE_NOW
 0

	)

191 
	#FB_ACTIVATE_NXTOPEN
 1

	)

192 
	#FB_ACTIVATE_TEST
 2

	)

193 
	#FB_ACTIVATE_MASK
 15

	)

195 
	#FB_ACTIVATE_VBL
 16

	)

196 
	#FB_CHANGE_CMAP_VBL
 32

	)

197 
	#FB_ACTIVATE_ALL
 64

	)

198 
	#FB_ACTIVATE_FORCE
 128

	)

199 
	#FB_ACTIVATE_INV_MODE
 256

	)

201 
	#FB_ACCELF_TEXT
 1

	)

203 
	#FB_SYNC_HOR_HIGH_ACT
 1

	)

204 
	#FB_SYNC_VERT_HIGH_ACT
 2

	)

205 
	#FB_SYNC_EXT
 4

	)

206 
	#FB_SYNC_COMP_HIGH_ACT
 8

	)

207 
	#FB_SYNC_BROADCAST
 16

	)

210 
	#FB_SYNC_ON_GREEN
 32

	)

212 
	#FB_VMODE_NONINTERLACED
 0

	)

213 
	#FB_VMODE_INTERLACED
 1

	)

214 
	#FB_VMODE_DOUBLE
 2

	)

215 
	#FB_VMODE_ODD_FLD_FIRST
 4

	)

216 
	#FB_VMODE_MASK
 255

	)

218 
	#FB_VMODE_YWRAP
 256

	)

219 
	#FB_VMODE_SMOOTH_XPAN
 512

	)

220 
	#FB_VMODE_CONUPDATE
 512

	)

225 
	#FB_ROTATE_UR
 0

	)

226 
	#FB_ROTATE_CW
 1

	)

227 
	#FB_ROTATE_UD
 2

	)

228 
	#FB_ROTATE_CCW
 3

	)

230 
	#PICOS2KHZ
(
a
è(1000000000UL/×))

	)

231 
	#KHZ2PICOS
(
a
è(1000000000UL/×))

	)

233 
	sfb_v¬_sü“nšfo
 {

234 
__u32
 
	mx»s
;

235 
__u32
 
	my»s
;

236 
__u32
 
	mx»s_vœtu®
;

237 
__u32
 
	my»s_vœtu®
;

238 
__u32
 
	mxoff£t
;

239 
__u32
 
	myoff£t
;

241 
__u32
 
	mb™s_³r_pix–
;

242 
__u32
 
	mg¿ysÿË
;

244 
fb_b™f›ld
 
	m»d
;

245 
fb_b™f›ld
 
	mg»’
;

246 
fb_b™f›ld
 
	mblue
;

247 
fb_b™f›ld
 
	mŒª¥
;

249 
__u32
 
	mnÚ¡d
;

251 
__u32
 
	maùiv©e
;

253 
__u32
 
	mheight
;

254 
__u32
 
	mwidth
;

256 
__u32
 
	macûl_æags
;

259 
__u32
 
	mpixşock
;

260 
__u32
 
	mËá_m¬gš
;

261 
__u32
 
	mright_m¬gš
;

262 
__u32
 
	muµ”_m¬gš
;

263 
__u32
 
	mlow”_m¬gš
;

264 
__u32
 
	mhsync_Ën
;

265 
__u32
 
	mvsync_Ën
;

266 
__u32
 
	msync
;

267 
__u32
 
	mvmode
;

268 
__u32
 
	mrÙ©e
;

269 
__u32
 
	m»£rved
[5];

272 
	sfb_cm­
 {

273 
__u32
 
	m¡¬t
;

274 
__u32
 
	mËn
;

275 
__u16
 *
	m»d
;

276 
__u16
 *
	mg»’
;

277 
__u16
 *
	mblue
;

278 
__u16
 *
	mŒª¥
;

281 
	sfb_cÚ2fbm­
 {

282 
__u32
 
	mcÚsŞe
;

283 
__u32
 
	mäamebufãr
;

287 
	#VESA_NO_BLANKING
 0

	)

288 
	#VESA_VSYNC_SUSPEND
 1

	)

289 
	#VESA_HSYNC_SUSPEND
 2

	)

290 
	#VESA_POWERDOWN
 3

	)

295 
	mFB_BLANK_UNBLANK
 = 
VESA_NO_BLANKING
,

298 
	mFB_BLANK_NORMAL
 = 
VESA_NO_BLANKING
 + 1,

301 
	mFB_BLANK_VSYNC_SUSPEND
 = 
VESA_VSYNC_SUSPEND
 + 1,

304 
	mFB_BLANK_HSYNC_SUSPEND
 = 
VESA_HSYNC_SUSPEND
 + 1,

307 
	mFB_BLANK_POWERDOWN
 = 
VESA_POWERDOWN
 + 1

310 
	#FB_VBLANK_VBLANKING
 0x001

	)

311 
	#FB_VBLANK_HBLANKING
 0x002

	)

312 
	#FB_VBLANK_HAVE_VBLANK
 0x004

	)

313 
	#FB_VBLANK_HAVE_HBLANK
 0x008

	)

314 
	#FB_VBLANK_HAVE_COUNT
 0x010

	)

315 
	#FB_VBLANK_HAVE_VCOUNT
 0x020

	)

316 
	#FB_VBLANK_HAVE_HCOUNT
 0x040

	)

317 
	#FB_VBLANK_VSYNCING
 0x080

	)

318 
	#FB_VBLANK_HAVE_VSYNC
 0x100

	)

320 
	sfb_vbÏnk
 {

321 
__u32
 
	mæags
;

322 
__u32
 
	mcouÁ
;

323 
__u32
 
	mvcouÁ
;

324 
__u32
 
	mhcouÁ
;

325 
__u32
 
	m»£rved
[4];

329 
	#ROP_COPY
 0

	)

330 
	#ROP_XOR
 1

	)

332 
	sfb_cİy¬—
 {

333 
__u32
 
	mdx
;

334 
__u32
 
	mdy
;

335 
__u32
 
	mwidth
;

336 
__u32
 
	mheight
;

337 
__u32
 
	msx
;

338 
__u32
 
	msy
;

341 
	sfb_fÌeù
 {

342 
__u32
 
	mdx
;

343 
__u32
 
	mdy
;

344 
__u32
 
	mwidth
;

345 
__u32
 
	mheight
;

346 
__u32
 
	mcŞÜ
;

347 
__u32
 
	mrİ
;

350 
	sfb_image
 {

351 
__u32
 
	mdx
;

352 
__u32
 
	mdy
;

353 
__u32
 
	mwidth
;

354 
__u32
 
	mheight
;

355 
__u32
 
	mfg_cŞÜ
;

356 
__u32
 
	mbg_cŞÜ
;

357 
__u8
 
	md•th
;

358 cÚ¡ *
	md©a
;

359 
fb_cm­
 
	mcm­
;

366 
	#FB_CUR_SETIMAGE
 0x01

	)

367 
	#FB_CUR_SETPOS
 0x02

	)

368 
	#FB_CUR_SETHOT
 0x04

	)

369 
	#FB_CUR_SETCMAP
 0x08

	)

370 
	#FB_CUR_SETSHAPE
 0x10

	)

371 
	#FB_CUR_SETSIZE
 0x20

	)

372 
	#FB_CUR_SETALL
 0xFF

	)

374 
	sfbcu½os
 {

375 
__u16
 
	mx
, 
	my
;

378 
	sfb_cursÜ
 {

379 
__u16
 
	m£t
;

380 
__u16
 
	m’abË
;

381 
__u16
 
	mrİ
;

382 cÚ¡ *
	mmask
;

383 
fbcu½os
 
	mhÙ
;

384 
fb_image
 
	mimage
;

387 #ifdeà
CONFIG_FB_BACKLIGHT


389 
	#FB_BACKLIGHT_LEVELS
 128

	)

390 
	#FB_BACKLIGHT_MAX
 0xFF

	)

	@/usr/include/linux/fcntl.h

1 #iâdeà
_LINUX_FCNTL_H


2 
	#_LINUX_FCNTL_H


	)

4 
	~<asm/fú.h
>

6 
	#F_SETLEASE
 (
F_LINUX_SPECIFIC_BASE
 + 0)

	)

7 
	#F_GETLEASE
 (
F_LINUX_SPECIFIC_BASE
 + 1)

	)

13 
	#F_CANCELLK
 (
F_LINUX_SPECIFIC_BASE
 + 5)

	)

16 
	#F_DUPFD_CLOEXEC
 (
F_LINUX_SPECIFIC_BASE
 + 6)

	)

22 
	#F_NOTIFY
 (
F_LINUX_SPECIFIC_BASE
+2)

	)

27 
	#F_SETPIPE_SZ
 (
F_LINUX_SPECIFIC_BASE
 + 7)

	)

28 
	#F_GETPIPE_SZ
 (
F_LINUX_SPECIFIC_BASE
 + 8)

	)

33 
	#DN_ACCESS
 0x00000001

	)

34 
	#DN_MODIFY
 0x00000002

	)

35 
	#DN_CREATE
 0x00000004

	)

36 
	#DN_DELETE
 0x00000008

	)

37 
	#DN_RENAME
 0x00000010

	)

38 
	#DN_ATTRIB
 0x00000020

	)

39 
	#DN_MULTISHOT
 0x80000000

	)

41 
	#AT_FDCWD
 -100

	)

44 
	#AT_SYMLINK_NOFOLLOW
 0x100

	)

45 
	#AT_REMOVEDIR
 0x200

	)

47 
	#AT_SYMLINK_FOLLOW
 0x400

	)

48 
	#AT_NO_AUTOMOUNT
 0x800

	)

49 
	#AT_EMPTY_PATH
 0x1000

	)

	@/usr/include/linux/fd.h

1 #iâdeà
_LINUX_FD_H


2 
	#_LINUX_FD_H


	)

4 
	~<lšux/ioùl.h
>

13 
	sæİpy_¡ruù
 {

14 
	msize
,

15 
	m£ù
,

16 
	mh—d
,

17 
	mŒack
,

18 
	m¡»tch
;

22 
	#FD_STRETCH
 1

	)

23 
	#FD_SWAPSIDES
 2

	)

24 
	#FD_ZEROBASED
 4

	)

25 
	#FD_SECTBASEMASK
 0x3FC

	)

26 
	#FD_MKSECTBASE
(
s
è(((sè^ 1è<< 2)

	)

27 
	#FD_SECTBASE
(
æİpy
è((((æİpy)->
¡»tch
 & 
FD_SECTBASEMASK
è>> 2è^ 1)

	)

29 
	mg­
,

31 
	m¿‹
,

32 
	#FD_2M
 0x4

	)

33 
	#FD_SIZECODEMASK
 0x38

	)

34 
	#FD_SIZECODE
(
æİpy
è(((((æİpy)->
¿‹
&
FD_SIZECODEMASK
)>> 3)+ 2è%8)

	)

35 
	#FD_SECTSIZE
(
æİpy
èĞ(æİpy)->
¿‹
 & 
FD_2M
 ? \

36 512 : 128 << 
	`FD_SIZECODE
(
æİpy
è)

	)

37 
	#FD_PERP
 0x40

	)

39 
	m¥ec1
,

40 
	mfmt_g­
;

41 cÚ¡ * 
	mÇme
;

48 
	#FDCLRPRM
 
	`_IO
(2, 0x41)

	)

51 
	#FDSETPRM
 
	`_IOW
(2, 0x42, 
æİpy_¡ruù
)

	)

52 
	#FDSETMEDIAPRM
 
FDSETPRM


	)

55 
	#FDDEFPRM
 
	`_IOW
(2, 0x43, 
æİpy_¡ruù
)

	)

56 
	#FDGETPRM
 
	`_IOR
(2, 0x04, 
æİpy_¡ruù
)

	)

57 
	#FDDEFMEDIAPRM
 
FDDEFPRM


	)

58 
	#FDGETMEDIAPRM
 
FDGETPRM


	)

62 
	#FDMSGON
 
	`_IO
(2,0x45)

	)

63 
	#FDMSGOFF
 
	`_IO
(2,0x46)

	)

70 
	#FD_FILL_BYTE
 0xF6

	)

72 
	sfÜm©_desü
 {

73 
	mdeviû
,
	mh—d
,
	mŒack
;

76 
	#FDFMTBEG
 
	`_IO
(2,0x47)

	)

78 
	#FDFMTTRK
 
	`_IOW
(2,0x48, 
fÜm©_desü
)

	)

80 
	#FDFMTEND
 
	`_IO
(2,0x49)

	)

87 
	sæİpy_max_”rÜs
 {

89 
	mabÜt
,

90 
	m»ad_Œack
,

92 
	m»£t
,

93 
	m»ÿl
,

101 
	m»pÜtšg
;

105 
	#FDSETEMSGTRESH
 
	`_IO
(2,0x4a)

	)

108 
	#FDFLUSH
 
	`_IO
(2,0x4b)

	)

112 
	#FDSETMAXERRS
 
	`_IOW
(2, 0x4c, 
æİpy_max_”rÜs
)

	)

113 
	#FDGETMAXERRS
 
	`_IOR
(2, 0x0e, 
æİpy_max_”rÜs
)

	)

118 
	tæİpy_drive_Çme
[16];

119 
	#FDGETDRVTYP
 
	`_IOR
(2, 0x0f, 
æİpy_drive_Çme
)

	)

126 
	sæİpy_drive_·¿ms
 {

127 sigÃd 
	mcmos
;

132 
	mmax_dŒ
;

133 
	mhÉ
;

134 
	mhut
;

136 
	m¤t
;

138 
	m¥šup
;

140 
	m¥šdown
;

141 
	m¥šdown_off£t
;

143 
	m£Ëù_d–ay
;

144 
	m½s
;

145 
	mŒacks
;

146 
	mtimeout
;

148 
	mš‹¾—ve_£ù
;

151 
æİpy_max_”rÜs
 
	mmax_”rÜs
;

153 
	mæags
;

160 
	#FTD_MSG
 0x10

	)

161 
	#FD_BROKEN_DCL
 0x20

	)

162 
	#FD_DEBUG
 0x02

	)

163 
	#FD_SILENT_DCL_CLEAR
 0x4

	)

164 
	#FD_INVERTED_DCL
 0x80

	)

167 
	m»ad_Œack
;

174 
	mautod‘eù
[8];

176 
	mcheckäeq
;

178 
	mÇtive_fÜm©
;

182 
	mFD_NEED_TWADDLE_BIT
,

183 
	mFD_VERIFY_BIT
,

184 
	mFD_DISK_NEWCHANGE_BIT
,

186 
	mFD_UNUSED_BIT
,

187 
	mFD_DISK_CHANGED_BIT
,

188 
	mFD_DISK_WRITABLE_BIT


191 
	#FDSETDRVPRM
 
	`_IOW
(2, 0x90, 
æİpy_drive_·¿ms
)

	)

192 
	#FDGETDRVPRM
 
	`_IOR
(2, 0x11, 
æİpy_drive_·¿ms
)

	)

199 
	sæİpy_drive_¡ruù
 {

200 
	mæags
;

202 
	#FD_NEED_TWADDLE
 (1 << 
FD_NEED_TWADDLE_BIT
)

	)

203 
	#FD_VERIFY
 (1 << 
FD_VERIFY_BIT
)

	)

204 
	#FD_DISK_NEWCHANGE
 (1 << 
FD_DISK_NEWCHANGE_BIT
)

	)

205 
	#FD_DISK_CHANGED
 (1 << 
FD_DISK_CHANGED_BIT
)

	)

206 
	#FD_DISK_WRITABLE
 (1 << 
FD_DISK_WRITABLE_BIT
)

	)

208 
	m¥šup_d©e
;

209 
	m£Ëù_d©e
;

210 
	mfœ¡_»ad_d©e
;

211 
	m´obed_fÜm©
;

212 
	mŒack
;

213 
	mmaxblock
;

214 
	mmaxŒack
;

215 
	mg’”©iÚ
;

222 
	mk“p_d©a
;

225 
	mfd_»f
;

226 
	mfd_deviû
;

227 
	mÏ¡_checked
;

230 *
	mdmabuf
;

231 
	mbufblocks
;

234 
	#FDGETDRVSTAT
 
	`_IOR
(2, 0x12, 
æİpy_drive_¡ruù
)

	)

235 
	#FDPOLLDRVSTAT
 
	`_IOR
(2, 0x13, 
æİpy_drive_¡ruù
)

	)

242 
	e»£t_mode
 {

243 
	mFD_RESET_IF_NEEDED
,

244 
	mFD_RESET_IF_RAWCMD
,

245 
	mFD_RESET_ALWAYS


247 
	#FDRESET
 
	`_IO
(2, 0x54)

	)

253 
	sæİpy_fdc_¡©e
 {

254 
	m¥ec1
;

255 
	m¥ec2
;

256 
	mdŒ
;

257 
	mv”siÚ
;

258 
	mdÜ
;

259 
	madd»ss
;

260 
	m¿wcmd
:2;

261 
	m»£t
:1;

262 
	mÃed_cÚfigu»
:1;

263 
	m³½_mode
:2;

264 
	mhas_fifo
:1;

265 
	mdriv”_v”siÚ
;

266 
	#FD_DRIVER_VERSION
 0x100

	)

274 
	mŒack
[4];

285 
	#FDGETFDCSTAT
 
	`_IOR
(2, 0x15, 
æİpy_fdc_¡©e
)

	)

291 
	sæİpy_wr™e_”rÜs
 {

300 
	mwr™e_”rÜs
;

304 
	mfœ¡_”rÜ_£ùÜ
;

305 
	mfœ¡_”rÜ_g’”©iÚ
;

306 
	mÏ¡_”rÜ_£ùÜ
;

307 
	mÏ¡_”rÜ_g’”©iÚ
;

309 
	mbadÃss
;

313 
	#FDWERRORCLR
 
	`_IO
(2, 0x56)

	)

315 
	#FDWERRORGET
 
	`_IOR
(2, 0x17, 
æİpy_wr™e_”rÜs
)

	)

323 
	#FDHAVEBATCHEDRAWCMD


	)

325 
	sæİpy_¿w_cmd
 {

326 
	mæags
;

327 
	#FD_RAW_READ
 1

	)

328 
	#FD_RAW_WRITE
 2

	)

329 
	#FD_RAW_NO_MOTOR
 4

	)

330 
	#FD_RAW_DISK_CHANGE
 4

	)

331 
	#FD_RAW_INTR
 8

	)

332 
	#FD_RAW_SPIN
 0x10

	)

333 
	#FD_RAW_NO_MOTOR_AFTER
 0x20

	)

335 
	#FD_RAW_NEED_DISK
 0x40

	)

336 
	#FD_RAW_NEED_SEEK
 0x80

	)

339 
	#FD_RAW_MORE
 0x100

	)

340 
	#FD_RAW_STOP_IF_FAILURE
 0x200

	)

341 
	#FD_RAW_STOP_IF_SUCCESS
 0x400

	)

342 
	#FD_RAW_SOFTFAILURE
 0x800

	)

346 
	#FD_RAW_FAILURE
 0x10000

	)

347 
	#FD_RAW_HARDFAILURE
 0x20000

	)

349 *
	md©a
;

350 *
	mk”Ãl_d©a
;

351 
æİpy_¿w_cmd
 *
	mÃxt
;

353 
	mËngth
;

354 
	mphys_Ëngth
;

355 
	mbufãr_Ëngth
;

357 
	m¿‹
;

358 
	mcmd_couÁ
;

359 
	mcmd
[16];

360 
	m»¶y_couÁ
;

361 
	m»¶y
[16];

362 
	mŒack
;

363 
	m»suÉcode
;

365 
	m»£rved1
;

366 
	m»£rved2
;

369 
	#FDRAWCMD
 
	`_IO
(2, 0x58)

	)

373 
	#FDTWADDLE
 
	`_IO
(2, 0x59)

	)

377 
	#FDEJECT
 
	`_IO
(2, 0x5a)

	)

	@/usr/include/linux/filter.h

5 #iâdeà
__LINUX_FILTER_H__


6 
	#__LINUX_FILTER_H__


	)

9 
	~<lšux/ty³s.h
>

15 
	#BPF_MAJOR_VERSION
 1

	)

16 
	#BPF_MINOR_VERSION
 1

	)

23 
	ssock_f‹r
 {

24 
__u16
 
	mcode
;

25 
__u8
 
	mjt
;

26 
__u8
 
	mjf
;

27 
__u32
 
	mk
;

30 
	ssock_årog
 {

31 
	mËn
;

32 
sock_f‹r
 *
	mf‹r
;

39 
	#BPF_CLASS
(
code
è((codeè& 0x07)

	)

40 
	#BPF_LD
 0x00

	)

41 
	#BPF_LDX
 0x01

	)

42 
	#BPF_ST
 0x02

	)

43 
	#BPF_STX
 0x03

	)

44 
	#BPF_ALU
 0x04

	)

45 
	#BPF_JMP
 0x05

	)

46 
	#BPF_RET
 0x06

	)

47 
	#BPF_MISC
 0x07

	)

50 
	#BPF_SIZE
(
code
è((codeè& 0x18)

	)

51 
	#BPF_W
 0x00

	)

52 
	#BPF_H
 0x08

	)

53 
	#BPF_B
 0x10

	)

54 
	#BPF_MODE
(
code
è((codeè& 0xe0)

	)

55 
	#BPF_IMM
 0x00

	)

56 
	#BPF_ABS
 0x20

	)

57 
	#BPF_IND
 0x40

	)

58 
	#BPF_MEM
 0x60

	)

59 
	#BPF_LEN
 0x80

	)

60 
	#BPF_MSH
 0xa0

	)

63 
	#BPF_OP
(
code
è((codeè& 0xf0)

	)

64 
	#BPF_ADD
 0x00

	)

65 
	#BPF_SUB
 0x10

	)

66 
	#BPF_MUL
 0x20

	)

67 
	#BPF_DIV
 0x30

	)

68 
	#BPF_OR
 0x40

	)

69 
	#BPF_AND
 0x50

	)

70 
	#BPF_LSH
 0x60

	)

71 
	#BPF_RSH
 0x70

	)

72 
	#BPF_NEG
 0x80

	)

73 
	#BPF_JA
 0x00

	)

74 
	#BPF_JEQ
 0x10

	)

75 
	#BPF_JGT
 0x20

	)

76 
	#BPF_JGE
 0x30

	)

77 
	#BPF_JSET
 0x40

	)

78 
	#BPF_SRC
(
code
è((codeè& 0x08)

	)

79 
	#BPF_K
 0x00

	)

80 
	#BPF_X
 0x08

	)

83 
	#BPF_RVAL
(
code
è((codeè& 0x18)

	)

84 
	#BPF_A
 0x10

	)

87 
	#BPF_MISCOP
(
code
è((codeè& 0xf8)

	)

88 
	#BPF_TAX
 0x00

	)

89 
	#BPF_TXA
 0x80

	)

91 #iâdeà
BPF_MAXINSNS


92 
	#BPF_MAXINSNS
 4096

	)

98 #iâdeà
BPF_STMT


99 
	#BPF_STMT
(
code
, 
k
è{ ()(code), 0, 0, k }

	)

101 #iâdeà
BPF_JUMP


102 
	#BPF_JUMP
(
code
, 
k
, 
jt
, 
jf
è{ ()(code), jt, jf, k }

	)

108 
	#BPF_MEMWORDS
 16

	)

115 
	#SKF_AD_OFF
 (-0x1000)

	)

116 
	#SKF_AD_PROTOCOL
 0

	)

117 
	#SKF_AD_PKTTYPE
 4

	)

118 
	#SKF_AD_IFINDEX
 8

	)

119 
	#SKF_AD_NLATTR
 12

	)

120 
	#SKF_AD_NLATTR_NEST
 16

	)

121 
	#SKF_AD_MARK
 20

	)

122 
	#SKF_AD_QUEUE
 24

	)

123 
	#SKF_AD_HATYPE
 28

	)

124 
	#SKF_AD_RXHASH
 32

	)

125 
	#SKF_AD_CPU
 36

	)

126 
	#SKF_AD_MAX
 40

	)

127 
	#SKF_NET_OFF
 (-0x100000)

	)

128 
	#SKF_LL_OFF
 (-0x200000)

	)

	@/usr/include/linux/flat.h

10 #iâdeà
_LINUX_FLAT_H


11 
	#_LINUX_FLAT_H


	)

14 
	#FLAT_VERSION
 0x00000004L

	)

16 #ifdeà
CONFIG_BINFMT_SHARED_FLAT


17 
	#MAX_SHARED_LIBS
 (4)

	)

19 
	#MAX_SHARED_LIBS
 (1)

	)

27 
	sæ©_hdr
 {

28 
	mmagic
[4];

29 
	m»v
;

30 
	m’Œy
;

32 
	md©a_¡¬t
;

34 
	md©a_’d
;

36 
	mbss_’d
;

41 
	m¡ack_size
;

42 
	m»loc_¡¬t
;

44 
	m»loc_couÁ
;

45 
	mæags
;

46 
	mbud_d©e
;

47 
	mfËr
[5];

50 
	#FLAT_FLAG_RAM
 0x0001

	)

51 
	#FLAT_FLAG_GOTPIC
 0x0002

	)

52 
	#FLAT_FLAG_GZIP
 0x0004

	)

53 
	#FLAT_FLAG_GZDATA
 0x0008

	)

54 
	#FLAT_FLAG_KTRACE
 0x0010

	)

	@/usr/include/linux/fs.h

1 #iâdeà
_LINUX_FS_H


2 
	#_LINUX_FS_H


	)

9 
	~<lšux/lim™s.h
>

10 
	~<lšux/ioùl.h
>

11 
	~<lšux/blk_ty³s.h
>

12 
	~<lšux/ty³s.h
>

25 #undeà
NR_OPEN


26 
	#INR_OPEN_CUR
 1024

	)

27 
	#INR_OPEN_MAX
 4096

	)

29 
	#BLOCK_SIZE_BITS
 10

	)

30 
	#BLOCK_SIZE
 (1<<
BLOCK_SIZE_BITS
)

	)

32 
	#SEEK_SET
 0

	)

33 
	#SEEK_CUR
 1

	)

34 
	#SEEK_END
 2

	)

35 
	#SEEK_DATA
 3

	)

36 
	#SEEK_HOLE
 4

	)

37 
	#SEEK_MAX
 
SEEK_HOLE


	)

39 
	sf¡rim_¿nge
 {

40 
__u64
 
	m¡¬t
;

41 
__u64
 
	mËn
;

42 
__u64
 
	mmšËn
;

46 
	sfes_¡©_¡ruù
 {

47 
	mÄ_fes
;

48 
	mÄ_ä“_fes
;

49 
	mmax_fes
;

52 
	sšodes_¡©_t
 {

53 
	mÄ_šodes
;

54 
	mÄ_unu£d
;

55 
	mdummy
[5];

59 
	#NR_FILE
 8192

	)

61 
	#MAY_EXEC
 0x00000001

	)

62 
	#MAY_WRITE
 0x00000002

	)

63 
	#MAY_READ
 0x00000004

	)

64 
	#MAY_APPEND
 0x00000008

	)

65 
	#MAY_ACCESS
 0x00000010

	)

66 
	#MAY_OPEN
 0x00000020

	)

67 
	#MAY_CHDIR
 0x00000040

	)

69 
	#MAY_NOT_BLOCK
 0x00000080

	)

77 
	#FMODE_READ
 ((
fmode_t
)0x1)

	)

79 
	#FMODE_WRITE
 ((
fmode_t
)0x2)

	)

81 
	#FMODE_LSEEK
 ((
fmode_t
)0x4)

	)

83 
	#FMODE_PREAD
 ((
fmode_t
)0x8)

	)

85 
	#FMODE_PWRITE
 ((
fmode_t
)0x10)

	)

87 
	#FMODE_EXEC
 ((
fmode_t
)0x20)

	)

89 
	#FMODE_NDELAY
 ((
fmode_t
)0x40)

	)

91 
	#FMODE_EXCL
 ((
fmode_t
)0x80)

	)

94 
	#FMODE_WRITE_IOCTL
 ((
fmode_t
)0x100)

	)

102 
	#FMODE_NOCMTIME
 ((
fmode_t
)0x800)

	)

105 
	#FMODE_RANDOM
 ((
fmode_t
)0x1000)

	)

108 
	#FMODE_UNSIGNED_OFFSET
 ((
fmode_t
)0x2000)

	)

111 
	#FMODE_PATH
 ((
fmode_t
)0x4000)

	)

114 
	#FMODE_NONOTIFY
 ((
fmode_t
)0x1000000)

	)

158 
	#RW_MASK
 
REQ_WRITE


	)

159 
	#RWA_MASK
 
REQ_RAHEAD


	)

161 
	#READ
 0

	)

162 
	#WRITE
 
RW_MASK


	)

163 
	#READA
 
RWA_MASK


	)

165 
	#READ_SYNC
 (
READ
 | 
REQ_SYNC
)

	)

166 
	#WRITE_SYNC
 (
WRITE
 | 
REQ_SYNC
 | 
REQ_NOIDLE
)

	)

167 
	#WRITE_ODIRECT
 (
WRITE
 | 
REQ_SYNC
)

	)

168 
	#WRITE_FLUSH
 (
WRITE
 | 
REQ_SYNC
 | 
REQ_NOIDLE
 | 
REQ_FLUSH
)

	)

169 
	#WRITE_FUA
 (
WRITE
 | 
REQ_SYNC
 | 
REQ_NOIDLE
 | 
REQ_FUA
)

	)

170 
	#WRITE_FLUSH_FUA
 (
WRITE
 | 
REQ_SYNC
 | 
REQ_NOIDLE
 | 
REQ_FLUSH
 | 
REQ_FUA
)

	)

172 
	#SEL_IN
 1

	)

173 
	#SEL_OUT
 2

	)

174 
	#SEL_EX
 4

	)

177 
	#FS_REQUIRES_DEV
 1

	)

178 
	#FS_BINARY_MOUNTDATA
 2

	)

179 
	#FS_HAS_SUBTYPE
 4

	)

180 
	#FS_REVAL_DOT
 16384

	)

181 
	#FS_RENAME_DOES_D_MOVE
 32768

	)

188 
	#MS_RDONLY
 1

	)

189 
	#MS_NOSUID
 2

	)

190 
	#MS_NODEV
 4

	)

191 
	#MS_NOEXEC
 8

	)

192 
	#MS_SYNCHRONOUS
 16

	)

193 
	#MS_REMOUNT
 32

	)

194 
	#MS_MANDLOCK
 64

	)

195 
	#MS_DIRSYNC
 128

	)

196 
	#MS_NOATIME
 1024

	)

197 
	#MS_NODIRATIME
 2048

	)

198 
	#MS_BIND
 4096

	)

199 
	#MS_MOVE
 8192

	)

200 
	#MS_REC
 16384

	)

201 
	#MS_VERBOSE
 32768

	)

203 
	#MS_SILENT
 32768

	)

204 
	#MS_POSIXACL
 (1<<16è

	)

205 
	#MS_UNBINDABLE
 (1<<17è

	)

206 
	#MS_PRIVATE
 (1<<18è

	)

207 
	#MS_SLAVE
 (1<<19è

	)

208 
	#MS_SHARED
 (1<<20è

	)

209 
	#MS_RELATIME
 (1<<21è

	)

210 
	#MS_KERNMOUNT
 (1<<22è

	)

211 
	#MS_I_VERSION
 (1<<23è

	)

212 
	#MS_STRICTATIME
 (1<<24è

	)

213 
	#MS_NOSEC
 (1<<28)

	)

214 
	#MS_BORN
 (1<<29)

	)

215 
	#MS_ACTIVE
 (1<<30)

	)

216 
	#MS_NOUSER
 (1<<31)

	)

221 
	#MS_RMT_MASK
 (
MS_RDONLY
|
MS_SYNCHRONOUS
|
MS_MANDLOCK
|
MS_I_VERSION
)

	)

226 
	#MS_MGC_VAL
 0xC0ED0000

	)

227 
	#MS_MGC_MSK
 0xffff0000

	)

231 
	#S_SYNC
 1

	)

232 
	#S_NOATIME
 2

	)

233 
	#S_APPEND
 4

	)

234 
	#S_IMMUTABLE
 8

	)

235 
	#S_DEAD
 16

	)

236 
	#S_NOQUOTA
 32

	)

237 
	#S_DIRSYNC
 64

	)

238 
	#S_NOCMTIME
 128

	)

239 
	#S_SWAPFILE
 256

	)

240 
	#S_PRIVATE
 512

	)

241 
	#S_IMA
 1024

	)

242 
	#S_AUTOMOUNT
 2048

	)

243 
	#S_NOSEC
 4096

	)

258 
	#__IS_FLG
(
šode
,
æg
è((šode)->
i_sb
->
s_æags
 & (æg))

	)

260 
	#IS_RDONLY
(
šode
è((šode)->
i_sb
->
s_æags
 & 
MS_RDONLY
)

	)

261 
	#IS_SYNC
(
šode
è(
	`__IS_FLG
(šode, 
MS_SYNCHRONOUS
) || \

262 ((
šode
)->
i_æags
 & 
S_SYNC
))

	)

263 
	#IS_DIRSYNC
(
šode
è(
	`__IS_FLG
(šode, 
MS_SYNCHRONOUS
|
MS_DIRSYNC
) || \

264 ((
šode
)->
i_æags
 & (
S_SYNC
|
S_DIRSYNC
)))

	)

265 
	#IS_MANDLOCK
(
šode
è
	`__IS_FLG
(šode, 
MS_MANDLOCK
)

	)

266 
	#IS_NOATIME
(
šode
è
	`__IS_FLG
(šode, 
MS_RDONLY
|
MS_NOATIME
)

	)

267 
	#IS_I_VERSION
(
šode
è
	`__IS_FLG
(šode, 
MS_I_VERSION
)

	)

269 
	#IS_NOQUOTA
(
šode
è((šode)->
i_æags
 & 
S_NOQUOTA
)

	)

270 
	#IS_APPEND
(
šode
è((šode)->
i_æags
 & 
S_APPEND
)

	)

271 
	#IS_IMMUTABLE
(
šode
è((šode)->
i_æags
 & 
S_IMMUTABLE
)

	)

272 
	#IS_POSIXACL
(
šode
è
	`__IS_FLG
(šode, 
MS_POSIXACL
)

	)

274 
	#IS_DEADDIR
(
šode
è((šode)->
i_æags
 & 
S_DEAD
)

	)

275 
	#IS_NOCMTIME
(
šode
è((šode)->
i_æags
 & 
S_NOCMTIME
)

	)

276 
	#IS_SWAPFILE
(
šode
è((šode)->
i_æags
 & 
S_SWAPFILE
)

	)

277 
	#IS_PRIVATE
(
šode
è((šode)->
i_æags
 & 
S_PRIVATE
)

	)

278 
	#IS_IMA
(
šode
è((šode)->
i_æags
 & 
S_IMA
)

	)

279 
	#IS_AUTOMOUNT
(
šode
è((šode)->
i_æags
 & 
S_AUTOMOUNT
)

	)

280 
	#IS_NOSEC
(
šode
è((šode)->
i_æags
 & 
S_NOSEC
)

	)

285 
	#BLKROSET
 
	`_IO
(0x12,93è

	)

286 
	#BLKROGET
 
	`_IO
(0x12,94è

	)

287 
	#BLKRRPART
 
	`_IO
(0x12,95è

	)

288 
	#BLKGETSIZE
 
	`_IO
(0x12,96è

	)

289 
	#BLKFLSBUF
 
	`_IO
(0x12,97è

	)

290 
	#BLKRASET
 
	`_IO
(0x12,98è

	)

291 
	#BLKRAGET
 
	`_IO
(0x12,99è

	)

292 
	#BLKFRASET
 
	`_IO
(0x12,100)

	)

293 
	#BLKFRAGET
 
	`_IO
(0x12,101)

	)

294 
	#BLKSECTSET
 
	`_IO
(0x12,102)

	)

295 
	#BLKSECTGET
 
	`_IO
(0x12,103)

	)

296 
	#BLKSSZGET
 
	`_IO
(0x12,104)

	)

298 
	#BLKPG
 
	`_IO
(0x12,105)

	)

302 
	#BLKELVGET
 
	`_IOR
(0x12,106,
size_t
)

	)

303 
	#BLKELVSET
 
	`_IOW
(0x12,107,
size_t
)

	)

308 
	#BLKBSZGET
 
	`_IOR
(0x12,112,
size_t
)

	)

309 
	#BLKBSZSET
 
	`_IOW
(0x12,113,
size_t
)

	)

310 
	#BLKGETSIZE64
 
	`_IOR
(0x12,114,
size_t
è

	)

311 
	#BLKTRACESETUP
 
	`_IOWR
(0x12,115,
blk_u£r_Œaû_£tup
)

	)

312 
	#BLKTRACESTART
 
	`_IO
(0x12,116)

	)

313 
	#BLKTRACESTOP
 
	`_IO
(0x12,117)

	)

314 
	#BLKTRACETEARDOWN
 
	`_IO
(0x12,118)

	)

315 
	#BLKDISCARD
 
	`_IO
(0x12,119)

	)

316 
	#BLKIOMIN
 
	`_IO
(0x12,120)

	)

317 
	#BLKIOOPT
 
	`_IO
(0x12,121)

	)

318 
	#BLKALIGNOFF
 
	`_IO
(0x12,122)

	)

319 
	#BLKPBSZGET
 
	`_IO
(0x12,123)

	)

320 
	#BLKDISCARDZEROES
 
	`_IO
(0x12,124)

	)

321 
	#BLKSECDISCARD
 
	`_IO
(0x12,125)

	)

323 
	#BMAP_IOCTL
 1

	)

324 
	#FIBMAP
 
	`_IO
(0x00,1è

	)

325 
	#FIGETBSZ
 
	`_IO
(0x00,2è

	)

326 
	#FIFREEZE
 
	`_IOWR
('X', 119, è

	)

327 
	#FITHAW
 
	`_IOWR
('X', 120, è

	)

328 
	#FITRIM
 
	`_IOWR
('X', 121, 
f¡rim_¿nge
è

	)

330 
	#FS_IOC_GETFLAGS
 
	`_IOR
('f', 1, )

	)

331 
	#FS_IOC_SETFLAGS
 
	`_IOW
('f', 2, )

	)

332 
	#FS_IOC_GETVERSION
 
	`_IOR
('v', 1, )

	)

333 
	#FS_IOC_SETVERSION
 
	`_IOW
('v', 2, )

	)

334 
	#FS_IOC_FIEMAP
 
	`_IOWR
('f', 11, 
f›m­
)

	)

335 
	#FS_IOC32_GETFLAGS
 
	`_IOR
('f', 1, )

	)

336 
	#FS_IOC32_SETFLAGS
 
	`_IOW
('f', 2, )

	)

337 
	#FS_IOC32_GETVERSION
 
	`_IOR
('v', 1, )

	)

338 
	#FS_IOC32_SETVERSION
 
	`_IOW
('v', 2, )

	)

343 
	#FS_SECRM_FL
 0x00000001

	)

344 
	#FS_UNRM_FL
 0x00000002

	)

345 
	#FS_COMPR_FL
 0x00000004

	)

346 
	#FS_SYNC_FL
 0x00000008

	)

347 
	#FS_IMMUTABLE_FL
 0x00000010

	)

348 
	#FS_APPEND_FL
 0x00000020

	)

349 
	#FS_NODUMP_FL
 0x00000040

	)

350 
	#FS_NOATIME_FL
 0x00000080

	)

352 
	#FS_DIRTY_FL
 0x00000100

	)

353 
	#FS_COMPRBLK_FL
 0x00000200

	)

354 
	#FS_NOCOMP_FL
 0x00000400

	)

355 
	#FS_ECOMPR_FL
 0x00000800

	)

357 
	#FS_BTREE_FL
 0x00001000

	)

358 
	#FS_INDEX_FL
 0x00001000

	)

359 
	#FS_IMAGIC_FL
 0x00002000

	)

360 
	#FS_JOURNAL_DATA_FL
 0x00004000

	)

361 
	#FS_NOTAIL_FL
 0x00008000

	)

362 
	#FS_DIRSYNC_FL
 0x00010000

	)

363 
	#FS_TOPDIR_FL
 0x00020000

	)

364 
	#FS_EXTENT_FL
 0x00080000

	)

365 
	#FS_DIRECTIO_FL
 0x00100000

	)

366 
	#FS_NOCOW_FL
 0x00800000

	)

367 
	#FS_RESERVED_FL
 0x80000000

	)

369 
	#FS_FL_USER_VISIBLE
 0x0003DFFF

	)

370 
	#FS_FL_USER_MODIFIABLE
 0x000380FF

	)

373 
	#SYNC_FILE_RANGE_WAIT_BEFORE
 1

	)

374 
	#SYNC_FILE_RANGE_WRITE
 2

	)

375 
	#SYNC_FILE_RANGE_WAIT_AFTER
 4

	)

	@/usr/include/linux/gigaset_dev.h

14 #iâdeà
GIGASET_INTERFACE_H


15 
	#GIGASET_INTERFACE_H


	)

17 
	~<lšux/ioùl.h
>

20 
	#GIGASET_IOCTL
 0x47

	)

23 
	#GIGASET_REDIR
 
	`_IOWR
(
GIGASET_IOCTL
, 0, )

	)

26 
	#GIGASET_CONFIG
 
	`_IOWR
(
GIGASET_IOCTL
, 1, )

	)

29 
	#GIGASET_BRKCHARS
 
	`_IOW
(
GIGASET_IOCTL
, 2, [6])

	)

32 
	#GIGASET_VERSION
 
	`_IOWR
(
GIGASET_IOCTL
, 3, [4])

	)

34 
	#GIGVER_DRIVER
 0

	)

35 
	#GIGVER_COMPAT
 1

	)

36 
	#GIGVER_FWBASE
 2

	)

	@/usr/include/linux/hiddev.h

1 #iâdeà
_HIDDEV_H


2 
	#_HIDDEV_H


	)

30 
	~<lšux/ty³s.h
>

36 
	shiddev_ev’t
 {

37 
	mhid
;

38 sigÃd 
	mv®ue
;

41 
	shiddev_devšfo
 {

42 
__u32
 
	mbu¡y³
;

43 
__u32
 
	mbu¢um
;

44 
__u32
 
	mdevnum
;

45 
__u32
 
	miâum
;

46 
__s16
 
	mv’dÜ
;

47 
__s16
 
	m´oduù
;

48 
__s16
 
	mv”siÚ
;

49 
__u32
 
	mnum_­¶iÿtiÚs
;

52 
	shiddev_cŞËùiÚ_šfo
 {

53 
__u32
 
	mšdex
;

54 
__u32
 
	mty³
;

55 
__u32
 
	mu§ge
;

56 
__u32
 
	mËv–
;

59 
	#HID_STRING_SIZE
 256

	)

60 
	shiddev_¡ršg_desütÜ
 {

61 
__s32
 
	mšdex
;

62 
	mv®ue
[
HID_STRING_SIZE
];

65 
	shiddev_»pÜt_šfo
 {

66 
__u32
 
	m»pÜt_ty³
;

67 
__u32
 
	m»pÜt_id
;

68 
__u32
 
	mnum_f›lds
;

78 
	#HID_REPORT_ID_UNKNOWN
 0xffffffff

	)

79 
	#HID_REPORT_ID_FIRST
 0x00000100

	)

80 
	#HID_REPORT_ID_NEXT
 0x00000200

	)

81 
	#HID_REPORT_ID_MASK
 0x000000ff

	)

82 
	#HID_REPORT_ID_MAX
 0x000000ff

	)

84 
	#HID_REPORT_TYPE_INPUT
 1

	)

85 
	#HID_REPORT_TYPE_OUTPUT
 2

	)

86 
	#HID_REPORT_TYPE_FEATURE
 3

	)

87 
	#HID_REPORT_TYPE_MIN
 1

	)

88 
	#HID_REPORT_TYPE_MAX
 3

	)

90 
	shiddev_f›ld_šfo
 {

91 
__u32
 
	m»pÜt_ty³
;

92 
__u32
 
	m»pÜt_id
;

93 
__u32
 
	mf›ld_šdex
;

94 
__u32
 
	mmaxu§ge
;

95 
__u32
 
	mæags
;

96 
__u32
 
	mphysiÿl
;

97 
__u32
 
	mlogiÿl
;

98 
__u32
 
	m­¶iÿtiÚ
;

99 
__s32
 
	mlogiÿl_mšimum
;

100 
__s32
 
	mlogiÿl_maximum
;

101 
__s32
 
	mphysiÿl_mšimum
;

102 
__s32
 
	mphysiÿl_maximum
;

103 
__u32
 
	mun™_expÚ’t
;

104 
__u32
 
	mun™
;

110 
	#HID_FIELD_CONSTANT
 0x001

	)

111 
	#HID_FIELD_VARIABLE
 0x002

	)

112 
	#HID_FIELD_RELATIVE
 0x004

	)

113 
	#HID_FIELD_WRAP
 0x008

	)

114 
	#HID_FIELD_NONLINEAR
 0x010

	)

115 
	#HID_FIELD_NO_PREFERRED
 0x020

	)

116 
	#HID_FIELD_NULL_STATE
 0x040

	)

117 
	#HID_FIELD_VOLATILE
 0x080

	)

118 
	#HID_FIELD_BUFFERED_BYTE
 0x100

	)

120 
	shiddev_u§ge_»f
 {

121 
__u32
 
	m»pÜt_ty³
;

122 
__u32
 
	m»pÜt_id
;

123 
__u32
 
	mf›ld_šdex
;

124 
__u32
 
	mu§ge_šdex
;

125 
__u32
 
	mu§ge_code
;

126 
__s32
 
	mv®ue
;

131 
	#HID_MAX_MULTI_USAGES
 1024

	)

132 
	shiddev_u§ge_»f_muÉi
 {

133 
hiddev_u§ge_»f
 
	mu»f
;

134 
__u32
 
	mnum_v®ues
;

135 
__s32
 
	mv®ues
[
HID_MAX_MULTI_USAGES
];

142 
	#HID_FIELD_INDEX_NONE
 0xffffffff

	)

148 
	#HID_VERSION
 0x010004

	)

154 
	#HIDIOCGVERSION
 
	`_IOR
('H', 0x01, )

	)

155 
	#HIDIOCAPPLICATION
 
	`_IO
('H', 0x02)

	)

156 
	#HIDIOCGDEVINFO
 
	`_IOR
('H', 0x03, 
hiddev_devšfo
)

	)

157 
	#HIDIOCGSTRING
 
	`_IOR
('H', 0x04, 
hiddev_¡ršg_desütÜ
)

	)

158 
	#HIDIOCINITREPORT
 
	`_IO
('H', 0x05)

	)

159 
	#HIDIOCGNAME
(
Ën
è
	`_IOC
(
_IOC_READ
, 'H', 0x06,†’)

	)

160 
	#HIDIOCGREPORT
 
	`_IOW
('H', 0x07, 
hiddev_»pÜt_šfo
)

	)

161 
	#HIDIOCSREPORT
 
	`_IOW
('H', 0x08, 
hiddev_»pÜt_šfo
)

	)

162 
	#HIDIOCGREPORTINFO
 
	`_IOWR
('H', 0x09, 
hiddev_»pÜt_šfo
)

	)

163 
	#HIDIOCGFIELDINFO
 
	`_IOWR
('H', 0x0A, 
hiddev_f›ld_šfo
)

	)

164 
	#HIDIOCGUSAGE
 
	`_IOWR
('H', 0x0B, 
hiddev_u§ge_»f
)

	)

165 
	#HIDIOCSUSAGE
 
	`_IOW
('H', 0x0C, 
hiddev_u§ge_»f
)

	)

166 
	#HIDIOCGUCODE
 
	`_IOWR
('H', 0x0D, 
hiddev_u§ge_»f
)

	)

167 
	#HIDIOCGFLAG
 
	`_IOR
('H', 0x0E, )

	)

168 
	#HIDIOCSFLAG
 
	`_IOW
('H', 0x0F, )

	)

169 
	#HIDIOCGCOLLECTIONINDEX
 
	`_IOW
('H', 0x10, 
hiddev_u§ge_»f
)

	)

170 
	#HIDIOCGCOLLECTIONINFO
 
	`_IOWR
('H', 0x11, 
hiddev_cŞËùiÚ_šfo
)

	)

171 
	#HIDIOCGPHYS
(
Ën
è
	`_IOC
(
_IOC_READ
, 'H', 0x12,†’)

	)

174 
	#HIDIOCGUSAGES
 
	`_IOWR
('H', 0x13, 
hiddev_u§ge_»f_muÉi
)

	)

175 
	#HIDIOCSUSAGES
 
	`_IOW
('H', 0x14, 
hiddev_u§ge_»f_muÉi
)

	)

180 
	#HIDDEV_FLAG_UREF
 0x1

	)

181 
	#HIDDEV_FLAG_REPORT
 0x2

	)

182 
	#HIDDEV_FLAGS
 0x3

	)

	@/usr/include/linux/i2c-dev.h

22 #iâdeà
_LINUX_I2C_DEV_H


23 
	#_LINUX_I2C_DEV_H


	)

25 
	~<lšux/ty³s.h
>

34 
	#I2C_RETRIES
 0x0701

	)

36 
	#I2C_TIMEOUT
 0x0702

	)

41 
	#I2C_SLAVE
 0x0703

	)

42 
	#I2C_SLAVE_FORCE
 0x0706

	)

44 
	#I2C_TENBIT
 0x0704

	)

46 
	#I2C_FUNCS
 0x0705

	)

48 
	#I2C_RDWR
 0x0707

	)

50 
	#I2C_PEC
 0x0708

	)

51 
	#I2C_SMBUS
 0x0720

	)

55 
	si2c_smbus_ioùl_d©a
 {

56 
__u8
 
	m»ad_wr™e
;

57 
__u8
 
	mcommªd
;

58 
__u32
 
	msize
;

59 
i2c_smbus_d©a
 *
	md©a
;

63 
	si2c_rdwr_ioùl_d©a
 {

64 
i2c_msg
 *
	mmsgs
;

65 
__u32
 
	mnmsgs
;

68 
	#I2C_RDRW_IOCTL_MAX_MSGS
 42

	)

	@/usr/include/linux/i2c.h

26 #iâdeà
_LINUX_I2C_H


27 
	#_LINUX_I2C_H


	)

29 
	~<lšux/ty³s.h
>

67 
	si2c_msg
 {

68 
__u16
 
	maddr
;

69 
__u16
 
	mæags
;

70 
	#I2C_M_TEN
 0x0010

	)

71 
	#I2C_M_RD
 0x0001

	)

72 
	#I2C_M_NOSTART
 0x4000

	)

73 
	#I2C_M_REV_DIR_ADDR
 0x2000

	)

74 
	#I2C_M_IGNORE_NAK
 0x1000

	)

75 
	#I2C_M_NO_RD_ACK
 0x0800

	)

76 
	#I2C_M_RECV_LEN
 0x0400

	)

77 
__u16
 
	mËn
;

78 
__u8
 *
	mbuf
;

83 
	#I2C_FUNC_I2C
 0x00000001

	)

84 
	#I2C_FUNC_10BIT_ADDR
 0x00000002

	)

85 
	#I2C_FUNC_PROTOCOL_MANGLING
 0x00000004

	)

86 
	#I2C_FUNC_SMBUS_PEC
 0x00000008

	)

87 
	#I2C_FUNC_SMBUS_BLOCK_PROC_CALL
 0x00008000

	)

88 
	#I2C_FUNC_SMBUS_QUICK
 0x00010000

	)

89 
	#I2C_FUNC_SMBUS_READ_BYTE
 0x00020000

	)

90 
	#I2C_FUNC_SMBUS_WRITE_BYTE
 0x00040000

	)

91 
	#I2C_FUNC_SMBUS_READ_BYTE_DATA
 0x00080000

	)

92 
	#I2C_FUNC_SMBUS_WRITE_BYTE_DATA
 0x00100000

	)

93 
	#I2C_FUNC_SMBUS_READ_WORD_DATA
 0x00200000

	)

94 
	#I2C_FUNC_SMBUS_WRITE_WORD_DATA
 0x00400000

	)

95 
	#I2C_FUNC_SMBUS_PROC_CALL
 0x00800000

	)

96 
	#I2C_FUNC_SMBUS_READ_BLOCK_DATA
 0x01000000

	)

97 
	#I2C_FUNC_SMBUS_WRITE_BLOCK_DATA
 0x02000000

	)

98 
	#I2C_FUNC_SMBUS_READ_I2C_BLOCK
 0x04000000

	)

99 
	#I2C_FUNC_SMBUS_WRITE_I2C_BLOCK
 0x08000000

	)

101 
	#I2C_FUNC_SMBUS_BYTE
 (
I2C_FUNC_SMBUS_READ_BYTE
 | \

102 
I2C_FUNC_SMBUS_WRITE_BYTE
)

	)

103 
	#I2C_FUNC_SMBUS_BYTE_DATA
 (
I2C_FUNC_SMBUS_READ_BYTE_DATA
 | \

104 
I2C_FUNC_SMBUS_WRITE_BYTE_DATA
)

	)

105 
	#I2C_FUNC_SMBUS_WORD_DATA
 (
I2C_FUNC_SMBUS_READ_WORD_DATA
 | \

106 
I2C_FUNC_SMBUS_WRITE_WORD_DATA
)

	)

107 
	#I2C_FUNC_SMBUS_BLOCK_DATA
 (
I2C_FUNC_SMBUS_READ_BLOCK_DATA
 | \

108 
I2C_FUNC_SMBUS_WRITE_BLOCK_DATA
)

	)

109 
	#I2C_FUNC_SMBUS_I2C_BLOCK
 (
I2C_FUNC_SMBUS_READ_I2C_BLOCK
 | \

110 
I2C_FUNC_SMBUS_WRITE_I2C_BLOCK
)

	)

112 
	#I2C_FUNC_SMBUS_EMUL
 (
I2C_FUNC_SMBUS_QUICK
 | \

113 
I2C_FUNC_SMBUS_BYTE
 | \

114 
I2C_FUNC_SMBUS_BYTE_DATA
 | \

115 
I2C_FUNC_SMBUS_WORD_DATA
 | \

116 
I2C_FUNC_SMBUS_PROC_CALL
 | \

117 
I2C_FUNC_SMBUS_WRITE_BLOCK_DATA
 | \

118 
I2C_FUNC_SMBUS_I2C_BLOCK
 | \

119 
I2C_FUNC_SMBUS_PEC
)

	)

124 
	#I2C_SMBUS_BLOCK_MAX
 32

	)

125 
	ui2c_smbus_d©a
 {

126 
__u8
 
	mby‹
;

127 
__u16
 
	mwÜd
;

128 
__u8
 
	mblock
[
I2C_SMBUS_BLOCK_MAX
 + 2];

133 
	#I2C_SMBUS_READ
 1

	)

134 
	#I2C_SMBUS_WRITE
 0

	)

138 
	#I2C_SMBUS_QUICK
 0

	)

139 
	#I2C_SMBUS_BYTE
 1

	)

140 
	#I2C_SMBUS_BYTE_DATA
 2

	)

141 
	#I2C_SMBUS_WORD_DATA
 3

	)

142 
	#I2C_SMBUS_PROC_CALL
 4

	)

143 
	#I2C_SMBUS_BLOCK_DATA
 5

	)

144 
	#I2C_SMBUS_I2C_BLOCK_BROKEN
 6

	)

145 
	#I2C_SMBUS_BLOCK_PROC_CALL
 7

	)

146 
	#I2C_SMBUS_I2C_BLOCK_DATA
 8

	)

	@/usr/include/linux/if.h

19 #iâdeà
_LINUX_IF_H


20 
	#_LINUX_IF_H


	)

22 
	~<lšux/ty³s.h
>

23 
	~<lšux/sock‘.h
>

26 
	#IFNAMSIZ
 16

	)

27 
	#IFALIASZ
 256

	)

28 
	~<lšux/hdlc/ioùl.h
>

31 
	#IFF_UP
 0x1

	)

32 
	#IFF_BROADCAST
 0x2

	)

33 
	#IFF_DEBUG
 0x4

	)

34 
	#IFF_LOOPBACK
 0x8

	)

35 
	#IFF_POINTOPOINT
 0x10

	)

36 
	#IFF_NOTRAILERS
 0x20

	)

37 
	#IFF_RUNNING
 0x40

	)

38 
	#IFF_NOARP
 0x80

	)

39 
	#IFF_PROMISC
 0x100

	)

40 
	#IFF_ALLMULTI
 0x200

	)

42 
	#IFF_MASTER
 0x400

	)

43 
	#IFF_SLAVE
 0x800

	)

45 
	#IFF_MULTICAST
 0x1000

	)

47 
	#IFF_PORTSEL
 0x2000

	)

48 
	#IFF_AUTOMEDIA
 0x4000

	)

49 
	#IFF_DYNAMIC
 0x8000

	)

51 
	#IFF_LOWER_UP
 0x10000

	)

52 
	#IFF_DORMANT
 0x20000

	)

54 
	#IFF_ECHO
 0x40000

	)

56 
	#IFF_VOLATILE
 (
IFF_LOOPBACK
|
IFF_POINTOPOINT
|
IFF_BROADCAST
|
IFF_ECHO
|\

57 
IFF_MASTER
|
IFF_SLAVE
|
IFF_RUNNING
|
IFF_LOWER_UP
|
IFF_DORMANT
)

	)

60 
	#IFF_802_1Q_VLAN
 0x1

	)

61 
	#IFF_EBRIDGE
 0x2

	)

62 
	#IFF_SLAVE_INACTIVE
 0x4

	)

63 
	#IFF_MASTER_8023AD
 0x8

	)

64 
	#IFF_MASTER_ALB
 0x10

	)

65 
	#IFF_BONDING
 0x20

	)

66 
	#IFF_SLAVE_NEEDARP
 0x40

	)

67 
	#IFF_ISATAP
 0x80

	)

68 
	#IFF_MASTER_ARPMON
 0x100

	)

69 
	#IFF_WAN_HDLC
 0x200

	)

70 
	#IFF_XMIT_DST_RELEASE
 0x400

	)

73 
	#IFF_DONT_BRIDGE
 0x800

	)

74 
	#IFF_DISABLE_NETPOLL
 0x1000

	)

75 
	#IFF_MACVLAN_PORT
 0x2000

	)

76 
	#IFF_BRIDGE_PORT
 0x4000

	)

77 
	#IFF_OVS_DATAPATH
 0x8000

	)

79 
	#IFF_TX_SKB_SHARING
 0x10000

	)

81 
	#IFF_UNICAST_FLT
 0x20000

	)

83 
	#IF_GET_IFACE
 0x0001

	)

84 
	#IF_GET_PROTO
 0x0002

	)

87 
	#IF_IFACE_V35
 0x1000

	)

88 
	#IF_IFACE_V24
 0x1001

	)

89 
	#IF_IFACE_X21
 0x1002

	)

90 
	#IF_IFACE_T1
 0x1003

	)

91 
	#IF_IFACE_E1
 0x1004

	)

92 
	#IF_IFACE_SYNC_SERIAL
 0x1005

	)

93 
	#IF_IFACE_X21D
 0x1006

	)

96 
	#IF_PROTO_HDLC
 0x2000

	)

97 
	#IF_PROTO_PPP
 0x2001

	)

98 
	#IF_PROTO_CISCO
 0x2002

	)

99 
	#IF_PROTO_FR
 0x2003

	)

100 
	#IF_PROTO_FR_ADD_PVC
 0x2004

	)

101 
	#IF_PROTO_FR_DEL_PVC
 0x2005

	)

102 
	#IF_PROTO_X25
 0x2006

	)

103 
	#IF_PROTO_HDLC_ETH
 0x2007

	)

104 
	#IF_PROTO_FR_ADD_ETH_PVC
 0x2008

	)

105 
	#IF_PROTO_FR_DEL_ETH_PVC
 0x2009

	)

106 
	#IF_PROTO_FR_PVC
 0x200A

	)

107 
	#IF_PROTO_FR_ETH_PVC
 0x200B

	)

108 
	#IF_PROTO_RAW
 0x200C

	)

112 
	mIF_OPER_UNKNOWN
,

113 
	mIF_OPER_NOTPRESENT
,

114 
	mIF_OPER_DOWN
,

115 
	mIF_OPER_LOWERLAYERDOWN
,

116 
	mIF_OPER_TESTING
,

117 
	mIF_OPER_DORMANT
,

118 
	mIF_OPER_UP
,

123 
	mIF_LINK_MODE_DEFAULT
,

124 
	mIF_LINK_MODE_DORMANT
,

137 
	sifm­
 {

138 
	mmem_¡¬t
;

139 
	mmem_’d
;

140 
	mba£_addr
;

141 
	mœq
;

142 
	mdma
;

143 
	mpÜt
;

147 
	sif_£‰šgs
 {

148 
	mty³
;

149 
	msize
;

152 
¿w_hdlc_´Ùo
 *
	m¿w_hdlc
;

153 
cisco_´Ùo
 *
	mcisco
;

154 
ä_´Ùo
 *
	mä
;

155 
ä_´Ùo_pvc
 *
	mä_pvc
;

156 
ä_´Ùo_pvc_šfo
 *
	mä_pvc_šfo
;

159 
sync_£rŸl_£‰šgs
 *
	msync
;

160 
‹1_£‰šgs
 *
	m‹1
;

161 } 
	mifs_ifsu
;

171 
	siäeq
 {

172 
	#IFHWADDRLEN
 6

	)

175 
	miän_Çme
[
IFNAMSIZ
];

176 } 
	miä_iän
;

179 
sockaddr
 
	miäu_addr
;

180 
sockaddr
 
	miäu_d¡addr
;

181 
sockaddr
 
	miäu_brßdaddr
;

182 
sockaddr
 
	miäu_Ãtmask
;

183 
sockaddr
 
	miäu_hwaddr
;

184 
	miäu_æags
;

185 
	miäu_iv®ue
;

186 
	miäu_mtu
;

187 
ifm­
 
	miäu_m­
;

188 
	miäu_¦ave
[
IFNAMSIZ
];

189 
	miäu_ÃwÇme
[
IFNAMSIZ
];

190 * 
	miäu_d©a
;

191 
if_£‰šgs
 
	miäu_£‰šgs
;

192 } 
	miä_iäu
;

195 
	#iä_Çme
 
iä_iän
.
iän_Çme


	)

196 
	#iä_hwaddr
 
iä_iäu
.
iäu_hwaddr


	)

197 
	#iä_addr
 
iä_iäu
.
iäu_addr


	)

198 
	#iä_d¡addr
 
iä_iäu
.
iäu_d¡addr


	)

199 
	#iä_brßdaddr
 
iä_iäu
.
iäu_brßdaddr


	)

200 
	#iä_Ãtmask
 
iä_iäu
.
iäu_Ãtmask


	)

201 
	#iä_æags
 
iä_iäu
.
iäu_æags


	)

202 
	#iä_m‘ric
 
iä_iäu
.
iäu_iv®ue


	)

203 
	#iä_mtu
 
iä_iäu
.
iäu_mtu


	)

204 
	#iä_m­
 
iä_iäu
.
iäu_m­


	)

205 
	#iä_¦ave
 
iä_iäu
.
iäu_¦ave


	)

206 
	#iä_d©a
 
iä_iäu
.
iäu_d©a


	)

207 
	#iä_ifšdex
 
iä_iäu
.
iäu_iv®ue


	)

208 
	#iä_bªdwidth
 
iä_iäu
.
iäu_iv®ue


	)

209 
	#iä_qËn
 
iä_iäu
.
iäu_iv®ue


	)

210 
	#iä_ÃwÇme
 
iä_iäu
.
iäu_ÃwÇme


	)

211 
	#iä_£‰šgs
 
iä_iäu
.
iäu_£‰šgs


	)

220 
	sifcÚf
 {

221 
	mifc_Ën
;

223 *
	mifcu_buf
;

224 
iäeq
 *
	mifcu_»q
;

225 } 
	mifc_ifcu
;

227 
	#ifc_buf
 
ifc_ifcu
.
ifcu_buf


	)

228 
	#ifc_»q
 
ifc_ifcu
.
ifcu_»q


	)

	@/usr/include/linux/if_bonding.h

43 #iâdeà
_LINUX_IF_BONDING_H


44 
	#_LINUX_IF_BONDING_H


	)

46 
	~<lšux/if.h
>

47 
	~<lšux/ty³s.h
>

48 
	~<lšux/if_‘h”.h
>

51 
	#BOND_ABI_VERSION
 2

	)

57 
	#BOND_ENSLAVE_OLD
 (
SIOCDEVPRIVATE
)

	)

58 
	#BOND_RELEASE_OLD
 (
SIOCDEVPRIVATE
 + 1)

	)

59 
	#BOND_SETHWADDR_OLD
 (
SIOCDEVPRIVATE
 + 2)

	)

60 
	#BOND_SLAVE_INFO_QUERY_OLD
 (
SIOCDEVPRIVATE
 + 11)

	)

61 
	#BOND_INFO_QUERY_OLD
 (
SIOCDEVPRIVATE
 + 12)

	)

62 
	#BOND_CHANGE_ACTIVE_OLD
 (
SIOCDEVPRIVATE
 + 13)

	)

64 
	#BOND_CHECK_MII_STATUS
 (
SIOCGMIIPHY
)

	)

66 
	#BOND_MODE_ROUNDROBIN
 0

	)

67 
	#BOND_MODE_ACTIVEBACKUP
 1

	)

68 
	#BOND_MODE_XOR
 2

	)

69 
	#BOND_MODE_BROADCAST
 3

	)

70 
	#BOND_MODE_8023AD
 4

	)

71 
	#BOND_MODE_TLB
 5

	)

72 
	#BOND_MODE_ALB
 6

	)

75 
	#BOND_LINK_UP
 0

	)

76 
	#BOND_LINK_FAIL
 1

	)

77 
	#BOND_LINK_DOWN
 2

	)

78 
	#BOND_LINK_BACK
 3

	)

81 
	#BOND_STATE_ACTIVE
 0

	)

82 
	#BOND_STATE_BACKUP
 1

	)

84 
	#BOND_DEFAULT_MAX_BONDS
 1

	)

86 
	#BOND_DEFAULT_TX_QUEUES
 16

	)

88 
	#BOND_DEFAULT_RESEND_IGMP
 1

	)

91 
	#BOND_XMIT_POLICY_LAYER2
 0

	)

92 
	#BOND_XMIT_POLICY_LAYER34
 1

	)

93 
	#BOND_XMIT_POLICY_LAYER23
 2

	)

95 
	sifbÚd
 {

96 
__s32
 
	mbÚd_mode
;

97 
__s32
 
	mnum_¦aves
;

98 
__s32
 
	mmiimÚ
;

99 } 
	tifbÚd
;

101 
	sif¦ave
 {

102 
__s32
 
	m¦ave_id
;

103 
	m¦ave_Çme
[
IFNAMSIZ
];

104 
__s8
 
	mlšk
;

105 
__s8
 
	m¡©e
;

106 
__u32
 
	mlšk_çu»_couÁ
;

107 } 
	tif¦ave
;

109 
	sad_šfo
 {

110 
__u16
 
	magg»g©Ü_id
;

111 
__u16
 
	mpÜts
;

112 
__u16
 
	maùÜ_key
;

113 
__u16
 
	m·¹Ãr_key
;

114 
__u8
 
	m·¹Ãr_sy¡em
[
ETH_ALEN
];

	@/usr/include/linux/if_bridge.h

13 #iâdeà
_LINUX_IF_BRIDGE_H


14 
	#_LINUX_IF_BRIDGE_H


	)

16 
	~<lšux/ty³s.h
>

18 
	#SYSFS_BRIDGE_ATTR
 "bridge"

	)

19 
	#SYSFS_BRIDGE_FDB
 "brfÜw¬d"

	)

20 
	#SYSFS_BRIDGE_PORT_SUBDIR
 "brif"

	)

21 
	#SYSFS_BRIDGE_PORT_ATTR
 "b½Üt"

	)

22 
	#SYSFS_BRIDGE_PORT_LINK
 "bridge"

	)

24 
	#BRCTL_VERSION
 1

	)

26 
	#BRCTL_GET_VERSION
 0

	)

27 
	#BRCTL_GET_BRIDGES
 1

	)

28 
	#BRCTL_ADD_BRIDGE
 2

	)

29 
	#BRCTL_DEL_BRIDGE
 3

	)

30 
	#BRCTL_ADD_IF
 4

	)

31 
	#BRCTL_DEL_IF
 5

	)

32 
	#BRCTL_GET_BRIDGE_INFO
 6

	)

33 
	#BRCTL_GET_PORT_LIST
 7

	)

34 
	#BRCTL_SET_BRIDGE_FORWARD_DELAY
 8

	)

35 
	#BRCTL_SET_BRIDGE_HELLO_TIME
 9

	)

36 
	#BRCTL_SET_BRIDGE_MAX_AGE
 10

	)

37 
	#BRCTL_SET_AGEING_TIME
 11

	)

38 
	#BRCTL_SET_GC_INTERVAL
 12

	)

39 
	#BRCTL_GET_PORT_INFO
 13

	)

40 
	#BRCTL_SET_BRIDGE_STP_STATE
 14

	)

41 
	#BRCTL_SET_BRIDGE_PRIORITY
 15

	)

42 
	#BRCTL_SET_PORT_PRIORITY
 16

	)

43 
	#BRCTL_SET_PATH_COST
 17

	)

44 
	#BRCTL_GET_FDB_ENTRIES
 18

	)

46 
	#BR_STATE_DISABLED
 0

	)

47 
	#BR_STATE_LISTENING
 1

	)

48 
	#BR_STATE_LEARNING
 2

	)

49 
	#BR_STATE_FORWARDING
 3

	)

50 
	#BR_STATE_BLOCKING
 4

	)

52 
	s__bridge_šfo
 {

53 
__u64
 
	mdesigÇ‹d_roÙ
;

54 
__u64
 
	mbridge_id
;

55 
__u32
 
	mroÙ_·th_co¡
;

56 
__u32
 
	mmax_age
;

57 
__u32
 
	mh–lo_time
;

58 
__u32
 
	mfÜw¬d_d–ay
;

59 
__u32
 
	mbridge_max_age
;

60 
__u32
 
	mbridge_h–lo_time
;

61 
__u32
 
	mbridge_fÜw¬d_d–ay
;

62 
__u8
 
	mtİŞogy_chªge
;

63 
__u8
 
	mtİŞogy_chªge_d‘eùed
;

64 
__u8
 
	mroÙ_pÜt
;

65 
__u8
 
	m¡p_’abËd
;

66 
__u32
 
	magešg_time
;

67 
__u32
 
	mgc_š‹rv®
;

68 
__u32
 
	mh–lo_tim”_v®ue
;

69 
__u32
 
	mtú_tim”_v®ue
;

70 
__u32
 
	mtİŞogy_chªge_tim”_v®ue
;

71 
__u32
 
	mgc_tim”_v®ue
;

74 
	s__pÜt_šfo
 {

75 
__u64
 
	mdesigÇ‹d_roÙ
;

76 
__u64
 
	mdesigÇ‹d_bridge
;

77 
__u16
 
	mpÜt_id
;

78 
__u16
 
	mdesigÇ‹d_pÜt
;

79 
__u32
 
	m·th_co¡
;

80 
__u32
 
	mdesigÇ‹d_co¡
;

81 
__u8
 
	m¡©e
;

82 
__u8
 
	mtİ_chªge_ack
;

83 
__u8
 
	mcÚfig_³ndšg
;

84 
__u8
 
	munu£d0
;

85 
__u32
 
	mmes§ge_age_tim”_v®ue
;

86 
__u32
 
	mfÜw¬d_d–ay_tim”_v®ue
;

87 
__u32
 
	mhŞd_tim”_v®ue
;

90 
	s__fdb_’Œy
 {

91 
__u8
 
	mmac_addr
[6];

92 
__u8
 
	mpÜt_no
;

93 
__u8
 
	mis_loÿl
;

94 
__u32
 
	magešg_tim”_v®ue
;

95 
__u8
 
	mpÜt_hi
;

96 
__u8
 
	m·d0
;

97 
__u16
 
	munu£d
;

	@/usr/include/linux/if_ppp.h

33 #iâdeà
_IF_PPP_H_


34 
	#_IF_PPP_H_


	)

36 
	~<lšux/ty³s.h
>

43 
	#PPP_MTU
 1500

	)

44 
	#PPP_MAXMRU
 65000

	)

45 
	#PROTO_IPX
 0x002b

	)

46 
	#PROTO_DNA_RT
 0x0027

	)

53 
	#SC_COMP_PROT
 0x00000001

	)

54 
	#SC_COMP_AC
 0x00000002

	)

55 
	#SC_COMP_TCP
 0x00000004

	)

56 
	#SC_NO_TCP_CCID
 0x00000008

	)

57 
	#SC_REJ_COMP_AC
 0x00000010

	)

58 
	#SC_REJ_COMP_TCP
 0x00000020

	)

59 
	#SC_CCP_OPEN
 0x00000040

	)

60 
	#SC_CCP_UP
 0x00000080

	)

61 
	#SC_ENABLE_IP
 0x00000100

	)

62 
	#SC_LOOP_TRAFFIC
 0x00000200

	)

63 
	#SC_MULTILINK
 0x00000400

	)

64 
	#SC_MP_SHORTSEQ
 0x00000800

	)

65 
	#SC_COMP_RUN
 0x00001000

	)

66 
	#SC_DECOMP_RUN
 0x00002000

	)

67 
	#SC_MP_XSHORTSEQ
 0x00004000

	)

68 
	#SC_DEBUG
 0x00010000

	)

69 
	#SC_LOG_INPKT
 0x00020000

	)

70 
	#SC_LOG_OUTPKT
 0x00040000

	)

71 
	#SC_LOG_RAWIN
 0x00080000

	)

72 
	#SC_LOG_FLUSH
 0x00100000

	)

73 
	#SC_SYNC
 0x00200000

	)

74 
	#SC_MUST_COMP
 0x00400000

	)

75 
	#SC_MASK
 0x0f600ffà

	)

78 
	#SC_XMIT_BUSY
 0x10000000

	)

79 
	#SC_RCV_ODDP
 0x08000000

	)

80 
	#SC_RCV_EVNP
 0x04000000

	)

81 
	#SC_RCV_B7_1
 0x02000000

	)

82 
	#SC_RCV_B7_0
 0x01000000

	)

83 
	#SC_DC_FERROR
 0x00800000

	)

84 
	#SC_DC_ERROR
 0x00400000

	)

90 
	sÅioùl
 {

91 
	m´ÙocŞ
;

92 
NPmode
 
	mmode
;

96 
	sµp_İtiÚ_d©a
 {

97 
__u8
 *
	m±r
;

98 
__u32
 
	mËngth
;

99 
	mŒªsm™
;

102 
	siåµ¡©¤eq
 {

103 
iäeq
 
	mb
;

104 
µp_¡©s
 
	m¡©s
;

107 
	siåµc¡©¤eq
 {

108 
iäeq
 
	mb
;

109 
µp_comp_¡©s
 
	m¡©s
;

113 
	sµpŞ2_ioc_¡©s
 {

114 
__u16
 
	mtuÂ–_id
;

115 
__u16
 
	m£ssiÚ_id
;

116 
__u32
 
	musšg_£c
:1;

117 
__®igÃd_u64
 
	mtx_·ck‘s
;

118 
__®igÃd_u64
 
	mtx_by‹s
;

119 
__®igÃd_u64
 
	mtx_”rÜs
;

120 
__®igÃd_u64
 
	mrx_·ck‘s
;

121 
__®igÃd_u64
 
	mrx_by‹s
;

122 
__®igÃd_u64
 
	mrx_£q_disÿrds
;

123 
__®igÃd_u64
 
	mrx_oos_·ck‘s
;

124 
__®igÃd_u64
 
	mrx_”rÜs
;

127 
	#iä__Çme
 
b
.
iä_iän
.
iän_Çme


	)

128 
	#¡©s_±r
 
b
.
iä_iäu
.
iäu_d©a


	)

134 
	#PPPIOCGFLAGS
 
	`_IOR
('t', 90, è

	)

135 
	#PPPIOCSFLAGS
 
	`_IOW
('t', 89, è

	)

136 
	#PPPIOCGASYNCMAP
 
	`_IOR
('t', 88, è

	)

137 
	#PPPIOCSASYNCMAP
 
	`_IOW
('t', 87, è

	)

138 
	#PPPIOCGUNIT
 
	`_IOR
('t', 86, è

	)

139 
	#PPPIOCGRASYNCMAP
 
	`_IOR
('t', 85, è

	)

140 
	#PPPIOCSRASYNCMAP
 
	`_IOW
('t', 84, è

	)

141 
	#PPPIOCGMRU
 
	`_IOR
('t', 83, è

	)

142 
	#PPPIOCSMRU
 
	`_IOW
('t', 82, è

	)

143 
	#PPPIOCSMAXCID
 
	`_IOW
('t', 81, è

	)

144 
	#PPPIOCGXASYNCMAP
 
	`_IOR
('t', 80, 
ext_accm
è

	)

145 
	#PPPIOCSXASYNCMAP
 
	`_IOW
('t', 79, 
ext_accm
è

	)

146 
	#PPPIOCXFERUNIT
 
	`_IO
('t', 78è

	)

147 
	#PPPIOCSCOMPRESS
 
	`_IOW
('t', 77, 
µp_İtiÚ_d©a
)

	)

148 
	#PPPIOCGNPMODE
 
	`_IOWR
('t', 76, 
Åioùl
è

	)

149 
	#PPPIOCSNPMODE
 
	`_IOW
('t', 75, 
Åioùl
è

	)

150 
	#PPPIOCSPASS
 
	`_IOW
('t', 71, 
sock_årog
è

	)

151 
	#PPPIOCSACTIVE
 
	`_IOW
('t', 70, 
sock_årog
è

	)

152 
	#PPPIOCGDEBUG
 
	`_IOR
('t', 65, è

	)

153 
	#PPPIOCSDEBUG
 
	`_IOW
('t', 64, è

	)

154 
	#PPPIOCGIDLE
 
	`_IOR
('t', 63, 
µp_idË
è

	)

155 
	#PPPIOCNEWUNIT
 
	`_IOWR
('t', 62, è

	)

156 
	#PPPIOCATTACH
 
	`_IOW
('t', 61, è

	)

157 
	#PPPIOCDETACH
 
	`_IOW
('t', 60, è

	)

158 
	#PPPIOCSMRRU
 
	`_IOW
('t', 59, è

	)

159 
	#PPPIOCCONNECT
 
	`_IOW
('t', 58, è

	)

160 
	#PPPIOCDISCONN
 
	`_IO
('t', 57è

	)

161 
	#PPPIOCATTCHAN
 
	`_IOW
('t', 56, è

	)

162 
	#PPPIOCGCHAN
 
	`_IOR
('t', 55, è

	)

163 
	#PPPIOCGL2TPSTATS
 
	`_IOR
('t', 54, 
µpŞ2_ioc_¡©s
)

	)

165 
	#SIOCGPPPSTATS
 (
SIOCDEVPRIVATE
 + 0)

	)

166 
	#SIOCGPPPVER
 (
SIOCDEVPRIVATE
 + 1è

	)

167 
	#SIOCGPPPCSTATS
 (
SIOCDEVPRIVATE
 + 2)

	)

169 #ià!
defšed
(
iä_mtu
)

170 
	#iä_mtu
 
iä_iäu
.
iäu_m‘ric


	)

	@/usr/include/linux/if_pppox.h

16 #iâdeà
__LINUX_IF_PPPOX_H


17 
	#__LINUX_IF_PPPOX_H


	)

20 
	~<lšux/ty³s.h
>

21 
	~<asm/by‹Üd”.h
>

23 
	~<lšux/sock‘.h
>

24 
	~<lšux/if_‘h”.h
>

25 
	~<lšux/if_µpŞ2.h
>

30 #iâdeà
AF_PPPOX


31 
	#AF_PPPOX
 24

	)

32 
	#PF_PPPOX
 
AF_PPPOX


	)

38 
__be16
 
	tsid_t
;

39 
	sµpÛ_addr
 {

40 
sid_t
 
	msid
;

41 
	m»mÙe
[
ETH_ALEN
];

42 
	mdev
[
IFNAMSIZ
];

48 
	sµ_addr
 {

49 
__be16
 
	mÿÎ_id
;

50 
š_addr
 
	msš_addr
;

56 
	#PX_PROTO_OE
 0

	)

57 
	#PX_PROTO_OL2TP
 1

	)

58 
	#PX_PROTO_PPTP
 2

	)

59 
	#PX_MAX_PROTO
 3

	)

61 
	ssockaddr_µpox
 {

62 
__k”Ãl_§_çmy_t
 
	m§_çmy
;

63 
	m§_´ÙocŞ
;

65 
µpÛ_addr
 
	mµpÛ
;

66 
µ_addr
 
	mµ
;

67 } 
	m§_addr
;

68 } 
__©Œibu‹__
((
·cked
));

75 
	ssockaddr_µpŞ2
 {

76 
__k”Ãl_§_çmy_t
 
	m§_çmy
;

77 
	m§_´ÙocŞ
;

78 
µpŞ2_addr
 
	mµpŞ2
;

79 } 
__©Œibu‹__
((
·cked
));

84 
	ssockaddr_µpŞ2v3
 {

85 
__k”Ãl_§_çmy_t
 
	m§_çmy
;

86 
	m§_´ÙocŞ
;

87 
µpŞ2v3_addr
 
	mµpŞ2
;

88 } 
__©Œibu‹__
((
·cked
));

96 
	#PPPOEIOCSFWD
 
	`_IOW
(0xB1 ,0, 
size_t
)

	)

97 
	#PPPOEIOCDFWD
 
	`_IO
(0xB1 ,1)

	)

101 
	#PADI_CODE
 0x09

	)

102 
	#PADO_CODE
 0x07

	)

103 
	#PADR_CODE
 0x19

	)

104 
	#PADS_CODE
 0x65

	)

105 
	#PADT_CODE
 0xa7

	)

106 
	sµpÛ_g
 {

107 
__be16
 
	mg_ty³
;

108 
__be16
 
	mg_Ën
;

109 
	mg_d©a
[0];

110 } 
__©Œibu‹__
 ((
·cked
));

113 
	#PTT_EOL
 
	`__ıu_to_be16
(0x0000)

	)

114 
	#PTT_SRV_NAME
 
	`__ıu_to_be16
(0x0101)

	)

115 
	#PTT_AC_NAME
 
	`__ıu_to_be16
(0x0102)

	)

116 
	#PTT_HOST_UNIQ
 
	`__ıu_to_be16
(0x0103)

	)

117 
	#PTT_AC_COOKIE
 
	`__ıu_to_be16
(0x0104)

	)

118 
	#PTT_VENDOR
 
	`__ıu_to_be16
(0x0105)

	)

119 
	#PTT_RELAY_SID
 
	`__ıu_to_be16
(0x0110)

	)

120 
	#PTT_SRV_ERR
 
	`__ıu_to_be16
(0x0201)

	)

121 
	#PTT_SYS_ERR
 
	`__ıu_to_be16
(0x0202)

	)

122 
	#PTT_GEN_ERR
 
	`__ıu_to_be16
(0x0203)

	)

124 
	sµpÛ_hdr
 {

125 #ià
defšed
(
__LITTLE_ENDIAN_BITFIELD
)

126 
__u8
 
	mty³
 : 4;

127 
__u8
 
	mv”
 : 4;

128 #–ià
defšed
(
__BIG_ENDIAN_BITFIELD
)

129 
__u8
 
	mv”
 : 4;

130 
__u8
 
	mty³
 : 4;

134 
__u8
 
	mcode
;

135 
__be16
 
	msid
;

136 
__be16
 
	mËngth
;

137 
µpÛ_g
 
	mg
[0];

138 } 
__©Œibu‹__
((
·cked
));

141 
	#PPPOE_SES_HLEN
 8

	)

	@/usr/include/linux/if_tun.h

16 #iâdeà
__IF_TUN_H


17 
	#__IF_TUN_H


	)

19 
	~<lšux/ty³s.h
>

20 
	~<lšux/if_‘h”.h
>

21 
	~<lšux/f‹r.h
>

24 
	#TUN_READQ_SIZE
 500

	)

27 
	#TUN_TUN_DEV
 0x0001

	)

28 
	#TUN_TAP_DEV
 0x0002

	)

29 
	#TUN_TYPE_MASK
 0x000f

	)

31 
	#TUN_FASYNC
 0x0010

	)

32 
	#TUN_NOCHECKSUM
 0x0020

	)

33 
	#TUN_NO_PI
 0x0040

	)

34 
	#TUN_ONE_QUEUE
 0x0080

	)

35 
	#TUN_PERSIST
 0x0100

	)

36 
	#TUN_VNET_HDR
 0x0200

	)

39 
	#TUNSETNOCSUM
 
	`_IOW
('T', 200, )

	)

40 
	#TUNSETDEBUG
 
	`_IOW
('T', 201, )

	)

41 
	#TUNSETIFF
 
	`_IOW
('T', 202, )

	)

42 
	#TUNSETPERSIST
 
	`_IOW
('T', 203, )

	)

43 
	#TUNSETOWNER
 
	`_IOW
('T', 204, )

	)

44 
	#TUNSETLINK
 
	`_IOW
('T', 205, )

	)

45 
	#TUNSETGROUP
 
	`_IOW
('T', 206, )

	)

46 
	#TUNGETFEATURES
 
	`_IOR
('T', 207, )

	)

47 
	#TUNSETOFFLOAD
 
	`_IOW
('T', 208, )

	)

48 
	#TUNSETTXFILTER
 
	`_IOW
('T', 209, )

	)

49 
	#TUNGETIFF
 
	`_IOR
('T', 210, )

	)

50 
	#TUNGETSNDBUF
 
	`_IOR
('T', 211, )

	)

51 
	#TUNSETSNDBUF
 
	`_IOW
('T', 212, )

	)

52 
	#TUNATTACHFILTER
 
	`_IOW
('T', 213, 
sock_årog
)

	)

53 
	#TUNDETACHFILTER
 
	`_IOW
('T', 214, 
sock_årog
)

	)

54 
	#TUNGETVNETHDRSZ
 
	`_IOR
('T', 215, )

	)

55 
	#TUNSETVNETHDRSZ
 
	`_IOW
('T', 216, )

	)

58 
	#IFF_TUN
 0x0001

	)

59 
	#IFF_TAP
 0x0002

	)

60 
	#IFF_NO_PI
 0x1000

	)

61 
	#IFF_ONE_QUEUE
 0x2000

	)

62 
	#IFF_VNET_HDR
 0x4000

	)

63 
	#IFF_TUN_EXCL
 0x8000

	)

66 
	#TUN_F_CSUM
 0x01

	)

67 
	#TUN_F_TSO4
 0x02

	)

68 
	#TUN_F_TSO6
 0x04

	)

69 
	#TUN_F_TSO_ECN
 0x08

	)

70 
	#TUN_F_UFO
 0x10

	)

73 
	#TUN_PKT_STRIP
 0x0001

	)

74 
	stun_pi
 {

75 
__u16
 
	mæags
;

76 
__be16
 
	m´Ùo
;

87 
	#TUN_FLT_ALLMULTI
 0x0001

	)

88 
	stun_f‹r
 {

89 
__u16
 
	mæags
;

90 
__u16
 
	mcouÁ
;

91 
__u8
 
	maddr
[0][
ETH_ALEN
];

	@/usr/include/linux/in6.h

21 #iâdeà
_LINUX_IN6_H


22 
	#_LINUX_IN6_H


	)

24 
	~<lšux/ty³s.h
>

30 
	sš6_addr
 {

32 
__u8
 
	mu6_addr8
[16];

33 
__be16
 
	mu6_addr16
[8];

34 
__be32
 
	mu6_addr32
[4];

35 } 
	mš6_u
;

36 
	#s6_addr
 
š6_u
.
u6_addr8


	)

37 
	#s6_addr16
 
š6_u
.
u6_addr16


	)

38 
	#s6_addr32
 
š6_u
.
u6_addr32


	)

46 
	ssockaddr_š6
 {

47 
	msš6_çmy
;

48 
__be16
 
	msš6_pÜt
;

49 
__be32
 
	msš6_æowšfo
;

50 
š6_addr
 
	msš6_addr
;

51 
__u32
 
	msš6_scİe_id
;

54 
	sv6_m»q
 {

56 
š6_addr
 
	mv6mr_muÉŸddr
;

59 
	mv6mr_ifšdex
;

62 
	#v6mr_aÿddr
 
v6mr_muÉŸddr


	)

64 
	sš6_æowÏb–_»q
 {

65 
š6_addr
 
	mær_d¡
;

66 
__be32
 
	mær_Ïb–
;

67 
__u8
 
	mær_aùiÚ
;

68 
__u8
 
	mær_sh¬e
;

69 
__u16
 
	mær_æags
;

70 
__u16
 
	mær_expœes
;

71 
__u16
 
	mær_lšg”
;

72 
__u32
 
	m__ær_·d
;

76 
	#IPV6_FL_A_GET
 0

	)

77 
	#IPV6_FL_A_PUT
 1

	)

78 
	#IPV6_FL_A_RENEW
 2

	)

80 
	#IPV6_FL_F_CREATE
 1

	)

81 
	#IPV6_FL_F_EXCL
 2

	)

83 
	#IPV6_FL_S_NONE
 0

	)

84 
	#IPV6_FL_S_EXCL
 1

	)

85 
	#IPV6_FL_S_PROCESS
 2

	)

86 
	#IPV6_FL_S_USER
 3

	)

87 
	#IPV6_FL_S_ANY
 255

	)

98 
	#IPV6_FLOWINFO_FLOWLABEL
 0x000fffff

	)

99 
	#IPV6_FLOWINFO_PRIORITY
 0x0ff00000

	)

102 
	#IPV6_PRIORITY_UNCHARACTERIZED
 0x0000

	)

103 
	#IPV6_PRIORITY_FILLER
 0x0100

	)

104 
	#IPV6_PRIORITY_UNATTENDED
 0x0200

	)

105 
	#IPV6_PRIORITY_RESERVED1
 0x0300

	)

106 
	#IPV6_PRIORITY_BULK
 0x0400

	)

107 
	#IPV6_PRIORITY_RESERVED2
 0x0500

	)

108 
	#IPV6_PRIORITY_INTERACTIVE
 0x0600

	)

109 
	#IPV6_PRIORITY_CONTROL
 0x0700

	)

110 
	#IPV6_PRIORITY_8
 0x0800

	)

111 
	#IPV6_PRIORITY_9
 0x0900

	)

112 
	#IPV6_PRIORITY_10
 0x0a00

	)

113 
	#IPV6_PRIORITY_11
 0x0b00

	)

114 
	#IPV6_PRIORITY_12
 0x0c00

	)

115 
	#IPV6_PRIORITY_13
 0x0d00

	)

116 
	#IPV6_PRIORITY_14
 0x0e00

	)

117 
	#IPV6_PRIORITY_15
 0x0f00

	)

122 
	#IPPROTO_HOPOPTS
 0

	)

123 
	#IPPROTO_ROUTING
 43

	)

124 
	#IPPROTO_FRAGMENT
 44

	)

125 
	#IPPROTO_ICMPV6
 58

	)

126 
	#IPPROTO_NONE
 59

	)

127 
	#IPPROTO_DSTOPTS
 60

	)

128 
	#IPPROTO_MH
 135

	)

133 
	#IPV6_TLV_PAD0
 0

	)

134 
	#IPV6_TLV_PADN
 1

	)

135 
	#IPV6_TLV_ROUTERALERT
 5

	)

136 
	#IPV6_TLV_JUMBO
 194

	)

137 
	#IPV6_TLV_HAO
 201

	)

143 
	#IPV6_ADDRFORM
 1

	)

144 
	#IPV6_2292PKTINFO
 2

	)

145 
	#IPV6_2292HOPOPTS
 3

	)

146 
	#IPV6_2292DSTOPTS
 4

	)

147 
	#IPV6_2292RTHDR
 5

	)

148 
	#IPV6_2292PKTOPTIONS
 6

	)

149 
	#IPV6_CHECKSUM
 7

	)

150 
	#IPV6_2292HOPLIMIT
 8

	)

151 
	#IPV6_NEXTHOP
 9

	)

152 
	#IPV6_AUTHHDR
 10

	)

153 
	#IPV6_FLOWINFO
 11

	)

155 
	#IPV6_UNICAST_HOPS
 16

	)

156 
	#IPV6_MULTICAST_IF
 17

	)

157 
	#IPV6_MULTICAST_HOPS
 18

	)

158 
	#IPV6_MULTICAST_LOOP
 19

	)

159 
	#IPV6_ADD_MEMBERSHIP
 20

	)

160 
	#IPV6_DROP_MEMBERSHIP
 21

	)

161 
	#IPV6_ROUTER_ALERT
 22

	)

162 
	#IPV6_MTU_DISCOVER
 23

	)

163 
	#IPV6_MTU
 24

	)

164 
	#IPV6_RECVERR
 25

	)

165 
	#IPV6_V6ONLY
 26

	)

166 
	#IPV6_JOIN_ANYCAST
 27

	)

167 
	#IPV6_LEAVE_ANYCAST
 28

	)

170 
	#IPV6_PMTUDISC_DONT
 0

	)

171 
	#IPV6_PMTUDISC_WANT
 1

	)

172 
	#IPV6_PMTUDISC_DO
 2

	)

173 
	#IPV6_PMTUDISC_PROBE
 3

	)

176 
	#IPV6_FLOWLABEL_MGR
 32

	)

177 
	#IPV6_FLOWINFO_SEND
 33

	)

179 
	#IPV6_IPSEC_POLICY
 34

	)

180 
	#IPV6_XFRM_POLICY
 35

	)

201 
	#IPV6_RECVPKTINFO
 49

	)

202 
	#IPV6_PKTINFO
 50

	)

203 
	#IPV6_RECVHOPLIMIT
 51

	)

204 
	#IPV6_HOPLIMIT
 52

	)

205 
	#IPV6_RECVHOPOPTS
 53

	)

206 
	#IPV6_HOPOPTS
 54

	)

207 
	#IPV6_RTHDRDSTOPTS
 55

	)

208 
	#IPV6_RECVRTHDR
 56

	)

209 
	#IPV6_RTHDR
 57

	)

210 
	#IPV6_RECVDSTOPTS
 58

	)

211 
	#IPV6_DSTOPTS
 59

	)

212 
	#IPV6_RECVPATHMTU
 60

	)

213 
	#IPV6_PATHMTU
 61

	)

214 
	#IPV6_DONTFRAG
 62

	)

216 
	#IPV6_USE_MIN_MTU
 63

	)

232 
	#IPV6_RECVTCLASS
 66

	)

233 
	#IPV6_TCLASS
 67

	)

246 
	#IPV6_ADDR_PREFERENCES
 72

	)

248 
	#IPV6_PREFER_SRC_TMP
 0x0001

	)

249 
	#IPV6_PREFER_SRC_PUBLIC
 0x0002

	)

250 
	#IPV6_PREFER_SRC_PUBTMP_DEFAULT
 0x0100

	)

251 
	#IPV6_PREFER_SRC_COA
 0x0004

	)

252 
	#IPV6_PREFER_SRC_HOME
 0x0400

	)

253 
	#IPV6_PREFER_SRC_CGA
 0x0008

	)

254 
	#IPV6_PREFER_SRC_NONCGA
 0x0800

	)

257 
	#IPV6_MINHOPCOUNT
 73

	)

259 
	#IPV6_ORIGDSTADDR
 74

	)

260 
	#IPV6_RECVORIGDSTADDR
 
IPV6_ORIGDSTADDR


	)

261 
	#IPV6_TRANSPARENT
 75

	)

	@/usr/include/linux/ioctl.h

1 #iâdeà
_LINUX_IOCTL_H


2 
	#_LINUX_IOCTL_H


	)

4 
	~<asm/ioùl.h
>

	@/usr/include/linux/ipv6_route.h

13 #iâdeà
_LINUX_IPV6_ROUTE_H


14 
	#_LINUX_IPV6_ROUTE_H


	)

16 
	~<lšux/ty³s.h
>

18 
	#RTF_DEFAULT
 0x00010000

	)

19 
	#RTF_ALLONLINK
 0x00020000

	)

21 
	#RTF_ADDRCONF
 0x00040000

	)

22 
	#RTF_PREFIX_RT
 0x00080000

	)

23 
	#RTF_ANYCAST
 0x00100000

	)

25 
	#RTF_NONEXTHOP
 0x00200000

	)

26 
	#RTF_EXPIRES
 0x00400000

	)

28 
	#RTF_ROUTEINFO
 0x00800000

	)

30 
	#RTF_CACHE
 0x01000000

	)

31 
	#RTF_FLOW
 0x02000000

	)

32 
	#RTF_POLICY
 0x04000000

	)

34 
	#RTF_PREF
(
´ef
è(Õ»fè<< 27)

	)

35 
	#RTF_PREF_MASK
 0x18000000

	)

37 
	#RTF_LOCAL
 0x80000000

	)

40 
	sš6_¹msg
 {

41 
š6_addr
 
	m¹msg_d¡
;

42 
š6_addr
 
	m¹msg_¤c
;

43 
š6_addr
 
	m¹msg_g©eway
;

44 
__u32
 
	m¹msg_ty³
;

45 
__u16
 
	m¹msg_d¡_Ën
;

46 
__u16
 
	m¹msg_¤c_Ën
;

47 
__u32
 
	m¹msg_m‘ric
;

48 
	m¹msg_šfo
;

49 
__u32
 
	m¹msg_æags
;

50 
	m¹msg_ifšdex
;

53 
	#RTMSG_NEWDEVICE
 0x11

	)

54 
	#RTMSG_DELDEVICE
 0x12

	)

55 
	#RTMSG_NEWROUTE
 0x21

	)

56 
	#RTMSG_DELROUTE
 0x22

	)

	@/usr/include/linux/joystick.h

1 #iâdeà
_LINUX_JOYSTICK_H


2 
	#_LINUX_JOYSTICK_H


	)

30 
	~<lšux/ty³s.h
>

31 
	~<lšux/šput.h
>

37 
	#JS_VERSION
 0x020100

	)

43 
	#JS_EVENT_BUTTON
 0x01

	)

44 
	#JS_EVENT_AXIS
 0x02

	)

45 
	#JS_EVENT_INIT
 0x80

	)

47 
	sjs_ev’t
 {

48 
__u32
 
	mtime
;

49 
__s16
 
	mv®ue
;

50 
__u8
 
	mty³
;

51 
__u8
 
	mnumb”
;

58 
	#JSIOCGVERSION
 
	`_IOR
('j', 0x01, 
__u32
è

	)

60 
	#JSIOCGAXES
 
	`_IOR
('j', 0x11, 
__u8
è

	)

61 
	#JSIOCGBUTTONS
 
	`_IOR
('j', 0x12, 
__u8
è

	)

62 
	#JSIOCGNAME
(
Ën
è
	`_IOC
(
_IOC_READ
, 'j', 0x13,†’è

	)

64 
	#JSIOCSCORR
 
	`_IOW
('j', 0x21, 
js_cÜr
è

	)

65 
	#JSIOCGCORR
 
	`_IOR
('j', 0x22, 
js_cÜr
è

	)

67 
	#JSIOCSAXMAP
 
	`_IOW
('j', 0x31, 
__u8
[
ABS_CNT
]è

	)

68 
	#JSIOCGAXMAP
 
	`_IOR
('j', 0x32, 
__u8
[
ABS_CNT
]è

	)

69 
	#JSIOCSBTNMAP
 
	`_IOW
('j', 0x33, 
__u16
[
KEY_MAX
 - 
BTN_MISC
 + 1]è

	)

70 
	#JSIOCGBTNMAP
 
	`_IOR
('j', 0x34, 
__u16
[
KEY_MAX
 - 
BTN_MISC
 + 1]è

	)

76 
	#JS_CORR_NONE
 0x00

	)

77 
	#JS_CORR_BROKEN
 0x01

	)

79 
	sjs_cÜr
 {

80 
__s32
 
	mcÛf
[8];

81 
__s16
 
	m´ec
;

82 
__u16
 
	mty³
;

89 
	#JS_RETURN
 (
JS_DATA_TYPE
)

	)

90 
	#JS_TRUE
 1

	)

91 
	#JS_FALSE
 0

	)

92 
	#JS_X_0
 0x01

	)

93 
	#JS_Y_0
 0x02

	)

94 
	#JS_X_1
 0x04

	)

95 
	#JS_Y_1
 0x08

	)

96 
	#JS_MAX
 2

	)

98 
	#JS_DEF_TIMEOUT
 0x1300

	)

99 
	#JS_DEF_CORR
 0

	)

100 
	#JS_DEF_TIMELIMIT
 10L

	)

102 
	#JS_SET_CAL
 1

	)

103 
	#JS_GET_CAL
 2

	)

104 
	#JS_SET_TIMEOUT
 3

	)

105 
	#JS_GET_TIMEOUT
 4

	)

106 
	#JS_SET_TIMELIMIT
 5

	)

107 
	#JS_GET_TIMELIMIT
 6

	)

108 
	#JS_GET_ALL
 7

	)

109 
	#JS_SET_ALL
 8

	)

111 
	sJS_DATA_TYPE
 {

112 
__s32
 
	mbu‰Ús
;

113 
__s32
 
	mx
;

114 
__s32
 
	my
;

117 
	sJS_DATA_SAVE_TYPE_32
 {

118 
__s32
 
	mJS_TIMEOUT
;

119 
__s32
 
	mBUSY
;

120 
__s32
 
	mJS_EXPIRETIME
;

121 
__s32
 
	mJS_TIMELIMIT
;

122 
JS_DATA_TYPE
 
	mJS_SAVE
;

123 
JS_DATA_TYPE
 
	mJS_CORR
;

126 
	sJS_DATA_SAVE_TYPE_64
 {

127 
__s32
 
	mJS_TIMEOUT
;

128 
__s32
 
	mBUSY
;

129 
__s64
 
	mJS_EXPIRETIME
;

130 
__s64
 
	mJS_TIMELIMIT
;

131 
JS_DATA_TYPE
 
	mJS_SAVE
;

132 
JS_DATA_TYPE
 
	mJS_CORR
;

	@/usr/include/linux/kd.h

1 #iâdeà
_LINUX_KD_H


2 
	#_LINUX_KD_H


	)

3 
	~<lšux/ty³s.h
>

8 
	#GIO_FONT
 0x4B60

	)

9 
	#PIO_FONT
 0x4B61

	)

11 
	#GIO_FONTX
 0x4B6B

	)

12 
	#PIO_FONTX
 0x4B6C

	)

13 
	scÚsŞefÚtdesc
 {

14 
	mch¬couÁ
;

15 
	mch¬height
;

16 *
	mch¬d©a
;

19 
	#PIO_FONTRESET
 0x4B6D

	)

21 
	#GIO_CMAP
 0x4B70

	)

22 
	#PIO_CMAP
 0x4B71

	)

24 
	#KIOCSOUND
 0x4B2F

	)

25 
	#KDMKTONE
 0x4B30

	)

27 
	#KDGETLED
 0x4B31

	)

28 
	#KDSETLED
 0x4B32

	)

29 
	#LED_SCR
 0x01

	)

30 
	#LED_NUM
 0x02

	)

31 
	#LED_CAP
 0x04

	)

33 
	#KDGKBTYPE
 0x4B33

	)

34 
	#KB_84
 0x01

	)

35 
	#KB_101
 0x02

	)

36 
	#KB_OTHER
 0x03

	)

38 
	#KDADDIO
 0x4B34

	)

39 
	#KDDELIO
 0x4B35

	)

40 
	#KDENABIO
 0x4B36

	)

41 
	#KDDISABIO
 0x4B37

	)

43 
	#KDSETMODE
 0x4B3A

	)

44 
	#KD_TEXT
 0x00

	)

45 
	#KD_GRAPHICS
 0x01

	)

46 
	#KD_TEXT0
 0x02

	)

47 
	#KD_TEXT1
 0x03

	)

48 
	#KD_TRANSPARENT
 0x04

	)

49 
	#KDGETMODE
 0x4B3B

	)

51 
	#KDMAPDISP
 0x4B3C

	)

52 
	#KDUNMAPDISP
 0x4B3D

	)

54 
	tsünm­_t
;

55 
	#E_TABSZ
 256

	)

56 
	#GIO_SCRNMAP
 0x4B40

	)

57 
	#PIO_SCRNMAP
 0x4B41

	)

58 
	#GIO_UNISCRNMAP
 0x4B69

	)

59 
	#PIO_UNISCRNMAP
 0x4B6A

	)

61 
	#GIO_UNIMAP
 0x4B66

	)

62 
	sunaœ
 {

63 
	municode
;

64 
	mfÚos
;

66 
	sunim­desc
 {

67 
	m’Œy_ù
;

68 
unaœ
 *
	m’Œ›s
;

70 
	#PIO_UNIMAP
 0x4B67

	)

71 
	#PIO_UNIMAPCLR
 0x4B68

	)

72 
	sunim­š™
 {

73 
	madvi£d_hashsize
;

74 
	madvi£d_hash¡•
;

75 
	madvi£d_hashËv–
;

78 
	#UNI_DIRECT_BASE
 0xF000

	)

79 
	#UNI_DIRECT_MASK
 0x01FF

	)

81 
	#K_RAW
 0x00

	)

82 
	#K_XLATE
 0x01

	)

83 
	#K_MEDIUMRAW
 0x02

	)

84 
	#K_UNICODE
 0x03

	)

85 
	#K_OFF
 0x04

	)

86 
	#KDGKBMODE
 0x4B44

	)

87 
	#KDSKBMODE
 0x4B45

	)

89 
	#K_METABIT
 0x03

	)

90 
	#K_ESCPREFIX
 0x04

	)

91 
	#KDGKBMETA
 0x4B62

	)

92 
	#KDSKBMETA
 0x4B63

	)

94 
	#K_SCROLLLOCK
 0x01

	)

95 
	#K_NUMLOCK
 0x02

	)

96 
	#K_CAPSLOCK
 0x04

	)

97 
	#KDGKBLED
 0x4B64

	)

98 
	#KDSKBLED
 0x4B65

	)

100 
	skb’Œy
 {

101 
	mkb_bË
;

102 
	mkb_šdex
;

103 
	mkb_v®ue
;

105 
	#K_NORMTAB
 0x00

	)

106 
	#K_SHIFTTAB
 0x01

	)

107 
	#K_ALTTAB
 0x02

	)

108 
	#K_ALTSHIFTTAB
 0x03

	)

110 
	#KDGKBENT
 0x4B46

	)

111 
	#KDSKBENT
 0x4B47

	)

113 
	skb£Áry
 {

114 
	mkb_func
;

115 
	mkb_¡ršg
[512];

117 
	#KDGKBSENT
 0x4B48

	)

118 
	#KDSKBSENT
 0x4B49

	)

120 
	skbdŸü
 {

121 
	mdŸü
, 
	mba£
, 
	m»suÉ
;

123 
	skbdŸüs
 {

124 
	mkb_út
;

125 
kbdŸü
 
	mkbdŸü
[256];

127 
	#KDGKBDIACR
 0x4B4A

	)

128 
	#KDSKBDIACR
 0x4B4B

	)

130 
	skbdŸüuc
 {

131 
	mdŸü
, 
	mba£
, 
	m»suÉ
;

133 
	skbdŸüsuc
 {

134 
	mkb_út
;

135 
kbdŸüuc
 
	mkbdŸüuc
[256];

137 
	#KDGKBDIACRUC
 0x4BFA

	)

138 
	#KDSKBDIACRUC
 0x4BFB

	)

140 
	skbkeycode
 {

141 
	msÿncode
, 
	mkeycode
;

143 
	#KDGETKEYCODE
 0x4B4C

	)

144 
	#KDSETKEYCODE
 0x4B4D

	)

146 
	#KDSIGACCEPT
 0x4B4E

	)

148 
	skbd_»³©
 {

149 
	md–ay
;

150 
	m³riod
;

154 
	#KDKBDREP
 0x4B52

	)

157 
	#KDFONTOP
 0x4B72

	)

159 
	scÚsŞe_fÚt_İ
 {

160 
	mİ
;

161 
	mæags
;

162 
	mwidth
, 
	mheight
;

163 
	mch¬couÁ
;

164 *
	md©a
;

167 
	scÚsŞe_fÚt
 {

168 
	mwidth
, 
	mheight
;

169 
	mch¬couÁ
;

170 *
	md©a
;

173 
	#KD_FONT_OP_SET
 0

	)

174 
	#KD_FONT_OP_GET
 1

	)

175 
	#KD_FONT_OP_SET_DEFAULT
 2

	)

176 
	#KD_FONT_OP_COPY
 3

	)

178 
	#KD_FONT_FLAG_DONT_RECALC
 1

	)

	@/usr/include/linux/kdev_t.h

1 #iâdeà
_LINUX_KDEV_T_H


2 
	#_LINUX_KDEV_T_H


	)

8 
	#MAJOR
(
dev
è((dev)>>8)

	)

9 
	#MINOR
(
dev
è((devè& 0xff)

	)

10 
	#MKDEV
(
ma
,
mi
è((ma)<<8 | (mi))

	)

	@/usr/include/linux/kernel.h

1 #iâdeà
_LINUX_KERNEL_H


2 
	#_LINUX_KERNEL_H


	)

7 
	#__ALIGN_KERNEL
(
x
, 
a
è
	`__ALIGN_KERNEL_MASK
(x, (
	`ty³of
(x))×è- 1)

	)

8 
	#__ALIGN_KERNEL_MASK
(
x
, 
mask
è(((xè+ (mask)è& ~(mask))

	)

11 
	#SI_LOAD_SHIFT
 16

	)

12 
	ssysšfo
 {

13 
	mu±ime
;

14 
	mlßds
[3];

15 
	mtÙ®¿m
;

16 
	mä“¿m
;

17 
	msh¬ed¿m
;

18 
	mbufã¼am
;

19 
	mtÙ®sw­
;

20 
	mä“sw­
;

21 
	m´ocs
;

22 
	m·d
;

23 
	mtÙ®high
;

24 
	mä“high
;

25 
	mmem_un™
;

26 
	m_f
[20-2*()-()];

	@/usr/include/linux/loop.h

1 #iâdeà
_LINUX_LOOP_H


2 
	#_LINUX_LOOP_H


	)

13 
	#LO_NAME_SIZE
 64

	)

14 
	#LO_KEY_SIZE
 32

	)

21 
	mLO_FLAGS_READ_ONLY
 = 1,

22 
	mLO_FLAGS_AUTOCLEAR
 = 4,

23 
	mLO_FLAGS_PARTSCAN
 = 8,

26 
	~<asm/posix_ty³s.h
>

27 
	~<lšux/ty³s.h
>

30 
	sloİ_šfo
 {

31 
	mlo_numb”
;

32 
__k”Ãl_Şd_dev_t
 
	mlo_deviû
;

33 
	mlo_šode
;

34 
__k”Ãl_Şd_dev_t
 
	mlo_rdeviû
;

35 
	mlo_off£t
;

36 
	mlo_’üy±_ty³
;

37 
	mlo_’üy±_key_size
;

38 
	mlo_æags
;

39 
	mlo_Çme
[
LO_NAME_SIZE
];

40 
	mlo_’üy±_key
[
LO_KEY_SIZE
];

41 
	mlo_š™
[2];

42 
	m»£rved
[4];

45 
	sloİ_šfo64
 {

46 
__u64
 
	mlo_deviû
;

47 
__u64
 
	mlo_šode
;

48 
__u64
 
	mlo_rdeviû
;

49 
__u64
 
	mlo_off£t
;

50 
__u64
 
	mlo_siz–im™
;

51 
__u32
 
	mlo_numb”
;

52 
__u32
 
	mlo_’üy±_ty³
;

53 
__u32
 
	mlo_’üy±_key_size
;

54 
__u32
 
	mlo_æags
;

55 
__u8
 
	mlo_fe_Çme
[
LO_NAME_SIZE
];

56 
__u8
 
	mlo_üy±_Çme
[
LO_NAME_SIZE
];

57 
__u8
 
	mlo_’üy±_key
[
LO_KEY_SIZE
];

58 
__u64
 
	mlo_š™
[2];

65 
	#LO_CRYPT_NONE
 0

	)

66 
	#LO_CRYPT_XOR
 1

	)

67 
	#LO_CRYPT_DES
 2

	)

68 
	#LO_CRYPT_FISH2
 3

	)

69 
	#LO_CRYPT_BLOW
 4

	)

70 
	#LO_CRYPT_CAST128
 5

	)

71 
	#LO_CRYPT_IDEA
 6

	)

72 
	#LO_CRYPT_DUMMY
 9

	)

73 
	#LO_CRYPT_SKIPJACK
 10

	)

74 
	#LO_CRYPT_CRYPTOAPI
 18

	)

75 
	#MAX_LO_CRYPT
 20

	)

81 
	#LOOP_SET_FD
 0x4C00

	)

82 
	#LOOP_CLR_FD
 0x4C01

	)

83 
	#LOOP_SET_STATUS
 0x4C02

	)

84 
	#LOOP_GET_STATUS
 0x4C03

	)

85 
	#LOOP_SET_STATUS64
 0x4C04

	)

86 
	#LOOP_GET_STATUS64
 0x4C05

	)

87 
	#LOOP_CHANGE_FD
 0x4C06

	)

88 
	#LOOP_SET_CAPACITY
 0x4C07

	)

91 
	#LOOP_CTL_ADD
 0x4C80

	)

92 
	#LOOP_CTL_REMOVE
 0x4C81

	)

93 
	#LOOP_CTL_GET_FREE
 0x4C82

	)

	@/usr/include/linux/lp.h

1 #iâdeà
_LINUX_LP_H


2 
	#_LINUX_LP_H


	)

15 
	#LP_EXIST
 0x0001

	)

16 
	#LP_SELEC
 0x0002

	)

17 
	#LP_BUSY
 0x0004

	)

18 
	#LP_BUSY_BIT_POS
 2

	)

19 
	#LP_OFFL
 0x0008

	)

20 
	#LP_NOPA
 0x0010

	)

21 
	#LP_ERR
 0x0020

	)

22 
	#LP_ABORT
 0x0040

	)

23 
	#LP_CAREFUL
 0x0080

	)

24 
	#LP_ABORTOPEN
 0x0100

	)

26 
	#LP_TRUST_IRQ_
 0x0200

	)

27 
	#LP_NO_REVERSE
 0x0400

	)

28 
	#LP_DATA_AVAIL
 0x0800

	)

35 
	#LP_PBUSY
 0x80

	)

36 
	#LP_PACK
 0x40

	)

37 
	#LP_POUTPA
 0x20

	)

38 
	#LP_PSELECD
 0x10

	)

39 
	#LP_PERRORP
 0x08

	)

49 
	#LP_INIT_CHAR
 1000

	)

55 
	#LP_INIT_WAIT
 1

	)

67 
	#LP_INIT_TIME
 2

	)

70 
	#LPCHAR
 0x0601

	)

71 
	#LPTIME
 0x0602

	)

72 
	#LPABORT
 0x0604

	)

74 
	#LPSETIRQ
 0x0605

	)

76 
	#LPGETIRQ
 0x0606

	)

77 
	#LPWAIT
 0x0608

	)

79 
	#LPCAREFUL
 0x0609

	)

82 
	#LPABORTOPEN
 0x060¨

	)

84 
	#LPGETSTATUS
 0x060b

	)

85 
	#LPRESET
 0x060ø

	)

86 #ifdeà
LP_STATS


87 
	#LPGETSTATS
 0x060d

	)

89 
	#LPGETFLAGS
 0x060

	)

90 
	#LPSETTIMEOUT
 0x060à

	)

96 
	#LP_TIMEOUT_INTERRUPT
 (60 * 
HZ
)

	)

97 
	#LP_TIMEOUT_POLLED
 (10 * 
HZ
)

	)

	@/usr/include/linux/magic.h

1 #iâdeà
__LINUX_MAGIC_H__


2 
	#__LINUX_MAGIC_H__


	)

4 
	#ADFS_SUPER_MAGIC
 0xadf5

	)

5 
	#AFFS_SUPER_MAGIC
 0xadff

	)

6 
	#AFS_SUPER_MAGIC
 0x5346414F

	)

7 
	#AUTOFS_SUPER_MAGIC
 0x0187

	)

8 
	#CODA_SUPER_MAGIC
 0x73757245

	)

9 
	#CRAMFS_MAGIC
 0x28cd3d45

	)

10 
	#CRAMFS_MAGIC_WEND
 0x453dcd28

	)

11 
	#DEBUGFS_MAGIC
 0x64626720

	)

12 
	#SYSFS_MAGIC
 0x62656572

	)

13 
	#SECURITYFS_MAGIC
 0x73636673

	)

14 
	#SELINUX_MAGIC
 0xf97cff8c

	)

15 
	#RAMFS_MAGIC
 0x858458f6

	)

16 
	#TMPFS_MAGIC
 0x01021994

	)

17 
	#HUGETLBFS_MAGIC
 0x958458f6

	)

18 
	#SQUASHFS_MAGIC
 0x73717368

	)

19 
	#ECRYPTFS_SUPER_MAGIC
 0xf15f

	)

20 
	#EFS_SUPER_MAGIC
 0x414A53

	)

21 
	#EXT2_SUPER_MAGIC
 0xEF53

	)

22 
	#EXT3_SUPER_MAGIC
 0xEF53

	)

23 
	#XENFS_SUPER_MAGIC
 0xabba1974

	)

24 
	#EXT4_SUPER_MAGIC
 0xEF53

	)

25 
	#BTRFS_SUPER_MAGIC
 0x9123683E

	)

26 
	#NILFS_SUPER_MAGIC
 0x3434

	)

27 
	#HPFS_SUPER_MAGIC
 0xf995e849

	)

28 
	#ISOFS_SUPER_MAGIC
 0x9660

	)

29 
	#JFFS2_SUPER_MAGIC
 0x72b6

	)

30 
	#ANON_INODE_FS_MAGIC
 0x09041934

	)

31 
	#PSTOREFS_MAGIC
 0x6165676C

	)

33 
	#MINIX_SUPER_MAGIC
 0x137F

	)

34 
	#MINIX_SUPER_MAGIC2
 0x138F

	)

35 
	#MINIX2_SUPER_MAGIC
 0x2468

	)

36 
	#MINIX2_SUPER_MAGIC2
 0x2478

	)

37 
	#MINIX3_SUPER_MAGIC
 0x4d5¨

	)

39 
	#MSDOS_SUPER_MAGIC
 0x4d44

	)

40 
	#NCP_SUPER_MAGIC
 0x564ø

	)

41 
	#NFS_SUPER_MAGIC
 0x6969

	)

42 
	#OPENPROM_SUPER_MAGIC
 0x9ç1

	)

43 
	#PROC_SUPER_MAGIC
 0x9ç0

	)

44 
	#QNX4_SUPER_MAGIC
 0x002à

	)

46 
	#REISERFS_SUPER_MAGIC
 0x52654973

	)

49 
	#REISERFS_SUPER_MAGIC_STRING
 "ReIsErFs"

	)

50 
	#REISER2FS_SUPER_MAGIC_STRING
 "ReIsEr2Fs"

	)

51 
	#REISER2FS_JR_SUPER_MAGIC_STRING
 "ReIsEr3Fs"

	)

53 
	#SMB_SUPER_MAGIC
 0x517B

	)

54 
	#USBDEVICE_SUPER_MAGIC
 0x9ç2

	)

55 
	#CGROUP_SUPER_MAGIC
 0x27e0eb

	)

57 
	#FUTEXFS_SUPER_MAGIC
 0xBAD1DEA

	)

59 
	#STACK_END_MAGIC
 0x57AC6E9D

	)

61 
	#DEVPTS_SUPER_MAGIC
 0x1cd1

	)

62 
	#SOCKFS_MAGIC
 0x534F434B

	)

63 
	#V9FS_MAGIC
 0x01021997

	)

	@/usr/include/linux/major.h

1 #iâdeà
_LINUX_MAJOR_H


2 
	#_LINUX_MAJOR_H


	)

9 
	#UNNAMED_MAJOR
 0

	)

10 
	#MEM_MAJOR
 1

	)

11 
	#RAMDISK_MAJOR
 1

	)

12 
	#FLOPPY_MAJOR
 2

	)

13 
	#PTY_MASTER_MAJOR
 2

	)

14 
	#IDE0_MAJOR
 3

	)

15 
	#HD_MAJOR
 
IDE0_MAJOR


	)

16 
	#PTY_SLAVE_MAJOR
 3

	)

17 
	#TTY_MAJOR
 4

	)

18 
	#TTYAUX_MAJOR
 5

	)

19 
	#LP_MAJOR
 6

	)

20 
	#VCS_MAJOR
 7

	)

21 
	#LOOP_MAJOR
 7

	)

22 
	#SCSI_DISK0_MAJOR
 8

	)

23 
	#SCSI_TAPE_MAJOR
 9

	)

24 
	#MD_MAJOR
 9

	)

25 
	#MISC_MAJOR
 10

	)

26 
	#SCSI_CDROM_MAJOR
 11

	)

27 
	#MUX_MAJOR
 11

	)

28 
	#XT_DISK_MAJOR
 13

	)

29 
	#INPUT_MAJOR
 13

	)

30 
	#SOUND_MAJOR
 14

	)

31 
	#CDU31A_CDROM_MAJOR
 15

	)

32 
	#JOYSTICK_MAJOR
 15

	)

33 
	#GOLDSTAR_CDROM_MAJOR
 16

	)

34 
	#OPTICS_CDROM_MAJOR
 17

	)

35 
	#SANYO_CDROM_MAJOR
 18

	)

36 
	#CYCLADES_MAJOR
 19

	)

37 
	#CYCLADESAUX_MAJOR
 20

	)

38 
	#MITSUMI_X_CDROM_MAJOR
 20

	)

39 
	#MFM_ACORN_MAJOR
 21

	)

40 
	#SCSI_GENERIC_MAJOR
 21

	)

41 
	#IDE1_MAJOR
 22

	)

42 
	#DIGICU_MAJOR
 22

	)

43 
	#DIGI_MAJOR
 23

	)

44 
	#MITSUMI_CDROM_MAJOR
 23

	)

45 
	#CDU535_CDROM_MAJOR
 24

	)

46 
	#STL_SERIALMAJOR
 24

	)

47 
	#MATSUSHITA_CDROM_MAJOR
 25

	)

48 
	#STL_CALLOUTMAJOR
 25

	)

49 
	#MATSUSHITA_CDROM2_MAJOR
 26

	)

50 
	#QIC117_TAPE_MAJOR
 27

	)

51 
	#MATSUSHITA_CDROM3_MAJOR
 27

	)

52 
	#MATSUSHITA_CDROM4_MAJOR
 28

	)

53 
	#STL_SIOMEMMAJOR
 28

	)

54 
	#ACSI_MAJOR
 28

	)

55 
	#AZTECH_CDROM_MAJOR
 29

	)

56 
	#FB_MAJOR
 29

	)

57 
	#CM206_CDROM_MAJOR
 32

	)

58 
	#IDE2_MAJOR
 33

	)

59 
	#IDE3_MAJOR
 34

	)

60 
	#Z8530_MAJOR
 34

	)

61 
	#XPRAM_MAJOR
 35

	)

62 
	#NETLINK_MAJOR
 36

	)

63 
	#PS2ESDI_MAJOR
 36

	)

64 
	#IDETAPE_MAJOR
 37

	)

65 
	#Z2RAM_MAJOR
 37

	)

66 
	#APBLOCK_MAJOR
 38

	)

67 
	#DDV_MAJOR
 39

	)

68 
	#NBD_MAJOR
 43

	)

69 
	#RISCOM8_NORMAL_MAJOR
 48

	)

70 
	#DAC960_MAJOR
 48

	)

71 
	#RISCOM8_CALLOUT_MAJOR
 49

	)

72 
	#MKISS_MAJOR
 55

	)

73 
	#DSP56K_MAJOR
 55

	)

75 
	#IDE4_MAJOR
 56

	)

76 
	#IDE5_MAJOR
 57

	)

78 
	#SCSI_DISK1_MAJOR
 65

	)

79 
	#SCSI_DISK2_MAJOR
 66

	)

80 
	#SCSI_DISK3_MAJOR
 67

	)

81 
	#SCSI_DISK4_MAJOR
 68

	)

82 
	#SCSI_DISK5_MAJOR
 69

	)

83 
	#SCSI_DISK6_MAJOR
 70

	)

84 
	#SCSI_DISK7_MAJOR
 71

	)

86 
	#COMPAQ_SMART2_MAJOR
 72

	)

87 
	#COMPAQ_SMART2_MAJOR1
 73

	)

88 
	#COMPAQ_SMART2_MAJOR2
 74

	)

89 
	#COMPAQ_SMART2_MAJOR3
 75

	)

90 
	#COMPAQ_SMART2_MAJOR4
 76

	)

91 
	#COMPAQ_SMART2_MAJOR5
 77

	)

92 
	#COMPAQ_SMART2_MAJOR6
 78

	)

93 
	#COMPAQ_SMART2_MAJOR7
 79

	)

95 
	#SPECIALIX_NORMAL_MAJOR
 75

	)

96 
	#SPECIALIX_CALLOUT_MAJOR
 76

	)

98 
	#AURORA_MAJOR
 79

	)

100 
	#I2O_MAJOR
 80

	)

102 
	#SHMIQ_MAJOR
 85

	)

103 
	#SCSI_CHANGER_MAJOR
 86

	)

105 
	#IDE6_MAJOR
 88

	)

106 
	#IDE7_MAJOR
 89

	)

107 
	#IDE8_MAJOR
 90

	)

108 
	#IDE9_MAJOR
 91

	)

110 
	#DASD_MAJOR
 94

	)

112 
	#MDISK_MAJOR
 95

	)

114 
	#UBD_MAJOR
 98

	)

116 
	#PP_MAJOR
 99

	)

117 
	#JSFD_MAJOR
 99

	)

119 
	#PHONE_MAJOR
 100

	)

121 
	#COMPAQ_CISS_MAJOR
 104

	)

122 
	#COMPAQ_CISS_MAJOR1
 105

	)

123 
	#COMPAQ_CISS_MAJOR2
 106

	)

124 
	#COMPAQ_CISS_MAJOR3
 107

	)

125 
	#COMPAQ_CISS_MAJOR4
 108

	)

126 
	#COMPAQ_CISS_MAJOR5
 109

	)

127 
	#COMPAQ_CISS_MAJOR6
 110

	)

128 
	#COMPAQ_CISS_MAJOR7
 111

	)

130 
	#VIODASD_MAJOR
 112

	)

131 
	#VIOCD_MAJOR
 113

	)

133 
	#ATARAID_MAJOR
 114

	)

135 
	#SCSI_DISK8_MAJOR
 128

	)

136 
	#SCSI_DISK9_MAJOR
 129

	)

137 
	#SCSI_DISK10_MAJOR
 130

	)

138 
	#SCSI_DISK11_MAJOR
 131

	)

139 
	#SCSI_DISK12_MAJOR
 132

	)

140 
	#SCSI_DISK13_MAJOR
 133

	)

141 
	#SCSI_DISK14_MAJOR
 134

	)

142 
	#SCSI_DISK15_MAJOR
 135

	)

144 
	#UNIX98_PTY_MASTER_MAJOR
 128

	)

145 
	#UNIX98_PTY_MAJOR_COUNT
 8

	)

146 
	#UNIX98_PTY_SLAVE_MAJOR
 (
UNIX98_PTY_MASTER_MAJOR
+
UNIX98_PTY_MAJOR_COUNT
)

	)

148 
	#DRBD_MAJOR
 147

	)

149 
	#RTF_MAJOR
 150

	)

150 
	#RAW_MAJOR
 162

	)

152 
	#USB_ACM_MAJOR
 166

	)

153 
	#USB_ACM_AUX_MAJOR
 167

	)

154 
	#USB_CHAR_MAJOR
 180

	)

156 
	#MMC_BLOCK_MAJOR
 179

	)

158 
	#VXVM_MAJOR
 199

	)

159 
	#VXSPEC_MAJOR
 200

	)

160 
	#VXDMP_MAJOR
 201

	)

162 
	#XENVBD_MAJOR
 202

	)

164 
	#MSR_MAJOR
 202

	)

165 
	#CPUID_MAJOR
 203

	)

167 
	#OSST_MAJOR
 206

	)

169 
	#IBM_TTY3270_MAJOR
 227

	)

170 
	#IBM_FS3270_MAJOR
 228

	)

172 
	#VIOTAPE_MAJOR
 230

	)

174 
	#BLOCK_EXT_MAJOR
 259

	)

175 
	#SCSI_OSD_MAJOR
 260

	)

	@/usr/include/linux/mii.h

8 #iâdeà
__LINUX_MII_H__


9 
	#__LINUX_MII_H__


	)

11 
	~<lšux/ty³s.h
>

14 
	#MII_BMCR
 0x00

	)

15 
	#MII_BMSR
 0x01

	)

16 
	#MII_PHYSID1
 0x02

	)

17 
	#MII_PHYSID2
 0x03

	)

18 
	#MII_ADVERTISE
 0x04

	)

19 
	#MII_LPA
 0x05

	)

20 
	#MII_EXPANSION
 0x06

	)

21 
	#MII_CTRL1000
 0x09

	)

22 
	#MII_STAT1000
 0x0¨

	)

23 
	#MII_ESTATUS
 0x0à

	)

24 
	#MII_DCOUNTER
 0x12

	)

25 
	#MII_FCSCOUNTER
 0x13

	)

26 
	#MII_NWAYTEST
 0x14

	)

27 
	#MII_RERRCOUNTER
 0x15

	)

28 
	#MII_SREVISION
 0x16

	)

29 
	#MII_RESV1
 0x17

	)

30 
	#MII_LBRERROR
 0x18

	)

31 
	#MII_PHYADDR
 0x19

	)

32 
	#MII_RESV2
 0x1¨

	)

33 
	#MII_TPISTATUS
 0x1b

	)

34 
	#MII_NCONFIG
 0x1ø

	)

37 
	#BMCR_RESV
 0x003à

	)

38 
	#BMCR_SPEED1000
 0x0040

	)

39 
	#BMCR_CTST
 0x0080

	)

40 
	#BMCR_FULLDPLX
 0x0100

	)

41 
	#BMCR_ANRESTART
 0x0200

	)

42 
	#BMCR_ISOLATE
 0x0400

	)

43 
	#BMCR_PDOWN
 0x0800

	)

44 
	#BMCR_ANENABLE
 0x1000

	)

45 
	#BMCR_SPEED100
 0x2000

	)

46 
	#BMCR_LOOPBACK
 0x4000

	)

47 
	#BMCR_RESET
 0x8000

	)

50 
	#BMSR_ERCAP
 0x0001

	)

51 
	#BMSR_JCD
 0x0002

	)

52 
	#BMSR_LSTATUS
 0x0004

	)

53 
	#BMSR_ANEGCAPABLE
 0x0008

	)

54 
	#BMSR_RFAULT
 0x0010

	)

55 
	#BMSR_ANEGCOMPLETE
 0x0020

	)

56 
	#BMSR_RESV
 0x00c0

	)

57 
	#BMSR_ESTATEN
 0x0100

	)

58 
	#BMSR_100HALF2
 0x0200

	)

59 
	#BMSR_100FULL2
 0x0400

	)

60 
	#BMSR_10HALF
 0x0800

	)

61 
	#BMSR_10FULL
 0x1000

	)

62 
	#BMSR_100HALF
 0x2000

	)

63 
	#BMSR_100FULL
 0x4000

	)

64 
	#BMSR_100BASE4
 0x8000

	)

67 
	#ADVERTISE_SLCT
 0x001à

	)

68 
	#ADVERTISE_CSMA
 0x0001

	)

69 
	#ADVERTISE_10HALF
 0x0020

	)

70 
	#ADVERTISE_1000XFULL
 0x0020

	)

71 
	#ADVERTISE_10FULL
 0x0040

	)

72 
	#ADVERTISE_1000XHALF
 0x0040

	)

73 
	#ADVERTISE_100HALF
 0x0080

	)

74 
	#ADVERTISE_1000XPAUSE
 0x0080

	)

75 
	#ADVERTISE_100FULL
 0x0100

	)

76 
	#ADVERTISE_1000XPSE_ASYM
 0x0100

	)

77 
	#ADVERTISE_100BASE4
 0x0200

	)

78 
	#ADVERTISE_PAUSE_CAP
 0x0400

	)

79 
	#ADVERTISE_PAUSE_ASYM
 0x0800

	)

80 
	#ADVERTISE_RESV
 0x1000

	)

81 
	#ADVERTISE_RFAULT
 0x2000

	)

82 
	#ADVERTISE_LPACK
 0x4000

	)

83 
	#ADVERTISE_NPAGE
 0x8000

	)

85 
	#ADVERTISE_FULL
 (
ADVERTISE_100FULL
 | 
ADVERTISE_10FULL
 | \

86 
ADVERTISE_CSMA
)

	)

87 
	#ADVERTISE_ALL
 (
ADVERTISE_10HALF
 | 
ADVERTISE_10FULL
 | \

88 
ADVERTISE_100HALF
 | 
ADVERTISE_100FULL
)

	)

91 
	#LPA_SLCT
 0x001à

	)

92 
	#LPA_10HALF
 0x0020

	)

93 
	#LPA_1000XFULL
 0x0020

	)

94 
	#LPA_10FULL
 0x0040

	)

95 
	#LPA_1000XHALF
 0x0040

	)

96 
	#LPA_100HALF
 0x0080

	)

97 
	#LPA_1000XPAUSE
 0x0080

	)

98 
	#LPA_100FULL
 0x0100

	)

99 
	#LPA_1000XPAUSE_ASYM
 0x0100

	)

100 
	#LPA_100BASE4
 0x0200

	)

101 
	#LPA_PAUSE_CAP
 0x0400

	)

102 
	#LPA_PAUSE_ASYM
 0x0800

	)

103 
	#LPA_RESV
 0x1000

	)

104 
	#LPA_RFAULT
 0x2000

	)

105 
	#LPA_LPACK
 0x4000

	)

106 
	#LPA_NPAGE
 0x8000

	)

108 
	#LPA_DUPLEX
 (
LPA_10FULL
 | 
LPA_100FULL
)

	)

109 
	#LPA_100
 (
LPA_100FULL
 | 
LPA_100HALF
 | 
LPA_100BASE4
)

	)

112 
	#EXPANSION_NWAY
 0x0001

	)

113 
	#EXPANSION_LCWP
 0x0002

	)

114 
	#EXPANSION_ENABLENPAGE
 0x0004

	)

115 
	#EXPANSION_NPCAPABLE
 0x0008

	)

116 
	#EXPANSION_MFAULTS
 0x0010

	)

117 
	#EXPANSION_RESV
 0xfã0

	)

119 
	#ESTATUS_1000_TFULL
 0x2000

	)

120 
	#ESTATUS_1000_THALF
 0x1000

	)

123 
	#NWAYTEST_RESV1
 0x00fà

	)

124 
	#NWAYTEST_LOOPBACK
 0x0100

	)

125 
	#NWAYTEST_RESV2
 0xã00

	)

128 
	#ADVERTISE_1000FULL
 0x0200

	)

129 
	#ADVERTISE_1000HALF
 0x0100

	)

130 
	#CTL1000_AS_MASTER
 0x0800

	)

131 
	#CTL1000_ENABLE_MASTER
 0x1000

	)

134 
	#LPA_1000LOCALRXOK
 0x2000

	)

135 
	#LPA_1000REMRXOK
 0x1000

	)

136 
	#LPA_1000FULL
 0x0800

	)

137 
	#LPA_1000HALF
 0x0400

	)

140 
	#FLOW_CTRL_TX
 0x01

	)

141 
	#FLOW_CTRL_RX
 0x02

	)

144 
	smii_ioùl_d©a
 {

145 
__u16
 
	mphy_id
;

146 
__u16
 
	m»g_num
;

147 
__u16
 
	mv®_š
;

148 
__u16
 
	mv®_out
;

	@/usr/include/linux/mman.h

1 #iâdeà
_LINUX_MMAN_H


2 
	#_LINUX_MMAN_H


	)

4 
	~<asm/mmª.h
>

6 
	#MREMAP_MAYMOVE
 1

	)

7 
	#MREMAP_FIXED
 2

	)

9 
	#OVERCOMMIT_GUESS
 0

	)

10 
	#OVERCOMMIT_ALWAYS
 1

	)

11 
	#OVERCOMMIT_NEVER
 2

	)

	@/usr/include/linux/mtio.h

8 #iâdeà
_LINUX_MTIO_H


9 
	#_LINUX_MTIO_H


	)

11 
	~<lšux/ty³s.h
>

12 
	~<lšux/ioùl.h
>

19 
	smtİ
 {

20 
	mmt_İ
;

21 
	mmt_couÁ
;

25 
	#MTRESET
 0

	)

26 
	#MTFSF
 1

	)

29 
	#MTBSF
 2

	)

30 
	#MTFSR
 3

	)

31 
	#MTBSR
 4

	)

32 
	#MTWEOF
 5

	)

33 
	#MTREW
 6

	)

34 
	#MTOFFL
 7

	)

35 
	#MTNOP
 8

	)

36 
	#MTRETEN
 9

	)

37 
	#MTBSFM
 10

	)

38 
	#MTFSFM
 11

	)

39 
	#MTEOM
 12

	)

43 
	#MTERASE
 13

	)

45 
	#MTRAS1
 14

	)

46 
	#MTRAS2
 15

	)

47 
	#MTRAS3
 16

	)

49 
	#MTSETBLK
 20

	)

50 
	#MTSETDENSITY
 21

	)

51 
	#MTSEEK
 22

	)

52 
	#MTTELL
 23

	)

53 
	#MTSETDRVBUFFER
 24

	)

55 
	#MTFSS
 25

	)

56 
	#MTBSS
 26

	)

57 
	#MTWSM
 27

	)

59 
	#MTLOCK
 28

	)

60 
	#MTUNLOCK
 29

	)

61 
	#MTLOAD
 30

	)

62 
	#MTUNLOAD
 31

	)

63 
	#MTCOMPRESSION
 32

	)

64 
	#MTSETPART
 33

	)

65 
	#MTMKPART
 34

	)

66 
	#MTWEOFI
 35

	)

70 
	smtg‘
 {

71 
	mmt_ty³
;

72 
	mmt_»sid
;

78 
	mmt_d¤eg
;

79 
	mmt_g¡©
;

80 
	mmt_”»g
;

82 
__k”Ãl_daddr_t
 
	mmt_f’o
;

83 
__k”Ãl_daddr_t
 
	mmt_blkno
;

92 
	#MT_ISUNKNOWN
 0x01

	)

93 
	#MT_ISQIC02
 0x02

	)

94 
	#MT_ISWT5150
 0x03

	)

95 
	#MT_ISARCHIVE_5945L2
 0x04

	)

96 
	#MT_ISCMSJ500
 0x05

	)

97 
	#MT_ISTDC3610
 0x06

	)

98 
	#MT_ISARCHIVE_VP60I
 0x07

	)

99 
	#MT_ISARCHIVE_2150L
 0x08

	)

100 
	#MT_ISARCHIVE_2060L
 0x09

	)

101 
	#MT_ISARCHIVESC499
 0x0A

	)

102 
	#MT_ISQIC02_ALL_FEATURES
 0x0F

	)

103 
	#MT_ISWT5099EEN24
 0x11

	)

104 
	#MT_ISTEAC_MT2ST
 0x12

	)

105 
	#MT_ISEVEREX_FT40A
 0x32

	)

106 
	#MT_ISDDS1
 0x51

	)

107 
	#MT_ISDDS2
 0x52

	)

108 
	#MT_ISONSTREAM_SC
 0x61

	)

110 
	#MT_ISSCSI1
 0x71

	)

111 
	#MT_ISSCSI2
 0x72

	)

116 
	#MT_ISFTAPE_UNKNOWN
 0x800000

	)

117 
	#MT_ISFTAPE_FLAG
 0x800000

	)

122 
	smos
 {

123 
	mmt_blkno
;

128 
	#MTIOCTOP
 
	`_IOW
('m', 1, 
mtİ
è

	)

129 
	#MTIOCGET
 
	`_IOR
('m', 2, 
mtg‘
è

	)

130 
	#MTIOCPOS
 
	`_IOR
('m', 3, 
mos
è

	)

139 
	#GMT_EOF
(
x
è((xè& 0x80000000)

	)

140 
	#GMT_BOT
(
x
è((xè& 0x40000000)

	)

141 
	#GMT_EOT
(
x
è((xè& 0x20000000)

	)

142 
	#GMT_SM
(
x
è((xè& 0x10000000è

	)

143 
	#GMT_EOD
(
x
è((xè& 0x08000000è

	)

144 
	#GMT_WR_PROT
(
x
è((xè& 0x04000000)

	)

146 
	#GMT_ONLINE
(
x
è((xè& 0x01000000)

	)

147 
	#GMT_D_6250
(
x
è((xè& 0x00800000)

	)

148 
	#GMT_D_1600
(
x
è((xè& 0x00400000)

	)

149 
	#GMT_D_800
(
x
è((xè& 0x00200000)

	)

152 
	#GMT_DR_OPEN
(
x
è((xè& 0x00040000è

	)

154 
	#GMT_IM_REP_EN
(
x
è((xè& 0x00010000è

	)

155 
	#GMT_CLN
(
x
è((xè& 0x00008000è

	)

161 
	#MT_ST_BLKSIZE_SHIFT
 0

	)

162 
	#MT_ST_BLKSIZE_MASK
 0xffffff

	)

163 
	#MT_ST_DENSITY_SHIFT
 24

	)

164 
	#MT_ST_DENSITY_MASK
 0xff000000

	)

166 
	#MT_ST_SOFTERR_SHIFT
 0

	)

167 
	#MT_ST_SOFTERR_MASK
 0xffff

	)

170 
	#MT_ST_OPTIONS
 0xf0000000

	)

171 
	#MT_ST_BOOLEANS
 0x10000000

	)

172 
	#MT_ST_SETBOOLEANS
 0x30000000

	)

173 
	#MT_ST_CLEARBOOLEANS
 0x40000000

	)

174 
	#MT_ST_WRITE_THRESHOLD
 0x20000000

	)

175 
	#MT_ST_DEF_BLKSIZE
 0x50000000

	)

176 
	#MT_ST_DEF_OPTIONS
 0x60000000

	)

177 
	#MT_ST_TIMEOUTS
 0x70000000

	)

178 
	#MT_ST_SET_TIMEOUT
 (
MT_ST_TIMEOUTS
 | 0x000000)

	)

179 
	#MT_ST_SET_LONG_TIMEOUT
 (
MT_ST_TIMEOUTS
 | 0x100000)

	)

180 
	#MT_ST_SET_CLN
 0x80000000

	)

182 
	#MT_ST_BUFFER_WRITES
 0x1

	)

183 
	#MT_ST_ASYNC_WRITES
 0x2

	)

184 
	#MT_ST_READ_AHEAD
 0x4

	)

185 
	#MT_ST_DEBUGGING
 0x8

	)

186 
	#MT_ST_TWO_FM
 0x10

	)

187 
	#MT_ST_FAST_MTEOM
 0x20

	)

188 
	#MT_ST_AUTO_LOCK
 0x40

	)

189 
	#MT_ST_DEF_WRITES
 0x80

	)

190 
	#MT_ST_CAN_BSR
 0x100

	)

191 
	#MT_ST_NO_BLKLIMS
 0x200

	)

192 
	#MT_ST_CAN_PARTITIONS
 0x400

	)

193 
	#MT_ST_SCSI2LOGICAL
 0x800

	)

194 
	#MT_ST_SYSV
 0x1000

	)

195 
	#MT_ST_NOWAIT
 0x2000

	)

196 
	#MT_ST_SILI
 0x4000

	)

199 
	#MT_ST_CLEAR_DEFAULT
 0xfffff

	)

200 
	#MT_ST_DEF_DENSITY
 (
MT_ST_DEF_OPTIONS
 | 0x100000)

	)

201 
	#MT_ST_DEF_COMPRESSION
 (
MT_ST_DEF_OPTIONS
 | 0x200000)

	)

202 
	#MT_ST_DEF_DRVBUFFER
 (
MT_ST_DEF_OPTIONS
 | 0x300000)

	)

205 
	#MT_ST_HPLOADER_OFFSET
 10000

	)

	@/usr/include/linux/nbd.h

15 #iâdeà
LINUX_NBD_H


16 
	#LINUX_NBD_H


	)

18 
	~<lšux/ty³s.h
>

20 
	#NBD_SET_SOCK
 
	`_IO
Ğ0xab, 0 )

	)

21 
	#NBD_SET_BLKSIZE
 
	`_IO
Ğ0xab, 1 )

	)

22 
	#NBD_SET_SIZE
 
	`_IO
Ğ0xab, 2 )

	)

23 
	#NBD_DO_IT
 
	`_IO
Ğ0xab, 3 )

	)

24 
	#NBD_CLEAR_SOCK
 
	`_IO
Ğ0xab, 4 )

	)

25 
	#NBD_CLEAR_QUE
 
	`_IO
Ğ0xab, 5 )

	)

26 
	#NBD_PRINT_DEBUG
 
	`_IO
Ğ0xab, 6 )

	)

27 
	#NBD_SET_SIZE_BLOCKS
 
	`_IO
Ğ0xab, 7 )

	)

28 
	#NBD_DISCONNECT
 
	`_IO
Ğ0xab, 8 )

	)

29 
	#NBD_SET_TIMEOUT
 
	`_IO
Ğ0xab, 9 )

	)

32 
	mNBD_CMD_READ
 = 0,

33 
	mNBD_CMD_WRITE
 = 1,

34 
	mNBD_CMD_DISC
 = 2

37 
	#nbd_cmd
(
»q
è(Ôeq)->
cmd
[0])

	)

43 
	#NBD_REQUEST_MAGIC
 0x25609513

	)

44 
	#NBD_REPLY_MAGIC
 0x67446698

	)

51 
	snbd_»que¡
 {

52 
__be32
 
	mmagic
;

53 
__be32
 
	mty³
;

54 
	mhªdË
[8];

55 
__be64
 
	mäom
;

56 
__be32
 
	mËn
;

57 } 
__©Œibu‹__
((
·cked
));

63 
	snbd_»¶y
 {

64 
__be32
 
	mmagic
;

65 
__be32
 
	m”rÜ
;

66 
	mhªdË
[8];

	@/usr/include/linux/ncp_mount.h

8 #iâdeà
_LINUX_NCP_MOUNT_H


9 
	#_LINUX_NCP_MOUNT_H


	)

11 
	~<lšux/ty³s.h
>

12 
	~<lšux/nı.h
>

14 
	#NCP_MOUNT_VERSION
 3

	)

17 
	#NCP_MOUNT_SOFT
 0x0001

	)

18 
	#NCP_MOUNT_INTR
 0x0002

	)

19 
	#NCP_MOUNT_STRONG
 0x0004

	)

20 
	#NCP_MOUNT_NO_OS2
 0x0008

	)

21 
	#NCP_MOUNT_NO_NFS
 0x0010

	)

22 
	#NCP_MOUNT_EXTRAS
 0x0020

	)

23 
	#NCP_MOUNT_SYMLINKS
 0x0040

	)

24 
	#NCP_MOUNT_NFS_EXTRAS
 0x0080

	)

26 
	snı_mouÁ_d©a
 {

27 
	mv”siÚ
;

28 
	mnı_fd
;

29 
__k”Ãl_uid_t
 
	mmouÁed_uid
;

30 
__k”Ãl_pid_t
 
	mwdog_pid
;

32 
	mmouÁed_vŞ
[
NCP_VOLNAME_LEN
 + 1];

33 
	mtime_out
;

35 
	m»Œy_couÁ
;

36 
	mæags
;

38 
__k”Ãl_uid_t
 
	muid
;

39 
__k”Ãl_gid_t
 
	mgid
;

40 
__k”Ãl_mode_t
 
	mfe_mode
;

41 
__k”Ãl_mode_t
 
	mdœ_mode
;

44 
	#NCP_MOUNT_VERSION_V4
 (4è

	)

46 
	snı_mouÁ_d©a_v4
 {

47 
	mv”siÚ
;

48 
	mæags
;

51 
	mmouÁed_uid
;

53 
	mwdog_pid
;

55 
	mnı_fd
;

56 
	mtime_out
;

58 
	m»Œy_couÁ
;

62 
	muid
;

63 
	mgid
;

65 
	mfe_mode
;

66 
	mdœ_mode
;

69 
	#NCP_MOUNT_VERSION_V5
 (5è

	)

	@/usr/include/linux/netdevice.h

25 #iâdeà
_LINUX_NETDEVICE_H


26 
	#_LINUX_NETDEVICE_H


	)

28 
	~<lšux/if.h
>

29 
	~<lšux/if_‘h”.h
>

30 
	~<lšux/if_·ck‘.h
>

31 
	~<lšux/if_lšk.h
>

34 
	#MAX_ADDR_LEN
 32

	)

37 
	#INIT_NETDEV_GROUP
 0

	)

43 
	mIF_PORT_UNKNOWN
 = 0,

44 
	mIF_PORT_10BASE2
,

45 
	mIF_PORT_10BASET
,

46 
	mIF_PORT_AUI
,

47 
	mIF_PORT_100BASET
,

48 
	mIF_PORT_100BASETX
,

49 
	mIF_PORT_100BASEFX


	@/usr/include/linux/netlink.h

1 #iâdeà
__LINUX_NETLINK_H


2 
	#__LINUX_NETLINK_H


	)

4 
	~<lšux/sock‘.h
>

5 
	~<lšux/ty³s.h
>

7 
	#NETLINK_ROUTE
 0

	)

8 
	#NETLINK_UNUSED
 1

	)

9 
	#NETLINK_USERSOCK
 2

	)

10 
	#NETLINK_FIREWALL
 3

	)

11 
	#NETLINK_INET_DIAG
 4

	)

12 
	#NETLINK_NFLOG
 5

	)

13 
	#NETLINK_XFRM
 6

	)

14 
	#NETLINK_SELINUX
 7

	)

15 
	#NETLINK_ISCSI
 8

	)

16 
	#NETLINK_AUDIT
 9

	)

17 
	#NETLINK_FIB_LOOKUP
 10

	)

18 
	#NETLINK_CONNECTOR
 11

	)

19 
	#NETLINK_NETFILTER
 12

	)

20 
	#NETLINK_IP6_FW
 13

	)

21 
	#NETLINK_DNRTMSG
 14

	)

22 
	#NETLINK_KOBJECT_UEVENT
 15

	)

23 
	#NETLINK_GENERIC
 16

	)

25 
	#NETLINK_SCSITRANSPORT
 18

	)

26 
	#NETLINK_ECRYPTFS
 19

	)

27 
	#NETLINK_RDMA
 20

	)

28 
	#NETLINK_CRYPTO
 21

	)

30 
	#MAX_LINKS
 32

	)

32 
	ssockaddr_Æ
 {

33 
__k”Ãl_§_çmy_t
 
	mÆ_çmy
;

34 
	mÆ_·d
;

35 
__u32
 
	mÆ_pid
;

36 
__u32
 
	mÆ_groups
;

39 
	sÆmsghdr
 {

40 
__u32
 
	mÆmsg_Ën
;

41 
__u16
 
	mÆmsg_ty³
;

42 
__u16
 
	mÆmsg_æags
;

43 
__u32
 
	mÆmsg_£q
;

44 
__u32
 
	mÆmsg_pid
;

49 
	#NLM_F_REQUEST
 1

	)

50 
	#NLM_F_MULTI
 2

	)

51 
	#NLM_F_ACK
 4

	)

52 
	#NLM_F_ECHO
 8

	)

53 
	#NLM_F_DUMP_INTR
 16

	)

56 
	#NLM_F_ROOT
 0x100

	)

57 
	#NLM_F_MATCH
 0x200

	)

58 
	#NLM_F_ATOMIC
 0x400

	)

59 
	#NLM_F_DUMP
 (
NLM_F_ROOT
|
NLM_F_MATCH
)

	)

62 
	#NLM_F_REPLACE
 0x100

	)

63 
	#NLM_F_EXCL
 0x200

	)

64 
	#NLM_F_CREATE
 0x400

	)

65 
	#NLM_F_APPEND
 0x800

	)

76 
	#NLMSG_ALIGNTO
 4U

	)

77 
	#NLMSG_ALIGN
(
Ën
èĞ(Ö’)+
NLMSG_ALIGNTO
-1è& ~(NLMSG_ALIGNTO-1è)

	)

78 
	#NLMSG_HDRLEN
 ((è
	`NLMSG_ALIGN
((
Æmsghdr
)))

	)

79 
	#NLMSG_LENGTH
(
Ën
è(Ö’)+
	`NLMSG_ALIGN
(
NLMSG_HDRLEN
))

	)

80 
	#NLMSG_SPACE
(
Ën
è
	`NLMSG_ALIGN
(
	`NLMSG_LENGTH
Ö’))

	)

81 
	#NLMSG_DATA
(
Æh
è((*)(((*êlhè+ 
	`NLMSG_LENGTH
(0)))

	)

82 
	#NLMSG_NEXT
(
Æh
,
Ën
è(Ö’è-ğ
	`NLMSG_ALIGN
(Òlh)->
Æmsg_Ën
), \

83 (
Æmsghdr
*)(((*)(
Æh
)è+ 
	`NLMSG_ALIGN
(Òlh)->
Æmsg_Ën
)))

	)

84 
	#NLMSG_OK
(
Æh
,
Ën
è(Ö’è>ğ()(
Æmsghdr
) && \

85 (
Æh
)->
Æmsg_Ën
 >ğ(
Æmsghdr
) && \

86 (
Æh
)->
Æmsg_Ën
 <ğ(
Ën
))

	)

87 
	#NLMSG_PAYLOAD
(
Æh
,
Ën
è(Òlh)->
Æmsg_Ën
 - 
	`NLMSG_SPACE
(Ö’)))

	)

89 
	#NLMSG_NOOP
 0x1

	)

90 
	#NLMSG_ERROR
 0x2

	)

91 
	#NLMSG_DONE
 0x3

	)

92 
	#NLMSG_OVERRUN
 0x4

	)

94 
	#NLMSG_MIN_TYPE
 0x10

	)

96 
	sÆmsg”r
 {

97 
	m”rÜ
;

98 
Æmsghdr
 
	mmsg
;

101 
	#NETLINK_ADD_MEMBERSHIP
 1

	)

102 
	#NETLINK_DROP_MEMBERSHIP
 2

	)

103 
	#NETLINK_PKTINFO
 3

	)

104 
	#NETLINK_BROADCAST_ERROR
 4

	)

105 
	#NETLINK_NO_ENOBUFS
 5

	)

107 
	sÆ_pktšfo
 {

108 
__u32
 
	mgroup
;

111 
	#NET_MAJOR
 36

	)

114 
	mNETLINK_UNCONNECTED
 = 0,

115 
	mNETLINK_CONNECTED
,

127 
	sÆ©Œ
 {

128 
__u16
 
	mÆa_Ën
;

129 
__u16
 
	mÆa_ty³
;

142 
	#NLA_F_NESTED
 (1 << 15)

	)

143 
	#NLA_F_NET_BYTEORDER
 (1 << 14)

	)

144 
	#NLA_TYPE_MASK
 ~(
NLA_F_NESTED
 | 
NLA_F_NET_BYTEORDER
)

	)

146 
	#NLA_ALIGNTO
 4

	)

147 
	#NLA_ALIGN
(
Ën
è((Ö’è+ 
NLA_ALIGNTO
 - 1è& ~(NLA_ALIGNTO - 1))

	)

148 
	#NLA_HDRLEN
 ((è
	`NLA_ALIGN
((
Æ©Œ
)))

	)

	@/usr/include/linux/nfs4_mount.h

1 #iâdeà
_LINUX_NFS4_MOUNT_H


2 
	#_LINUX_NFS4_MOUNT_H


	)

19 
	#NFS4_MOUNT_VERSION
 1

	)

21 
	snfs_¡ršg
 {

22 
	mËn
;

23 cÚ¡ * 
	md©a
;

26 
	snfs4_mouÁ_d©a
 {

27 
	mv”siÚ
;

28 
	mæags
;

29 
	mrsize
;

30 
	mwsize
;

31 
	mtimeo
;

32 
	m»Œªs
;

33 
	maüegmš
;

34 
	maüegmax
;

35 
	macdœmš
;

36 
	macdœmax
;

39 
nfs_¡ršg
 
	mş›Á_addr
;

42 
nfs_¡ršg
 
	mmÁ_·th
;

45 
nfs_¡ršg
 
	mho¡Çme
;

47 
	mho¡_add¾’
;

48 
sockaddr
 * 
	mho¡_addr
;

51 
	m´Ùo
;

54 
	mauth_æavou¾’
;

55 *
	mauth_æavours
;

63 
	#NFS4_MOUNT_SOFT
 0x0001

	)

64 
	#NFS4_MOUNT_INTR
 0x0002

	)

65 
	#NFS4_MOUNT_NOCTO
 0x0010

	)

66 
	#NFS4_MOUNT_NOAC
 0x0020

	)

67 
	#NFS4_MOUNT_STRICTLOCK
 0x1000

	)

68 
	#NFS4_MOUNT_UNSHARED
 0x8000

	)

69 
	#NFS4_MOUNT_FLAGMASK
 0x9033

	)

	@/usr/include/linux/oom.h

1 #iâdeà
__INCLUDE_LINUX_OOM_H


2 
	#__INCLUDE_LINUX_OOM_H


	)

10 
	#OOM_DISABLE
 (-17)

	)

12 
	#OOM_ADJUST_MIN
 (-16)

	)

13 
	#OOM_ADJUST_MAX
 15

	)

19 
	#OOM_SCORE_ADJ_MIN
 (-1000)

	)

20 
	#OOM_SCORE_ADJ_MAX
 1000

	)

	@/usr/include/linux/pci.h

17 #iâdeà
LINUX_PCI_H


18 
	#LINUX_PCI_H


	)

20 
	~<lšux/pci_»gs.h
>

30 
	#PCI_DEVFN
(
¦Ù
, 
func
è((((¦Ùè& 0x1fè<< 3è| ((funcè& 0x07))

	)

31 
	#PCI_SLOT
(
devâ
è(((devâè>> 3è& 0x1f)

	)

32 
	#PCI_FUNC
(
devâ
è((devâè& 0x07)

	)

35 
	#PCIIOC_BASE
 ('P' << 24 | 'C' << 16 | 'I' << 8)

	)

36 
	#PCIIOC_CONTROLLER
 (
PCIIOC_BASE
 | 0x00è

	)

37 
	#PCIIOC_MMAP_IS_IO
 (
PCIIOC_BASE
 | 0x01è

	)

38 
	#PCIIOC_MMAP_IS_MEM
 (
PCIIOC_BASE
 | 0x02è

	)

39 
	#PCIIOC_WRITE_COMBINE
 (
PCIIOC_BASE
 | 0x03è

	)

	@/usr/include/linux/perf_event.h

14 #iâdeà
_LINUX_PERF_EVENT_H


15 
	#_LINUX_PERF_EVENT_H


	)

17 
	~<lšux/ty³s.h
>

18 
	~<lšux/ioùl.h
>

19 
	~<asm/by‹Üd”.h
>

28 
	e³rf_ty³_id
 {

29 
	mPERF_TYPE_HARDWARE
 = 0,

30 
	mPERF_TYPE_SOFTWARE
 = 1,

31 
	mPERF_TYPE_TRACEPOINT
 = 2,

32 
	mPERF_TYPE_HW_CACHE
 = 3,

33 
	mPERF_TYPE_RAW
 = 4,

34 
	mPERF_TYPE_BREAKPOINT
 = 5,

36 
	mPERF_TYPE_MAX
,

44 
	e³rf_hw_id
 {

48 
	mPERF_COUNT_HW_CPU_CYCLES
 = 0,

49 
	mPERF_COUNT_HW_INSTRUCTIONS
 = 1,

50 
	mPERF_COUNT_HW_CACHE_REFERENCES
 = 2,

51 
	mPERF_COUNT_HW_CACHE_MISSES
 = 3,

52 
	mPERF_COUNT_HW_BRANCH_INSTRUCTIONS
 = 4,

53 
	mPERF_COUNT_HW_BRANCH_MISSES
 = 5,

54 
	mPERF_COUNT_HW_BUS_CYCLES
 = 6,

55 
	mPERF_COUNT_HW_STALLED_CYCLES_FRONTEND
 = 7,

56 
	mPERF_COUNT_HW_STALLED_CYCLES_BACKEND
 = 8,

58 
	mPERF_COUNT_HW_MAX
,

68 
	e³rf_hw_ÿche_id
 {

69 
	mPERF_COUNT_HW_CACHE_L1D
 = 0,

70 
	mPERF_COUNT_HW_CACHE_L1I
 = 1,

71 
	mPERF_COUNT_HW_CACHE_LL
 = 2,

72 
	mPERF_COUNT_HW_CACHE_DTLB
 = 3,

73 
	mPERF_COUNT_HW_CACHE_ITLB
 = 4,

74 
	mPERF_COUNT_HW_CACHE_BPU
 = 5,

75 
	mPERF_COUNT_HW_CACHE_NODE
 = 6,

77 
	mPERF_COUNT_HW_CACHE_MAX
,

80 
	e³rf_hw_ÿche_İ_id
 {

81 
	mPERF_COUNT_HW_CACHE_OP_READ
 = 0,

82 
	mPERF_COUNT_HW_CACHE_OP_WRITE
 = 1,

83 
	mPERF_COUNT_HW_CACHE_OP_PREFETCH
 = 2,

85 
	mPERF_COUNT_HW_CACHE_OP_MAX
,

88 
	e³rf_hw_ÿche_İ_»suÉ_id
 {

89 
	mPERF_COUNT_HW_CACHE_RESULT_ACCESS
 = 0,

90 
	mPERF_COUNT_HW_CACHE_RESULT_MISS
 = 1,

92 
	mPERF_COUNT_HW_CACHE_RESULT_MAX
,

101 
	e³rf_sw_ids
 {

102 
	mPERF_COUNT_SW_CPU_CLOCK
 = 0,

103 
	mPERF_COUNT_SW_TASK_CLOCK
 = 1,

104 
	mPERF_COUNT_SW_PAGE_FAULTS
 = 2,

105 
	mPERF_COUNT_SW_CONTEXT_SWITCHES
 = 3,

106 
	mPERF_COUNT_SW_CPU_MIGRATIONS
 = 4,

107 
	mPERF_COUNT_SW_PAGE_FAULTS_MIN
 = 5,

108 
	mPERF_COUNT_SW_PAGE_FAULTS_MAJ
 = 6,

109 
	mPERF_COUNT_SW_ALIGNMENT_FAULTS
 = 7,

110 
	mPERF_COUNT_SW_EMULATION_FAULTS
 = 8,

112 
	mPERF_COUNT_SW_MAX
,

119 
	e³rf_ev’t_§m¶e_fÜm©
 {

120 
	mPERF_SAMPLE_IP
 = 1U << 0,

121 
	mPERF_SAMPLE_TID
 = 1U << 1,

122 
	mPERF_SAMPLE_TIME
 = 1U << 2,

123 
	mPERF_SAMPLE_ADDR
 = 1U << 3,

124 
	mPERF_SAMPLE_READ
 = 1U << 4,

125 
	mPERF_SAMPLE_CALLCHAIN
 = 1U << 5,

126 
	mPERF_SAMPLE_ID
 = 1U << 6,

127 
	mPERF_SAMPLE_CPU
 = 1U << 7,

128 
	mPERF_SAMPLE_PERIOD
 = 1U << 8,

129 
	mPERF_SAMPLE_STREAM_ID
 = 1U << 9,

130 
	mPERF_SAMPLE_RAW
 = 1U << 10,

132 
	mPERF_SAMPLE_MAX
 = 1U << 11,

155 
	e³rf_ev’t_»ad_fÜm©
 {

156 
	mPERF_FORMAT_TOTAL_TIME_ENABLED
 = 1U << 0,

157 
	mPERF_FORMAT_TOTAL_TIME_RUNNING
 = 1U << 1,

158 
	mPERF_FORMAT_ID
 = 1U << 2,

159 
	mPERF_FORMAT_GROUP
 = 1U << 3,

161 
	mPERF_FORMAT_MAX
 = 1U << 4,

164 
	#PERF_ATTR_SIZE_VER0
 64

	)

169 
	s³rf_ev’t_©Œ
 {

174 
__u32
 
	mty³
;

179 
__u32
 
	msize
;

184 
__u64
 
	mcÚfig
;

187 
__u64
 
	m§m¶e_³riod
;

188 
__u64
 
	m§m¶e_äeq
;

191 
__u64
 
	m§m¶e_ty³
;

192 
__u64
 
	m»ad_fÜm©
;

194 
__u64
 
	mdi§bËd
 : 1,

195 
	mšh”™
 : 1,

196 
	mpšÃd
 : 1,

197 
	mexşusive
 : 1,

198 
	mexşude_u£r
 : 1,

199 
	mexşude_k”Ãl
 : 1,

200 
	mexşude_hv
 : 1,

201 
	mexşude_idË
 : 1,

202 
	mmm­
 : 1,

203 
	mcomm
 : 1,

204 
	mäeq
 : 1,

205 
	mšh”™_¡©
 : 1,

206 
	m’abË_Ú_exec
 : 1,

207 
	msk
 : 1,

208 
	mw©”m¬k
 : 1,

219 
	m´eci£_
 : 2,

220 
	mmm­_d©a
 : 1,

221 
	m§m¶e_id_®l
 : 1,

223 
	mexşude_ho¡
 : 1,

224 
	mexşude_gue¡
 : 1,

226 
	m__»£rved_1
 : 43;

229 
__u32
 
	mwakeup_ev’ts
;

230 
__u32
 
	mwakeup_w©”m¬k
;

233 
__u32
 
	mbp_ty³
;

235 
__u64
 
	mbp_addr
;

236 
__u64
 
	mcÚfig1
;

239 
__u64
 
	mbp_Ën
;

240 
__u64
 
	mcÚfig2
;

247 
	#PERF_EVENT_IOC_ENABLE
 
	`_IO
 ('$', 0)

	)

248 
	#PERF_EVENT_IOC_DISABLE
 
	`_IO
 ('$', 1)

	)

249 
	#PERF_EVENT_IOC_REFRESH
 
	`_IO
 ('$', 2)

	)

250 
	#PERF_EVENT_IOC_RESET
 
	`_IO
 ('$', 3)

	)

251 
	#PERF_EVENT_IOC_PERIOD
 
	`_IOW
('$', 4, 
__u64
)

	)

252 
	#PERF_EVENT_IOC_SET_OUTPUT
 
	`_IO
 ('$', 5)

	)

253 
	#PERF_EVENT_IOC_SET_FILTER
 
	`_IOW
('$', 6, *)

	)

255 
	e³rf_ev’t_ioc_æags
 {

256 
	mPERF_IOC_FLAG_GROUP
 = 1U << 0,

262 
	s³rf_ev’t_mm­_·ge
 {

263 
__u32
 
	mv”siÚ
;

264 
__u32
 
	mcom·t_v”siÚ
;

288 
__u32
 
	mlock
;

289 
__u32
 
	mšdex
;

290 
__s64
 
	moff£t
;

291 
__u64
 
	mtime_’abËd
;

292 
__u64
 
	mtime_ruÂšg
;

298 
__u64
 
	m__»£rved
[123];

311 
__u64
 
	md©a_h—d
;

312 
__u64
 
	md©a_
;

315 
	#PERF_RECORD_MISC_CPUMODE_MASK
 (7 << 0)

	)

316 
	#PERF_RECORD_MISC_CPUMODE_UNKNOWN
 (0 << 0)

	)

317 
	#PERF_RECORD_MISC_KERNEL
 (1 << 0)

	)

318 
	#PERF_RECORD_MISC_USER
 (2 << 0)

	)

319 
	#PERF_RECORD_MISC_HYPERVISOR
 (3 << 0)

	)

320 
	#PERF_RECORD_MISC_GUEST_KERNEL
 (4 << 0)

	)

321 
	#PERF_RECORD_MISC_GUEST_USER
 (5 << 0)

	)

328 
	#PERF_RECORD_MISC_EXACT_IP
 (1 << 14)

	)

332 
	#PERF_RECORD_MISC_EXT_RESERVED
 (1 << 15)

	)

334 
	s³rf_ev’t_h—d”
 {

335 
__u32
 
	mty³
;

336 
__u16
 
	mmisc
;

337 
__u16
 
	msize
;

340 
	e³rf_ev’t_ty³
 {

365 
	mPERF_RECORD_MMAP
 = 1,

374 
	mPERF_RECORD_LOST
 = 2,

384 
	mPERF_RECORD_COMM
 = 3,

394 
	mPERF_RECORD_EXIT
 = 4,

404 
	mPERF_RECORD_THROTTLE
 = 5,

405 
	mPERF_RECORD_UNTHROTTLE
 = 6,

415 
	mPERF_RECORD_FORK
 = 7,

425 
	mPERF_RECORD_READ
 = 8,

460 
	mPERF_RECORD_SAMPLE
 = 9,

462 
	mPERF_RECORD_MAX
,

465 
	e³rf_ÿÎchaš_cÚ‹xt
 {

466 
	mPERF_CONTEXT_HV
 = (
__u64
)-32,

467 
	mPERF_CONTEXT_KERNEL
 = (
__u64
)-128,

468 
	mPERF_CONTEXT_USER
 = (
__u64
)-512,

470 
	mPERF_CONTEXT_GUEST
 = (
__u64
)-2048,

471 
	mPERF_CONTEXT_GUEST_KERNEL
 = (
__u64
)-2176,

472 
	mPERF_CONTEXT_GUEST_USER
 = (
__u64
)-2560,

474 
	mPERF_CONTEXT_MAX
 = (
__u64
)-4095,

477 
	#PERF_FLAG_FD_NO_GROUP
 (1U << 0)

	)

478 
	#PERF_FLAG_FD_OUTPUT
 (1U << 1)

	)

479 
	#PERF_FLAG_PID_CGROUP
 (1U << 2è

	)

	@/usr/include/linux/personality.h

1 #iâdeà
_LINUX_PERSONALITY_H


2 
	#_LINUX_PERSONALITY_H


	)

11 
	mUNAME26
 = 0x0020000,

12 
	mADDR_NO_RANDOMIZE
 = 0x0040000,

13 
	mFDPIC_FUNCPTRS
 = 0x0080000,

16 
	mMMAP_PAGE_ZERO
 = 0x0100000,

17 
	mADDR_COMPAT_LAYOUT
 = 0x0200000,

18 
	mREAD_IMPLIES_EXEC
 = 0x0400000,

19 
	mADDR_LIMIT_32BIT
 = 0x0800000,

20 
	mSHORT_INODE
 = 0x1000000,

21 
	mWHOLE_SECONDS
 = 0x2000000,

22 
	mSTICKY_TIMEOUTS
 = 0x4000000,

23 
	mADDR_LIMIT_3GB
 = 0x8000000,

30 
	#PER_CLEAR_ON_SETID
 (
READ_IMPLIES_EXEC
 | \

31 
ADDR_NO_RANDOMIZE
 | \

32 
ADDR_COMPAT_LAYOUT
 | \

33 
MMAP_PAGE_ZERO
)

	)

42 
	mPER_LINUX
 = 0x0000,

43 
	mPER_LINUX_32BIT
 = 0x0000 | 
ADDR_LIMIT_32BIT
,

44 
	mPER_LINUX_FDPIC
 = 0x0000 | 
FDPIC_FUNCPTRS
,

45 
	mPER_SVR4
 = 0x0001 | 
STICKY_TIMEOUTS
 | 
MMAP_PAGE_ZERO
,

46 
	mPER_SVR3
 = 0x0002 | 
STICKY_TIMEOUTS
 | 
SHORT_INODE
,

47 
	mPER_SCOSVR3
 = 0x0003 | 
STICKY_TIMEOUTS
 |

48 
WHOLE_SECONDS
 | 
SHORT_INODE
,

49 
	mPER_OSR5
 = 0x0003 | 
STICKY_TIMEOUTS
 | 
WHOLE_SECONDS
,

50 
	mPER_WYSEV386
 = 0x0004 | 
STICKY_TIMEOUTS
 | 
SHORT_INODE
,

51 
	mPER_ISCR4
 = 0x0005 | 
STICKY_TIMEOUTS
,

52 
	mPER_BSD
 = 0x0006,

53 
	mPER_SUNOS
 = 0x0006 | 
STICKY_TIMEOUTS
,

54 
	mPER_XENIX
 = 0x0007 | 
STICKY_TIMEOUTS
 | 
SHORT_INODE
,

55 
	mPER_LINUX32
 = 0x0008,

56 
	mPER_LINUX32_3GB
 = 0x0008 | 
ADDR_LIMIT_3GB
,

57 
	mPER_IRIX32
 = 0x0009 | 
STICKY_TIMEOUTS
,

58 
	mPER_IRIXN32
 = 0x000¨| 
STICKY_TIMEOUTS
,

59 
	mPER_IRIX64
 = 0x000b | 
STICKY_TIMEOUTS
,

60 
	mPER_RISCOS
 = 0x000c,

61 
	mPER_SOLARIS
 = 0x000d | 
STICKY_TIMEOUTS
,

62 
	mPER_UW7
 = 0x000| 
STICKY_TIMEOUTS
 | 
MMAP_PAGE_ZERO
,

63 
	mPER_OSF4
 = 0x000f,

64 
	mPER_HPUX
 = 0x0010,

65 
	mPER_MASK
 = 0x00ff,

	@/usr/include/linux/poll.h

1 #iâdeà
_LINUX_POLL_H


2 
	#_LINUX_POLL_H


	)

4 
	~<asm/pŞl.h
>

	@/usr/include/linux/ppdev.h

17 
	#PP_IOCTL
 'p'

	)

20 
	#PPSETMODE
 
	`_IOW
(
PP_IOCTL
, 0x80, )

	)

23 
	#PPRSTATUS
 
	`_IOR
(
PP_IOCTL
, 0x81, )

	)

24 
	#PPWSTATUS
 
	`OBSOLETE__IOW
(
PP_IOCTL
, 0x82, )

	)

27 
	#PPRCONTROL
 
	`_IOR
(
PP_IOCTL
, 0x83, )

	)

28 
	#PPWCONTROL
 
	`_IOW
(
PP_IOCTL
, 0x84, )

	)

30 
	sµdev_äob_¡ruù
 {

31 
	mmask
;

32 
	mv®
;

34 
	#PPFCONTROL
 
	`_IOW
(
PP_IOCTL
, 0x8e, 
µdev_äob_¡ruù
)

	)

37 
	#PPRDATA
 
	`_IOR
(
PP_IOCTL
, 0x85, )

	)

38 
	#PPWDATA
 
	`_IOW
(
PP_IOCTL
, 0x86, )

	)

41 
	#PPRECONTROL
 
	`OBSOLETE__IOR
(
PP_IOCTL
, 0x87, )

	)

42 
	#PPWECONTROL
 
	`OBSOLETE__IOW
(
PP_IOCTL
, 0x88, )

	)

45 
	#PPRFIFO
 
	`OBSOLETE__IOR
(
PP_IOCTL
, 0x89, )

	)

46 
	#PPWFIFO
 
	`OBSOLETE__IOW
(
PP_IOCTL
, 0x8a, )

	)

49 
	#PPCLAIM
 
	`_IO
(
PP_IOCTL
, 0x8b)

	)

52 
	#PPRELEASE
 
	`_IO
(
PP_IOCTL
, 0x8c)

	)

56 
	#PPYIELD
 
	`_IO
(
PP_IOCTL
, 0x8d)

	)

59 
	#PPEXCL
 
	`_IO
(
PP_IOCTL
, 0x8f)

	)

62 
	#PPDATADIR
 
	`_IOW
(
PP_IOCTL
, 0x90, )

	)

65 
	#PPNEGOT
 
	`_IOW
(
PP_IOCTL
, 0x91, )

	)

68 
	#PPWCTLONIRQ
 
	`_IOW
(
PP_IOCTL
, 0x92, )

	)

71 
	#PPCLRIRQ
 
	`_IOR
(
PP_IOCTL
, 0x93, )

	)

74 
	#PPSETPHASE
 
	`_IOW
(
PP_IOCTL
, 0x94, )

	)

77 
	#PPGETTIME
 
	`_IOR
(
PP_IOCTL
, 0x95, 
timev®
)

	)

78 
	#PPSETTIME
 
	`_IOW
(
PP_IOCTL
, 0x96, 
timev®
)

	)

81 
	#PPGETMODES
 
	`_IOR
(
PP_IOCTL
, 0x97, )

	)

84 
	#PPGETMODE
 
	`_IOR
(
PP_IOCTL
, 0x98, )

	)

85 
	#PPGETPHASE
 
	`_IOR
(
PP_IOCTL
, 0x99, )

	)

88 
	#PPGETFLAGS
 
	`_IOR
(
PP_IOCTL
, 0x9a, )

	)

89 
	#PPSETFLAGS
 
	`_IOW
(
PP_IOCTL
, 0x9b, )

	)

92 
	#PP_FASTWRITE
 (1<<2)

	)

93 
	#PP_FASTREAD
 (1<<3)

	)

94 
	#PP_W91284PIC
 (1<<4)

	)

97 
	#PP_FLAGMASK
 (
PP_FASTWRITE
 | 
PP_FASTREAD
 | 
PP_W91284PIC
)

	)

	@/usr/include/linux/ppp_defs.h

28 
	~<lšux/ty³s.h
>

42 #iâdeà
_PPP_DEFS_H_


43 
	#_PPP_DEFS_H_


	)

48 
	#PPP_HDRLEN
 4

	)

49 
	#PPP_FCSLEN
 2

	)

50 
	#PPP_MRU
 1500

	)

52 
	#PPP_ADDRESS
(
p
è(((
__u8
 *)Õ))[0])

	)

53 
	#PPP_CONTROL
(
p
è(((
__u8
 *)Õ))[1])

	)

54 
	#PPP_PROTOCOL
(
p
è((((
__u8
 *)Õ))[2] << 8è+ ((__u8 *)Õ))[3])

	)

59 
	#PPP_ALLSTATIONS
 0xfà

	)

60 
	#PPP_UI
 0x03

	)

61 
	#PPP_FLAG
 0x7

	)

62 
	#PPP_ESCAPE
 0x7d

	)

63 
	#PPP_TRANS
 0x20

	)

68 
	#PPP_IP
 0x21

	)

69 
	#PPP_AT
 0x29

	)

70 
	#PPP_IPX
 0x2b

	)

71 
	#PPP_VJC_COMP
 0x2d

	)

72 
	#PPP_VJC_UNCOMP
 0x2à

	)

73 
	#PPP_MP
 0x3d

	)

74 
	#PPP_IPV6
 0x57

	)

75 
	#PPP_COMPFRAG
 0xfb

	)

76 
	#PPP_COMP
 0xfd

	)

77 
	#PPP_MPLS_UC
 0x0281

	)

78 
	#PPP_MPLS_MC
 0x0283

	)

79 
	#PPP_IPCP
 0x8021

	)

80 
	#PPP_ATCP
 0x8029

	)

81 
	#PPP_IPXCP
 0x802b

	)

82 
	#PPP_IPV6CP
 0x8057

	)

83 
	#PPP_CCPFRAG
 0x80fb

	)

84 
	#PPP_CCP
 0x80fd

	)

85 
	#PPP_MPLSCP
 0x80fd

	)

86 
	#PPP_LCP
 0xc021

	)

87 
	#PPP_PAP
 0xc023

	)

88 
	#PPP_LQR
 0xc025

	)

89 
	#PPP_CHAP
 0xc223

	)

90 
	#PPP_CBCP
 0xc029

	)

96 
	#PPP_INITFCS
 0xfffà

	)

97 
	#PPP_GOODFCS
 0xf0b8

	)

104 
__u32
 
	text_accm
[8];

109 
	eNPmode
 {

110 
	mNPMODE_PASS
,

111 
	mNPMODE_DROP
,

112 
	mNPMODE_ERROR
,

113 
	mNPMODE_QUEUE


119 
	sµp¡©
 {

120 
__u32
 
	mµp_disÿrds
;

122 
__u32
 
	mµp_iby‹s
;

123 
__u32
 
	mµp_ioùeùs
;

124 
__u32
 
	mµp_ack‘s
;

125 
__u32
 
	mµp_›¼Üs
;

126 
__u32
 
	mµp_qrs
;

128 
__u32
 
	mµp_oby‹s
;

129 
__u32
 
	mµp_ooùeùs
;

130 
__u32
 
	mµp_İack‘s
;

131 
__u32
 
	mµp_Û¼Üs
;

132 
__u32
 
	mµp_Şqrs
;

135 
	svj¡©
 {

136 
__u32
 
	mvjs_·ck‘s
;

137 
__u32
 
	mvjs_com´es£d
;

138 
__u32
 
	mvjs_£¬ches
;

139 
__u32
 
	mvjs_mis£s
;

140 
__u32
 
	mvjs_uncom´es£dš
;

141 
__u32
 
	mvjs_com´es£dš
;

142 
__u32
 
	mvjs_”rÜš
;

143 
__u32
 
	mvjs_tos£d
;

146 
	scomp¡©
 {

147 
__u32
 
	munc_by‹s
;

148 
__u32
 
	munc_·ck‘s
;

149 
__u32
 
	mcomp_by‹s
;

150 
__u32
 
	mcomp_·ck‘s
;

151 
__u32
 
	mšc_by‹s
;

152 
__u32
 
	mšc_·ck‘s
;

155 
__u32
 
	mš_couÁ
;

156 
__u32
 
	mby‹s_out
;

158 
	m¿tio
;

161 
	sµp_¡©s
 {

162 
µp¡©
 
	mp
;

163 
vj¡©
 
	mvj
;

166 
	sµp_comp_¡©s
 {

167 
comp¡©
 
	mc
;

168 
comp¡©
 
	md
;

175 
	sµp_idË
 {

176 
__k”Ãl_time_t
 
	mxm™_idË
;

177 
__k”Ãl_time_t
 
	m»cv_idË
;

	@/usr/include/linux/ptrace.h

1 #iâdeà
_LINUX_PTRACE_H


2 
	#_LINUX_PTRACE_H


	)

8 
	#PTRACE_TRACEME
 0

	)

9 
	#PTRACE_PEEKTEXT
 1

	)

10 
	#PTRACE_PEEKDATA
 2

	)

11 
	#PTRACE_PEEKUSR
 3

	)

12 
	#PTRACE_POKETEXT
 4

	)

13 
	#PTRACE_POKEDATA
 5

	)

14 
	#PTRACE_POKEUSR
 6

	)

15 
	#PTRACE_CONT
 7

	)

16 
	#PTRACE_KILL
 8

	)

17 
	#PTRACE_SINGLESTEP
 9

	)

19 
	#PTRACE_ATTACH
 16

	)

20 
	#PTRACE_DETACH
 17

	)

22 
	#PTRACE_SYSCALL
 24

	)

25 
	#PTRACE_SETOPTIONS
 0x4200

	)

26 
	#PTRACE_GETEVENTMSG
 0x4201

	)

27 
	#PTRACE_GETSIGINFO
 0x4202

	)

28 
	#PTRACE_SETSIGINFO
 0x4203

	)

47 
	#PTRACE_GETREGSET
 0x4204

	)

48 
	#PTRACE_SETREGSET
 0x4205

	)

50 
	#PTRACE_SEIZE
 0x4206

	)

51 
	#PTRACE_INTERRUPT
 0x4207

	)

52 
	#PTRACE_LISTEN
 0x4208

	)

55 
	#PTRACE_SEIZE_DEVEL
 0x80000000

	)

58 
	#PTRACE_O_TRACESYSGOOD
 0x00000001

	)

59 
	#PTRACE_O_TRACEFORK
 0x00000002

	)

60 
	#PTRACE_O_TRACEVFORK
 0x00000004

	)

61 
	#PTRACE_O_TRACECLONE
 0x00000008

	)

62 
	#PTRACE_O_TRACEEXEC
 0x00000010

	)

63 
	#PTRACE_O_TRACEVFORKDONE
 0x00000020

	)

64 
	#PTRACE_O_TRACEEXIT
 0x00000040

	)

65 
	#PTRACE_O_TRACESECCOMP
 0x00000080

	)

67 
	#PTRACE_O_MASK
 0x000000ff

	)

70 
	#PTRACE_EVENT_FORK
 1

	)

71 
	#PTRACE_EVENT_VFORK
 2

	)

72 
	#PTRACE_EVENT_CLONE
 3

	)

73 
	#PTRACE_EVENT_EXEC
 4

	)

74 
	#PTRACE_EVENT_VFORK_DONE
 5

	)

75 
	#PTRACE_EVENT_EXIT
 6

	)

76 
	#PTRACE_EVENT_STOP
 7

	)

77 
	#PTRACE_EVENT_SECCOMP
 8

	)

79 
	~<asm/±¿û.h
>

	@/usr/include/linux/raid/md_u.h

15 #iâdeà
_MD_U_H


16 
	#_MD_U_H


	)

23 
	#MD_MAJOR_VERSION
 0

	)

24 
	#MD_MINOR_VERSION
 90

	)

34 
	#MD_PATCHLEVEL_VERSION
 3

	)

39 
	#RAID_VERSION
 
	`_IOR
 (
MD_MAJOR
, 0x10, 
mdu_v”siÚ_t
)

	)

40 
	#GET_ARRAY_INFO
 
	`_IOR
 (
MD_MAJOR
, 0x11, 
mdu_¬¿y_šfo_t
)

	)

41 
	#GET_DISK_INFO
 
	`_IOR
 (
MD_MAJOR
, 0x12, 
mdu_disk_šfo_t
)

	)

42 
	#PRINT_RAID_DEBUG
 
	`_IO
 (
MD_MAJOR
, 0x13)

	)

43 
	#RAID_AUTORUN
 
	`_IO
 (
MD_MAJOR
, 0x14)

	)

44 
	#GET_BITMAP_FILE
 
	`_IOR
 (
MD_MAJOR
, 0x15, 
mdu_b™m­_fe_t
)

	)

47 
	#CLEAR_ARRAY
 
	`_IO
 (
MD_MAJOR
, 0x20)

	)

48 
	#ADD_NEW_DISK
 
	`_IOW
 (
MD_MAJOR
, 0x21, 
mdu_disk_šfo_t
)

	)

49 
	#HOT_REMOVE_DISK
 
	`_IO
 (
MD_MAJOR
, 0x22)

	)

50 
	#SET_ARRAY_INFO
 
	`_IOW
 (
MD_MAJOR
, 0x23, 
mdu_¬¿y_šfo_t
)

	)

51 
	#SET_DISK_INFO
 
	`_IO
 (
MD_MAJOR
, 0x24)

	)

52 
	#WRITE_RAID_INFO
 
	`_IO
 (
MD_MAJOR
, 0x25)

	)

53 
	#UNPROTECT_ARRAY
 
	`_IO
 (
MD_MAJOR
, 0x26)

	)

54 
	#PROTECT_ARRAY
 
	`_IO
 (
MD_MAJOR
, 0x27)

	)

55 
	#HOT_ADD_DISK
 
	`_IO
 (
MD_MAJOR
, 0x28)

	)

56 
	#SET_DISK_FAULTY
 
	`_IO
 (
MD_MAJOR
, 0x29)

	)

57 
	#HOT_GENERATE_ERROR
 
	`_IO
 (
MD_MAJOR
, 0x2a)

	)

58 
	#SET_BITMAP_FILE
 
	`_IOW
 (
MD_MAJOR
, 0x2b, )

	)

61 
	#RUN_ARRAY
 
	`_IOW
 (
MD_MAJOR
, 0x30, 
mdu_·¿m_t
)

	)

63 
	#STOP_ARRAY
 
	`_IO
 (
MD_MAJOR
, 0x32)

	)

64 
	#STOP_ARRAY_RO
 
	`_IO
 (
MD_MAJOR
, 0x33)

	)

65 
	#RESTART_ARRAY_RW
 
	`_IO
 (
MD_MAJOR
, 0x34)

	)

68 
	#MdpMšÜShiá
 6

	)

70 
	smdu_v”siÚ_s
 {

71 
	mmajÜ
;

72 
	mmšÜ
;

73 
	m·tchËv–
;

74 } 
	tmdu_v”siÚ_t
;

76 
	smdu_¬¿y_šfo_s
 {

80 
	mmajÜ_v”siÚ
;

81 
	mmšÜ_v”siÚ
;

82 
	m·tch_v”siÚ
;

83 
	mùime
;

84 
	mËv–
;

85 
	msize
;

86 
	mÄ_disks
;

87 
	m¿id_disks
;

88 
	mmd_mšÜ
;

89 
	mnÙ_³rsi¡’t
;

94 
	mutime
;

95 
	m¡©e
;

96 
	maùive_disks
;

97 
	mwÜkšg_disks
;

98 
	mçed_disks
;

99 
	m¥¬e_disks
;

104 
	mÏyout
;

105 
	mchunk_size
;

107 } 
	tmdu_¬¿y_šfo_t
;

110 
	#LEVEL_MULTIPATH
 (-4)

	)

111 
	#LEVEL_LINEAR
 (-1)

	)

112 
	#LEVEL_FAULTY
 (-5)

	)

118 
	#LEVEL_NONE
 (-1000000)

	)

120 
	smdu_disk_šfo_s
 {

124 
	mnumb”
;

125 
	mmajÜ
;

126 
	mmšÜ
;

127 
	m¿id_disk
;

128 
	m¡©e
;

130 } 
	tmdu_disk_šfo_t
;

132 
	smdu_¡¬t_šfo_s
 {

136 
	mmajÜ
;

137 
	mmšÜ
;

138 
	m¿id_disk
;

139 
	m¡©e
;

141 } 
	tmdu_¡¬t_šfo_t
;

143 
	smdu_b™m­_fe_s


145 
	m·thÇme
[4096];

146 } 
	tmdu_b™m­_fe_t
;

148 
	smdu_·¿m_s


150 
	m³rsÚ®™y
;

151 
	mchunk_size
;

152 
	mmax_çuÉ
;

153 } 
	tmdu_·¿m_t
;

	@/usr/include/linux/random.h

7 #iâdeà
_LINUX_RANDOM_H


8 
	#_LINUX_RANDOM_H


	)

10 
	~<lšux/ty³s.h
>

11 
	~<lšux/ioùl.h
>

12 
	~<lšux/œqÄ.h
>

17 
	#RNDGETENTCNT
 
	`_IOR
Ğ'R', 0x00, )

	)

20 
	#RNDADDTOENTCNT
 
	`_IOW
Ğ'R', 0x01, )

	)

23 
	#RNDGETPOOL
 
	`_IOR
Ğ'R', 0x02, [2] )

	)

29 
	#RNDADDENTROPY
 
	`_IOW
Ğ'R', 0x03, [2] )

	)

32 
	#RNDZAPENTCNT
 
	`_IO
Ğ'R', 0x04 )

	)

35 
	#RNDCLEARPOOL
 
	`_IO
Ğ'R', 0x06 )

	)

37 
	s¿nd_poŞ_šfo
 {

38 
	m’Œİy_couÁ
;

39 
	mbuf_size
;

40 
__u32
 
	mbuf
[0];

43 
	sºd_¡©e
 {

44 
__u32
 
	ms1
, 
	ms2
, 
	ms3
;

	@/usr/include/linux/raw.h

1 #iâdeà
__LINUX_RAW_H


2 
	#__LINUX_RAW_H


	)

4 
	~<lšux/ty³s.h
>

6 
	#RAW_SETBIND
 
	`_IO
Ğ0xac, 0 )

	)

7 
	#RAW_GETBIND
 
	`_IO
Ğ0xac, 1 )

	)

9 
	s¿w_cÚfig_»que¡


11 
	m¿w_mšÜ
;

12 
__u64
 
	mblock_majÜ
;

13 
__u64
 
	mblock_mšÜ
;

16 
	#MAX_RAW_MINORS
 
CONFIG_MAX_RAW_DEVS


	)

	@/usr/include/linux/route.h

23 #iâdeà
_LINUX_ROUTE_H


24 
	#_LINUX_ROUTE_H


	)

26 
	~<lšux/if.h
>

30 
	s¹’Œy
 {

31 
	m¹_·d1
;

32 
sockaddr
 
	m¹_d¡
;

33 
sockaddr
 
	m¹_g©eway
;

34 
sockaddr
 
	m¹_g’mask
;

35 
	m¹_æags
;

36 
	m¹_·d2
;

37 
	m¹_·d3
;

38 *
	m¹_·d4
;

39 
	m¹_m‘ric
;

40 *
	m¹_dev
;

41 
	m¹_mtu
;

42 
	#¹_mss
 
¹_mtu


	)

43 
	m¹_wšdow
;

44 
	m¹_œ‰
;

48 
	#RTF_UP
 0x0001

	)

49 
	#RTF_GATEWAY
 0x0002

	)

50 
	#RTF_HOST
 0x0004

	)

51 
	#RTF_REINSTATE
 0x0008

	)

52 
	#RTF_DYNAMIC
 0x0010

	)

53 
	#RTF_MODIFIED
 0x0020

	)

54 
	#RTF_MTU
 0x0040

	)

55 
	#RTF_MSS
 
RTF_MTU


	)

56 
	#RTF_WINDOW
 0x0080

	)

57 
	#RTF_IRTT
 0x0100

	)

58 
	#RTF_REJECT
 0x0200

	)

	@/usr/include/linux/rtc.h

11 #iâdeà
_LINUX_RTC_H_


12 
	#_LINUX_RTC_H_


	)

20 
	s¹c_time
 {

21 
	mtm_£c
;

22 
	mtm_mš
;

23 
	mtm_hour
;

24 
	mtm_mday
;

25 
	mtm_mÚ
;

26 
	mtm_y—r
;

27 
	mtm_wday
;

28 
	mtm_yday
;

29 
	mtm_isd¡
;

36 
	s¹c_wk®rm
 {

37 
	m’abËd
;

38 
	m³ndšg
;

39 
¹c_time
 
	mtime
;

55 
	s¹c_¶l_šfo
 {

56 
	m¶l_ù¾
;

57 
	m¶l_v®ue
;

58 
	m¶l_max
;

59 
	m¶l_mš
;

60 
	m¶l_posmuÉ
;

61 
	m¶l_ÃgmuÉ
;

62 
	m¶l_şock
;

70 
	#RTC_AIE_ON
 
	`_IO
('p', 0x01è

	)

71 
	#RTC_AIE_OFF
 
	`_IO
('p', 0x02è

	)

72 
	#RTC_UIE_ON
 
	`_IO
('p', 0x03è

	)

73 
	#RTC_UIE_OFF
 
	`_IO
('p', 0x04è

	)

74 
	#RTC_PIE_ON
 
	`_IO
('p', 0x05è

	)

75 
	#RTC_PIE_OFF
 
	`_IO
('p', 0x06è

	)

76 
	#RTC_WIE_ON
 
	`_IO
('p', 0x0fè

	)

77 
	#RTC_WIE_OFF
 
	`_IO
('p', 0x10è

	)

79 
	#RTC_ALM_SET
 
	`_IOW
('p', 0x07, 
¹c_time
è

	)

80 
	#RTC_ALM_READ
 
	`_IOR
('p', 0x08, 
¹c_time
è

	)

81 
	#RTC_RD_TIME
 
	`_IOR
('p', 0x09, 
¹c_time
è

	)

82 
	#RTC_SET_TIME
 
	`_IOW
('p', 0x0a, 
¹c_time
è

	)

83 
	#RTC_IRQP_READ
 
	`_IOR
('p', 0x0b, è

	)

84 
	#RTC_IRQP_SET
 
	`_IOW
('p', 0x0c, è

	)

85 
	#RTC_EPOCH_READ
 
	`_IOR
('p', 0x0d, è

	)

86 
	#RTC_EPOCH_SET
 
	`_IOW
('p', 0x0e, è

	)

88 
	#RTC_WKALM_SET
 
	`_IOW
('p', 0x0f, 
¹c_wk®rm
)

	)

89 
	#RTC_WKALM_RD
 
	`_IOR
('p', 0x10, 
¹c_wk®rm
)

	)

91 
	#RTC_PLL_GET
 
	`_IOR
('p', 0x11, 
¹c_¶l_šfo
è

	)

92 
	#RTC_PLL_SET
 
	`_IOW
('p', 0x12, 
¹c_¶l_šfo
è

	)

95 
	#RTC_IRQF
 0x80

	)

96 
	#RTC_PF
 0x40

	)

97 
	#RTC_AF
 0x20

	)

98 
	#RTC_UF
 0x10

	)

101 
	#RTC_MAX_FREQ
 8192

	)

	@/usr/include/linux/sched.h

1 #iâdeà
_LINUX_SCHED_H


2 
	#_LINUX_SCHED_H


	)

7 
	#CSIGNAL
 0x000000fà

	)

8 
	#CLONE_VM
 0x00000100

	)

9 
	#CLONE_FS
 0x00000200

	)

10 
	#CLONE_FILES
 0x00000400

	)

11 
	#CLONE_SIGHAND
 0x00000800

	)

12 
	#CLONE_PTRACE
 0x00002000

	)

13 
	#CLONE_VFORK
 0x00004000

	)

14 
	#CLONE_PARENT
 0x00008000

	)

15 
	#CLONE_THREAD
 0x00010000

	)

16 
	#CLONE_NEWNS
 0x00020000

	)

17 
	#CLONE_SYSVSEM
 0x00040000

	)

18 
	#CLONE_SETTLS
 0x00080000

	)

19 
	#CLONE_PARENT_SETTID
 0x00100000

	)

20 
	#CLONE_CHILD_CLEARTID
 0x00200000

	)

21 
	#CLONE_DETACHED
 0x00400000

	)

22 
	#CLONE_UNTRACED
 0x00800000

	)

23 
	#CLONE_CHILD_SETTID
 0x01000000

	)

26 
	#CLONE_NEWUTS
 0x04000000

	)

27 
	#CLONE_NEWIPC
 0x08000000

	)

28 
	#CLONE_NEWUSER
 0x10000000

	)

29 
	#CLONE_NEWPID
 0x20000000

	)

30 
	#CLONE_NEWNET
 0x40000000

	)

31 
	#CLONE_IO
 0x80000000

	)

36 
	#SCHED_NORMAL
 0

	)

37 
	#SCHED_FIFO
 1

	)

38 
	#SCHED_RR
 2

	)

39 
	#SCHED_BATCH
 3

	)

41 
	#SCHED_IDLE
 5

	)

43 
	#SCHED_RESET_ON_FORK
 0x40000000

	)

	@/usr/include/linux/securebits.h

1 #iâdeà
_LINUX_SECUREBITS_H


2 
	#_LINUX_SECUREBITS_H
 1

	)

8 
	#is£cu»_mask
(
X
è(1 << (X))

	)

10 
	#SECUREBITS_DEFAULT
 0x00000000

	)

18 
	#SECURE_NOROOT
 0

	)

19 
	#SECURE_NOROOT_LOCKED
 1

	)

21 
	#SECBIT_NOROOT
 (
	`is£cu»_mask
(
SECURE_NOROOT
))

	)

22 
	#SECBIT_NOROOT_LOCKED
 (
	`is£cu»_mask
(
SECURE_NOROOT_LOCKED
))

	)

28 
	#SECURE_NO_SETUID_FIXUP
 2

	)

29 
	#SECURE_NO_SETUID_FIXUP_LOCKED
 3

	)

31 
	#SECBIT_NO_SETUID_FIXUP
 (
	`is£cu»_mask
(
SECURE_NO_SETUID_FIXUP
))

	)

32 
	#SECBIT_NO_SETUID_FIXUP_LOCKED
 \

33 (
	`is£cu»_mask
(
SECURE_NO_SETUID_FIXUP_LOCKED
))

	)

40 
	#SECURE_KEEP_CAPS
 4

	)

41 
	#SECURE_KEEP_CAPS_LOCKED
 5

	)

43 
	#SECBIT_KEEP_CAPS
 (
	`is£cu»_mask
(
SECURE_KEEP_CAPS
))

	)

44 
	#SECBIT_KEEP_CAPS_LOCKED
 (
	`is£cu»_mask
(
SECURE_KEEP_CAPS_LOCKED
))

	)

46 
	#SECURE_ALL_BITS
 (
	`is£cu»_mask
(
SECURE_NOROOT
) | \

47 
	`is£cu»_mask
(
SECURE_NO_SETUID_FIXUP
) | \

48 
	`is£cu»_mask
(
SECURE_KEEP_CAPS
))

	)

49 
	#SECURE_ALL_LOCKS
 (
SECURE_ALL_BITS
 << 1)

	)

	@/usr/include/linux/serial.h

10 #iâdeà
_LINUX_SERIAL_H


11 
	#_LINUX_SERIAL_H


	)

13 
	~<lšux/ty³s.h
>

16 
	s£rŸl_¡ruù
 {

17 
	mty³
;

18 
	mlše
;

19 
	mpÜt
;

20 
	mœq
;

21 
	mæags
;

22 
	mxm™_fifo_size
;

23 
	mcu¡om_divisÜ
;

24 
	mbaud_ba£
;

25 
	mşo£_d–ay
;

26 
	mio_ty³
;

27 
	m»£rved_ch¬
[1];

28 
	mhub6
;

29 
	mşosšg_wa™
;

30 
	mşosšg_wa™2
;

31 *
	miomem_ba£
;

32 
	miomem_»g_shiá
;

33 
	mpÜt_high
;

34 
	miom­_ba£
;

41 
	#ASYNC_CLOSING_WAIT_INF
 0

	)

42 
	#ASYNC_CLOSING_WAIT_NONE
 65535

	)

47 
	#PORT_UNKNOWN
 0

	)

48 
	#PORT_8250
 1

	)

49 
	#PORT_16450
 2

	)

50 
	#PORT_16550
 3

	)

51 
	#PORT_16550A
 4

	)

52 
	#PORT_CIRRUS
 5

	)

53 
	#PORT_16650
 6

	)

54 
	#PORT_16650V2
 7

	)

55 
	#PORT_16750
 8

	)

56 
	#PORT_STARTECH
 9

	)

57 
	#PORT_16C950
 10

	)

58 
	#PORT_16654
 11

	)

59 
	#PORT_16850
 12

	)

60 
	#PORT_RSA
 13

	)

61 
	#PORT_MAX
 13

	)

63 
	#SERIAL_IO_PORT
 0

	)

64 
	#SERIAL_IO_HUB6
 1

	)

65 
	#SERIAL_IO_MEM
 2

	)

67 
	s£rŸl_u¬t_cÚfig
 {

68 *
	mÇme
;

69 
	mdæ_xm™_fifo_size
;

70 
	mæags
;

73 
	#UART_CLEAR_FIFO
 0x01

	)

74 
	#UART_USE_FIFO
 0x02

	)

75 
	#UART_STARTECH
 0x04

	)

76 
	#UART_NATSEMI
 0x08

	)

83 
	#ASYNCB_HUP_NOTIFY
 0

	)

85 
	#ASYNCB_FOURPORT
 1

	)

86 
	#ASYNCB_SAK
 2

	)

87 
	#ASYNCB_SPLIT_TERMIOS
 3

	)

88 
	#ASYNCB_SPD_HI
 4

	)

89 
	#ASYNCB_SPD_VHI
 5

	)

90 
	#ASYNCB_SKIP_TEST
 6

	)

91 
	#ASYNCB_AUTO_IRQ
 7

	)

93 
	#ASYNCB_SESSION_LOCKOUT
 8

	)

94 
	#ASYNCB_PGRP_LOCKOUT
 9

	)

95 
	#ASYNCB_CALLOUT_NOHUP
 10

	)

96 
	#ASYNCB_HARDPPS_CD
 11

	)

97 
	#ASYNCB_SPD_SHI
 12

	)

98 
	#ASYNCB_LOW_LATENCY
 13

	)

99 
	#ASYNCB_BUGGY_UART
 14

	)

101 
	#ASYNCB_AUTOPROBE
 15

	)

102 
	#ASYNCB_LAST_USER
 15

	)

105 
	#ASYNCB_INITIALIZED
 31

	)

106 
	#ASYNCB_SUSPENDED
 30

	)

107 
	#ASYNCB_NORMAL_ACTIVE
 29

	)

108 
	#ASYNCB_BOOT_AUTOCONF
 28

	)

109 
	#ASYNCB_CLOSING
 27

	)

110 
	#ASYNCB_CTS_FLOW
 26

	)

111 
	#ASYNCB_CHECK_CD
 25

	)

112 
	#ASYNCB_SHARE_IRQ
 24

	)

113 
	#ASYNCB_CONS_FLOW
 23

	)

114 
	#ASYNCB_BOOT_ONLYMCA
 22

	)

115 
	#ASYNCB_FIRST_KERNEL
 22

	)

117 
	#ASYNC_HUP_NOTIFY
 (1U << 
ASYNCB_HUP_NOTIFY
)

	)

118 
	#ASYNC_SUSPENDED
 (1U << 
ASYNCB_SUSPENDED
)

	)

119 
	#ASYNC_FOURPORT
 (1U << 
ASYNCB_FOURPORT
)

	)

120 
	#ASYNC_SAK
 (1U << 
ASYNCB_SAK
)

	)

121 
	#ASYNC_SPLIT_TERMIOS
 (1U << 
ASYNCB_SPLIT_TERMIOS
)

	)

122 
	#ASYNC_SPD_HI
 (1U << 
ASYNCB_SPD_HI
)

	)

123 
	#ASYNC_SPD_VHI
 (1U << 
ASYNCB_SPD_VHI
)

	)

124 
	#ASYNC_SKIP_TEST
 (1U << 
ASYNCB_SKIP_TEST
)

	)

125 
	#ASYNC_AUTO_IRQ
 (1U << 
ASYNCB_AUTO_IRQ
)

	)

126 
	#ASYNC_SESSION_LOCKOUT
 (1U << 
ASYNCB_SESSION_LOCKOUT
)

	)

127 
	#ASYNC_PGRP_LOCKOUT
 (1U << 
ASYNCB_PGRP_LOCKOUT
)

	)

128 
	#ASYNC_CALLOUT_NOHUP
 (1U << 
ASYNCB_CALLOUT_NOHUP
)

	)

129 
	#ASYNC_HARDPPS_CD
 (1U << 
ASYNCB_HARDPPS_CD
)

	)

130 
	#ASYNC_SPD_SHI
 (1U << 
ASYNCB_SPD_SHI
)

	)

131 
	#ASYNC_LOW_LATENCY
 (1U << 
ASYNCB_LOW_LATENCY
)

	)

132 
	#ASYNC_BUGGY_UART
 (1U << 
ASYNCB_BUGGY_UART
)

	)

133 
	#ASYNC_AUTOPROBE
 (1U << 
ASYNCB_AUTOPROBE
)

	)

135 
	#ASYNC_FLAGS
 ((1U << (
ASYNCB_LAST_USER
 + 1)è- 1)

	)

136 
	#ASYNC_USR_MASK
 (
ASYNC_SPD_HI
|
ASYNC_SPD_VHI
| \

137 
ASYNC_CALLOUT_NOHUP
|
ASYNC_SPD_SHI
|
ASYNC_LOW_LATENCY
)

	)

138 
	#ASYNC_SPD_CUST
 (
ASYNC_SPD_HI
|
ASYNC_SPD_VHI
)

	)

139 
	#ASYNC_SPD_WARP
 (
ASYNC_SPD_HI
|
ASYNC_SPD_SHI
)

	)

140 
	#ASYNC_SPD_MASK
 (
ASYNC_SPD_HI
|
ASYNC_SPD_VHI
|
ASYNC_SPD_SHI
)

	)

142 
	#ASYNC_INITIALIZED
 (1U << 
ASYNCB_INITIALIZED
)

	)

143 
	#ASYNC_NORMAL_ACTIVE
 (1U << 
ASYNCB_NORMAL_ACTIVE
)

	)

144 
	#ASYNC_BOOT_AUTOCONF
 (1U << 
ASYNCB_BOOT_AUTOCONF
)

	)

145 
	#ASYNC_CLOSING
 (1U << 
ASYNCB_CLOSING
)

	)

146 
	#ASYNC_CTS_FLOW
 (1U << 
ASYNCB_CTS_FLOW
)

	)

147 
	#ASYNC_CHECK_CD
 (1U << 
ASYNCB_CHECK_CD
)

	)

148 
	#ASYNC_SHARE_IRQ
 (1U << 
ASYNCB_SHARE_IRQ
)

	)

149 
	#ASYNC_CONS_FLOW
 (1U << 
ASYNCB_CONS_FLOW
)

	)

150 
	#ASYNC_BOOT_ONLYMCA
 (1U << 
ASYNCB_BOOT_ONLYMCA
)

	)

151 
	#ASYNC_INTERNAL_FLAGS
 (~((1U << 
ASYNCB_FIRST_KERNEL
è- 1))

	)

156 
	s£rŸl_muÉÜt_¡ruù
 {

157 
	mœq
;

158 
	mpÜt1
;

159 
	mmask1
, 
	mm©ch1
;

160 
	mpÜt2
;

161 
	mmask2
, 
	mm©ch2
;

162 
	mpÜt3
;

163 
	mmask3
, 
	mm©ch3
;

164 
	mpÜt4
;

165 
	mmask4
, 
	mm©ch4
;

166 
	mpÜt_mÚ™Ü
;

167 
	m»£rved
[32];

174 
	s£rŸl_icouÁ”_¡ruù
 {

175 
	mùs
, 
	md¤
, 
	mºg
, 
	mdcd
;

176 
	mrx
, 
	mtx
;

177 
	mäame
, 
	mov”run
, 
	m·r™y
, 
	mbrk
;

178 
	mbuf_ov”run
;

179 
	m»£rved
[9];

189 
	s£rŸl_rs485
 {

190 
__u32
 
	mæags
;

191 
	#SER_RS485_ENABLED
 (1 << 0è

	)

192 
	#SER_RS485_RTS_ON_SEND
 (1 << 1è

	)

195 
	#SER_RS485_RTS_AFTER_SEND
 (1 << 2è

	)

197 
	#SER_RS485_RX_DURING_TX
 (1 << 4)

	)

198 
__u32
 
	md–ay_¹s_befÜe_£nd
;

199 
__u32
 
	md–ay_¹s_aá”_£nd
;

200 
__u32
 
	m·ddšg
[5];

	@/usr/include/linux/shm.h

1 #iâdeà
_LINUX_SHM_H_


2 
	#_LINUX_SHM_H_


	)

4 
	~<lšux/c.h
>

5 
	~<lšux/”ºo.h
>

6 
	~<uni¡d.h
>

13 
	#SHMMAX
 0x2000000

	)

14 
	#SHMMIN
 1

	)

15 
	#SHMMNI
 4096

	)

16 
	#SHMALL
 (
SHMMAX
/
	`g‘·gesize
()*(
SHMMNI
/16))

	)

17 
	#SHMSEG
 
SHMMNI


	)

21 
	sshmid_ds
 {

22 
c_³rm
 
	mshm_³rm
;

23 
	mshm_£gsz
;

24 
__k”Ãl_time_t
 
	mshm_©ime
;

25 
__k”Ãl_time_t
 
	mshm_dtime
;

26 
__k”Ãl_time_t
 
	mshm_ùime
;

27 
__k”Ãl_c_pid_t
 
	mshm_ıid
;

28 
__k”Ãl_c_pid_t
 
	mshm_Íid
;

29 
	mshm_Ç‰ch
;

30 
	mshm_unu£d
;

31 *
	mshm_unu£d2
;

32 *
	mshm_unu£d3
;

36 
	~<asm/shmbuf.h
>

39 
	#SHM_R
 0400

	)

40 
	#SHM_W
 0200

	)

43 
	#SHM_RDONLY
 010000

	)

44 
	#SHM_RND
 020000

	)

45 
	#SHM_REMAP
 040000

	)

46 
	#SHM_EXEC
 0100000

	)

49 
	#SHM_LOCK
 11

	)

50 
	#SHM_UNLOCK
 12

	)

53 
	#SHM_STAT
 13

	)

54 
	#SHM_INFO
 14

	)

57 
	sshmšfo
 {

58 
	mshmmax
;

59 
	mshmmš
;

60 
	mshmmni
;

61 
	mshm£g
;

62 
	mshm®l
;

65 
	sshm_šfo
 {

66 
	mu£d_ids
;

67 
	mshm_tÙ
;

68 
	mshm_rss
;

69 
	mshm_swp
;

70 
	msw­_©‹m±s
;

71 
	msw­_sucûs£s
;

	@/usr/include/linux/signal.h

1 #iâdeà
_LINUX_SIGNAL_H


2 
	#_LINUX_SIGNAL_H


	)

4 
	~<asm/sigÇl.h
>

5 
	~<asm/sigšfo.h
>

	@/usr/include/linux/signalfd.h

8 #iâdeà
_LINUX_SIGNALFD_H


9 
	#_LINUX_SIGNALFD_H


	)

11 
	~<lšux/ty³s.h
>

13 
	~<lšux/fú.h
>

16 
	#SFD_CLOEXEC
 
O_CLOEXEC


	)

17 
	#SFD_NONBLOCK
 
O_NONBLOCK


	)

19 
	ssigÇlfd_sigšfo
 {

20 
__u32
 
	mssi_signo
;

21 
__s32
 
	mssi_”ºo
;

22 
__s32
 
	mssi_code
;

23 
__u32
 
	mssi_pid
;

24 
__u32
 
	mssi_uid
;

25 
__s32
 
	mssi_fd
;

26 
__u32
 
	mssi_tid
;

27 
__u32
 
	mssi_bªd
;

28 
__u32
 
	mssi_ov”run
;

29 
__u32
 
	mssi_Œ­no
;

30 
__s32
 
	mssi_¡©us
;

31 
__s32
 
	mssi_št
;

32 
__u64
 
	mssi_±r
;

33 
__u64
 
	mssi_utime
;

34 
__u64
 
	mssi_¡ime
;

35 
__u64
 
	mssi_addr
;

36 
__u16
 
	mssi_addr_lsb
;

47 
__u8
 
	m__·d
[46];

	@/usr/include/linux/som.h

1 #iâdeà
_LINUX_SOM_H


2 
	#_LINUX_SOM_H


	)

7 
	~<lšux/time.h
>

9 
	#SOM_PAGESIZE
 4096

	)

12 
	ssom_hdr
 {

13 
	msy¡em_id
;

14 
	ma_magic
;

15 
	mv”siÚ_id
;

16 
time¥ec
 
	mfe_time
;

17 
	m’Œy_¥aû
;

18 
	m’Œy_sub¥aû
;

19 
	m’Œy_off£t
;

20 
	maux_h—d”_loÿtiÚ
;

21 
	maux_h—d”_size
;

22 
	msom_Ëngth
;

23 
	m´esumed_dp
;

24 
	m¥aû_loÿtiÚ
;

25 
	m¥aû_tÙ®
;

26 
	msub¥aû_loÿtiÚ
;

27 
	msub¥aû_tÙ®
;

28 
	mlßd”_fixup_loÿtiÚ
;

29 
	mlßd”_fixup_tÙ®
;

30 
	m¥aû_¡ršgs_loÿtiÚ
;

31 
	m¥aû_¡ršgs_size
;

32 
	mš™_¬¿y_loÿtiÚ
;

33 
	mš™_¬¿y_tÙ®
;

34 
	mcomp”_loÿtiÚ
;

35 
	mcomp”_tÙ®
;

36 
	msymbŞ_loÿtiÚ
;

37 
	msymbŞ_tÙ®
;

38 
	mfixup_»que¡_loÿtiÚ
;

39 
	mfixup_»que¡_tÙ®
;

40 
	msymbŞ_¡ršgs_loÿtiÚ
;

41 
	msymbŞ_¡ršgs_size
;

42 
	muÆßdabË_¥_loÿtiÚ
;

43 
	muÆßdabË_¥_size
;

44 
	mchecksum
;

49 
	#SOM_SID_PARISC_1_0
 0x020b

	)

50 
	#SOM_SID_PARISC_1_1
 0x0210

	)

51 
	#SOM_SID_PARISC_2_0
 0x0214

	)

55 
	#SOM_LIB_EXEC
 0x0104

	)

56 
	#SOM_RELOCATABLE
 0x0106

	)

57 
	#SOM_EXEC_NONSHARE
 0x0107

	)

58 
	#SOM_EXEC_SHARE
 0x0108

	)

59 
	#SOM_EXEC_DEMAND
 0x010B

	)

60 
	#SOM_LIB_DYN
 0x010D

	)

61 
	#SOM_LIB_SHARE
 0x010E

	)

62 
	#SOM_LIB_RELOC
 0x0619

	)

66 
	#SOM_ID_OLD
 85082112

	)

67 
	#SOM_ID_NEW
 87102412

	)

69 
	saux_id
 {

70 
	mmªd©Üy
 :1;

71 
	mcİy
 :1;

72 
	m­³nd
 :1;

73 
	mignÜe
 :1;

74 
	m»£rved
 :12;

75 
	mty³
 :16;

76 
	mËngth
;

80 
	ssom_exec_auxhdr
 {

81 
aux_id
 
	msom_auxhdr
;

82 
	mexec_tsize
;

83 
	mexec_tmem
;

84 
	mexec_tfe
;

85 
	mexec_dsize
;

86 
	mexec_dmem
;

87 
	mexec_dfe
;

88 
	mexec_bsize
;

89 
	mexec_’Œy
;

90 
	mexec_æags
;

91 
	mexec_bfl
;

97 
	uÇme_±
 {

98 * 
	mn_Çme
;

99 
	mn_¡rx
;

103 
	s¥aû_diùiÚ¬y_»cÜd
 {

104 
Çme_±
 
	mÇme
;

105 
	mis_lßdabË
 :1;

106 
	mis_defšed
 :1;

107 
	mis_´iv©e
 :1;

108 
	mhas_š‹rmedŸ‹_code
 :1;

109 
	mis_t¥ecific
 :1;

110 
	m»£rved
 :11;

111 
	msÜt_key
 :8;

112 
	m»£rved2
 :8;

114 
	m¥aû_numb”
;

115 
	msub¥aû_šdex
;

116 
	msub¥aû_quªt™y
;

117 
	mlßd”_fix_šdex
;

118 
	mlßd”_fix_quªt™y
;

119 
	mš™_poš‹r_šdex
;

120 
	mš™_poš‹r_quªt™y
;

124 
	ssub¥aû_diùiÚ¬y_»cÜd
 {

125 
	m¥aû_šdex
;

126 
	macûss_cÚŒŞ_b™s
 :7;

127 
	mmemÜy_»sid’t
 :1;

128 
	mdup_commÚ
 :1;

129 
	mis_commÚ
 :1;

130 
	mquad¿Á
 :2;

131 
	mš™ŸÎy_äoz’
 :1;

132 
	mis_fœ¡
 :1;

133 
	mcode_Úly
 :1;

134 
	msÜt_key
 :8;

135 
	m»¶iÿ‹_š™
 :1;

136 
	mcÚtšu©iÚ
 :1;

137 
	mis_t¥ecific
 :1;

138 
	mis_comd©
 :1;

139 
	m»£rved
 :4;

141 
	mfe_loc_š™_v®ue
;

142 
	mš™Ÿliz©iÚ_Ëngth
;

143 
	msub¥aû_¡¬t
;

144 
	msub¥aû_Ëngth
;

146 
	m»£rved2
 :5;

147 
	m®ignm’t
 :27;

149 
Çme_±
 
	mÇme
;

150 
	mfixup_»que¡_šdex
;

151 
	mfixup_»que¡_quªt™y
;

	@/usr/include/linux/sonet.h

6 #iâdeà
LINUX_SONET_H


7 
	#LINUX_SONET_H


	)

9 
	#__SONET_ITEMS
 \

10 
	`__HANDLE_ITEM
(
£ùiÚ_b
); \

11 
	`__HANDLE_ITEM
(
lše_b
); \

12 
	`__HANDLE_ITEM
(
·th_b
); \

13 
	`__HANDLE_ITEM
(
lše_ãbe
); \

14 
	`__HANDLE_ITEM
(
·th_ãbe
); \

15 
	`__HANDLE_ITEM
(
cÜr_hcs
); \

16 
	`__HANDLE_ITEM
(
uncÜr_hcs
); \

17 
	`__HANDLE_ITEM
(
tx_ûÎs
); \

18 
	`__HANDLE_ITEM
(
rx_ûÎs
);

	)

20 
	ssÚ‘_¡©s
 {

21 
	#__HANDLE_ITEM
(
i
è
	)
i

22 
	m__SONET_ITEMS


23 #undeà
__HANDLE_ITEM


24 } 
__©Œibu‹__
 ((
·cked
));

27 
	#SONET_GETSTAT
 
	`_IOR
('a',
ATMIOC_PHYTYP
,
sÚ‘_¡©s
)

	)

29 
	#SONET_GETSTATZ
 
	`_IOR
('a',
ATMIOC_PHYTYP
+1,
sÚ‘_¡©s
)

	)

31 
	#SONET_SETDIAG
 
	`_IOWR
('a',
ATMIOC_PHYTYP
+2,)

	)

33 
	#SONET_CLRDIAG
 
	`_IOWR
('a',
ATMIOC_PHYTYP
+3,)

	)

35 
	#SONET_GETDIAG
 
	`_IOR
('a',
ATMIOC_PHYTYP
+4,)

	)

37 
	#SONET_SETFRAMING
 
	`_IOW
('a',
ATMIOC_PHYTYP
+5,)

	)

39 
	#SONET_GETFRAMING
 
	`_IOR
('a',
ATMIOC_PHYTYP
+6,)

	)

41 
	#SONET_GETFRSENSE
 
	`_IOR
('a',
ATMIOC_PHYTYP
+7, \

42 [
SONET_FRSENSE_SIZE
]è

	)

44 
	#SONET_INS_SBIP
 1

	)

45 
	#SONET_INS_LBIP
 2

	)

46 
	#SONET_INS_PBIP
 4

	)

47 
	#SONET_INS_FRAME
 8

	)

48 
	#SONET_INS_LOS
 16

	)

49 
	#SONET_INS_LAIS
 32

	)

50 
	#SONET_INS_PAIS
 64

	)

51 
	#SONET_INS_HCS
 128

	)

53 
	#SONET_FRAME_SONET
 0

	)

54 
	#SONET_FRAME_SDH
 1

	)

56 
	#SONET_FRSENSE_SIZE
 6

	)

	@/usr/include/linux/soundcard.h

1 #iâdeà
SOUNDCARD_H


2 
	#SOUNDCARD_H


	)

36 
	#SOUND_VERSION
 0x030802

	)

37 
	#OPEN_SOUND_SYSTEM


	)

40 
	~<lšux/ioùl.h
>

43 
	~<’dŸn.h
>

49 
	#SNDCARD_ADLIB
 1

	)

50 
	#SNDCARD_SB
 2

	)

51 
	#SNDCARD_PAS
 3

	)

52 
	#SNDCARD_GUS
 4

	)

53 
	#SNDCARD_MPU401
 5

	)

54 
	#SNDCARD_SB16
 6

	)

55 
	#SNDCARD_SB16MIDI
 7

	)

56 
	#SNDCARD_UART6850
 8

	)

57 
	#SNDCARD_GUS16
 9

	)

58 
	#SNDCARD_MSS
 10

	)

59 
	#SNDCARD_PSS
 11

	)

60 
	#SNDCARD_SSCAPE
 12

	)

61 
	#SNDCARD_PSS_MPU
 13

	)

62 
	#SNDCARD_PSS_MSS
 14

	)

63 
	#SNDCARD_SSCAPE_MSS
 15

	)

64 
	#SNDCARD_TRXPRO
 16

	)

65 
	#SNDCARD_TRXPRO_SB
 17

	)

66 
	#SNDCARD_TRXPRO_MPU
 18

	)

67 
	#SNDCARD_MAD16
 19

	)

68 
	#SNDCARD_MAD16_MPU
 20

	)

69 
	#SNDCARD_CS4232
 21

	)

70 
	#SNDCARD_CS4232_MPU
 22

	)

71 
	#SNDCARD_MAUI
 23

	)

72 
	#SNDCARD_PSEUDO_MSS
 24

	)

73 
	#SNDCARD_GUSPNP
 25

	)

74 
	#SNDCARD_UART401
 26

	)

81 #iâdeà
_SIOWR


82 #ià
defšed
(
_IOWR
è&& (defšed(
_AIX
è|| (!defšed(
sun
è&& !defšed(
¥¬c
è&& !defšed(
__¥¬c__
è&& !defšed(
__INCioùlh
è&& !defšed(
__Lynx__
)))

84 
	#SIOCPARM_MASK
 
IOCPARM_MASK


	)

85 
	#SIOC_VOID
 
IOC_VOID


	)

86 
	#SIOC_OUT
 
IOC_OUT


	)

87 
	#SIOC_IN
 
IOC_IN


	)

88 
	#SIOC_INOUT
 
IOC_INOUT


	)

89 
	#_SIOC_SIZE
 
_IOC_SIZE


	)

90 
	#_SIOC_DIR
 
_IOC_DIR


	)

91 
	#_SIOC_NONE
 
_IOC_NONE


	)

92 
	#_SIOC_READ
 
_IOC_READ


	)

93 
	#_SIOC_WRITE
 
_IOC_WRITE


	)

94 
	#_SIO
 
_IO


	)

95 
	#_SIOR
 
_IOR


	)

96 
	#_SIOW
 
_IOW


	)

97 
	#_SIOWR
 
_IOWR


	)

107 
	#SIOCPARM_MASK
 0x1ffà

	)

108 
	#SIOC_VOID
 0x00000000

	)

109 
	#SIOC_OUT
 0x20000000

	)

110 
	#SIOC_IN
 0x40000000

	)

111 
	#SIOC_INOUT
 (
SIOC_IN
|
SIOC_OUT
)

	)

113 
	#_SIO
(
x
,
y
è(()(
SIOC_VOID
|(x<<8)|y))

	)

114 
	#_SIOR
(
x
,
y
,
t
è(()(
SIOC_OUT
|((Ñ)&
SIOCPARM_MASK
)<<16)|(x<<8)|y))

	)

115 
	#_SIOW
(
x
,
y
,
t
è(()(
SIOC_IN
|((Ñ)&
SIOCPARM_MASK
)<<16)|(x<<8)|y))

	)

117 
	#_SIOWR
(
x
,
y
,
t
è(()(
SIOC_INOUT
|((Ñ)&
SIOCPARM_MASK
)<<16)|(x<<8)|y))

	)

118 
	#_SIOC_SIZE
(
x
è((x>>16)&
SIOCPARM_MASK
)

	)

119 
	#_SIOC_DIR
(
x
è(x & 0xf0000000)

	)

120 
	#_SIOC_NONE
 
SIOC_VOID


	)

121 
	#_SIOC_READ
 
SIOC_OUT


	)

122 
	#_SIOC_WRITE
 
SIOC_IN


	)

126 
	#SNDCTL_SEQ_RESET
 
	`_SIO
 ('Q', 0)

	)

127 
	#SNDCTL_SEQ_SYNC
 
	`_SIO
 ('Q', 1)

	)

128 
	#SNDCTL_SYNTH_INFO
 
	`_SIOWR
('Q', 2, 
syÁh_šfo
)

	)

129 
	#SNDCTL_SEQ_CTRLRATE
 
	`_SIOWR
('Q', 3, è

	)

130 
	#SNDCTL_SEQ_GETOUTCOUNT
 
	`_SIOR
 ('Q', 4, )

	)

131 
	#SNDCTL_SEQ_GETINCOUNT
 
	`_SIOR
 ('Q', 5, )

	)

132 
	#SNDCTL_SEQ_PERCMODE
 
	`_SIOW
 ('Q', 6, )

	)

133 
	#SNDCTL_FM_LOAD_INSTR
 
	`_SIOW
 ('Q', 7, 
sbi_š¡rum’t
è

	)

134 
	#SNDCTL_SEQ_TESTMIDI
 
	`_SIOW
 ('Q', 8, )

	)

135 
	#SNDCTL_SEQ_RESETSAMPLES
 
	`_SIOW
 ('Q', 9, )

	)

136 
	#SNDCTL_SEQ_NRSYNTHS
 
	`_SIOR
 ('Q',10, )

	)

137 
	#SNDCTL_SEQ_NRMIDIS
 
	`_SIOR
 ('Q',11, )

	)

138 
	#SNDCTL_MIDI_INFO
 
	`_SIOWR
('Q',12, 
midi_šfo
)

	)

139 
	#SNDCTL_SEQ_THRESHOLD
 
	`_SIOW
 ('Q',13, )

	)

140 
	#SNDCTL_SYNTH_MEMAVL
 
	`_SIOWR
('Q',14, è

	)

141 
	#SNDCTL_FM_4OP_ENABLE
 
	`_SIOW
 ('Q',15, è

	)

142 
	#SNDCTL_SEQ_PANIC
 
	`_SIO
 ('Q',17)

	)

143 
	#SNDCTL_SEQ_OUTOFBAND
 
	`_SIOW
 ('Q',18, 
£q_ev’t_»c
)

	)

144 
	#SNDCTL_SEQ_GETTIME
 
	`_SIOR
 ('Q',19, )

	)

145 
	#SNDCTL_SYNTH_ID
 
	`_SIOWR
('Q',20, 
syÁh_šfo
)

	)

146 
	#SNDCTL_SYNTH_CONTROL
 
	`_SIOWR
('Q',21, 
syÁh_cÚŒŞ
)

	)

147 
	#SNDCTL_SYNTH_REMOVESAMPLE
 
	`_SIOWR
('Q',22, 
»move_§m¶e
)

	)

149 
	ssyÁh_cÚŒŞ


151 
	mdevno
;

152 
	md©a
[4000];

153 }
	tsyÁh_cÚŒŞ
;

155 
	s»move_§m¶e


157 
	mdevno
;

158 
	mbªkno
;

159 
	mš¡ºo
;

160 } 
	t»move_§m¶e
;

162 
	s£q_ev’t_»c
 {

163 
	m¬r
[8];

164 } 
	t£q_ev’t_»c
;

166 
	#SNDCTL_TMR_TIMEBASE
 
	`_SIOWR
('T', 1, )

	)

167 
	#SNDCTL_TMR_START
 
	`_SIO
 ('T', 2)

	)

168 
	#SNDCTL_TMR_STOP
 
	`_SIO
 ('T', 3)

	)

169 
	#SNDCTL_TMR_CONTINUE
 
	`_SIO
 ('T', 4)

	)

170 
	#SNDCTL_TMR_TEMPO
 
	`_SIOWR
('T', 5, )

	)

171 
	#SNDCTL_TMR_SOURCE
 
	`_SIOWR
('T', 6, )

	)

172 
	#TMR_INTERNAL
 0x00000001

	)

173 
	#TMR_EXTERNAL
 0x00000002

	)

174 
	#TMR_MODE_MIDI
 0x00000010

	)

175 
	#TMR_MODE_FSK
 0x00000020

	)

176 
	#TMR_MODE_CLS
 0x00000040

	)

177 
	#TMR_MODE_SMPTE
 0x00000080

	)

178 
	#SNDCTL_TMR_METRONOME
 
	`_SIOW
 ('T', 7, )

	)

179 
	#SNDCTL_TMR_SELECT
 
	`_SIOW
 ('T', 8, )

	)

185 
	#_LINUX_PATCHKEY_H_INDIRECT


	)

186 
	~<lšux/·tchkey.h
>

187 #undeà
_LINUX_PATCHKEY_H_INDIRECT


189 #ià 
defšed
(
__BYTE_ORDER
)

190 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


191 
	#AFMT_S16_NE
 
AFMT_S16_BE


	)

192 #–ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


193 
	#AFMT_S16_NE
 
AFMT_S16_LE


	)

209 
	s·tch_šfo
 {

210 
	mkey
;

211 
	#WAVE_PATCH
 
	`_PATCHKEY
(0x04)

	)

212 
	#GUS_PATCH
 
WAVE_PATCH


	)

213 
	#WAVEFRONT_PATCH
 
	`_PATCHKEY
(0x06)

	)

215 
	mdeviû_no
;

216 
	mš¡r_no
;

218 
	mmode
;

223 
	#WAVE_16_BITS
 0x01

	)

224 
	#WAVE_UNSIGNED
 0x02

	)

225 
	#WAVE_LOOPING
 0x04

	)

226 
	#WAVE_BIDIR_LOOP
 0x08

	)

227 
	#WAVE_LOOP_BACK
 0x10

	)

228 
	#WAVE_SUSTAIN_ON
 0x20

	)

229 
	#WAVE_ENVELOPES
 0x40

	)

230 
	#WAVE_FAST_RELEASE
 0x80

	)

233 
	#WAVE_VIBRATO
 0x00010000

	)

234 
	#WAVE_TREMOLO
 0x00020000

	)

235 
	#WAVE_SCALE
 0x00040000

	)

236 
	#WAVE_FRACTIONS
 0x00080000

	)

238 
	#WAVE_ROM
 0x40000000

	)

239 
	#WAVE_MULAW
 0x20000000

	)

242 
	mËn
;

243 
	mloİ_¡¬t
, 
	mloİ_’d
;

261 
	mba£_äeq
;

262 
	mba£_nÙe
;

263 
	mhigh_nÙe
;

264 
	mlow_nÙe
;

265 
	m·Âšg
;

266 
	md‘unšg
;

271 
	m’v_¿‹
[ 6 ];

272 
	m’v_off£t
[ 6 ];

280 
	mŒemŞo_sw“p
;

281 
	mŒemŞo_¿‹
;

282 
	mŒemŞo_d•th
;

284 
	mvib¿to_sw“p
;

285 
	mvib¿to_¿‹
;

286 
	mvib¿to_d•th
;

288 
	msÿË_äequ’cy
;

289 
	msÿË_çùÜ
;

291 
	mvŞume
;

292 
	mäaùiÚs
;

293 
	m»£rved1
;

294 
	m¥¬e
[2];

295 
	md©a
[1];

298 
	ssy£x_šfo
 {

299 
	mkey
;

300 
	#SYSEX_PATCH
 
	`_PATCHKEY
(0x05)

	)

301 
	#MAUI_PATCH
 
	`_PATCHKEY
(0x06)

	)

302 
	mdeviû_no
;

303 
	mËn
;

304 
	md©a
[1];

327 
	#SEQ_NOTEOFF
 0

	)

328 
	#SEQ_FMNOTEOFF
 
SEQ_NOTEOFF


	)

329 
	#SEQ_NOTEON
 1

	)

330 
	#SEQ_FMNOTEON
 
SEQ_NOTEON


	)

331 
	#SEQ_WAIT
 
TMR_WAIT_ABS


	)

332 
	#SEQ_PGMCHANGE
 3

	)

333 
	#SEQ_FMPGMCHANGE
 
SEQ_PGMCHANGE


	)

334 
	#SEQ_SYNCTIMER
 
TMR_START


	)

335 
	#SEQ_MIDIPUTC
 5

	)

336 
	#SEQ_DRUMON
 6

	)

337 
	#SEQ_DRUMOFF
 7

	)

338 
	#SEQ_ECHO
 
TMR_ECHO


	)

339 
	#SEQ_AFTERTOUCH
 9

	)

340 
	#SEQ_CONTROLLER
 10

	)

354 
	#CTL_BANK_SELECT
 0x00

	)

355 
	#CTL_MODWHEEL
 0x01

	)

356 
	#CTL_BREATH
 0x02

	)

358 
	#CTL_FOOT
 0x04

	)

359 
	#CTL_PORTAMENTO_TIME
 0x05

	)

360 
	#CTL_DATA_ENTRY
 0x06

	)

361 
	#CTL_MAIN_VOLUME
 0x07

	)

362 
	#CTL_BALANCE
 0x08

	)

364 
	#CTL_PAN
 0x0a

	)

365 
	#CTL_EXPRESSION
 0x0b

	)

370 
	#CTL_GENERAL_PURPOSE1
 0x10

	)

371 
	#CTL_GENERAL_PURPOSE2
 0x11

	)

372 
	#CTL_GENERAL_PURPOSE3
 0x12

	)

373 
	#CTL_GENERAL_PURPOSE4
 0x13

	)

383 
	#CTL_DAMPER_PEDAL
 0x40

	)

384 
	#CTL_SUSTAIN
 0x40

	)

385 
	#CTL_HOLD
 0x40

	)

386 
	#CTL_PORTAMENTO
 0x41

	)

387 
	#CTL_SOSTENUTO
 0x42

	)

388 
	#CTL_SOFT_PEDAL
 0x43

	)

390 
	#CTL_HOLD2
 0x45

	)

393 
	#CTL_GENERAL_PURPOSE5
 0x50

	)

394 
	#CTL_GENERAL_PURPOSE6
 0x51

	)

395 
	#CTL_GENERAL_PURPOSE7
 0x52

	)

396 
	#CTL_GENERAL_PURPOSE8
 0x53

	)

398 
	#CTL_EXT_EFF_DEPTH
 0x5b

	)

399 
	#CTL_TREMOLO_DEPTH
 0x5c

	)

400 
	#CTL_CHORUS_DEPTH
 0x5d

	)

401 
	#CTL_DETUNE_DEPTH
 0x5e

	)

402 
	#CTL_CELESTE_DEPTH
 0x5

	)

403 
	#CTL_PHASER_DEPTH
 0x5f

	)

404 
	#CTL_DATA_INCREMENT
 0x60

	)

405 
	#CTL_DATA_DECREMENT
 0x61

	)

406 
	#CTL_NONREG_PARM_NUM_LSB
 0x62

	)

407 
	#CTL_NONREG_PARM_NUM_MSB
 0x63

	)

408 
	#CTL_REGIST_PARM_NUM_LSB
 0x64

	)

409 
	#CTL_REGIST_PARM_NUM_MSB
 0x65

	)

414 
	#CTRL_PITCH_BENDER
 255

	)

415 
	#CTRL_PITCH_BENDER_RANGE
 254

	)

416 
	#CTRL_EXPRESSION
 253

	)

417 
	#CTRL_MAIN_VOLUME
 252

	)

418 
	#SEQ_BALANCE
 11

	)

419 
	#SEQ_VOLMODE
 12

	)

425 
	#VOL_METHOD_ADAGIO
 1

	)

426 
	#VOL_METHOD_LINEAR
 2

	)

437 
	#SEQ_FULLSIZE
 0xfd

	)

458 
	#SEQ_PRIVATE
 0xã

	)

459 
	#SEQ_EXTENDED
 0xfà

	)

465 
	tsbi_š¡r_d©a
[32];

467 
	ssbi_š¡rum’t
 {

468 
	mkey
;

469 
	#FM_PATCH
 
	`_PATCHKEY
(0x01)

	)

470 
	#OPL3_PATCH
 
	`_PATCHKEY
(0x03)

	)

471 
	mdeviû
;

472 
	mchªÃl
;

473 
sbi_š¡r_d©a
 
	mİ”©Üs
;

476 
	ssyÁh_šfo
 {

477 
	mÇme
[30];

478 
	mdeviû
;

479 
	msyÁh_ty³
;

480 
	#SYNTH_TYPE_FM
 0

	)

481 
	#SYNTH_TYPE_SAMPLE
 1

	)

482 
	#SYNTH_TYPE_MIDI
 2

	)

484 
	msyÁh_subty³
;

485 
	#FM_TYPE_ADLIB
 0x00

	)

486 
	#FM_TYPE_OPL3
 0x01

	)

487 
	#MIDI_TYPE_MPU401
 0x401

	)

489 
	#SAMPLE_TYPE_BASIC
 0x10

	)

490 
	#SAMPLE_TYPE_GUS
 
SAMPLE_TYPE_BASIC


	)

491 
	#SAMPLE_TYPE_WAVEFRONT
 0x11

	)

493 
	m³rc_mode
;

494 
	mÄ_voiûs
;

495 
	mÄ_drums
;

496 
	mš¡r_bªk_size
;

497 
	mÿ·b™›s
;

498 
	#SYNTH_CAP_PERCMODE
 0x00000001

	)

499 
	#SYNTH_CAP_OPL3
 0x00000002

	)

500 
	#SYNTH_CAP_INPUT
 0x00000004

	)

501 
	mdumm›s
[19];

504 
	ssound_tim”_šfo
 {

505 
	mÇme
[32];

506 
	mÿps
;

509 
	#MIDI_CAP_MPU401
 1

	)

511 
	smidi_šfo
 {

512 
	mÇme
[30];

513 
	mdeviû
;

514 
	mÿ·b™›s
;

515 
	mdev_ty³
;

516 
	mdumm›s
[18];

523 
	mcmd
;

524 
	mÄ_¬gs
, 
	mÄ_»tuºs
;

525 
	md©a
[30];

526 } 
	tmpu_commªd_»c
;

528 
	#SNDCTL_MIDI_PRETIME
 
	`_SIOWR
('m', 0, )

	)

529 
	#SNDCTL_MIDI_MPUMODE
 
	`_SIOWR
('m', 1, )

	)

530 
	#SNDCTL_MIDI_MPUCMD
 
	`_SIOWR
('m', 2, 
mpu_commªd_»c
)

	)

536 
	#SNDCTL_DSP_RESET
 
	`_SIO
 ('P', 0)

	)

537 
	#SNDCTL_DSP_SYNC
 
	`_SIO
 ('P', 1)

	)

538 
	#SNDCTL_DSP_SPEED
 
	`_SIOWR
('P', 2, )

	)

539 
	#SNDCTL_DSP_STEREO
 
	`_SIOWR
('P', 3, )

	)

540 
	#SNDCTL_DSP_GETBLKSIZE
 
	`_SIOWR
('P', 4, )

	)

541 
	#SNDCTL_DSP_SAMPLESIZE
 
SNDCTL_DSP_SETFMT


	)

542 
	#SNDCTL_DSP_CHANNELS
 
	`_SIOWR
('P', 6, )

	)

543 
	#SOUND_PCM_WRITE_CHANNELS
 
SNDCTL_DSP_CHANNELS


	)

544 
	#SOUND_PCM_WRITE_FILTER
 
	`_SIOWR
('P', 7, )

	)

545 
	#SNDCTL_DSP_POST
 
	`_SIO
 ('P', 8)

	)

546 
	#SNDCTL_DSP_SUBDIVIDE
 
	`_SIOWR
('P', 9, )

	)

547 
	#SNDCTL_DSP_SETFRAGMENT
 
	`_SIOWR
('P',10, )

	)

550 
	#SNDCTL_DSP_GETFMTS
 
	`_SIOR
 ('P',11, è

	)

551 
	#SNDCTL_DSP_SETFMT
 
	`_SIOWR
('P',5, è

	)

552 
	#AFMT_QUERY
 0x00000000

	)

553 
	#AFMT_MU_LAW
 0x00000001

	)

554 
	#AFMT_A_LAW
 0x00000002

	)

555 
	#AFMT_IMA_ADPCM
 0x00000004

	)

556 
	#AFMT_U8
 0x00000008

	)

557 
	#AFMT_S16_LE
 0x00000010

	)

558 
	#AFMT_S16_BE
 0x00000020

	)

559 
	#AFMT_S8
 0x00000040

	)

560 
	#AFMT_U16_LE
 0x00000080

	)

561 
	#AFMT_U16_BE
 0x00000100

	)

562 
	#AFMT_MPEG
 0x00000200

	)

563 
	#AFMT_AC3
 0x00000400

	)

568 
	saudio_buf_šfo
 {

569 
	mäagm’ts
;

570 
	mäag¡Ù®
;

571 
	mäagsize
;

573 
	mby‹s
;

575 } 
	taudio_buf_šfo
;

577 
	#SNDCTL_DSP_GETOSPACE
 
	`_SIOR
 ('P',12, 
audio_buf_šfo
)

	)

578 
	#SNDCTL_DSP_GETISPACE
 
	`_SIOR
 ('P',13, 
audio_buf_šfo
)

	)

579 
	#SNDCTL_DSP_NONBLOCK
 
	`_SIO
 ('P',14)

	)

580 
	#SNDCTL_DSP_GETCAPS
 
	`_SIOR
 ('P',15, )

	)

581 
	#DSP_CAP_REVISION
 0x000000fà

	)

582 
	#DSP_CAP_DUPLEX
 0x00000100

	)

583 
	#DSP_CAP_REALTIME
 0x00000200

	)

584 
	#DSP_CAP_BATCH
 0x00000400

	)

588 
	#DSP_CAP_COPROC
 0x00000800

	)

591 
	#DSP_CAP_TRIGGER
 0x00001000

	)

592 
	#DSP_CAP_MMAP
 0x00002000

	)

593 
	#DSP_CAP_MULTI
 0x00004000

	)

594 
	#DSP_CAP_BIND
 0x00008000

	)

597 
	#SNDCTL_DSP_GETTRIGGER
 
	`_SIOR
 ('P',16, )

	)

598 
	#SNDCTL_DSP_SETTRIGGER
 
	`_SIOW
 ('P',16, )

	)

599 
	#PCM_ENABLE_INPUT
 0x00000001

	)

600 
	#PCM_ENABLE_OUTPUT
 0x00000002

	)

602 
	scouÁ_šfo
 {

603 
	mby‹s
;

604 
	mblocks
;

605 
	m±r
;

606 } 
	tcouÁ_šfo
;

608 
	#SNDCTL_DSP_GETIPTR
 
	`_SIOR
 ('P',17, 
couÁ_šfo
)

	)

609 
	#SNDCTL_DSP_GETOPTR
 
	`_SIOR
 ('P',18, 
couÁ_šfo
)

	)

611 
	sbuffmem_desc
 {

612 *
	mbufãr
;

613 
	msize
;

614 } 
	tbuffmem_desc
;

615 
	#SNDCTL_DSP_MAPINBUF
 
	`_SIOR
 ('P', 19, 
buffmem_desc
)

	)

616 
	#SNDCTL_DSP_MAPOUTBUF
 
	`_SIOR
 ('P', 20, 
buffmem_desc
)

	)

617 
	#SNDCTL_DSP_SETSYNCRO
 
	`_SIO
 ('P', 21)

	)

618 
	#SNDCTL_DSP_SETDUPLEX
 
	`_SIO
 ('P', 22)

	)

619 
	#SNDCTL_DSP_GETODELAY
 
	`_SIOR
 ('P', 23, )

	)

621 
	#SNDCTL_DSP_GETCHANNELMASK
 
	`_SIOWR
('P', 64, )

	)

622 
	#SNDCTL_DSP_BIND_CHANNEL
 
	`_SIOWR
('P', 65, )

	)

623 
	#DSP_BIND_QUERY
 0x00000000

	)

624 
	#DSP_BIND_FRONT
 0x00000001

	)

625 
	#DSP_BIND_SURR
 0x00000002

	)

626 
	#DSP_BIND_CENTER_LFE
 0x00000004

	)

627 
	#DSP_BIND_HANDSET
 0x00000008

	)

628 
	#DSP_BIND_MIC
 0x00000010

	)

629 
	#DSP_BIND_MODEM1
 0x00000020

	)

630 
	#DSP_BIND_MODEM2
 0x00000040

	)

631 
	#DSP_BIND_I2S
 0x00000080

	)

632 
	#DSP_BIND_SPDIF
 0x00000100

	)

634 
	#SNDCTL_DSP_SETSPDIF
 
	`_SIOW
 ('P', 66, )

	)

635 
	#SNDCTL_DSP_GETSPDIF
 
	`_SIOR
 ('P', 67, )

	)

636 
	#SPDIF_PRO
 0x0001

	)

637 
	#SPDIF_N_AUD
 0x0002

	)

638 
	#SPDIF_COPY
 0x0004

	)

639 
	#SPDIF_PRE
 0x0008

	)

640 
	#SPDIF_CC
 0x07f0

	)

641 
	#SPDIF_L
 0x0800

	)

642 
	#SPDIF_DRS
 0x4000

	)

643 
	#SPDIF_V
 0x8000

	)

656 
	#SNDCTL_DSP_PROFILE
 
	`_SIOW
 ('P', 23, )

	)

657 
	#APF_NORMAL
 0

	)

658 
	#APF_NETWORK
 1

	)

659 
	#APF_CPUINTENS
 2

	)

661 
	#SOUND_PCM_READ_RATE
 
	`_SIOR
 ('P', 2, )

	)

662 
	#SOUND_PCM_READ_CHANNELS
 
	`_SIOR
 ('P', 6, )

	)

663 
	#SOUND_PCM_READ_BITS
 
	`_SIOR
 ('P', 5, )

	)

664 
	#SOUND_PCM_READ_FILTER
 
	`_SIOR
 ('P', 7, )

	)

667 
	#SOUND_PCM_WRITE_BITS
 
SNDCTL_DSP_SETFMT


	)

668 
	#SOUND_PCM_WRITE_RATE
 
SNDCTL_DSP_SPEED


	)

669 
	#SOUND_PCM_POST
 
SNDCTL_DSP_POST


	)

670 
	#SOUND_PCM_RESET
 
SNDCTL_DSP_RESET


	)

671 
	#SOUND_PCM_SYNC
 
SNDCTL_DSP_SYNC


	)

672 
	#SOUND_PCM_SUBDIVIDE
 
SNDCTL_DSP_SUBDIVIDE


	)

673 
	#SOUND_PCM_SETFRAGMENT
 
SNDCTL_DSP_SETFRAGMENT


	)

674 
	#SOUND_PCM_GETFMTS
 
SNDCTL_DSP_GETFMTS


	)

675 
	#SOUND_PCM_SETFMT
 
SNDCTL_DSP_SETFMT


	)

676 
	#SOUND_PCM_GETOSPACE
 
SNDCTL_DSP_GETOSPACE


	)

677 
	#SOUND_PCM_GETISPACE
 
SNDCTL_DSP_GETISPACE


	)

678 
	#SOUND_PCM_NONBLOCK
 
SNDCTL_DSP_NONBLOCK


	)

679 
	#SOUND_PCM_GETCAPS
 
SNDCTL_DSP_GETCAPS


	)

680 
	#SOUND_PCM_GETTRIGGER
 
SNDCTL_DSP_GETTRIGGER


	)

681 
	#SOUND_PCM_SETTRIGGER
 
SNDCTL_DSP_SETTRIGGER


	)

682 
	#SOUND_PCM_SETSYNCRO
 
SNDCTL_DSP_SETSYNCRO


	)

683 
	#SOUND_PCM_GETIPTR
 
SNDCTL_DSP_GETIPTR


	)

684 
	#SOUND_PCM_GETOPTR
 
SNDCTL_DSP_GETOPTR


	)

685 
	#SOUND_PCM_MAPINBUF
 
SNDCTL_DSP_MAPINBUF


	)

686 
	#SOUND_PCM_MAPOUTBUF
 
SNDCTL_DSP_MAPOUTBUF


	)

693 
	scİr_bufãr
 {

694 
	mcommªd
;

695 
	mæags
;

696 
	#CPF_NONE
 0x0000

	)

697 
	#CPF_FIRST
 0x0001

	)

698 
	#CPF_LAST
 0x0002

	)

699 
	mËn
;

700 
	moffs
;

702 
	md©a
[4000];

703 } 
	tcİr_bufãr
;

705 
	scİr_debug_buf
 {

706 
	mcommªd
;

707 
	m·rm1
;

708 
	m·rm2
;

709 
	mæags
;

710 
	mËn
;

711 } 
	tcİr_debug_buf
;

713 
	scİr_msg
 {

714 
	mËn
;

715 
	md©a
[4000];

716 } 
	tcİr_msg
;

718 
	#SNDCTL_COPR_RESET
 
	`_SIO
 ('C', 0)

	)

719 
	#SNDCTL_COPR_LOAD
 
	`_SIOWR
('C', 1, 
cİr_bufãr
)

	)

720 
	#SNDCTL_COPR_RDATA
 
	`_SIOWR
('C', 2, 
cİr_debug_buf
)

	)

721 
	#SNDCTL_COPR_RCODE
 
	`_SIOWR
('C', 3, 
cİr_debug_buf
)

	)

722 
	#SNDCTL_COPR_WDATA
 
	`_SIOW
 ('C', 4, 
cİr_debug_buf
)

	)

723 
	#SNDCTL_COPR_WCODE
 
	`_SIOW
 ('C', 5, 
cİr_debug_buf
)

	)

724 
	#SNDCTL_COPR_RUN
 
	`_SIOWR
('C', 6, 
cİr_debug_buf
)

	)

725 
	#SNDCTL_COPR_HALT
 
	`_SIOWR
('C', 7, 
cİr_debug_buf
)

	)

726 
	#SNDCTL_COPR_SENDMSG
 
	`_SIOWR
('C', 8, 
cİr_msg
)

	)

727 
	#SNDCTL_COPR_RCVMSG
 
	`_SIOR
 ('C', 9, 
cİr_msg
)

	)

742 
	#SOUND_MIXER_NRDEVICES
 25

	)

743 
	#SOUND_MIXER_VOLUME
 0

	)

744 
	#SOUND_MIXER_BASS
 1

	)

745 
	#SOUND_MIXER_TREBLE
 2

	)

746 
	#SOUND_MIXER_SYNTH
 3

	)

747 
	#SOUND_MIXER_PCM
 4

	)

748 
	#SOUND_MIXER_SPEAKER
 5

	)

749 
	#SOUND_MIXER_LINE
 6

	)

750 
	#SOUND_MIXER_MIC
 7

	)

751 
	#SOUND_MIXER_CD
 8

	)

752 
	#SOUND_MIXER_IMIX
 9

	)

753 
	#SOUND_MIXER_ALTPCM
 10

	)

754 
	#SOUND_MIXER_RECLEV
 11

	)

755 
	#SOUND_MIXER_IGAIN
 12

	)

756 
	#SOUND_MIXER_OGAIN
 13

	)

763 
	#SOUND_MIXER_LINE1
 14

	)

764 
	#SOUND_MIXER_LINE2
 15

	)

765 
	#SOUND_MIXER_LINE3
 16

	)

766 
	#SOUND_MIXER_DIGITAL1
 17

	)

767 
	#SOUND_MIXER_DIGITAL2
 18

	)

768 
	#SOUND_MIXER_DIGITAL3
 19

	)

769 
	#SOUND_MIXER_PHONEIN
 20

	)

770 
	#SOUND_MIXER_PHONEOUT
 21

	)

771 
	#SOUND_MIXER_VIDEO
 22

	)

772 
	#SOUND_MIXER_RADIO
 23

	)

773 
	#SOUND_MIXER_MONITOR
 24

	)

777 
	#SOUND_ONOFF_MIN
 28

	)

778 
	#SOUND_ONOFF_MAX
 30

	)

781 
	#SOUND_MIXER_NONE
 31

	)

787 
	#SOUND_MIXER_ENHANCE
 
SOUND_MIXER_NONE


	)

788 
	#SOUND_MIXER_MUTE
 
SOUND_MIXER_NONE


	)

789 
	#SOUND_MIXER_LOUD
 
SOUND_MIXER_NONE


	)

792 
	#SOUND_DEVICE_LABELS
 {"Vol ", "Bass ", "Trebl", "Synth", "Pcm ", "Spkr ", "Line ", \

795 "PhÚeIn", "PhÚeOut", "Video", "Radio", "MÚ™Ü"}

	)

797 
	#SOUND_DEVICE_NAMES
 {"vol", "bass", "treble", "synth", "pcm", "speaker", "line", \

800 "phš", "phout", "video", "¿dio", "mÚ™Ü"}

	)

804 
	#SOUND_MIXER_RECSRC
 0xfà

	)

805 
	#SOUND_MIXER_DEVMASK
 0xã

	)

806 
	#SOUND_MIXER_RECMASK
 0xfd

	)

807 
	#SOUND_MIXER_CAPS
 0xfc

	)

808 
	#SOUND_CAP_EXCL_INPUT
 0x00000001

	)

809 
	#SOUND_MIXER_STEREODEVS
 0xfb

	)

810 
	#SOUND_MIXER_OUTSRC
 0xç

	)

811 
	#SOUND_MIXER_OUTMASK
 0xf9

	)

815 
	#SOUND_MASK_VOLUME
 (1 << 
SOUND_MIXER_VOLUME
)

	)

816 
	#SOUND_MASK_BASS
 (1 << 
SOUND_MIXER_BASS
)

	)

817 
	#SOUND_MASK_TREBLE
 (1 << 
SOUND_MIXER_TREBLE
)

	)

818 
	#SOUND_MASK_SYNTH
 (1 << 
SOUND_MIXER_SYNTH
)

	)

819 
	#SOUND_MASK_PCM
 (1 << 
SOUND_MIXER_PCM
)

	)

820 
	#SOUND_MASK_SPEAKER
 (1 << 
SOUND_MIXER_SPEAKER
)

	)

821 
	#SOUND_MASK_LINE
 (1 << 
SOUND_MIXER_LINE
)

	)

822 
	#SOUND_MASK_MIC
 (1 << 
SOUND_MIXER_MIC
)

	)

823 
	#SOUND_MASK_CD
 (1 << 
SOUND_MIXER_CD
)

	)

824 
	#SOUND_MASK_IMIX
 (1 << 
SOUND_MIXER_IMIX
)

	)

825 
	#SOUND_MASK_ALTPCM
 (1 << 
SOUND_MIXER_ALTPCM
)

	)

826 
	#SOUND_MASK_RECLEV
 (1 << 
SOUND_MIXER_RECLEV
)

	)

827 
	#SOUND_MASK_IGAIN
 (1 << 
SOUND_MIXER_IGAIN
)

	)

828 
	#SOUND_MASK_OGAIN
 (1 << 
SOUND_MIXER_OGAIN
)

	)

829 
	#SOUND_MASK_LINE1
 (1 << 
SOUND_MIXER_LINE1
)

	)

830 
	#SOUND_MASK_LINE2
 (1 << 
SOUND_MIXER_LINE2
)

	)

831 
	#SOUND_MASK_LINE3
 (1 << 
SOUND_MIXER_LINE3
)

	)

832 
	#SOUND_MASK_DIGITAL1
 (1 << 
SOUND_MIXER_DIGITAL1
)

	)

833 
	#SOUND_MASK_DIGITAL2
 (1 << 
SOUND_MIXER_DIGITAL2
)

	)

834 
	#SOUND_MASK_DIGITAL3
 (1 << 
SOUND_MIXER_DIGITAL3
)

	)

835 
	#SOUND_MASK_PHONEIN
 (1 << 
SOUND_MIXER_PHONEIN
)

	)

836 
	#SOUND_MASK_PHONEOUT
 (1 << 
SOUND_MIXER_PHONEOUT
)

	)

837 
	#SOUND_MASK_RADIO
 (1 << 
SOUND_MIXER_RADIO
)

	)

838 
	#SOUND_MASK_VIDEO
 (1 << 
SOUND_MIXER_VIDEO
)

	)

839 
	#SOUND_MASK_MONITOR
 (1 << 
SOUND_MIXER_MONITOR
)

	)

842 
	#SOUND_MASK_MUTE
 (1 << 
SOUND_MIXER_MUTE
)

	)

843 
	#SOUND_MASK_ENHANCE
 (1 << 
SOUND_MIXER_ENHANCE
)

	)

844 
	#SOUND_MASK_LOUD
 (1 << 
SOUND_MIXER_LOUD
)

	)

846 
	#MIXER_READ
(
dev
è
	`_SIOR
('M', dev, )

	)

847 
	#SOUND_MIXER_READ_VOLUME
 
	`MIXER_READ
(
SOUND_MIXER_VOLUME
)

	)

848 
	#SOUND_MIXER_READ_BASS
 
	`MIXER_READ
(
SOUND_MIXER_BASS
)

	)

849 
	#SOUND_MIXER_READ_TREBLE
 
	`MIXER_READ
(
SOUND_MIXER_TREBLE
)

	)

850 
	#SOUND_MIXER_READ_SYNTH
 
	`MIXER_READ
(
SOUND_MIXER_SYNTH
)

	)

851 
	#SOUND_MIXER_READ_PCM
 
	`MIXER_READ
(
SOUND_MIXER_PCM
)

	)

852 
	#SOUND_MIXER_READ_SPEAKER
 
	`MIXER_READ
(
SOUND_MIXER_SPEAKER
)

	)

853 
	#SOUND_MIXER_READ_LINE
 
	`MIXER_READ
(
SOUND_MIXER_LINE
)

	)

854 
	#SOUND_MIXER_READ_MIC
 
	`MIXER_READ
(
SOUND_MIXER_MIC
)

	)

855 
	#SOUND_MIXER_READ_CD
 
	`MIXER_READ
(
SOUND_MIXER_CD
)

	)

856 
	#SOUND_MIXER_READ_IMIX
 
	`MIXER_READ
(
SOUND_MIXER_IMIX
)

	)

857 
	#SOUND_MIXER_READ_ALTPCM
 
	`MIXER_READ
(
SOUND_MIXER_ALTPCM
)

	)

858 
	#SOUND_MIXER_READ_RECLEV
 
	`MIXER_READ
(
SOUND_MIXER_RECLEV
)

	)

859 
	#SOUND_MIXER_READ_IGAIN
 
	`MIXER_READ
(
SOUND_MIXER_IGAIN
)

	)

860 
	#SOUND_MIXER_READ_OGAIN
 
	`MIXER_READ
(
SOUND_MIXER_OGAIN
)

	)

861 
	#SOUND_MIXER_READ_LINE1
 
	`MIXER_READ
(
SOUND_MIXER_LINE1
)

	)

862 
	#SOUND_MIXER_READ_LINE2
 
	`MIXER_READ
(
SOUND_MIXER_LINE2
)

	)

863 
	#SOUND_MIXER_READ_LINE3
 
	`MIXER_READ
(
SOUND_MIXER_LINE3
)

	)

866 
	#SOUND_MIXER_READ_MUTE
 
	`MIXER_READ
(
SOUND_MIXER_MUTE
)

	)

867 
	#SOUND_MIXER_READ_ENHANCE
 
	`MIXER_READ
(
SOUND_MIXER_ENHANCE
)

	)

868 
	#SOUND_MIXER_READ_LOUD
 
	`MIXER_READ
(
SOUND_MIXER_LOUD
)

	)

870 
	#SOUND_MIXER_READ_RECSRC
 
	`MIXER_READ
(
SOUND_MIXER_RECSRC
)

	)

871 
	#SOUND_MIXER_READ_DEVMASK
 
	`MIXER_READ
(
SOUND_MIXER_DEVMASK
)

	)

872 
	#SOUND_MIXER_READ_RECMASK
 
	`MIXER_READ
(
SOUND_MIXER_RECMASK
)

	)

873 
	#SOUND_MIXER_READ_STEREODEVS
 
	`MIXER_READ
(
SOUND_MIXER_STEREODEVS
)

	)

874 
	#SOUND_MIXER_READ_CAPS
 
	`MIXER_READ
(
SOUND_MIXER_CAPS
)

	)

876 
	#MIXER_WRITE
(
dev
è
	`_SIOWR
('M', dev, )

	)

877 
	#SOUND_MIXER_WRITE_VOLUME
 
	`MIXER_WRITE
(
SOUND_MIXER_VOLUME
)

	)

878 
	#SOUND_MIXER_WRITE_BASS
 
	`MIXER_WRITE
(
SOUND_MIXER_BASS
)

	)

879 
	#SOUND_MIXER_WRITE_TREBLE
 
	`MIXER_WRITE
(
SOUND_MIXER_TREBLE
)

	)

880 
	#SOUND_MIXER_WRITE_SYNTH
 
	`MIXER_WRITE
(
SOUND_MIXER_SYNTH
)

	)

881 
	#SOUND_MIXER_WRITE_PCM
 
	`MIXER_WRITE
(
SOUND_MIXER_PCM
)

	)

882 
	#SOUND_MIXER_WRITE_SPEAKER
 
	`MIXER_WRITE
(
SOUND_MIXER_SPEAKER
)

	)

883 
	#SOUND_MIXER_WRITE_LINE
 
	`MIXER_WRITE
(
SOUND_MIXER_LINE
)

	)

884 
	#SOUND_MIXER_WRITE_MIC
 
	`MIXER_WRITE
(
SOUND_MIXER_MIC
)

	)

885 
	#SOUND_MIXER_WRITE_CD
 
	`MIXER_WRITE
(
SOUND_MIXER_CD
)

	)

886 
	#SOUND_MIXER_WRITE_IMIX
 
	`MIXER_WRITE
(
SOUND_MIXER_IMIX
)

	)

887 
	#SOUND_MIXER_WRITE_ALTPCM
 
	`MIXER_WRITE
(
SOUND_MIXER_ALTPCM
)

	)

888 
	#SOUND_MIXER_WRITE_RECLEV
 
	`MIXER_WRITE
(
SOUND_MIXER_RECLEV
)

	)

889 
	#SOUND_MIXER_WRITE_IGAIN
 
	`MIXER_WRITE
(
SOUND_MIXER_IGAIN
)

	)

890 
	#SOUND_MIXER_WRITE_OGAIN
 
	`MIXER_WRITE
(
SOUND_MIXER_OGAIN
)

	)

891 
	#SOUND_MIXER_WRITE_LINE1
 
	`MIXER_WRITE
(
SOUND_MIXER_LINE1
)

	)

892 
	#SOUND_MIXER_WRITE_LINE2
 
	`MIXER_WRITE
(
SOUND_MIXER_LINE2
)

	)

893 
	#SOUND_MIXER_WRITE_LINE3
 
	`MIXER_WRITE
(
SOUND_MIXER_LINE3
)

	)

896 
	#SOUND_MIXER_WRITE_MUTE
 
	`MIXER_WRITE
(
SOUND_MIXER_MUTE
)

	)

897 
	#SOUND_MIXER_WRITE_ENHANCE
 
	`MIXER_WRITE
(
SOUND_MIXER_ENHANCE
)

	)

898 
	#SOUND_MIXER_WRITE_LOUD
 
	`MIXER_WRITE
(
SOUND_MIXER_LOUD
)

	)

900 
	#SOUND_MIXER_WRITE_RECSRC
 
	`MIXER_WRITE
(
SOUND_MIXER_RECSRC
)

	)

902 
	smix”_šfo


904 
	mid
[16];

905 
	mÇme
[32];

906 
	mmodify_couÁ”
;

907 
	mfËrs
[10];

908 } 
	tmix”_šfo
;

910 
	s_Şd_mix”_šfo


912 
	mid
[16];

913 
	mÇme
[32];

914 } 
	t_Şd_mix”_šfo
;

916 
	#SOUND_MIXER_INFO
 
	`_SIOR
 ('M', 101, 
mix”_šfo
)

	)

917 
	#SOUND_OLD_MIXER_INFO
 
	`_SIOR
 ('M', 101, 
_Şd_mix”_šfo
)

	)

925 
	tmix”_»cÜd
[128];

927 
	#SOUND_MIXER_ACCESS
 
	`_SIOWR
('M', 102, 
mix”_»cÜd
)

	)

932 
	#SOUND_MIXER_AGC
 
	`_SIOWR
('M', 103, )

	)

933 
	#SOUND_MIXER_3DSE
 
	`_SIOWR
('M', 104, )

	)

939 
	#SOUND_MIXER_PRIVATE1
 
	`_SIOWR
('M', 111, )

	)

940 
	#SOUND_MIXER_PRIVATE2
 
	`_SIOWR
('M', 112, )

	)

941 
	#SOUND_MIXER_PRIVATE3
 
	`_SIOWR
('M', 113, )

	)

942 
	#SOUND_MIXER_PRIVATE4
 
	`_SIOWR
('M', 114, )

	)

943 
	#SOUND_MIXER_PRIVATE5
 
	`_SIOWR
('M', 115, )

	)

953 
	smix”_vŞ_bË
 {

954 
	mnum
;

955 
	mÇme
[32];

956 
	mËv–s
[32];

957 } 
	tmix”_vŞ_bË
;

959 
	#SOUND_MIXER_GETLEVELS
 
	`_SIOWR
('M', 116, 
mix”_vŞ_bË
)

	)

960 
	#SOUND_MIXER_SETLEVELS
 
	`_SIOWR
('M', 117, 
mix”_vŞ_bË
)

	)

968 
	#OSS_GETVERSION
 
	`_SIOR
 ('M', 118, )

	)

988 
	#EV_SEQ_LOCAL
 0x80

	)

989 
	#EV_TIMING
 0x81

	)

990 
	#EV_CHN_COMMON
 0x92

	)

991 
	#EV_CHN_VOICE
 0x93

	)

992 
	#EV_SYSEX
 0x94

	)

1002 
	#MIDI_NOTEOFF
 0x80

	)

1003 
	#MIDI_NOTEON
 0x90

	)

1004 
	#MIDI_KEY_PRESSURE
 0xA0

	)

1010 
	#MIDI_CTL_CHANGE
 0xB0

	)

1011 
	#MIDI_PGM_CHANGE
 0xC0

	)

1012 
	#MIDI_CHN_PRESSURE
 0xD0

	)

1013 
	#MIDI_PITCH_BEND
 0xE0

	)

1015 
	#MIDI_SYSTEM_PREFIX
 0xF0

	)

1020 
	#TMR_WAIT_REL
 1

	)

1021 
	#TMR_WAIT_ABS
 2

	)

1022 
	#TMR_STOP
 3

	)

1023 
	#TMR_START
 4

	)

1024 
	#TMR_CONTINUE
 5

	)

1025 
	#TMR_TEMPO
 6

	)

1026 
	#TMR_ECHO
 8

	)

1027 
	#TMR_CLOCK
 9

	)

1028 
	#TMR_SPP
 10

	)

1029 
	#TMR_TIMESIG
 11

	)

1034 
	#LOCL_STARTAUDIO
 1

	)

1052 
	#SEQ_DECLAREBUF
(è
	`SEQ_USE_EXTBUF
()

	)

1054 
£qbuf_dump
();

1056 
	#SEQ_PM_DEFINES
 
__foo_b¬___


	)

1058 
	#SEQ_LOAD_GMINSTR
(
dev
, 
š¡r
)

	)

1059 
	#SEQ_LOAD_GMDRUM
(
dev
, 
drum
)

	)

1061 
	#_SEQ_EXTERN
 

	)

1062 
	#SEQ_USE_EXTBUF
() \

1063 
_SEQ_EXTERN
 
_£qbuf
[]; \

1064 
_SEQ_EXTERN
 
_£qbuæ’
; _SEQ_EXTERN 
_£qbuåŒ


	)

1066 #iâdeà
USE_SIMPLE_MACROS


1086 
	#SEQ_DEFINEBUF
(
Ën
è
_£qbuf
[Ën]; 
_£qbuæ’
 =†’;
_£qbuåŒ
 = 0

	)

1087 
	#_SEQ_NEEDBUF
(
Ën
èià((
_£qbuåŒ
+Ö’)è> 
_£qbuæ’
è
	`£qbuf_dump
()

	)

1088 
	#_SEQ_ADVBUF
(
Ën
è
_£qbuåŒ
 +ğ
	)
len

1089 
	#SEQ_DUMPBUF
 
£qbuf_dump


	)

1105 
	#_SEQ_NEEDBUF
(
Ën
è

	)

1108 
	#SEQ_VOLUME_MODE
(
dev
, 
mode
è{
	`_SEQ_NEEDBUF
(8);\

1109 
_£qbuf
[
_£qbuåŒ
] = 
SEQ_EXTENDED
;\

1110 
_£qbuf
[
_£qbuåŒ
+1] = 
SEQ_VOLMODE
;\

1111 
_£qbuf
[
_£qbuåŒ
+2] = (
dev
);\

1112 
_£qbuf
[
_£qbuåŒ
+3] = (
mode
);\

1113 
_£qbuf
[
_£qbuåŒ
+4] = 0;\

1114 
_£qbuf
[
_£qbuåŒ
+5] = 0;\

1115 
_£qbuf
[
_£qbuåŒ
+6] = 0;\

1116 
_£qbuf
[
_£qbuåŒ
+7] = 0;\

1117 
	`_SEQ_ADVBUF
(8);}

	)

1123 
	#_CHN_VOICE
(
dev
, 
ev’t
, 
chn
, 
nÙe
, 
·rm
) \

1124 {
	`_SEQ_NEEDBUF
(8);\

1125 
_£qbuf
[
_£qbuåŒ
] = 
EV_CHN_VOICE
;\

1126 
_£qbuf
[
_£qbuåŒ
+1] = (
dev
);\

1127 
_£qbuf
[
_£qbuåŒ
+2] = (
ev’t
);\

1128 
_£qbuf
[
_£qbuåŒ
+3] = (
chn
);\

1129 
_£qbuf
[
_£qbuåŒ
+4] = (
nÙe
);\

1130 
_£qbuf
[
_£qbuåŒ
+5] = (
·rm
);\

1131 
_£qbuf
[
_£qbuåŒ
+6] = (0);\

1132 
_£qbuf
[
_£qbuåŒ
+7] = 0;\

1133 
	`_SEQ_ADVBUF
(8);}

	)

1135 
	#SEQ_START_NOTE
(
dev
, 
chn
, 
nÙe
, 
vŞ
) \

1136 
	`_CHN_VOICE
(
dev
, 
MIDI_NOTEON
, 
chn
, 
nÙe
, 
vŞ
)

	)

1138 
	#SEQ_STOP_NOTE
(
dev
, 
chn
, 
nÙe
, 
vŞ
) \

1139 
	`_CHN_VOICE
(
dev
, 
MIDI_NOTEOFF
, 
chn
, 
nÙe
, 
vŞ
)

	)

1141 
	#SEQ_KEY_PRESSURE
(
dev
, 
chn
, 
nÙe
, 
´essu»
) \

1142 
	`_CHN_VOICE
(
dev
, 
MIDI_KEY_PRESSURE
, 
chn
, 
nÙe
, 
´essu»
)

	)

1148 
	#_CHN_COMMON
(
dev
, 
ev’t
, 
chn
, 
p1
, 
p2
, 
w14
) \

1149 {
	`_SEQ_NEEDBUF
(8);\

1150 
_£qbuf
[
_£qbuåŒ
] = 
EV_CHN_COMMON
;\

1151 
_£qbuf
[
_£qbuåŒ
+1] = (
dev
);\

1152 
_£qbuf
[
_£qbuåŒ
+2] = (
ev’t
);\

1153 
_£qbuf
[
_£qbuåŒ
+3] = (
chn
);\

1154 
_£qbuf
[
_£qbuåŒ
+4] = (
p1
);\

1155 
_£qbuf
[
_£qbuåŒ
+5] = (
p2
);\

1156 *(*)&
_£qbuf
[
_£qbuåŒ
+6] = (
w14
);\

1157 
	`_SEQ_ADVBUF
(8);}

	)

1173 
	#SEQ_SYSEX
(
dev
, 
buf
, 
Ën
) \

1174 {
ii
, 
Î
=(
Ën
); \

1175 *
buå
=
buf
;\

1176 ià(
Î
>6)ll=6;\

1177 
	`_SEQ_NEEDBUF
(8);\

1178 
_£qbuf
[
_£qbuåŒ
] = 
EV_SYSEX
;\

1179 
_£qbuf
[
_£qbuåŒ
+1] = (
dev
);\

1180 
ii
=0;ii<
Î
;ii++)\

1181 
_£qbuf
[
_£qbuåŒ
+
ii
+2] = 
buå
[ii];\

1182 
ii
=
Î
;ii<6;ii++)\

1183 
_£qbuf
[
_£qbuåŒ
+
ii
+2] = 0xff;\

1184 
	`_SEQ_ADVBUF
(8);}

	)

1186 
	#SEQ_CHN_PRESSURE
(
dev
, 
chn
, 
´essu»
) \

1187 
	`_CHN_COMMON
(
dev
, 
MIDI_CHN_PRESSURE
, 
chn
, 
´essu»
, 0, 0)

	)

1189 
	#SEQ_SET_PATCH
 
SEQ_PGM_CHANGE


	)

1190 
	#SEQ_PGM_CHANGE
(
dev
, 
chn
, 
·tch
) \

1191 
	`_CHN_COMMON
(
dev
, 
MIDI_PGM_CHANGE
, 
chn
, 
·tch
, 0, 0)

	)

1193 
	#SEQ_CONTROL
(
dev
, 
chn
, 
cÚŒŞËr
, 
v®ue
) \

1194 
	`_CHN_COMMON
(
dev
, 
MIDI_CTL_CHANGE
, 
chn
, 
cÚŒŞËr
, 0, 
v®ue
)

	)

1196 
	#SEQ_BENDER
(
dev
, 
chn
, 
v®ue
) \

1197 
	`_CHN_COMMON
(
dev
, 
MIDI_PITCH_BEND
, 
chn
, 0, 0, 
v®ue
)

	)

1200 
	#SEQ_V2_X_CONTROL
(
dev
, 
voiû
, 
cÚŒŞËr
, 
v®ue
è{
	`_SEQ_NEEDBUF
(8);\

1201 
_£qbuf
[
_£qbuåŒ
] = 
SEQ_EXTENDED
;\

1202 
_£qbuf
[
_£qbuåŒ
+1] = 
SEQ_CONTROLLER
;\

1203 
_£qbuf
[
_£qbuåŒ
+2] = (
dev
);\

1204 
_£qbuf
[
_£qbuåŒ
+3] = (
voiû
);\

1205 
_£qbuf
[
_£qbuåŒ
+4] = (
cÚŒŞËr
);\

1206 
_£qbuf
[
_£qbuåŒ
+5] = ((
v®ue
)&0xff);\

1207 
_£qbuf
[
_£qbuåŒ
+6] = ((
v®ue
>>8)&0xff);\

1208 
_£qbuf
[
_£qbuåŒ
+7] = 0;\

1209 
	`_SEQ_ADVBUF
(8);}

	)

1214 
	#SEQ_PITCHBEND
(
dev
, 
voiû
, 
v®ue
è
	`SEQ_V2_X_CONTROL
(dev, voiû, 
CTRL_PITCH_BENDER
, v®ue)

	)

1215 
	#SEQ_BENDER_RANGE
(
dev
, 
voiû
, 
v®ue
è
	`SEQ_V2_X_CONTROL
(dev, voiû, 
CTRL_PITCH_BENDER_RANGE
, v®ue)

	)

1216 
	#SEQ_EXPRESSION
(
dev
, 
voiû
, 
v®ue
è
	`SEQ_CONTROL
(dev, voiû, 
CTL_EXPRESSION
, v®ue*128)

	)

1217 
	#SEQ_MAIN_VOLUME
(
dev
, 
voiû
, 
v®ue
è
	`SEQ_CONTROL
(dev, voiû, 
CTL_MAIN_VOLUME
, (v®ue*16383)/100)

	)

1218 
	#SEQ_PANNING
(
dev
, 
voiû
, 
pos
è
	`SEQ_CONTROL
(dev, voiû, 
CTL_PAN
, (pos+128è/ 2)

	)

1224 
	#_TIMER_EVENT
(
ev
, 
·rm
è{
	`_SEQ_NEEDBUF
(8);\

1225 
_£qbuf
[
_£qbuåŒ
+0] = 
EV_TIMING
; \

1226 
_£qbuf
[
_£qbuåŒ
+1] = (
ev
); \

1227 
_£qbuf
[
_£qbuåŒ
+2] = 0;\

1228 
_£qbuf
[
_£qbuåŒ
+3] = 0;\

1229 *(*)&
_£qbuf
[
_£qbuåŒ
+4] = (
·rm
); \

1230 
	`_SEQ_ADVBUF
(8);}

	)

1232 
	#SEQ_START_TIMER
(è
	`_TIMER_EVENT
(
TMR_START
, 0)

	)

1233 
	#SEQ_STOP_TIMER
(è
	`_TIMER_EVENT
(
TMR_STOP
, 0)

	)

1234 
	#SEQ_CONTINUE_TIMER
(è
	`_TIMER_EVENT
(
TMR_CONTINUE
, 0)

	)

1235 
	#SEQ_WAIT_TIME
(
ticks
è
	`_TIMER_EVENT
(
TMR_WAIT_ABS
,icks)

	)

1236 
	#SEQ_DELTA_TIME
(
ticks
è
	`_TIMER_EVENT
(
TMR_WAIT_REL
,icks)

	)

1237 
	#SEQ_ECHO_BACK
(
key
è
	`_TIMER_EVENT
(
TMR_ECHO
, key)

	)

1238 
	#SEQ_SET_TEMPO
(
v®ue
è
	`_TIMER_EVENT
(
TMR_TEMPO
, v®ue)

	)

1239 
	#SEQ_SONGPOS
(
pos
è
	`_TIMER_EVENT
(
TMR_SPP
,…os)

	)

1240 
	#SEQ_TIME_SIGNATURE
(
sig
è
	`_TIMER_EVENT
(
TMR_TIMESIG
, sig)

	)

1246 
	#_LOCAL_EVENT
(
ev
, 
·rm
è{
	`_SEQ_NEEDBUF
(8);\

1247 
_£qbuf
[
_£qbuåŒ
+0] = 
EV_SEQ_LOCAL
; \

1248 
_£qbuf
[
_£qbuåŒ
+1] = (
ev
); \

1249 
_£qbuf
[
_£qbuåŒ
+2] = 0;\

1250 
_£qbuf
[
_£qbuåŒ
+3] = 0;\

1251 *(*)&
_£qbuf
[
_£qbuåŒ
+4] = (
·rm
); \

1252 
	`_SEQ_ADVBUF
(8);}

	)

1254 
	#SEQ_PLAYAUDIO
(
devmask
è
	`_LOCAL_EVENT
(
LOCL_STARTAUDIO
, devmask)

	)

1259 
	#SEQ_MIDIOUT
(
deviû
, 
by‹
è{
	`_SEQ_NEEDBUF
(4);\

1260 
_£qbuf
[
_£qbuåŒ
] = 
SEQ_MIDIPUTC
;\

1261 
_£qbuf
[
_£qbuåŒ
+1] = (
by‹
);\

1262 
_£qbuf
[
_£qbuåŒ
+2] = (
deviû
);\

1263 
_£qbuf
[
_£qbuåŒ
+3] = 0;\

1264 
	`_SEQ_ADVBUF
(4);}

	)

1269 
	#SEQ_WRPATCH
(
·tchx
, 
Ën
) \

1270 {ià(
_£qbuåŒ
è
	`SEQ_DUMPBUF
();\

1271 ià(
	`wr™e
(
£qfd
, (*)(
·tchx
), 
Ën
)==-1) \

1272 
	`³¼Ü
("Wr™·tch: /dev/£qu’ûr");}

	)

1273 
	#SEQ_WRPATCH2
(
·tchx
, 
Ën
) \

1274 (
	`SEQ_DUMPBUF
(), 
	`wr™e
(
£qfd
, (*)(
·tchx
), 
Ën
))

	)

	@/usr/include/linux/stat.h

1 #iâdeà
_LINUX_STAT_H


2 
	#_LINUX_STAT_H


	)

5 #ià
defšed
(
__KERNEL__
è|| !defšed(
__GLIBC__
) || (__GLIBC__ < 2)

7 
	#S_IFMT
 00170000

	)

8 
	#S_IFSOCK
 0140000

	)

9 
	#S_IFLNK
 0120000

	)

10 
	#S_IFREG
 0100000

	)

11 
	#S_IFBLK
 0060000

	)

12 
	#S_IFDIR
 0040000

	)

13 
	#S_IFCHR
 0020000

	)

14 
	#S_IFIFO
 0010000

	)

15 
	#S_ISUID
 0004000

	)

16 
	#S_ISGID
 0002000

	)

17 
	#S_ISVTX
 0001000

	)

19 
	#S_ISLNK
(
m
è(((mè& 
S_IFMT
è=ğ
S_IFLNK
)

	)

20 
	#S_ISREG
(
m
è(((mè& 
S_IFMT
è=ğ
S_IFREG
)

	)

21 
	#S_ISDIR
(
m
è(((mè& 
S_IFMT
è=ğ
S_IFDIR
)

	)

22 
	#S_ISCHR
(
m
è(((mè& 
S_IFMT
è=ğ
S_IFCHR
)

	)

23 
	#S_ISBLK
(
m
è(((mè& 
S_IFMT
è=ğ
S_IFBLK
)

	)

24 
	#S_ISFIFO
(
m
è(((mè& 
S_IFMT
è=ğ
S_IFIFO
)

	)

25 
	#S_ISSOCK
(
m
è(((mè& 
S_IFMT
è=ğ
S_IFSOCK
)

	)

27 
	#S_IRWXU
 00700

	)

28 
	#S_IRUSR
 00400

	)

29 
	#S_IWUSR
 00200

	)

30 
	#S_IXUSR
 00100

	)

32 
	#S_IRWXG
 00070

	)

33 
	#S_IRGRP
 00040

	)

34 
	#S_IWGRP
 00020

	)

35 
	#S_IXGRP
 00010

	)

37 
	#S_IRWXO
 00007

	)

38 
	#S_IROTH
 00004

	)

39 
	#S_IWOTH
 00002

	)

40 
	#S_IXOTH
 00001

	)

	@/usr/include/linux/stddef.h

1 #iâdeà
_LINUX_STDDEF_H


2 
	#_LINUX_STDDEF_H


	)

6 #undeà
NULL


7 #ià
defšed
(
__ılu¥lus
)

8 
	#NULL
 0

	)

10 
	#NULL
 ((*)0)

	)

	@/usr/include/linux/string.h

1 #iâdeà
_LINUX_STRING_H_


2 
	#_LINUX_STRING_H_


	)

6 
	~<¡ršg.h
>

	@/usr/include/linux/sysctl.h

22 #iâdeà
_LINUX_SYSCTL_H


23 
	#_LINUX_SYSCTL_H


	)

25 
	~<lšux/k”Ãl.h
>

26 
	~<lšux/ty³s.h
>

29 
	gcom¶‘iÚ
;

31 
	#CTL_MAXNAME
 10

	)

36 
	s__sysùl_¬gs
 {

37 *
	mÇme
;

38 
	mÆ’
;

39 *
	mŞdv®
;

40 
size_t
 *
	mŞdËÅ
;

41 *
	mÃwv®
;

42 
size_t
 
	mÃwËn
;

43 
	m__unu£d
[4];

52 
	mCTL_KERN
=1,

53 
	mCTL_VM
=2,

54 
	mCTL_NET
=3,

55 
	mCTL_PROC
=4,

56 
	mCTL_FS
=5,

57 
	mCTL_DEBUG
=6,

58 
	mCTL_DEV
=7,

59 
	mCTL_BUS
=8,

60 
	mCTL_ABI
=9,

61 
	mCTL_CPU
=10,

62 
	mCTL_ARLAN
=254,

63 
	mCTL_S390DBF
=5677,

64 
	mCTL_SUNRPC
=7249,

65 
	mCTL_PM
=9899,

66 
	mCTL_FRV
=9898,

72 
	mCTL_BUS_ISA
=1

78 
	mINOTIFY_MAX_USER_INSTANCES
=1,

79 
	mINOTIFY_MAX_USER_WATCHES
=2,

80 
	mINOTIFY_MAX_QUEUED_EVENTS
=3

86 
	mKERN_OSTYPE
=1,

87 
	mKERN_OSRELEASE
=2,

88 
	mKERN_OSREV
=3,

89 
	mKERN_VERSION
=4,

90 
	mKERN_SECUREMASK
=5,

91 
	mKERN_PROF
=6,

92 
	mKERN_NODENAME
=7,

93 
	mKERN_DOMAINNAME
=8,

95 
	mKERN_PANIC
=15,

96 
	mKERN_REALROOTDEV
=16,

98 
	mKERN_SPARC_REBOOT
=21,

99 
	mKERN_CTLALTDEL
=22,

100 
	mKERN_PRINTK
=23,

101 
	mKERN_NAMETRANS
=24,

102 
	mKERN_PPC_HTABRECLAIM
=25,

103 
	mKERN_PPC_ZEROPAGED
=26,

104 
	mKERN_PPC_POWERSAVE_NAP
=27,

105 
	mKERN_MODPROBE
=28,

106 
	mKERN_SG_BIG_BUFF
=29,

107 
	mKERN_ACCT
=30,

108 
	mKERN_PPC_L2CR
=31,

110 
	mKERN_RTSIGNR
=32,

111 
	mKERN_RTSIGMAX
=33,

113 
	mKERN_SHMMAX
=34,

114 
	mKERN_MSGMAX
=35,

115 
	mKERN_MSGMNB
=36,

116 
	mKERN_MSGPOOL
=37,

117 
	mKERN_SYSRQ
=38,

118 
	mKERN_MAX_THREADS
=39,

119 
	mKERN_RANDOM
=40,

120 
	mKERN_SHMALL
=41,

121 
	mKERN_MSGMNI
=42,

122 
	mKERN_SEM
=43,

123 
	mKERN_SPARC_STOP_A
=44,

124 
	mKERN_SHMMNI
=45,

125 
	mKERN_OVERFLOWUID
=46,

126 
	mKERN_OVERFLOWGID
=47,

127 
	mKERN_SHMPATH
=48,

128 
	mKERN_HOTPLUG
=49,

129 
	mKERN_IEEE_EMULATION_WARNINGS
=50,

130 
	mKERN_S390_USER_DEBUG_LOGGING
=51,

131 
	mKERN_CORE_USES_PID
=52,

132 
	mKERN_TAINTED
=53,

133 
	mKERN_CADPID
=54,

134 
	mKERN_PIDMAX
=55,

135 
	mKERN_CORE_PATTERN
=56,

136 
	mKERN_PANIC_ON_OOPS
=57,

137 
	mKERN_HPPA_PWRSW
=58,

138 
	mKERN_HPPA_UNALIGNED
=59,

139 
	mKERN_PRINTK_RATELIMIT
=60,

140 
	mKERN_PRINTK_RATELIMIT_BURST
=61,

141 
	mKERN_PTY
=62,

142 
	mKERN_NGROUPS_MAX
=63,

143 
	mKERN_SPARC_SCONS_PWROFF
=64,

144 
	mKERN_HZ_TIMER
=65,

145 
	mKERN_UNKNOWN_NMI_PANIC
=66,

146 
	mKERN_BOOTLOADER_TYPE
=67,

147 
	mKERN_RANDOMIZE
=68,

148 
	mKERN_SETUID_DUMPABLE
=69,

149 
	mKERN_SPIN_RETRY
=70,

150 
	mKERN_ACPI_VIDEO_FLAGS
=71,

151 
	mKERN_IA64_UNALIGNED
=72,

152 
	mKERN_COMPAT_LOG
=73,

153 
	mKERN_MAX_LOCK_DEPTH
=74,

154 
	mKERN_NMI_WATCHDOG
=75,

155 
	mKERN_PANIC_ON_NMI
=76,

163 
	mVM_UNUSED1
=1,

164 
	mVM_UNUSED2
=2,

165 
	mVM_UNUSED3
=3,

166 
	mVM_UNUSED4
=4,

167 
	mVM_OVERCOMMIT_MEMORY
=5,

168 
	mVM_UNUSED5
=6,

169 
	mVM_UNUSED7
=7,

170 
	mVM_UNUSED8
=8,

171 
	mVM_UNUSED9
=9,

172 
	mVM_PAGE_CLUSTER
=10,

173 
	mVM_DIRTY_BACKGROUND
=11,

174 
	mVM_DIRTY_RATIO
=12,

175 
	mVM_DIRTY_WB_CS
=13,

176 
	mVM_DIRTY_EXPIRE_CS
=14,

177 
	mVM_NR_PDFLUSH_THREADS
=15,

178 
	mVM_OVERCOMMIT_RATIO
=16,

179 
	mVM_PAGEBUF
=17,

180 
	mVM_HUGETLB_PAGES
=18,

181 
	mVM_SWAPPINESS
=19,

182 
	mVM_LOWMEM_RESERVE_RATIO
=20,

183 
	mVM_MIN_FREE_KBYTES
=21,

184 
	mVM_MAX_MAP_COUNT
=22,

185 
	mVM_LAPTOP_MODE
=23,

186 
	mVM_BLOCK_DUMP
=24,

187 
	mVM_HUGETLB_GROUP
=25,

188 
	mVM_VFS_CACHE_PRESSURE
=26,

189 
	mVM_LEGACY_VA_LAYOUT
=27,

190 
	mVM_SWAP_TOKEN_TIMEOUT
=28,

191 
	mVM_DROP_PAGECACHE
=29,

192 
	mVM_PERCPU_PAGELIST_FRACTION
=30,

193 
	mVM_ZONE_RECLAIM_MODE
=31,

194 
	mVM_MIN_UNMAPPED
=32,

195 
	mVM_PANIC_ON_OOM
=33,

196 
	mVM_VDSO_ENABLED
=34,

197 
	mVM_MIN_SLAB
=35,

204 
	mNET_CORE
=1,

205 
	mNET_ETHER
=2,

206 
	mNET_802
=3,

207 
	mNET_UNIX
=4,

208 
	mNET_IPV4
=5,

209 
	mNET_IPX
=6,

210 
	mNET_ATALK
=7,

211 
	mNET_NETROM
=8,

212 
	mNET_AX25
=9,

213 
	mNET_BRIDGE
=10,

214 
	mNET_ROSE
=11,

215 
	mNET_IPV6
=12,

216 
	mNET_X25
=13,

217 
	mNET_TR
=14,

218 
	mNET_DECNET
=15,

219 
	mNET_ECONET
=16,

220 
	mNET_SCTP
=17,

221 
	mNET_LLC
=18,

222 
	mNET_NETFILTER
=19,

223 
	mNET_DCCP
=20,

224 
	mNET_IRDA
=412,

230 
	mRANDOM_POOLSIZE
=1,

231 
	mRANDOM_ENTROPY_COUNT
=2,

232 
	mRANDOM_READ_THRESH
=3,

233 
	mRANDOM_WRITE_THRESH
=4,

234 
	mRANDOM_BOOT_ID
=5,

235 
	mRANDOM_UUID
=6

241 
	mPTY_MAX
=1,

242 
	mPTY_NR
=2

248 
	mBUS_ISA_MEM_BASE
=1,

249 
	mBUS_ISA_PORT_BASE
=2,

250 
	mBUS_ISA_PORT_SHIFT
=3

256 
	mNET_CORE_WMEM_MAX
=1,

257 
	mNET_CORE_RMEM_MAX
=2,

258 
	mNET_CORE_WMEM_DEFAULT
=3,

259 
	mNET_CORE_RMEM_DEFAULT
=4,

261 
	mNET_CORE_MAX_BACKLOG
=6,

262 
	mNET_CORE_FASTROUTE
=7,

263 
	mNET_CORE_MSG_COST
=8,

264 
	mNET_CORE_MSG_BURST
=9,

265 
	mNET_CORE_OPTMEM_MAX
=10,

266 
	mNET_CORE_HOT_LIST_LENGTH
=11,

267 
	mNET_CORE_DIVERT_VERSION
=12,

268 
	mNET_CORE_NO_CONG_THRESH
=13,

269 
	mNET_CORE_NO_CONG
=14,

270 
	mNET_CORE_LO_CONG
=15,

271 
	mNET_CORE_MOD_CONG
=16,

272 
	mNET_CORE_DEV_WEIGHT
=17,

273 
	mNET_CORE_SOMAXCONN
=18,

274 
	mNET_CORE_BUDGET
=19,

275 
	mNET_CORE_AEVENT_ETIME
=20,

276 
	mNET_CORE_AEVENT_RSEQTH
=21,

277 
	mNET_CORE_WARNINGS
=22,

288 
	mNET_UNIX_DESTROY_DELAY
=1,

289 
	mNET_UNIX_DELETE_DELAY
=2,

290 
	mNET_UNIX_MAX_DGRAM_QLEN
=3,

296 
	mNET_NF_CONNTRACK_MAX
=1,

297 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_SYN_SENT
=2,

298 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_SYN_RECV
=3,

299 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_ESTABLISHED
=4,

300 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_FIN_WAIT
=5,

301 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_CLOSE_WAIT
=6,

302 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_LAST_ACK
=7,

303 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_TIME_WAIT
=8,

304 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_CLOSE
=9,

305 
	mNET_NF_CONNTRACK_UDP_TIMEOUT
=10,

306 
	mNET_NF_CONNTRACK_UDP_TIMEOUT_STREAM
=11,

307 
	mNET_NF_CONNTRACK_ICMP_TIMEOUT
=12,

308 
	mNET_NF_CONNTRACK_GENERIC_TIMEOUT
=13,

309 
	mNET_NF_CONNTRACK_BUCKETS
=14,

310 
	mNET_NF_CONNTRACK_LOG_INVALID
=15,

311 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_MAX_RETRANS
=16,

312 
	mNET_NF_CONNTRACK_TCP_LOOSE
=17,

313 
	mNET_NF_CONNTRACK_TCP_BE_LIBERAL
=18,

314 
	mNET_NF_CONNTRACK_TCP_MAX_RETRANS
=19,

315 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_CLOSED
=20,

316 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_COOKIE_WAIT
=21,

317 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_COOKIE_ECHOED
=22,

318 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_ESTABLISHED
=23,

319 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_SENT
=24,

320 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_RECD
=25,

321 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_ACK_SENT
=26,

322 
	mNET_NF_CONNTRACK_COUNT
=27,

323 
	mNET_NF_CONNTRACK_ICMPV6_TIMEOUT
=28,

324 
	mNET_NF_CONNTRACK_FRAG6_TIMEOUT
=29,

325 
	mNET_NF_CONNTRACK_FRAG6_LOW_THRESH
=30,

326 
	mNET_NF_CONNTRACK_FRAG6_HIGH_THRESH
=31,

327 
	mNET_NF_CONNTRACK_CHECKSUM
=32,

334 
	mNET_IPV4_FORWARD
=8,

335 
	mNET_IPV4_DYNADDR
=9,

337 
	mNET_IPV4_CONF
=16,

338 
	mNET_IPV4_NEIGH
=17,

339 
	mNET_IPV4_ROUTE
=18,

340 
	mNET_IPV4_FIB_HASH
=19,

341 
	mNET_IPV4_NETFILTER
=20,

343 
	mNET_IPV4_TCP_TIMESTAMPS
=33,

344 
	mNET_IPV4_TCP_WINDOW_SCALING
=34,

345 
	mNET_IPV4_TCP_SACK
=35,

346 
	mNET_IPV4_TCP_RETRANS_COLLAPSE
=36,

347 
	mNET_IPV4_DEFAULT_TTL
=37,

348 
	mNET_IPV4_AUTOCONFIG
=38,

349 
	mNET_IPV4_NO_PMTU_DISC
=39,

350 
	mNET_IPV4_TCP_SYN_RETRIES
=40,

351 
	mNET_IPV4_IPFRAG_HIGH_THRESH
=41,

352 
	mNET_IPV4_IPFRAG_LOW_THRESH
=42,

353 
	mNET_IPV4_IPFRAG_TIME
=43,

354 
	mNET_IPV4_TCP_MAX_KA_PROBES
=44,

355 
	mNET_IPV4_TCP_KEEPALIVE_TIME
=45,

356 
	mNET_IPV4_TCP_KEEPALIVE_PROBES
=46,

357 
	mNET_IPV4_TCP_RETRIES1
=47,

358 
	mNET_IPV4_TCP_RETRIES2
=48,

359 
	mNET_IPV4_TCP_FIN_TIMEOUT
=49,

360 
	mNET_IPV4_IP_MASQ_DEBUG
=50,

361 
	mNET_TCP_SYNCOOKIES
=51,

362 
	mNET_TCP_STDURG
=52,

363 
	mNET_TCP_RFC1337
=53,

364 
	mNET_TCP_SYN_TAILDROP
=54,

365 
	mNET_TCP_MAX_SYN_BACKLOG
=55,

366 
	mNET_IPV4_LOCAL_PORT_RANGE
=56,

367 
	mNET_IPV4_ICMP_ECHO_IGNORE_ALL
=57,

368 
	mNET_IPV4_ICMP_ECHO_IGNORE_BROADCASTS
=58,

369 
	mNET_IPV4_ICMP_SOURCEQUENCH_RATE
=59,

370 
	mNET_IPV4_ICMP_DESTUNREACH_RATE
=60,

371 
	mNET_IPV4_ICMP_TIMEEXCEED_RATE
=61,

372 
	mNET_IPV4_ICMP_PARAMPROB_RATE
=62,

373 
	mNET_IPV4_ICMP_ECHOREPLY_RATE
=63,

374 
	mNET_IPV4_ICMP_IGNORE_BOGUS_ERROR_RESPONSES
=64,

375 
	mNET_IPV4_IGMP_MAX_MEMBERSHIPS
=65,

376 
	mNET_TCP_TW_RECYCLE
=66,

377 
	mNET_IPV4_ALWAYS_DEFRAG
=67,

378 
	mNET_IPV4_TCP_KEEPALIVE_INTVL
=68,

379 
	mNET_IPV4_INET_PEER_THRESHOLD
=69,

380 
	mNET_IPV4_INET_PEER_MINTTL
=70,

381 
	mNET_IPV4_INET_PEER_MAXTTL
=71,

382 
	mNET_IPV4_INET_PEER_GC_MINTIME
=72,

383 
	mNET_IPV4_INET_PEER_GC_MAXTIME
=73,

384 
	mNET_TCP_ORPHAN_RETRIES
=74,

385 
	mNET_TCP_ABORT_ON_OVERFLOW
=75,

386 
	mNET_TCP_SYNACK_RETRIES
=76,

387 
	mNET_TCP_MAX_ORPHANS
=77,

388 
	mNET_TCP_MAX_TW_BUCKETS
=78,

389 
	mNET_TCP_FACK
=79,

390 
	mNET_TCP_REORDERING
=80,

391 
	mNET_TCP_ECN
=81,

392 
	mNET_TCP_DSACK
=82,

393 
	mNET_TCP_MEM
=83,

394 
	mNET_TCP_WMEM
=84,

395 
	mNET_TCP_RMEM
=85,

396 
	mNET_TCP_APP_WIN
=86,

397 
	mNET_TCP_ADV_WIN_SCALE
=87,

398 
	mNET_IPV4_NONLOCAL_BIND
=88,

399 
	mNET_IPV4_ICMP_RATELIMIT
=89,

400 
	mNET_IPV4_ICMP_RATEMASK
=90,

401 
	mNET_TCP_TW_REUSE
=91,

402 
	mNET_TCP_FRTO
=92,

403 
	mNET_TCP_LOW_LATENCY
=93,

404 
	mNET_IPV4_IPFRAG_SECRET_INTERVAL
=94,

405 
	mNET_IPV4_IGMP_MAX_MSF
=96,

406 
	mNET_TCP_NO_METRICS_SAVE
=97,

407 
	mNET_TCP_DEFAULT_WIN_SCALE
=105,

408 
	mNET_TCP_MODERATE_RCVBUF
=106,

409 
	mNET_TCP_TSO_WIN_DIVISOR
=107,

410 
	mNET_TCP_BIC_BETA
=108,

411 
	mNET_IPV4_ICMP_ERRORS_USE_INBOUND_IFADDR
=109,

412 
	mNET_TCP_CONG_CONTROL
=110,

413 
	mNET_TCP_ABC
=111,

414 
	mNET_IPV4_IPFRAG_MAX_DIST
=112,

415 
	mNET_TCP_MTU_PROBING
=113,

416 
	mNET_TCP_BASE_MSS
=114,

417 
	mNET_IPV4_TCP_WORKAROUND_SIGNED_WINDOWS
=115,

418 
	mNET_TCP_DMA_COPYBREAK
=116,

419 
	mNET_TCP_SLOW_START_AFTER_IDLE
=117,

420 
	mNET_CIPSOV4_CACHE_ENABLE
=118,

421 
	mNET_CIPSOV4_CACHE_BUCKET_SIZE
=119,

422 
	mNET_CIPSOV4_RBM_OPTFMT
=120,

423 
	mNET_CIPSOV4_RBM_STRICTVALID
=121,

424 
	mNET_TCP_AVAIL_CONG_CONTROL
=122,

425 
	mNET_TCP_ALLOWED_CONG_CONTROL
=123,

426 
	mNET_TCP_MAX_SSTHRESH
=124,

427 
	mNET_TCP_FRTO_RESPONSE
=125,

431 
	mNET_IPV4_ROUTE_FLUSH
=1,

432 
	mNET_IPV4_ROUTE_MIN_DELAY
=2,

433 
	mNET_IPV4_ROUTE_MAX_DELAY
=3,

434 
	mNET_IPV4_ROUTE_GC_THRESH
=4,

435 
	mNET_IPV4_ROUTE_MAX_SIZE
=5,

436 
	mNET_IPV4_ROUTE_GC_MIN_INTERVAL
=6,

437 
	mNET_IPV4_ROUTE_GC_TIMEOUT
=7,

438 
	mNET_IPV4_ROUTE_GC_INTERVAL
=8,

439 
	mNET_IPV4_ROUTE_REDIRECT_LOAD
=9,

440 
	mNET_IPV4_ROUTE_REDIRECT_NUMBER
=10,

441 
	mNET_IPV4_ROUTE_REDIRECT_SILENCE
=11,

442 
	mNET_IPV4_ROUTE_ERROR_COST
=12,

443 
	mNET_IPV4_ROUTE_ERROR_BURST
=13,

444 
	mNET_IPV4_ROUTE_GC_ELASTICITY
=14,

445 
	mNET_IPV4_ROUTE_MTU_EXPIRES
=15,

446 
	mNET_IPV4_ROUTE_MIN_PMTU
=16,

447 
	mNET_IPV4_ROUTE_MIN_ADVMSS
=17,

448 
	mNET_IPV4_ROUTE_SECRET_INTERVAL
=18,

449 
	mNET_IPV4_ROUTE_GC_MIN_INTERVAL_MS
=19,

454 
	mNET_PROTO_CONF_ALL
=-2,

455 
	mNET_PROTO_CONF_DEFAULT
=-3

462 
	mNET_IPV4_CONF_FORWARDING
=1,

463 
	mNET_IPV4_CONF_MC_FORWARDING
=2,

464 
	mNET_IPV4_CONF_PROXY_ARP
=3,

465 
	mNET_IPV4_CONF_ACCEPT_REDIRECTS
=4,

466 
	mNET_IPV4_CONF_SECURE_REDIRECTS
=5,

467 
	mNET_IPV4_CONF_SEND_REDIRECTS
=6,

468 
	mNET_IPV4_CONF_SHARED_MEDIA
=7,

469 
	mNET_IPV4_CONF_RP_FILTER
=8,

470 
	mNET_IPV4_CONF_ACCEPT_SOURCE_ROUTE
=9,

471 
	mNET_IPV4_CONF_BOOTP_RELAY
=10,

472 
	mNET_IPV4_CONF_LOG_MARTIANS
=11,

473 
	mNET_IPV4_CONF_TAG
=12,

474 
	mNET_IPV4_CONF_ARPFILTER
=13,

475 
	mNET_IPV4_CONF_MEDIUM_ID
=14,

476 
	mNET_IPV4_CONF_NOXFRM
=15,

477 
	mNET_IPV4_CONF_NOPOLICY
=16,

478 
	mNET_IPV4_CONF_FORCE_IGMP_VERSION
=17,

479 
	mNET_IPV4_CONF_ARP_ANNOUNCE
=18,

480 
	mNET_IPV4_CONF_ARP_IGNORE
=19,

481 
	mNET_IPV4_CONF_PROMOTE_SECONDARIES
=20,

482 
	mNET_IPV4_CONF_ARP_ACCEPT
=21,

483 
	mNET_IPV4_CONF_ARP_NOTIFY
=22,

489 
	mNET_IPV4_NF_CONNTRACK_MAX
=1,

490 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_SYN_SENT
=2,

491 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_SYN_RECV
=3,

492 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_ESTABLISHED
=4,

493 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_FIN_WAIT
=5,

494 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_CLOSE_WAIT
=6,

495 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_LAST_ACK
=7,

496 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_TIME_WAIT
=8,

497 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_CLOSE
=9,

498 
	mNET_IPV4_NF_CONNTRACK_UDP_TIMEOUT
=10,

499 
	mNET_IPV4_NF_CONNTRACK_UDP_TIMEOUT_STREAM
=11,

500 
	mNET_IPV4_NF_CONNTRACK_ICMP_TIMEOUT
=12,

501 
	mNET_IPV4_NF_CONNTRACK_GENERIC_TIMEOUT
=13,

502 
	mNET_IPV4_NF_CONNTRACK_BUCKETS
=14,

503 
	mNET_IPV4_NF_CONNTRACK_LOG_INVALID
=15,

504 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_MAX_RETRANS
=16,

505 
	mNET_IPV4_NF_CONNTRACK_TCP_LOOSE
=17,

506 
	mNET_IPV4_NF_CONNTRACK_TCP_BE_LIBERAL
=18,

507 
	mNET_IPV4_NF_CONNTRACK_TCP_MAX_RETRANS
=19,

508 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_CLOSED
=20,

509 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_COOKIE_WAIT
=21,

510 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_COOKIE_ECHOED
=22,

511 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_ESTABLISHED
=23,

512 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_SENT
=24,

513 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_RECD
=25,

514 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_ACK_SENT
=26,

515 
	mNET_IPV4_NF_CONNTRACK_COUNT
=27,

516 
	mNET_IPV4_NF_CONNTRACK_CHECKSUM
=28,

521 
	mNET_IPV6_CONF
=16,

522 
	mNET_IPV6_NEIGH
=17,

523 
	mNET_IPV6_ROUTE
=18,

524 
	mNET_IPV6_ICMP
=19,

525 
	mNET_IPV6_BINDV6ONLY
=20,

526 
	mNET_IPV6_IP6FRAG_HIGH_THRESH
=21,

527 
	mNET_IPV6_IP6FRAG_LOW_THRESH
=22,

528 
	mNET_IPV6_IP6FRAG_TIME
=23,

529 
	mNET_IPV6_IP6FRAG_SECRET_INTERVAL
=24,

530 
	mNET_IPV6_MLD_MAX_MSF
=25,

534 
	mNET_IPV6_ROUTE_FLUSH
=1,

535 
	mNET_IPV6_ROUTE_GC_THRESH
=2,

536 
	mNET_IPV6_ROUTE_MAX_SIZE
=3,

537 
	mNET_IPV6_ROUTE_GC_MIN_INTERVAL
=4,

538 
	mNET_IPV6_ROUTE_GC_TIMEOUT
=5,

539 
	mNET_IPV6_ROUTE_GC_INTERVAL
=6,

540 
	mNET_IPV6_ROUTE_GC_ELASTICITY
=7,

541 
	mNET_IPV6_ROUTE_MTU_EXPIRES
=8,

542 
	mNET_IPV6_ROUTE_MIN_ADVMSS
=9,

543 
	mNET_IPV6_ROUTE_GC_MIN_INTERVAL_MS
=10

547 
	mNET_IPV6_FORWARDING
=1,

548 
	mNET_IPV6_HOP_LIMIT
=2,

549 
	mNET_IPV6_MTU
=3,

550 
	mNET_IPV6_ACCEPT_RA
=4,

551 
	mNET_IPV6_ACCEPT_REDIRECTS
=5,

552 
	mNET_IPV6_AUTOCONF
=6,

553 
	mNET_IPV6_DAD_TRANSMITS
=7,

554 
	mNET_IPV6_RTR_SOLICITS
=8,

555 
	mNET_IPV6_RTR_SOLICIT_INTERVAL
=9,

556 
	mNET_IPV6_RTR_SOLICIT_DELAY
=10,

557 
	mNET_IPV6_USE_TEMPADDR
=11,

558 
	mNET_IPV6_TEMP_VALID_LFT
=12,

559 
	mNET_IPV6_TEMP_PREFERED_LFT
=13,

560 
	mNET_IPV6_REGEN_MAX_RETRY
=14,

561 
	mNET_IPV6_MAX_DESYNC_FACTOR
=15,

562 
	mNET_IPV6_MAX_ADDRESSES
=16,

563 
	mNET_IPV6_FORCE_MLD_VERSION
=17,

564 
	mNET_IPV6_ACCEPT_RA_DEFRTR
=18,

565 
	mNET_IPV6_ACCEPT_RA_PINFO
=19,

566 
	mNET_IPV6_ACCEPT_RA_RTR_PREF
=20,

567 
	mNET_IPV6_RTR_PROBE_INTERVAL
=21,

568 
	mNET_IPV6_ACCEPT_RA_RT_INFO_MAX_PLEN
=22,

569 
	mNET_IPV6_PROXY_NDP
=23,

570 
	mNET_IPV6_ACCEPT_SOURCE_ROUTE
=25,

571 
	m__NET_IPV6_MAX


576 
	mNET_IPV6_ICMP_RATELIMIT
=1

581 
	mNET_NEIGH_MCAST_SOLICIT
=1,

582 
	mNET_NEIGH_UCAST_SOLICIT
=2,

583 
	mNET_NEIGH_APP_SOLICIT
=3,

584 
	mNET_NEIGH_RETRANS_TIME
=4,

585 
	mNET_NEIGH_REACHABLE_TIME
=5,

586 
	mNET_NEIGH_DELAY_PROBE_TIME
=6,

587 
	mNET_NEIGH_GC_STALE_TIME
=7,

588 
	mNET_NEIGH_UNRES_QLEN
=8,

589 
	mNET_NEIGH_PROXY_QLEN
=9,

590 
	mNET_NEIGH_ANYCAST_DELAY
=10,

591 
	mNET_NEIGH_PROXY_DELAY
=11,

592 
	mNET_NEIGH_LOCKTIME
=12,

593 
	mNET_NEIGH_GC_INTERVAL
=13,

594 
	mNET_NEIGH_GC_THRESH1
=14,

595 
	mNET_NEIGH_GC_THRESH2
=15,

596 
	mNET_NEIGH_GC_THRESH3
=16,

597 
	mNET_NEIGH_RETRANS_TIME_MS
=17,

598 
	mNET_NEIGH_REACHABLE_TIME_MS
=18,

603 
	mNET_DCCP_DEFAULT
=1,

608 
	mNET_IPX_PPROP_BROADCASTING
=1,

609 
	mNET_IPX_FORWARDING
=2

614 
	mNET_LLC2
=1,

615 
	mNET_LLC_STATION
=2,

620 
	mNET_LLC2_TIMEOUT
=1,

625 
	mNET_LLC_STATION_ACK_TIMEOUT
=1,

630 
	mNET_LLC2_ACK_TIMEOUT
=1,

631 
	mNET_LLC2_P_TIMEOUT
=2,

632 
	mNET_LLC2_REJ_TIMEOUT
=3,

633 
	mNET_LLC2_BUSY_TIMEOUT
=4,

638 
	mNET_ATALK_AARP_EXPIRY_TIME
=1,

639 
	mNET_ATALK_AARP_TICK_TIME
=2,

640 
	mNET_ATALK_AARP_RETRANSMIT_LIMIT
=3,

641 
	mNET_ATALK_AARP_RESOLVE_TIME
=4

647 
	mNET_NETROM_DEFAULT_PATH_QUALITY
=1,

648 
	mNET_NETROM_OBSOLESCENCE_COUNT_INITIALISER
=2,

649 
	mNET_NETROM_NETWORK_TTL_INITIALISER
=3,

650 
	mNET_NETROM_TRANSPORT_TIMEOUT
=4,

651 
	mNET_NETROM_TRANSPORT_MAXIMUM_TRIES
=5,

652 
	mNET_NETROM_TRANSPORT_ACKNOWLEDGE_DELAY
=6,

653 
	mNET_NETROM_TRANSPORT_BUSY_DELAY
=7,

654 
	mNET_NETROM_TRANSPORT_REQUESTED_WINDOW_SIZE
=8,

655 
	mNET_NETROM_TRANSPORT_NO_ACTIVITY_TIMEOUT
=9,

656 
	mNET_NETROM_ROUTING_CONTROL
=10,

657 
	mNET_NETROM_LINK_FAILS_COUNT
=11,

658 
	mNET_NETROM_RESET
=12

663 
	mNET_AX25_IP_DEFAULT_MODE
=1,

664 
	mNET_AX25_DEFAULT_MODE
=2,

665 
	mNET_AX25_BACKOFF_TYPE
=3,

666 
	mNET_AX25_CONNECT_MODE
=4,

667 
	mNET_AX25_STANDARD_WINDOW
=5,

668 
	mNET_AX25_EXTENDED_WINDOW
=6,

669 
	mNET_AX25_T1_TIMEOUT
=7,

670 
	mNET_AX25_T2_TIMEOUT
=8,

671 
	mNET_AX25_T3_TIMEOUT
=9,

672 
	mNET_AX25_IDLE_TIMEOUT
=10,

673 
	mNET_AX25_N2
=11,

674 
	mNET_AX25_PACLEN
=12,

675 
	mNET_AX25_PROTOCOL
=13,

676 
	mNET_AX25_DAMA_SLAVE_TIMEOUT
=14

681 
	mNET_ROSE_RESTART_REQUEST_TIMEOUT
=1,

682 
	mNET_ROSE_CALL_REQUEST_TIMEOUT
=2,

683 
	mNET_ROSE_RESET_REQUEST_TIMEOUT
=3,

684 
	mNET_ROSE_CLEAR_REQUEST_TIMEOUT
=4,

685 
	mNET_ROSE_ACK_HOLD_BACK_TIMEOUT
=5,

686 
	mNET_ROSE_ROUTING_CONTROL
=6,

687 
	mNET_ROSE_LINK_FAIL_TIMEOUT
=7,

688 
	mNET_ROSE_MAX_VCS
=8,

689 
	mNET_ROSE_WINDOW_SIZE
=9,

690 
	mNET_ROSE_NO_ACTIVITY_TIMEOUT
=10

695 
	mNET_X25_RESTART_REQUEST_TIMEOUT
=1,

696 
	mNET_X25_CALL_REQUEST_TIMEOUT
=2,

697 
	mNET_X25_RESET_REQUEST_TIMEOUT
=3,

698 
	mNET_X25_CLEAR_REQUEST_TIMEOUT
=4,

699 
	mNET_X25_ACK_HOLD_BACK_TIMEOUT
=5,

700 
	mNET_X25_FORWARD
=6

706 
	mNET_TR_RIF_TIMEOUT
=1

711 
	mNET_DECNET_NODE_TYPE
 = 1,

712 
	mNET_DECNET_NODE_ADDRESS
 = 2,

713 
	mNET_DECNET_NODE_NAME
 = 3,

714 
	mNET_DECNET_DEFAULT_DEVICE
 = 4,

715 
	mNET_DECNET_TIME_WAIT
 = 5,

716 
	mNET_DECNET_DN_COUNT
 = 6,

717 
	mNET_DECNET_DI_COUNT
 = 7,

718 
	mNET_DECNET_DR_COUNT
 = 8,

719 
	mNET_DECNET_DST_GC_INTERVAL
 = 9,

720 
	mNET_DECNET_CONF
 = 10,

721 
	mNET_DECNET_NO_FC_MAX_CWND
 = 11,

722 
	mNET_DECNET_MEM
 = 12,

723 
	mNET_DECNET_RMEM
 = 13,

724 
	mNET_DECNET_WMEM
 = 14,

725 
	mNET_DECNET_DEBUG_LEVEL
 = 255

730 
	mNET_DECNET_CONF_LOOPBACK
 = -2,

731 
	mNET_DECNET_CONF_DDCMP
 = -3,

732 
	mNET_DECNET_CONF_PPP
 = -4,

733 
	mNET_DECNET_CONF_X25
 = -5,

734 
	mNET_DECNET_CONF_GRE
 = -6,

735 
	mNET_DECNET_CONF_ETHER
 = -7

742 
	mNET_DECNET_CONF_DEV_PRIORITY
 = 1,

743 
	mNET_DECNET_CONF_DEV_T1
 = 2,

744 
	mNET_DECNET_CONF_DEV_T2
 = 3,

745 
	mNET_DECNET_CONF_DEV_T3
 = 4,

746 
	mNET_DECNET_CONF_DEV_FORWARDING
 = 5,

747 
	mNET_DECNET_CONF_DEV_BLKSIZE
 = 6,

748 
	mNET_DECNET_CONF_DEV_STATE
 = 7

753 
	mNET_SCTP_RTO_INITIAL
 = 1,

754 
	mNET_SCTP_RTO_MIN
 = 2,

755 
	mNET_SCTP_RTO_MAX
 = 3,

756 
	mNET_SCTP_RTO_ALPHA
 = 4,

757 
	mNET_SCTP_RTO_BETA
 = 5,

758 
	mNET_SCTP_VALID_COOKIE_LIFE
 = 6,

759 
	mNET_SCTP_ASSOCIATION_MAX_RETRANS
 = 7,

760 
	mNET_SCTP_PATH_MAX_RETRANS
 = 8,

761 
	mNET_SCTP_MAX_INIT_RETRANSMITS
 = 9,

762 
	mNET_SCTP_HB_INTERVAL
 = 10,

763 
	mNET_SCTP_PRESERVE_ENABLE
 = 11,

764 
	mNET_SCTP_MAX_BURST
 = 12,

765 
	mNET_SCTP_ADDIP_ENABLE
 = 13,

766 
	mNET_SCTP_PRSCTP_ENABLE
 = 14,

767 
	mNET_SCTP_SNDBUF_POLICY
 = 15,

768 
	mNET_SCTP_SACK_TIMEOUT
 = 16,

769 
	mNET_SCTP_RCVBUF_POLICY
 = 17,

774 
	mNET_BRIDGE_NF_CALL_ARPTABLES
 = 1,

775 
	mNET_BRIDGE_NF_CALL_IPTABLES
 = 2,

776 
	mNET_BRIDGE_NF_CALL_IP6TABLES
 = 3,

777 
	mNET_BRIDGE_NF_FILTER_VLAN_TAGGED
 = 4,

778 
	mNET_BRIDGE_NF_FILTER_PPPOE_TAGGED
 = 5,

783 
	mNET_IRDA_DISCOVERY
=1,

784 
	mNET_IRDA_DEVNAME
=2,

785 
	mNET_IRDA_DEBUG
=3,

786 
	mNET_IRDA_FAST_POLL
=4,

787 
	mNET_IRDA_DISCOVERY_SLOTS
=5,

788 
	mNET_IRDA_DISCOVERY_TIMEOUT
=6,

789 
	mNET_IRDA_SLOT_TIMEOUT
=7,

790 
	mNET_IRDA_MAX_BAUD_RATE
=8,

791 
	mNET_IRDA_MIN_TX_TURN_TIME
=9,

792 
	mNET_IRDA_MAX_TX_DATA_SIZE
=10,

793 
	mNET_IRDA_MAX_TX_WINDOW
=11,

794 
	mNET_IRDA_MAX_NOREPLY_TIME
=12,

795 
	mNET_IRDA_WARN_NOREPLY_TIME
=13,

796 
	mNET_IRDA_LAP_KEEPALIVE_TIME
=14,

803 
	mFS_NRINODE
=1,

804 
	mFS_STATINODE
=2,

805 
	mFS_MAXINODE
=3,

806 
	mFS_NRDQUOT
=4,

807 
	mFS_MAXDQUOT
=5,

808 
	mFS_NRFILE
=6,

809 
	mFS_MAXFILE
=7,

810 
	mFS_DENTRY
=8,

811 
	mFS_NRSUPER
=9,

812 
	mFS_MAXSUPER
=10,

813 
	mFS_OVERFLOWUID
=11,

814 
	mFS_OVERFLOWGID
=12,

815 
	mFS_LEASES
=13,

816 
	mFS_DIR_NOTIFY
=14,

817 
	mFS_LEASE_TIME
=15,

818 
	mFS_DQSTATS
=16,

819 
	mFS_XFS
=17,

820 
	mFS_AIO_NR
=18,

821 
	mFS_AIO_MAX_NR
=19,

822 
	mFS_INOTIFY
=20,

823 
	mFS_OCFS2
=988,

828 
	mFS_DQ_LOOKUPS
 = 1,

829 
	mFS_DQ_DROPS
 = 2,

830 
	mFS_DQ_READS
 = 3,

831 
	mFS_DQ_WRITES
 = 4,

832 
	mFS_DQ_CACHE_HITS
 = 5,

833 
	mFS_DQ_ALLOCATED
 = 6,

834 
	mFS_DQ_FREE
 = 7,

835 
	mFS_DQ_SYNCS
 = 8,

836 
	mFS_DQ_WARNINGS
 = 9,

843 
	mDEV_CDROM
=1,

844 
	mDEV_HWMON
=2,

845 
	mDEV_PARPORT
=3,

846 
	mDEV_RAID
=4,

847 
	mDEV_MAC_HID
=5,

848 
	mDEV_SCSI
=6,

849 
	mDEV_IPMI
=7,

854 
	mDEV_CDROM_INFO
=1,

855 
	mDEV_CDROM_AUTOCLOSE
=2,

856 
	mDEV_CDROM_AUTOEJECT
=3,

857 
	mDEV_CDROM_DEBUG
=4,

858 
	mDEV_CDROM_LOCK
=5,

859 
	mDEV_CDROM_CHECK_MEDIA
=6

864 
	mDEV_PARPORT_DEFAULT
=-3

869 
	mDEV_RAID_SPEED_LIMIT_MIN
=1,

870 
	mDEV_RAID_SPEED_LIMIT_MAX
=2

875 
	mDEV_PARPORT_DEFAULT_TIMESLICE
=1,

876 
	mDEV_PARPORT_DEFAULT_SPINTIME
=2

881 
	mDEV_PARPORT_SPINTIME
=1,

882 
	mDEV_PARPORT_BASE_ADDR
=2,

883 
	mDEV_PARPORT_IRQ
=3,

884 
	mDEV_PARPORT_DMA
=4,

885 
	mDEV_PARPORT_MODES
=5,

886 
	mDEV_PARPORT_DEVICES
=6,

887 
	mDEV_PARPORT_AUTOPROBE
=16

892 
	mDEV_PARPORT_DEVICES_ACTIVE
=-3,

897 
	mDEV_PARPORT_DEVICE_TIMESLICE
=1,

902 
	mDEV_MAC_HID_KEYBOARD_SENDS_LINUX_KEYCODES
=1,

903 
	mDEV_MAC_HID_KEYBOARD_LOCK_KEYCODES
=2,

904 
	mDEV_MAC_HID_MOUSE_BUTTON_EMULATION
=3,

905 
	mDEV_MAC_HID_MOUSE_BUTTON2_KEYCODE
=4,

906 
	mDEV_MAC_HID_MOUSE_BUTTON3_KEYCODE
=5,

907 
	mDEV_MAC_HID_ADB_MOUSE_SENDS_KEYCODES
=6

912 
	mDEV_SCSI_LOGGING_LEVEL
=1,

917 
	mDEV_IPMI_POWEROFF_POWERCYCLE
=1,

923 
	mABI_DEFHANDLER_COFF
=1,

924 
	mABI_DEFHANDLER_ELF
=2,

925 
	mABI_DEFHANDLER_LCALL7
=3,

926 
	mABI_DEFHANDLER_LIBCSO
=4,

927 
	mABI_TRACE
=5,

928 
	mABI_FAKE_UTSNAME
=6,

	@/usr/include/linux/time.h

1 #iâdeà
_LINUX_TIME_H


2 
	#_LINUX_TIME_H


	)

4 
	~<lšux/ty³s.h
>

7 #iâdeà
_STRUCT_TIMESPEC


8 
	#_STRUCT_TIMESPEC


	)

9 
	stime¥ec
 {

10 
__k”Ãl_time_t
 
	mtv_£c
;

11 
	mtv_n£c
;

15 
	stimev®
 {

16 
__k”Ãl_time_t
 
	mtv_£c
;

17 
__k”Ãl_su£cÚds_t
 
	mtv_u£c
;

20 
	stimezÚe
 {

21 
	mtz_mšu‹swe¡
;

22 
	mtz_d¡time
;

26 
	#NFDBITS
 
__NFDBITS


	)

28 
	#FD_SETSIZE
 
__FD_SETSIZE


	)

29 
	#FD_SET
(
fd
,
fd£
è
	`__FD_SET
(fd,fd£)

	)

30 
	#FD_CLR
(
fd
,
fd£
è
	`__FD_CLR
(fd,fd£)

	)

31 
	#FD_ISSET
(
fd
,
fd£
è
	`__FD_ISSET
(fd,fd£)

	)

32 
	#FD_ZERO
(
fd£
è
	`__FD_ZERO
(fd£)

	)

38 
	#ITIMER_REAL
 0

	)

39 
	#ITIMER_VIRTUAL
 1

	)

40 
	#ITIMER_PROF
 2

	)

42 
	s™im”¥ec
 {

43 
time¥ec
 
	m™_š‹rv®
;

44 
time¥ec
 
	m™_v®ue
;

47 
	s™im”v®
 {

48 
timev®
 
	m™_š‹rv®
;

49 
timev®
 
	m™_v®ue
;

55 
	#CLOCK_REALTIME
 0

	)

56 
	#CLOCK_MONOTONIC
 1

	)

57 
	#CLOCK_PROCESS_CPUTIME_ID
 2

	)

58 
	#CLOCK_THREAD_CPUTIME_ID
 3

	)

59 
	#CLOCK_MONOTONIC_RAW
 4

	)

60 
	#CLOCK_REALTIME_COARSE
 5

	)

61 
	#CLOCK_MONOTONIC_COARSE
 6

	)

62 
	#CLOCK_BOOTTIME
 7

	)

63 
	#CLOCK_REALTIME_ALARM
 8

	)

64 
	#CLOCK_BOOTTIME_ALARM
 9

	)

69 
	#CLOCK_SGI_CYCLE
 10

	)

70 
	#MAX_CLOCKS
 16

	)

71 
	#CLOCKS_MASK
 (
CLOCK_REALTIME
 | 
CLOCK_MONOTONIC
)

	)

72 
	#CLOCKS_MONO
 
CLOCK_MONOTONIC


	)

77 
	#TIMER_ABSTIME
 0x01

	)

	@/usr/include/linux/tty.h

1 #iâdeà
_LINUX_TTY_H


2 
	#_LINUX_TTY_H


	)

8 
	#NR_LDISCS
 30

	)

11 
	#N_TTY
 0

	)

12 
	#N_SLIP
 1

	)

13 
	#N_MOUSE
 2

	)

14 
	#N_PPP
 3

	)

15 
	#N_STRIP
 4

	)

16 
	#N_AX25
 5

	)

17 
	#N_X25
 6

	)

18 
	#N_6PACK
 7

	)

19 
	#N_MASC
 8

	)

20 
	#N_R3964
 9

	)

21 
	#N_PROFIBUS_FDL
 10

	)

22 
	#N_IRDA
 11

	)

23 
	#N_SMSBLOCK
 12

	)

25 
	#N_HDLC
 13

	)

26 
	#N_SYNC_PPP
 14

	)

27 
	#N_HCI
 15

	)

28 
	#N_GIGASET_M101
 16

	)

29 
	#N_SLCAN
 17

	)

30 
	#N_PPS
 18

	)

31 
	#N_V253
 19

	)

32 
	#N_CAIF
 20

	)

33 
	#N_GSM0710
 21

	)

34 
	#N_TI_WL
 22

	)

35 
	#N_TRACESINK
 23

	)

36 
	#N_TRACEROUTER
 24

	)

	@/usr/include/linux/types.h

1 #iâdeà
_LINUX_TYPES_H


2 
	#_LINUX_TYPES_H


	)

4 
	~<asm/ty³s.h
>

6 #iâdeà
__ASSEMBLY__


8 
	~<lšux/posix_ty³s.h
>

16 #ifdeà
__CHECKER__


17 
	#__b™wi£__
 
	`__©Œibu‹__
((
b™wi£
))

	)

19 
	#__b™wi£__


	)

21 #ifdeà
__CHECK_ENDIAN__


22 
	#__b™wi£
 
__b™wi£__


	)

24 
	#__b™wi£


	)

27 
__u16
 
	t__b™wi£
 
	t__Ë16
;

28 
__u16
 
	t__b™wi£
 
	t__be16
;

29 
__u32
 
	t__b™wi£
 
	t__Ë32
;

30 
__u32
 
	t__b™wi£
 
	t__be32
;

31 
__u64
 
	t__b™wi£
 
	t__Ë64
;

32 
__u64
 
	t__b™wi£
 
	t__be64
;

34 
__u16
 
	t__b™wi£
 
	t__sum16
;

35 
__u32
 
	t__b™wi£
 
	t__wsum
;

46 
	#__®igÃd_u64
 
__u64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

47 
	#__®igÃd_be64
 
__be64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

48 
	#__®igÃd_Ë64
 
__Ë64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

	@/usr/include/linux/uio.h

1 #iâdeà
__LINUX_UIO_H


2 
	#__LINUX_UIO_H


	)

5 
	~<lšux/ty³s.h
>

16 
	siovec


18 *
	miov_ba£
;

19 
__k”Ãl_size_t
 
	miov_Ën
;

26 
	#UIO_FASTIOV
 8

	)

27 
	#UIO_MAXIOV
 1024

	)

	@/usr/include/linux/unistd.h

1 #iâdeà
_LINUX_UNISTD_H_


2 
	#_LINUX_UNISTD_H_


	)

7 
	~<asm/uni¡d.h
>

	@/usr/include/linux/usbdevice_fs.h

29 #iâdeà
_LINUX_USBDEVICE_FS_H


30 
	#_LINUX_USBDEVICE_FS_H


	)

32 
	~<lšux/ty³s.h
>

33 
	~<lšux/magic.h
>

39 
	susbdevfs_ù¾Œªsãr
 {

40 
__u8
 
	mbReque¡Ty³
;

41 
__u8
 
	mbReque¡
;

42 
__u16
 
	mwV®ue
;

43 
__u16
 
	mwIndex
;

44 
__u16
 
	mwL’gth
;

45 
__u32
 
	mtimeout
;

46 *
	md©a
;

49 
	susbdevfs_bulkŒªsãr
 {

50 
	m•
;

51 
	mËn
;

52 
	mtimeout
;

53 *
	md©a
;

56 
	susbdevfs_£tš‹rçû
 {

57 
	mš‹rçû
;

58 
	m®t£‰šg
;

61 
	susbdevfs_discÚÃùsigÇl
 {

62 
	msigÄ
;

63 *
	mcÚ‹xt
;

66 
	#USBDEVFS_MAXDRIVERNAME
 255

	)

68 
	susbdevfs_g‘driv”
 {

69 
	mš‹rçû
;

70 
	mdriv”
[
USBDEVFS_MAXDRIVERNAME
 + 1];

73 
	susbdevfs_cÚÃùšfo
 {

74 
	mdevnum
;

75 
	m¦ow
;

78 
	#USBDEVFS_URB_SHORT_NOT_OK
 0x01

	)

79 
	#USBDEVFS_URB_ISO_ASAP
 0x02

	)

80 
	#USBDEVFS_URB_BULK_CONTINUATION
 0x04

	)

81 
	#USBDEVFS_URB_NO_FSBR
 0x20

	)

82 
	#USBDEVFS_URB_ZERO_PACKET
 0x40

	)

83 
	#USBDEVFS_URB_NO_INTERRUPT
 0x80

	)

85 
	#USBDEVFS_URB_TYPE_ISO
 0

	)

86 
	#USBDEVFS_URB_TYPE_INTERRUPT
 1

	)

87 
	#USBDEVFS_URB_TYPE_CONTROL
 2

	)

88 
	#USBDEVFS_URB_TYPE_BULK
 3

	)

90 
	susbdevfs_iso_·ck‘_desc
 {

91 
	mËngth
;

92 
	maùu®_Ëngth
;

93 
	m¡©us
;

96 
	susbdevfs_urb
 {

97 
	mty³
;

98 
	m’dpošt
;

99 
	m¡©us
;

100 
	mæags
;

101 *
	mbufãr
;

102 
	mbufãr_Ëngth
;

103 
	maùu®_Ëngth
;

104 
	m¡¬t_äame
;

105 
	mnumb”_of_·ck‘s
;

106 
	m”rÜ_couÁ
;

107 
	msigÄ
;

109 *
	mu£rcÚ‹xt
;

110 
usbdevfs_iso_·ck‘_desc
 
	miso_äame_desc
[0];

114 
	susbdevfs_ioùl
 {

115 
	miâo
;

116 
	mioùl_code
;

118 *
	md©a
;

123 
	susbdevfs_hub_pÜtšfo
 {

124 
	mÅÜts
;

125 
	mpÜt
 [127];

129 
	#USBDEVFS_CONTROL
 
	`_IOWR
('U', 0, 
usbdevfs_ù¾Œªsãr
)

	)

130 
	#USBDEVFS_CONTROL32
 
	`_IOWR
('U', 0, 
usbdevfs_ù¾Œªsãr32
)

	)

131 
	#USBDEVFS_BULK
 
	`_IOWR
('U', 2, 
usbdevfs_bulkŒªsãr
)

	)

132 
	#USBDEVFS_BULK32
 
	`_IOWR
('U', 2, 
usbdevfs_bulkŒªsãr32
)

	)

133 
	#USBDEVFS_RESETEP
 
	`_IOR
('U', 3, )

	)

134 
	#USBDEVFS_SETINTERFACE
 
	`_IOR
('U', 4, 
usbdevfs_£tš‹rçû
)

	)

135 
	#USBDEVFS_SETCONFIGURATION
 
	`_IOR
('U', 5, )

	)

136 
	#USBDEVFS_GETDRIVER
 
	`_IOW
('U', 8, 
usbdevfs_g‘driv”
)

	)

137 
	#USBDEVFS_SUBMITURB
 
	`_IOR
('U', 10, 
usbdevfs_urb
)

	)

138 
	#USBDEVFS_SUBMITURB32
 
	`_IOR
('U', 10, 
usbdevfs_urb32
)

	)

139 
	#USBDEVFS_DISCARDURB
 
	`_IO
('U', 11)

	)

140 
	#USBDEVFS_REAPURB
 
	`_IOW
('U', 12, *)

	)

141 
	#USBDEVFS_REAPURB32
 
	`_IOW
('U', 12, 
__u32
)

	)

142 
	#USBDEVFS_REAPURBNDELAY
 
	`_IOW
('U', 13, *)

	)

143 
	#USBDEVFS_REAPURBNDELAY32
 
	`_IOW
('U', 13, 
__u32
)

	)

144 
	#USBDEVFS_DISCSIGNAL
 
	`_IOR
('U', 14, 
usbdevfs_discÚÃùsigÇl
)

	)

145 
	#USBDEVFS_DISCSIGNAL32
 
	`_IOR
('U', 14, 
usbdevfs_discÚÃùsigÇl32
)

	)

146 
	#USBDEVFS_CLAIMINTERFACE
 
	`_IOR
('U', 15, )

	)

147 
	#USBDEVFS_RELEASEINTERFACE
 
	`_IOR
('U', 16, )

	)

148 
	#USBDEVFS_CONNECTINFO
 
	`_IOW
('U', 17, 
usbdevfs_cÚÃùšfo
)

	)

149 
	#USBDEVFS_IOCTL
 
	`_IOWR
('U', 18, 
usbdevfs_ioùl
)

	)

150 
	#USBDEVFS_IOCTL32
 
	`_IOWR
('U', 18, 
usbdevfs_ioùl32
)

	)

151 
	#USBDEVFS_HUB_PORTINFO
 
	`_IOR
('U', 19, 
usbdevfs_hub_pÜtšfo
)

	)

152 
	#USBDEVFS_RESET
 
	`_IO
('U', 20)

	)

153 
	#USBDEVFS_CLEAR_HALT
 
	`_IOR
('U', 21, )

	)

154 
	#USBDEVFS_DISCONNECT
 
	`_IO
('U', 22)

	)

155 
	#USBDEVFS_CONNECT
 
	`_IO
('U', 23)

	)

156 
	#USBDEVFS_CLAIM_PORT
 
	`_IOR
('U', 24, )

	)

157 
	#USBDEVFS_RELEASE_PORT
 
	`_IOR
('U', 25, )

	)

	@/usr/include/linux/utime.h

1 #iâdeà
_LINUX_UTIME_H


2 
	#_LINUX_UTIME_H


	)

4 
	~<lšux/ty³s.h
>

6 
	sutimbuf
 {

7 
__k”Ãl_time_t
 
	maùime
;

8 
__k”Ãl_time_t
 
	mmodtime
;

	@/usr/include/linux/utsname.h

1 #iâdeà
_LINUX_UTSNAME_H


2 
	#_LINUX_UTSNAME_H


	)

4 
	#__OLD_UTS_LEN
 8

	)

6 
	sŞdŞd_ut¢ame
 {

7 
	msy¢ame
[9];

8 
	mnod’ame
[9];

9 
	m»Ëa£
[9];

10 
	mv”siÚ
[9];

11 
	mmachše
[9];

14 
	#__NEW_UTS_LEN
 64

	)

16 
	sŞd_ut¢ame
 {

17 
	msy¢ame
[65];

18 
	mnod’ame
[65];

19 
	m»Ëa£
[65];

20 
	mv”siÚ
[65];

21 
	mmachše
[65];

24 
	sÃw_ut¢ame
 {

25 
	msy¢ame
[
__NEW_UTS_LEN
 + 1];

26 
	mnod’ame
[
__NEW_UTS_LEN
 + 1];

27 
	m»Ëa£
[
__NEW_UTS_LEN
 + 1];

28 
	mv”siÚ
[
__NEW_UTS_LEN
 + 1];

29 
	mmachše
[
__NEW_UTS_LEN
 + 1];

30 
	mdomašÇme
[
__NEW_UTS_LEN
 + 1];

	@/usr/include/linux/videodev2.h

56 #iâdeà
__LINUX_VIDEODEV2_H


57 
	#__LINUX_VIDEODEV2_H


	)

59 
	~<sys/time.h
>

61 
	~<lšux/ioùl.h
>

62 
	~<lšux/ty³s.h
>

68 
	#VIDEO_MAX_FRAME
 32

	)

69 
	#VIDEO_MAX_PLANES
 8

	)

75 
	#VID_TYPE_CAPTURE
 1

	)

76 
	#VID_TYPE_TUNER
 2

	)

77 
	#VID_TYPE_TELETEXT
 4

	)

78 
	#VID_TYPE_OVERLAY
 8

	)

79 
	#VID_TYPE_CHROMAKEY
 16

	)

80 
	#VID_TYPE_CLIPPING
 32

	)

81 
	#VID_TYPE_FRAMERAM
 64

	)

82 
	#VID_TYPE_SCALES
 128

	)

83 
	#VID_TYPE_MONOCHROME
 256

	)

84 
	#VID_TYPE_SUBCAPTURE
 512

	)

85 
	#VID_TYPE_MPEG_DECODER
 1024

	)

86 
	#VID_TYPE_MPEG_ENCODER
 2048

	)

87 
	#VID_TYPE_MJPEG_DECODER
 4096

	)

88 
	#VID_TYPE_MJPEG_ENCODER
 8192

	)

95 
	#v4l2_fourcc
(
a
, 
b
, 
c
, 
d
)\

96 ((
__u32
)(
a
è| ((__u32)(
b
è<< 8è| ((__u32)(
c
è<< 16è| ((__u32)(
d
è<< 24))

	)

101 
	ev4l2_f›ld
 {

102 
	mV4L2_FIELD_ANY
 = 0,

106 
	mV4L2_FIELD_NONE
 = 1,

107 
	mV4L2_FIELD_TOP
 = 2,

108 
	mV4L2_FIELD_BOTTOM
 = 3,

109 
	mV4L2_FIELD_INTERLACED
 = 4,

110 
	mV4L2_FIELD_SEQ_TB
 = 5,

112 
	mV4L2_FIELD_SEQ_BT
 = 6,

113 
	mV4L2_FIELD_ALTERNATE
 = 7,

115 
	mV4L2_FIELD_INTERLACED_TB
 = 8,

118 
	mV4L2_FIELD_INTERLACED_BT
 = 9,

122 
	#V4L2_FIELD_HAS_TOP
(
f›ld
) \

123 ((
f›ld
è=ğ
V4L2_FIELD_TOP
 ||\

124 (
f›ld
è=ğ
V4L2_FIELD_INTERLACED
 ||\

125 (
f›ld
è=ğ
V4L2_FIELD_INTERLACED_TB
 ||\

126 (
f›ld
è=ğ
V4L2_FIELD_INTERLACED_BT
 ||\

127 (
f›ld
è=ğ
V4L2_FIELD_SEQ_TB
 ||\

128 (
f›ld
è=ğ
V4L2_FIELD_SEQ_BT
)

	)

129 
	#V4L2_FIELD_HAS_BOTTOM
(
f›ld
) \

130 ((
f›ld
è=ğ
V4L2_FIELD_BOTTOM
 ||\

131 (
f›ld
è=ğ
V4L2_FIELD_INTERLACED
 ||\

132 (
f›ld
è=ğ
V4L2_FIELD_INTERLACED_TB
 ||\

133 (
f›ld
è=ğ
V4L2_FIELD_INTERLACED_BT
 ||\

134 (
f›ld
è=ğ
V4L2_FIELD_SEQ_TB
 ||\

135 (
f›ld
è=ğ
V4L2_FIELD_SEQ_BT
)

	)

136 
	#V4L2_FIELD_HAS_BOTH
(
f›ld
) \

137 ((
f›ld
è=ğ
V4L2_FIELD_INTERLACED
 ||\

138 (
f›ld
è=ğ
V4L2_FIELD_INTERLACED_TB
 ||\

139 (
f›ld
è=ğ
V4L2_FIELD_INTERLACED_BT
 ||\

140 (
f›ld
è=ğ
V4L2_FIELD_SEQ_TB
 ||\

141 (
f›ld
è=ğ
V4L2_FIELD_SEQ_BT
)

	)

143 
	ev4l2_buf_ty³
 {

144 
	mV4L2_BUF_TYPE_VIDEO_CAPTURE
 = 1,

145 
	mV4L2_BUF_TYPE_VIDEO_OUTPUT
 = 2,

146 
	mV4L2_BUF_TYPE_VIDEO_OVERLAY
 = 3,

147 
	mV4L2_BUF_TYPE_VBI_CAPTURE
 = 4,

148 
	mV4L2_BUF_TYPE_VBI_OUTPUT
 = 5,

149 
	mV4L2_BUF_TYPE_SLICED_VBI_CAPTURE
 = 6,

150 
	mV4L2_BUF_TYPE_SLICED_VBI_OUTPUT
 = 7,

153 
	mV4L2_BUF_TYPE_VIDEO_OUTPUT_OVERLAY
 = 8,

155 
	mV4L2_BUF_TYPE_VIDEO_CAPTURE_MPLANE
 = 9,

156 
	mV4L2_BUF_TYPE_VIDEO_OUTPUT_MPLANE
 = 10,

157 
	mV4L2_BUF_TYPE_PRIVATE
 = 0x80,

160 
	#V4L2_TYPE_IS_MULTIPLANAR
(
ty³
) \

161 ((
ty³
è=ğ
V4L2_BUF_TYPE_VIDEO_CAPTURE_MPLANE
 \

162 || (
ty³
è=ğ
V4L2_BUF_TYPE_VIDEO_OUTPUT_MPLANE
)

	)

164 
	#V4L2_TYPE_IS_OUTPUT
(
ty³
) \

165 ((
ty³
è=ğ
V4L2_BUF_TYPE_VIDEO_OUTPUT
 \

166 || (
ty³
è=ğ
V4L2_BUF_TYPE_VIDEO_OUTPUT_MPLANE
 \

167 || (
ty³
è=ğ
V4L2_BUF_TYPE_VIDEO_OVERLAY
 \

168 || (
ty³
è=ğ
V4L2_BUF_TYPE_VIDEO_OUTPUT_OVERLAY
 \

169 || (
ty³
è=ğ
V4L2_BUF_TYPE_VBI_OUTPUT
 \

170 || (
ty³
è=ğ
V4L2_BUF_TYPE_SLICED_VBI_OUTPUT
)

	)

172 
	ev4l2_tuÃr_ty³
 {

173 
	mV4L2_TUNER_RADIO
 = 1,

174 
	mV4L2_TUNER_ANALOG_TV
 = 2,

175 
	mV4L2_TUNER_DIGITAL_TV
 = 3,

178 
	ev4l2_memÜy
 {

179 
	mV4L2_MEMORY_MMAP
 = 1,

180 
	mV4L2_MEMORY_USERPTR
 = 2,

181 
	mV4L2_MEMORY_OVERLAY
 = 3,

185 
	ev4l2_cŞÜ¥aû
 {

187 
	mV4L2_COLORSPACE_SMPTE170M
 = 1,

190 
	mV4L2_COLORSPACE_SMPTE240M
 = 2,

193 
	mV4L2_COLORSPACE_REC709
 = 3,

196 
	mV4L2_COLORSPACE_BT878
 = 4,

199 
	mV4L2_COLORSPACE_470_SYSTEM_M
 = 5,

200 
	mV4L2_COLORSPACE_470_SYSTEM_BG
 = 6,

206 
	mV4L2_COLORSPACE_JPEG
 = 7,

209 
	mV4L2_COLORSPACE_SRGB
 = 8,

212 
	ev4l2_´iÜ™y
 {

213 
	mV4L2_PRIORITY_UNSET
 = 0,

214 
	mV4L2_PRIORITY_BACKGROUND
 = 1,

215 
	mV4L2_PRIORITY_INTERACTIVE
 = 2,

216 
	mV4L2_PRIORITY_RECORD
 = 3,

217 
	mV4L2_PRIORITY_DEFAULT
 = 
V4L2_PRIORITY_INTERACTIVE
,

220 
	sv4l2_»ù
 {

221 
__s32
 
	mËá
;

222 
__s32
 
	mtİ
;

223 
__s32
 
	mwidth
;

224 
__s32
 
	mheight
;

227 
	sv4l2_äaù
 {

228 
__u32
 
	mnum”©Ü
;

229 
__u32
 
	md’omš©Ü
;

235 
	sv4l2_ÿ·b™y
 {

236 
__u8
 
	mdriv”
[16];

237 
__u8
 
	mÿrd
[32];

238 
__u8
 
	mbus_šfo
[32];

239 
__u32
 
	mv”siÚ
;

240 
__u32
 
	mÿ·b™›s
;

241 
__u32
 
	m»£rved
[4];

245 
	#V4L2_CAP_VIDEO_CAPTURE
 0x00000001

	)

246 
	#V4L2_CAP_VIDEO_OUTPUT
 0x00000002

	)

247 
	#V4L2_CAP_VIDEO_OVERLAY
 0x00000004

	)

248 
	#V4L2_CAP_VBI_CAPTURE
 0x00000010

	)

249 
	#V4L2_CAP_VBI_OUTPUT
 0x00000020

	)

250 
	#V4L2_CAP_SLICED_VBI_CAPTURE
 0x00000040

	)

251 
	#V4L2_CAP_SLICED_VBI_OUTPUT
 0x00000080

	)

252 
	#V4L2_CAP_RDS_CAPTURE
 0x00000100

	)

253 
	#V4L2_CAP_VIDEO_OUTPUT_OVERLAY
 0x00000200

	)

254 
	#V4L2_CAP_HW_FREQ_SEEK
 0x00000400

	)

255 
	#V4L2_CAP_RDS_OUTPUT
 0x00000800

	)

258 
	#V4L2_CAP_VIDEO_CAPTURE_MPLANE
 0x00001000

	)

260 
	#V4L2_CAP_VIDEO_OUTPUT_MPLANE
 0x00002000

	)

262 
	#V4L2_CAP_TUNER
 0x00010000

	)

263 
	#V4L2_CAP_AUDIO
 0x00020000

	)

264 
	#V4L2_CAP_RADIO
 0x00040000

	)

265 
	#V4L2_CAP_MODULATOR
 0x00080000

	)

267 
	#V4L2_CAP_READWRITE
 0x01000000

	)

268 
	#V4L2_CAP_ASYNCIO
 0x02000000

	)

269 
	#V4L2_CAP_STREAMING
 0x04000000

	)

274 
	sv4l2_pix_fÜm©
 {

275 
__u32
 
	mwidth
;

276 
__u32
 
	mheight
;

277 
__u32
 
	mpix–fÜm©
;

278 
v4l2_f›ld
 
	mf›ld
;

279 
__u32
 
	mby‹¥”lše
;

280 
__u32
 
	msizeimage
;

281 
v4l2_cŞÜ¥aû
 
	mcŞÜ¥aû
;

282 
__u32
 
	m´iv
;

288 
	#V4L2_PIX_FMT_RGB332
 
	`v4l2_fourcc
('R', 'G', 'B', '1'è

	)

289 
	#V4L2_PIX_FMT_RGB444
 
	`v4l2_fourcc
('R', '4', '4', '4'è

	)

290 
	#V4L2_PIX_FMT_RGB555
 
	`v4l2_fourcc
('R', 'G', 'B', 'O'è

	)

291 
	#V4L2_PIX_FMT_RGB565
 
	`v4l2_fourcc
('R', 'G', 'B', 'P'è

	)

292 
	#V4L2_PIX_FMT_RGB555X
 
	`v4l2_fourcc
('R', 'G', 'B', 'Q'è

	)

293 
	#V4L2_PIX_FMT_RGB565X
 
	`v4l2_fourcc
('R', 'G', 'B', 'R'è

	)

294 
	#V4L2_PIX_FMT_BGR666
 
	`v4l2_fourcc
('B', 'G', 'R', 'H'è

	)

295 
	#V4L2_PIX_FMT_BGR24
 
	`v4l2_fourcc
('B', 'G', 'R', '3'è

	)

296 
	#V4L2_PIX_FMT_RGB24
 
	`v4l2_fourcc
('R', 'G', 'B', '3'è

	)

297 
	#V4L2_PIX_FMT_BGR32
 
	`v4l2_fourcc
('B', 'G', 'R', '4'è

	)

298 
	#V4L2_PIX_FMT_RGB32
 
	`v4l2_fourcc
('R', 'G', 'B', '4'è

	)

301 
	#V4L2_PIX_FMT_GREY
 
	`v4l2_fourcc
('G', 'R', 'E', 'Y'è

	)

302 
	#V4L2_PIX_FMT_Y4
 
	`v4l2_fourcc
('Y', '0', '4', ' 'è

	)

303 
	#V4L2_PIX_FMT_Y6
 
	`v4l2_fourcc
('Y', '0', '6', ' 'è

	)

304 
	#V4L2_PIX_FMT_Y10
 
	`v4l2_fourcc
('Y', '1', '0', ' 'è

	)

305 
	#V4L2_PIX_FMT_Y12
 
	`v4l2_fourcc
('Y', '1', '2', ' 'è

	)

306 
	#V4L2_PIX_FMT_Y16
 
	`v4l2_fourcc
('Y', '1', '6', ' 'è

	)

309 
	#V4L2_PIX_FMT_Y10BPACK
 
	`v4l2_fourcc
('Y', '1', '0', 'B'è

	)

312 
	#V4L2_PIX_FMT_PAL8
 
	`v4l2_fourcc
('P', 'A', 'L', '8'è

	)

315 
	#V4L2_PIX_FMT_YVU410
 
	`v4l2_fourcc
('Y', 'V', 'U', '9'è

	)

316 
	#V4L2_PIX_FMT_YVU420
 
	`v4l2_fourcc
('Y', 'V', '1', '2'è

	)

317 
	#V4L2_PIX_FMT_YUYV
 
	`v4l2_fourcc
('Y', 'U', 'Y', 'V'è

	)

318 
	#V4L2_PIX_FMT_YYUV
 
	`v4l2_fourcc
('Y', 'Y', 'U', 'V'è

	)

319 
	#V4L2_PIX_FMT_YVYU
 
	`v4l2_fourcc
('Y', 'V', 'Y', 'U'è

	)

320 
	#V4L2_PIX_FMT_UYVY
 
	`v4l2_fourcc
('U', 'Y', 'V', 'Y'è

	)

321 
	#V4L2_PIX_FMT_VYUY
 
	`v4l2_fourcc
('V', 'Y', 'U', 'Y'è

	)

322 
	#V4L2_PIX_FMT_YUV422P
 
	`v4l2_fourcc
('4', '2', '2', 'P'è

	)

323 
	#V4L2_PIX_FMT_YUV411P
 
	`v4l2_fourcc
('4', '1', '1', 'P'è

	)

324 
	#V4L2_PIX_FMT_Y41P
 
	`v4l2_fourcc
('Y', '4', '1', 'P'è

	)

325 
	#V4L2_PIX_FMT_YUV444
 
	`v4l2_fourcc
('Y', '4', '4', '4'è

	)

326 
	#V4L2_PIX_FMT_YUV555
 
	`v4l2_fourcc
('Y', 'U', 'V', 'O'è

	)

327 
	#V4L2_PIX_FMT_YUV565
 
	`v4l2_fourcc
('Y', 'U', 'V', 'P'è

	)

328 
	#V4L2_PIX_FMT_YUV32
 
	`v4l2_fourcc
('Y', 'U', 'V', '4'è

	)

329 
	#V4L2_PIX_FMT_YUV410
 
	`v4l2_fourcc
('Y', 'U', 'V', '9'è

	)

330 
	#V4L2_PIX_FMT_YUV420
 
	`v4l2_fourcc
('Y', 'U', '1', '2'è

	)

331 
	#V4L2_PIX_FMT_HI240
 
	`v4l2_fourcc
('H', 'I', '2', '4'è

	)

332 
	#V4L2_PIX_FMT_HM12
 
	`v4l2_fourcc
('H', 'M', '1', '2'è

	)

333 
	#V4L2_PIX_FMT_M420
 
	`v4l2_fourcc
('M', '4', '2', '0'è

	)

336 
	#V4L2_PIX_FMT_NV12
 
	`v4l2_fourcc
('N', 'V', '1', '2'è

	)

337 
	#V4L2_PIX_FMT_NV21
 
	`v4l2_fourcc
('N', 'V', '2', '1'è

	)

338 
	#V4L2_PIX_FMT_NV16
 
	`v4l2_fourcc
('N', 'V', '1', '6'è

	)

339 
	#V4L2_PIX_FMT_NV61
 
	`v4l2_fourcc
('N', 'V', '6', '1'è

	)

342 
	#V4L2_PIX_FMT_NV12M
 
	`v4l2_fourcc
('N', 'M', '1', '2'è

	)

343 
	#V4L2_PIX_FMT_NV12MT
 
	`v4l2_fourcc
('T', 'M', '1', '2'è

	)

346 
	#V4L2_PIX_FMT_YUV420M
 
	`v4l2_fourcc
('Y', 'M', '1', '2'è

	)

349 
	#V4L2_PIX_FMT_SBGGR8
 
	`v4l2_fourcc
('B', 'A', '8', '1'è

	)

350 
	#V4L2_PIX_FMT_SGBRG8
 
	`v4l2_fourcc
('G', 'B', 'R', 'G'è

	)

351 
	#V4L2_PIX_FMT_SGRBG8
 
	`v4l2_fourcc
('G', 'R', 'B', 'G'è

	)

352 
	#V4L2_PIX_FMT_SRGGB8
 
	`v4l2_fourcc
('R', 'G', 'G', 'B'è

	)

353 
	#V4L2_PIX_FMT_SBGGR10
 
	`v4l2_fourcc
('B', 'G', '1', '0'è

	)

354 
	#V4L2_PIX_FMT_SGBRG10
 
	`v4l2_fourcc
('G', 'B', '1', '0'è

	)

355 
	#V4L2_PIX_FMT_SGRBG10
 
	`v4l2_fourcc
('B', 'A', '1', '0'è

	)

356 
	#V4L2_PIX_FMT_SRGGB10
 
	`v4l2_fourcc
('R', 'G', '1', '0'è

	)

357 
	#V4L2_PIX_FMT_SBGGR12
 
	`v4l2_fourcc
('B', 'G', '1', '2'è

	)

358 
	#V4L2_PIX_FMT_SGBRG12
 
	`v4l2_fourcc
('G', 'B', '1', '2'è

	)

359 
	#V4L2_PIX_FMT_SGRBG12
 
	`v4l2_fourcc
('B', 'A', '1', '2'è

	)

360 
	#V4L2_PIX_FMT_SRGGB12
 
	`v4l2_fourcc
('R', 'G', '1', '2'è

	)

362 
	#V4L2_PIX_FMT_SGRBG10DPCM8
 
	`v4l2_fourcc
('B', 'D', '1', '0')

	)

367 
	#V4L2_PIX_FMT_SBGGR16
 
	`v4l2_fourcc
('B', 'Y', 'R', '2'è

	)

370 
	#V4L2_PIX_FMT_MJPEG
 
	`v4l2_fourcc
('M', 'J', 'P', 'G'è

	)

371 
	#V4L2_PIX_FMT_JPEG
 
	`v4l2_fourcc
('J', 'P', 'E', 'G'è

	)

372 
	#V4L2_PIX_FMT_DV
 
	`v4l2_fourcc
('d', 'v', 's', 'd'è

	)

373 
	#V4L2_PIX_FMT_MPEG
 
	`v4l2_fourcc
('M', 'P', 'E', 'G'è

	)

374 
	#V4L2_PIX_FMT_H264
 
	`v4l2_fourcc
('H', '2', '6', '4'è

	)

375 
	#V4L2_PIX_FMT_H264_NO_SC
 
	`v4l2_fourcc
('A', 'V', 'C', '1'è

	)

376 
	#V4L2_PIX_FMT_H263
 
	`v4l2_fourcc
('H', '2', '6', '3'è

	)

377 
	#V4L2_PIX_FMT_MPEG1
 
	`v4l2_fourcc
('M', 'P', 'G', '1'è

	)

378 
	#V4L2_PIX_FMT_MPEG2
 
	`v4l2_fourcc
('M', 'P', 'G', '2'è

	)

379 
	#V4L2_PIX_FMT_MPEG4
 
	`v4l2_fourcc
('M', 'P', 'G', '4'è

	)

380 
	#V4L2_PIX_FMT_XVID
 
	`v4l2_fourcc
('X', 'V', 'I', 'D'è

	)

381 
	#V4L2_PIX_FMT_VC1_ANNEX_G
 
	`v4l2_fourcc
('V', 'C', '1', 'G'è

	)

382 
	#V4L2_PIX_FMT_VC1_ANNEX_L
 
	`v4l2_fourcc
('V', 'C', '1', 'L'è

	)

385 
	#V4L2_PIX_FMT_CPIA1
 
	`v4l2_fourcc
('C', 'P', 'I', 'A'è

	)

386 
	#V4L2_PIX_FMT_WNVA
 
	`v4l2_fourcc
('W', 'N', 'V', 'A'è

	)

387 
	#V4L2_PIX_FMT_SN9C10X
 
	`v4l2_fourcc
('S', '9', '1', '0'è

	)

388 
	#V4L2_PIX_FMT_SN9C20X_I420
 
	`v4l2_fourcc
('S', '9', '2', '0'è

	)

389 
	#V4L2_PIX_FMT_PWC1
 
	`v4l2_fourcc
('P', 'W', 'C', '1'è

	)

390 
	#V4L2_PIX_FMT_PWC2
 
	`v4l2_fourcc
('P', 'W', 'C', '2'è

	)

391 
	#V4L2_PIX_FMT_ET61X251
 
	`v4l2_fourcc
('E', '6', '2', '5'è

	)

392 
	#V4L2_PIX_FMT_SPCA501
 
	`v4l2_fourcc
('S', '5', '0', '1'è

	)

393 
	#V4L2_PIX_FMT_SPCA505
 
	`v4l2_fourcc
('S', '5', '0', '5'è

	)

394 
	#V4L2_PIX_FMT_SPCA508
 
	`v4l2_fourcc
('S', '5', '0', '8'è

	)

395 
	#V4L2_PIX_FMT_SPCA561
 
	`v4l2_fourcc
('S', '5', '6', '1'è

	)

396 
	#V4L2_PIX_FMT_PAC207
 
	`v4l2_fourcc
('P', '2', '0', '7'è

	)

397 
	#V4L2_PIX_FMT_MR97310A
 
	`v4l2_fourcc
('M', '3', '1', '0'è

	)

398 
	#V4L2_PIX_FMT_SN9C2028
 
	`v4l2_fourcc
('S', 'O', 'N', 'X'è

	)

399 
	#V4L2_PIX_FMT_SQ905C
 
	`v4l2_fourcc
('9', '0', '5', 'C'è

	)

400 
	#V4L2_PIX_FMT_PJPG
 
	`v4l2_fourcc
('P', 'J', 'P', 'G'è

	)

401 
	#V4L2_PIX_FMT_OV511
 
	`v4l2_fourcc
('O', '5', '1', '1'è

	)

402 
	#V4L2_PIX_FMT_OV518
 
	`v4l2_fourcc
('O', '5', '1', '8'è

	)

403 
	#V4L2_PIX_FMT_STV0680
 
	`v4l2_fourcc
('S', '6', '8', '0'è

	)

404 
	#V4L2_PIX_FMT_TM6000
 
	`v4l2_fourcc
('T', 'M', '6', '0'è

	)

405 
	#V4L2_PIX_FMT_CIT_YYVYUY
 
	`v4l2_fourcc
('C', 'I', 'T', 'V'è

	)

406 
	#V4L2_PIX_FMT_KONICA420
 
	`v4l2_fourcc
('K', 'O', 'N', 'I'è

	)

407 
	#V4L2_PIX_FMT_JPGL
 
	`v4l2_fourcc
('J', 'P', 'G', 'L'è

	)

408 
	#V4L2_PIX_FMT_SE401
 
	`v4l2_fourcc
('S', '4', '0', '1'è

	)

413 
	sv4l2_fmtdesc
 {

414 
__u32
 
	mšdex
;

415 
v4l2_buf_ty³
 
	mty³
;

416 
__u32
 
	mæags
;

417 
__u8
 
	mdesütiÚ
[32];

418 
__u32
 
	mpix–fÜm©
;

419 
__u32
 
	m»£rved
[4];

422 
	#V4L2_FMT_FLAG_COMPRESSED
 0x0001

	)

423 
	#V4L2_FMT_FLAG_EMULATED
 0x0002

	)

430 
	ev4l2_ämsiz‘y³s
 {

431 
	mV4L2_FRMSIZE_TYPE_DISCRETE
 = 1,

432 
	mV4L2_FRMSIZE_TYPE_CONTINUOUS
 = 2,

433 
	mV4L2_FRMSIZE_TYPE_STEPWISE
 = 3,

436 
	sv4l2_ämsize_disü‘e
 {

437 
__u32
 
	mwidth
;

438 
__u32
 
	mheight
;

441 
	sv4l2_ämsize_¡•wi£
 {

442 
__u32
 
	mmš_width
;

443 
__u32
 
	mmax_width
;

444 
__u32
 
	m¡•_width
;

445 
__u32
 
	mmš_height
;

446 
__u32
 
	mmax_height
;

447 
__u32
 
	m¡•_height
;

450 
	sv4l2_ämsiz“num
 {

451 
__u32
 
	mšdex
;

452 
__u32
 
	mpix–_fÜm©
;

453 
__u32
 
	mty³
;

456 
v4l2_ämsize_disü‘e
 
	mdisü‘e
;

457 
v4l2_ämsize_¡•wi£
 
	m¡•wi£
;

460 
__u32
 
	m»£rved
[2];

466 
	ev4l2_ämiv®ty³s
 {

467 
	mV4L2_FRMIVAL_TYPE_DISCRETE
 = 1,

468 
	mV4L2_FRMIVAL_TYPE_CONTINUOUS
 = 2,

469 
	mV4L2_FRMIVAL_TYPE_STEPWISE
 = 3,

472 
	sv4l2_ämiv®_¡•wi£
 {

473 
v4l2_äaù
 
	mmš
;

474 
v4l2_äaù
 
	mmax
;

475 
v4l2_äaù
 
	m¡•
;

478 
	sv4l2_ämiv®’um
 {

479 
__u32
 
	mšdex
;

480 
__u32
 
	mpix–_fÜm©
;

481 
__u32
 
	mwidth
;

482 
__u32
 
	mheight
;

483 
__u32
 
	mty³
;

486 
v4l2_äaù
 
	mdisü‘e
;

487 
v4l2_ämiv®_¡•wi£
 
	m¡•wi£
;

490 
__u32
 
	m»£rved
[2];

497 
	sv4l2_timecode
 {

498 
__u32
 
	mty³
;

499 
__u32
 
	mæags
;

500 
__u8
 
	mäames
;

501 
__u8
 
	m£cÚds
;

502 
__u8
 
	mmšu‹s
;

503 
__u8
 
	mhours
;

504 
__u8
 
	mu£rb™s
[4];

508 
	#V4L2_TC_TYPE_24FPS
 1

	)

509 
	#V4L2_TC_TYPE_25FPS
 2

	)

510 
	#V4L2_TC_TYPE_30FPS
 3

	)

511 
	#V4L2_TC_TYPE_50FPS
 4

	)

512 
	#V4L2_TC_TYPE_60FPS
 5

	)

515 
	#V4L2_TC_FLAG_DROPFRAME
 0x0001

	)

516 
	#V4L2_TC_FLAG_COLORFRAME
 0x0002

	)

517 
	#V4L2_TC_USERBITS_f›ld
 0x000C

	)

518 
	#V4L2_TC_USERBITS_USERDEFINED
 0x0000

	)

519 
	#V4L2_TC_USERBITS_8BITCHARS
 0x0008

	)

522 
	sv4l2_j³gcom´essiÚ
 {

523 
	mqu®™y
;

525 
	mAPPn
;

527 
	mAPP_Ën
;

528 
	mAPP_d©a
[60];

530 
	mCOM_Ën
;

531 
	mCOM_d©a
[60];

533 
__u32
 
	mj³g_m¬k”s
;

543 
	#V4L2_JPEG_MARKER_DHT
 (1<<3è

	)

544 
	#V4L2_JPEG_MARKER_DQT
 (1<<4è

	)

545 
	#V4L2_JPEG_MARKER_DRI
 (1<<5è

	)

546 
	#V4L2_JPEG_MARKER_COM
 (1<<6è

	)

547 
	#V4L2_JPEG_MARKER_APP
 (1<<7è

	)

554 
	sv4l2_»que¡bufãrs
 {

555 
__u32
 
	mcouÁ
;

556 
v4l2_buf_ty³
 
	mty³
;

557 
v4l2_memÜy
 
	mmemÜy
;

558 
__u32
 
	m»£rved
[2];

579 
	sv4l2_¶ªe
 {

580 
__u32
 
	mby‹su£d
;

581 
__u32
 
	mËngth
;

583 
__u32
 
	mmem_off£t
;

584 
	mu£½Œ
;

585 } 
	mm
;

586 
__u32
 
	md©a_off£t
;

587 
__u32
 
	m»£rved
[11];

617 
	sv4l2_bufãr
 {

618 
__u32
 
	mšdex
;

619 
v4l2_buf_ty³
 
	mty³
;

620 
__u32
 
	mby‹su£d
;

621 
__u32
 
	mæags
;

622 
v4l2_f›ld
 
	mf›ld
;

623 
timev®
 
	mtime¡amp
;

624 
v4l2_timecode
 
	mtimecode
;

625 
__u32
 
	m£qu’û
;

628 
v4l2_memÜy
 
	mmemÜy
;

630 
__u32
 
	moff£t
;

631 
	mu£½Œ
;

632 
v4l2_¶ªe
 *
	m¶ªes
;

633 } 
	mm
;

634 
__u32
 
	mËngth
;

635 
__u32
 
	mšput
;

636 
__u32
 
	m»£rved
;

640 
	#V4L2_BUF_FLAG_MAPPED
 0x0001

	)

641 
	#V4L2_BUF_FLAG_QUEUED
 0x0002

	)

642 
	#V4L2_BUF_FLAG_DONE
 0x0004

	)

643 
	#V4L2_BUF_FLAG_KEYFRAME
 0x0008

	)

644 
	#V4L2_BUF_FLAG_PFRAME
 0x0010

	)

645 
	#V4L2_BUF_FLAG_BFRAME
 0x0020

	)

647 
	#V4L2_BUF_FLAG_ERROR
 0x0040

	)

648 
	#V4L2_BUF_FLAG_TIMECODE
 0x0100

	)

649 
	#V4L2_BUF_FLAG_INPUT
 0x0200

	)

650 
	#V4L2_BUF_FLAG_PREPARED
 0x0400

	)

652 
	#V4L2_BUF_FLAG_NO_CACHE_INVALIDATE
 0x0800

	)

653 
	#V4L2_BUF_FLAG_NO_CACHE_CLEAN
 0x1000

	)

658 
	sv4l2_äamebufãr
 {

659 
__u32
 
	mÿ·b™y
;

660 
__u32
 
	mæags
;

663 *
	mba£
;

664 
v4l2_pix_fÜm©
 
	mfmt
;

667 
	#V4L2_FBUF_CAP_EXTERNOVERLAY
 0x0001

	)

668 
	#V4L2_FBUF_CAP_CHROMAKEY
 0x0002

	)

669 
	#V4L2_FBUF_CAP_LIST_CLIPPING
 0x0004

	)

670 
	#V4L2_FBUF_CAP_BITMAP_CLIPPING
 0x0008

	)

671 
	#V4L2_FBUF_CAP_LOCAL_ALPHA
 0x0010

	)

672 
	#V4L2_FBUF_CAP_GLOBAL_ALPHA
 0x0020

	)

673 
	#V4L2_FBUF_CAP_LOCAL_INV_ALPHA
 0x0040

	)

674 
	#V4L2_FBUF_CAP_SRC_CHROMAKEY
 0x0080

	)

676 
	#V4L2_FBUF_FLAG_PRIMARY
 0x0001

	)

677 
	#V4L2_FBUF_FLAG_OVERLAY
 0x0002

	)

678 
	#V4L2_FBUF_FLAG_CHROMAKEY
 0x0004

	)

679 
	#V4L2_FBUF_FLAG_LOCAL_ALPHA
 0x0008

	)

680 
	#V4L2_FBUF_FLAG_GLOBAL_ALPHA
 0x0010

	)

681 
	#V4L2_FBUF_FLAG_LOCAL_INV_ALPHA
 0x0020

	)

682 
	#V4L2_FBUF_FLAG_SRC_CHROMAKEY
 0x0040

	)

684 
	sv4l2_ş
 {

685 
v4l2_»ù
 
	mc
;

686 
v4l2_ş
 *
	mÃxt
;

689 
	sv4l2_wšdow
 {

690 
v4l2_»ù
 
	mw
;

691 
v4l2_f›ld
 
	mf›ld
;

692 
__u32
 
	mchromakey
;

693 
v4l2_ş
 *
	mşs
;

694 
__u32
 
	mşcouÁ
;

695 *
	mb™m­
;

696 
__u8
 
	mglob®_®pha
;

702 
	sv4l2_ÿ±u»·rm
 {

703 
__u32
 
	mÿ·b™y
;

704 
__u32
 
	mÿ±u»mode
;

705 
v4l2_äaù
 
	mtim•”äame
;

706 
__u32
 
	mex‹ndedmode
;

707 
__u32
 
	m»adbufãrs
;

708 
__u32
 
	m»£rved
[4];

712 
	#V4L2_MODE_HIGHQUALITY
 0x0001

	)

713 
	#V4L2_CAP_TIMEPERFRAME
 0x1000

	)

715 
	sv4l2_ouu¬m
 {

716 
__u32
 
	mÿ·b™y
;

717 
__u32
 
	mouutmode
;

718 
v4l2_äaù
 
	mtim•”äame
;

719 
__u32
 
	mex‹ndedmode
;

720 
__u32
 
	mwr™ebufãrs
;

721 
__u32
 
	m»£rved
[4];

727 
	sv4l2_üİÿp
 {

728 
v4l2_buf_ty³
 
	mty³
;

729 
v4l2_»ù
 
	mbounds
;

730 
v4l2_»ù
 
	mdeäeù
;

731 
v4l2_äaù
 
	mpix–a¥eù
;

734 
	sv4l2_üİ
 {

735 
v4l2_buf_ty³
 
	mty³
;

736 
v4l2_»ù
 
	mc
;

743 
__u64
 
	tv4l2_¡d_id
;

746 
	#V4L2_STD_PAL_B
 ((
v4l2_¡d_id
)0x00000001)

	)

747 
	#V4L2_STD_PAL_B1
 ((
v4l2_¡d_id
)0x00000002)

	)

748 
	#V4L2_STD_PAL_G
 ((
v4l2_¡d_id
)0x00000004)

	)

749 
	#V4L2_STD_PAL_H
 ((
v4l2_¡d_id
)0x00000008)

	)

750 
	#V4L2_STD_PAL_I
 ((
v4l2_¡d_id
)0x00000010)

	)

751 
	#V4L2_STD_PAL_D
 ((
v4l2_¡d_id
)0x00000020)

	)

752 
	#V4L2_STD_PAL_D1
 ((
v4l2_¡d_id
)0x00000040)

	)

753 
	#V4L2_STD_PAL_K
 ((
v4l2_¡d_id
)0x00000080)

	)

755 
	#V4L2_STD_PAL_M
 ((
v4l2_¡d_id
)0x00000100)

	)

756 
	#V4L2_STD_PAL_N
 ((
v4l2_¡d_id
)0x00000200)

	)

757 
	#V4L2_STD_PAL_Nc
 ((
v4l2_¡d_id
)0x00000400)

	)

758 
	#V4L2_STD_PAL_60
 ((
v4l2_¡d_id
)0x00000800)

	)

760 
	#V4L2_STD_NTSC_M
 ((
v4l2_¡d_id
)0x00001000è

	)

761 
	#V4L2_STD_NTSC_M_JP
 ((
v4l2_¡d_id
)0x00002000è

	)

762 
	#V4L2_STD_NTSC_443
 ((
v4l2_¡d_id
)0x00004000)

	)

763 
	#V4L2_STD_NTSC_M_KR
 ((
v4l2_¡d_id
)0x00008000è

	)

765 
	#V4L2_STD_SECAM_B
 ((
v4l2_¡d_id
)0x00010000)

	)

766 
	#V4L2_STD_SECAM_D
 ((
v4l2_¡d_id
)0x00020000)

	)

767 
	#V4L2_STD_SECAM_G
 ((
v4l2_¡d_id
)0x00040000)

	)

768 
	#V4L2_STD_SECAM_H
 ((
v4l2_¡d_id
)0x00080000)

	)

769 
	#V4L2_STD_SECAM_K
 ((
v4l2_¡d_id
)0x00100000)

	)

770 
	#V4L2_STD_SECAM_K1
 ((
v4l2_¡d_id
)0x00200000)

	)

771 
	#V4L2_STD_SECAM_L
 ((
v4l2_¡d_id
)0x00400000)

	)

772 
	#V4L2_STD_SECAM_LC
 ((
v4l2_¡d_id
)0x00800000)

	)

775 
	#V4L2_STD_ATSC_8_VSB
 ((
v4l2_¡d_id
)0x01000000)

	)

776 
	#V4L2_STD_ATSC_16_VSB
 ((
v4l2_¡d_id
)0x02000000)

	)

796 
	#V4L2_STD_NTSC
 (
V4L2_STD_NTSC_M
 |\

797 
V4L2_STD_NTSC_M_JP
 |\

798 
V4L2_STD_NTSC_M_KR
)

	)

800 
	#V4L2_STD_SECAM_DK
 (
V4L2_STD_SECAM_D
 |\

801 
V4L2_STD_SECAM_K
 |\

802 
V4L2_STD_SECAM_K1
)

	)

804 
	#V4L2_STD_SECAM
 (
V4L2_STD_SECAM_B
 |\

805 
V4L2_STD_SECAM_G
 |\

806 
V4L2_STD_SECAM_H
 |\

807 
V4L2_STD_SECAM_DK
 |\

808 
V4L2_STD_SECAM_L
 |\

809 
V4L2_STD_SECAM_LC
)

	)

811 
	#V4L2_STD_PAL_BG
 (
V4L2_STD_PAL_B
 |\

812 
V4L2_STD_PAL_B1
 |\

813 
V4L2_STD_PAL_G
)

	)

814 
	#V4L2_STD_PAL_DK
 (
V4L2_STD_PAL_D
 |\

815 
V4L2_STD_PAL_D1
 |\

816 
V4L2_STD_PAL_K
)

	)

822 
	#V4L2_STD_PAL
 (
V4L2_STD_PAL_BG
 |\

823 
V4L2_STD_PAL_DK
 |\

824 
V4L2_STD_PAL_H
 |\

825 
V4L2_STD_PAL_I
)

	)

827 
	#V4L2_STD_B
 (
V4L2_STD_PAL_B
 |\

828 
V4L2_STD_PAL_B1
 |\

829 
V4L2_STD_SECAM_B
)

	)

830 
	#V4L2_STD_G
 (
V4L2_STD_PAL_G
 |\

831 
V4L2_STD_SECAM_G
)

	)

832 
	#V4L2_STD_H
 (
V4L2_STD_PAL_H
 |\

833 
V4L2_STD_SECAM_H
)

	)

834 
	#V4L2_STD_L
 (
V4L2_STD_SECAM_L
 |\

835 
V4L2_STD_SECAM_LC
)

	)

836 
	#V4L2_STD_GH
 (
V4L2_STD_G
 |\

837 
V4L2_STD_H
)

	)

838 
	#V4L2_STD_DK
 (
V4L2_STD_PAL_DK
 |\

839 
V4L2_STD_SECAM_DK
)

	)

840 
	#V4L2_STD_BG
 (
V4L2_STD_B
 |\

841 
V4L2_STD_G
)

	)

842 
	#V4L2_STD_MN
 (
V4L2_STD_PAL_M
 |\

843 
V4L2_STD_PAL_N
 |\

844 
V4L2_STD_PAL_Nc
 |\

845 
V4L2_STD_NTSC
)

	)

848 
	#V4L2_STD_MTS
 (
V4L2_STD_NTSC_M
 |\

849 
V4L2_STD_PAL_M
 |\

850 
V4L2_STD_PAL_N
 |\

851 
V4L2_STD_PAL_Nc
)

	)

854 
	#V4L2_STD_525_60
 (
V4L2_STD_PAL_M
 |\

855 
V4L2_STD_PAL_60
 |\

856 
V4L2_STD_NTSC
 |\

857 
V4L2_STD_NTSC_443
)

	)

859 
	#V4L2_STD_625_50
 (
V4L2_STD_PAL
 |\

860 
V4L2_STD_PAL_N
 |\

861 
V4L2_STD_PAL_Nc
 |\

862 
V4L2_STD_SECAM
)

	)

864 
	#V4L2_STD_ATSC
 (
V4L2_STD_ATSC_8_VSB
 |\

865 
V4L2_STD_ATSC_16_VSB
)

	)

867 
	#V4L2_STD_UNKNOWN
 0

	)

868 
	#V4L2_STD_ALL
 (
V4L2_STD_525_60
 |\

869 
V4L2_STD_625_50
)

	)

871 
	sv4l2_¡ªd¬d
 {

872 
__u32
 
	mšdex
;

873 
v4l2_¡d_id
 
	mid
;

874 
__u8
 
	mÇme
[24];

875 
v4l2_äaù
 
	mäam•”iod
;

876 
__u32
 
	mäam–šes
;

877 
__u32
 
	m»£rved
[4];

883 
	sv4l2_dv_´e£t
 {

884 
__u32
 
	m´e£t
;

885 
__u32
 
	m»£rved
[4];

891 
	sv4l2_dv_’um_´e£t
 {

892 
__u32
 
	mšdex
;

893 
__u32
 
	m´e£t
;

894 
__u8
 
	mÇme
[32];

895 
__u32
 
	mwidth
;

896 
__u32
 
	mheight
;

897 
__u32
 
	m»£rved
[4];

903 
	#V4L2_DV_INVALID
 0

	)

904 
	#V4L2_DV_480P59_94
 1

	)

905 
	#V4L2_DV_576P50
 2

	)

906 
	#V4L2_DV_720P24
 3

	)

907 
	#V4L2_DV_720P25
 4

	)

908 
	#V4L2_DV_720P30
 5

	)

909 
	#V4L2_DV_720P50
 6

	)

910 
	#V4L2_DV_720P59_94
 7

	)

911 
	#V4L2_DV_720P60
 8

	)

912 
	#V4L2_DV_1080I29_97
 9

	)

913 
	#V4L2_DV_1080I30
 10

	)

914 
	#V4L2_DV_1080I25
 11

	)

915 
	#V4L2_DV_1080I50
 12

	)

916 
	#V4L2_DV_1080I60
 13

	)

917 
	#V4L2_DV_1080P24
 14

	)

918 
	#V4L2_DV_1080P25
 15

	)

919 
	#V4L2_DV_1080P30
 16

	)

920 
	#V4L2_DV_1080P50
 17

	)

921 
	#V4L2_DV_1080P60
 18

	)

928 
	sv4l2_bt_timšgs
 {

929 
__u32
 
	mwidth
;

930 
__u32
 
	mheight
;

931 
__u32
 
	mš‹¾aûd
;

932 
__u32
 
	mpŞ¬™›s
;

933 
__u64
 
	mpix–şock
;

934 
__u32
 
	mhäÚÜch
;

935 
__u32
 
	mhsync
;

936 
__u32
 
	mhbackpÜch
;

937 
__u32
 
	mväÚÜch
;

938 
__u32
 
	mvsync
;

939 
__u32
 
	mvbackpÜch
;

940 
__u32
 
	m_väÚÜch
;

943 
__u32
 
	m_vsync
;

946 
__u32
 
	m_vbackpÜch
;

949 
__u32
 
	m»£rved
[16];

950 } 
__©Œibu‹__
 ((
·cked
));

953 
	#V4L2_DV_PROGRESSIVE
 0

	)

954 
	#V4L2_DV_INTERLACED
 1

	)

957 
	#V4L2_DV_VSYNC_POS_POL
 0x00000001

	)

958 
	#V4L2_DV_HSYNC_POS_POL
 0x00000002

	)

962 
	sv4l2_dv_timšgs
 {

963 
__u32
 
	mty³
;

965 
v4l2_bt_timšgs
 
	mbt
;

966 
__u32
 
	m»£rved
[32];

968 } 
__©Œibu‹__
 ((
·cked
));

971 
	#V4L2_DV_BT_656_1120
 0

	)

976 
	sv4l2_šput
 {

977 
__u32
 
	mšdex
;

978 
__u8
 
	mÇme
[32];

979 
__u32
 
	mty³
;

980 
__u32
 
	maudio£t
;

981 
__u32
 
	mtuÃr
;

982 
v4l2_¡d_id
 
	m¡d
;

983 
__u32
 
	m¡©us
;

984 
__u32
 
	mÿ·b™›s
;

985 
__u32
 
	m»£rved
[3];

989 
	#V4L2_INPUT_TYPE_TUNER
 1

	)

990 
	#V4L2_INPUT_TYPE_CAMERA
 2

	)

993 
	#V4L2_IN_ST_NO_POWER
 0x00000001

	)

994 
	#V4L2_IN_ST_NO_SIGNAL
 0x00000002

	)

995 
	#V4L2_IN_ST_NO_COLOR
 0x00000004

	)

999 
	#V4L2_IN_ST_HFLIP
 0x00000010

	)

1000 
	#V4L2_IN_ST_VFLIP
 0x00000020

	)

1003 
	#V4L2_IN_ST_NO_H_LOCK
 0x00000100

	)

1004 
	#V4L2_IN_ST_COLOR_KILL
 0x00000200

	)

1007 
	#V4L2_IN_ST_NO_SYNC
 0x00010000

	)

1008 
	#V4L2_IN_ST_NO_EQU
 0x00020000

	)

1009 
	#V4L2_IN_ST_NO_CARRIER
 0x00040000

	)

1012 
	#V4L2_IN_ST_MACROVISION
 0x01000000

	)

1013 
	#V4L2_IN_ST_NO_ACCESS
 0x02000000

	)

1014 
	#V4L2_IN_ST_VTR
 0x04000000

	)

1017 
	#V4L2_IN_CAP_PRESETS
 0x00000001

	)

1018 
	#V4L2_IN_CAP_CUSTOM_TIMINGS
 0x00000002

	)

1019 
	#V4L2_IN_CAP_STD
 0x00000004

	)

1024 
	sv4l2_ouut
 {

1025 
__u32
 
	mšdex
;

1026 
__u8
 
	mÇme
[32];

1027 
__u32
 
	mty³
;

1028 
__u32
 
	maudio£t
;

1029 
__u32
 
	mmoduÏtÜ
;

1030 
v4l2_¡d_id
 
	m¡d
;

1031 
__u32
 
	mÿ·b™›s
;

1032 
__u32
 
	m»£rved
[3];

1035 
	#V4L2_OUTPUT_TYPE_MODULATOR
 1

	)

1036 
	#V4L2_OUTPUT_TYPE_ANALOG
 2

	)

1037 
	#V4L2_OUTPUT_TYPE_ANALOGVGAOVERLAY
 3

	)

1040 
	#V4L2_OUT_CAP_PRESETS
 0x00000001

	)

1041 
	#V4L2_OUT_CAP_CUSTOM_TIMINGS
 0x00000002

	)

1042 
	#V4L2_OUT_CAP_STD
 0x00000004

	)

1047 
	sv4l2_cÚŒŞ
 {

1048 
__u32
 
	mid
;

1049 
__s32
 
	mv®ue
;

1052 
	sv4l2_ext_cÚŒŞ
 {

1053 
__u32
 
	mid
;

1054 
__u32
 
	msize
;

1055 
__u32
 
	m»£rved2
[1];

1057 
__s32
 
	mv®ue
;

1058 
__s64
 
	mv®ue64
;

1059 *
	m¡ršg
;

1061 } 
__©Œibu‹__
 ((
·cked
));

1063 
	sv4l2_ext_cÚŒŞs
 {

1064 
__u32
 
	mù¾_şass
;

1065 
__u32
 
	mcouÁ
;

1066 
__u32
 
	m”rÜ_idx
;

1067 
__u32
 
	m»£rved
[2];

1068 
v4l2_ext_cÚŒŞ
 *
	mcÚŒŞs
;

1072 
	#V4L2_CTRL_CLASS_USER
 0x00980000

	)

1073 
	#V4L2_CTRL_CLASS_MPEG
 0x00990000

	)

1074 
	#V4L2_CTRL_CLASS_CAMERA
 0x009a0000

	)

1075 
	#V4L2_CTRL_CLASS_FM_TX
 0x009b0000

	)

1076 
	#V4L2_CTRL_CLASS_FLASH
 0x009c0000

	)

1078 
	#V4L2_CTRL_ID_MASK
 (0x0fffffff)

	)

1079 
	#V4L2_CTRL_ID2CLASS
(
id
è((idè& 0x0fff0000UL)

	)

1080 
	#V4L2_CTRL_DRIVER_PRIV
(
id
è(((idè& 0xffffè>ğ0x1000)

	)

1082 
	ev4l2_ù¾_ty³
 {

1083 
	mV4L2_CTRL_TYPE_INTEGER
 = 1,

1084 
	mV4L2_CTRL_TYPE_BOOLEAN
 = 2,

1085 
	mV4L2_CTRL_TYPE_MENU
 = 3,

1086 
	mV4L2_CTRL_TYPE_BUTTON
 = 4,

1087 
	mV4L2_CTRL_TYPE_INTEGER64
 = 5,

1088 
	mV4L2_CTRL_TYPE_CTRL_CLASS
 = 6,

1089 
	mV4L2_CTRL_TYPE_STRING
 = 7,

1090 
	mV4L2_CTRL_TYPE_BITMASK
 = 8,

1094 
	sv4l2_qu”yù¾
 {

1095 
__u32
 
	mid
;

1096 
v4l2_ù¾_ty³
 
	mty³
;

1097 
__u8
 
	mÇme
[32];

1098 
__s32
 
	mmšimum
;

1099 
__s32
 
	mmaximum
;

1100 
__s32
 
	m¡•
;

1101 
__s32
 
	mdeçuÉ_v®ue
;

1102 
__u32
 
	mæags
;

1103 
__u32
 
	m»£rved
[2];

1107 
	sv4l2_qu”ym’u
 {

1108 
__u32
 
	mid
;

1109 
__u32
 
	mšdex
;

1110 
__u8
 
	mÇme
[32];

1111 
__u32
 
	m»£rved
;

1115 
	#V4L2_CTRL_FLAG_DISABLED
 0x0001

	)

1116 
	#V4L2_CTRL_FLAG_GRABBED
 0x0002

	)

1117 
	#V4L2_CTRL_FLAG_READ_ONLY
 0x0004

	)

1118 
	#V4L2_CTRL_FLAG_UPDATE
 0x0008

	)

1119 
	#V4L2_CTRL_FLAG_INACTIVE
 0x0010

	)

1120 
	#V4L2_CTRL_FLAG_SLIDER
 0x0020

	)

1121 
	#V4L2_CTRL_FLAG_WRITE_ONLY
 0x0040

	)

1122 
	#V4L2_CTRL_FLAG_VOLATILE
 0x0080

	)

1125 
	#V4L2_CTRL_FLAG_NEXT_CTRL
 0x80000000

	)

1128 
	#V4L2_CID_MAX_CTRLS
 1024

	)

1129 
	#V4L2_CID_BASE
 (
V4L2_CTRL_CLASS_USER
 | 0x900)

	)

1130 
	#V4L2_CID_USER_BASE
 
V4L2_CID_BASE


	)

1132 
	#V4L2_CID_PRIVATE_BASE
 0x08000000

	)

1134 
	#V4L2_CID_USER_CLASS
 (
V4L2_CTRL_CLASS_USER
 | 1)

	)

1135 
	#V4L2_CID_BRIGHTNESS
 (
V4L2_CID_BASE
+0)

	)

1136 
	#V4L2_CID_CONTRAST
 (
V4L2_CID_BASE
+1)

	)

1137 
	#V4L2_CID_SATURATION
 (
V4L2_CID_BASE
+2)

	)

1138 
	#V4L2_CID_HUE
 (
V4L2_CID_BASE
+3)

	)

1139 
	#V4L2_CID_AUDIO_VOLUME
 (
V4L2_CID_BASE
+5)

	)

1140 
	#V4L2_CID_AUDIO_BALANCE
 (
V4L2_CID_BASE
+6)

	)

1141 
	#V4L2_CID_AUDIO_BASS
 (
V4L2_CID_BASE
+7)

	)

1142 
	#V4L2_CID_AUDIO_TREBLE
 (
V4L2_CID_BASE
+8)

	)

1143 
	#V4L2_CID_AUDIO_MUTE
 (
V4L2_CID_BASE
+9)

	)

1144 
	#V4L2_CID_AUDIO_LOUDNESS
 (
V4L2_CID_BASE
+10)

	)

1145 
	#V4L2_CID_BLACK_LEVEL
 (
V4L2_CID_BASE
+11è

	)

1146 
	#V4L2_CID_AUTO_WHITE_BALANCE
 (
V4L2_CID_BASE
+12)

	)

1147 
	#V4L2_CID_DO_WHITE_BALANCE
 (
V4L2_CID_BASE
+13)

	)

1148 
	#V4L2_CID_RED_BALANCE
 (
V4L2_CID_BASE
+14)

	)

1149 
	#V4L2_CID_BLUE_BALANCE
 (
V4L2_CID_BASE
+15)

	)

1150 
	#V4L2_CID_GAMMA
 (
V4L2_CID_BASE
+16)

	)

1151 
	#V4L2_CID_WHITENESS
 (
V4L2_CID_GAMMA
è

	)

1152 
	#V4L2_CID_EXPOSURE
 (
V4L2_CID_BASE
+17)

	)

1153 
	#V4L2_CID_AUTOGAIN
 (
V4L2_CID_BASE
+18)

	)

1154 
	#V4L2_CID_GAIN
 (
V4L2_CID_BASE
+19)

	)

1155 
	#V4L2_CID_HFLIP
 (
V4L2_CID_BASE
+20)

	)

1156 
	#V4L2_CID_VFLIP
 (
V4L2_CID_BASE
+21)

	)

1159 
	#V4L2_CID_HCENTER
 (
V4L2_CID_BASE
+22)

	)

1160 
	#V4L2_CID_VCENTER
 (
V4L2_CID_BASE
+23)

	)

1162 
	#V4L2_CID_POWER_LINE_FREQUENCY
 (
V4L2_CID_BASE
+24)

	)

1163 
	ev4l2_pow”_lše_äequ’cy
 {

1164 
	mV4L2_CID_POWER_LINE_FREQUENCY_DISABLED
 = 0,

1165 
	mV4L2_CID_POWER_LINE_FREQUENCY_50HZ
 = 1,

1166 
	mV4L2_CID_POWER_LINE_FREQUENCY_60HZ
 = 2,

1167 
	mV4L2_CID_POWER_LINE_FREQUENCY_AUTO
 = 3,

1169 
	#V4L2_CID_HUE_AUTO
 (
V4L2_CID_BASE
+25)

	)

1170 
	#V4L2_CID_WHITE_BALANCE_TEMPERATURE
 (
V4L2_CID_BASE
+26)

	)

1171 
	#V4L2_CID_SHARPNESS
 (
V4L2_CID_BASE
+27)

	)

1172 
	#V4L2_CID_BACKLIGHT_COMPENSATION
 (
V4L2_CID_BASE
+28)

	)

1173 
	#V4L2_CID_CHROMA_AGC
 (
V4L2_CID_BASE
+29)

	)

1174 
	#V4L2_CID_COLOR_KILLER
 (
V4L2_CID_BASE
+30)

	)

1175 
	#V4L2_CID_COLORFX
 (
V4L2_CID_BASE
+31)

	)

1176 
	ev4l2_cŞÜfx
 {

1177 
	mV4L2_COLORFX_NONE
 = 0,

1178 
	mV4L2_COLORFX_BW
 = 1,

1179 
	mV4L2_COLORFX_SEPIA
 = 2,

1180 
	mV4L2_COLORFX_NEGATIVE
 = 3,

1181 
	mV4L2_COLORFX_EMBOSS
 = 4,

1182 
	mV4L2_COLORFX_SKETCH
 = 5,

1183 
	mV4L2_COLORFX_SKY_BLUE
 = 6,

1184 
	mV4L2_COLORFX_GRASS_GREEN
 = 7,

1185 
	mV4L2_COLORFX_SKIN_WHITEN
 = 8,

1186 
	mV4L2_COLORFX_VIVID
 = 9,

1188 
	#V4L2_CID_AUTOBRIGHTNESS
 (
V4L2_CID_BASE
+32)

	)

1189 
	#V4L2_CID_BAND_STOP_FILTER
 (
V4L2_CID_BASE
+33)

	)

1191 
	#V4L2_CID_ROTATE
 (
V4L2_CID_BASE
+34)

	)

1192 
	#V4L2_CID_BG_COLOR
 (
V4L2_CID_BASE
+35)

	)

1194 
	#V4L2_CID_CHROMA_GAIN
 (
V4L2_CID_BASE
+36)

	)

1196 
	#V4L2_CID_ILLUMINATORS_1
 (
V4L2_CID_BASE
+37)

	)

1197 
	#V4L2_CID_ILLUMINATORS_2
 (
V4L2_CID_BASE
+38)

	)

1199 
	#V4L2_CID_MIN_BUFFERS_FOR_CAPTURE
 (
V4L2_CID_BASE
+39)

	)

1200 
	#V4L2_CID_MIN_BUFFERS_FOR_OUTPUT
 (
V4L2_CID_BASE
+40)

	)

1203 
	#V4L2_CID_LASTP1
 (
V4L2_CID_BASE
+41)

	)

1208 
	#V4L2_CID_MPEG_BASE
 (
V4L2_CTRL_CLASS_MPEG
 | 0x900)

	)

1209 
	#V4L2_CID_MPEG_CLASS
 (
V4L2_CTRL_CLASS_MPEG
 | 1)

	)

1212 
	#V4L2_CID_MPEG_STREAM_TYPE
 (
V4L2_CID_MPEG_BASE
+0)

	)

1213 
	ev4l2_m³g_¡»am_ty³
 {

1214 
	mV4L2_MPEG_STREAM_TYPE_MPEG2_PS
 = 0,

1215 
	mV4L2_MPEG_STREAM_TYPE_MPEG2_TS
 = 1,

1216 
	mV4L2_MPEG_STREAM_TYPE_MPEG1_SS
 = 2,

1217 
	mV4L2_MPEG_STREAM_TYPE_MPEG2_DVD
 = 3,

1218 
	mV4L2_MPEG_STREAM_TYPE_MPEG1_VCD
 = 4,

1219 
	mV4L2_MPEG_STREAM_TYPE_MPEG2_SVCD
 = 5,

1221 
	#V4L2_CID_MPEG_STREAM_PID_PMT
 (
V4L2_CID_MPEG_BASE
+1)

	)

1222 
	#V4L2_CID_MPEG_STREAM_PID_AUDIO
 (
V4L2_CID_MPEG_BASE
+2)

	)

1223 
	#V4L2_CID_MPEG_STREAM_PID_VIDEO
 (
V4L2_CID_MPEG_BASE
+3)

	)

1224 
	#V4L2_CID_MPEG_STREAM_PID_PCR
 (
V4L2_CID_MPEG_BASE
+4)

	)

1225 
	#V4L2_CID_MPEG_STREAM_PES_ID_AUDIO
 (
V4L2_CID_MPEG_BASE
+5)

	)

1226 
	#V4L2_CID_MPEG_STREAM_PES_ID_VIDEO
 (
V4L2_CID_MPEG_BASE
+6)

	)

1227 
	#V4L2_CID_MPEG_STREAM_VBI_FMT
 (
V4L2_CID_MPEG_BASE
+7)

	)

1228 
	ev4l2_m³g_¡»am_vbi_fmt
 {

1229 
	mV4L2_MPEG_STREAM_VBI_FMT_NONE
 = 0,

1230 
	mV4L2_MPEG_STREAM_VBI_FMT_IVTV
 = 1,

1234 
	#V4L2_CID_MPEG_AUDIO_SAMPLING_FREQ
 (
V4L2_CID_MPEG_BASE
+100)

	)

1235 
	ev4l2_m³g_audio_§m¶šg_äeq
 {

1236 
	mV4L2_MPEG_AUDIO_SAMPLING_FREQ_44100
 = 0,

1237 
	mV4L2_MPEG_AUDIO_SAMPLING_FREQ_48000
 = 1,

1238 
	mV4L2_MPEG_AUDIO_SAMPLING_FREQ_32000
 = 2,

1240 
	#V4L2_CID_MPEG_AUDIO_ENCODING
 (
V4L2_CID_MPEG_BASE
+101)

	)

1241 
	ev4l2_m³g_audio_’codšg
 {

1242 
	mV4L2_MPEG_AUDIO_ENCODING_LAYER_1
 = 0,

1243 
	mV4L2_MPEG_AUDIO_ENCODING_LAYER_2
 = 1,

1244 
	mV4L2_MPEG_AUDIO_ENCODING_LAYER_3
 = 2,

1245 
	mV4L2_MPEG_AUDIO_ENCODING_AAC
 = 3,

1246 
	mV4L2_MPEG_AUDIO_ENCODING_AC3
 = 4,

1248 
	#V4L2_CID_MPEG_AUDIO_L1_BITRATE
 (
V4L2_CID_MPEG_BASE
+102)

	)

1249 
	ev4l2_m³g_audio_l1_b™¿‹
 {

1250 
	mV4L2_MPEG_AUDIO_L1_BITRATE_32K
 = 0,

1251 
	mV4L2_MPEG_AUDIO_L1_BITRATE_64K
 = 1,

1252 
	mV4L2_MPEG_AUDIO_L1_BITRATE_96K
 = 2,

1253 
	mV4L2_MPEG_AUDIO_L1_BITRATE_128K
 = 3,

1254 
	mV4L2_MPEG_AUDIO_L1_BITRATE_160K
 = 4,

1255 
	mV4L2_MPEG_AUDIO_L1_BITRATE_192K
 = 5,

1256 
	mV4L2_MPEG_AUDIO_L1_BITRATE_224K
 = 6,

1257 
	mV4L2_MPEG_AUDIO_L1_BITRATE_256K
 = 7,

1258 
	mV4L2_MPEG_AUDIO_L1_BITRATE_288K
 = 8,

1259 
	mV4L2_MPEG_AUDIO_L1_BITRATE_320K
 = 9,

1260 
	mV4L2_MPEG_AUDIO_L1_BITRATE_352K
 = 10,

1261 
	mV4L2_MPEG_AUDIO_L1_BITRATE_384K
 = 11,

1262 
	mV4L2_MPEG_AUDIO_L1_BITRATE_416K
 = 12,

1263 
	mV4L2_MPEG_AUDIO_L1_BITRATE_448K
 = 13,

1265 
	#V4L2_CID_MPEG_AUDIO_L2_BITRATE
 (
V4L2_CID_MPEG_BASE
+103)

	)

1266 
	ev4l2_m³g_audio_l2_b™¿‹
 {

1267 
	mV4L2_MPEG_AUDIO_L2_BITRATE_32K
 = 0,

1268 
	mV4L2_MPEG_AUDIO_L2_BITRATE_48K
 = 1,

1269 
	mV4L2_MPEG_AUDIO_L2_BITRATE_56K
 = 2,

1270 
	mV4L2_MPEG_AUDIO_L2_BITRATE_64K
 = 3,

1271 
	mV4L2_MPEG_AUDIO_L2_BITRATE_80K
 = 4,

1272 
	mV4L2_MPEG_AUDIO_L2_BITRATE_96K
 = 5,

1273 
	mV4L2_MPEG_AUDIO_L2_BITRATE_112K
 = 6,

1274 
	mV4L2_MPEG_AUDIO_L2_BITRATE_128K
 = 7,

1275 
	mV4L2_MPEG_AUDIO_L2_BITRATE_160K
 = 8,

1276 
	mV4L2_MPEG_AUDIO_L2_BITRATE_192K
 = 9,

1277 
	mV4L2_MPEG_AUDIO_L2_BITRATE_224K
 = 10,

1278 
	mV4L2_MPEG_AUDIO_L2_BITRATE_256K
 = 11,

1279 
	mV4L2_MPEG_AUDIO_L2_BITRATE_320K
 = 12,

1280 
	mV4L2_MPEG_AUDIO_L2_BITRATE_384K
 = 13,

1282 
	#V4L2_CID_MPEG_AUDIO_L3_BITRATE
 (
V4L2_CID_MPEG_BASE
+104)

	)

1283 
	ev4l2_m³g_audio_l3_b™¿‹
 {

1284 
	mV4L2_MPEG_AUDIO_L3_BITRATE_32K
 = 0,

1285 
	mV4L2_MPEG_AUDIO_L3_BITRATE_40K
 = 1,

1286 
	mV4L2_MPEG_AUDIO_L3_BITRATE_48K
 = 2,

1287 
	mV4L2_MPEG_AUDIO_L3_BITRATE_56K
 = 3,

1288 
	mV4L2_MPEG_AUDIO_L3_BITRATE_64K
 = 4,

1289 
	mV4L2_MPEG_AUDIO_L3_BITRATE_80K
 = 5,

1290 
	mV4L2_MPEG_AUDIO_L3_BITRATE_96K
 = 6,

1291 
	mV4L2_MPEG_AUDIO_L3_BITRATE_112K
 = 7,

1292 
	mV4L2_MPEG_AUDIO_L3_BITRATE_128K
 = 8,

1293 
	mV4L2_MPEG_AUDIO_L3_BITRATE_160K
 = 9,

1294 
	mV4L2_MPEG_AUDIO_L3_BITRATE_192K
 = 10,

1295 
	mV4L2_MPEG_AUDIO_L3_BITRATE_224K
 = 11,

1296 
	mV4L2_MPEG_AUDIO_L3_BITRATE_256K
 = 12,

1297 
	mV4L2_MPEG_AUDIO_L3_BITRATE_320K
 = 13,

1299 
	#V4L2_CID_MPEG_AUDIO_MODE
 (
V4L2_CID_MPEG_BASE
+105)

	)

1300 
	ev4l2_m³g_audio_mode
 {

1301 
	mV4L2_MPEG_AUDIO_MODE_STEREO
 = 0,

1302 
	mV4L2_MPEG_AUDIO_MODE_JOINT_STEREO
 = 1,

1303 
	mV4L2_MPEG_AUDIO_MODE_DUAL
 = 2,

1304 
	mV4L2_MPEG_AUDIO_MODE_MONO
 = 3,

1306 
	#V4L2_CID_MPEG_AUDIO_MODE_EXTENSION
 (
V4L2_CID_MPEG_BASE
+106)

	)

1307 
	ev4l2_m³g_audio_mode_ex‹nsiÚ
 {

1308 
	mV4L2_MPEG_AUDIO_MODE_EXTENSION_BOUND_4
 = 0,

1309 
	mV4L2_MPEG_AUDIO_MODE_EXTENSION_BOUND_8
 = 1,

1310 
	mV4L2_MPEG_AUDIO_MODE_EXTENSION_BOUND_12
 = 2,

1311 
	mV4L2_MPEG_AUDIO_MODE_EXTENSION_BOUND_16
 = 3,

1313 
	#V4L2_CID_MPEG_AUDIO_EMPHASIS
 (
V4L2_CID_MPEG_BASE
+107)

	)

1314 
	ev4l2_m³g_audio_emphasis
 {

1315 
	mV4L2_MPEG_AUDIO_EMPHASIS_NONE
 = 0,

1316 
	mV4L2_MPEG_AUDIO_EMPHASIS_50_DIV_15_uS
 = 1,

1317 
	mV4L2_MPEG_AUDIO_EMPHASIS_CCITT_J17
 = 2,

1319 
	#V4L2_CID_MPEG_AUDIO_CRC
 (
V4L2_CID_MPEG_BASE
+108)

	)

1320 
	ev4l2_m³g_audio_üc
 {

1321 
	mV4L2_MPEG_AUDIO_CRC_NONE
 = 0,

1322 
	mV4L2_MPEG_AUDIO_CRC_CRC16
 = 1,

1324 
	#V4L2_CID_MPEG_AUDIO_MUTE
 (
V4L2_CID_MPEG_BASE
+109)

	)

1325 
	#V4L2_CID_MPEG_AUDIO_AAC_BITRATE
 (
V4L2_CID_MPEG_BASE
+110)

	)

1326 
	#V4L2_CID_MPEG_AUDIO_AC3_BITRATE
 (
V4L2_CID_MPEG_BASE
+111)

	)

1327 
	ev4l2_m³g_audio_ac3_b™¿‹
 {

1328 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_32K
 = 0,

1329 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_40K
 = 1,

1330 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_48K
 = 2,

1331 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_56K
 = 3,

1332 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_64K
 = 4,

1333 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_80K
 = 5,

1334 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_96K
 = 6,

1335 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_112K
 = 7,

1336 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_128K
 = 8,

1337 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_160K
 = 9,

1338 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_192K
 = 10,

1339 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_224K
 = 11,

1340 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_256K
 = 12,

1341 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_320K
 = 13,

1342 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_384K
 = 14,

1343 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_448K
 = 15,

1344 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_512K
 = 16,

1345 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_576K
 = 17,

1346 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_640K
 = 18,

1350 
	#V4L2_CID_MPEG_VIDEO_ENCODING
 (
V4L2_CID_MPEG_BASE
+200)

	)

1351 
	ev4l2_m³g_video_’codšg
 {

1352 
	mV4L2_MPEG_VIDEO_ENCODING_MPEG_1
 = 0,

1353 
	mV4L2_MPEG_VIDEO_ENCODING_MPEG_2
 = 1,

1354 
	mV4L2_MPEG_VIDEO_ENCODING_MPEG_4_AVC
 = 2,

1356 
	#V4L2_CID_MPEG_VIDEO_ASPECT
 (
V4L2_CID_MPEG_BASE
+201)

	)

1357 
	ev4l2_m³g_video_a¥eù
 {

1358 
	mV4L2_MPEG_VIDEO_ASPECT_1x1
 = 0,

1359 
	mV4L2_MPEG_VIDEO_ASPECT_4x3
 = 1,

1360 
	mV4L2_MPEG_VIDEO_ASPECT_16x9
 = 2,

1361 
	mV4L2_MPEG_VIDEO_ASPECT_221x100
 = 3,

1363 
	#V4L2_CID_MPEG_VIDEO_B_FRAMES
 (
V4L2_CID_MPEG_BASE
+202)

	)

1364 
	#V4L2_CID_MPEG_VIDEO_GOP_SIZE
 (
V4L2_CID_MPEG_BASE
+203)

	)

1365 
	#V4L2_CID_MPEG_VIDEO_GOP_CLOSURE
 (
V4L2_CID_MPEG_BASE
+204)

	)

1366 
	#V4L2_CID_MPEG_VIDEO_PULLDOWN
 (
V4L2_CID_MPEG_BASE
+205)

	)

1367 
	#V4L2_CID_MPEG_VIDEO_BITRATE_MODE
 (
V4L2_CID_MPEG_BASE
+206)

	)

1368 
	ev4l2_m³g_video_b™¿‹_mode
 {

1369 
	mV4L2_MPEG_VIDEO_BITRATE_MODE_VBR
 = 0,

1370 
	mV4L2_MPEG_VIDEO_BITRATE_MODE_CBR
 = 1,

1372 
	#V4L2_CID_MPEG_VIDEO_BITRATE
 (
V4L2_CID_MPEG_BASE
+207)

	)

1373 
	#V4L2_CID_MPEG_VIDEO_BITRATE_PEAK
 (
V4L2_CID_MPEG_BASE
+208)

	)

1374 
	#V4L2_CID_MPEG_VIDEO_TEMPORAL_DECIMATION
 (
V4L2_CID_MPEG_BASE
+209)

	)

1375 
	#V4L2_CID_MPEG_VIDEO_MUTE
 (
V4L2_CID_MPEG_BASE
+210)

	)

1376 
	#V4L2_CID_MPEG_VIDEO_MUTE_YUV
 (
V4L2_CID_MPEG_BASE
+211)

	)

1377 
	#V4L2_CID_MPEG_VIDEO_DECODER_SLICE_INTERFACE
 (
V4L2_CID_MPEG_BASE
+212)

	)

1378 
	#V4L2_CID_MPEG_VIDEO_DECODER_MPEG4_DEBLOCK_FILTER
 (
V4L2_CID_MPEG_BASE
+213)

	)

1379 
	#V4L2_CID_MPEG_VIDEO_CYCLIC_INTRA_REFRESH_MB
 (
V4L2_CID_MPEG_BASE
+214)

	)

1380 
	#V4L2_CID_MPEG_VIDEO_FRAME_RC_ENABLE
 (
V4L2_CID_MPEG_BASE
+215)

	)

1381 
	#V4L2_CID_MPEG_VIDEO_HEADER_MODE
 (
V4L2_CID_MPEG_BASE
+216)

	)

1382 
	ev4l2_m³g_video_h—d”_mode
 {

1383 
	mV4L2_MPEG_VIDEO_HEADER_MODE_SEPARATE
 = 0,

1384 
	mV4L2_MPEG_VIDEO_HEADER_MODE_JOINED_WITH_1ST_FRAME
 = 1,

1387 
	#V4L2_CID_MPEG_VIDEO_MAX_REF_PIC
 (
V4L2_CID_MPEG_BASE
+217)

	)

1388 
	#V4L2_CID_MPEG_VIDEO_MB_RC_ENABLE
 (
V4L2_CID_MPEG_BASE
+218)

	)

1389 
	#V4L2_CID_MPEG_VIDEO_MULTI_SLICE_MAX_BYTES
 (
V4L2_CID_MPEG_BASE
+219)

	)

1390 
	#V4L2_CID_MPEG_VIDEO_MULTI_SLICE_MAX_MB
 (
V4L2_CID_MPEG_BASE
+220)

	)

1391 
	#V4L2_CID_MPEG_VIDEO_MULTI_SLICE_MODE
 (
V4L2_CID_MPEG_BASE
+221)

	)

1392 
	ev4l2_m³g_video_muÉi_¦iû_mode
 {

1393 
	mV4L2_MPEG_VIDEO_MULTI_SLICE_MODE_SINGLE
 = 0,

1394 
	mV4L2_MPEG_VIDEO_MULTI_SICE_MODE_MAX_MB
 = 1,

1395 
	mV4L2_MPEG_VIDEO_MULTI_SICE_MODE_MAX_BYTES
 = 2,

1397 
	#V4L2_CID_MPEG_VIDEO_VBV_SIZE
 (
V4L2_CID_MPEG_BASE
+222)

	)

1398 
	#V4L2_CID_MPEG_VIDEO_H263_I_FRAME_QP
 (
V4L2_CID_MPEG_BASE
+300)

	)

1399 
	#V4L2_CID_MPEG_VIDEO_H263_P_FRAME_QP
 (
V4L2_CID_MPEG_BASE
+301)

	)

1400 
	#V4L2_CID_MPEG_VIDEO_H263_B_FRAME_QP
 (
V4L2_CID_MPEG_BASE
+302)

	)

1401 
	#V4L2_CID_MPEG_VIDEO_H263_MIN_QP
 (
V4L2_CID_MPEG_BASE
+303)

	)

1402 
	#V4L2_CID_MPEG_VIDEO_H263_MAX_QP
 (
V4L2_CID_MPEG_BASE
+304)

	)

1403 
	#V4L2_CID_MPEG_VIDEO_H264_I_FRAME_QP
 (
V4L2_CID_MPEG_BASE
+350)

	)

1404 
	#V4L2_CID_MPEG_VIDEO_H264_P_FRAME_QP
 (
V4L2_CID_MPEG_BASE
+351)

	)

1405 
	#V4L2_CID_MPEG_VIDEO_H264_B_FRAME_QP
 (
V4L2_CID_MPEG_BASE
+352)

	)

1406 
	#V4L2_CID_MPEG_VIDEO_H264_MIN_QP
 (
V4L2_CID_MPEG_BASE
+353)

	)

1407 
	#V4L2_CID_MPEG_VIDEO_H264_MAX_QP
 (
V4L2_CID_MPEG_BASE
+354)

	)

1408 
	#V4L2_CID_MPEG_VIDEO_H264_8X8_TRANSFORM
 (
V4L2_CID_MPEG_BASE
+355)

	)

1409 
	#V4L2_CID_MPEG_VIDEO_H264_CPB_SIZE
 (
V4L2_CID_MPEG_BASE
+356)

	)

1410 
	#V4L2_CID_MPEG_VIDEO_H264_ENTROPY_MODE
 (
V4L2_CID_MPEG_BASE
+357)

	)

1411 
	ev4l2_m³g_video_h264_’Œİy_mode
 {

1412 
	mV4L2_MPEG_VIDEO_H264_ENTROPY_MODE_CAVLC
 = 0,

1413 
	mV4L2_MPEG_VIDEO_H264_ENTROPY_MODE_CABAC
 = 1,

1415 
	#V4L2_CID_MPEG_VIDEO_H264_I_PERIOD
 (
V4L2_CID_MPEG_BASE
+358)

	)

1416 
	#V4L2_CID_MPEG_VIDEO_H264_LEVEL
 (
V4L2_CID_MPEG_BASE
+359)

	)

1417 
	ev4l2_m³g_video_h264_Ëv–
 {

1418 
	mV4L2_MPEG_VIDEO_H264_LEVEL_1_0
 = 0,

1419 
	mV4L2_MPEG_VIDEO_H264_LEVEL_1B
 = 1,

1420 
	mV4L2_MPEG_VIDEO_H264_LEVEL_1_1
 = 2,

1421 
	mV4L2_MPEG_VIDEO_H264_LEVEL_1_2
 = 3,

1422 
	mV4L2_MPEG_VIDEO_H264_LEVEL_1_3
 = 4,

1423 
	mV4L2_MPEG_VIDEO_H264_LEVEL_2_0
 = 5,

1424 
	mV4L2_MPEG_VIDEO_H264_LEVEL_2_1
 = 6,

1425 
	mV4L2_MPEG_VIDEO_H264_LEVEL_2_2
 = 7,

1426 
	mV4L2_MPEG_VIDEO_H264_LEVEL_3_0
 = 8,

1427 
	mV4L2_MPEG_VIDEO_H264_LEVEL_3_1
 = 9,

1428 
	mV4L2_MPEG_VIDEO_H264_LEVEL_3_2
 = 10,

1429 
	mV4L2_MPEG_VIDEO_H264_LEVEL_4_0
 = 11,

1430 
	mV4L2_MPEG_VIDEO_H264_LEVEL_4_1
 = 12,

1431 
	mV4L2_MPEG_VIDEO_H264_LEVEL_4_2
 = 13,

1432 
	mV4L2_MPEG_VIDEO_H264_LEVEL_5_0
 = 14,

1433 
	mV4L2_MPEG_VIDEO_H264_LEVEL_5_1
 = 15,

1435 
	#V4L2_CID_MPEG_VIDEO_H264_LOOP_FILTER_ALPHA
 (
V4L2_CID_MPEG_BASE
+360)

	)

1436 
	#V4L2_CID_MPEG_VIDEO_H264_LOOP_FILTER_BETA
 (
V4L2_CID_MPEG_BASE
+361)

	)

1437 
	#V4L2_CID_MPEG_VIDEO_H264_LOOP_FILTER_MODE
 (
V4L2_CID_MPEG_BASE
+362)

	)

1438 
	ev4l2_m³g_video_h264_loİ_f‹r_mode
 {

1439 
	mV4L2_MPEG_VIDEO_H264_LOOP_FILTER_MODE_ENABLED
 = 0,

1440 
	mV4L2_MPEG_VIDEO_H264_LOOP_FILTER_MODE_DISABLED
 = 1,

1441 
	mV4L2_MPEG_VIDEO_H264_LOOP_FILTER_MODE_DISABLED_AT_SLICE_BOUNDARY
 = 2,

1443 
	#V4L2_CID_MPEG_VIDEO_H264_PROFILE
 (
V4L2_CID_MPEG_BASE
+363)

	)

1444 
	ev4l2_m³g_video_h264_´ofe
 {

1445 
	mV4L2_MPEG_VIDEO_H264_PROFILE_BASELINE
 = 0,

1446 
	mV4L2_MPEG_VIDEO_H264_PROFILE_CONSTRAINED_BASELINE
 = 1,

1447 
	mV4L2_MPEG_VIDEO_H264_PROFILE_MAIN
 = 2,

1448 
	mV4L2_MPEG_VIDEO_H264_PROFILE_EXTENDED
 = 3,

1449 
	mV4L2_MPEG_VIDEO_H264_PROFILE_HIGH
 = 4,

1450 
	mV4L2_MPEG_VIDEO_H264_PROFILE_HIGH_10
 = 5,

1451 
	mV4L2_MPEG_VIDEO_H264_PROFILE_HIGH_422
 = 6,

1452 
	mV4L2_MPEG_VIDEO_H264_PROFILE_HIGH_444_PREDICTIVE
 = 7,

1453 
	mV4L2_MPEG_VIDEO_H264_PROFILE_HIGH_10_INTRA
 = 8,

1454 
	mV4L2_MPEG_VIDEO_H264_PROFILE_HIGH_422_INTRA
 = 9,

1455 
	mV4L2_MPEG_VIDEO_H264_PROFILE_HIGH_444_INTRA
 = 10,

1456 
	mV4L2_MPEG_VIDEO_H264_PROFILE_CAVLC_444_INTRA
 = 11,

1457 
	mV4L2_MPEG_VIDEO_H264_PROFILE_SCALABLE_BASELINE
 = 12,

1458 
	mV4L2_MPEG_VIDEO_H264_PROFILE_SCALABLE_HIGH
 = 13,

1459 
	mV4L2_MPEG_VIDEO_H264_PROFILE_SCALABLE_HIGH_INTRA
 = 14,

1460 
	mV4L2_MPEG_VIDEO_H264_PROFILE_STEREO_HIGH
 = 15,

1461 
	mV4L2_MPEG_VIDEO_H264_PROFILE_MULTIVIEW_HIGH
 = 16,

1463 
	#V4L2_CID_MPEG_VIDEO_H264_VUI_EXT_SAR_HEIGHT
 (
V4L2_CID_MPEG_BASE
+364)

	)

1464 
	#V4L2_CID_MPEG_VIDEO_H264_VUI_EXT_SAR_WIDTH
 (
V4L2_CID_MPEG_BASE
+365)

	)

1465 
	#V4L2_CID_MPEG_VIDEO_H264_VUI_SAR_ENABLE
 (
V4L2_CID_MPEG_BASE
+366)

	)

1466 
	#V4L2_CID_MPEG_VIDEO_H264_VUI_SAR_IDC
 (
V4L2_CID_MPEG_BASE
+367)

	)

1467 
	ev4l2_m³g_video_h264_vui_§r_idc
 {

1468 
	mV4L2_MPEG_VIDEO_H264_VUI_SAR_IDC_UNSPECIFIED
 = 0,

1469 
	mV4L2_MPEG_VIDEO_H264_VUI_SAR_IDC_1x1
 = 1,

1470 
	mV4L2_MPEG_VIDEO_H264_VUI_SAR_IDC_12x11
 = 2,

1471 
	mV4L2_MPEG_VIDEO_H264_VUI_SAR_IDC_10x11
 = 3,

1472 
	mV4L2_MPEG_VIDEO_H264_VUI_SAR_IDC_16x11
 = 4,

1473 
	mV4L2_MPEG_VIDEO_H264_VUI_SAR_IDC_40x33
 = 5,

1474 
	mV4L2_MPEG_VIDEO_H264_VUI_SAR_IDC_24x11
 = 6,

1475 
	mV4L2_MPEG_VIDEO_H264_VUI_SAR_IDC_20x11
 = 7,

1476 
	mV4L2_MPEG_VIDEO_H264_VUI_SAR_IDC_32x11
 = 8,

1477 
	mV4L2_MPEG_VIDEO_H264_VUI_SAR_IDC_80x33
 = 9,

1478 
	mV4L2_MPEG_VIDEO_H264_VUI_SAR_IDC_18x11
 = 10,

1479 
	mV4L2_MPEG_VIDEO_H264_VUI_SAR_IDC_15x11
 = 11,

1480 
	mV4L2_MPEG_VIDEO_H264_VUI_SAR_IDC_64x33
 = 12,

1481 
	mV4L2_MPEG_VIDEO_H264_VUI_SAR_IDC_160x99
 = 13,

1482 
	mV4L2_MPEG_VIDEO_H264_VUI_SAR_IDC_4x3
 = 14,

1483 
	mV4L2_MPEG_VIDEO_H264_VUI_SAR_IDC_3x2
 = 15,

1484 
	mV4L2_MPEG_VIDEO_H264_VUI_SAR_IDC_2x1
 = 16,

1485 
	mV4L2_MPEG_VIDEO_H264_VUI_SAR_IDC_EXTENDED
 = 17,

1487 
	#V4L2_CID_MPEG_VIDEO_MPEG4_I_FRAME_QP
 (
V4L2_CID_MPEG_BASE
+400)

	)

1488 
	#V4L2_CID_MPEG_VIDEO_MPEG4_P_FRAME_QP
 (
V4L2_CID_MPEG_BASE
+401)

	)

1489 
	#V4L2_CID_MPEG_VIDEO_MPEG4_B_FRAME_QP
 (
V4L2_CID_MPEG_BASE
+402)

	)

1490 
	#V4L2_CID_MPEG_VIDEO_MPEG4_MIN_QP
 (
V4L2_CID_MPEG_BASE
+403)

	)

1491 
	#V4L2_CID_MPEG_VIDEO_MPEG4_MAX_QP
 (
V4L2_CID_MPEG_BASE
+404)

	)

1492 
	#V4L2_CID_MPEG_VIDEO_MPEG4_LEVEL
 (
V4L2_CID_MPEG_BASE
+405)

	)

1493 
	ev4l2_m³g_video_m³g4_Ëv–
 {

1494 
	mV4L2_MPEG_VIDEO_MPEG4_LEVEL_0
 = 0,

1495 
	mV4L2_MPEG_VIDEO_MPEG4_LEVEL_0B
 = 1,

1496 
	mV4L2_MPEG_VIDEO_MPEG4_LEVEL_1
 = 2,

1497 
	mV4L2_MPEG_VIDEO_MPEG4_LEVEL_2
 = 3,

1498 
	mV4L2_MPEG_VIDEO_MPEG4_LEVEL_3
 = 4,

1499 
	mV4L2_MPEG_VIDEO_MPEG4_LEVEL_3B
 = 5,

1500 
	mV4L2_MPEG_VIDEO_MPEG4_LEVEL_4
 = 6,

1501 
	mV4L2_MPEG_VIDEO_MPEG4_LEVEL_5
 = 7,

1503 
	#V4L2_CID_MPEG_VIDEO_MPEG4_PROFILE
 (
V4L2_CID_MPEG_BASE
+406)

	)

1504 
	ev4l2_m³g_video_m³g4_´ofe
 {

1505 
	mV4L2_MPEG_VIDEO_MPEG4_PROFILE_SIMPLE
 = 0,

1506 
	mV4L2_MPEG_VIDEO_MPEG4_PROFILE_ADVANCED_SIMPLE
 = 1,

1507 
	mV4L2_MPEG_VIDEO_MPEG4_PROFILE_CORE
 = 2,

1508 
	mV4L2_MPEG_VIDEO_MPEG4_PROFILE_SIMPLE_SCALABLE
 = 3,

1509 
	mV4L2_MPEG_VIDEO_MPEG4_PROFILE_ADVANCED_CODING_EFFICIENCY
 = 4,

1511 
	#V4L2_CID_MPEG_VIDEO_MPEG4_QPEL
 (
V4L2_CID_MPEG_BASE
+407)

	)

1514 
	#V4L2_CID_MPEG_CX2341X_BASE
 (
V4L2_CTRL_CLASS_MPEG
 | 0x1000)

	)

1515 
	#V4L2_CID_MPEG_CX2341X_VIDEO_SPATIAL_FILTER_MODE
 (
V4L2_CID_MPEG_CX2341X_BASE
+0)

	)

1516 
	ev4l2_m³g_cx2341x_video_¥©Ÿl_f‹r_mode
 {

1517 
	mV4L2_MPEG_CX2341X_VIDEO_SPATIAL_FILTER_MODE_MANUAL
 = 0,

1518 
	mV4L2_MPEG_CX2341X_VIDEO_SPATIAL_FILTER_MODE_AUTO
 = 1,

1520 
	#V4L2_CID_MPEG_CX2341X_VIDEO_SPATIAL_FILTER
 (
V4L2_CID_MPEG_CX2341X_BASE
+1)

	)

1521 
	#V4L2_CID_MPEG_CX2341X_VIDEO_LUMA_SPATIAL_FILTER_TYPE
 (
V4L2_CID_MPEG_CX2341X_BASE
+2)

	)

1522 
	ev4l2_m³g_cx2341x_video_luma_¥©Ÿl_f‹r_ty³
 {

1523 
	mV4L2_MPEG_CX2341X_VIDEO_LUMA_SPATIAL_FILTER_TYPE_OFF
 = 0,

1524 
	mV4L2_MPEG_CX2341X_VIDEO_LUMA_SPATIAL_FILTER_TYPE_1D_HOR
 = 1,

1525 
	mV4L2_MPEG_CX2341X_VIDEO_LUMA_SPATIAL_FILTER_TYPE_1D_VERT
 = 2,

1526 
	mV4L2_MPEG_CX2341X_VIDEO_LUMA_SPATIAL_FILTER_TYPE_2D_HV_SEPARABLE
 = 3,

1527 
	mV4L2_MPEG_CX2341X_VIDEO_LUMA_SPATIAL_FILTER_TYPE_2D_SYM_NON_SEPARABLE
 = 4,

1529 
	#V4L2_CID_MPEG_CX2341X_VIDEO_CHROMA_SPATIAL_FILTER_TYPE
 (
V4L2_CID_MPEG_CX2341X_BASE
+3)

	)

1530 
	ev4l2_m³g_cx2341x_video_chroma_¥©Ÿl_f‹r_ty³
 {

1531 
	mV4L2_MPEG_CX2341X_VIDEO_CHROMA_SPATIAL_FILTER_TYPE_OFF
 = 0,

1532 
	mV4L2_MPEG_CX2341X_VIDEO_CHROMA_SPATIAL_FILTER_TYPE_1D_HOR
 = 1,

1534 
	#V4L2_CID_MPEG_CX2341X_VIDEO_TEMPORAL_FILTER_MODE
 (
V4L2_CID_MPEG_CX2341X_BASE
+4)

	)

1535 
	ev4l2_m³g_cx2341x_video_‹mpÜ®_f‹r_mode
 {

1536 
	mV4L2_MPEG_CX2341X_VIDEO_TEMPORAL_FILTER_MODE_MANUAL
 = 0,

1537 
	mV4L2_MPEG_CX2341X_VIDEO_TEMPORAL_FILTER_MODE_AUTO
 = 1,

1539 
	#V4L2_CID_MPEG_CX2341X_VIDEO_TEMPORAL_FILTER
 (
V4L2_CID_MPEG_CX2341X_BASE
+5)

	)

1540 
	#V4L2_CID_MPEG_CX2341X_VIDEO_MEDIAN_FILTER_TYPE
 (
V4L2_CID_MPEG_CX2341X_BASE
+6)

	)

1541 
	ev4l2_m³g_cx2341x_video_medŸn_f‹r_ty³
 {

1542 
	mV4L2_MPEG_CX2341X_VIDEO_MEDIAN_FILTER_TYPE_OFF
 = 0,

1543 
	mV4L2_MPEG_CX2341X_VIDEO_MEDIAN_FILTER_TYPE_HOR
 = 1,

1544 
	mV4L2_MPEG_CX2341X_VIDEO_MEDIAN_FILTER_TYPE_VERT
 = 2,

1545 
	mV4L2_MPEG_CX2341X_VIDEO_MEDIAN_FILTER_TYPE_HOR_VERT
 = 3,

1546 
	mV4L2_MPEG_CX2341X_VIDEO_MEDIAN_FILTER_TYPE_DIAG
 = 4,

1548 
	#V4L2_CID_MPEG_CX2341X_VIDEO_LUMA_MEDIAN_FILTER_BOTTOM
 (
V4L2_CID_MPEG_CX2341X_BASE
+7)

	)

1549 
	#V4L2_CID_MPEG_CX2341X_VIDEO_LUMA_MEDIAN_FILTER_TOP
 (
V4L2_CID_MPEG_CX2341X_BASE
+8)

	)

1550 
	#V4L2_CID_MPEG_CX2341X_VIDEO_CHROMA_MEDIAN_FILTER_BOTTOM
 (
V4L2_CID_MPEG_CX2341X_BASE
+9)

	)

1551 
	#V4L2_CID_MPEG_CX2341X_VIDEO_CHROMA_MEDIAN_FILTER_TOP
 (
V4L2_CID_MPEG_CX2341X_BASE
+10)

	)

1552 
	#V4L2_CID_MPEG_CX2341X_STREAM_INSERT_NAV_PACKETS
 (
V4L2_CID_MPEG_CX2341X_BASE
+11)

	)

1555 
	#V4L2_CID_MPEG_MFC51_BASE
 (
V4L2_CTRL_CLASS_MPEG
 | 0x1100)

	)

1557 
	#V4L2_CID_MPEG_MFC51_VIDEO_DECODER_H264_DISPLAY_DELAY
 (
V4L2_CID_MPEG_MFC51_BASE
+0)

	)

1558 
	#V4L2_CID_MPEG_MFC51_VIDEO_DECODER_H264_DISPLAY_DELAY_ENABLE
 (
V4L2_CID_MPEG_MFC51_BASE
+1)

	)

1559 
	#V4L2_CID_MPEG_MFC51_VIDEO_FRAME_SKIP_MODE
 (
V4L2_CID_MPEG_MFC51_BASE
+2)

	)

1560 
	ev4l2_m³g_mfc51_video_äame_sk_mode
 {

1561 
	mV4L2_MPEG_MFC51_VIDEO_FRAME_SKIP_MODE_DISABLED
 = 0,

1562 
	mV4L2_MPEG_MFC51_VIDEO_FRAME_SKIP_MODE_LEVEL_LIMIT
 = 1,

1563 
	mV4L2_MPEG_MFC51_VIDEO_FRAME_SKIP_MODE_BUF_LIMIT
 = 2,

1565 
	#V4L2_CID_MPEG_MFC51_VIDEO_FORCE_FRAME_TYPE
 (
V4L2_CID_MPEG_MFC51_BASE
+3)

	)

1566 
	ev4l2_m³g_mfc51_video_fÜû_äame_ty³
 {

1567 
	mV4L2_MPEG_MFC51_VIDEO_FORCE_FRAME_TYPE_DISABLED
 = 0,

1568 
	mV4L2_MPEG_MFC51_VIDEO_FORCE_FRAME_TYPE_I_FRAME
 = 1,

1569 
	mV4L2_MPEG_MFC51_VIDEO_FORCE_FRAME_TYPE_NOT_CODED
 = 2,

1571 
	#V4L2_CID_MPEG_MFC51_VIDEO_PADDING
 (
V4L2_CID_MPEG_MFC51_BASE
+4)

	)

1572 
	#V4L2_CID_MPEG_MFC51_VIDEO_PADDING_YUV
 (
V4L2_CID_MPEG_MFC51_BASE
+5)

	)

1573 
	#V4L2_CID_MPEG_MFC51_VIDEO_RC_FIXED_TARGET_BIT
 (
V4L2_CID_MPEG_MFC51_BASE
+6)

	)

1574 
	#V4L2_CID_MPEG_MFC51_VIDEO_RC_REACTION_COEFF
 (
V4L2_CID_MPEG_MFC51_BASE
+7)

	)

1575 
	#V4L2_CID_MPEG_MFC51_VIDEO_H264_ADAPTIVE_RC_ACTIVITY
 (
V4L2_CID_MPEG_MFC51_BASE
+50)

	)

1576 
	#V4L2_CID_MPEG_MFC51_VIDEO_H264_ADAPTIVE_RC_DARK
 (
V4L2_CID_MPEG_MFC51_BASE
+51)

	)

1577 
	#V4L2_CID_MPEG_MFC51_VIDEO_H264_ADAPTIVE_RC_SMOOTH
 (
V4L2_CID_MPEG_MFC51_BASE
+52)

	)

1578 
	#V4L2_CID_MPEG_MFC51_VIDEO_H264_ADAPTIVE_RC_STATIC
 (
V4L2_CID_MPEG_MFC51_BASE
+53)

	)

1579 
	#V4L2_CID_MPEG_MFC51_VIDEO_H264_NUM_REF_PIC_FOR_P
 (
V4L2_CID_MPEG_MFC51_BASE
+54)

	)

1582 
	#V4L2_CID_CAMERA_CLASS_BASE
 (
V4L2_CTRL_CLASS_CAMERA
 | 0x900)

	)

1583 
	#V4L2_CID_CAMERA_CLASS
 (
V4L2_CTRL_CLASS_CAMERA
 | 1)

	)

1585 
	#V4L2_CID_EXPOSURE_AUTO
 (
V4L2_CID_CAMERA_CLASS_BASE
+1)

	)

1586 
	ev4l2_exposu»_auto_ty³
 {

1587 
	mV4L2_EXPOSURE_AUTO
 = 0,

1588 
	mV4L2_EXPOSURE_MANUAL
 = 1,

1589 
	mV4L2_EXPOSURE_SHUTTER_PRIORITY
 = 2,

1590 
	mV4L2_EXPOSURE_APERTURE_PRIORITY
 = 3

1592 
	#V4L2_CID_EXPOSURE_ABSOLUTE
 (
V4L2_CID_CAMERA_CLASS_BASE
+2)

	)

1593 
	#V4L2_CID_EXPOSURE_AUTO_PRIORITY
 (
V4L2_CID_CAMERA_CLASS_BASE
+3)

	)

1595 
	#V4L2_CID_PAN_RELATIVE
 (
V4L2_CID_CAMERA_CLASS_BASE
+4)

	)

1596 
	#V4L2_CID_TILT_RELATIVE
 (
V4L2_CID_CAMERA_CLASS_BASE
+5)

	)

1597 
	#V4L2_CID_PAN_RESET
 (
V4L2_CID_CAMERA_CLASS_BASE
+6)

	)

1598 
	#V4L2_CID_TILT_RESET
 (
V4L2_CID_CAMERA_CLASS_BASE
+7)

	)

1600 
	#V4L2_CID_PAN_ABSOLUTE
 (
V4L2_CID_CAMERA_CLASS_BASE
+8)

	)

1601 
	#V4L2_CID_TILT_ABSOLUTE
 (
V4L2_CID_CAMERA_CLASS_BASE
+9)

	)

1603 
	#V4L2_CID_FOCUS_ABSOLUTE
 (
V4L2_CID_CAMERA_CLASS_BASE
+10)

	)

1604 
	#V4L2_CID_FOCUS_RELATIVE
 (
V4L2_CID_CAMERA_CLASS_BASE
+11)

	)

1605 
	#V4L2_CID_FOCUS_AUTO
 (
V4L2_CID_CAMERA_CLASS_BASE
+12)

	)

1607 
	#V4L2_CID_ZOOM_ABSOLUTE
 (
V4L2_CID_CAMERA_CLASS_BASE
+13)

	)

1608 
	#V4L2_CID_ZOOM_RELATIVE
 (
V4L2_CID_CAMERA_CLASS_BASE
+14)

	)

1609 
	#V4L2_CID_ZOOM_CONTINUOUS
 (
V4L2_CID_CAMERA_CLASS_BASE
+15)

	)

1611 
	#V4L2_CID_PRIVACY
 (
V4L2_CID_CAMERA_CLASS_BASE
+16)

	)

1613 
	#V4L2_CID_IRIS_ABSOLUTE
 (
V4L2_CID_CAMERA_CLASS_BASE
+17)

	)

1614 
	#V4L2_CID_IRIS_RELATIVE
 (
V4L2_CID_CAMERA_CLASS_BASE
+18)

	)

1617 
	#V4L2_CID_FM_TX_CLASS_BASE
 (
V4L2_CTRL_CLASS_FM_TX
 | 0x900)

	)

1618 
	#V4L2_CID_FM_TX_CLASS
 (
V4L2_CTRL_CLASS_FM_TX
 | 1)

	)

1620 
	#V4L2_CID_RDS_TX_DEVIATION
 (
V4L2_CID_FM_TX_CLASS_BASE
 + 1)

	)

1621 
	#V4L2_CID_RDS_TX_PI
 (
V4L2_CID_FM_TX_CLASS_BASE
 + 2)

	)

1622 
	#V4L2_CID_RDS_TX_PTY
 (
V4L2_CID_FM_TX_CLASS_BASE
 + 3)

	)

1623 
	#V4L2_CID_RDS_TX_PS_NAME
 (
V4L2_CID_FM_TX_CLASS_BASE
 + 5)

	)

1624 
	#V4L2_CID_RDS_TX_RADIO_TEXT
 (
V4L2_CID_FM_TX_CLASS_BASE
 + 6)

	)

1626 
	#V4L2_CID_AUDIO_LIMITER_ENABLED
 (
V4L2_CID_FM_TX_CLASS_BASE
 + 64)

	)

1627 
	#V4L2_CID_AUDIO_LIMITER_RELEASE_TIME
 (
V4L2_CID_FM_TX_CLASS_BASE
 + 65)

	)

1628 
	#V4L2_CID_AUDIO_LIMITER_DEVIATION
 (
V4L2_CID_FM_TX_CLASS_BASE
 + 66)

	)

1630 
	#V4L2_CID_AUDIO_COMPRESSION_ENABLED
 (
V4L2_CID_FM_TX_CLASS_BASE
 + 80)

	)

1631 
	#V4L2_CID_AUDIO_COMPRESSION_GAIN
 (
V4L2_CID_FM_TX_CLASS_BASE
 + 81)

	)

1632 
	#V4L2_CID_AUDIO_COMPRESSION_THRESHOLD
 (
V4L2_CID_FM_TX_CLASS_BASE
 + 82)

	)

1633 
	#V4L2_CID_AUDIO_COMPRESSION_ATTACK_TIME
 (
V4L2_CID_FM_TX_CLASS_BASE
 + 83)

	)

1634 
	#V4L2_CID_AUDIO_COMPRESSION_RELEASE_TIME
 (
V4L2_CID_FM_TX_CLASS_BASE
 + 84)

	)

1636 
	#V4L2_CID_PILOT_TONE_ENABLED
 (
V4L2_CID_FM_TX_CLASS_BASE
 + 96)

	)

1637 
	#V4L2_CID_PILOT_TONE_DEVIATION
 (
V4L2_CID_FM_TX_CLASS_BASE
 + 97)

	)

1638 
	#V4L2_CID_PILOT_TONE_FREQUENCY
 (
V4L2_CID_FM_TX_CLASS_BASE
 + 98)

	)

1640 
	#V4L2_CID_TUNE_PREEMPHASIS
 (
V4L2_CID_FM_TX_CLASS_BASE
 + 112)

	)

1641 
	ev4l2_´“mphasis
 {

1642 
	mV4L2_PREEMPHASIS_DISABLED
 = 0,

1643 
	mV4L2_PREEMPHASIS_50_uS
 = 1,

1644 
	mV4L2_PREEMPHASIS_75_uS
 = 2,

1646 
	#V4L2_CID_TUNE_POWER_LEVEL
 (
V4L2_CID_FM_TX_CLASS_BASE
 + 113)

	)

1647 
	#V4L2_CID_TUNE_ANTENNA_CAPACITOR
 (
V4L2_CID_FM_TX_CLASS_BASE
 + 114)

	)

1650 
	#V4L2_CID_FLASH_CLASS_BASE
 (
V4L2_CTRL_CLASS_FLASH
 | 0x900)

	)

1651 
	#V4L2_CID_FLASH_CLASS
 (
V4L2_CTRL_CLASS_FLASH
 | 1)

	)

1653 
	#V4L2_CID_FLASH_LED_MODE
 (
V4L2_CID_FLASH_CLASS_BASE
 + 1)

	)

1654 
	ev4l2_æash_Ëd_mode
 {

1655 
	mV4L2_FLASH_LED_MODE_NONE
,

1656 
	mV4L2_FLASH_LED_MODE_FLASH
,

1657 
	mV4L2_FLASH_LED_MODE_TORCH
,

1660 
	#V4L2_CID_FLASH_STROBE_SOURCE
 (
V4L2_CID_FLASH_CLASS_BASE
 + 2)

	)

1661 
	ev4l2_æash_¡robe_sourû
 {

1662 
	mV4L2_FLASH_STROBE_SOURCE_SOFTWARE
,

1663 
	mV4L2_FLASH_STROBE_SOURCE_EXTERNAL
,

1666 
	#V4L2_CID_FLASH_STROBE
 (
V4L2_CID_FLASH_CLASS_BASE
 + 3)

	)

1667 
	#V4L2_CID_FLASH_STROBE_STOP
 (
V4L2_CID_FLASH_CLASS_BASE
 + 4)

	)

1668 
	#V4L2_CID_FLASH_STROBE_STATUS
 (
V4L2_CID_FLASH_CLASS_BASE
 + 5)

	)

1670 
	#V4L2_CID_FLASH_TIMEOUT
 (
V4L2_CID_FLASH_CLASS_BASE
 + 6)

	)

1671 
	#V4L2_CID_FLASH_INTENSITY
 (
V4L2_CID_FLASH_CLASS_BASE
 + 7)

	)

1672 
	#V4L2_CID_FLASH_TORCH_INTENSITY
 (
V4L2_CID_FLASH_CLASS_BASE
 + 8)

	)

1673 
	#V4L2_CID_FLASH_INDICATOR_INTENSITY
 (
V4L2_CID_FLASH_CLASS_BASE
 + 9)

	)

1675 
	#V4L2_CID_FLASH_FAULT
 (
V4L2_CID_FLASH_CLASS_BASE
 + 10)

	)

1676 
	#V4L2_FLASH_FAULT_OVER_VOLTAGE
 (1 << 0)

	)

1677 
	#V4L2_FLASH_FAULT_TIMEOUT
 (1 << 1)

	)

1678 
	#V4L2_FLASH_FAULT_OVER_TEMPERATURE
 (1 << 2)

	)

1679 
	#V4L2_FLASH_FAULT_SHORT_CIRCUIT
 (1 << 3)

	)

1681 
	#V4L2_CID_FLASH_CHARGE
 (
V4L2_CID_FLASH_CLASS_BASE
 + 11)

	)

1682 
	#V4L2_CID_FLASH_READY
 (
V4L2_CID_FLASH_CLASS_BASE
 + 12)

	)

1687 
	sv4l2_tuÃr
 {

1688 
__u32
 
	mšdex
;

1689 
__u8
 
	mÇme
[32];

1690 
v4l2_tuÃr_ty³
 
	mty³
;

1691 
__u32
 
	mÿ·b™y
;

1692 
__u32
 
	m¿ng–ow
;

1693 
__u32
 
	m¿ngehigh
;

1694 
__u32
 
	mrxsubchªs
;

1695 
__u32
 
	maudmode
;

1696 
__s32
 
	msigÇl
;

1697 
__s32
 
	mafc
;

1698 
__u32
 
	m»£rved
[4];

1701 
	sv4l2_moduÏtÜ
 {

1702 
__u32
 
	mšdex
;

1703 
__u8
 
	mÇme
[32];

1704 
__u32
 
	mÿ·b™y
;

1705 
__u32
 
	m¿ng–ow
;

1706 
__u32
 
	m¿ngehigh
;

1707 
__u32
 
	mtxsubchªs
;

1708 
__u32
 
	m»£rved
[4];

1712 
	#V4L2_TUNER_CAP_LOW
 0x0001

	)

1713 
	#V4L2_TUNER_CAP_NORM
 0x0002

	)

1714 
	#V4L2_TUNER_CAP_STEREO
 0x0010

	)

1715 
	#V4L2_TUNER_CAP_LANG2
 0x0020

	)

1716 
	#V4L2_TUNER_CAP_SAP
 0x0020

	)

1717 
	#V4L2_TUNER_CAP_LANG1
 0x0040

	)

1718 
	#V4L2_TUNER_CAP_RDS
 0x0080

	)

1719 
	#V4L2_TUNER_CAP_RDS_BLOCK_IO
 0x0100

	)

1720 
	#V4L2_TUNER_CAP_RDS_CONTROLS
 0x0200

	)

1723 
	#V4L2_TUNER_SUB_MONO
 0x0001

	)

1724 
	#V4L2_TUNER_SUB_STEREO
 0x0002

	)

1725 
	#V4L2_TUNER_SUB_LANG2
 0x0004

	)

1726 
	#V4L2_TUNER_SUB_SAP
 0x0004

	)

1727 
	#V4L2_TUNER_SUB_LANG1
 0x0008

	)

1728 
	#V4L2_TUNER_SUB_RDS
 0x0010

	)

1731 
	#V4L2_TUNER_MODE_MONO
 0x0000

	)

1732 
	#V4L2_TUNER_MODE_STEREO
 0x0001

	)

1733 
	#V4L2_TUNER_MODE_LANG2
 0x0002

	)

1734 
	#V4L2_TUNER_MODE_SAP
 0x0002

	)

1735 
	#V4L2_TUNER_MODE_LANG1
 0x0003

	)

1736 
	#V4L2_TUNER_MODE_LANG1_LANG2
 0x0004

	)

1738 
	sv4l2_äequ’cy
 {

1739 
__u32
 
	mtuÃr
;

1740 
v4l2_tuÃr_ty³
 
	mty³
;

1741 
__u32
 
	mäequ’cy
;

1742 
__u32
 
	m»£rved
[8];

1745 
	sv4l2_hw_äeq_£ek
 {

1746 
__u32
 
	mtuÃr
;

1747 
v4l2_tuÃr_ty³
 
	mty³
;

1748 
__u32
 
	m£ek_upw¬d
;

1749 
__u32
 
	mw¿p_¬ound
;

1750 
__u32
 
	m¥acšg
;

1751 
__u32
 
	m»£rved
[7];

1758 
	sv4l2_rds_d©a
 {

1759 
__u8
 
	mlsb
;

1760 
__u8
 
	mmsb
;

1761 
__u8
 
	mblock
;

1762 } 
__©Œibu‹__
 ((
·cked
));

1764 
	#V4L2_RDS_BLOCK_MSK
 0x7

	)

1765 
	#V4L2_RDS_BLOCK_A
 0

	)

1766 
	#V4L2_RDS_BLOCK_B
 1

	)

1767 
	#V4L2_RDS_BLOCK_C
 2

	)

1768 
	#V4L2_RDS_BLOCK_D
 3

	)

1769 
	#V4L2_RDS_BLOCK_C_ALT
 4

	)

1770 
	#V4L2_RDS_BLOCK_INVALID
 7

	)

1772 
	#V4L2_RDS_BLOCK_CORRECTED
 0x40

	)

1773 
	#V4L2_RDS_BLOCK_ERROR
 0x80

	)

1778 
	sv4l2_audio
 {

1779 
__u32
 
	mšdex
;

1780 
__u8
 
	mÇme
[32];

1781 
__u32
 
	mÿ·b™y
;

1782 
__u32
 
	mmode
;

1783 
__u32
 
	m»£rved
[2];

1787 
	#V4L2_AUDCAP_STEREO
 0x00001

	)

1788 
	#V4L2_AUDCAP_AVL
 0x00002

	)

1791 
	#V4L2_AUDMODE_AVL
 0x00001

	)

1793 
	sv4l2_audioout
 {

1794 
__u32
 
	mšdex
;

1795 
__u8
 
	mÇme
[32];

1796 
__u32
 
	mÿ·b™y
;

1797 
__u32
 
	mmode
;

1798 
__u32
 
	m»£rved
[2];

1807 
	#V4L2_ENC_IDX_FRAME_I
 (0)

	)

1808 
	#V4L2_ENC_IDX_FRAME_P
 (1)

	)

1809 
	#V4L2_ENC_IDX_FRAME_B
 (2)

	)

1810 
	#V4L2_ENC_IDX_FRAME_MASK
 (0xf)

	)

1812 
	sv4l2_’c_idx_’Œy
 {

1813 
__u64
 
	moff£t
;

1814 
__u64
 
	m±s
;

1815 
__u32
 
	mËngth
;

1816 
__u32
 
	mæags
;

1817 
__u32
 
	m»£rved
[2];

1820 
	#V4L2_ENC_IDX_ENTRIES
 (64)

	)

1821 
	sv4l2_’c_idx
 {

1822 
__u32
 
	m’Œ›s
;

1823 
__u32
 
	m’Œ›s_ÿp
;

1824 
__u32
 
	m»£rved
[4];

1825 
v4l2_’c_idx_’Œy
 
	m’Œy
[
V4L2_ENC_IDX_ENTRIES
];

1829 
	#V4L2_ENC_CMD_START
 (0)

	)

1830 
	#V4L2_ENC_CMD_STOP
 (1)

	)

1831 
	#V4L2_ENC_CMD_PAUSE
 (2)

	)

1832 
	#V4L2_ENC_CMD_RESUME
 (3)

	)

1835 
	#V4L2_ENC_CMD_STOP_AT_GOP_END
 (1 << 0)

	)

1837 
	sv4l2_’cod”_cmd
 {

1838 
__u32
 
	mcmd
;

1839 
__u32
 
	mæags
;

1842 
__u32
 
	md©a
[8];

1843 } 
	m¿w
;

1857 
	sv4l2_vbi_fÜm©
 {

1858 
__u32
 
	m§m¶šg_¿‹
;

1859 
__u32
 
	moff£t
;

1860 
__u32
 
	m§m¶es_³r_lše
;

1861 
__u32
 
	m§m¶e_fÜm©
;

1862 
__s32
 
	m¡¬t
[2];

1863 
__u32
 
	mcouÁ
[2];

1864 
__u32
 
	mæags
;

1865 
__u32
 
	m»£rved
[2];

1869 
	#V4L2_VBI_UNSYNC
 (1 << 0)

	)

1870 
	#V4L2_VBI_INTERLACED
 (1 << 1)

	)

1879 
	sv4l2_¦iûd_vbi_fÜm©
 {

1880 
__u16
 
	m£rviû_£t
;

1885 
__u16
 
	m£rviû_lšes
[2][24];

1886 
__u32
 
	mio_size
;

1887 
__u32
 
	m»£rved
[2];

1892 
	#V4L2_SLICED_TELETEXT_B
 (0x0001)

	)

1894 
	#V4L2_SLICED_VPS
 (0x0400)

	)

1896 
	#V4L2_SLICED_CAPTION_525
 (0x1000)

	)

1898 
	#V4L2_SLICED_WSS_625
 (0x4000)

	)

1900 
	#V4L2_SLICED_VBI_525
 (
V4L2_SLICED_CAPTION_525
)

	)

1901 
	#V4L2_SLICED_VBI_625
 (
V4L2_SLICED_TELETEXT_B
 | 
V4L2_SLICED_VPS
 | 
V4L2_SLICED_WSS_625
)

	)

1903 
	sv4l2_¦iûd_vbi_ÿp
 {

1904 
__u16
 
	m£rviû_£t
;

1909 
__u16
 
	m£rviû_lšes
[2][24];

1910 
v4l2_buf_ty³
 
	mty³
;

1911 
__u32
 
	m»£rved
[3];

1914 
	sv4l2_¦iûd_vbi_d©a
 {

1915 
__u32
 
	mid
;

1916 
__u32
 
	mf›ld
;

1917 
__u32
 
	mlše
;

1918 
__u32
 
	m»£rved
;

1919 
__u8
 
	md©a
[48];

1939 
	#V4L2_MPEG_VBI_IVTV_TELETEXT_B
 (1)

	)

1940 
	#V4L2_MPEG_VBI_IVTV_CAPTION_525
 (4)

	)

1941 
	#V4L2_MPEG_VBI_IVTV_WSS_625
 (5)

	)

1942 
	#V4L2_MPEG_VBI_IVTV_VPS
 (7)

	)

1944 
	sv4l2_m³g_vbi_™v0_lše
 {

1945 
__u8
 
	mid
;

1946 
__u8
 
	md©a
[42];

1947 } 
__©Œibu‹__
 ((
·cked
));

1949 
	sv4l2_m³g_vbi_™v0
 {

1950 
__Ë32
 
	mlšemask
[2];

1951 
v4l2_m³g_vbi_™v0_lše
 
	mlše
[35];

1952 } 
__©Œibu‹__
 ((
·cked
));

1954 
	sv4l2_m³g_vbi_ITV0
 {

1955 
v4l2_m³g_vbi_™v0_lše
 
	mlše
[36];

1956 } 
__©Œibu‹__
 ((
·cked
));

1958 
	#V4L2_MPEG_VBI_IVTV_MAGIC0
 "™v0"

	)

1959 
	#V4L2_MPEG_VBI_IVTV_MAGIC1
 "ITV0"

	)

1961 
	sv4l2_m³g_vbi_fmt_ivtv
 {

1962 
__u8
 
	mmagic
[4];

1964 
v4l2_m³g_vbi_™v0
 
	m™v0
;

1965 
v4l2_m³g_vbi_ITV0
 
	mITV0
;

1967 } 
__©Œibu‹__
 ((
·cked
));

1980 
	sv4l2_¶ªe_pix_fÜm©
 {

1981 
__u32
 
	msizeimage
;

1982 
__u16
 
	mby‹¥”lše
;

1983 
__u16
 
	m»£rved
[7];

1984 } 
__©Œibu‹__
 ((
·cked
));

1996 
	sv4l2_pix_fÜm©_m¶ªe
 {

1997 
__u32
 
	mwidth
;

1998 
__u32
 
	mheight
;

1999 
__u32
 
	mpix–fÜm©
;

2000 
v4l2_f›ld
 
	mf›ld
;

2001 
v4l2_cŞÜ¥aû
 
	mcŞÜ¥aû
;

2003 
v4l2_¶ªe_pix_fÜm©
 
	m¶ªe_fmt
[
VIDEO_MAX_PLANES
];

2004 
__u8
 
	mnum_¶ªes
;

2005 
__u8
 
	m»£rved
[11];

2006 } 
__©Œibu‹__
 ((
·cked
));

2018 
	sv4l2_fÜm©
 {

2019 
v4l2_buf_ty³
 
	mty³
;

2021 
v4l2_pix_fÜm©
 
	mpix
;

2022 
v4l2_pix_fÜm©_m¶ªe
 
	mpix_mp
;

2023 
v4l2_wšdow
 
	mwš
;

2024 
v4l2_vbi_fÜm©
 
	mvbi
;

2025 
v4l2_¦iûd_vbi_fÜm©
 
	m¦iûd
;

2026 
__u8
 
	m¿w_d©a
[200];

2027 } 
	mfmt
;

2032 
	sv4l2_¡»am·rm
 {

2033 
v4l2_buf_ty³
 
	mty³
;

2035 
v4l2_ÿ±u»·rm
 
	mÿ±u»
;

2036 
v4l2_ouu¬m
 
	mouut
;

2037 
__u8
 
	m¿w_d©a
[200];

2038 } 
	m·rm
;

2045 
	#V4L2_EVENT_ALL
 0

	)

2046 
	#V4L2_EVENT_VSYNC
 1

	)

2047 
	#V4L2_EVENT_EOS
 2

	)

2048 
	#V4L2_EVENT_CTRL
 3

	)

2049 
	#V4L2_EVENT_FRAME_SYNC
 4

	)

2050 
	#V4L2_EVENT_PRIVATE_START
 0x08000000

	)

2053 
	sv4l2_ev’t_vsync
 {

2055 
__u8
 
	mf›ld
;

2056 } 
__©Œibu‹__
 ((
·cked
));

2059 
	#V4L2_EVENT_CTRL_CH_VALUE
 (1 << 0)

	)

2060 
	#V4L2_EVENT_CTRL_CH_FLAGS
 (1 << 1)

	)

2062 
	sv4l2_ev’t_ù¾
 {

2063 
__u32
 
	mchªges
;

2064 
__u32
 
	mty³
;

2066 
__s32
 
	mv®ue
;

2067 
__s64
 
	mv®ue64
;

2069 
__u32
 
	mæags
;

2070 
__s32
 
	mmšimum
;

2071 
__s32
 
	mmaximum
;

2072 
__s32
 
	m¡•
;

2073 
__s32
 
	mdeçuÉ_v®ue
;

2076 
	sv4l2_ev’t_äame_sync
 {

2077 
__u32
 
	mäame_£qu’û
;

2080 
	sv4l2_ev’t
 {

2081 
__u32
 
	mty³
;

2083 
v4l2_ev’t_vsync
 
	mvsync
;

2084 
v4l2_ev’t_ù¾
 
	mù¾
;

2085 
v4l2_ev’t_äame_sync
 
	mäame_sync
;

2086 
__u8
 
	md©a
[64];

2087 } 
	mu
;

2088 
__u32
 
	m³ndšg
;

2089 
__u32
 
	m£qu’û
;

2090 
time¥ec
 
	mtime¡amp
;

2091 
__u32
 
	mid
;

2092 
__u32
 
	m»£rved
[8];

2095 
	#V4L2_EVENT_SUB_FL_SEND_INITIAL
 (1 << 0)

	)

2096 
	#V4L2_EVENT_SUB_FL_ALLOW_FEEDBACK
 (1 << 1)

	)

2098 
	sv4l2_ev’t_subsütiÚ
 {

2099 
__u32
 
	mty³
;

2100 
__u32
 
	mid
;

2101 
__u32
 
	mæags
;

2102 
__u32
 
	m»£rved
[5];

2114 
	#V4L2_CHIP_MATCH_HOST
 0

	)

2115 
	#V4L2_CHIP_MATCH_I2C_DRIVER
 1

	)

2116 
	#V4L2_CHIP_MATCH_I2C_ADDR
 2

	)

2117 
	#V4L2_CHIP_MATCH_AC97
 3

	)

2119 
	sv4l2_dbg_m©ch
 {

2120 
__u32
 
	mty³
;

2122 
__u32
 
	maddr
;

2123 
	mÇme
[32];

2125 } 
__©Œibu‹__
 ((
·cked
));

2127 
	sv4l2_dbg_»gi¡”
 {

2128 
v4l2_dbg_m©ch
 
	mm©ch
;

2129 
__u32
 
	msize
;

2130 
__u64
 
	m»g
;

2131 
__u64
 
	mv®
;

2132 } 
__©Œibu‹__
 ((
·cked
));

2135 
	sv4l2_dbg_ch_id’t
 {

2136 
v4l2_dbg_m©ch
 
	mm©ch
;

2137 
__u32
 
	mid’t
;

2138 
__u32
 
	m»visiÚ
;

2139 } 
__©Œibu‹__
 ((
·cked
));

2150 
	sv4l2_ü—‹_bufãrs
 {

2151 
__u32
 
	mšdex
;

2152 
__u32
 
	mcouÁ
;

2153 
v4l2_memÜy
 
	mmemÜy
;

2154 
v4l2_fÜm©
 
	mfÜm©
;

2155 
__u32
 
	m»£rved
[8];

2162 
	#VIDIOC_QUERYCAP
 
	`_IOR
('V', 0, 
v4l2_ÿ·b™y
)

	)

2163 
	#VIDIOC_RESERVED
 
	`_IO
('V', 1)

	)

2164 
	#VIDIOC_ENUM_FMT
 
	`_IOWR
('V', 2, 
v4l2_fmtdesc
)

	)

2165 
	#VIDIOC_G_FMT
 
	`_IOWR
('V', 4, 
v4l2_fÜm©
)

	)

2166 
	#VIDIOC_S_FMT
 
	`_IOWR
('V', 5, 
v4l2_fÜm©
)

	)

2167 
	#VIDIOC_REQBUFS
 
	`_IOWR
('V', 8, 
v4l2_»que¡bufãrs
)

	)

2168 
	#VIDIOC_QUERYBUF
 
	`_IOWR
('V', 9, 
v4l2_bufãr
)

	)

2169 
	#VIDIOC_G_FBUF
 
	`_IOR
('V', 10, 
v4l2_äamebufãr
)

	)

2170 
	#VIDIOC_S_FBUF
 
	`_IOW
('V', 11, 
v4l2_äamebufãr
)

	)

2171 
	#VIDIOC_OVERLAY
 
	`_IOW
('V', 14, )

	)

2172 
	#VIDIOC_QBUF
 
	`_IOWR
('V', 15, 
v4l2_bufãr
)

	)

2173 
	#VIDIOC_DQBUF
 
	`_IOWR
('V', 17, 
v4l2_bufãr
)

	)

2174 
	#VIDIOC_STREAMON
 
	`_IOW
('V', 18, )

	)

2175 
	#VIDIOC_STREAMOFF
 
	`_IOW
('V', 19, )

	)

2176 
	#VIDIOC_G_PARM
 
	`_IOWR
('V', 21, 
v4l2_¡»am·rm
)

	)

2177 
	#VIDIOC_S_PARM
 
	`_IOWR
('V', 22, 
v4l2_¡»am·rm
)

	)

2178 
	#VIDIOC_G_STD
 
	`_IOR
('V', 23, 
v4l2_¡d_id
)

	)

2179 
	#VIDIOC_S_STD
 
	`_IOW
('V', 24, 
v4l2_¡d_id
)

	)

2180 
	#VIDIOC_ENUMSTD
 
	`_IOWR
('V', 25, 
v4l2_¡ªd¬d
)

	)

2181 
	#VIDIOC_ENUMINPUT
 
	`_IOWR
('V', 26, 
v4l2_šput
)

	)

2182 
	#VIDIOC_G_CTRL
 
	`_IOWR
('V', 27, 
v4l2_cÚŒŞ
)

	)

2183 
	#VIDIOC_S_CTRL
 
	`_IOWR
('V', 28, 
v4l2_cÚŒŞ
)

	)

2184 
	#VIDIOC_G_TUNER
 
	`_IOWR
('V', 29, 
v4l2_tuÃr
)

	)

2185 
	#VIDIOC_S_TUNER
 
	`_IOW
('V', 30, 
v4l2_tuÃr
)

	)

2186 
	#VIDIOC_G_AUDIO
 
	`_IOR
('V', 33, 
v4l2_audio
)

	)

2187 
	#VIDIOC_S_AUDIO
 
	`_IOW
('V', 34, 
v4l2_audio
)

	)

2188 
	#VIDIOC_QUERYCTRL
 
	`_IOWR
('V', 36, 
v4l2_qu”yù¾
)

	)

2189 
	#VIDIOC_QUERYMENU
 
	`_IOWR
('V', 37, 
v4l2_qu”ym’u
)

	)

2190 
	#VIDIOC_G_INPUT
 
	`_IOR
('V', 38, )

	)

2191 
	#VIDIOC_S_INPUT
 
	`_IOWR
('V', 39, )

	)

2192 
	#VIDIOC_G_OUTPUT
 
	`_IOR
('V', 46, )

	)

2193 
	#VIDIOC_S_OUTPUT
 
	`_IOWR
('V', 47, )

	)

2194 
	#VIDIOC_ENUMOUTPUT
 
	`_IOWR
('V', 48, 
v4l2_ouut
)

	)

2195 
	#VIDIOC_G_AUDOUT
 
	`_IOR
('V', 49, 
v4l2_audioout
)

	)

2196 
	#VIDIOC_S_AUDOUT
 
	`_IOW
('V', 50, 
v4l2_audioout
)

	)

2197 
	#VIDIOC_G_MODULATOR
 
	`_IOWR
('V', 54, 
v4l2_moduÏtÜ
)

	)

2198 
	#VIDIOC_S_MODULATOR
 
	`_IOW
('V', 55, 
v4l2_moduÏtÜ
)

	)

2199 
	#VIDIOC_G_FREQUENCY
 
	`_IOWR
('V', 56, 
v4l2_äequ’cy
)

	)

2200 
	#VIDIOC_S_FREQUENCY
 
	`_IOW
('V', 57, 
v4l2_äequ’cy
)

	)

2201 
	#VIDIOC_CROPCAP
 
	`_IOWR
('V', 58, 
v4l2_üİÿp
)

	)

2202 
	#VIDIOC_G_CROP
 
	`_IOWR
('V', 59, 
v4l2_üİ
)

	)

2203 
	#VIDIOC_S_CROP
 
	`_IOW
('V', 60, 
v4l2_üİ
)

	)

2204 
	#VIDIOC_G_JPEGCOMP
 
	`_IOR
('V', 61, 
v4l2_j³gcom´essiÚ
)

	)

2205 
	#VIDIOC_S_JPEGCOMP
 
	`_IOW
('V', 62, 
v4l2_j³gcom´essiÚ
)

	)

2206 
	#VIDIOC_QUERYSTD
 
	`_IOR
('V', 63, 
v4l2_¡d_id
)

	)

2207 
	#VIDIOC_TRY_FMT
 
	`_IOWR
('V', 64, 
v4l2_fÜm©
)

	)

2208 
	#VIDIOC_ENUMAUDIO
 
	`_IOWR
('V', 65, 
v4l2_audio
)

	)

2209 
	#VIDIOC_ENUMAUDOUT
 
	`_IOWR
('V', 66, 
v4l2_audioout
)

	)

2210 
	#VIDIOC_G_PRIORITY
 
	`_IOR
('V', 67, 
v4l2_´iÜ™y
)

	)

2211 
	#VIDIOC_S_PRIORITY
 
	`_IOW
('V', 68, 
v4l2_´iÜ™y
)

	)

2212 
	#VIDIOC_G_SLICED_VBI_CAP
 
	`_IOWR
('V', 69, 
v4l2_¦iûd_vbi_ÿp
)

	)

2213 
	#VIDIOC_LOG_STATUS
 
	`_IO
('V', 70)

	)

2214 
	#VIDIOC_G_EXT_CTRLS
 
	`_IOWR
('V', 71, 
v4l2_ext_cÚŒŞs
)

	)

2215 
	#VIDIOC_S_EXT_CTRLS
 
	`_IOWR
('V', 72, 
v4l2_ext_cÚŒŞs
)

	)

2216 
	#VIDIOC_TRY_EXT_CTRLS
 
	`_IOWR
('V', 73, 
v4l2_ext_cÚŒŞs
)

	)

2218 
	#VIDIOC_ENUM_FRAMESIZES
 
	`_IOWR
('V', 74, 
v4l2_ämsiz“num
)

	)

2219 
	#VIDIOC_ENUM_FRAMEINTERVALS
 
	`_IOWR
('V', 75, 
v4l2_ämiv®’um
)

	)

2220 
	#VIDIOC_G_ENC_INDEX
 
	`_IOR
('V', 76, 
v4l2_’c_idx
)

	)

2221 
	#VIDIOC_ENCODER_CMD
 
	`_IOWR
('V', 77, 
v4l2_’cod”_cmd
)

	)

2222 
	#VIDIOC_TRY_ENCODER_CMD
 
	`_IOWR
('V', 78, 
v4l2_’cod”_cmd
)

	)

2229 
	#VIDIOC_DBG_S_REGISTER
 
	`_IOW
('V', 79, 
v4l2_dbg_»gi¡”
)

	)

2230 
	#VIDIOC_DBG_G_REGISTER
 
	`_IOWR
('V', 80, 
v4l2_dbg_»gi¡”
)

	)

2234 
	#VIDIOC_DBG_G_CHIP_IDENT
 
	`_IOWR
('V', 81, 
v4l2_dbg_ch_id’t
)

	)

2237 
	#VIDIOC_S_HW_FREQ_SEEK
 
	`_IOW
('V', 82, 
v4l2_hw_äeq_£ek
)

	)

2238 
	#VIDIOC_ENUM_DV_PRESETS
 
	`_IOWR
('V', 83, 
v4l2_dv_’um_´e£t
)

	)

2239 
	#VIDIOC_S_DV_PRESET
 
	`_IOWR
('V', 84, 
v4l2_dv_´e£t
)

	)

2240 
	#VIDIOC_G_DV_PRESET
 
	`_IOWR
('V', 85, 
v4l2_dv_´e£t
)

	)

2241 
	#VIDIOC_QUERY_DV_PRESET
 
	`_IOR
('V', 86, 
v4l2_dv_´e£t
)

	)

2242 
	#VIDIOC_S_DV_TIMINGS
 
	`_IOWR
('V', 87, 
v4l2_dv_timšgs
)

	)

2243 
	#VIDIOC_G_DV_TIMINGS
 
	`_IOWR
('V', 88, 
v4l2_dv_timšgs
)

	)

2244 
	#VIDIOC_DQEVENT
 
	`_IOR
('V', 89, 
v4l2_ev’t
)

	)

2245 
	#VIDIOC_SUBSCRIBE_EVENT
 
	`_IOW
('V', 90, 
v4l2_ev’t_subsütiÚ
)

	)

2246 
	#VIDIOC_UNSUBSCRIBE_EVENT
 
	`_IOW
('V', 91, 
v4l2_ev’t_subsütiÚ
)

	)

2250 
	#VIDIOC_CREATE_BUFS
 
	`_IOWR
('V', 92, 
v4l2_ü—‹_bufãrs
)

	)

2251 
	#VIDIOC_PREPARE_BUF
 
	`_IOWR
('V', 93, 
v4l2_bufãr
)

	)

2256 
	#BASE_VIDIOC_PRIVATE
 192

	)

	@/usr/include/linux/vt.h

1 #iâdeà
_LINUX_VT_H


2 
	#_LINUX_VT_H


	)

9 
	#MIN_NR_CONSOLES
 1

	)

10 
	#MAX_NR_CONSOLES
 63

	)

11 
	#MAX_NR_USER_CONSOLES
 63

	)

17 
	#VT_OPENQRY
 0x5600

	)

19 
	svt_mode
 {

20 
	mmode
;

21 
	mwa™v
;

22 
	m»lsig
;

23 
	macqsig
;

24 
	mäsig
;

26 
	#VT_GETMODE
 0x5601

	)

27 
	#VT_SETMODE
 0x5602

	)

28 
	#VT_AUTO
 0x00

	)

29 
	#VT_PROCESS
 0x01

	)

30 
	#VT_ACKACQ
 0x02

	)

32 
	svt_¡©
 {

33 
	mv_aùive
;

34 
	mv_sigÇl
;

35 
	mv_¡©e
;

37 
	#VT_GETSTATE
 0x5603

	)

38 
	#VT_SENDSIG
 0x5604

	)

40 
	#VT_RELDISP
 0x5605

	)

42 
	#VT_ACTIVATE
 0x5606

	)

43 
	#VT_WAITACTIVE
 0x5607

	)

44 
	#VT_DISALLOCATE
 0x5608

	)

46 
	svt_sizes
 {

47 
	mv_rows
;

48 
	mv_cŞs
;

49 
	mv_süŞlsize
;

51 
	#VT_RESIZE
 0x5609

	)

53 
	svt_cÚsize
 {

54 
	mv_rows
;

55 
	mv_cŞs
;

56 
	mv_vlš
;

57 
	mv_şš
;

58 
	mv_vcŞ
;

59 
	mv_ccŞ
;

61 
	#VT_RESIZEX
 0x560A

	)

62 
	#VT_LOCKSWITCH
 0x560B

	)

63 
	#VT_UNLOCKSWITCH
 0x560C

	)

64 
	#VT_GETHIFONTMASK
 0x560D

	)

66 
	svt_ev’t
 {

67 
	mev’t
;

68 
	#VT_EVENT_SWITCH
 0x0001

	)

69 
	#VT_EVENT_BLANK
 0x0002

	)

70 
	#VT_EVENT_UNBLANK
 0x0004

	)

71 
	#VT_EVENT_RESIZE
 0x0008

	)

72 
	#VT_MAX_EVENT
 0x000F

	)

73 
	mŞdev
;

74 
	mÃwev
;

75 
	m·d
[4];

78 
	#VT_WAITEVENT
 0x560E

	)

80 
	svt_£ùiv©e
 {

81 
	mcÚsŞe
;

82 
vt_mode
 
	mmode
;

85 
	#VT_SETACTIVATE
 0x560F

	)

88 
	#vt_g‘_kmsg_»dœeù
(è
	`vt_kmsg_»dœeù
(-1)

	)

	@/usr/include/linux/wait.h

1 #iâdeà
_LINUX_WAIT_H


2 
	#_LINUX_WAIT_H


	)

4 
	#WNOHANG
 0x00000001

	)

5 
	#WUNTRACED
 0x00000002

	)

6 
	#WSTOPPED
 
WUNTRACED


	)

7 
	#WEXITED
 0x00000004

	)

8 
	#WCONTINUED
 0x00000008

	)

9 
	#WNOWAIT
 0x01000000

	)

11 
	#__WNOTHREAD
 0x20000000

	)

12 
	#__WALL
 0x40000000

	)

13 
	#__WCLONE
 0x80000000

	)

16 
	#P_ALL
 0

	)

17 
	#P_PID
 1

	)

18 
	#P_PGID
 2

	)

	@/usr/include/linux/watchdog.h

9 #iâdeà
_LINUX_WATCHDOG_H


10 
	#_LINUX_WATCHDOG_H


	)

12 
	~<lšux/ioùl.h
>

13 
	~<lšux/ty³s.h
>

15 
	#WATCHDOG_IOCTL_BASE
 'W'

	)

17 
	sw©chdog_šfo
 {

18 
__u32
 
	mİtiÚs
;

19 
__u32
 
	mfœmw¬e_v”siÚ
;

20 
__u8
 
	mid’t™y
[32];

23 
	#WDIOC_GETSUPPORT
 
	`_IOR
(
WATCHDOG_IOCTL_BASE
, 0, 
w©chdog_šfo
)

	)

24 
	#WDIOC_GETSTATUS
 
	`_IOR
(
WATCHDOG_IOCTL_BASE
, 1, )

	)

25 
	#WDIOC_GETBOOTSTATUS
 
	`_IOR
(
WATCHDOG_IOCTL_BASE
, 2, )

	)

26 
	#WDIOC_GETTEMP
 
	`_IOR
(
WATCHDOG_IOCTL_BASE
, 3, )

	)

27 
	#WDIOC_SETOPTIONS
 
	`_IOR
(
WATCHDOG_IOCTL_BASE
, 4, )

	)

28 
	#WDIOC_KEEPALIVE
 
	`_IOR
(
WATCHDOG_IOCTL_BASE
, 5, )

	)

29 
	#WDIOC_SETTIMEOUT
 
	`_IOWR
(
WATCHDOG_IOCTL_BASE
, 6, )

	)

30 
	#WDIOC_GETTIMEOUT
 
	`_IOR
(
WATCHDOG_IOCTL_BASE
, 7, )

	)

31 
	#WDIOC_SETPRETIMEOUT
 
	`_IOWR
(
WATCHDOG_IOCTL_BASE
, 8, )

	)

32 
	#WDIOC_GETPRETIMEOUT
 
	`_IOR
(
WATCHDOG_IOCTL_BASE
, 9, )

	)

33 
	#WDIOC_GETTIMELEFT
 
	`_IOR
(
WATCHDOG_IOCTL_BASE
, 10, )

	)

35 
	#WDIOF_UNKNOWN
 -1

	)

36 
	#WDIOS_UNKNOWN
 -1

	)

38 
	#WDIOF_OVERHEAT
 0x0001

	)

39 
	#WDIOF_FANFAULT
 0x0002

	)

40 
	#WDIOF_EXTERN1
 0x0004

	)

41 
	#WDIOF_EXTERN2
 0x0008

	)

42 
	#WDIOF_POWERUNDER
 0x0010

	)

43 
	#WDIOF_CARDRESET
 0x0020

	)

44 
	#WDIOF_POWEROVER
 0x0040

	)

45 
	#WDIOF_SETTIMEOUT
 0x0080

	)

46 
	#WDIOF_MAGICCLOSE
 0x0100

	)

47 
	#WDIOF_PRETIMEOUT
 0x0200

	)

48 
	#WDIOF_KEEPALIVEPING
 0x8000

	)

50 
	#WDIOS_DISABLECARD
 0x0001

	)

51 
	#WDIOS_ENABLECARD
 0x0002

	)

52 
	#WDIOS_TEMPPANIC
 0x0004

	)

	@/usr/include/linux/xattr.h

10 #iâdeà
_LINUX_XATTR_H


11 
	#_LINUX_XATTR_H


	)

13 
	#XATTR_CREATE
 0x1

	)

14 
	#XATTR_REPLACE
 0x2

	)

17 
	#XATTR_OS2_PREFIX
 "os2."

	)

18 
	#XATTR_OS2_PREFIX_LEN
 ( (
XATTR_OS2_PREFIX
è- 1)

	)

20 
	#XATTR_SECURITY_PREFIX
 "£cur™y."

	)

21 
	#XATTR_SECURITY_PREFIX_LEN
 ( (
XATTR_SECURITY_PREFIX
è- 1)

	)

23 
	#XATTR_SYSTEM_PREFIX
 "sy¡em."

	)

24 
	#XATTR_SYSTEM_PREFIX_LEN
 ( (
XATTR_SYSTEM_PREFIX
è- 1)

	)

26 
	#XATTR_TRUSTED_PREFIX
 "Œu¡ed."

	)

27 
	#XATTR_TRUSTED_PREFIX_LEN
 ( (
XATTR_TRUSTED_PREFIX
è- 1)

	)

29 
	#XATTR_USER_PREFIX
 "u£r."

	)

30 
	#XATTR_USER_PREFIX_LEN
 ( (
XATTR_USER_PREFIX
è- 1)

	)

33 
	#XATTR_EVM_SUFFIX
 "evm"

	)

34 
	#XATTR_NAME_EVM
 
XATTR_SECURITY_PREFIX
 
XATTR_EVM_SUFFIX


	)

36 
	#XATTR_SELINUX_SUFFIX
 "£lšux"

	)

37 
	#XATTR_NAME_SELINUX
 
XATTR_SECURITY_PREFIX
 
XATTR_SELINUX_SUFFIX


	)

39 
	#XATTR_SMACK_SUFFIX
 "SMACK64"

	)

40 
	#XATTR_SMACK_IPIN
 "SMACK64IPIN"

	)

41 
	#XATTR_SMACK_IPOUT
 "SMACK64IPOUT"

	)

42 
	#XATTR_SMACK_EXEC
 "SMACK64EXEC"

	)

43 
	#XATTR_SMACK_TRANSMUTE
 "SMACK64TRANSMUTE"

	)

44 
	#XATTR_SMACK_MMAP
 "SMACK64MMAP"

	)

45 
	#XATTR_NAME_SMACK
 
XATTR_SECURITY_PREFIX
 
XATTR_SMACK_SUFFIX


	)

46 
	#XATTR_NAME_SMACKIPIN
 
XATTR_SECURITY_PREFIX
 
XATTR_SMACK_IPIN


	)

47 
	#XATTR_NAME_SMACKIPOUT
 
XATTR_SECURITY_PREFIX
 
XATTR_SMACK_IPOUT


	)

48 
	#XATTR_NAME_SMACKEXEC
 
XATTR_SECURITY_PREFIX
 
XATTR_SMACK_EXEC


	)

49 
	#XATTR_NAME_SMACKTRANSMUTE
 
XATTR_SECURITY_PREFIX
 
XATTR_SMACK_TRANSMUTE


	)

50 
	#XATTR_NAME_SMACKMMAP
 
XATTR_SECURITY_PREFIX
 
XATTR_SMACK_MMAP


	)

52 
	#XATTR_CAPS_SUFFIX
 "ÿ·b™y"

	)

53 
	#XATTR_NAME_CAPS
 
XATTR_SECURITY_PREFIX
 
XATTR_CAPS_SUFFIX


	)

55 
	#XATTR_POSIX_ACL_ACCESS
 "posix_aş_acûss"

	)

56 
	#XATTR_NAME_POSIX_ACL_ACCESS
 
XATTR_SYSTEM_PREFIX
 
XATTR_POSIX_ACL_ACCESS


	)

57 
	#XATTR_POSIX_ACL_DEFAULT
 "posix_aş_deçuÉ"

	)

58 
	#XATTR_NAME_POSIX_ACL_DEFAULT
 
XATTR_SYSTEM_PREFIX
 
XATTR_POSIX_ACL_DEFAULT


	)

	@/usr/include/scsi/scsi.h

24 #iâdeà
_SCSI_SCSI_H


25 
	#_SCSI_SCSI_H
 1

	)

27 
	~<ã©u»s.h
>

33 
	#TEST_UNIT_READY
 0x00

	)

34 
	#REZERO_UNIT
 0x01

	)

35 
	#REQUEST_SENSE
 0x03

	)

36 
	#FORMAT_UNIT
 0x04

	)

37 
	#READ_BLOCK_LIMITS
 0x05

	)

38 
	#REASSIGN_BLOCKS
 0x07

	)

39 
	#READ_6
 0x08

	)

40 
	#WRITE_6
 0x0a

	)

41 
	#SEEK_6
 0x0b

	)

42 
	#READ_REVERSE
 0x0f

	)

43 
	#WRITE_FILEMARKS
 0x10

	)

44 
	#SPACE
 0x11

	)

45 
	#INQUIRY
 0x12

	)

46 
	#RECOVER_BUFFERED_DATA
 0x14

	)

47 
	#MODE_SELECT
 0x15

	)

48 
	#RESERVE
 0x16

	)

49 
	#RELEASE
 0x17

	)

50 
	#COPY
 0x18

	)

51 
	#ERASE
 0x19

	)

52 
	#MODE_SENSE
 0x1a

	)

53 
	#START_STOP
 0x1b

	)

54 
	#RECEIVE_DIAGNOSTIC
 0x1c

	)

55 
	#SEND_DIAGNOSTIC
 0x1d

	)

56 
	#ALLOW_MEDIUM_REMOVAL
 0x1e

	)

58 
	#SET_WINDOW
 0x24

	)

59 
	#READ_CAPACITY
 0x25

	)

60 
	#READ_10
 0x28

	)

61 
	#WRITE_10
 0x2a

	)

62 
	#SEEK_10
 0x2b

	)

63 
	#WRITE_VERIFY
 0x2e

	)

64 
	#VERIFY
 0x2f

	)

65 
	#SEARCH_HIGH
 0x30

	)

66 
	#SEARCH_EQUAL
 0x31

	)

67 
	#SEARCH_LOW
 0x32

	)

68 
	#SET_LIMITS
 0x33

	)

69 
	#PRE_FETCH
 0x34

	)

70 
	#READ_POSITION
 0x34

	)

71 
	#SYNCHRONIZE_CACHE
 0x35

	)

72 
	#LOCK_UNLOCK_CACHE
 0x36

	)

73 
	#READ_DEFECT_DATA
 0x37

	)

74 
	#MEDIUM_SCAN
 0x38

	)

75 
	#COMPARE
 0x39

	)

76 
	#COPY_VERIFY
 0x3a

	)

77 
	#WRITE_BUFFER
 0x3b

	)

78 
	#READ_BUFFER
 0x3c

	)

79 
	#UPDATE_BLOCK
 0x3d

	)

80 
	#READ_LONG
 0x3e

	)

81 
	#WRITE_LONG
 0x3f

	)

82 
	#CHANGE_DEFINITION
 0x40

	)

83 
	#WRITE_SAME
 0x41

	)

84 
	#READ_TOC
 0x43

	)

85 
	#LOG_SELECT
 0x4c

	)

86 
	#LOG_SENSE
 0x4d

	)

87 
	#MODE_SELECT_10
 0x55

	)

88 
	#RESERVE_10
 0x56

	)

89 
	#RELEASE_10
 0x57

	)

90 
	#MODE_SENSE_10
 0x5a

	)

91 
	#PERSISTENT_RESERVE_IN
 0x5e

	)

92 
	#PERSISTENT_RESERVE_OUT
 0x5f

	)

93 
	#MOVE_MEDIUM
 0xa5

	)

94 
	#READ_12
 0xa8

	)

95 
	#WRITE_12
 0x¯

	)

96 
	#WRITE_VERIFY_12
 0x«

	)

97 
	#SEARCH_HIGH_12
 0xb0

	)

98 
	#SEARCH_EQUAL_12
 0xb1

	)

99 
	#SEARCH_LOW_12
 0xb2

	)

100 
	#READ_ELEMENT_STATUS
 0xb8

	)

101 
	#SEND_VOLUME_TAG
 0xb6

	)

102 
	#WRITE_LONG_2
 0x—

	)

108 
	#GOOD
 0x00

	)

109 
	#CHECK_CONDITION
 0x01

	)

110 
	#CONDITION_GOOD
 0x02

	)

111 
	#BUSY
 0x04

	)

112 
	#INTERMEDIATE_GOOD
 0x08

	)

113 
	#INTERMEDIATE_C_GOOD
 0x0a

	)

114 
	#RESERVATION_CONFLICT
 0x0c

	)

115 
	#COMMAND_TERMINATED
 0x11

	)

116 
	#QUEUE_FULL
 0x14

	)

118 
	#STATUS_MASK
 0x3e

	)

124 
	#NO_SENSE
 0x00

	)

125 
	#RECOVERED_ERROR
 0x01

	)

126 
	#NOT_READY
 0x02

	)

127 
	#MEDIUM_ERROR
 0x03

	)

128 
	#HARDWARE_ERROR
 0x04

	)

129 
	#ILLEGAL_REQUEST
 0x05

	)

130 
	#UNIT_ATTENTION
 0x06

	)

131 
	#DATA_PROTECT
 0x07

	)

132 
	#BLANK_CHECK
 0x08

	)

133 
	#COPY_ABORTED
 0x0a

	)

134 
	#ABORTED_COMMAND
 0x0b

	)

135 
	#VOLUME_OVERFLOW
 0x0d

	)

136 
	#MISCOMPARE
 0x0e

	)

143 
	#TYPE_DISK
 0x00

	)

144 
	#TYPE_TAPE
 0x01

	)

145 
	#TYPE_PROCESSOR
 0x03

	)

146 
	#TYPE_WORM
 0x04

	)

147 
	#TYPE_ROM
 0x05

	)

148 
	#TYPE_SCANNER
 0x06

	)

149 
	#TYPE_MOD
 0x07

	)

151 
	#TYPE_MEDIUM_CHANGER
 0x08

	)

152 
	#TYPE_ENCLOSURE
 0x0d

	)

153 
	#TYPE_NO_LUN
 0x7f

	)

161 
	sccs_mode£l_h—d


163 
	m_r1
;

164 
	mmedium
;

165 
	m_r2
;

166 
	mblock_desc_Ëngth
;

167 
	md’s™y
;

168 
	mnumb”_blocks_hi
;

170 
	mnumb”_blocks_med
;

171 
	mnumb”_blocks_lo
;

172 
	m_r3
;

173 
	mblock_Ëngth_hi
;

175 
	mblock_Ëngth_med
;

176 
	mblock_Ëngth_lo
;

183 
	#COMMAND_COMPLETE
 0x00

	)

184 
	#EXTENDED_MESSAGE
 0x01

	)

185 
	#EXTENDED_MODIFY_DATA_POINTER
 0x00

	)

186 
	#EXTENDED_SDTR
 0x01

	)

187 
	#EXTENDED_EXTENDED_IDENTIFY
 0x02

	)

188 
	#EXTENDED_WDTR
 0x03

	)

189 
	#SAVE_POINTERS
 0x02

	)

190 
	#RESTORE_POINTERS
 0x03

	)

191 
	#DISCONNECT
 0x04

	)

192 
	#INITIATOR_ERROR
 0x05

	)

193 
	#ABORT
 0x06

	)

194 
	#MESSAGE_REJECT
 0x07

	)

195 
	#NOP
 0x08

	)

196 
	#MSG_PARITY_ERROR
 0x09

	)

197 
	#LINKED_CMD_COMPLETE
 0x0a

	)

198 
	#LINKED_FLG_CMD_COMPLETE
 0x0b

	)

199 
	#BUS_DEVICE_RESET
 0x0c

	)

201 
	#INITIATE_RECOVERY
 0x0à

	)

202 
	#RELEASE_RECOVERY
 0x10

	)

204 
	#SIMPLE_QUEUE_TAG
 0x20

	)

205 
	#HEAD_OF_QUEUE_TAG
 0x21

	)

206 
	#ORDERED_QUEUE_TAG
 0x22

	)

213 
	#SCSI_IOCTL_GET_IDLUN
 0x5382

	)

217 
	#SCSI_IOCTL_TAGGED_ENABLE
 0x5383

	)

218 
	#SCSI_IOCTL_TAGGED_DISABLE
 0x5384

	)

221 
	#SCSI_IOCTL_PROBE_HOST
 0x5385

	)

224 
	#SCSI_IOCTL_GET_BUS_NUMBER
 0x5386

	)

	@/usr/include/scsi/scsi_ioctl.h

19 #iâdeà
_SCSI_IOCTL_H


20 
	#_SCSI_IOCTL_H


	)

23 
	#SCSI_IOCTL_SEND_COMMAND
 1

	)

24 
	#SCSI_IOCTL_TEST_UNIT_READY
 2

	)

25 
	#SCSI_IOCTL_BENCHMARK_COMMAND
 3

	)

26 
	#SCSI_IOCTL_SYNC
 4

	)

27 
	#SCSI_IOCTL_START_UNIT
 5

	)

28 
	#SCSI_IOCTL_STOP_UNIT
 6

	)

29 
	#SCSI_IOCTL_DOORLOCK
 0x5380

	)

30 
	#SCSI_IOCTL_DOORUNLOCK
 0x5381

	)

	@/usr/include/scsi/sg.h

26 #iâdeà
_SCSI_SG_H


27 
	#_SCSI_SG_H
 1

	)

29 
	~<ã©u»s.h
>

36 
	ssg_iovec


38 * 
	miov_ba£
;

39 
size_t
 
	miov_Ën
;

40 } 
	tsg_iovec_t
;

43 
	ssg_io_hdr


45 
	mš‹rçû_id
;

46 
	mdxãr_dœeùiÚ
;

47 
	mcmd_Ën
;

48 
	mmx_sb_Ën
;

49 
	miovec_couÁ
;

50 
	mdxãr_Ën
;

51 * 
	mdxã½
;

53 * 
	mcmdp
;

54 * 
	msbp
;

55 
	mtimeout
;

56 
	mæags
;

57 
	m·ck_id
;

58 * 
	mu¤_±r
;

59 
	m¡©us
;

60 
	mmasked_¡©us
;

61 
	mmsg_¡©us
;

62 
	msb_Ën_wr
;

63 
	mho¡_¡©us
;

64 
	mdriv”_¡©us
;

65 
	m»sid
;

66 
	mdu¿tiÚ
;

67 
	mšfo
;

68 } 
	tsg_io_hdr_t
;

72 
	#SG_DXFER_NONE
 -1

	)

73 
	#SG_DXFER_TO_DEV
 -2

	)

74 
	#SG_DXFER_FROM_DEV
 -3

	)

75 
	#SG_DXFER_TO_FROM_DEV
 -4

	)

82 
	#SG_FLAG_DIRECT_IO
 1

	)

83 
	#SG_FLAG_LUN_INHIBIT
 2

	)

85 
	#SG_FLAG_NO_DXFER
 0x10000

	)

89 
	#SG_INFO_OK_MASK
 0x1

	)

90 
	#SG_INFO_OK
 0x0

	)

91 
	#SG_INFO_CHECK
 0x1

	)

93 
	#SG_INFO_DIRECT_IO_MASK
 0x6

	)

94 
	#SG_INFO_INDIRECT_IO
 0x0

	)

95 
	#SG_INFO_DIRECT_IO
 0x2

	)

96 
	#SG_INFO_MIXED_IO
 0x4

	)

101 
	ssg_scsi_id
 {

103 
	mho¡_no
;

104 
	mchªÃl
;

106 
	mscsi_id
;

107 
	mlun
;

109 
	mscsi_ty³
;

111 
	mh_cmd_³r_lun
;

113 
	md_queue_d•th
;

115 
	munu£d
[2];

119 
	ssg_»q_šfo
 {

120 
	m»q_¡©e
;

121 
	mÜphª
;

122 
	msg_io_owÃd
;

123 
	m´obËm
;

124 
	m·ck_id
;

125 * 
	mu¤_±r
;

126 
	mdu¿tiÚ
;

128 
	munu£d
;

129 } 
	tsg_»q_šfo_t
;

136 
	#SG_EMULATED_HOST
 0x2203

	)

140 
	#SG_SET_TRANSFORM
 0x2204

	)

142 
	#SG_GET_TRANSFORM
 0x2205

	)

144 
	#SG_SET_RESERVED_SIZE
 0x2275

	)

145 
	#SG_GET_RESERVED_SIZE
 0x2272

	)

148 
	#SG_GET_SCSI_ID
 0x2276

	)

152 
	#SG_SET_FORCE_LOW_DMA
 0x2279

	)

153 
	#SG_GET_LOW_DMA
 0x227¨

	)

159 
	#SG_SET_FORCE_PACK_ID
 0x227b

	)

160 
	#SG_GET_PACK_ID
 0x227ø

	)

162 
	#SG_GET_NUM_WAITING
 0x227d

	)

165 
	#SG_GET_SG_TABLESIZE
 0x227F

	)

167 
	#SG_GET_VERSION_NUM
 0x2282

	)

170 
	#SG_SCSI_RESET
 0x2284

	)

172 
	#SG_SCSI_RESET_NOTHING
 0

	)

173 
	#SG_SCSI_RESET_DEVICE
 1

	)

174 
	#SG_SCSI_RESET_BUS
 2

	)

175 
	#SG_SCSI_RESET_HOST
 3

	)

178 
	#SG_IO
 0x2285

	)

180 
	#SG_GET_REQUEST_TABLE
 0x2286

	)

183 
	#SG_SET_KEEP_ORPHAN
 0x2287

	)

184 
	#SG_GET_KEEP_ORPHAN
 0x2288

	)

187 
	#SG_SCATTER_SZ
 (8 * 4096è

	)

195 
	#SG_DEFAULT_RETRIES
 1

	)

198 
	#SG_DEF_FORCE_LOW_DMA
 0

	)

199 
	#SG_DEF_FORCE_PACK_ID
 0

	)

200 
	#SG_DEF_KEEP_ORPHAN
 0

	)

201 
	#SG_DEF_RESERVED_SIZE
 
SG_SCATTER_SZ


	)

204 
	#SG_MAX_QUEUE
 16

	)

206 
	#SG_BIG_BUFF
 
SG_DEF_RESERVED_SIZE


	)

209 
sg_io_hdr
 
	tSg_io_hdr
;

210 
sg_io_vec
 
	tSg_io_vec
;

211 
sg_scsi_id
 
	tSg_scsi_id
;

212 
sg_»q_šfo
 
	tSg_»q_šfo
;

219 
	#SG_MAX_SENSE
 16

	)

221 
	ssg_h—d”


224 
	m·ck_Ën
;

226 
	m»¶y_Ën
;

228 
	m·ck_id
;

230 
	m»suÉ
;

232 
	mtw–ve_by‹
:1;

234 
	mrg‘_¡©us
:5;

236 
	mho¡_¡©us
:8;

238 
	mdriv”_¡©us
:8;

240 
	mÙh”_æags
:10;

245 
	m£n£_bufãr
[
SG_MAX_SENSE
];

253 
	#SG_SET_TIMEOUT
 0x2201

	)

254 
	#SG_GET_TIMEOUT
 0x2202

	)

257 
	#SG_GET_COMMAND_Q
 0x2270

	)

258 
	#SG_SET_COMMAND_Q
 0x2271

	)

262 
	#SG_SET_DEBUG
 0x227

	)

264 
	#SG_NEXT_CMD_LEN
 0x2283

	)

269 
	#SG_DEFAULT_TIMEOUT
 (60*
HZ
è

	)

270 
	#SG_DEF_COMMAND_Q
 0

	)

272 
	#SG_DEF_UNDERRUN_FLAG
 0

	)

	@/usr/include/asm-generic/ioctls.h

1 #iâdeà
__ASM_GENERIC_IOCTLS_H


2 
	#__ASM_GENERIC_IOCTLS_H


	)

4 
	~<lšux/ioùl.h
>

19 
	#TCGETS
 0x5401

	)

20 
	#TCSETS
 0x5402

	)

21 
	#TCSETSW
 0x5403

	)

22 
	#TCSETSF
 0x5404

	)

23 
	#TCGETA
 0x5405

	)

24 
	#TCSETA
 0x5406

	)

25 
	#TCSETAW
 0x5407

	)

26 
	#TCSETAF
 0x5408

	)

27 
	#TCSBRK
 0x5409

	)

28 
	#TCXONC
 0x540A

	)

29 
	#TCFLSH
 0x540B

	)

30 
	#TIOCEXCL
 0x540C

	)

31 
	#TIOCNXCL
 0x540D

	)

32 
	#TIOCSCTTY
 0x540E

	)

33 
	#TIOCGPGRP
 0x540F

	)

34 
	#TIOCSPGRP
 0x5410

	)

35 
	#TIOCOUTQ
 0x5411

	)

36 
	#TIOCSTI
 0x5412

	)

37 
	#TIOCGWINSZ
 0x5413

	)

38 
	#TIOCSWINSZ
 0x5414

	)

39 
	#TIOCMGET
 0x5415

	)

40 
	#TIOCMBIS
 0x5416

	)

41 
	#TIOCMBIC
 0x5417

	)

42 
	#TIOCMSET
 0x5418

	)

43 
	#TIOCGSOFTCAR
 0x5419

	)

44 
	#TIOCSSOFTCAR
 0x541A

	)

45 
	#FIONREAD
 0x541B

	)

46 
	#TIOCINQ
 
FIONREAD


	)

47 
	#TIOCLINUX
 0x541C

	)

48 
	#TIOCCONS
 0x541D

	)

49 
	#TIOCGSERIAL
 0x541E

	)

50 
	#TIOCSSERIAL
 0x541F

	)

51 
	#TIOCPKT
 0x5420

	)

52 
	#FIONBIO
 0x5421

	)

53 
	#TIOCNOTTY
 0x5422

	)

54 
	#TIOCSETD
 0x5423

	)

55 
	#TIOCGETD
 0x5424

	)

56 
	#TCSBRKP
 0x5425

	)

57 
	#TIOCSBRK
 0x5427

	)

58 
	#TIOCCBRK
 0x5428

	)

59 
	#TIOCGSID
 0x5429

	)

60 
	#TCGETS2
 
	`_IOR
('T', 0x2A, 
‹rmios2
)

	)

61 
	#TCSETS2
 
	`_IOW
('T', 0x2B, 
‹rmios2
)

	)

62 
	#TCSETSW2
 
	`_IOW
('T', 0x2C, 
‹rmios2
)

	)

63 
	#TCSETSF2
 
	`_IOW
('T', 0x2D, 
‹rmios2
)

	)

64 
	#TIOCGRS485
 0x542E

	)

65 #iâdeà
TIOCSRS485


66 
	#TIOCSRS485
 0x542F

	)

68 
	#TIOCGPTN
 
	`_IOR
('T', 0x30, è

	)

69 
	#TIOCSPTLCK
 
	`_IOW
('T', 0x31, è

	)

70 
	#TIOCGDEV
 
	`_IOR
('T', 0x32, è

	)

71 
	#TCGETX
 0x5432

	)

72 
	#TCSETX
 0x5433

	)

73 
	#TCSETXF
 0x5434

	)

74 
	#TCSETXW
 0x5435

	)

75 
	#TIOCSIG
 
	`_IOW
('T', 0x36, è

	)

76 
	#TIOCVHANGUP
 0x5437

	)

78 
	#FIONCLEX
 0x5450

	)

79 
	#FIOCLEX
 0x5451

	)

80 
	#FIOASYNC
 0x5452

	)

81 
	#TIOCSERCONFIG
 0x5453

	)

82 
	#TIOCSERGWILD
 0x5454

	)

83 
	#TIOCSERSWILD
 0x5455

	)

84 
	#TIOCGLCKTRMIOS
 0x5456

	)

85 
	#TIOCSLCKTRMIOS
 0x5457

	)

86 
	#TIOCSERGSTRUCT
 0x5458

	)

87 
	#TIOCSERGETLSR
 0x5459

	)

88 
	#TIOCSERGETMULTI
 0x545A

	)

89 
	#TIOCSERSETMULTI
 0x545B

	)

91 
	#TIOCMIWAIT
 0x545C

	)

92 
	#TIOCGICOUNT
 0x545D

	)

98 #iâdeà
FIOQSIZE


99 
	#FIOQSIZE
 0x5460

	)

103 
	#TIOCPKT_DATA
 0

	)

104 
	#TIOCPKT_FLUSHREAD
 1

	)

105 
	#TIOCPKT_FLUSHWRITE
 2

	)

106 
	#TIOCPKT_STOP
 4

	)

107 
	#TIOCPKT_START
 8

	)

108 
	#TIOCPKT_NOSTOP
 16

	)

109 
	#TIOCPKT_DOSTOP
 32

	)

110 
	#TIOCPKT_IOCTL
 64

	)

112 
	#TIOCSER_TEMT
 0x01

	)

	@/usr/include/asm-generic/mman.h

1 #iâdeà
__ASM_GENERIC_MMAN_H


2 
	#__ASM_GENERIC_MMAN_H


	)

4 
	~<asm-g’”ic/mmª-commÚ.h
>

6 
	#MAP_GROWSDOWN
 0x0100

	)

7 
	#MAP_DENYWRITE
 0x0800

	)

8 
	#MAP_EXECUTABLE
 0x1000

	)

9 
	#MAP_LOCKED
 0x2000

	)

10 
	#MAP_NORESERVE
 0x4000

	)

11 
	#MAP_POPULATE
 0x8000

	)

12 
	#MAP_NONBLOCK
 0x10000

	)

13 
	#MAP_STACK
 0x20000

	)

14 
	#MAP_HUGETLB
 0x40000

	)

16 
	#MCL_CURRENT
 1

	)

17 
	#MCL_FUTURE
 2

	)

	@/usr/include/asm-generic/param.h

1 #iâdeà
__ASM_GENERIC_PARAM_H


2 
	#__ASM_GENERIC_PARAM_H


	)

5 #iâdeà
HZ


6 
	#HZ
 100

	)

9 #iâdeà
EXEC_PAGESIZE


10 
	#EXEC_PAGESIZE
 4096

	)

13 #iâdeà
NOGROUP


14 
	#NOGROUP
 (-1)

	)

17 
	#MAXHOSTNAMELEN
 64

	)

	@/usr/include/asm-generic/poll.h

1 #iâdeà
__ASM_GENERIC_POLL_H


2 
	#__ASM_GENERIC_POLL_H


	)

5 
	#POLLIN
 0x0001

	)

6 
	#POLLPRI
 0x0002

	)

7 
	#POLLOUT
 0x0004

	)

8 
	#POLLERR
 0x0008

	)

9 
	#POLLHUP
 0x0010

	)

10 
	#POLLNVAL
 0x0020

	)

13 
	#POLLRDNORM
 0x0040

	)

14 
	#POLLRDBAND
 0x0080

	)

15 #iâdeà
POLLWRNORM


16 
	#POLLWRNORM
 0x0100

	)

18 #iâdeà
POLLWRBAND


19 
	#POLLWRBAND
 0x0200

	)

21 #iâdeà
POLLMSG


22 
	#POLLMSG
 0x0400

	)

24 #iâdeà
POLLREMOVE


25 
	#POLLREMOVE
 0x1000

	)

27 #iâdeà
POLLRDHUP


28 
	#POLLRDHUP
 0x2000

	)

31 
	#POLLFREE
 0x4000

	)

33 
	spŞlfd
 {

34 
	mfd
;

35 
	mev’ts
;

36 
	m»v’ts
;

	@/usr/include/asm-generic/siginfo.h

1 #iâdeà
_ASM_GENERIC_SIGINFO_H


2 
	#_ASM_GENERIC_SIGINFO_H


	)

5 
	~<lšux/ty³s.h
>

7 
	usigv®
 {

8 
	msiv®_št
;

9 *
	msiv®_±r
;

10 } 
	tsigv®_t
;

16 #iâdeà
__ARCH_SI_PREAMBLE_SIZE


17 
	#__ARCH_SI_PREAMBLE_SIZE
 (3 * ())

	)

20 
	#SI_MAX_SIZE
 128

	)

21 #iâdeà
SI_PAD_SIZE


22 
	#SI_PAD_SIZE
 ((
SI_MAX_SIZE
 - 
__ARCH_SI_PREAMBLE_SIZE
è/ ())

	)

25 #iâdeà
__ARCH_SI_UID_T


26 
	#__ARCH_SI_UID_T
 
__k”Ãl_uid32_t


	)

34 #iâdeà
__ARCH_SI_BAND_T


35 
	#__ARCH_SI_BAND_T
 

	)

38 #iâdeà
HAVE_ARCH_SIGINFO_T


40 
	ssigšfo
 {

41 
	msi_signo
;

42 
	msi_”ºo
;

43 
	msi_code
;

46 
	m_·d
[
SI_PAD_SIZE
];

50 
__k”Ãl_pid_t
 
	m_pid
;

51 
__ARCH_SI_UID_T
 
	m_uid
;

52 } 
	m_kl
;

56 
__k”Ãl_tim”_t
 
	m_tid
;

57 
	m_ov”run
;

58 
	m_·d
[Ğ
__ARCH_SI_UID_T
) - ()];

59 
sigv®_t
 
	m_sigv®
;

60 
	m_sys_´iv©e
;

61 } 
	m_tim”
;

65 
__k”Ãl_pid_t
 
	m_pid
;

66 
__ARCH_SI_UID_T
 
	m_uid
;

67 
sigv®_t
 
	m_sigv®
;

68 } 
	m_¹
;

72 
__k”Ãl_pid_t
 
	m_pid
;

73 
__ARCH_SI_UID_T
 
	m_uid
;

74 
	m_¡©us
;

75 
__k”Ãl_şock_t
 
	m_utime
;

76 
__k”Ãl_şock_t
 
	m_¡ime
;

77 } 
	m_sigchld
;

81 *
	m_addr
;

82 #ifdeà
__ARCH_SI_TRAPNO


83 
	m_Œ­no
;

85 
	m_addr_lsb
;

86 } 
	m_sigçuÉ
;

90 
__ARCH_SI_BAND_T
 
	m_bªd
;

91 
	m_fd
;

92 } 
	m_sigpŞl
;

96 *
	m_ÿÎ_addr
;

97 
	m_sysÿÎ
;

98 
	m_¬ch
;

99 } 
	m_sigsys
;

100 } 
	m_sif›lds
;

101 } 
	tsigšfo_t
;

104 
	#__ARCH_SIGSYS


	)

110 
	#si_pid
 
_sif›lds
.
_kl
.
_pid


	)

111 
	#si_uid
 
_sif›lds
.
_kl
.
_uid


	)

112 
	#si_tid
 
_sif›lds
.
_tim”
.
_tid


	)

113 
	#si_ov”run
 
_sif›lds
.
_tim”
.
_ov”run


	)

114 
	#si_sys_´iv©e
 
_sif›lds
.
_tim”
.
_sys_´iv©e


	)

115 
	#si_¡©us
 
_sif›lds
.
_sigchld
.
_¡©us


	)

116 
	#si_utime
 
_sif›lds
.
_sigchld
.
_utime


	)

117 
	#si_¡ime
 
_sif›lds
.
_sigchld
.
_¡ime


	)

118 
	#si_v®ue
 
_sif›lds
.
_¹
.
_sigv®


	)

119 
	#si_št
 
_sif›lds
.
_¹
.
_sigv®
.
siv®_št


	)

120 
	#si_±r
 
_sif›lds
.
_¹
.
_sigv®
.
siv®_±r


	)

121 
	#si_addr
 
_sif›lds
.
_sigçuÉ
.
_addr


	)

122 #ifdeà
__ARCH_SI_TRAPNO


123 
	#si_Œ­no
 
_sif›lds
.
_sigçuÉ
.
_Œ­no


	)

125 
	#si_addr_lsb
 
_sif›lds
.
_sigçuÉ
.
_addr_lsb


	)

126 
	#si_bªd
 
_sif›lds
.
_sigpŞl
.
_bªd


	)

127 
	#si_fd
 
_sif›lds
.
_sigpŞl
.
_fd


	)

128 #ifdeà
__ARCH_SIGSYS


129 
	#si_ÿÎ_addr
 
_sif›lds
.
_sigsys
.
_ÿÎ_addr


	)

130 
	#si_sysÿÎ
 
_sif›lds
.
_sigsys
.
_sysÿÎ


	)

131 
	#si_¬ch
 
_sif›lds
.
_sigsys
.
_¬ch


	)

134 
	#__SI_KILL
 0

	)

135 
	#__SI_TIMER
 0

	)

136 
	#__SI_POLL
 0

	)

137 
	#__SI_FAULT
 0

	)

138 
	#__SI_CHLD
 0

	)

139 
	#__SI_RT
 0

	)

140 
	#__SI_MESGQ
 0

	)

141 
	#__SI_SYS
 0

	)

142 
	#__SI_CODE
(
T
,
N
è(N)

	)

148 
	#SI_USER
 0

	)

149 
	#SI_KERNEL
 0x80

	)

150 
	#SI_QUEUE
 -1

	)

151 
	#SI_TIMER
 
	`__SI_CODE
(
__SI_TIMER
,-2è

	)

152 
	#SI_MESGQ
 
	`__SI_CODE
(
__SI_MESGQ
,-3è

	)

153 
	#SI_ASYNCIO
 -4

	)

154 
	#SI_SIGIO
 -5

	)

155 
	#SI_TKILL
 -6

	)

156 
	#SI_DETHREAD
 -7

	)

158 
	#SI_FROMUSER
(
sŒ
è((sŒ)->
si_code
 <ğ0)

	)

159 
	#SI_FROMKERNEL
(
sŒ
è((sŒ)->
si_code
 > 0)

	)

164 
	#ILL_ILLOPC
 (
__SI_FAULT
|1è

	)

165 
	#ILL_ILLOPN
 (
__SI_FAULT
|2è

	)

166 
	#ILL_ILLADR
 (
__SI_FAULT
|3è

	)

167 
	#ILL_ILLTRP
 (
__SI_FAULT
|4è

	)

168 
	#ILL_PRVOPC
 (
__SI_FAULT
|5è

	)

169 
	#ILL_PRVREG
 (
__SI_FAULT
|6è

	)

170 
	#ILL_COPROC
 (
__SI_FAULT
|7è

	)

171 
	#ILL_BADSTK
 (
__SI_FAULT
|8è

	)

172 
	#NSIGILL
 8

	)

177 
	#FPE_INTDIV
 (
__SI_FAULT
|1è

	)

178 
	#FPE_INTOVF
 (
__SI_FAULT
|2è

	)

179 
	#FPE_FLTDIV
 (
__SI_FAULT
|3è

	)

180 
	#FPE_FLTOVF
 (
__SI_FAULT
|4è

	)

181 
	#FPE_FLTUND
 (
__SI_FAULT
|5è

	)

182 
	#FPE_FLTRES
 (
__SI_FAULT
|6è

	)

183 
	#FPE_FLTINV
 (
__SI_FAULT
|7è

	)

184 
	#FPE_FLTSUB
 (
__SI_FAULT
|8è

	)

185 
	#NSIGFPE
 8

	)

190 
	#SEGV_MAPERR
 (
__SI_FAULT
|1è

	)

191 
	#SEGV_ACCERR
 (
__SI_FAULT
|2è

	)

192 
	#NSIGSEGV
 2

	)

197 
	#BUS_ADRALN
 (
__SI_FAULT
|1è

	)

198 
	#BUS_ADRERR
 (
__SI_FAULT
|2è

	)

199 
	#BUS_OBJERR
 (
__SI_FAULT
|3è

	)

201 
	#BUS_MCEERR_AR
 (
__SI_FAULT
|4)

	)

203 
	#BUS_MCEERR_AO
 (
__SI_FAULT
|5)

	)

204 
	#NSIGBUS
 5

	)

209 
	#TRAP_BRKPT
 (
__SI_FAULT
|1è

	)

210 
	#TRAP_TRACE
 (
__SI_FAULT
|2è

	)

211 
	#TRAP_BRANCH
 (
__SI_FAULT
|3è

	)

212 
	#TRAP_HWBKPT
 (
__SI_FAULT
|4è

	)

213 
	#NSIGTRAP
 4

	)

218 
	#CLD_EXITED
 (
__SI_CHLD
|1è

	)

219 
	#CLD_KILLED
 (
__SI_CHLD
|2è

	)

220 
	#CLD_DUMPED
 (
__SI_CHLD
|3è

	)

221 
	#CLD_TRAPPED
 (
__SI_CHLD
|4è

	)

222 
	#CLD_STOPPED
 (
__SI_CHLD
|5è

	)

223 
	#CLD_CONTINUED
 (
__SI_CHLD
|6è

	)

224 
	#NSIGCHLD
 6

	)

229 
	#POLL_IN
 (
__SI_POLL
|1è

	)

230 
	#POLL_OUT
 (
__SI_POLL
|2è

	)

231 
	#POLL_MSG
 (
__SI_POLL
|3è

	)

232 
	#POLL_ERR
 (
__SI_POLL
|4è

	)

233 
	#POLL_PRI
 (
__SI_POLL
|5è

	)

234 
	#POLL_HUP
 (
__SI_POLL
|6è

	)

235 
	#NSIGPOLL
 6

	)

240 
	#SYS_SECCOMP
 (
__SI_SYS
|1è

	)

241 
	#NSIGSYS
 1

	)

251 
	#SIGEV_SIGNAL
 0

	)

252 
	#SIGEV_NONE
 1

	)

253 
	#SIGEV_THREAD
 2

	)

254 
	#SIGEV_THREAD_ID
 4

	)

260 #iâdeà
__ARCH_SIGEV_PREAMBLE_SIZE


261 
	#__ARCH_SIGEV_PREAMBLE_SIZE
 ((è* 2 + (
sigv®_t
))

	)

264 
	#SIGEV_MAX_SIZE
 64

	)

265 
	#SIGEV_PAD_SIZE
 ((
SIGEV_MAX_SIZE
 - 
__ARCH_SIGEV_PREAMBLE_SIZE
) \

266 / ())

	)

268 
	ssigev’t
 {

269 
sigv®_t
 
	msigev_v®ue
;

270 
	msigev_signo
;

271 
	msigev_nÙify
;

273 
	m_·d
[
SIGEV_PAD_SIZE
];

274 
	m_tid
;

277 (*
	m_funùiÚ
)(
	msigv®_t
);

278 *
	m_©Œibu‹
;

279 } 
	m_sigev_th»ad
;

280 } 
	m_sigev_un
;

281 } 
	tsigev’t_t
;

283 
	#sigev_nÙify_funùiÚ
 
_sigev_un
.
_sigev_th»ad
.
_funùiÚ


	)

284 
	#sigev_nÙify_©Œibu‹s
 
_sigev_un
.
_sigev_th»ad
.
_©Œibu‹


	)

285 
	#sigev_nÙify_th»ad_id
 
_sigev_un
.
_tid


	)

	@/usr/include/asm/a.out.h

1 #iâdeà
_ASM_X86_A_OUT_H


2 
	#_ASM_X86_A_OUT_H


	)

4 
	sexec


6 
	ma_šfo
;

7 
	ma_‹xt
;

8 
	ma_d©a
;

9 
	ma_bss
;

10 
	ma_syms
;

11 
	ma_’Œy
;

12 
	ma_Œsize
;

13 
	ma_drsize
;

16 
	#N_TRSIZE
(
a
è(×).
a_Œsize
)

	)

17 
	#N_DRSIZE
(
a
è(×).
a_drsize
)

	)

18 
	#N_SYMSIZE
(
a
è(×).
a_syms
)

	)

	@/usr/include/asm/errno.h

1 
	~<asm-g’”ic/”ºo.h
>

	@/usr/include/asm/fcntl.h

1 
	~<asm-g’”ic/fú.h
>

	@/usr/include/asm/ioctl.h

1 
	~<asm-g’”ic/ioùl.h
>

	@/usr/include/asm/posix_types.h

1 #ifdeà
__i386__


2 
	~<asm/posix_ty³s_32.h
>

4 
	~<asm/posix_ty³s_64.h
>

	@/usr/include/asm/ptrace.h

1 #iâdeà
_ASM_X86_PTRACE_H


2 
	#_ASM_X86_PTRACE_H


	)

5 
	~<asm/±¿û-abi.h
>

6 
	~<asm/´oûssÜ-æags.h
>

9 #iâdeà
__ASSEMBLY__


11 #ifdeà
__i386__


16 
	s±_»gs
 {

17 
	mebx
;

18 
	mecx
;

19 
	medx
;

20 
	mesi
;

21 
	medi
;

22 
	mebp
;

23 
	m—x
;

24 
	mxds
;

25 
	mxes
;

26 
	mxfs
;

27 
	mxgs
;

28 
	mÜig_—x
;

29 
	me
;

30 
	mxcs
;

31 
	meæags
;

32 
	me¥
;

33 
	mxss
;

40 
	s±_»gs
 {

41 
	mr15
;

42 
	mr14
;

43 
	mr13
;

44 
	mr12
;

45 
	mrbp
;

46 
	mrbx
;

48 
	mr11
;

49 
	mr10
;

50 
	mr9
;

51 
	mr8
;

52 
	m¿x
;

53 
	mrcx
;

54 
	mrdx
;

55 
	mrsi
;

56 
	mrdi
;

57 
	mÜig_¿x
;

60 
	mr
;

61 
	mcs
;

62 
	meæags
;

63 
	mr¥
;

64 
	mss
;

	@/usr/include/asm/shmbuf.h

1 
	~<asm-g’”ic/shmbuf.h
>

	@/usr/include/asm/signal.h

1 #iâdeà
_ASM_X86_SIGNAL_H


2 
	#_ASM_X86_SIGNAL_H


	)

4 #iâdeà
__ASSEMBLY__


5 
	~<lšux/ty³s.h
>

6 
	~<lšux/time.h
>

10 
	gsigšfo
;

14 
	#NSIG
 32

	)

15 
	tsig£t_t
;

19 
	#SIGHUP
 1

	)

20 
	#SIGINT
 2

	)

21 
	#SIGQUIT
 3

	)

22 
	#SIGILL
 4

	)

23 
	#SIGTRAP
 5

	)

24 
	#SIGABRT
 6

	)

25 
	#SIGIOT
 6

	)

26 
	#SIGBUS
 7

	)

27 
	#SIGFPE
 8

	)

28 
	#SIGKILL
 9

	)

29 
	#SIGUSR1
 10

	)

30 
	#SIGSEGV
 11

	)

31 
	#SIGUSR2
 12

	)

32 
	#SIGPIPE
 13

	)

33 
	#SIGALRM
 14

	)

34 
	#SIGTERM
 15

	)

35 
	#SIGSTKFLT
 16

	)

36 
	#SIGCHLD
 17

	)

37 
	#SIGCONT
 18

	)

38 
	#SIGSTOP
 19

	)

39 
	#SIGTSTP
 20

	)

40 
	#SIGTTIN
 21

	)

41 
	#SIGTTOU
 22

	)

42 
	#SIGURG
 23

	)

43 
	#SIGXCPU
 24

	)

44 
	#SIGXFSZ
 25

	)

45 
	#SIGVTALRM
 26

	)

46 
	#SIGPROF
 27

	)

47 
	#SIGWINCH
 28

	)

48 
	#SIGIO
 29

	)

49 
	#SIGPOLL
 
SIGIO


	)

53 
	#SIGPWR
 30

	)

54 
	#SIGSYS
 31

	)

55 
	#SIGUNUSED
 31

	)

58 
	#SIGRTMIN
 32

	)

59 
	#SIGRTMAX
 
_NSIG


	)

74 
	#SA_NOCLDSTOP
 0x00000001u

	)

75 
	#SA_NOCLDWAIT
 0x00000002u

	)

76 
	#SA_SIGINFO
 0x00000004u

	)

77 
	#SA_ONSTACK
 0x08000000u

	)

78 
	#SA_RESTART
 0x10000000u

	)

79 
	#SA_NODEFER
 0x40000000u

	)

80 
	#SA_RESETHAND
 0x80000000u

	)

82 
	#SA_NOMASK
 
SA_NODEFER


	)

83 
	#SA_ONESHOT
 
SA_RESETHAND


	)

85 
	#SA_RESTORER
 0x04000000

	)

90 
	#SS_ONSTACK
 1

	)

91 
	#SS_DISABLE
 2

	)

93 
	#MINSIGSTKSZ
 2048

	)

94 
	#SIGSTKSZ
 8192

	)

96 
	~<asm-g’”ic/sigÇl-defs.h
>

98 #iâdeà
__ASSEMBLY__


101 
	#__ARCH_HAS_SA_RESTORER


	)

103 #ifdeà
__i386__


106 
	ssigaùiÚ
 {

108 
__sighªdËr_t
 
	m_§_hªdËr
;

109 (*
	m_§_sigaùiÚ
)(, 
	msigšfo
 *, *);

110 } 
	m_u
;

111 
sig£t_t
 
	m§_mask
;

112 
	m§_æags
;

113 (*
	m§_»¡Ü”
)();

116 
	#§_hªdËr
 
_u
.
_§_hªdËr


	)

117 
	#§_sigaùiÚ
 
_u
.
_§_sigaùiÚ


	)

121 
	ssigaùiÚ
 {

122 
__sighªdËr_t
 
	m§_hªdËr
;

123 
	m§_æags
;

124 
__sig»¡Üe_t
 
	m§_»¡Ü”
;

125 
sig£t_t
 
	m§_mask
;

128 
	sk_sigaùiÚ
 {

129 
sigaùiÚ
 
	m§
;

134 
	ssig®t¡ack
 {

135 *
	mss_¥
;

136 
	mss_æags
;

137 
size_t
 
	mss_size
;

138 } 
	t¡ack_t
;

	@/usr/include/asm/types.h

1 #iâdeà
_ASM_X86_TYPES_H


2 
	#_ASM_X86_TYPES_H


	)

4 
	~<asm-g’”ic/ty³s.h
>

	@/usr/include/asm/unistd_32.h

1 #iâdeà
_ASM_X86_UNISTD_32_H


2 
	#_ASM_X86_UNISTD_32_H


	)

8 
	#__NR_»¡¬t_sysÿÎ
 0

	)

9 
	#__NR_ex™
 1

	)

10 
	#__NR_fÜk
 2

	)

11 
	#__NR_»ad
 3

	)

12 
	#__NR_wr™e
 4

	)

13 
	#__NR_İ’
 5

	)

14 
	#__NR_şo£
 6

	)

15 
	#__NR_wa™pid
 7

	)

16 
	#__NR_ü—t
 8

	)

17 
	#__NR_lšk
 9

	)

18 
	#__NR_uÆšk
 10

	)

19 
	#__NR_execve
 11

	)

20 
	#__NR_chdœ
 12

	)

21 
	#__NR_time
 13

	)

22 
	#__NR_mknod
 14

	)

23 
	#__NR_chmod
 15

	)

24 
	#__NR_lchown
 16

	)

25 
	#__NR_b»ak
 17

	)

26 
	#__NR_Şd¡©
 18

	)

27 
	#__NR_l£ek
 19

	)

28 
	#__NR_g‘pid
 20

	)

29 
	#__NR_mouÁ
 21

	)

30 
	#__NR_umouÁ
 22

	)

31 
	#__NR_£tuid
 23

	)

32 
	#__NR_g‘uid
 24

	)

33 
	#__NR_¡ime
 25

	)

34 
	#__NR_±¿û
 26

	)

35 
	#__NR_®¬m
 27

	)

36 
	#__NR_Şdf¡©
 28

	)

37 
	#__NR_·u£
 29

	)

38 
	#__NR_utime
 30

	)

39 
	#__NR_¡ty
 31

	)

40 
	#__NR_g‰y
 32

	)

41 
	#__NR_acûss
 33

	)

42 
	#__NR_niû
 34

	)

43 
	#__NR_áime
 35

	)

44 
	#__NR_sync
 36

	)

45 
	#__NR_kl
 37

	)

46 
	#__NR_»Çme
 38

	)

47 
	#__NR_mkdœ
 39

	)

48 
	#__NR_rmdœ
 40

	)

49 
	#__NR_dup
 41

	)

50 
	#__NR_pe
 42

	)

51 
	#__NR_times
 43

	)

52 
	#__NR_´of
 44

	)

53 
	#__NR_brk
 45

	)

54 
	#__NR_£tgid
 46

	)

55 
	#__NR_g‘gid
 47

	)

56 
	#__NR_sigÇl
 48

	)

57 
	#__NR_g‘euid
 49

	)

58 
	#__NR_g‘egid
 50

	)

59 
	#__NR_acù
 51

	)

60 
	#__NR_umouÁ2
 52

	)

61 
	#__NR_lock
 53

	)

62 
	#__NR_ioùl
 54

	)

63 
	#__NR_fú
 55

	)

64 
	#__NR_mpx
 56

	)

65 
	#__NR_£gid
 57

	)

66 
	#__NR_ulim™
 58

	)

67 
	#__NR_ŞdŞduÇme
 59

	)

68 
	#__NR_umask
 60

	)

69 
	#__NR_chroÙ
 61

	)

70 
	#__NR_u¡©
 62

	)

71 
	#__NR_dup2
 63

	)

72 
	#__NR_g‘µid
 64

	)

73 
	#__NR_g‘pg½
 65

	)

74 
	#__NR_£tsid
 66

	)

75 
	#__NR_sigaùiÚ
 67

	)

76 
	#__NR_sg‘mask
 68

	)

77 
	#__NR_s£tmask
 69

	)

78 
	#__NR_£Œeuid
 70

	)

79 
	#__NR_£Œegid
 71

	)

80 
	#__NR_sigsu¥’d
 72

	)

81 
	#__NR_sig³ndšg
 73

	)

82 
	#__NR_£tho¡Çme
 74

	)

83 
	#__NR_£Œlim™
 75

	)

84 
	#__NR_g‘¾im™
 76

	)

85 
	#__NR_g‘ru§ge
 77

	)

86 
	#__NR_g‘timeofday
 78

	)

87 
	#__NR_£‰imeofday
 79

	)

88 
	#__NR_g‘groups
 80

	)

89 
	#__NR_£tgroups
 81

	)

90 
	#__NR_£Ëù
 82

	)

91 
	#__NR_symlšk
 83

	)

92 
	#__NR_Şdl¡©
 84

	)

93 
	#__NR_»adlšk
 85

	)

94 
	#__NR_u£lib
 86

	)

95 
	#__NR_sw­Ú
 87

	)

96 
	#__NR_»boÙ
 88

	)

97 
	#__NR_»addœ
 89

	)

98 
	#__NR_mm­
 90

	)

99 
	#__NR_munm­
 91

	)

100 
	#__NR_Œunÿ‹
 92

	)

101 
	#__NR_árunÿ‹
 93

	)

102 
	#__NR_fchmod
 94

	)

103 
	#__NR_fchown
 95

	)

104 
	#__NR_g‘´iÜ™y
 96

	)

105 
	#__NR_£riÜ™y
 97

	)

106 
	#__NR_´of
 98

	)

107 
	#__NR_¡©fs
 99

	)

108 
	#__NR_f¡©fs
 100

	)

109 
	#__NR_iİ”m
 101

	)

110 
	#__NR_sock‘ÿÎ
 102

	)

111 
	#__NR_sy¦og
 103

	)

112 
	#__NR_£t™im”
 104

	)

113 
	#__NR_g‘™im”
 105

	)

114 
	#__NR_¡©
 106

	)

115 
	#__NR_l¡©
 107

	)

116 
	#__NR_f¡©
 108

	)

117 
	#__NR_ŞduÇme
 109

	)

118 
	#__NR_iİl
 110

	)

119 
	#__NR_vhªgup
 111

	)

120 
	#__NR_idË
 112

	)

121 
	#__NR_vm86Şd
 113

	)

122 
	#__NR_wa™4
 114

	)

123 
	#__NR_sw­off
 115

	)

124 
	#__NR_sysšfo
 116

	)

125 
	#__NR_c
 117

	)

126 
	#__NR_fsync
 118

	)

127 
	#__NR_sig»tuº
 119

	)

128 
	#__NR_şÚe
 120

	)

129 
	#__NR_£tdomašÇme
 121

	)

130 
	#__NR_uÇme
 122

	)

131 
	#__NR_modify_ldt
 123

	)

132 
	#__NR_adjtimex
 124

	)

133 
	#__NR_m´Ùeù
 125

	)

134 
	#__NR_sig´ocmask
 126

	)

135 
	#__NR_ü—‹_moduË
 127

	)

136 
	#__NR_š™_moduË
 128

	)

137 
	#__NR_d–‘e_moduË
 129

	)

138 
	#__NR_g‘_k”Ãl_syms
 130

	)

139 
	#__NR_quÙaùl
 131

	)

140 
	#__NR_g‘pgid
 132

	)

141 
	#__NR_fchdœ
 133

	)

142 
	#__NR_bdæush
 134

	)

143 
	#__NR_sysfs
 135

	)

144 
	#__NR_³rsÚ®™y
 136

	)

145 
	#__NR_afs_sysÿÎ
 137

	)

146 
	#__NR_£tfsuid
 138

	)

147 
	#__NR_£tfsgid
 139

	)

148 
	#__NR__Î£ek
 140

	)

149 
	#__NR_g‘d’ts
 141

	)

150 
	#__NR__Ãw£Ëù
 142

	)

151 
	#__NR_æock
 143

	)

152 
	#__NR_msync
 144

	)

153 
	#__NR_»adv
 145

	)

154 
	#__NR_wr™ev
 146

	)

155 
	#__NR_g‘sid
 147

	)

156 
	#__NR_fd©async
 148

	)

157 
	#__NR__sysùl
 149

	)

158 
	#__NR_mlock
 150

	)

159 
	#__NR_muÆock
 151

	)

160 
	#__NR_mlock®l
 152

	)

161 
	#__NR_muÆock®l
 153

	)

162 
	#__NR_sched_£¬am
 154

	)

163 
	#__NR_sched_g‘·¿m
 155

	)

164 
	#__NR_sched_£tscheduËr
 156

	)

165 
	#__NR_sched_g‘scheduËr
 157

	)

166 
	#__NR_sched_y›ld
 158

	)

167 
	#__NR_sched_g‘_´iÜ™y_max
 159

	)

168 
	#__NR_sched_g‘_´iÜ™y_mš
 160

	)

169 
	#__NR_sched_¼_g‘_š‹rv®
 161

	)

170 
	#__NR_Çno¦“p
 162

	)

171 
	#__NR_m»m­
 163

	)

172 
	#__NR_£Œesuid
 164

	)

173 
	#__NR_g‘»suid
 165

	)

174 
	#__NR_vm86
 166

	)

175 
	#__NR_qu”y_moduË
 167

	)

176 
	#__NR_pŞl
 168

	)

177 
	#__NR_nfs£rvùl
 169

	)

178 
	#__NR_£Œesgid
 170

	)

179 
	#__NR_g‘»sgid
 171

	)

180 
	#__NR_´ùl
 172

	)

181 
	#__NR_¹_sig»tuº
 173

	)

182 
	#__NR_¹_sigaùiÚ
 174

	)

183 
	#__NR_¹_sig´ocmask
 175

	)

184 
	#__NR_¹_sig³ndšg
 176

	)

185 
	#__NR_¹_sigtimedwa™
 177

	)

186 
	#__NR_¹_sigqueuešfo
 178

	)

187 
	#__NR_¹_sigsu¥’d
 179

	)

188 
	#__NR_´—d64
 180

	)

189 
	#__NR_pwr™e64
 181

	)

190 
	#__NR_chown
 182

	)

191 
	#__NR_g‘cwd
 183

	)

192 
	#__NR_ÿpg‘
 184

	)

193 
	#__NR_ÿp£t
 185

	)

194 
	#__NR_sig®t¡ack
 186

	)

195 
	#__NR_£ndfe
 187

	)

196 
	#__NR_g‘pmsg
 188

	)

197 
	#__NR_pumsg
 189

	)

198 
	#__NR_vfÜk
 190

	)

199 
	#__NR_ug‘¾im™
 191

	)

200 
	#__NR_mm­2
 192

	)

201 
	#__NR_Œunÿ‹64
 193

	)

202 
	#__NR_árunÿ‹64
 194

	)

203 
	#__NR_¡©64
 195

	)

204 
	#__NR_l¡©64
 196

	)

205 
	#__NR_f¡©64
 197

	)

206 
	#__NR_lchown32
 198

	)

207 
	#__NR_g‘uid32
 199

	)

208 
	#__NR_g‘gid32
 200

	)

209 
	#__NR_g‘euid32
 201

	)

210 
	#__NR_g‘egid32
 202

	)

211 
	#__NR_£Œeuid32
 203

	)

212 
	#__NR_£Œegid32
 204

	)

213 
	#__NR_g‘groups32
 205

	)

214 
	#__NR_£tgroups32
 206

	)

215 
	#__NR_fchown32
 207

	)

216 
	#__NR_£Œesuid32
 208

	)

217 
	#__NR_g‘»suid32
 209

	)

218 
	#__NR_£Œesgid32
 210

	)

219 
	#__NR_g‘»sgid32
 211

	)

220 
	#__NR_chown32
 212

	)

221 
	#__NR_£tuid32
 213

	)

222 
	#__NR_£tgid32
 214

	)

223 
	#__NR_£tfsuid32
 215

	)

224 
	#__NR_£tfsgid32
 216

	)

225 
	#__NR_pivÙ_roÙ
 217

	)

226 
	#__NR_mšcÜe
 218

	)

227 
	#__NR_madvi£
 219

	)

228 
	#__NR_madvi£1
 219

	)

229 
	#__NR_g‘d’ts64
 220

	)

230 
	#__NR_fú64
 221

	)

232 
	#__NR_g‘tid
 224

	)

233 
	#__NR_»adah—d
 225

	)

234 
	#__NR_£tx©Œ
 226

	)

235 
	#__NR_l£tx©Œ
 227

	)

236 
	#__NR_f£tx©Œ
 228

	)

237 
	#__NR_g‘x©Œ
 229

	)

238 
	#__NR_lg‘x©Œ
 230

	)

239 
	#__NR_fg‘x©Œ
 231

	)

240 
	#__NR_li¡x©Œ
 232

	)

241 
	#__NR_Îi¡x©Œ
 233

	)

242 
	#__NR_æi¡x©Œ
 234

	)

243 
	#__NR_»movex©Œ
 235

	)

244 
	#__NR_Ìemovex©Œ
 236

	)

245 
	#__NR_äemovex©Œ
 237

	)

246 
	#__NR_tkl
 238

	)

247 
	#__NR_£ndfe64
 239

	)

248 
	#__NR_fu‹x
 240

	)

249 
	#__NR_sched_£ffš™y
 241

	)

250 
	#__NR_sched_g‘affš™y
 242

	)

251 
	#__NR_£t_th»ad_¬—
 243

	)

252 
	#__NR_g‘_th»ad_¬—
 244

	)

253 
	#__NR_io_£tup
 245

	)

254 
	#__NR_io_de¡roy
 246

	)

255 
	#__NR_io_g‘ev’ts
 247

	)

256 
	#__NR_io_subm™
 248

	)

257 
	#__NR_io_ÿnûl
 249

	)

258 
	#__NR_çdvi£64
 250

	)

260 
	#__NR_ex™_group
 252

	)

261 
	#__NR_lookup_dcook›
 253

	)

262 
	#__NR_•Şl_ü—‹
 254

	)

263 
	#__NR_•Şl_ùl
 255

	)

264 
	#__NR_•Şl_wa™
 256

	)

265 
	#__NR_»m­_fe_·ges
 257

	)

266 
	#__NR_£t_tid_add»ss
 258

	)

267 
	#__NR_tim”_ü—‹
 259

	)

268 
	#__NR_tim”_£‰ime
 (
__NR_tim”_ü—‹
+1)

	)

269 
	#__NR_tim”_g‘time
 (
__NR_tim”_ü—‹
+2)

	)

270 
	#__NR_tim”_g‘ov”run
 (
__NR_tim”_ü—‹
+3)

	)

271 
	#__NR_tim”_d–‘e
 (
__NR_tim”_ü—‹
+4)

	)

272 
	#__NR_şock_£‰ime
 (
__NR_tim”_ü—‹
+5)

	)

273 
	#__NR_şock_g‘time
 (
__NR_tim”_ü—‹
+6)

	)

274 
	#__NR_şock_g‘»s
 (
__NR_tim”_ü—‹
+7)

	)

275 
	#__NR_şock_Çno¦“p
 (
__NR_tim”_ü—‹
+8)

	)

276 
	#__NR_¡©fs64
 268

	)

277 
	#__NR_f¡©fs64
 269

	)

278 
	#__NR_tgkl
 270

	)

279 
	#__NR_utimes
 271

	)

280 
	#__NR_çdvi£64_64
 272

	)

281 
	#__NR_v£rv”
 273

	)

282 
	#__NR_mbšd
 274

	)

283 
	#__NR_g‘_mempŞicy
 275

	)

284 
	#__NR_£t_mempŞicy
 276

	)

285 
	#__NR_mq_İ’
 277

	)

286 
	#__NR_mq_uÆšk
 (
__NR_mq_İ’
+1)

	)

287 
	#__NR_mq_timed£nd
 (
__NR_mq_İ’
+2)

	)

288 
	#__NR_mq_timed»ûive
 (
__NR_mq_İ’
+3)

	)

289 
	#__NR_mq_nÙify
 (
__NR_mq_İ’
+4)

	)

290 
	#__NR_mq_g‘£‰r
 (
__NR_mq_İ’
+5)

	)

291 
	#__NR_kexec_lßd
 283

	)

292 
	#__NR_wa™id
 284

	)

294 
	#__NR_add_key
 286

	)

295 
	#__NR_»que¡_key
 287

	)

296 
	#__NR_keyùl
 288

	)

297 
	#__NR_iİrio_£t
 289

	)

298 
	#__NR_iİrio_g‘
 290

	)

299 
	#__NR_šÙify_š™
 291

	)

300 
	#__NR_šÙify_add_w©ch
 292

	)

301 
	#__NR_šÙify_rm_w©ch
 293

	)

302 
	#__NR_mig¿‹_·ges
 294

	)

303 
	#__NR_İ’©
 295

	)

304 
	#__NR_mkdœ©
 296

	)

305 
	#__NR_mknod©
 297

	)

306 
	#__NR_fchowÇt
 298

	)

307 
	#__NR_futime§t
 299

	)

308 
	#__NR_f¡©©64
 300

	)

309 
	#__NR_uÆšk©
 301

	)

310 
	#__NR_»Çm—t
 302

	)

311 
	#__NR_lšk©
 303

	)

312 
	#__NR_symlšk©
 304

	)

313 
	#__NR_»adlšk©
 305

	)

314 
	#__NR_fchmod©
 306

	)

315 
	#__NR_çcûs§t
 307

	)

316 
	#__NR_p£Ëù6
 308

	)

317 
	#__NR_µŞl
 309

	)

318 
	#__NR_unsh¬e
 310

	)

319 
	#__NR_£t_robu¡_li¡
 311

	)

320 
	#__NR_g‘_robu¡_li¡
 312

	)

321 
	#__NR_¥liû
 313

	)

322 
	#__NR_sync_fe_¿nge
 314

	)

323 
	#__NR_‹e
 315

	)

324 
	#__NR_vm¥liû
 316

	)

325 
	#__NR_move_·ges
 317

	)

326 
	#__NR_g‘ıu
 318

	)

327 
	#__NR_•Şl_pwa™
 319

	)

328 
	#__NR_utim’§t
 320

	)

329 
	#__NR_sigÇlfd
 321

	)

330 
	#__NR_tim”fd_ü—‹
 322

	)

331 
	#__NR_ev’tfd
 323

	)

332 
	#__NR_çÎoÿ‹
 324

	)

333 
	#__NR_tim”fd_£‰ime
 325

	)

334 
	#__NR_tim”fd_g‘time
 326

	)

335 
	#__NR_sigÇlfd4
 327

	)

336 
	#__NR_ev’tfd2
 328

	)

337 
	#__NR_•Şl_ü—‹1
 329

	)

338 
	#__NR_dup3
 330

	)

339 
	#__NR_pe2
 331

	)

340 
	#__NR_šÙify_š™1
 332

	)

341 
	#__NR_´—dv
 333

	)

342 
	#__NR_pwr™ev
 334

	)

343 
	#__NR_¹_tgsigqueuešfo
 335

	)

344 
	#__NR_³rf_ev’t_İ’
 336

	)

345 
	#__NR_»cvmmsg
 337

	)

346 
	#__NR_çnÙify_š™
 338

	)

347 
	#__NR_çnÙify_m¬k
 339

	)

348 
	#__NR_´lim™64
 340

	)

349 
	#__NR_Çme_to_hªdË_©
 341

	)

350 
	#__NR_İ’_by_hªdË_©
 342

	)

351 
	#__NR_şock_adjtime
 343

	)

352 
	#__NR_syncfs
 344

	)

353 
	#__NR_£ndmmsg
 345

	)

354 
	#__NR_£Šs
 346

	)

355 
	#__NR_´oûss_vm_»adv
 347

	)

356 
	#__NR_´oûss_vm_wr™ev
 348

	)

	@/usr/include/asm/unistd_64.h

1 #iâdeà
_ASM_X86_UNISTD_64_H


2 
	#_ASM_X86_UNISTD_64_H


	)

4 #iâdeà
__SYSCALL


5 
	#__SYSCALL
(
a
, 
b
)

	)

15 
	#__NR_»ad
 0

	)

16 
	$__SYSCALL
(
__NR_»ad
, 
sys_»ad
)

17 
	#__NR_wr™e
 1

	)

18 
	$__SYSCALL
(
__NR_wr™e
, 
sys_wr™e
)

19 
	#__NR_İ’
 2

	)

20 
	$__SYSCALL
(
__NR_İ’
, 
sys_İ’
)

21 
	#__NR_şo£
 3

	)

22 
	$__SYSCALL
(
__NR_şo£
, 
sys_şo£
)

23 
	#__NR_¡©
 4

	)

24 
	$__SYSCALL
(
__NR_¡©
, 
sys_Ãw¡©
)

25 
	#__NR_f¡©
 5

	)

26 
	$__SYSCALL
(
__NR_f¡©
, 
sys_Ãwf¡©
)

27 
	#__NR_l¡©
 6

	)

28 
	$__SYSCALL
(
__NR_l¡©
, 
sys_Ãwl¡©
)

29 
	#__NR_pŞl
 7

	)

30 
	$__SYSCALL
(
__NR_pŞl
, 
sys_pŞl
)

32 
	#__NR_l£ek
 8

	)

33 
	$__SYSCALL
(
__NR_l£ek
, 
sys_l£ek
)

34 
	#__NR_mm­
 9

	)

35 
	$__SYSCALL
(
__NR_mm­
, 
sys_mm­
)

36 
	#__NR_m´Ùeù
 10

	)

37 
	$__SYSCALL
(
__NR_m´Ùeù
, 
sys_m´Ùeù
)

38 
	#__NR_munm­
 11

	)

39 
	$__SYSCALL
(
__NR_munm­
, 
sys_munm­
)

40 
	#__NR_brk
 12

	)

41 
	$__SYSCALL
(
__NR_brk
, 
sys_brk
)

42 
	#__NR_¹_sigaùiÚ
 13

	)

43 
	$__SYSCALL
(
__NR_¹_sigaùiÚ
, 
sys_¹_sigaùiÚ
)

44 
	#__NR_¹_sig´ocmask
 14

	)

45 
	$__SYSCALL
(
__NR_¹_sig´ocmask
, 
sys_¹_sig´ocmask
)

46 
	#__NR_¹_sig»tuº
 15

	)

47 
	$__SYSCALL
(
__NR_¹_sig»tuº
, 
¡ub_¹_sig»tuº
)

49 
	#__NR_ioùl
 16

	)

50 
	$__SYSCALL
(
__NR_ioùl
, 
sys_ioùl
)

51 
	#__NR_´—d64
 17

	)

52 
	$__SYSCALL
(
__NR_´—d64
, 
sys_´—d64
)

53 
	#__NR_pwr™e64
 18

	)

54 
	$__SYSCALL
(
__NR_pwr™e64
, 
sys_pwr™e64
)

55 
	#__NR_»adv
 19

	)

56 
	$__SYSCALL
(
__NR_»adv
, 
sys_»adv
)

57 
	#__NR_wr™ev
 20

	)

58 
	$__SYSCALL
(
__NR_wr™ev
, 
sys_wr™ev
)

59 
	#__NR_acûss
 21

	)

60 
	$__SYSCALL
(
__NR_acûss
, 
sys_acûss
)

61 
	#__NR_pe
 22

	)

62 
	$__SYSCALL
(
__NR_pe
, 
sys_pe
)

63 
	#__NR_£Ëù
 23

	)

64 
	$__SYSCALL
(
__NR_£Ëù
, 
sys_£Ëù
)

66 
	#__NR_sched_y›ld
 24

	)

67 
	$__SYSCALL
(
__NR_sched_y›ld
, 
sys_sched_y›ld
)

68 
	#__NR_m»m­
 25

	)

69 
	$__SYSCALL
(
__NR_m»m­
, 
sys_m»m­
)

70 
	#__NR_msync
 26

	)

71 
	$__SYSCALL
(
__NR_msync
, 
sys_msync
)

72 
	#__NR_mšcÜe
 27

	)

73 
	$__SYSCALL
(
__NR_mšcÜe
, 
sys_mšcÜe
)

74 
	#__NR_madvi£
 28

	)

75 
	$__SYSCALL
(
__NR_madvi£
, 
sys_madvi£
)

76 
	#__NR_shmg‘
 29

	)

77 
	$__SYSCALL
(
__NR_shmg‘
, 
sys_shmg‘
)

78 
	#__NR_shm©
 30

	)

79 
	$__SYSCALL
(
__NR_shm©
, 
sys_shm©
)

80 
	#__NR_shmùl
 31

	)

81 
	$__SYSCALL
(
__NR_shmùl
, 
sys_shmùl
)

83 
	#__NR_dup
 32

	)

84 
	$__SYSCALL
(
__NR_dup
, 
sys_dup
)

85 
	#__NR_dup2
 33

	)

86 
	$__SYSCALL
(
__NR_dup2
, 
sys_dup2
)

87 
	#__NR_·u£
 34

	)

88 
	$__SYSCALL
(
__NR_·u£
, 
sys_·u£
)

89 
	#__NR_Çno¦“p
 35

	)

90 
	$__SYSCALL
(
__NR_Çno¦“p
, 
sys_Çno¦“p
)

91 
	#__NR_g‘™im”
 36

	)

92 
	$__SYSCALL
(
__NR_g‘™im”
, 
sys_g‘™im”
)

93 
	#__NR_®¬m
 37

	)

94 
	$__SYSCALL
(
__NR_®¬m
, 
sys_®¬m
)

95 
	#__NR_£t™im”
 38

	)

96 
	$__SYSCALL
(
__NR_£t™im”
, 
sys_£t™im”
)

97 
	#__NR_g‘pid
 39

	)

98 
	$__SYSCALL
(
__NR_g‘pid
, 
sys_g‘pid
)

100 
	#__NR_£ndfe
 40

	)

101 
	$__SYSCALL
(
__NR_£ndfe
, 
sys_£ndfe64
)

102 
	#__NR_sock‘
 41

	)

103 
	$__SYSCALL
(
__NR_sock‘
, 
sys_sock‘
)

104 
	#__NR_cÚÃù
 42

	)

105 
	$__SYSCALL
(
__NR_cÚÃù
, 
sys_cÚÃù
)

106 
	#__NR_acû±
 43

	)

107 
	$__SYSCALL
(
__NR_acû±
, 
sys_acû±
)

108 
	#__NR_£ndto
 44

	)

109 
	$__SYSCALL
(
__NR_£ndto
, 
sys_£ndto
)

110 
	#__NR_»cväom
 45

	)

111 
	$__SYSCALL
(
__NR_»cväom
, 
sys_»cväom
)

112 
	#__NR_£ndmsg
 46

	)

113 
	$__SYSCALL
(
__NR_£ndmsg
, 
sys_£ndmsg
)

114 
	#__NR_»cvmsg
 47

	)

115 
	$__SYSCALL
(
__NR_»cvmsg
, 
sys_»cvmsg
)

117 
	#__NR_shutdown
 48

	)

118 
	$__SYSCALL
(
__NR_shutdown
, 
sys_shutdown
)

119 
	#__NR_bšd
 49

	)

120 
	$__SYSCALL
(
__NR_bšd
, 
sys_bšd
)

121 
	#__NR_li¡’
 50

	)

122 
	$__SYSCALL
(
__NR_li¡’
, 
sys_li¡’
)

123 
	#__NR_g‘sockÇme
 51

	)

124 
	$__SYSCALL
(
__NR_g‘sockÇme
, 
sys_g‘sockÇme
)

125 
	#__NR_g‘³”Çme
 52

	)

126 
	$__SYSCALL
(
__NR_g‘³”Çme
, 
sys_g‘³”Çme
)

127 
	#__NR_sock‘·œ
 53

	)

128 
	$__SYSCALL
(
__NR_sock‘·œ
, 
sys_sock‘·œ
)

129 
	#__NR_£tsockİt
 54

	)

130 
	$__SYSCALL
(
__NR_£tsockİt
, 
sys_£tsockİt
)

131 
	#__NR_g‘sockİt
 55

	)

132 
	$__SYSCALL
(
__NR_g‘sockİt
, 
sys_g‘sockİt
)

134 
	#__NR_şÚe
 56

	)

135 
	$__SYSCALL
(
__NR_şÚe
, 
¡ub_şÚe
)

136 
	#__NR_fÜk
 57

	)

137 
	$__SYSCALL
(
__NR_fÜk
, 
¡ub_fÜk
)

138 
	#__NR_vfÜk
 58

	)

139 
	$__SYSCALL
(
__NR_vfÜk
, 
¡ub_vfÜk
)

140 
	#__NR_execve
 59

	)

141 
	$__SYSCALL
(
__NR_execve
, 
¡ub_execve
)

142 
	#__NR_ex™
 60

	)

143 
	$__SYSCALL
(
__NR_ex™
, 
sys_ex™
)

144 
	#__NR_wa™4
 61

	)

145 
	$__SYSCALL
(
__NR_wa™4
, 
sys_wa™4
)

146 
	#__NR_kl
 62

	)

147 
	$__SYSCALL
(
__NR_kl
, 
sys_kl
)

148 
	#__NR_uÇme
 63

	)

149 
	$__SYSCALL
(
__NR_uÇme
, 
sys_ÃwuÇme
)

151 
	#__NR_£mg‘
 64

	)

152 
	$__SYSCALL
(
__NR_£mg‘
, 
sys_£mg‘
)

153 
	#__NR_£mİ
 65

	)

154 
	$__SYSCALL
(
__NR_£mİ
, 
sys_£mİ
)

155 
	#__NR_£mùl
 66

	)

156 
	$__SYSCALL
(
__NR_£mùl
, 
sys_£mùl
)

157 
	#__NR_shmdt
 67

	)

158 
	$__SYSCALL
(
__NR_shmdt
, 
sys_shmdt
)

159 
	#__NR_msgg‘
 68

	)

160 
	$__SYSCALL
(
__NR_msgg‘
, 
sys_msgg‘
)

161 
	#__NR_msg¢d
 69

	)

162 
	$__SYSCALL
(
__NR_msg¢d
, 
sys_msg¢d
)

163 
	#__NR_msgrcv
 70

	)

164 
	$__SYSCALL
(
__NR_msgrcv
, 
sys_msgrcv
)

165 
	#__NR_msgùl
 71

	)

166 
	$__SYSCALL
(
__NR_msgùl
, 
sys_msgùl
)

168 
	#__NR_fú
 72

	)

169 
	$__SYSCALL
(
__NR_fú
, 
sys_fú
)

170 
	#__NR_æock
 73

	)

171 
	$__SYSCALL
(
__NR_æock
, 
sys_æock
)

172 
	#__NR_fsync
 74

	)

173 
	$__SYSCALL
(
__NR_fsync
, 
sys_fsync
)

174 
	#__NR_fd©async
 75

	)

175 
	$__SYSCALL
(
__NR_fd©async
, 
sys_fd©async
)

176 
	#__NR_Œunÿ‹
 76

	)

177 
	$__SYSCALL
(
__NR_Œunÿ‹
, 
sys_Œunÿ‹
)

178 
	#__NR_árunÿ‹
 77

	)

179 
	$__SYSCALL
(
__NR_árunÿ‹
, 
sys_árunÿ‹
)

180 
	#__NR_g‘d’ts
 78

	)

181 
	$__SYSCALL
(
__NR_g‘d’ts
, 
sys_g‘d’ts
)

182 
	#__NR_g‘cwd
 79

	)

183 
	$__SYSCALL
(
__NR_g‘cwd
, 
sys_g‘cwd
)

185 
	#__NR_chdœ
 80

	)

186 
	$__SYSCALL
(
__NR_chdœ
, 
sys_chdœ
)

187 
	#__NR_fchdœ
 81

	)

188 
	$__SYSCALL
(
__NR_fchdœ
, 
sys_fchdœ
)

189 
	#__NR_»Çme
 82

	)

190 
	$__SYSCALL
(
__NR_»Çme
, 
sys_»Çme
)

191 
	#__NR_mkdœ
 83

	)

192 
	$__SYSCALL
(
__NR_mkdœ
, 
sys_mkdœ
)

193 
	#__NR_rmdœ
 84

	)

194 
	$__SYSCALL
(
__NR_rmdœ
, 
sys_rmdœ
)

195 
	#__NR_ü—t
 85

	)

196 
	$__SYSCALL
(
__NR_ü—t
, 
sys_ü—t
)

197 
	#__NR_lšk
 86

	)

198 
	$__SYSCALL
(
__NR_lšk
, 
sys_lšk
)

199 
	#__NR_uÆšk
 87

	)

200 
	$__SYSCALL
(
__NR_uÆšk
, 
sys_uÆšk
)

202 
	#__NR_symlšk
 88

	)

203 
	$__SYSCALL
(
__NR_symlšk
, 
sys_symlšk
)

204 
	#__NR_»adlšk
 89

	)

205 
	$__SYSCALL
(
__NR_»adlšk
, 
sys_»adlšk
)

206 
	#__NR_chmod
 90

	)

207 
	$__SYSCALL
(
__NR_chmod
, 
sys_chmod
)

208 
	#__NR_fchmod
 91

	)

209 
	$__SYSCALL
(
__NR_fchmod
, 
sys_fchmod
)

210 
	#__NR_chown
 92

	)

211 
	$__SYSCALL
(
__NR_chown
, 
sys_chown
)

212 
	#__NR_fchown
 93

	)

213 
	$__SYSCALL
(
__NR_fchown
, 
sys_fchown
)

214 
	#__NR_lchown
 94

	)

215 
	$__SYSCALL
(
__NR_lchown
, 
sys_lchown
)

216 
	#__NR_umask
 95

	)

217 
	$__SYSCALL
(
__NR_umask
, 
sys_umask
)

219 
	#__NR_g‘timeofday
 96

	)

220 
	$__SYSCALL
(
__NR_g‘timeofday
, 
sys_g‘timeofday
)

221 
	#__NR_g‘¾im™
 97

	)

222 
	$__SYSCALL
(
__NR_g‘¾im™
, 
sys_g‘¾im™
)

223 
	#__NR_g‘ru§ge
 98

	)

224 
	$__SYSCALL
(
__NR_g‘ru§ge
, 
sys_g‘ru§ge
)

225 
	#__NR_sysšfo
 99

	)

226 
	$__SYSCALL
(
__NR_sysšfo
, 
sys_sysšfo
)

227 
	#__NR_times
 100

	)

228 
	$__SYSCALL
(
__NR_times
, 
sys_times
)

229 
	#__NR_±¿û
 101

	)

230 
	$__SYSCALL
(
__NR_±¿û
, 
sys_±¿û
)

231 
	#__NR_g‘uid
 102

	)

232 
	$__SYSCALL
(
__NR_g‘uid
, 
sys_g‘uid
)

233 
	#__NR_sy¦og
 103

	)

234 
	$__SYSCALL
(
__NR_sy¦og
, 
sys_sy¦og
)

237 
	#__NR_g‘gid
 104

	)

238 
	$__SYSCALL
(
__NR_g‘gid
, 
sys_g‘gid
)

239 
	#__NR_£tuid
 105

	)

240 
	$__SYSCALL
(
__NR_£tuid
, 
sys_£tuid
)

241 
	#__NR_£tgid
 106

	)

242 
	$__SYSCALL
(
__NR_£tgid
, 
sys_£tgid
)

243 
	#__NR_g‘euid
 107

	)

244 
	$__SYSCALL
(
__NR_g‘euid
, 
sys_g‘euid
)

245 
	#__NR_g‘egid
 108

	)

246 
	$__SYSCALL
(
__NR_g‘egid
, 
sys_g‘egid
)

247 
	#__NR_£gid
 109

	)

248 
	$__SYSCALL
(
__NR_£gid
, 
sys_£gid
)

249 
	#__NR_g‘µid
 110

	)

250 
	$__SYSCALL
(
__NR_g‘µid
, 
sys_g‘µid
)

251 
	#__NR_g‘pg½
 111

	)

252 
	$__SYSCALL
(
__NR_g‘pg½
, 
sys_g‘pg½
)

254 
	#__NR_£tsid
 112

	)

255 
	$__SYSCALL
(
__NR_£tsid
, 
sys_£tsid
)

256 
	#__NR_£Œeuid
 113

	)

257 
	$__SYSCALL
(
__NR_£Œeuid
, 
sys_£Œeuid
)

258 
	#__NR_£Œegid
 114

	)

259 
	$__SYSCALL
(
__NR_£Œegid
, 
sys_£Œegid
)

260 
	#__NR_g‘groups
 115

	)

261 
	$__SYSCALL
(
__NR_g‘groups
, 
sys_g‘groups
)

262 
	#__NR_£tgroups
 116

	)

263 
	$__SYSCALL
(
__NR_£tgroups
, 
sys_£tgroups
)

264 
	#__NR_£Œesuid
 117

	)

265 
	$__SYSCALL
(
__NR_£Œesuid
, 
sys_£Œesuid
)

266 
	#__NR_g‘»suid
 118

	)

267 
	$__SYSCALL
(
__NR_g‘»suid
, 
sys_g‘»suid
)

268 
	#__NR_£Œesgid
 119

	)

269 
	$__SYSCALL
(
__NR_£Œesgid
, 
sys_£Œesgid
)

271 
	#__NR_g‘»sgid
 120

	)

272 
	$__SYSCALL
(
__NR_g‘»sgid
, 
sys_g‘»sgid
)

273 
	#__NR_g‘pgid
 121

	)

274 
	$__SYSCALL
(
__NR_g‘pgid
, 
sys_g‘pgid
)

275 
	#__NR_£tfsuid
 122

	)

276 
	$__SYSCALL
(
__NR_£tfsuid
, 
sys_£tfsuid
)

277 
	#__NR_£tfsgid
 123

	)

278 
	$__SYSCALL
(
__NR_£tfsgid
, 
sys_£tfsgid
)

279 
	#__NR_g‘sid
 124

	)

280 
	$__SYSCALL
(
__NR_g‘sid
, 
sys_g‘sid
)

281 
	#__NR_ÿpg‘
 125

	)

282 
	$__SYSCALL
(
__NR_ÿpg‘
, 
sys_ÿpg‘
)

283 
	#__NR_ÿp£t
 126

	)

284 
	$__SYSCALL
(
__NR_ÿp£t
, 
sys_ÿp£t
)

286 
	#__NR_¹_sig³ndšg
 127

	)

287 
	$__SYSCALL
(
__NR_¹_sig³ndšg
, 
sys_¹_sig³ndšg
)

288 
	#__NR_¹_sigtimedwa™
 128

	)

289 
	$__SYSCALL
(
__NR_¹_sigtimedwa™
, 
sys_¹_sigtimedwa™
)

290 
	#__NR_¹_sigqueuešfo
 129

	)

291 
	$__SYSCALL
(
__NR_¹_sigqueuešfo
, 
sys_¹_sigqueuešfo
)

292 
	#__NR_¹_sigsu¥’d
 130

	)

293 
	$__SYSCALL
(
__NR_¹_sigsu¥’d
, 
sys_¹_sigsu¥’d
)

294 
	#__NR_sig®t¡ack
 131

	)

295 
	$__SYSCALL
(
__NR_sig®t¡ack
, 
¡ub_sig®t¡ack
)

296 
	#__NR_utime
 132

	)

297 
	$__SYSCALL
(
__NR_utime
, 
sys_utime
)

298 
	#__NR_mknod
 133

	)

299 
	$__SYSCALL
(
__NR_mknod
, 
sys_mknod
)

302 
	#__NR_u£lib
 134

	)

303 
	$__SYSCALL
(
__NR_u£lib
, 
sys_ni_sysÿÎ
)

304 
	#__NR_³rsÚ®™y
 135

	)

305 
	$__SYSCALL
(
__NR_³rsÚ®™y
, 
sys_³rsÚ®™y
)

307 
	#__NR_u¡©
 136

	)

308 
	$__SYSCALL
(
__NR_u¡©
, 
sys_u¡©
)

309 
	#__NR_¡©fs
 137

	)

310 
	$__SYSCALL
(
__NR_¡©fs
, 
sys_¡©fs
)

311 
	#__NR_f¡©fs
 138

	)

312 
	$__SYSCALL
(
__NR_f¡©fs
, 
sys_f¡©fs
)

313 
	#__NR_sysfs
 139

	)

314 
	$__SYSCALL
(
__NR_sysfs
, 
sys_sysfs
)

316 
	#__NR_g‘´iÜ™y
 140

	)

317 
	$__SYSCALL
(
__NR_g‘´iÜ™y
, 
sys_g‘´iÜ™y
)

318 
	#__NR_£riÜ™y
 141

	)

319 
	$__SYSCALL
(
__NR_£riÜ™y
, 
sys_£riÜ™y
)

320 
	#__NR_sched_£¬am
 142

	)

321 
	$__SYSCALL
(
__NR_sched_£¬am
, 
sys_sched_£¬am
)

322 
	#__NR_sched_g‘·¿m
 143

	)

323 
	$__SYSCALL
(
__NR_sched_g‘·¿m
, 
sys_sched_g‘·¿m
)

324 
	#__NR_sched_£tscheduËr
 144

	)

325 
	$__SYSCALL
(
__NR_sched_£tscheduËr
, 
sys_sched_£tscheduËr
)

326 
	#__NR_sched_g‘scheduËr
 145

	)

327 
	$__SYSCALL
(
__NR_sched_g‘scheduËr
, 
sys_sched_g‘scheduËr
)

328 
	#__NR_sched_g‘_´iÜ™y_max
 146

	)

329 
	$__SYSCALL
(
__NR_sched_g‘_´iÜ™y_max
, 
sys_sched_g‘_´iÜ™y_max
)

330 
	#__NR_sched_g‘_´iÜ™y_mš
 147

	)

331 
	$__SYSCALL
(
__NR_sched_g‘_´iÜ™y_mš
, 
sys_sched_g‘_´iÜ™y_mš
)

332 
	#__NR_sched_¼_g‘_š‹rv®
 148

	)

333 
	$__SYSCALL
(
__NR_sched_¼_g‘_š‹rv®
, 
sys_sched_¼_g‘_š‹rv®
)

335 
	#__NR_mlock
 149

	)

336 
	$__SYSCALL
(
__NR_mlock
, 
sys_mlock
)

337 
	#__NR_muÆock
 150

	)

338 
	$__SYSCALL
(
__NR_muÆock
, 
sys_muÆock
)

339 
	#__NR_mlock®l
 151

	)

340 
	$__SYSCALL
(
__NR_mlock®l
, 
sys_mlock®l
)

341 
	#__NR_muÆock®l
 152

	)

342 
	$__SYSCALL
(
__NR_muÆock®l
, 
sys_muÆock®l
)

344 
	#__NR_vhªgup
 153

	)

345 
	$__SYSCALL
(
__NR_vhªgup
, 
sys_vhªgup
)

347 
	#__NR_modify_ldt
 154

	)

348 
	$__SYSCALL
(
__NR_modify_ldt
, 
sys_modify_ldt
)

350 
	#__NR_pivÙ_roÙ
 155

	)

351 
	$__SYSCALL
(
__NR_pivÙ_roÙ
, 
sys_pivÙ_roÙ
)

353 
	#__NR__sysùl
 156

	)

354 
	$__SYSCALL
(
__NR__sysùl
, 
sys_sysùl
)

356 
	#__NR_´ùl
 157

	)

357 
	$__SYSCALL
(
__NR_´ùl
, 
sys_´ùl
)

358 
	#__NR_¬ch_´ùl
 158

	)

359 
	$__SYSCALL
(
__NR_¬ch_´ùl
, 
sys_¬ch_´ùl
)

361 
	#__NR_adjtimex
 159

	)

362 
	$__SYSCALL
(
__NR_adjtimex
, 
sys_adjtimex
)

364 
	#__NR_£Œlim™
 160

	)

365 
	$__SYSCALL
(
__NR_£Œlim™
, 
sys_£Œlim™
)

367 
	#__NR_chroÙ
 161

	)

368 
	$__SYSCALL
(
__NR_chroÙ
, 
sys_chroÙ
)

370 
	#__NR_sync
 162

	)

371 
	$__SYSCALL
(
__NR_sync
, 
sys_sync
)

373 
	#__NR_acù
 163

	)

374 
	$__SYSCALL
(
__NR_acù
, 
sys_acù
)

376 
	#__NR_£‰imeofday
 164

	)

377 
	$__SYSCALL
(
__NR_£‰imeofday
, 
sys_£‰imeofday
)

379 
	#__NR_mouÁ
 165

	)

380 
	$__SYSCALL
(
__NR_mouÁ
, 
sys_mouÁ
)

381 
	#__NR_umouÁ2
 166

	)

382 
	$__SYSCALL
(
__NR_umouÁ2
, 
sys_umouÁ
)

384 
	#__NR_sw­Ú
 167

	)

385 
	$__SYSCALL
(
__NR_sw­Ú
, 
sys_sw­Ú
)

386 
	#__NR_sw­off
 168

	)

387 
	$__SYSCALL
(
__NR_sw­off
, 
sys_sw­off
)

389 
	#__NR_»boÙ
 169

	)

390 
	$__SYSCALL
(
__NR_»boÙ
, 
sys_»boÙ
)

392 
	#__NR_£tho¡Çme
 170

	)

393 
	$__SYSCALL
(
__NR_£tho¡Çme
, 
sys_£tho¡Çme
)

394 
	#__NR_£tdomašÇme
 171

	)

395 
	$__SYSCALL
(
__NR_£tdomašÇme
, 
sys_£tdomašÇme
)

397 
	#__NR_iİl
 172

	)

398 
	$__SYSCALL
(
__NR_iİl
, 
¡ub_iİl
)

399 
	#__NR_iİ”m
 173

	)

400 
	$__SYSCALL
(
__NR_iİ”m
, 
sys_iİ”m
)

402 
	#__NR_ü—‹_moduË
 174

	)

403 
	$__SYSCALL
(
__NR_ü—‹_moduË
, 
sys_ni_sysÿÎ
)

404 
	#__NR_š™_moduË
 175

	)

405 
	$__SYSCALL
(
__NR_š™_moduË
, 
sys_š™_moduË
)

406 
	#__NR_d–‘e_moduË
 176

	)

407 
	$__SYSCALL
(
__NR_d–‘e_moduË
, 
sys_d–‘e_moduË
)

408 
	#__NR_g‘_k”Ãl_syms
 177

	)

409 
	$__SYSCALL
(
__NR_g‘_k”Ãl_syms
, 
sys_ni_sysÿÎ
)

410 
	#__NR_qu”y_moduË
 178

	)

411 
	$__SYSCALL
(
__NR_qu”y_moduË
, 
sys_ni_sysÿÎ
)

413 
	#__NR_quÙaùl
 179

	)

414 
	$__SYSCALL
(
__NR_quÙaùl
, 
sys_quÙaùl
)

416 
	#__NR_nfs£rvùl
 180

	)

417 
	$__SYSCALL
(
__NR_nfs£rvùl
, 
sys_ni_sysÿÎ
)

420 
	#__NR_g‘pmsg
 181

	)

421 
	$__SYSCALL
(
__NR_g‘pmsg
, 
sys_ni_sysÿÎ
)

422 
	#__NR_pumsg
 182

	)

423 
	$__SYSCALL
(
__NR_pumsg
, 
sys_ni_sysÿÎ
)

426 
	#__NR_afs_sysÿÎ
 183

	)

427 
	$__SYSCALL
(
__NR_afs_sysÿÎ
, 
sys_ni_sysÿÎ
)

430 
	#__NR_tuxÿÎ
 184

	)

431 
	$__SYSCALL
(
__NR_tuxÿÎ
, 
sys_ni_sysÿÎ
)

433 
	#__NR_£cur™y
 185

	)

434 
	$__SYSCALL
(
__NR_£cur™y
, 
sys_ni_sysÿÎ
)

436 
	#__NR_g‘tid
 186

	)

437 
	$__SYSCALL
(
__NR_g‘tid
, 
sys_g‘tid
)

439 
	#__NR_»adah—d
 187

	)

440 
	$__SYSCALL
(
__NR_»adah—d
, 
sys_»adah—d
)

441 
	#__NR_£tx©Œ
 188

	)

442 
	$__SYSCALL
(
__NR_£tx©Œ
, 
sys_£tx©Œ
)

443 
	#__NR_l£tx©Œ
 189

	)

444 
	$__SYSCALL
(
__NR_l£tx©Œ
, 
sys_l£tx©Œ
)

445 
	#__NR_f£tx©Œ
 190

	)

446 
	$__SYSCALL
(
__NR_f£tx©Œ
, 
sys_f£tx©Œ
)

447 
	#__NR_g‘x©Œ
 191

	)

448 
	$__SYSCALL
(
__NR_g‘x©Œ
, 
sys_g‘x©Œ
)

449 
	#__NR_lg‘x©Œ
 192

	)

450 
	$__SYSCALL
(
__NR_lg‘x©Œ
, 
sys_lg‘x©Œ
)

451 
	#__NR_fg‘x©Œ
 193

	)

452 
	$__SYSCALL
(
__NR_fg‘x©Œ
, 
sys_fg‘x©Œ
)

453 
	#__NR_li¡x©Œ
 194

	)

454 
	$__SYSCALL
(
__NR_li¡x©Œ
, 
sys_li¡x©Œ
)

455 
	#__NR_Îi¡x©Œ
 195

	)

456 
	$__SYSCALL
(
__NR_Îi¡x©Œ
, 
sys_Îi¡x©Œ
)

457 
	#__NR_æi¡x©Œ
 196

	)

458 
	$__SYSCALL
(
__NR_æi¡x©Œ
, 
sys_æi¡x©Œ
)

459 
	#__NR_»movex©Œ
 197

	)

460 
	$__SYSCALL
(
__NR_»movex©Œ
, 
sys_»movex©Œ
)

461 
	#__NR_Ìemovex©Œ
 198

	)

462 
	$__SYSCALL
(
__NR_Ìemovex©Œ
, 
sys_Ìemovex©Œ
)

463 
	#__NR_äemovex©Œ
 199

	)

464 
	$__SYSCALL
(
__NR_äemovex©Œ
, 
sys_äemovex©Œ
)

465 
	#__NR_tkl
 200

	)

466 
	$__SYSCALL
(
__NR_tkl
, 
sys_tkl
)

467 
	#__NR_time
 201

	)

468 
	$__SYSCALL
(
__NR_time
, 
sys_time
)

469 
	#__NR_fu‹x
 202

	)

470 
	$__SYSCALL
(
__NR_fu‹x
, 
sys_fu‹x
)

471 
	#__NR_sched_£ffš™y
 203

	)

472 
	$__SYSCALL
(
__NR_sched_£ffš™y
, 
sys_sched_£ffš™y
)

473 
	#__NR_sched_g‘affš™y
 204

	)

474 
	$__SYSCALL
(
__NR_sched_g‘affš™y
, 
sys_sched_g‘affš™y
)

475 
	#__NR_£t_th»ad_¬—
 205

	)

476 
	$__SYSCALL
(
__NR_£t_th»ad_¬—
, 
sys_ni_sysÿÎ
)

477 
	#__NR_io_£tup
 206

	)

478 
	$__SYSCALL
(
__NR_io_£tup
, 
sys_io_£tup
)

479 
	#__NR_io_de¡roy
 207

	)

480 
	$__SYSCALL
(
__NR_io_de¡roy
, 
sys_io_de¡roy
)

481 
	#__NR_io_g‘ev’ts
 208

	)

482 
	$__SYSCALL
(
__NR_io_g‘ev’ts
, 
sys_io_g‘ev’ts
)

483 
	#__NR_io_subm™
 209

	)

484 
	$__SYSCALL
(
__NR_io_subm™
, 
sys_io_subm™
)

485 
	#__NR_io_ÿnûl
 210

	)

486 
	$__SYSCALL
(
__NR_io_ÿnûl
, 
sys_io_ÿnûl
)

487 
	#__NR_g‘_th»ad_¬—
 211

	)

488 
	$__SYSCALL
(
__NR_g‘_th»ad_¬—
, 
sys_ni_sysÿÎ
)

489 
	#__NR_lookup_dcook›
 212

	)

490 
	$__SYSCALL
(
__NR_lookup_dcook›
, 
sys_lookup_dcook›
)

491 
	#__NR_•Şl_ü—‹
 213

	)

492 
	$__SYSCALL
(
__NR_•Şl_ü—‹
, 
sys_•Şl_ü—‹
)

493 
	#__NR_•Şl_ùl_Şd
 214

	)

494 
	$__SYSCALL
(
__NR_•Şl_ùl_Şd
, 
sys_ni_sysÿÎ
)

495 
	#__NR_•Şl_wa™_Şd
 215

	)

496 
	$__SYSCALL
(
__NR_•Şl_wa™_Şd
, 
sys_ni_sysÿÎ
)

497 
	#__NR_»m­_fe_·ges
 216

	)

498 
	$__SYSCALL
(
__NR_»m­_fe_·ges
, 
sys_»m­_fe_·ges
)

499 
	#__NR_g‘d’ts64
 217

	)

500 
	$__SYSCALL
(
__NR_g‘d’ts64
, 
sys_g‘d’ts64
)

501 
	#__NR_£t_tid_add»ss
 218

	)

502 
	$__SYSCALL
(
__NR_£t_tid_add»ss
, 
sys_£t_tid_add»ss
)

503 
	#__NR_»¡¬t_sysÿÎ
 219

	)

504 
	$__SYSCALL
(
__NR_»¡¬t_sysÿÎ
, 
sys_»¡¬t_sysÿÎ
)

505 
	#__NR_£mtimedİ
 220

	)

506 
	$__SYSCALL
(
__NR_£mtimedİ
, 
sys_£mtimedİ
)

507 
	#__NR_çdvi£64
 221

	)

508 
	$__SYSCALL
(
__NR_çdvi£64
, 
sys_çdvi£64
)

509 
	#__NR_tim”_ü—‹
 222

	)

510 
	$__SYSCALL
(
__NR_tim”_ü—‹
, 
sys_tim”_ü—‹
)

511 
	#__NR_tim”_£‰ime
 223

	)

512 
	$__SYSCALL
(
__NR_tim”_£‰ime
, 
sys_tim”_£‰ime
)

513 
	#__NR_tim”_g‘time
 224

	)

514 
	$__SYSCALL
(
__NR_tim”_g‘time
, 
sys_tim”_g‘time
)

515 
	#__NR_tim”_g‘ov”run
 225

	)

516 
	$__SYSCALL
(
__NR_tim”_g‘ov”run
, 
sys_tim”_g‘ov”run
)

517 
	#__NR_tim”_d–‘e
 226

	)

518 
	$__SYSCALL
(
__NR_tim”_d–‘e
, 
sys_tim”_d–‘e
)

519 
	#__NR_şock_£‰ime
 227

	)

520 
	$__SYSCALL
(
__NR_şock_£‰ime
, 
sys_şock_£‰ime
)

521 
	#__NR_şock_g‘time
 228

	)

522 
	$__SYSCALL
(
__NR_şock_g‘time
, 
sys_şock_g‘time
)

523 
	#__NR_şock_g‘»s
 229

	)

524 
	$__SYSCALL
(
__NR_şock_g‘»s
, 
sys_şock_g‘»s
)

525 
	#__NR_şock_Çno¦“p
 230

	)

526 
	$__SYSCALL
(
__NR_şock_Çno¦“p
, 
sys_şock_Çno¦“p
)

527 
	#__NR_ex™_group
 231

	)

528 
	$__SYSCALL
(
__NR_ex™_group
, 
sys_ex™_group
)

529 
	#__NR_•Şl_wa™
 232

	)

530 
	$__SYSCALL
(
__NR_•Şl_wa™
, 
sys_•Şl_wa™
)

531 
	#__NR_•Şl_ùl
 233

	)

532 
	$__SYSCALL
(
__NR_•Şl_ùl
, 
sys_•Şl_ùl
)

533 
	#__NR_tgkl
 234

	)

534 
	$__SYSCALL
(
__NR_tgkl
, 
sys_tgkl
)

535 
	#__NR_utimes
 235

	)

536 
	$__SYSCALL
(
__NR_utimes
, 
sys_utimes
)

537 
	#__NR_v£rv”
 236

	)

538 
	$__SYSCALL
(
__NR_v£rv”
, 
sys_ni_sysÿÎ
)

539 
	#__NR_mbšd
 237

	)

540 
	$__SYSCALL
(
__NR_mbšd
, 
sys_mbšd
)

541 
	#__NR_£t_mempŞicy
 238

	)

542 
	$__SYSCALL
(
__NR_£t_mempŞicy
, 
sys_£t_mempŞicy
)

543 
	#__NR_g‘_mempŞicy
 239

	)

544 
	$__SYSCALL
(
__NR_g‘_mempŞicy
, 
sys_g‘_mempŞicy
)

545 
	#__NR_mq_İ’
 240

	)

546 
	$__SYSCALL
(
__NR_mq_İ’
, 
sys_mq_İ’
)

547 
	#__NR_mq_uÆšk
 241

	)

548 
	$__SYSCALL
(
__NR_mq_uÆšk
, 
sys_mq_uÆšk
)

549 
	#__NR_mq_timed£nd
 242

	)

550 
	$__SYSCALL
(
__NR_mq_timed£nd
, 
sys_mq_timed£nd
)

551 
	#__NR_mq_timed»ûive
 243

	)

552 
	$__SYSCALL
(
__NR_mq_timed»ûive
, 
sys_mq_timed»ûive
)

553 
	#__NR_mq_nÙify
 244

	)

554 
	$__SYSCALL
(
__NR_mq_nÙify
, 
sys_mq_nÙify
)

555 
	#__NR_mq_g‘£‰r
 245

	)

556 
	$__SYSCALL
(
__NR_mq_g‘£‰r
, 
sys_mq_g‘£‰r
)

557 
	#__NR_kexec_lßd
 246

	)

558 
	$__SYSCALL
(
__NR_kexec_lßd
, 
sys_kexec_lßd
)

559 
	#__NR_wa™id
 247

	)

560 
	$__SYSCALL
(
__NR_wa™id
, 
sys_wa™id
)

561 
	#__NR_add_key
 248

	)

562 
	$__SYSCALL
(
__NR_add_key
, 
sys_add_key
)

563 
	#__NR_»que¡_key
 249

	)

564 
	$__SYSCALL
(
__NR_»que¡_key
, 
sys_»que¡_key
)

565 
	#__NR_keyùl
 250

	)

566 
	$__SYSCALL
(
__NR_keyùl
, 
sys_keyùl
)

567 
	#__NR_iİrio_£t
 251

	)

568 
	$__SYSCALL
(
__NR_iİrio_£t
, 
sys_iİrio_£t
)

569 
	#__NR_iİrio_g‘
 252

	)

570 
	$__SYSCALL
(
__NR_iİrio_g‘
, 
sys_iİrio_g‘
)

571 
	#__NR_šÙify_š™
 253

	)

572 
	$__SYSCALL
(
__NR_šÙify_š™
, 
sys_šÙify_š™
)

573 
	#__NR_šÙify_add_w©ch
 254

	)

574 
	$__SYSCALL
(
__NR_šÙify_add_w©ch
, 
sys_šÙify_add_w©ch
)

575 
	#__NR_šÙify_rm_w©ch
 255

	)

576 
	$__SYSCALL
(
__NR_šÙify_rm_w©ch
, 
sys_šÙify_rm_w©ch
)

577 
	#__NR_mig¿‹_·ges
 256

	)

578 
	$__SYSCALL
(
__NR_mig¿‹_·ges
, 
sys_mig¿‹_·ges
)

579 
	#__NR_İ’©
 257

	)

580 
	$__SYSCALL
(
__NR_İ’©
, 
sys_İ’©
)

581 
	#__NR_mkdœ©
 258

	)

582 
	$__SYSCALL
(
__NR_mkdœ©
, 
sys_mkdœ©
)

583 
	#__NR_mknod©
 259

	)

584 
	$__SYSCALL
(
__NR_mknod©
, 
sys_mknod©
)

585 
	#__NR_fchowÇt
 260

	)

586 
	$__SYSCALL
(
__NR_fchowÇt
, 
sys_fchowÇt
)

587 
	#__NR_futime§t
 261

	)

588 
	$__SYSCALL
(
__NR_futime§t
, 
sys_futime§t
)

589 
	#__NR_Ãwf¡©©
 262

	)

590 
	$__SYSCALL
(
__NR_Ãwf¡©©
, 
sys_Ãwf¡©©
)

591 
	#__NR_uÆšk©
 263

	)

592 
	$__SYSCALL
(
__NR_uÆšk©
, 
sys_uÆšk©
)

593 
	#__NR_»Çm—t
 264

	)

594 
	$__SYSCALL
(
__NR_»Çm—t
, 
sys_»Çm—t
)

595 
	#__NR_lšk©
 265

	)

596 
	$__SYSCALL
(
__NR_lšk©
, 
sys_lšk©
)

597 
	#__NR_symlšk©
 266

	)

598 
	$__SYSCALL
(
__NR_symlšk©
, 
sys_symlšk©
)

599 
	#__NR_»adlšk©
 267

	)

600 
	$__SYSCALL
(
__NR_»adlšk©
, 
sys_»adlšk©
)

601 
	#__NR_fchmod©
 268

	)

602 
	$__SYSCALL
(
__NR_fchmod©
, 
sys_fchmod©
)

603 
	#__NR_çcûs§t
 269

	)

604 
	$__SYSCALL
(
__NR_çcûs§t
, 
sys_çcûs§t
)

605 
	#__NR_p£Ëù6
 270

	)

606 
	$__SYSCALL
(
__NR_p£Ëù6
, 
sys_p£Ëù6
)

607 
	#__NR_µŞl
 271

	)

608 
	$__SYSCALL
(
__NR_µŞl
, 
sys_µŞl
)

609 
	#__NR_unsh¬e
 272

	)

610 
	$__SYSCALL
(
__NR_unsh¬e
, 
sys_unsh¬e
)

611 
	#__NR_£t_robu¡_li¡
 273

	)

612 
	$__SYSCALL
(
__NR_£t_robu¡_li¡
, 
sys_£t_robu¡_li¡
)

613 
	#__NR_g‘_robu¡_li¡
 274

	)

614 
	$__SYSCALL
(
__NR_g‘_robu¡_li¡
, 
sys_g‘_robu¡_li¡
)

615 
	#__NR_¥liû
 275

	)

616 
	$__SYSCALL
(
__NR_¥liû
, 
sys_¥liû
)

617 
	#__NR_‹e
 276

	)

618 
	$__SYSCALL
(
__NR_‹e
, 
sys_‹e
)

619 
	#__NR_sync_fe_¿nge
 277

	)

620 
	$__SYSCALL
(
__NR_sync_fe_¿nge
, 
sys_sync_fe_¿nge
)

621 
	#__NR_vm¥liû
 278

	)

622 
	$__SYSCALL
(
__NR_vm¥liû
, 
sys_vm¥liû
)

623 
	#__NR_move_·ges
 279

	)

624 
	$__SYSCALL
(
__NR_move_·ges
, 
sys_move_·ges
)

625 
	#__NR_utim’§t
 280

	)

626 
	$__SYSCALL
(
__NR_utim’§t
, 
sys_utim’§t
)

627 
	#__NR_•Şl_pwa™
 281

	)

628 
	$__SYSCALL
(
__NR_•Şl_pwa™
, 
sys_•Şl_pwa™
)

629 
	#__NR_sigÇlfd
 282

	)

630 
	$__SYSCALL
(
__NR_sigÇlfd
, 
sys_sigÇlfd
)

631 
	#__NR_tim”fd_ü—‹
 283

	)

632 
	$__SYSCALL
(
__NR_tim”fd_ü—‹
, 
sys_tim”fd_ü—‹
)

633 
	#__NR_ev’tfd
 284

	)

634 
	$__SYSCALL
(
__NR_ev’tfd
, 
sys_ev’tfd
)

635 
	#__NR_çÎoÿ‹
 285

	)

636 
	$__SYSCALL
(
__NR_çÎoÿ‹
, 
sys_çÎoÿ‹
)

637 
	#__NR_tim”fd_£‰ime
 286

	)

638 
	$__SYSCALL
(
__NR_tim”fd_£‰ime
, 
sys_tim”fd_£‰ime
)

639 
	#__NR_tim”fd_g‘time
 287

	)

640 
	$__SYSCALL
(
__NR_tim”fd_g‘time
, 
sys_tim”fd_g‘time
)

641 
	#__NR_acû±4
 288

	)

642 
	$__SYSCALL
(
__NR_acû±4
, 
sys_acû±4
)

643 
	#__NR_sigÇlfd4
 289

	)

644 
	$__SYSCALL
(
__NR_sigÇlfd4
, 
sys_sigÇlfd4
)

645 
	#__NR_ev’tfd2
 290

	)

646 
	$__SYSCALL
(
__NR_ev’tfd2
, 
sys_ev’tfd2
)

647 
	#__NR_•Şl_ü—‹1
 291

	)

648 
	$__SYSCALL
(
__NR_•Şl_ü—‹1
, 
sys_•Şl_ü—‹1
)

649 
	#__NR_dup3
 292

	)

650 
	$__SYSCALL
(
__NR_dup3
, 
sys_dup3
)

651 
	#__NR_pe2
 293

	)

652 
	$__SYSCALL
(
__NR_pe2
, 
sys_pe2
)

653 
	#__NR_šÙify_š™1
 294

	)

654 
	$__SYSCALL
(
__NR_šÙify_š™1
, 
sys_šÙify_š™1
)

655 
	#__NR_´—dv
 295

	)

656 
	$__SYSCALL
(
__NR_´—dv
, 
sys_´—dv
)

657 
	#__NR_pwr™ev
 296

	)

658 
	$__SYSCALL
(
__NR_pwr™ev
, 
sys_pwr™ev
)

659 
	#__NR_¹_tgsigqueuešfo
 297

	)

660 
	$__SYSCALL
(
__NR_¹_tgsigqueuešfo
, 
sys_¹_tgsigqueuešfo
)

661 
	#__NR_³rf_ev’t_İ’
 298

	)

662 
	$__SYSCALL
(
__NR_³rf_ev’t_İ’
, 
sys_³rf_ev’t_İ’
)

663 
	#__NR_»cvmmsg
 299

	)

664 
	$__SYSCALL
(
__NR_»cvmmsg
, 
sys_»cvmmsg
)

665 
	#__NR_çnÙify_š™
 300

	)

666 
	$__SYSCALL
(
__NR_çnÙify_š™
, 
sys_çnÙify_š™
)

667 
	#__NR_çnÙify_m¬k
 301

	)

668 
	$__SYSCALL
(
__NR_çnÙify_m¬k
, 
sys_çnÙify_m¬k
)

669 
	#__NR_´lim™64
 302

	)

670 
	$__SYSCALL
(
__NR_´lim™64
, 
sys_´lim™64
)

671 
	#__NR_Çme_to_hªdË_©
 303

	)

672 
	$__SYSCALL
(
__NR_Çme_to_hªdË_©
, 
sys_Çme_to_hªdË_©
)

673 
	#__NR_İ’_by_hªdË_©
 304

	)

674 
	$__SYSCALL
(
__NR_İ’_by_hªdË_©
, 
sys_İ’_by_hªdË_©
)

675 
	#__NR_şock_adjtime
 305

	)

676 
	$__SYSCALL
(
__NR_şock_adjtime
, 
sys_şock_adjtime
)

677 
	#__NR_syncfs
 306

	)

678 
	$__SYSCALL
(
__NR_syncfs
, 
sys_syncfs
)

679 
	#__NR_£ndmmsg
 307

	)

680 
	$__SYSCALL
(
__NR_£ndmmsg
, 
sys_£ndmmsg
)

681 
	#__NR_£Šs
 308

	)

682 
	$__SYSCALL
(
__NR_£Šs
, 
sys_£Šs
)

683 
	#__NR_g‘ıu
 309

	)

684 
	$__SYSCALL
(
__NR_g‘ıu
, 
sys_g‘ıu
)

685 
	#__NR_´oûss_vm_»adv
 310

	)

686 
	$__SYSCALL
(
__NR_´oûss_vm_»adv
, 
sys_´oûss_vm_»adv
)

687 
	#__NR_´oûss_vm_wr™ev
 311

	)

688 
	$__SYSCALL
(
__NR_´oûss_vm_wr™ev
, 
sys_´oûss_vm_wr™ev
)

690 #iâdeà
__NO_STUBS


691 
	#__ARCH_WANT_OLD_READDIR


	)

692 
	#__ARCH_WANT_OLD_STAT


	)

693 
	#__ARCH_WANT_SYS_ALARM


	)

694 
	#__ARCH_WANT_SYS_GETHOSTNAME


	)

695 
	#__ARCH_WANT_SYS_PAUSE


	)

696 
	#__ARCH_WANT_SYS_SGETMASK


	)

697 
	#__ARCH_WANT_SYS_SIGNAL


	)

698 
	#__ARCH_WANT_SYS_UTIME


	)

699 
	#__ARCH_WANT_SYS_WAITPID


	)

700 
	#__ARCH_WANT_SYS_SOCKETCALL


	)

701 
	#__ARCH_WANT_SYS_FADVISE64


	)

702 
	#__ARCH_WANT_SYS_GETPGRP


	)

703 
	#__ARCH_WANT_SYS_LLSEEK


	)

704 
	#__ARCH_WANT_SYS_NICE


	)

705 
	#__ARCH_WANT_SYS_OLD_GETRLIMIT


	)

706 
	#__ARCH_WANT_SYS_OLD_UNAME


	)

707 
	#__ARCH_WANT_SYS_OLDUMOUNT


	)

708 
	#__ARCH_WANT_SYS_SIGPENDING


	)

709 
	#__ARCH_WANT_SYS_SIGPROCMASK


	)

710 
	#__ARCH_WANT_SYS_RT_SIGACTION


	)

711 
	#__ARCH_WANT_SYS_RT_SIGSUSPEND


	)

712 
	#__ARCH_WANT_SYS_TIME


	)

713 
	#__ARCH_WANT_COMPAT_SYS_TIME


	)

	@/usr/include/endian.h

19 #iâdef 
_ENDIAN_H


20 
	#_ENDIAN_H
 1

	)

22 
	~<ã©u»s.h
>

32 
	#__LITTLE_ENDIAN
 1234

	)

33 
	#__BIG_ENDIAN
 4321

	)

34 
	#__PDP_ENDIAN
 3412

	)

37 
	~<b™s/’dŸn.h
>

41 #iâdeà
__FLOAT_WORD_ORDER


42 
	#__FLOAT_WORD_ORDER
 
__BYTE_ORDER


	)

45 #ifdef 
__USE_BSD


46 
	#LITTLE_ENDIAN
 
__LITTLE_ENDIAN


	)

47 
	#BIG_ENDIAN
 
__BIG_ENDIAN


	)

48 
	#PDP_ENDIAN
 
__PDP_ENDIAN


	)

49 
	#BYTE_ORDER
 
__BYTE_ORDER


	)

52 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


53 
	#__LONG_LONG_PAIR
(
HI
, 
LO
èLO, 
	)
HI

54 #–ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


55 
	#__LONG_LONG_PAIR
(
HI
, 
LO
èHI, 
	)
LO

59 #ifdeà
__USE_BSD


61 
	~<b™s/by‹sw­.h
>

63 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


64 
	#htobe16
(
x
è
	`__bsw­_16
 (x)

	)

65 
	#htŞe16
(
x
è(x)

	)

66 
	#be16toh
(
x
è
	`__bsw­_16
 (x)

	)

67 
	#Ë16toh
(
x
è(x)

	)

69 
	#htobe32
(
x
è
	`__bsw­_32
 (x)

	)

70 
	#htŞe32
(
x
è(x)

	)

71 
	#be32toh
(
x
è
	`__bsw­_32
 (x)

	)

72 
	#Ë32toh
(
x
è(x)

	)

74 
	#htobe64
(
x
è
	`__bsw­_64
 (x)

	)

75 
	#htŞe64
(
x
è(x)

	)

76 
	#be64toh
(
x
è
	`__bsw­_64
 (x)

	)

77 
	#Ë64toh
(
x
è(x)

	)

79 
	#htobe16
(
x
è(x)

	)

80 
	#htŞe16
(
x
è
	`__bsw­_16
 (x)

	)

81 
	#be16toh
(
x
è(x)

	)

82 
	#Ë16toh
(
x
è
	`__bsw­_16
 (x)

	)

84 
	#htobe32
(
x
è(x)

	)

85 
	#htŞe32
(
x
è
	`__bsw­_32
 (x)

	)

86 
	#be32toh
(
x
è(x)

	)

87 
	#Ë32toh
(
x
è
	`__bsw­_32
 (x)

	)

89 
	#htobe64
(
x
è(x)

	)

90 
	#htŞe64
(
x
è
	`__bsw­_64
 (x)

	)

91 
	#be64toh
(
x
è(x)

	)

92 
	#Ë64toh
(
x
è
	`__bsw­_64
 (x)

	)

	@/usr/include/features.h

20 #iâdef 
_FEATURES_H


21 
	#_FEATURES_H
 1

	)

98 #undeà
__USE_ISOC99


99 #undeà
__USE_ISOC95


100 #undeà
__USE_POSIX


101 #undeà
__USE_POSIX2


102 #undeà
__USE_POSIX199309


103 #undeà
__USE_POSIX199506


104 #undeà
__USE_XOPEN


105 #undeà
__USE_XOPEN_EXTENDED


106 #undeà
__USE_UNIX98


107 #undeà
__USE_XOPEN2K


108 #undeà
__USE_XOPEN2KXSI


109 #undeà
__USE_XOPEN2K8


110 #undeà
__USE_XOPEN2K8XSI


111 #undeà
__USE_LARGEFILE


112 #undeà
__USE_LARGEFILE64


113 #undeà
__USE_FILE_OFFSET64


114 #undeà
__USE_BSD


115 #undeà
__USE_SVID


116 #undeà
__USE_MISC


117 #undeà
__USE_ATFILE


118 #undeà
__USE_GNU


119 #undeà
__USE_REENTRANT


120 #undeà
__USE_FORTIFY_LEVEL


121 #undeà
__FAVOR_BSD


122 #undeà
__KERNEL_STRICT_NAMES


126 #iâdeà
_LOOSE_KERNEL_NAMES


127 
	#__KERNEL_STRICT_NAMES


	)

131 
	#__USE_ANSI
 1

	)

140 #ià
defšed
 
__GNUC__
 && defšed 
__GNUC_MINOR__


141 
	#__GNUC_PREREQ
(
maj
, 
mš
) \

142 ((
__GNUC__
 << 16è+ 
__GNUC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

144 
	#__GNUC_PREREQ
(
maj
, 
mš
è0

	)

149 #ià
defšed
 
_BSD_SOURCE
 && \

150 !(
defšed
 
	g_POSIX_SOURCE
 || defšed 
	g_POSIX_C_SOURCE
 || \

151 
defšed
 
	g_XOPEN_SOURCE
 || defšed 
	g_GNU_SOURCE
 || defšed 
	g_SVID_SOURCE
)

152 
	#__FAVOR_BSD
 1

	)

156 #ifdeà
_GNU_SOURCE


157 #undeà
_ISOC95_SOURCE


158 
	#_ISOC95_SOURCE
 1

	)

159 #undeà
_ISOC99_SOURCE


160 
	#_ISOC99_SOURCE
 1

	)

161 #undeà
_POSIX_SOURCE


162 
	#_POSIX_SOURCE
 1

	)

163 #undeà
_POSIX_C_SOURCE


164 
	#_POSIX_C_SOURCE
 200809L

	)

165 #undeà
_XOPEN_SOURCE


166 
	#_XOPEN_SOURCE
 700

	)

167 #undeà
_XOPEN_SOURCE_EXTENDED


168 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

169 #undeà
_LARGEFILE64_SOURCE


170 
	#_LARGEFILE64_SOURCE
 1

	)

171 #undeà
_BSD_SOURCE


172 
	#_BSD_SOURCE
 1

	)

173 #undeà
_SVID_SOURCE


174 
	#_SVID_SOURCE
 1

	)

175 #undeà
_ATFILE_SOURCE


176 
	#_ATFILE_SOURCE
 1

	)

181 #ià(!
defšed
 
__STRICT_ANSI__
 && !defšed 
_ISOC99_SOURCE
 && \

182 !
defšed
 
	g_POSIX_SOURCE
 && !defšed 
	g_POSIX_C_SOURCE
 && \

183 !
defšed
 
	g_XOPEN_SOURCE
 && !defšed 
	g_BSD_SOURCE
 && !defšed 
	g_SVID_SOURCE
)

184 
	#_BSD_SOURCE
 1

	)

185 
	#_SVID_SOURCE
 1

	)

192 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC9X_SOURCE
 \

193 || (
defšed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

194 
	#__USE_ISOC99
 1

	)

198 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC9X_SOURCE
 \

199 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

200 
	#__USE_ISOC95
 1

	)

205 #ià((!
defšed
 
__STRICT_ANSI__
 || (
_XOPEN_SOURCE
 - 0) >= 500) && \

206 !
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE
)

207 
	#_POSIX_SOURCE
 1

	)

208 #ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

209 
	#_POSIX_C_SOURCE
 2

	)

210 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

211 
	#_POSIX_C_SOURCE
 199506L

	)

212 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

213 
	#_POSIX_C_SOURCE
 200112L

	)

215 
	#_POSIX_C_SOURCE
 200809L

	)

217 
	#__USE_POSIX_IMPLICITLY
 1

	)

220 #ià
defšed
 
_POSIX_SOURCE
 || 
_POSIX_C_SOURCE
 >ğ1 || defšed 
_XOPEN_SOURCE


221 
	#__USE_POSIX
 1

	)

224 #ià
defšed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >ğ2 || defšed 
_XOPEN_SOURCE


225 
	#__USE_POSIX2
 1

	)

228 #ià(
_POSIX_C_SOURCE
 - 0) >= 199309L

229 
	#__USE_POSIX199309
 1

	)

232 #ià(
_POSIX_C_SOURCE
 - 0) >= 199506L

233 
	#__USE_POSIX199506
 1

	)

236 #ià(
_POSIX_C_SOURCE
 - 0) >= 200112L

237 
	#__USE_XOPEN2K
 1

	)

238 #undeà
__USE_ISOC95


239 
	#__USE_ISOC95
 1

	)

240 #undeà
__USE_ISOC99


241 
	#__USE_ISOC99
 1

	)

244 #ià(
_POSIX_C_SOURCE
 - 0) >= 200809L

245 
	#__USE_XOPEN2K8
 1

	)

246 #undeà
_ATFILE_SOURCE


247 
	#_ATFILE_SOURCE
 1

	)

250 #ifdef 
_XOPEN_SOURCE


251 
	#__USE_XOPEN
 1

	)

252 #ià(
_XOPEN_SOURCE
 - 0) >= 500

253 
	#__USE_XOPEN_EXTENDED
 1

	)

254 
	#__USE_UNIX98
 1

	)

255 #undeà
_LARGEFILE_SOURCE


256 
	#_LARGEFILE_SOURCE
 1

	)

257 #ià(
_XOPEN_SOURCE
 - 0) >= 600

258 #ià(
_XOPEN_SOURCE
 - 0) >= 700

259 
	#__USE_XOPEN2K8
 1

	)

260 
	#__USE_XOPEN2K8XSI
 1

	)

262 
	#__USE_XOPEN2K
 1

	)

263 
	#__USE_XOPEN2KXSI
 1

	)

264 #undeà
__USE_ISOC95


265 
	#__USE_ISOC95
 1

	)

266 #undeà
__USE_ISOC99


267 
	#__USE_ISOC99
 1

	)

270 #ifdeà
_XOPEN_SOURCE_EXTENDED


271 
	#__USE_XOPEN_EXTENDED
 1

	)

276 #ifdeà
_LARGEFILE_SOURCE


277 
	#__USE_LARGEFILE
 1

	)

280 #ifdeà
_LARGEFILE64_SOURCE


281 
	#__USE_LARGEFILE64
 1

	)

284 #ià
defšed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

285 
	#__USE_FILE_OFFSET64
 1

	)

288 #ià
defšed
 
_BSD_SOURCE
 || defšed 
_SVID_SOURCE


289 
	#__USE_MISC
 1

	)

292 #ifdef 
_BSD_SOURCE


293 
	#__USE_BSD
 1

	)

296 #ifdef 
_SVID_SOURCE


297 
	#__USE_SVID
 1

	)

300 #ifdef 
_ATFILE_SOURCE


301 
	#__USE_ATFILE
 1

	)

304 #ifdef 
_GNU_SOURCE


305 
	#__USE_GNU
 1

	)

308 #ià
defšed
 
_REENTRANT
 || defšed 
_THREAD_SAFE


309 
	#__USE_REENTRANT
 1

	)

312 #ià
defšed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0 \

313 && 
__GNUC_PREREQ
 (4, 1è&& 
defšed
 
	g__OPTIMIZE__
 && __OPTIMIZE__ > 0

314 #ià
_FORTIFY_SOURCE
 > 1

315 
	#__USE_FORTIFY_LEVEL
 2

	)

317 
	#__USE_FORTIFY_LEVEL
 1

	)

320 
	#__USE_FORTIFY_LEVEL
 0

	)

324 
	~<b™s/´edefs.h
>

327 
	#__STDC_ISO_10646__
 200009L

	)

335 #undeà
__GNU_LIBRARY__


336 
	#__GNU_LIBRARY__
 6

	)

340 
	#__GLIBC__
 2

	)

341 
	#__GLIBC_MINOR__
 15

	)

343 
	#__GLIBC_PREREQ
(
maj
, 
mš
) \

344 ((
__GLIBC__
 << 16è+ 
__GLIBC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

347 #ià
defšed
 
__GNUC__
 \

348 || (
defšed
 
	g__PGI
 && defšed 
	g__i386__
 ) \

349 || (
defšed
 
	g__INTEL_COMPILER
 && (defšed 
	g__i386__
 || defšed 
	g__Ÿ64__
)) \

350 || (
defšed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L)

351 
	#__GLIBC_HAVE_LONG_LONG
 1

	)

355 #iâdeà
__ASSEMBLER__


356 #iâdeà
_SYS_CDEFS_H


357 
	~<sys/cdefs.h
>

362 #ià
defšed
 
__USE_FILE_OFFSET64
 && !defšed 
__REDIRECT


363 
	#__USE_LARGEFILE
 1

	)

364 
	#__USE_LARGEFILE64
 1

	)

370 #ià
__GNUC_PREREQ
 (2, 7è&& 
defšed
 
__OPTIMIZE__
 \

371 && !
defšed
 
	g__OPTIMIZE_SIZE__
 && !defšed 
	g__NO_INLINE__
 \

372 && 
defšed
 
	g__ex‹º_šlše


373 
	#__USE_EXTERN_INLINES
 1

	)

378 #ià
__GNUC_PREREQ
 (2, 7è&& 
defšed
 
__OPTIMIZE__
 \

379 && (
defšed
 
	g_LIBC
 || !defšed 
	g__OPTIMIZE_SIZE__
è&& !defšed 
	g__NO_INLINE__
 \

380 && 
defšed
 
	g__ex‹º_šlše


381 
	#__USE_EXTERN_INLINES_IN_LIBC
 1

	)

389 
	~<gnu/¡ubs.h
>

	@/usr/include/linux/atmapi.h

6 #iâdeà
_LINUX_ATMAPI_H


7 
	#_LINUX_ATMAPI_H


	)

9 #ià
defšed
(
__¥¬c__
è|| defšed(
__Ÿ64__
)

12 
	#__ATM_API_ALIGN
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

14 
	#__ATM_API_ALIGN


	)

27 ¡ruù { 
	m_
[8]; } 
	t__ATM_API_ALIGN
 
	t©m_k±r_t
;

	@/usr/include/linux/atmsap.h

6 #iâdeà
_LINUX_ATMSAP_H


7 
	#_LINUX_ATMSAP_H


	)

9 
	~<lšux/©m­i.h
>

22 
	#ATM_L2_NONE
 0

	)

23 
	#ATM_L2_ISO1745
 0x01

	)

24 
	#ATM_L2_Q291
 0x02

	)

25 
	#ATM_L2_X25_LL
 0x06

	)

26 
	#ATM_L2_X25_ML
 0x07

	)

27 
	#ATM_L2_LAPB
 0x08

	)

28 
	#ATM_L2_HDLC_ARM
 0x09

	)

29 
	#ATM_L2_HDLC_NRM
 0x0¨

	)

30 
	#ATM_L2_HDLC_ABM
 0x0b

	)

31 
	#ATM_L2_ISO8802
 0x0ø

	)

32 
	#ATM_L2_X75
 0x0d

	)

33 
	#ATM_L2_Q922
 0x0

	)

34 
	#ATM_L2_USER
 0x10

	)

35 
	#ATM_L2_ISO7776
 0x11

	)

44 
	#ATM_L3_NONE
 0

	)

45 
	#ATM_L3_X25
 0x06

	)

46 
	#ATM_L3_ISO8208
 0x07

	)

47 
	#ATM_L3_X223
 0x08

	)

48 
	#ATM_L3_ISO8473
 0x09

	)

49 
	#ATM_L3_T70
 0x0¨

	)

50 
	#ATM_L3_TR9577
 0x0b

	)

51 
	#ATM_L3_H310
 0x0ø

	)

52 
	#ATM_L3_H321
 0x0d

	)

53 
	#ATM_L3_USER
 0x10

	)

62 
	#ATM_HL_NONE
 0

	)

63 
	#ATM_HL_ISO
 0x01

	)

64 
	#ATM_HL_USER
 0x02

	)

65 
	#ATM_HL_HLP
 0x03

	)

66 
	#ATM_HL_VENDOR
 0x04

	)

75 
	#ATM_IMD_NONE
 0

	)

76 
	#ATM_IMD_NORMAL
 1

	)

77 
	#ATM_IMD_EXTENDED
 2

	)

84 
	#ATM_TT_NONE
 0

	)

85 
	#ATM_TT_RX
 1

	)

86 
	#ATM_TT_TX
 2

	)

87 
	#ATM_TT_RXTX
 3

	)

89 
	#ATM_MC_NONE
 0

	)

90 
	#ATM_MC_TS
 1

	)

91 
	#ATM_MC_TS_FEC
 2

	)

92 
	#ATM_MC_PS
 3

	)

93 
	#ATM_MC_PS_FEC
 4

	)

94 
	#ATM_MC_H221
 5

	)

100 
	#ATM_MAX_HLI
 8

	)

103 
	s©m_bÎi
 {

104 
	ml2_´Ùo
;

107 
	mmode
;

109 
	mwšdow
;

110 } 
	m™u
;

111 
	mu£r
;

112 } 
	ml2
;

113 
	ml3_´Ùo
;

116 
	mmode
;

118 
	mdef_size
;

120 
	mwšdow
;

121 } 
	m™u
;

122 
	mu£r
;

124 
	m‹rm_ty³
;

125 
	mfw_mpx_ÿp
;

127 
	mbw_mpx_ÿp
;

129 } 
	mh310
;

131 
	mi
;

132 
	m¢­
[5];

134 } 
	mŒ9577
;

135 } 
	ml3
;

136 } 
	g__ATM_API_ALIGN
;

139 
	s©m_bhli
 {

140 
	mhl_ty³
;

141 
	mhl_Ëngth
;

143 
	mhl_šfo
[
ATM_MAX_HLI
];

147 
	#ATM_MAX_BLLI
 3

	)

150 
	s©m_§p
 {

151 
©m_bhli
 
	mbhli
;

152 
©m_bÎi
 
	mbÎi
[
ATM_MAX_BLLI
] 
	m__ATM_API_ALIGN
;

157 
__šlše__
 
	$bÎi_š_u£
(
©m_bÎi
 
bÎi
)

159  
bÎi
.
l2_´Ùo
 || bÎi.
l3_´Ùo
;

160 
	}
}

	@/usr/include/linux/blk_types.h

5 #iâdeà
__LINUX_BLK_TYPES_H


6 
	#__LINUX_BLK_TYPES_H


	)

8 #ifdeà
CONFIG_BLOCK


10 
	~<lšux/ty³s.h
>

12 
	gbio_£t
;

13 
	gbio
;

14 
	gbio_š‹gr™y_·ylßd
;

15 
	g·ge
;

16 
	gblock_deviû
;

17 (
	tbio_’d_io_t
è(
	tbio
 *, );

18 (
	tbio_de¡ruùÜ_t
è(
	tbio
 *);

23 
	sbio_vec
 {

24 
·ge
 *
bv_·ge
;

25 
bv_Ën
;

26 
bv_off£t
;

33 
	sbio
 {

34 
£ùÜ_t
 
bi_£ùÜ
;

36 
bio
 *
bi_Ãxt
;

37 
block_deviû
 *
bi_bdev
;

38 
bi_æags
;

39 
bi_rw
;

43 
bi_vút
;

44 
bi_idx
;

49 
bi_phys_£gm’ts
;

51 
bi_size
;

57 
bi_£g_äÚt_size
;

58 
bi_£g_back_size
;

60 
bi_max_vecs
;

62 
©omic_t
 
bi_út
;

64 
bio_vec
 *
bi_io_vec
;

66 
bio_’d_io_t
 *
bi_’d_io
;

68 *
bi_´iv©e
;

69 #ià
	`defšed
(
CONFIG_BLK_DEV_INTEGRITY
)

70 
bio_š‹gr™y_·ylßd
 *
bi_š‹gr™y
;

73 
bio_de¡ruùÜ_t
 *
bi_de¡ruùÜ
;

80 
bio_vec
 
bi_šlše_vecs
[0];

86 
	#BIO_UPTODATE
 0

	)

87 
	#BIO_RW_BLOCK
 1

	)

88 
	#BIO_EOF
 2

	)

89 
	#BIO_SEG_VALID
 3

	)

90 
	#BIO_CLONED
 4

	)

91 
	#BIO_BOUNCED
 5

	)

92 
	#BIO_USER_MAPPED
 6

	)

93 
	#BIO_EOPNOTSUPP
 7

	)

94 
	#BIO_NULL_MAPPED
 8

	)

95 
	#BIO_FS_INTEGRITY
 9

	)

96 
	#BIO_QUIET
 10

	)

97 
	#BIO_MAPPED_INTEGRITY
 11

	)

98 
	#bio_æagged
(
bio
, 
æag
è((bio)->
bi_æags
 & (1 << (æag)))

	)

103 
	#BIO_POOL_BITS
 (4)

	)

104 
	#BIO_POOL_NONE
 ((1UL << 
BIO_POOL_BITS
è- 1)

	)

105 
	#BIO_POOL_OFFSET
 (
BITS_PER_LONG
 - 
BIO_POOL_BITS
)

	)

106 
	#BIO_POOL_MASK
 (1UL << 
BIO_POOL_OFFSET
)

	)

107 
	#BIO_POOL_IDX
(
bio
è((bio)->
bi_æags
 >> 
BIO_POOL_OFFSET
)

	)

115 
	erq_æag_b™s
 {

117 
__REQ_WRITE
,

118 
__REQ_FAILFAST_DEV
,

119 
__REQ_FAILFAST_TRANSPORT
,

120 
__REQ_FAILFAST_DRIVER
,

122 
__REQ_SYNC
,

123 
__REQ_META
,

124 
__REQ_PRIO
,

125 
__REQ_DISCARD
,

126 
__REQ_SECURE
,

128 
__REQ_NOIDLE
,

129 
__REQ_FUA
,

130 
__REQ_FLUSH
,

133 
__REQ_RAHEAD
,

134 
__REQ_THROTTLED
,

138 
__REQ_SORTED
,

139 
__REQ_SOFTBARRIER
,

140 
__REQ_NOMERGE
,

141 
__REQ_STARTED
,

142 
__REQ_DONTPREP
,

143 
__REQ_QUEUED
,

144 
__REQ_ELVPRIV
,

145 
__REQ_FAILED
,

146 
__REQ_QUIET
,

147 
__REQ_PREEMPT
,

148 
__REQ_ALLOCED
,

149 
__REQ_COPY_USER
,

150 
__REQ_FLUSH_SEQ
,

151 
__REQ_IO_STAT
,

152 
__REQ_MIXED_MERGE
,

153 
__REQ_NR_BITS
,

156 
	#REQ_WRITE
 (1 << 
__REQ_WRITE
)

	)

157 
	#REQ_FAILFAST_DEV
 (1 << 
__REQ_FAILFAST_DEV
)

	)

158 
	#REQ_FAILFAST_TRANSPORT
 (1 << 
__REQ_FAILFAST_TRANSPORT
)

	)

159 
	#REQ_FAILFAST_DRIVER
 (1 << 
__REQ_FAILFAST_DRIVER
)

	)

160 
	#REQ_SYNC
 (1 << 
__REQ_SYNC
)

	)

161 
	#REQ_META
 (1 << 
__REQ_META
)

	)

162 
	#REQ_PRIO
 (1 << 
__REQ_PRIO
)

	)

163 
	#REQ_DISCARD
 (1 << 
__REQ_DISCARD
)

	)

164 
	#REQ_NOIDLE
 (1 << 
__REQ_NOIDLE
)

	)

166 
	#REQ_FAILFAST_MASK
 \

167 (
REQ_FAILFAST_DEV
 | 
REQ_FAILFAST_TRANSPORT
 | 
REQ_FAILFAST_DRIVER
)

	)

168 
	#REQ_COMMON_MASK
 \

169 (
REQ_WRITE
 | 
REQ_FAILFAST_MASK
 | 
REQ_SYNC
 | 
REQ_META
 | 
REQ_PRIO
 | \

170 
REQ_DISCARD
 | 
REQ_NOIDLE
 | 
REQ_FLUSH
 | 
REQ_FUA
 | 
REQ_SECURE
)

	)

171 
	#REQ_CLONE_MASK
 
REQ_COMMON_MASK


	)

173 
	#REQ_RAHEAD
 (1 << 
__REQ_RAHEAD
)

	)

174 
	#REQ_THROTTLED
 (1 << 
__REQ_THROTTLED
)

	)

176 
	#REQ_SORTED
 (1 << 
__REQ_SORTED
)

	)

177 
	#REQ_SOFTBARRIER
 (1 << 
__REQ_SOFTBARRIER
)

	)

178 
	#REQ_FUA
 (1 << 
__REQ_FUA
)

	)

179 
	#REQ_NOMERGE
 (1 << 
__REQ_NOMERGE
)

	)

180 
	#REQ_STARTED
 (1 << 
__REQ_STARTED
)

	)

181 
	#REQ_DONTPREP
 (1 << 
__REQ_DONTPREP
)

	)

182 
	#REQ_QUEUED
 (1 << 
__REQ_QUEUED
)

	)

183 
	#REQ_ELVPRIV
 (1 << 
__REQ_ELVPRIV
)

	)

184 
	#REQ_FAILED
 (1 << 
__REQ_FAILED
)

	)

185 
	#REQ_QUIET
 (1 << 
__REQ_QUIET
)

	)

186 
	#REQ_PREEMPT
 (1 << 
__REQ_PREEMPT
)

	)

187 
	#REQ_ALLOCED
 (1 << 
__REQ_ALLOCED
)

	)

188 
	#REQ_COPY_USER
 (1 << 
__REQ_COPY_USER
)

	)

189 
	#REQ_FLUSH
 (1 << 
__REQ_FLUSH
)

	)

190 
	#REQ_FLUSH_SEQ
 (1 << 
__REQ_FLUSH_SEQ
)

	)

191 
	#REQ_IO_STAT
 (1 << 
__REQ_IO_STAT
)

	)

192 
	#REQ_MIXED_MERGE
 (1 << 
__REQ_MIXED_MERGE
)

	)

193 
	#REQ_SECURE
 (1 << 
__REQ_SECURE
)

	)

	@/usr/include/linux/byteorder/little_endian.h

1 #iâdeà
_LINUX_BYTEORDER_LITTLE_ENDIAN_H


2 
	#_LINUX_BYTEORDER_LITTLE_ENDIAN_H


	)

4 #iâdeà
__LITTLE_ENDIAN


5 
	#__LITTLE_ENDIAN
 1234

	)

7 #iâdeà
__LITTLE_ENDIAN_BITFIELD


8 
	#__LITTLE_ENDIAN_BITFIELD


	)

11 
	~<lšux/ty³s.h
>

12 
	~<lšux/swab.h
>

14 
	#__cÚ¡ªt_htÚl
(
x
è((
__be32
)
	`___cÚ¡ªt_swab32
((x)))

	)

15 
	#__cÚ¡ªt_Áohl
(
x
è
	`___cÚ¡ªt_swab32
((
__be32
)(x))

	)

16 
	#__cÚ¡ªt_htÚs
(
x
è((
__be16
)
	`___cÚ¡ªt_swab16
((x)))

	)

17 
	#__cÚ¡ªt_Áohs
(
x
è
	`___cÚ¡ªt_swab16
((
__be16
)(x))

	)

18 
	#__cÚ¡ªt_ıu_to_Ë64
(
x
è((
__Ë64
)(
__u64
)(x))

	)

19 
	#__cÚ¡ªt_Ë64_to_ıu
(
x
è((
__u64
)(
__Ë64
)(x))

	)

20 
	#__cÚ¡ªt_ıu_to_Ë32
(
x
è((
__Ë32
)(
__u32
)(x))

	)

21 
	#__cÚ¡ªt_Ë32_to_ıu
(
x
è((
__u32
)(
__Ë32
)(x))

	)

22 
	#__cÚ¡ªt_ıu_to_Ë16
(
x
è((
__Ë16
)(
__u16
)(x))

	)

23 
	#__cÚ¡ªt_Ë16_to_ıu
(
x
è((
__u16
)(
__Ë16
)(x))

	)

24 
	#__cÚ¡ªt_ıu_to_be64
(
x
è((
__be64
)
	`___cÚ¡ªt_swab64
((x)))

	)

25 
	#__cÚ¡ªt_be64_to_ıu
(
x
è
	`___cÚ¡ªt_swab64
((
__u64
)(
__be64
)(x))

	)

26 
	#__cÚ¡ªt_ıu_to_be32
(
x
è((
__be32
)
	`___cÚ¡ªt_swab32
((x)))

	)

27 
	#__cÚ¡ªt_be32_to_ıu
(
x
è
	`___cÚ¡ªt_swab32
((
__u32
)(
__be32
)(x))

	)

28 
	#__cÚ¡ªt_ıu_to_be16
(
x
è((
__be16
)
	`___cÚ¡ªt_swab16
((x)))

	)

29 
	#__cÚ¡ªt_be16_to_ıu
(
x
è
	`___cÚ¡ªt_swab16
((
__u16
)(
__be16
)(x))

	)

30 
	#__ıu_to_Ë64
(
x
è((
__Ë64
)(
__u64
)(x))

	)

31 
	#__Ë64_to_ıu
(
x
è((
__u64
)(
__Ë64
)(x))

	)

32 
	#__ıu_to_Ë32
(
x
è((
__Ë32
)(
__u32
)(x))

	)

33 
	#__Ë32_to_ıu
(
x
è((
__u32
)(
__Ë32
)(x))

	)

34 
	#__ıu_to_Ë16
(
x
è((
__Ë16
)(
__u16
)(x))

	)

35 
	#__Ë16_to_ıu
(
x
è((
__u16
)(
__Ë16
)(x))

	)

36 
	#__ıu_to_be64
(
x
è((
__be64
)
	`__swab64
((x)))

	)

37 
	#__be64_to_ıu
(
x
è
	`__swab64
((
__u64
)(
__be64
)(x))

	)

38 
	#__ıu_to_be32
(
x
è((
__be32
)
	`__swab32
((x)))

	)

39 
	#__be32_to_ıu
(
x
è
	`__swab32
((
__u32
)(
__be32
)(x))

	)

40 
	#__ıu_to_be16
(
x
è((
__be16
)
	`__swab16
((x)))

	)

41 
	#__be16_to_ıu
(
x
è
	`__swab16
((
__u16
)(
__be16
)(x))

	)

43 
__šlše__
 
__Ë64
 
	$__ıu_to_Ë64p
(cÚ¡ 
__u64
 *
p
)

45  (
__Ë64
)*
p
;

46 
	}
}

47 
__šlše__
 
__u64
 
	$__Ë64_to_ıup
(cÚ¡ 
__Ë64
 *
p
)

49  (
__u64
)*
p
;

50 
	}
}

51 
__šlše__
 
__Ë32
 
	$__ıu_to_Ë32p
(cÚ¡ 
__u32
 *
p
)

53  (
__Ë32
)*
p
;

54 
	}
}

55 
__šlše__
 
__u32
 
	$__Ë32_to_ıup
(cÚ¡ 
__Ë32
 *
p
)

57  (
__u32
)*
p
;

58 
	}
}

59 
__šlše__
 
__Ë16
 
	$__ıu_to_Ë16p
(cÚ¡ 
__u16
 *
p
)

61  (
__Ë16
)*
p
;

62 
	}
}

63 
__šlše__
 
__u16
 
	$__Ë16_to_ıup
(cÚ¡ 
__Ë16
 *
p
)

65  (
__u16
)*
p
;

66 
	}
}

67 
__šlše__
 
__be64
 
	$__ıu_to_be64p
(cÚ¡ 
__u64
 *
p
)

69  (
__be64
)
	`__swab64p
(
p
);

70 
	}
}

71 
__šlše__
 
__u64
 
	$__be64_to_ıup
(cÚ¡ 
__be64
 *
p
)

73  
	`__swab64p
((
__u64
 *)
p
);

74 
	}
}

75 
__šlše__
 
__be32
 
	$__ıu_to_be32p
(cÚ¡ 
__u32
 *
p
)

77  (
__be32
)
	`__swab32p
(
p
);

78 
	}
}

79 
__šlše__
 
__u32
 
	$__be32_to_ıup
(cÚ¡ 
__be32
 *
p
)

81  
	`__swab32p
((
__u32
 *)
p
);

82 
	}
}

83 
__šlše__
 
__be16
 
	$__ıu_to_be16p
(cÚ¡ 
__u16
 *
p
)

85  (
__be16
)
	`__swab16p
(
p
);

86 
	}
}

87 
__šlše__
 
__u16
 
	$__be16_to_ıup
(cÚ¡ 
__be16
 *
p
)

89  
	`__swab16p
((
__u16
 *)
p
);

90 
	}
}

91 
	#__ıu_to_Ë64s
(
x
èdØ{ ()(x); } 0)

	)

92 
	#__Ë64_to_ıus
(
x
èdØ{ ()(x); } 0)

	)

93 
	#__ıu_to_Ë32s
(
x
èdØ{ ()(x); } 0)

	)

94 
	#__Ë32_to_ıus
(
x
èdØ{ ()(x); } 0)

	)

95 
	#__ıu_to_Ë16s
(
x
èdØ{ ()(x); } 0)

	)

96 
	#__Ë16_to_ıus
(
x
èdØ{ ()(x); } 0)

	)

97 
	#__ıu_to_be64s
(
x
è
	`__swab64s
((x))

	)

98 
	#__be64_to_ıus
(
x
è
	`__swab64s
((x))

	)

99 
	#__ıu_to_be32s
(
x
è
	`__swab32s
((x))

	)

100 
	#__be32_to_ıus
(
x
è
	`__swab32s
((x))

	)

101 
	#__ıu_to_be16s
(
x
è
	`__swab16s
((x))

	)

102 
	#__be16_to_ıus
(
x
è
	`__swab16s
((x))

	)

	@/usr/include/linux/elf-em.h

1 #iâdeà
_LINUX_ELF_EM_H


2 
	#_LINUX_ELF_EM_H


	)

5 
	#EM_NONE
 0

	)

6 
	#EM_M32
 1

	)

7 
	#EM_SPARC
 2

	)

8 
	#EM_386
 3

	)

9 
	#EM_68K
 4

	)

10 
	#EM_88K
 5

	)

11 
	#EM_486
 6

	)

12 
	#EM_860
 7

	)

13 
	#EM_MIPS
 8

	)

17 
	#EM_MIPS_RS3_LE
 10

	)

18 
	#EM_MIPS_RS4_BE
 10

	)

20 
	#EM_PARISC
 15

	)

21 
	#EM_SPARC32PLUS
 18

	)

22 
	#EM_PPC
 20

	)

23 
	#EM_PPC64
 21

	)

24 
	#EM_SPU
 23

	)

25 
	#EM_SH
 42

	)

26 
	#EM_SPARCV9
 43

	)

27 
	#EM_IA_64
 50

	)

28 
	#EM_X86_64
 62

	)

29 
	#EM_S390
 22

	)

30 
	#EM_CRIS
 76

	)

31 
	#EM_V850
 87

	)

32 
	#EM_M32R
 88

	)

33 
	#EM_H8_300
 46

	)

34 
	#EM_MN10300
 89

	)

35 
	#EM_BLACKFIN
 106

	)

36 
	#EM_FRV
 0x5441

	)

37 
	#EM_AVR32
 0x18ad

	)

43 
	#EM_ALPHA
 0x9026

	)

46 
	#EM_CYGNUS_V850
 0x9080

	)

48 
	#EM_CYGNUS_M32R
 0x9041

	)

50 
	#EM_S390_OLD
 0xA390

	)

52 
	#EM_CYGNUS_MN10300
 0xb“f

	)

	@/usr/include/linux/hdlc/ioctl.h

1 #iâdeà
__HDLC_IOCTL_H__


2 
	#__HDLC_IOCTL_H__


	)

5 
	#GENERIC_HDLC_VERSION
 4

	)

7 
	#CLOCK_DEFAULT
 0

	)

8 
	#CLOCK_EXT
 1

	)

9 
	#CLOCK_INT
 2

	)

10 
	#CLOCK_TXINT
 3

	)

11 
	#CLOCK_TXFROMRX
 4

	)

14 
	#ENCODING_DEFAULT
 0

	)

15 
	#ENCODING_NRZ
 1

	)

16 
	#ENCODING_NRZI
 2

	)

17 
	#ENCODING_FM_MARK
 3

	)

18 
	#ENCODING_FM_SPACE
 4

	)

19 
	#ENCODING_MANCHESTER
 5

	)

22 
	#PARITY_DEFAULT
 0

	)

23 
	#PARITY_NONE
 1

	)

24 
	#PARITY_CRC16_PR0
 2

	)

25 
	#PARITY_CRC16_PR1
 3

	)

26 
	#PARITY_CRC16_PR0_CCITT
 4

	)

27 
	#PARITY_CRC16_PR1_CCITT
 5

	)

28 
	#PARITY_CRC32_PR0_CCITT
 6

	)

29 
	#PARITY_CRC32_PR1_CCITT
 7

	)

31 
	#LMI_DEFAULT
 0

	)

32 
	#LMI_NONE
 1

	)

33 
	#LMI_ANSI
 2

	)

34 
	#LMI_CCITT
 3

	)

35 
	#LMI_CISCO
 4

	)

38 
	mşock_¿‹
;

39 
	mşock_ty³
;

40 
	mloİback
;

41 } 
	tsync_£rŸl_£‰šgs
;

44 
	mşock_¿‹
;

45 
	mşock_ty³
;

46 
	mloİback
;

47 
	m¦Ù_m­
;

48 } 
	t‹1_£‰šgs
;

51 
	m’codšg
;

52 
	m·r™y
;

53 } 
	t¿w_hdlc_´Ùo
;

56 
	mt391
;

57 
	mt392
;

58 
	mn391
;

59 
	mn392
;

60 
	mn393
;

61 
	mlmi
;

62 
	mdû
;

63 } 
	tä_´Ùo
;

66 
	mdlci
;

67 } 
	tä_´Ùo_pvc
;

70 
	mdlci
;

71 
	mma¡”
[
IFNAMSIZ
];

72 }
	tä_´Ùo_pvc_šfo
;

75 
	mš‹rv®
;

76 
	mtimeout
;

77 } 
	tcisco_´Ùo
;

	@/usr/include/linux/if_ether.h

21 #iâdeà
_LINUX_IF_ETHER_H


22 
	#_LINUX_IF_ETHER_H


	)

24 
	~<lšux/ty³s.h
>

31 
	#ETH_ALEN
 6

	)

32 
	#ETH_HLEN
 14

	)

33 
	#ETH_ZLEN
 60

	)

34 
	#ETH_DATA_LEN
 1500

	)

35 
	#ETH_FRAME_LEN
 1514

	)

36 
	#ETH_FCS_LEN
 4

	)

42 
	#ETH_P_LOOP
 0x0060

	)

43 
	#ETH_P_PUP
 0x0200

	)

44 
	#ETH_P_PUPAT
 0x0201

	)

45 
	#ETH_P_IP
 0x0800

	)

46 
	#ETH_P_X25
 0x0805

	)

47 
	#ETH_P_ARP
 0x0806

	)

48 
	#ETH_P_BPQ
 0x08FF

	)

49 
	#ETH_P_IEEEPUP
 0x0a00

	)

50 
	#ETH_P_IEEEPUPAT
 0x0a01

	)

51 
	#ETH_P_DEC
 0x6000

	)

52 
	#ETH_P_DNA_DL
 0x6001

	)

53 
	#ETH_P_DNA_RC
 0x6002

	)

54 
	#ETH_P_DNA_RT
 0x6003

	)

55 
	#ETH_P_LAT
 0x6004

	)

56 
	#ETH_P_DIAG
 0x6005

	)

57 
	#ETH_P_CUST
 0x6006

	)

58 
	#ETH_P_SCA
 0x6007

	)

59 
	#ETH_P_TEB
 0x6558

	)

60 
	#ETH_P_RARP
 0x8035

	)

61 
	#ETH_P_ATALK
 0x809B

	)

62 
	#ETH_P_AARP
 0x80F3

	)

63 
	#ETH_P_8021Q
 0x8100

	)

64 
	#ETH_P_IPX
 0x8137

	)

65 
	#ETH_P_IPV6
 0x86DD

	)

66 
	#ETH_P_PAUSE
 0x8808

	)

67 
	#ETH_P_SLOW
 0x8809

	)

68 
	#ETH_P_WCCP
 0x883E

	)

70 
	#ETH_P_PPP_DISC
 0x8863

	)

71 
	#ETH_P_PPP_SES
 0x8864

	)

72 
	#ETH_P_MPLS_UC
 0x8847

	)

73 
	#ETH_P_MPLS_MC
 0x8848

	)

74 
	#ETH_P_ATMMPOA
 0x884ø

	)

75 
	#ETH_P_LINK_CTL
 0x886ø

	)

76 
	#ETH_P_ATMFATE
 0x8884

	)

79 
	#ETH_P_PAE
 0x888E

	)

80 
	#ETH_P_AOE
 0x88A2

	)

81 
	#ETH_P_8021AD
 0x88A8

	)

82 
	#ETH_P_TIPC
 0x88CA

	)

83 
	#ETH_P_8021AH
 0x88E7

	)

84 
	#ETH_P_1588
 0x88F7

	)

85 
	#ETH_P_FCOE
 0x8906

	)

86 
	#ETH_P_TDLS
 0x890D

	)

87 
	#ETH_P_FIP
 0x8914

	)

88 
	#ETH_P_QINQ1
 0x9100

	)

89 
	#ETH_P_QINQ2
 0x9200

	)

90 
	#ETH_P_QINQ3
 0x9300

	)

91 
	#ETH_P_EDSA
 0xDADA

	)

92 
	#ETH_P_AF_IUCV
 0xFBFB

	)

98 
	#ETH_P_802_3
 0x0001

	)

99 
	#ETH_P_AX25
 0x0002

	)

100 
	#ETH_P_ALL
 0x0003

	)

101 
	#ETH_P_802_2
 0x0004

	)

102 
	#ETH_P_SNAP
 0x0005

	)

103 
	#ETH_P_DDCMP
 0x0006

	)

104 
	#ETH_P_WAN_PPP
 0x0007

	)

105 
	#ETH_P_PPP_MP
 0x0008

	)

106 
	#ETH_P_LOCALTALK
 0x0009

	)

107 
	#ETH_P_CAN
 0x000C

	)

108 
	#ETH_P_PPPTALK
 0x0010

	)

109 
	#ETH_P_TR_802_2
 0x0011

	)

110 
	#ETH_P_MOBITEX
 0x0015

	)

111 
	#ETH_P_CONTROL
 0x0016

	)

112 
	#ETH_P_IRDA
 0x0017

	)

113 
	#ETH_P_ECONET
 0x0018

	)

114 
	#ETH_P_HDLC
 0x0019

	)

115 
	#ETH_P_ARCNET
 0x001A

	)

116 
	#ETH_P_DSA
 0x001B

	)

117 
	#ETH_P_TRAILER
 0x001C

	)

118 
	#ETH_P_PHONET
 0x00F5

	)

119 
	#ETH_P_IEEE802154
 0x00F6

	)

120 
	#ETH_P_CAIF
 0x00F7

	)

126 
	s‘hhdr
 {

127 
	mh_de¡
[
ETH_ALEN
];

128 
	mh_sourû
[
ETH_ALEN
];

129 
__be16
 
	mh_´Ùo
;

130 } 
__©Œibu‹__
((
·cked
));

	@/usr/include/linux/if_link.h

1 #iâdeà
_LINUX_IF_LINK_H


2 
	#_LINUX_IF_LINK_H


	)

4 
	~<lšux/ty³s.h
>

5 
	~<lšux/Ãšk.h
>

8 
	s¹Æ_lšk_¡©s
 {

9 
__u32
 
	mrx_·ck‘s
;

10 
__u32
 
	mtx_·ck‘s
;

11 
__u32
 
	mrx_by‹s
;

12 
__u32
 
	mtx_by‹s
;

13 
__u32
 
	mrx_”rÜs
;

14 
__u32
 
	mtx_”rÜs
;

15 
__u32
 
	mrx_drİ³d
;

16 
__u32
 
	mtx_drİ³d
;

17 
__u32
 
	mmuÉiÿ¡
;

18 
__u32
 
	mcŞlisiÚs
;

21 
__u32
 
	mrx_Ëngth_”rÜs
;

22 
__u32
 
	mrx_ov”_”rÜs
;

23 
__u32
 
	mrx_üc_”rÜs
;

24 
__u32
 
	mrx_äame_”rÜs
;

25 
__u32
 
	mrx_fifo_”rÜs
;

26 
__u32
 
	mrx_mis£d_”rÜs
;

29 
__u32
 
	mtx_abÜ‹d_”rÜs
;

30 
__u32
 
	mtx_ÿ¼›r_”rÜs
;

31 
__u32
 
	mtx_fifo_”rÜs
;

32 
__u32
 
	mtx_h—¹b—t_”rÜs
;

33 
__u32
 
	mtx_wšdow_”rÜs
;

36 
__u32
 
	mrx_com´es£d
;

37 
__u32
 
	mtx_com´es£d
;

41 
	s¹Æ_lšk_¡©s64
 {

42 
__u64
 
	mrx_·ck‘s
;

43 
__u64
 
	mtx_·ck‘s
;

44 
__u64
 
	mrx_by‹s
;

45 
__u64
 
	mtx_by‹s
;

46 
__u64
 
	mrx_”rÜs
;

47 
__u64
 
	mtx_”rÜs
;

48 
__u64
 
	mrx_drİ³d
;

49 
__u64
 
	mtx_drİ³d
;

50 
__u64
 
	mmuÉiÿ¡
;

51 
__u64
 
	mcŞlisiÚs
;

54 
__u64
 
	mrx_Ëngth_”rÜs
;

55 
__u64
 
	mrx_ov”_”rÜs
;

56 
__u64
 
	mrx_üc_”rÜs
;

57 
__u64
 
	mrx_äame_”rÜs
;

58 
__u64
 
	mrx_fifo_”rÜs
;

59 
__u64
 
	mrx_mis£d_”rÜs
;

62 
__u64
 
	mtx_abÜ‹d_”rÜs
;

63 
__u64
 
	mtx_ÿ¼›r_”rÜs
;

64 
__u64
 
	mtx_fifo_”rÜs
;

65 
__u64
 
	mtx_h—¹b—t_”rÜs
;

66 
__u64
 
	mtx_wšdow_”rÜs
;

69 
__u64
 
	mrx_com´es£d
;

70 
__u64
 
	mtx_com´es£d
;

74 
	s¹Æ_lšk_ifm­
 {

75 
__u64
 
	mmem_¡¬t
;

76 
__u64
 
	mmem_’d
;

77 
__u64
 
	mba£_addr
;

78 
__u16
 
	mœq
;

79 
__u8
 
	mdma
;

80 
__u8
 
	mpÜt
;

102 
	mIFLA_UNSPEC
,

103 
	mIFLA_ADDRESS
,

104 
	mIFLA_BROADCAST
,

105 
	mIFLA_IFNAME
,

106 
	mIFLA_MTU
,

107 
	mIFLA_LINK
,

108 
	mIFLA_QDISC
,

109 
	mIFLA_STATS
,

110 
	mIFLA_COST
,

111 
	#IFLA_COST
 
IFLA_COST


	)

112 
	mIFLA_PRIORITY
,

113 
	#IFLA_PRIORITY
 
IFLA_PRIORITY


	)

114 
	mIFLA_MASTER
,

115 
	#IFLA_MASTER
 
IFLA_MASTER


	)

116 
	mIFLA_WIRELESS
,

117 
	#IFLA_WIRELESS
 
IFLA_WIRELESS


	)

118 
	mIFLA_PROTINFO
,

119 
	#IFLA_PROTINFO
 
IFLA_PROTINFO


	)

120 
	mIFLA_TXQLEN
,

121 
	#IFLA_TXQLEN
 
IFLA_TXQLEN


	)

122 
	mIFLA_MAP
,

123 
	#IFLA_MAP
 
IFLA_MAP


	)

124 
	mIFLA_WEIGHT
,

125 
	#IFLA_WEIGHT
 
IFLA_WEIGHT


	)

126 
	mIFLA_OPERSTATE
,

127 
	mIFLA_LINKMODE
,

128 
	mIFLA_LINKINFO
,

129 
	#IFLA_LINKINFO
 
IFLA_LINKINFO


	)

130 
	mIFLA_NET_NS_PID
,

131 
	mIFLA_IFALIAS
,

132 
	mIFLA_NUM_VF
,

133 
	mIFLA_VFINFO_LIST
,

134 
	mIFLA_STATS64
,

135 
	mIFLA_VF_PORTS
,

136 
	mIFLA_PORT_SELF
,

137 
	mIFLA_AF_SPEC
,

138 
	mIFLA_GROUP
,

139 
	mIFLA_NET_NS_FD
,

140 
	mIFLA_EXT_MASK
,

141 
	m__IFLA_MAX


145 
	#IFLA_MAX
 (
__IFLA_MAX
 - 1)

	)

148 
	#IFLA_RTA
(
r
è((
¹©Œ
*)(((*)Ô)è+ 
	`NLMSG_ALIGN
((
ifšfomsg
))))

	)

149 
	#IFLA_PAYLOAD
(
n
è
	`NLMSG_PAYLOAD
Ò,(
ifšfomsg
))

	)

152 
	mIFLA_INET_UNSPEC
,

153 
	mIFLA_INET_CONF
,

154 
	m__IFLA_INET_MAX
,

157 
	#IFLA_INET_MAX
 (
__IFLA_INET_MAX
 - 1)

	)

190 
	mIFLA_INET6_UNSPEC
,

191 
	mIFLA_INET6_FLAGS
,

192 
	mIFLA_INET6_CONF
,

193 
	mIFLA_INET6_STATS
,

194 
	mIFLA_INET6_MCAST
,

195 
	mIFLA_INET6_CACHEINFO
,

196 
	mIFLA_INET6_ICMP6STATS
,

197 
	m__IFLA_INET6_MAX


200 
	#IFLA_INET6_MAX
 (
__IFLA_INET6_MAX
 - 1)

	)

202 
	siæa_ÿchešfo
 {

203 
__u32
 
	mmax_»asm_Ën
;

204 
__u32
 
	mt¡amp
;

205 
__u32
 
	m»achabË_time
;

206 
__u32
 
	m»Œªs_time
;

210 
	mIFLA_INFO_UNSPEC
,

211 
	mIFLA_INFO_KIND
,

212 
	mIFLA_INFO_DATA
,

213 
	mIFLA_INFO_XSTATS
,

214 
	m__IFLA_INFO_MAX
,

217 
	#IFLA_INFO_MAX
 (
__IFLA_INFO_MAX
 - 1)

	)

222 
	mIFLA_VLAN_UNSPEC
,

223 
	mIFLA_VLAN_ID
,

224 
	mIFLA_VLAN_FLAGS
,

225 
	mIFLA_VLAN_EGRESS_QOS
,

226 
	mIFLA_VLAN_INGRESS_QOS
,

227 
	m__IFLA_VLAN_MAX
,

230 
	#IFLA_VLAN_MAX
 (
__IFLA_VLAN_MAX
 - 1)

	)

232 
	siæa_vÏn_æags
 {

233 
__u32
 
	mæags
;

234 
__u32
 
	mmask
;

238 
	mIFLA_VLAN_QOS_UNSPEC
,

239 
	mIFLA_VLAN_QOS_MAPPING
,

240 
	m__IFLA_VLAN_QOS_MAX


243 
	#IFLA_VLAN_QOS_MAX
 (
__IFLA_VLAN_QOS_MAX
 - 1)

	)

245 
	siæa_vÏn_qos_m­pšg
 {

246 
__u32
 
	mäom
;

247 
__u32
 
	mto
;

252 
	mIFLA_MACVLAN_UNSPEC
,

253 
	mIFLA_MACVLAN_MODE
,

254 
	m__IFLA_MACVLAN_MAX
,

257 
	#IFLA_MACVLAN_MAX
 (
__IFLA_MACVLAN_MAX
 - 1)

	)

259 
	emacvÏn_mode
 {

260 
	mMACVLAN_MODE_PRIVATE
 = 1,

261 
	mMACVLAN_MODE_VEPA
 = 2,

262 
	mMACVLAN_MODE_BRIDGE
 = 4,

263 
	mMACVLAN_MODE_PASSTHRU
 = 8,

269 
	mIFLA_VF_INFO_UNSPEC
,

270 
	mIFLA_VF_INFO
,

271 
	m__IFLA_VF_INFO_MAX
,

274 
	#IFLA_VF_INFO_MAX
 (
__IFLA_VF_INFO_MAX
 - 1)

	)

277 
	mIFLA_VF_UNSPEC
,

278 
	mIFLA_VF_MAC
,

279 
	mIFLA_VF_VLAN
,

280 
	mIFLA_VF_TX_RATE
,

281 
	mIFLA_VF_SPOOFCHK
,

282 
	m__IFLA_VF_MAX
,

285 
	#IFLA_VF_MAX
 (
__IFLA_VF_MAX
 - 1)

	)

287 
	siæa_vf_mac
 {

288 
__u32
 
	mvf
;

289 
__u8
 
	mmac
[32];

292 
	siæa_vf_vÏn
 {

293 
__u32
 
	mvf
;

294 
__u32
 
	mvÏn
;

295 
__u32
 
	mqos
;

298 
	siæa_vf_tx_¿‹
 {

299 
__u32
 
	mvf
;

300 
__u32
 
	m¿‹
;

303 
	siæa_vf_¥oofchk
 {

304 
__u32
 
	mvf
;

305 
__u32
 
	m£‰šg
;

324 
	mIFLA_VF_PORT_UNSPEC
,

325 
	mIFLA_VF_PORT
,

326 
	m__IFLA_VF_PORT_MAX
,

329 
	#IFLA_VF_PORT_MAX
 (
__IFLA_VF_PORT_MAX
 - 1)

	)

332 
	mIFLA_PORT_UNSPEC
,

333 
	mIFLA_PORT_VF
,

334 
	mIFLA_PORT_PROFILE
,

335 
	mIFLA_PORT_VSI_TYPE
,

336 
	mIFLA_PORT_INSTANCE_UUID
,

337 
	mIFLA_PORT_HOST_UUID
,

338 
	mIFLA_PORT_REQUEST
,

339 
	mIFLA_PORT_RESPONSE
,

340 
	m__IFLA_PORT_MAX
,

343 
	#IFLA_PORT_MAX
 (
__IFLA_PORT_MAX
 - 1)

	)

345 
	#PORT_PROFILE_MAX
 40

	)

346 
	#PORT_UUID_MAX
 16

	)

347 
	#PORT_SELF_VF
 -1

	)

350 
	mPORT_REQUEST_PREASSOCIATE
 = 0,

351 
	mPORT_REQUEST_PREASSOCIATE_RR
,

352 
	mPORT_REQUEST_ASSOCIATE
,

353 
	mPORT_REQUEST_DISASSOCIATE
,

357 
	mPORT_VDP_RESPONSE_SUCCESS
 = 0,

358 
	mPORT_VDP_RESPONSE_INVALID_FORMAT
,

359 
	mPORT_VDP_RESPONSE_INSUFFICIENT_RESOURCES
,

360 
	mPORT_VDP_RESPONSE_UNUSED_VTID
,

361 
	mPORT_VDP_RESPONSE_VTID_VIOLATION
,

362 
	mPORT_VDP_RESPONSE_VTID_VERSION_VIOALTION
,

363 
	mPORT_VDP_RESPONSE_OUT_OF_SYNC
,

365 
	mPORT_PROFILE_RESPONSE_SUCCESS
 = 0x100,

366 
	mPORT_PROFILE_RESPONSE_INPROGRESS
,

367 
	mPORT_PROFILE_RESPONSE_INVALID
,

368 
	mPORT_PROFILE_RESPONSE_BADSTATE
,

369 
	mPORT_PROFILE_RESPONSE_INSUFFICIENT_RESOURCES
,

370 
	mPORT_PROFILE_RESPONSE_ERROR
,

373 
	siæa_pÜt_vsi
 {

374 
__u8
 
	mvsi_mgr_id
;

375 
__u8
 
	mvsi_ty³_id
[3];

376 
__u8
 
	mvsi_ty³_v”siÚ
;

377 
__u8
 
	m·d
[3];

	@/usr/include/linux/if_packet.h

1 #iâdeà
__LINUX_IF_PACKET_H


2 
	#__LINUX_IF_PACKET_H


	)

4 
	~<lšux/ty³s.h
>

6 
	ssockaddr_pkt
 {

7 
	m¥kt_çmy
;

8 
	m¥kt_deviû
[14];

9 
__be16
 
	m¥kt_´ÙocŞ
;

12 
	ssockaddr_Î
 {

13 
	m¦l_çmy
;

14 
__be16
 
	m¦l_´ÙocŞ
;

15 
	m¦l_ifšdex
;

16 
	m¦l_h©y³
;

17 
	m¦l_pk‰y³
;

18 
	m¦l_h®’
;

19 
	m¦l_addr
[8];

24 
	#PACKET_HOST
 0

	)

25 
	#PACKET_BROADCAST
 1

	)

26 
	#PACKET_MULTICAST
 2

	)

27 
	#PACKET_OTHERHOST
 3

	)

28 
	#PACKET_OUTGOING
 4

	)

30 
	#PACKET_LOOPBACK
 5

	)

31 
	#PACKET_FASTROUTE
 6

	)

35 
	#PACKET_ADD_MEMBERSHIP
 1

	)

36 
	#PACKET_DROP_MEMBERSHIP
 2

	)

37 
	#PACKET_RECV_OUTPUT
 3

	)

39 
	#PACKET_RX_RING
 5

	)

40 
	#PACKET_STATISTICS
 6

	)

41 
	#PACKET_COPY_THRESH
 7

	)

42 
	#PACKET_AUXDATA
 8

	)

43 
	#PACKET_ORIGDEV
 9

	)

44 
	#PACKET_VERSION
 10

	)

45 
	#PACKET_HDRLEN
 11

	)

46 
	#PACKET_RESERVE
 12

	)

47 
	#PACKET_TX_RING
 13

	)

48 
	#PACKET_LOSS
 14

	)

49 
	#PACKET_VNET_HDR
 15

	)

50 
	#PACKET_TX_TIMESTAMP
 16

	)

51 
	#PACKET_TIMESTAMP
 17

	)

52 
	#PACKET_FANOUT
 18

	)

54 
	#PACKET_FANOUT_HASH
 0

	)

55 
	#PACKET_FANOUT_LB
 1

	)

56 
	#PACKET_FANOUT_CPU
 2

	)

57 
	#PACKET_FANOUT_FLAG_DEFRAG
 0x8000

	)

59 
	sack‘_¡©s
 {

60 
	m_·ck‘s
;

61 
	m_drİs
;

64 
	sack‘_¡©s_v3
 {

65 
	m_·ck‘s
;

66 
	m_drİs
;

67 
	m_ä“ze_q_út
;

70 
	uack‘_¡©s_u
 {

71 
ack‘_¡©s
 
	m¡©s1
;

72 
ack‘_¡©s_v3
 
	m¡©s3
;

75 
	sack‘_auxd©a
 {

76 
__u32
 
	m_¡©us
;

77 
__u32
 
	m_Ën
;

78 
__u32
 
	m_¢­Ën
;

79 
__u16
 
	m_mac
;

80 
__u16
 
	m_Ãt
;

81 
__u16
 
	m_vÏn_tci
;

82 
__u16
 
	m_·ddšg
;

86 
	#TP_STATUS_KERNEL
 0x0

	)

87 
	#TP_STATUS_USER
 0x1

	)

88 
	#TP_STATUS_COPY
 0x2

	)

89 
	#TP_STATUS_LOSING
 0x4

	)

90 
	#TP_STATUS_CSUMNOTREADY
 0x8

	)

91 
	#TP_STATUS_VLAN_VALID
 0x10

	)

92 
	#TP_STATUS_BLK_TMO
 0x20

	)

95 
	#TP_STATUS_AVAILABLE
 0x0

	)

96 
	#TP_STATUS_SEND_REQUEST
 0x1

	)

97 
	#TP_STATUS_SENDING
 0x2

	)

98 
	#TP_STATUS_WRONG_FORMAT
 0x4

	)

101 
	#TP_FT_REQ_FILL_RXHASH
 0x1

	)

103 
	sack‘_hdr
 {

104 
	m_¡©us
;

105 
	m_Ën
;

106 
	m_¢­Ën
;

107 
	m_mac
;

108 
	m_Ãt
;

109 
	m_£c
;

110 
	m_u£c
;

113 
	#TPACKET_ALIGNMENT
 16

	)

114 
	#TPACKET_ALIGN
(
x
è(((x)+
TPACKET_ALIGNMENT
-1)&~(TPACKET_ALIGNMENT-1))

	)

115 
	#TPACKET_HDRLEN
 (
	`TPACKET_ALIGN
((
ack‘_hdr
)è+ (
sockaddr_Î
))

	)

117 
	sack‘2_hdr
 {

118 
__u32
 
	m_¡©us
;

119 
__u32
 
	m_Ën
;

120 
__u32
 
	m_¢­Ën
;

121 
__u16
 
	m_mac
;

122 
__u16
 
	m_Ãt
;

123 
__u32
 
	m_£c
;

124 
__u32
 
	m_n£c
;

125 
__u16
 
	m_vÏn_tci
;

126 
__u16
 
	m_·ddšg
;

129 
	sack‘_hdr_v¬ŸÁ1
 {

130 
__u32
 
	m_rxhash
;

131 
__u32
 
	m_vÏn_tci
;

134 
	sack‘3_hdr
 {

135 
__u32
 
	m_Ãxt_off£t
;

136 
__u32
 
	m_£c
;

137 
__u32
 
	m_n£c
;

138 
__u32
 
	m_¢­Ën
;

139 
__u32
 
	m_Ën
;

140 
__u32
 
	m_¡©us
;

141 
__u16
 
	m_mac
;

142 
__u16
 
	m_Ãt
;

145 
ack‘_hdr_v¬ŸÁ1
 
	mhv1
;

149 
	sack‘_bd_ts
 {

150 
	mts_£c
;

152 
	mts_u£c
;

153 
	mts_n£c
;

157 
	sack‘_hdr_v1
 {

158 
__u32
 
	mblock_¡©us
;

159 
__u32
 
	mnum_pkts
;

160 
__u32
 
	moff£t_to_fœ¡_pkt
;

165 
__u32
 
	mblk_Ën
;

176 
__®igÃd_u64
 
	m£q_num
;

203 
ack‘_bd_ts
 
	mts_fœ¡_pkt
, 
	mts_Ï¡_pkt
;

206 
	uack‘_bd_h—d”_u
 {

207 
ack‘_hdr_v1
 
	mbh1
;

210 
	sack‘_block_desc
 {

211 
__u32
 
	mv”siÚ
;

212 
__u32
 
	moff£t_to_´iv
;

213 
ack‘_bd_h—d”_u
 
	mhdr
;

216 
	#TPACKET2_HDRLEN
 (
	`TPACKET_ALIGN
((
ack‘2_hdr
)è+ (
sockaddr_Î
))

	)

217 
	#TPACKET3_HDRLEN
 (
	`TPACKET_ALIGN
((
ack‘3_hdr
)è+ (
sockaddr_Î
))

	)

219 
	eack‘_v”siÚs
 {

220 
	mTPACKET_V1
,

221 
	mTPACKET_V2
,

222 
	mTPACKET_V3


238 
	sack‘_»q
 {

239 
	m_block_size
;

240 
	m_block_Ä
;

241 
	m_äame_size
;

242 
	m_äame_Ä
;

245 
	sack‘_»q3
 {

246 
	m_block_size
;

247 
	m_block_Ä
;

248 
	m_äame_size
;

249 
	m_äame_Ä
;

250 
	m_»tœe_blk_tov
;

251 
	m_sizeof_´iv
;

252 
	m_ã©u»_»q_wÜd
;

255 
	uack‘_»q_u
 {

256 
ack‘_»q
 
	m»q
;

257 
ack‘_»q3
 
	m»q3
;

260 
	s·ck‘_m»q
 {

261 
	mmr_ifšdex
;

262 
	mmr_ty³
;

263 
	mmr_®’
;

264 
	mmr_add»ss
[8];

267 
	#PACKET_MR_MULTICAST
 0

	)

268 
	#PACKET_MR_PROMISC
 1

	)

269 
	#PACKET_MR_ALLMULTI
 2

	)

270 
	#PACKET_MR_UNICAST
 3

	)

	@/usr/include/linux/if_pppol2tp.h

15 #iâdeà
__LINUX_IF_PPPOL2TP_H


16 
	#__LINUX_IF_PPPOL2TP_H


	)

18 
	~<lšux/ty³s.h
>

24 
	sµpŞ2_addr
 {

25 
__k”Ãl_pid_t
 
	mpid
;

27 
	mfd
;

29 
sockaddr_š
 
	maddr
;

31 
__u16
 
	ms_tuÂ–
, 
	ms_£ssiÚ
;

32 
__u16
 
	md_tuÂ–
, 
	md_£ssiÚ
;

38 
	sµpŞ2v3_addr
 {

39 
__k”Ãl_pid_t
 
	mpid
;

41 
	mfd
;

43 
sockaddr_š
 
	maddr
;

45 
__u32
 
	ms_tuÂ–
, 
	ms_£ssiÚ
;

46 
__u32
 
	md_tuÂ–
, 
	md_£ssiÚ
;

60 
	mPPPOL2TP_SO_DEBUG
 = 1,

61 
	mPPPOL2TP_SO_RECVSEQ
 = 2,

62 
	mPPPOL2TP_SO_SENDSEQ
 = 3,

63 
	mPPPOL2TP_SO_LNSMODE
 = 4,

64 
	mPPPOL2TP_SO_REORDERTO
 = 5,

69 
	mPPPOL2TP_MSG_DEBUG
 = (1 << 0),

71 
	mPPPOL2TP_MSG_CONTROL
 = (1 << 1),

73 
	mPPPOL2TP_MSG_SEQ
 = (1 << 2),

74 
	mPPPOL2TP_MSG_DATA
 = (1 << 3),

	@/usr/include/linux/input.h

1 #iâdeà
_INPUT_H


2 
	#_INPUT_H


	)

12 
	~<sys/time.h
>

13 
	~<sys/ioùl.h
>

14 
	~<sys/ty³s.h
>

15 
	~<lšux/ty³s.h
>

21 
	sšput_ev’t
 {

22 
timev®
 
	mtime
;

23 
__u16
 
	mty³
;

24 
__u16
 
	mcode
;

25 
__s32
 
	mv®ue
;

32 
	#EV_VERSION
 0x010001

	)

38 
	sšput_id
 {

39 
__u16
 
	mbu¡y³
;

40 
__u16
 
	mv’dÜ
;

41 
__u16
 
	m´oduù
;

42 
__u16
 
	mv”siÚ
;

64 
	sšput_absšfo
 {

65 
__s32
 
	mv®ue
;

66 
__s32
 
	mmšimum
;

67 
__s32
 
	mmaximum
;

68 
__s32
 
	mfuzz
;

69 
__s32
 
	mæ©
;

70 
__s32
 
	m»sŞutiÚ
;

88 
	sšput_keym­_’Œy
 {

89 
	#INPUT_KEYMAP_BY_INDEX
 (1 << 0)

	)

90 
__u8
 
	mæags
;

91 
__u8
 
	mËn
;

92 
__u16
 
	mšdex
;

93 
__u32
 
	mkeycode
;

94 
__u8
 
	msÿncode
[32];

97 
	#EVIOCGVERSION
 
	`_IOR
('E', 0x01, è

	)

98 
	#EVIOCGID
 
	`_IOR
('E', 0x02, 
šput_id
è

	)

99 
	#EVIOCGREP
 
	`_IOR
('E', 0x03, [2]è

	)

100 
	#EVIOCSREP
 
	`_IOW
('E', 0x03, [2]è

	)

102 
	#EVIOCGKEYCODE
 
	`_IOR
('E', 0x04, [2]è

	)

103 
	#EVIOCGKEYCODE_V2
 
	`_IOR
('E', 0x04, 
šput_keym­_’Œy
)

	)

104 
	#EVIOCSKEYCODE
 
	`_IOW
('E', 0x04, [2]è

	)

105 
	#EVIOCSKEYCODE_V2
 
	`_IOW
('E', 0x04, 
šput_keym­_’Œy
)

	)

107 
	#EVIOCGNAME
(
Ën
è
	`_IOC
(
_IOC_READ
, 'E', 0x06,†’è

	)

108 
	#EVIOCGPHYS
(
Ën
è
	`_IOC
(
_IOC_READ
, 'E', 0x07,†’è

	)

109 
	#EVIOCGUNIQ
(
Ën
è
	`_IOC
(
_IOC_READ
, 'E', 0x08,†’è

	)

110 
	#EVIOCGPROP
(
Ën
è
	`_IOC
(
_IOC_READ
, 'E', 0x09,†’è

	)

112 
	#EVIOCGKEY
(
Ën
è
	`_IOC
(
_IOC_READ
, 'E', 0x18,†’è

	)

113 
	#EVIOCGLED
(
Ën
è
	`_IOC
(
_IOC_READ
, 'E', 0x19,†’è

	)

114 
	#EVIOCGSND
(
Ën
è
	`_IOC
(
_IOC_READ
, 'E', 0x1a,†’è

	)

115 
	#EVIOCGSW
(
Ën
è
	`_IOC
(
_IOC_READ
, 'E', 0x1b,†’è

	)

117 
	#EVIOCGBIT
(
ev
,
Ën
è
	`_IOC
(
_IOC_READ
, 'E', 0x20 + (ev),†’è

	)

118 
	#EVIOCGABS
(
abs
è
	`_IOR
('E', 0x40 + (abs), 
šput_absšfo
è

	)

119 
	#EVIOCSABS
(
abs
è
	`_IOW
('E', 0xc0 + (abs), 
šput_absšfo
è

	)

121 
	#EVIOCSFF
 
	`_IOC
(
_IOC_WRITE
, 'E', 0x80, (
ff_efãù
)è

	)

122 
	#EVIOCRMFF
 
	`_IOW
('E', 0x81, è

	)

123 
	#EVIOCGEFFECTS
 
	`_IOR
('E', 0x84, è

	)

125 
	#EVIOCGRAB
 
	`_IOW
('E', 0x90, è

	)

131 
	#INPUT_PROP_POINTER
 0x00

	)

132 
	#INPUT_PROP_DIRECT
 0x01

	)

133 
	#INPUT_PROP_BUTTONPAD
 0x02

	)

134 
	#INPUT_PROP_SEMI_MT
 0x03

	)

136 
	#INPUT_PROP_MAX
 0x1f

	)

137 
	#INPUT_PROP_CNT
 (
INPUT_PROP_MAX
 + 1)

	)

143 
	#EV_SYN
 0x00

	)

144 
	#EV_KEY
 0x01

	)

145 
	#EV_REL
 0x02

	)

146 
	#EV_ABS
 0x03

	)

147 
	#EV_MSC
 0x04

	)

148 
	#EV_SW
 0x05

	)

149 
	#EV_LED
 0x11

	)

150 
	#EV_SND
 0x12

	)

151 
	#EV_REP
 0x14

	)

152 
	#EV_FF
 0x15

	)

153 
	#EV_PWR
 0x16

	)

154 
	#EV_FF_STATUS
 0x17

	)

155 
	#EV_MAX
 0x1f

	)

156 
	#EV_CNT
 (
EV_MAX
+1)

	)

162 
	#SYN_REPORT
 0

	)

163 
	#SYN_CONFIG
 1

	)

164 
	#SYN_MT_REPORT
 2

	)

165 
	#SYN_DROPPED
 3

	)

178 
	#KEY_RESERVED
 0

	)

179 
	#KEY_ESC
 1

	)

180 
	#KEY_1
 2

	)

181 
	#KEY_2
 3

	)

182 
	#KEY_3
 4

	)

183 
	#KEY_4
 5

	)

184 
	#KEY_5
 6

	)

185 
	#KEY_6
 7

	)

186 
	#KEY_7
 8

	)

187 
	#KEY_8
 9

	)

188 
	#KEY_9
 10

	)

189 
	#KEY_0
 11

	)

190 
	#KEY_MINUS
 12

	)

191 
	#KEY_EQUAL
 13

	)

192 
	#KEY_BACKSPACE
 14

	)

193 
	#KEY_TAB
 15

	)

194 
	#KEY_Q
 16

	)

195 
	#KEY_W
 17

	)

196 
	#KEY_E
 18

	)

197 
	#KEY_R
 19

	)

198 
	#KEY_T
 20

	)

199 
	#KEY_Y
 21

	)

200 
	#KEY_U
 22

	)

201 
	#KEY_I
 23

	)

202 
	#KEY_O
 24

	)

203 
	#KEY_P
 25

	)

204 
	#KEY_LEFTBRACE
 26

	)

205 
	#KEY_RIGHTBRACE
 27

	)

206 
	#KEY_ENTER
 28

	)

207 
	#KEY_LEFTCTRL
 29

	)

208 
	#KEY_A
 30

	)

209 
	#KEY_S
 31

	)

210 
	#KEY_D
 32

	)

211 
	#KEY_F
 33

	)

212 
	#KEY_G
 34

	)

213 
	#KEY_H
 35

	)

214 
	#KEY_J
 36

	)

215 
	#KEY_K
 37

	)

216 
	#KEY_L
 38

	)

217 
	#KEY_SEMICOLON
 39

	)

218 
	#KEY_APOSTROPHE
 40

	)

219 
	#KEY_GRAVE
 41

	)

220 
	#KEY_LEFTSHIFT
 42

	)

221 
	#KEY_BACKSLASH
 43

	)

222 
	#KEY_Z
 44

	)

223 
	#KEY_X
 45

	)

224 
	#KEY_C
 46

	)

225 
	#KEY_V
 47

	)

226 
	#KEY_B
 48

	)

227 
	#KEY_N
 49

	)

228 
	#KEY_M
 50

	)

229 
	#KEY_COMMA
 51

	)

230 
	#KEY_DOT
 52

	)

231 
	#KEY_SLASH
 53

	)

232 
	#KEY_RIGHTSHIFT
 54

	)

233 
	#KEY_KPASTERISK
 55

	)

234 
	#KEY_LEFTALT
 56

	)

235 
	#KEY_SPACE
 57

	)

236 
	#KEY_CAPSLOCK
 58

	)

237 
	#KEY_F1
 59

	)

238 
	#KEY_F2
 60

	)

239 
	#KEY_F3
 61

	)

240 
	#KEY_F4
 62

	)

241 
	#KEY_F5
 63

	)

242 
	#KEY_F6
 64

	)

243 
	#KEY_F7
 65

	)

244 
	#KEY_F8
 66

	)

245 
	#KEY_F9
 67

	)

246 
	#KEY_F10
 68

	)

247 
	#KEY_NUMLOCK
 69

	)

248 
	#KEY_SCROLLLOCK
 70

	)

249 
	#KEY_KP7
 71

	)

250 
	#KEY_KP8
 72

	)

251 
	#KEY_KP9
 73

	)

252 
	#KEY_KPMINUS
 74

	)

253 
	#KEY_KP4
 75

	)

254 
	#KEY_KP5
 76

	)

255 
	#KEY_KP6
 77

	)

256 
	#KEY_KPPLUS
 78

	)

257 
	#KEY_KP1
 79

	)

258 
	#KEY_KP2
 80

	)

259 
	#KEY_KP3
 81

	)

260 
	#KEY_KP0
 82

	)

261 
	#KEY_KPDOT
 83

	)

263 
	#KEY_ZENKAKUHANKAKU
 85

	)

264 
	#KEY_102ND
 86

	)

265 
	#KEY_F11
 87

	)

266 
	#KEY_F12
 88

	)

267 
	#KEY_RO
 89

	)

268 
	#KEY_KATAKANA
 90

	)

269 
	#KEY_HIRAGANA
 91

	)

270 
	#KEY_HENKAN
 92

	)

271 
	#KEY_KATAKANAHIRAGANA
 93

	)

272 
	#KEY_MUHENKAN
 94

	)

273 
	#KEY_KPJPCOMMA
 95

	)

274 
	#KEY_KPENTER
 96

	)

275 
	#KEY_RIGHTCTRL
 97

	)

276 
	#KEY_KPSLASH
 98

	)

277 
	#KEY_SYSRQ
 99

	)

278 
	#KEY_RIGHTALT
 100

	)

279 
	#KEY_LINEFEED
 101

	)

280 
	#KEY_HOME
 102

	)

281 
	#KEY_UP
 103

	)

282 
	#KEY_PAGEUP
 104

	)

283 
	#KEY_LEFT
 105

	)

284 
	#KEY_RIGHT
 106

	)

285 
	#KEY_END
 107

	)

286 
	#KEY_DOWN
 108

	)

287 
	#KEY_PAGEDOWN
 109

	)

288 
	#KEY_INSERT
 110

	)

289 
	#KEY_DELETE
 111

	)

290 
	#KEY_MACRO
 112

	)

291 
	#KEY_MUTE
 113

	)

292 
	#KEY_VOLUMEDOWN
 114

	)

293 
	#KEY_VOLUMEUP
 115

	)

294 
	#KEY_POWER
 116

	)

295 
	#KEY_KPEQUAL
 117

	)

296 
	#KEY_KPPLUSMINUS
 118

	)

297 
	#KEY_PAUSE
 119

	)

298 
	#KEY_SCALE
 120

	)

300 
	#KEY_KPCOMMA
 121

	)

301 
	#KEY_HANGEUL
 122

	)

302 
	#KEY_HANGUEL
 
KEY_HANGEUL


	)

303 
	#KEY_HANJA
 123

	)

304 
	#KEY_YEN
 124

	)

305 
	#KEY_LEFTMETA
 125

	)

306 
	#KEY_RIGHTMETA
 126

	)

307 
	#KEY_COMPOSE
 127

	)

309 
	#KEY_STOP
 128

	)

310 
	#KEY_AGAIN
 129

	)

311 
	#KEY_PROPS
 130

	)

312 
	#KEY_UNDO
 131

	)

313 
	#KEY_FRONT
 132

	)

314 
	#KEY_COPY
 133

	)

315 
	#KEY_OPEN
 134

	)

316 
	#KEY_PASTE
 135

	)

317 
	#KEY_FIND
 136

	)

318 
	#KEY_CUT
 137

	)

319 
	#KEY_HELP
 138

	)

320 
	#KEY_MENU
 139

	)

321 
	#KEY_CALC
 140

	)

322 
	#KEY_SETUP
 141

	)

323 
	#KEY_SLEEP
 142

	)

324 
	#KEY_WAKEUP
 143

	)

325 
	#KEY_FILE
 144

	)

326 
	#KEY_SENDFILE
 145

	)

327 
	#KEY_DELETEFILE
 146

	)

328 
	#KEY_XFER
 147

	)

329 
	#KEY_PROG1
 148

	)

330 
	#KEY_PROG2
 149

	)

331 
	#KEY_WWW
 150

	)

332 
	#KEY_MSDOS
 151

	)

333 
	#KEY_COFFEE
 152

	)

334 
	#KEY_SCREENLOCK
 
KEY_COFFEE


	)

335 
	#KEY_DIRECTION
 153

	)

336 
	#KEY_CYCLEWINDOWS
 154

	)

337 
	#KEY_MAIL
 155

	)

338 
	#KEY_BOOKMARKS
 156

	)

339 
	#KEY_COMPUTER
 157

	)

340 
	#KEY_BACK
 158

	)

341 
	#KEY_FORWARD
 159

	)

342 
	#KEY_CLOSECD
 160

	)

343 
	#KEY_EJECTCD
 161

	)

344 
	#KEY_EJECTCLOSECD
 162

	)

345 
	#KEY_NEXTSONG
 163

	)

346 
	#KEY_PLAYPAUSE
 164

	)

347 
	#KEY_PREVIOUSSONG
 165

	)

348 
	#KEY_STOPCD
 166

	)

349 
	#KEY_RECORD
 167

	)

350 
	#KEY_REWIND
 168

	)

351 
	#KEY_PHONE
 169

	)

352 
	#KEY_ISO
 170

	)

353 
	#KEY_CONFIG
 171

	)

354 
	#KEY_HOMEPAGE
 172

	)

355 
	#KEY_REFRESH
 173

	)

356 
	#KEY_EXIT
 174

	)

357 
	#KEY_MOVE
 175

	)

358 
	#KEY_EDIT
 176

	)

359 
	#KEY_SCROLLUP
 177

	)

360 
	#KEY_SCROLLDOWN
 178

	)

361 
	#KEY_KPLEFTPAREN
 179

	)

362 
	#KEY_KPRIGHTPAREN
 180

	)

363 
	#KEY_NEW
 181

	)

364 
	#KEY_REDO
 182

	)

366 
	#KEY_F13
 183

	)

367 
	#KEY_F14
 184

	)

368 
	#KEY_F15
 185

	)

369 
	#KEY_F16
 186

	)

370 
	#KEY_F17
 187

	)

371 
	#KEY_F18
 188

	)

372 
	#KEY_F19
 189

	)

373 
	#KEY_F20
 190

	)

374 
	#KEY_F21
 191

	)

375 
	#KEY_F22
 192

	)

376 
	#KEY_F23
 193

	)

377 
	#KEY_F24
 194

	)

379 
	#KEY_PLAYCD
 200

	)

380 
	#KEY_PAUSECD
 201

	)

381 
	#KEY_PROG3
 202

	)

382 
	#KEY_PROG4
 203

	)

383 
	#KEY_DASHBOARD
 204

	)

384 
	#KEY_SUSPEND
 205

	)

385 
	#KEY_CLOSE
 206

	)

386 
	#KEY_PLAY
 207

	)

387 
	#KEY_FASTFORWARD
 208

	)

388 
	#KEY_BASSBOOST
 209

	)

389 
	#KEY_PRINT
 210

	)

390 
	#KEY_HP
 211

	)

391 
	#KEY_CAMERA
 212

	)

392 
	#KEY_SOUND
 213

	)

393 
	#KEY_QUESTION
 214

	)

394 
	#KEY_EMAIL
 215

	)

395 
	#KEY_CHAT
 216

	)

396 
	#KEY_SEARCH
 217

	)

397 
	#KEY_CONNECT
 218

	)

398 
	#KEY_FINANCE
 219

	)

399 
	#KEY_SPORT
 220

	)

400 
	#KEY_SHOP
 221

	)

401 
	#KEY_ALTERASE
 222

	)

402 
	#KEY_CANCEL
 223

	)

403 
	#KEY_BRIGHTNESSDOWN
 224

	)

404 
	#KEY_BRIGHTNESSUP
 225

	)

405 
	#KEY_MEDIA
 226

	)

407 
	#KEY_SWITCHVIDEOMODE
 227

	)

409 
	#KEY_KBDILLUMTOGGLE
 228

	)

410 
	#KEY_KBDILLUMDOWN
 229

	)

411 
	#KEY_KBDILLUMUP
 230

	)

413 
	#KEY_SEND
 231

	)

414 
	#KEY_REPLY
 232

	)

415 
	#KEY_FORWARDMAIL
 233

	)

416 
	#KEY_SAVE
 234

	)

417 
	#KEY_DOCUMENTS
 235

	)

419 
	#KEY_BATTERY
 236

	)

421 
	#KEY_BLUETOOTH
 237

	)

422 
	#KEY_WLAN
 238

	)

423 
	#KEY_UWB
 239

	)

425 
	#KEY_UNKNOWN
 240

	)

427 
	#KEY_VIDEO_NEXT
 241

	)

428 
	#KEY_VIDEO_PREV
 242

	)

429 
	#KEY_BRIGHTNESS_CYCLE
 243

	)

430 
	#KEY_BRIGHTNESS_ZERO
 244

	)

431 
	#KEY_DISPLAY_OFF
 245

	)

433 
	#KEY_WIMAX
 246

	)

434 
	#KEY_RFKILL
 247

	)

436 
	#KEY_MICMUTE
 248

	)

440 
	#BTN_MISC
 0x100

	)

441 
	#BTN_0
 0x100

	)

442 
	#BTN_1
 0x101

	)

443 
	#BTN_2
 0x102

	)

444 
	#BTN_3
 0x103

	)

445 
	#BTN_4
 0x104

	)

446 
	#BTN_5
 0x105

	)

447 
	#BTN_6
 0x106

	)

448 
	#BTN_7
 0x107

	)

449 
	#BTN_8
 0x108

	)

450 
	#BTN_9
 0x109

	)

452 
	#BTN_MOUSE
 0x110

	)

453 
	#BTN_LEFT
 0x110

	)

454 
	#BTN_RIGHT
 0x111

	)

455 
	#BTN_MIDDLE
 0x112

	)

456 
	#BTN_SIDE
 0x113

	)

457 
	#BTN_EXTRA
 0x114

	)

458 
	#BTN_FORWARD
 0x115

	)

459 
	#BTN_BACK
 0x116

	)

460 
	#BTN_TASK
 0x117

	)

462 
	#BTN_JOYSTICK
 0x120

	)

463 
	#BTN_TRIGGER
 0x120

	)

464 
	#BTN_THUMB
 0x121

	)

465 
	#BTN_THUMB2
 0x122

	)

466 
	#BTN_TOP
 0x123

	)

467 
	#BTN_TOP2
 0x124

	)

468 
	#BTN_PINKIE
 0x125

	)

469 
	#BTN_BASE
 0x126

	)

470 
	#BTN_BASE2
 0x127

	)

471 
	#BTN_BASE3
 0x128

	)

472 
	#BTN_BASE4
 0x129

	)

473 
	#BTN_BASE5
 0x12a

	)

474 
	#BTN_BASE6
 0x12b

	)

475 
	#BTN_DEAD
 0x12f

	)

477 
	#BTN_GAMEPAD
 0x130

	)

478 
	#BTN_A
 0x130

	)

479 
	#BTN_B
 0x131

	)

480 
	#BTN_C
 0x132

	)

481 
	#BTN_X
 0x133

	)

482 
	#BTN_Y
 0x134

	)

483 
	#BTN_Z
 0x135

	)

484 
	#BTN_TL
 0x136

	)

485 
	#BTN_TR
 0x137

	)

486 
	#BTN_TL2
 0x138

	)

487 
	#BTN_TR2
 0x139

	)

488 
	#BTN_SELECT
 0x13a

	)

489 
	#BTN_START
 0x13b

	)

490 
	#BTN_MODE
 0x13c

	)

491 
	#BTN_THUMBL
 0x13d

	)

492 
	#BTN_THUMBR
 0x13e

	)

494 
	#BTN_DIGI
 0x140

	)

495 
	#BTN_TOOL_PEN
 0x140

	)

496 
	#BTN_TOOL_RUBBER
 0x141

	)

497 
	#BTN_TOOL_BRUSH
 0x142

	)

498 
	#BTN_TOOL_PENCIL
 0x143

	)

499 
	#BTN_TOOL_AIRBRUSH
 0x144

	)

500 
	#BTN_TOOL_FINGER
 0x145

	)

501 
	#BTN_TOOL_MOUSE
 0x146

	)

502 
	#BTN_TOOL_LENS
 0x147

	)

503 
	#BTN_TOOL_QUINTTAP
 0x148

	)

504 
	#BTN_TOUCH
 0x14a

	)

505 
	#BTN_STYLUS
 0x14b

	)

506 
	#BTN_STYLUS2
 0x14c

	)

507 
	#BTN_TOOL_DOUBLETAP
 0x14d

	)

508 
	#BTN_TOOL_TRIPLETAP
 0x14e

	)

509 
	#BTN_TOOL_QUADTAP
 0x14à

	)

511 
	#BTN_WHEEL
 0x150

	)

512 
	#BTN_GEAR_DOWN
 0x150

	)

513 
	#BTN_GEAR_UP
 0x151

	)

515 
	#KEY_OK
 0x160

	)

516 
	#KEY_SELECT
 0x161

	)

517 
	#KEY_GOTO
 0x162

	)

518 
	#KEY_CLEAR
 0x163

	)

519 
	#KEY_POWER2
 0x164

	)

520 
	#KEY_OPTION
 0x165

	)

521 
	#KEY_INFO
 0x166

	)

522 
	#KEY_TIME
 0x167

	)

523 
	#KEY_VENDOR
 0x168

	)

524 
	#KEY_ARCHIVE
 0x169

	)

525 
	#KEY_PROGRAM
 0x16¨

	)

526 
	#KEY_CHANNEL
 0x16b

	)

527 
	#KEY_FAVORITES
 0x16c

	)

528 
	#KEY_EPG
 0x16d

	)

529 
	#KEY_PVR
 0x16

	)

530 
	#KEY_MHP
 0x16f

	)

531 
	#KEY_LANGUAGE
 0x170

	)

532 
	#KEY_TITLE
 0x171

	)

533 
	#KEY_SUBTITLE
 0x172

	)

534 
	#KEY_ANGLE
 0x173

	)

535 
	#KEY_ZOOM
 0x174

	)

536 
	#KEY_MODE
 0x175

	)

537 
	#KEY_KEYBOARD
 0x176

	)

538 
	#KEY_SCREEN
 0x177

	)

539 
	#KEY_PC
 0x178

	)

540 
	#KEY_TV
 0x179

	)

541 
	#KEY_TV2
 0x17¨

	)

542 
	#KEY_VCR
 0x17b

	)

543 
	#KEY_VCR2
 0x17ø

	)

544 
	#KEY_SAT
 0x17d

	)

545 
	#KEY_SAT2
 0x17e

	)

546 
	#KEY_CD
 0x17à

	)

547 
	#KEY_TAPE
 0x180

	)

548 
	#KEY_RADIO
 0x181

	)

549 
	#KEY_TUNER
 0x182

	)

550 
	#KEY_PLAYER
 0x183

	)

551 
	#KEY_TEXT
 0x184

	)

552 
	#KEY_DVD
 0x185

	)

553 
	#KEY_AUX
 0x186

	)

554 
	#KEY_MP3
 0x187

	)

555 
	#KEY_AUDIO
 0x188

	)

556 
	#KEY_VIDEO
 0x189

	)

557 
	#KEY_DIRECTORY
 0x18a

	)

558 
	#KEY_LIST
 0x18b

	)

559 
	#KEY_MEMO
 0x18ø

	)

560 
	#KEY_CALENDAR
 0x18d

	)

561 
	#KEY_RED
 0x18e

	)

562 
	#KEY_GREEN
 0x18f

	)

563 
	#KEY_YELLOW
 0x190

	)

564 
	#KEY_BLUE
 0x191

	)

565 
	#KEY_CHANNELUP
 0x192

	)

566 
	#KEY_CHANNELDOWN
 0x193

	)

567 
	#KEY_FIRST
 0x194

	)

568 
	#KEY_LAST
 0x195

	)

569 
	#KEY_AB
 0x196

	)

570 
	#KEY_NEXT
 0x197

	)

571 
	#KEY_RESTART
 0x198

	)

572 
	#KEY_SLOW
 0x199

	)

573 
	#KEY_SHUFFLE
 0x19a

	)

574 
	#KEY_BREAK
 0x19b

	)

575 
	#KEY_PREVIOUS
 0x19c

	)

576 
	#KEY_DIGITS
 0x19d

	)

577 
	#KEY_TEEN
 0x19e

	)

578 
	#KEY_TWEN
 0x19f

	)

579 
	#KEY_VIDEOPHONE
 0x1a0

	)

580 
	#KEY_GAMES
 0x1a1

	)

581 
	#KEY_ZOOMIN
 0x1a2

	)

582 
	#KEY_ZOOMOUT
 0x1a3

	)

583 
	#KEY_ZOOMRESET
 0x1a4

	)

584 
	#KEY_WORDPROCESSOR
 0x1a5

	)

585 
	#KEY_EDITOR
 0x1a6

	)

586 
	#KEY_SPREADSHEET
 0x1a7

	)

587 
	#KEY_GRAPHICSEDITOR
 0x1a8

	)

588 
	#KEY_PRESENTATION
 0x1a9

	)

589 
	#KEY_DATABASE
 0x1¯

	)

590 
	#KEY_NEWS
 0x1ab

	)

591 
	#KEY_VOICEMAIL
 0x1aø

	)

592 
	#KEY_ADDRESSBOOK
 0x1ad

	)

593 
	#KEY_MESSENGER
 0x1«

	)

594 
	#KEY_DISPLAYTOGGLE
 0x1aà

	)

595 
	#KEY_SPELLCHECK
 0x1b0

	)

596 
	#KEY_LOGOFF
 0x1b1

	)

598 
	#KEY_DOLLAR
 0x1b2

	)

599 
	#KEY_EURO
 0x1b3

	)

601 
	#KEY_FRAMEBACK
 0x1b4

	)

602 
	#KEY_FRAMEFORWARD
 0x1b5

	)

603 
	#KEY_CONTEXT_MENU
 0x1b6

	)

604 
	#KEY_MEDIA_REPEAT
 0x1b7

	)

605 
	#KEY_10CHANNELSUP
 0x1b8

	)

606 
	#KEY_10CHANNELSDOWN
 0x1b9

	)

607 
	#KEY_IMAGES
 0x1b¨

	)

609 
	#KEY_DEL_EOL
 0x1c0

	)

610 
	#KEY_DEL_EOS
 0x1c1

	)

611 
	#KEY_INS_LINE
 0x1c2

	)

612 
	#KEY_DEL_LINE
 0x1c3

	)

614 
	#KEY_FN
 0x1d0

	)

615 
	#KEY_FN_ESC
 0x1d1

	)

616 
	#KEY_FN_F1
 0x1d2

	)

617 
	#KEY_FN_F2
 0x1d3

	)

618 
	#KEY_FN_F3
 0x1d4

	)

619 
	#KEY_FN_F4
 0x1d5

	)

620 
	#KEY_FN_F5
 0x1d6

	)

621 
	#KEY_FN_F6
 0x1d7

	)

622 
	#KEY_FN_F7
 0x1d8

	)

623 
	#KEY_FN_F8
 0x1d9

	)

624 
	#KEY_FN_F9
 0x1da

	)

625 
	#KEY_FN_F10
 0x1db

	)

626 
	#KEY_FN_F11
 0x1dc

	)

627 
	#KEY_FN_F12
 0x1dd

	)

628 
	#KEY_FN_1
 0x1de

	)

629 
	#KEY_FN_2
 0x1df

	)

630 
	#KEY_FN_D
 0x1e0

	)

631 
	#KEY_FN_E
 0x1e1

	)

632 
	#KEY_FN_F
 0x1e2

	)

633 
	#KEY_FN_S
 0x1e3

	)

634 
	#KEY_FN_B
 0x1e4

	)

636 
	#KEY_BRL_DOT1
 0x1f1

	)

637 
	#KEY_BRL_DOT2
 0x1f2

	)

638 
	#KEY_BRL_DOT3
 0x1f3

	)

639 
	#KEY_BRL_DOT4
 0x1f4

	)

640 
	#KEY_BRL_DOT5
 0x1f5

	)

641 
	#KEY_BRL_DOT6
 0x1f6

	)

642 
	#KEY_BRL_DOT7
 0x1f7

	)

643 
	#KEY_BRL_DOT8
 0x1f8

	)

644 
	#KEY_BRL_DOT9
 0x1f9

	)

645 
	#KEY_BRL_DOT10
 0x1ç

	)

647 
	#KEY_NUMERIC_0
 0x200

	)

648 
	#KEY_NUMERIC_1
 0x201

	)

649 
	#KEY_NUMERIC_2
 0x202

	)

650 
	#KEY_NUMERIC_3
 0x203

	)

651 
	#KEY_NUMERIC_4
 0x204

	)

652 
	#KEY_NUMERIC_5
 0x205

	)

653 
	#KEY_NUMERIC_6
 0x206

	)

654 
	#KEY_NUMERIC_7
 0x207

	)

655 
	#KEY_NUMERIC_8
 0x208

	)

656 
	#KEY_NUMERIC_9
 0x209

	)

657 
	#KEY_NUMERIC_STAR
 0x20a

	)

658 
	#KEY_NUMERIC_POUND
 0x20b

	)

660 
	#KEY_CAMERA_FOCUS
 0x210

	)

661 
	#KEY_WPS_BUTTON
 0x211

	)

663 
	#KEY_TOUCHPAD_TOGGLE
 0x212

	)

664 
	#KEY_TOUCHPAD_ON
 0x213

	)

665 
	#KEY_TOUCHPAD_OFF
 0x214

	)

667 
	#KEY_CAMERA_ZOOMIN
 0x215

	)

668 
	#KEY_CAMERA_ZOOMOUT
 0x216

	)

669 
	#KEY_CAMERA_UP
 0x217

	)

670 
	#KEY_CAMERA_DOWN
 0x218

	)

671 
	#KEY_CAMERA_LEFT
 0x219

	)

672 
	#KEY_CAMERA_RIGHT
 0x21a

	)

674 
	#BTN_TRIGGER_HAPPY
 0x2c0

	)

675 
	#BTN_TRIGGER_HAPPY1
 0x2c0

	)

676 
	#BTN_TRIGGER_HAPPY2
 0x2c1

	)

677 
	#BTN_TRIGGER_HAPPY3
 0x2c2

	)

678 
	#BTN_TRIGGER_HAPPY4
 0x2c3

	)

679 
	#BTN_TRIGGER_HAPPY5
 0x2c4

	)

680 
	#BTN_TRIGGER_HAPPY6
 0x2c5

	)

681 
	#BTN_TRIGGER_HAPPY7
 0x2c6

	)

682 
	#BTN_TRIGGER_HAPPY8
 0x2c7

	)

683 
	#BTN_TRIGGER_HAPPY9
 0x2c8

	)

684 
	#BTN_TRIGGER_HAPPY10
 0x2c9

	)

685 
	#BTN_TRIGGER_HAPPY11
 0x2ÿ

	)

686 
	#BTN_TRIGGER_HAPPY12
 0x2cb

	)

687 
	#BTN_TRIGGER_HAPPY13
 0x2cc

	)

688 
	#BTN_TRIGGER_HAPPY14
 0x2cd

	)

689 
	#BTN_TRIGGER_HAPPY15
 0x2û

	)

690 
	#BTN_TRIGGER_HAPPY16
 0x2cf

	)

691 
	#BTN_TRIGGER_HAPPY17
 0x2d0

	)

692 
	#BTN_TRIGGER_HAPPY18
 0x2d1

	)

693 
	#BTN_TRIGGER_HAPPY19
 0x2d2

	)

694 
	#BTN_TRIGGER_HAPPY20
 0x2d3

	)

695 
	#BTN_TRIGGER_HAPPY21
 0x2d4

	)

696 
	#BTN_TRIGGER_HAPPY22
 0x2d5

	)

697 
	#BTN_TRIGGER_HAPPY23
 0x2d6

	)

698 
	#BTN_TRIGGER_HAPPY24
 0x2d7

	)

699 
	#BTN_TRIGGER_HAPPY25
 0x2d8

	)

700 
	#BTN_TRIGGER_HAPPY26
 0x2d9

	)

701 
	#BTN_TRIGGER_HAPPY27
 0x2da

	)

702 
	#BTN_TRIGGER_HAPPY28
 0x2db

	)

703 
	#BTN_TRIGGER_HAPPY29
 0x2dc

	)

704 
	#BTN_TRIGGER_HAPPY30
 0x2dd

	)

705 
	#BTN_TRIGGER_HAPPY31
 0x2de

	)

706 
	#BTN_TRIGGER_HAPPY32
 0x2df

	)

707 
	#BTN_TRIGGER_HAPPY33
 0x2e0

	)

708 
	#BTN_TRIGGER_HAPPY34
 0x2e1

	)

709 
	#BTN_TRIGGER_HAPPY35
 0x2e2

	)

710 
	#BTN_TRIGGER_HAPPY36
 0x2e3

	)

711 
	#BTN_TRIGGER_HAPPY37
 0x2e4

	)

712 
	#BTN_TRIGGER_HAPPY38
 0x2e5

	)

713 
	#BTN_TRIGGER_HAPPY39
 0x2e6

	)

714 
	#BTN_TRIGGER_HAPPY40
 0x2e7

	)

717 
	#KEY_MIN_INTERESTING
 
KEY_MUTE


	)

718 
	#KEY_MAX
 0x2ff

	)

719 
	#KEY_CNT
 (
KEY_MAX
+1)

	)

725 
	#REL_X
 0x00

	)

726 
	#REL_Y
 0x01

	)

727 
	#REL_Z
 0x02

	)

728 
	#REL_RX
 0x03

	)

729 
	#REL_RY
 0x04

	)

730 
	#REL_RZ
 0x05

	)

731 
	#REL_HWHEEL
 0x06

	)

732 
	#REL_DIAL
 0x07

	)

733 
	#REL_WHEEL
 0x08

	)

734 
	#REL_MISC
 0x09

	)

735 
	#REL_MAX
 0x0f

	)

736 
	#REL_CNT
 (
REL_MAX
+1)

	)

742 
	#ABS_X
 0x00

	)

743 
	#ABS_Y
 0x01

	)

744 
	#ABS_Z
 0x02

	)

745 
	#ABS_RX
 0x03

	)

746 
	#ABS_RY
 0x04

	)

747 
	#ABS_RZ
 0x05

	)

748 
	#ABS_THROTTLE
 0x06

	)

749 
	#ABS_RUDDER
 0x07

	)

750 
	#ABS_WHEEL
 0x08

	)

751 
	#ABS_GAS
 0x09

	)

752 
	#ABS_BRAKE
 0x0a

	)

753 
	#ABS_HAT0X
 0x10

	)

754 
	#ABS_HAT0Y
 0x11

	)

755 
	#ABS_HAT1X
 0x12

	)

756 
	#ABS_HAT1Y
 0x13

	)

757 
	#ABS_HAT2X
 0x14

	)

758 
	#ABS_HAT2Y
 0x15

	)

759 
	#ABS_HAT3X
 0x16

	)

760 
	#ABS_HAT3Y
 0x17

	)

761 
	#ABS_PRESSURE
 0x18

	)

762 
	#ABS_DISTANCE
 0x19

	)

763 
	#ABS_TILT_X
 0x1a

	)

764 
	#ABS_TILT_Y
 0x1b

	)

765 
	#ABS_TOOL_WIDTH
 0x1c

	)

767 
	#ABS_VOLUME
 0x20

	)

769 
	#ABS_MISC
 0x28

	)

771 
	#ABS_MT_SLOT
 0x2à

	)

772 
	#ABS_MT_TOUCH_MAJOR
 0x30

	)

773 
	#ABS_MT_TOUCH_MINOR
 0x31

	)

774 
	#ABS_MT_WIDTH_MAJOR
 0x32

	)

775 
	#ABS_MT_WIDTH_MINOR
 0x33

	)

776 
	#ABS_MT_ORIENTATION
 0x34

	)

777 
	#ABS_MT_POSITION_X
 0x35

	)

778 
	#ABS_MT_POSITION_Y
 0x36

	)

779 
	#ABS_MT_TOOL_TYPE
 0x37

	)

780 
	#ABS_MT_BLOB_ID
 0x38

	)

781 
	#ABS_MT_TRACKING_ID
 0x39

	)

782 
	#ABS_MT_PRESSURE
 0x3¨

	)

783 
	#ABS_MT_DISTANCE
 0x3b

	)

786 
	#ABS_MAX
 0x3f

	)

787 
	#ABS_CNT
 (
ABS_MAX
+1)

	)

793 
	#SW_LID
 0x00

	)

794 
	#SW_TABLET_MODE
 0x01

	)

795 
	#SW_HEADPHONE_INSERT
 0x02

	)

796 
	#SW_RFKILL_ALL
 0x03

	)

798 
	#SW_RADIO
 
SW_RFKILL_ALL


	)

799 
	#SW_MICROPHONE_INSERT
 0x04

	)

800 
	#SW_DOCK
 0x05

	)

801 
	#SW_LINEOUT_INSERT
 0x06

	)

802 
	#SW_JACK_PHYSICAL_INSERT
 0x07

	)

803 
	#SW_VIDEOOUT_INSERT
 0x08

	)

804 
	#SW_CAMERA_LENS_COVER
 0x09

	)

805 
	#SW_KEYPAD_SLIDE
 0x0¨

	)

806 
	#SW_FRONT_PROXIMITY
 0x0b

	)

807 
	#SW_ROTATE_LOCK
 0x0ø

	)

808 
	#SW_LINEIN_INSERT
 0x0d

	)

809 
	#SW_MAX
 0x0f

	)

810 
	#SW_CNT
 (
SW_MAX
+1)

	)

816 
	#MSC_SERIAL
 0x00

	)

817 
	#MSC_PULSELED
 0x01

	)

818 
	#MSC_GESTURE
 0x02

	)

819 
	#MSC_RAW
 0x03

	)

820 
	#MSC_SCAN
 0x04

	)

821 
	#MSC_MAX
 0x07

	)

822 
	#MSC_CNT
 (
MSC_MAX
+1)

	)

828 
	#LED_NUML
 0x00

	)

829 
	#LED_CAPSL
 0x01

	)

830 
	#LED_SCROLLL
 0x02

	)

831 
	#LED_COMPOSE
 0x03

	)

832 
	#LED_KANA
 0x04

	)

833 
	#LED_SLEEP
 0x05

	)

834 
	#LED_SUSPEND
 0x06

	)

835 
	#LED_MUTE
 0x07

	)

836 
	#LED_MISC
 0x08

	)

837 
	#LED_MAIL
 0x09

	)

838 
	#LED_CHARGING
 0x0a

	)

839 
	#LED_MAX
 0x0f

	)

840 
	#LED_CNT
 (
LED_MAX
+1)

	)

846 
	#REP_DELAY
 0x00

	)

847 
	#REP_PERIOD
 0x01

	)

848 
	#REP_MAX
 0x01

	)

849 
	#REP_CNT
 (
REP_MAX
+1)

	)

855 
	#SND_CLICK
 0x00

	)

856 
	#SND_BELL
 0x01

	)

857 
	#SND_TONE
 0x02

	)

858 
	#SND_MAX
 0x07

	)

859 
	#SND_CNT
 (
SND_MAX
+1)

	)

865 
	#ID_BUS
 0

	)

866 
	#ID_VENDOR
 1

	)

867 
	#ID_PRODUCT
 2

	)

868 
	#ID_VERSION
 3

	)

870 
	#BUS_PCI
 0x01

	)

871 
	#BUS_ISAPNP
 0x02

	)

872 
	#BUS_USB
 0x03

	)

873 
	#BUS_HIL
 0x04

	)

874 
	#BUS_BLUETOOTH
 0x05

	)

875 
	#BUS_VIRTUAL
 0x06

	)

877 
	#BUS_ISA
 0x10

	)

878 
	#BUS_I8042
 0x11

	)

879 
	#BUS_XTKBD
 0x12

	)

880 
	#BUS_RS232
 0x13

	)

881 
	#BUS_GAMEPORT
 0x14

	)

882 
	#BUS_PARPORT
 0x15

	)

883 
	#BUS_AMIGA
 0x16

	)

884 
	#BUS_ADB
 0x17

	)

885 
	#BUS_I2C
 0x18

	)

886 
	#BUS_HOST
 0x19

	)

887 
	#BUS_GSC
 0x1A

	)

888 
	#BUS_ATARI
 0x1B

	)

889 
	#BUS_SPI
 0x1C

	)

894 
	#MT_TOOL_FINGER
 0

	)

895 
	#MT_TOOL_PEN
 1

	)

896 
	#MT_TOOL_MAX
 1

	)

901 
	#FF_STATUS_STOPPED
 0x00

	)

902 
	#FF_STATUS_PLAYING
 0x01

	)

903 
	#FF_STATUS_MAX
 0x01

	)

920 
	sff_»¶ay
 {

921 
__u16
 
	mËngth
;

922 
__u16
 
	md–ay
;

930 
	sff_Œigg”
 {

931 
__u16
 
	mbu‰Ú
;

932 
__u16
 
	mš‹rv®
;

947 
	sff_’v–İe
 {

948 
__u16
 
	m©ck_Ëngth
;

949 
__u16
 
	m©ck_Ëv–
;

950 
__u16
 
	mçde_Ëngth
;

951 
__u16
 
	mçde_Ëv–
;

959 
	sff_cÚ¡ªt_efãù
 {

960 
__s16
 
	mËv–
;

961 
ff_’v–İe
 
	m’v–İe
;

970 
	sff_¿mp_efãù
 {

971 
__s16
 
	m¡¬t_Ëv–
;

972 
__s16
 
	m’d_Ëv–
;

973 
ff_’v–İe
 
	m’v–İe
;

986 
	sff_cÚd™iÚ_efãù
 {

987 
__u16
 
	mright_§tu¿tiÚ
;

988 
__u16
 
	mËá_§tu¿tiÚ
;

990 
__s16
 
	mright_cÛff
;

991 
__s16
 
	mËá_cÛff
;

993 
__u16
 
	md—dbªd
;

994 
__s16
 
	mûÁ”
;

1015 
	sff_³riodic_efãù
 {

1016 
__u16
 
	mwavefÜm
;

1017 
__u16
 
	m³riod
;

1018 
__s16
 
	mmagn™ude
;

1019 
__s16
 
	moff£t
;

1020 
__u16
 
	mpha£
;

1022 
ff_’v–İe
 
	m’v–İe
;

1024 
__u32
 
	mcu¡om_Ën
;

1025 
__s16
 *
	mcu¡om_d©a
;

1036 
	sff_rumbË_efãù
 {

1037 
__u16
 
	m¡rÚg_magn™ude
;

1038 
__u16
 
	mw—k_magn™ude
;

1064 
	sff_efãù
 {

1065 
__u16
 
	mty³
;

1066 
__s16
 
	mid
;

1067 
__u16
 
	mdœeùiÚ
;

1068 
ff_Œigg”
 
	mŒigg”
;

1069 
ff_»¶ay
 
	m»¶ay
;

1072 
ff_cÚ¡ªt_efãù
 
	mcÚ¡ªt
;

1073 
ff_¿mp_efãù
 
	m¿mp
;

1074 
ff_³riodic_efãù
 
	m³riodic
;

1075 
ff_cÚd™iÚ_efãù
 
	mcÚd™iÚ
[2];

1076 
ff_rumbË_efãù
 
	mrumbË
;

1077 } 
	mu
;

1084 
	#FF_RUMBLE
 0x50

	)

1085 
	#FF_PERIODIC
 0x51

	)

1086 
	#FF_CONSTANT
 0x52

	)

1087 
	#FF_SPRING
 0x53

	)

1088 
	#FF_FRICTION
 0x54

	)

1089 
	#FF_DAMPER
 0x55

	)

1090 
	#FF_INERTIA
 0x56

	)

1091 
	#FF_RAMP
 0x57

	)

1093 
	#FF_EFFECT_MIN
 
FF_RUMBLE


	)

1094 
	#FF_EFFECT_MAX
 
FF_RAMP


	)

1100 
	#FF_SQUARE
 0x58

	)

1101 
	#FF_TRIANGLE
 0x59

	)

1102 
	#FF_SINE
 0x5a

	)

1103 
	#FF_SAW_UP
 0x5b

	)

1104 
	#FF_SAW_DOWN
 0x5c

	)

1105 
	#FF_CUSTOM
 0x5d

	)

1107 
	#FF_WAVEFORM_MIN
 
FF_SQUARE


	)

1108 
	#FF_WAVEFORM_MAX
 
FF_CUSTOM


	)

1114 
	#FF_GAIN
 0x60

	)

1115 
	#FF_AUTOCENTER
 0x61

	)

1117 
	#FF_MAX
 0x7f

	)

1118 
	#FF_CNT
 (
FF_MAX
+1)

	)

	@/usr/include/linux/ipc.h

1 #iâdeà
_LINUX_IPC_H


2 
	#_LINUX_IPC_H


	)

4 
	~<lšux/ty³s.h
>

6 
	#IPC_PRIVATE
 ((
__k”Ãl_key_t
è0)

	)

9 
	sc_³rm


11 
__k”Ãl_key_t
 
	mkey
;

12 
__k”Ãl_uid_t
 
	muid
;

13 
__k”Ãl_gid_t
 
	mgid
;

14 
__k”Ãl_uid_t
 
	mcuid
;

15 
__k”Ãl_gid_t
 
	mcgid
;

16 
__k”Ãl_mode_t
 
	mmode
;

17 
	m£q
;

21 
	~<asm/cbuf.h
>

24 
	#IPC_CREAT
 00001000

	)

25 
	#IPC_EXCL
 00002000

	)

26 
	#IPC_NOWAIT
 00004000

	)

31 
	#IPC_DIPC
 00010000

	)

32 
	#IPC_OWN
 00020000

	)

38 
	#IPC_RMID
 0

	)

39 
	#IPC_SET
 1

	)

40 
	#IPC_STAT
 2

	)

41 
	#IPC_INFO
 3

	)

47 
	#IPC_OLD
 0

	)

49 
	#IPC_64
 0x0100

	)

57 
	sc_kludge
 {

58 
msgbuf
 *
	mmsgp
;

59 
	mmsgtyp
;

62 
	#SEMOP
 1

	)

63 
	#SEMGET
 2

	)

64 
	#SEMCTL
 3

	)

65 
	#SEMTIMEDOP
 4

	)

66 
	#MSGSND
 11

	)

67 
	#MSGRCV
 12

	)

68 
	#MSGGET
 13

	)

69 
	#MSGCTL
 14

	)

70 
	#SHMAT
 21

	)

71 
	#SHMDT
 22

	)

72 
	#SHMGET
 23

	)

73 
	#SHMCTL
 24

	)

76 
	#DIPC
 25

	)

78 
	#IPCCALL
(
v”siÚ
,
İ
è((v”siÚ)<<16 | (İ))

	)

	@/usr/include/linux/irqnr.h

1 #iâdeà
_LINUX_IRQNR_H


2 
	#_LINUX_IRQNR_H


	)

	@/usr/include/linux/kernelcapi.h

10 #iâdeà
__KERNELCAPI_H__


11 
	#__KERNELCAPI_H__


	)

13 
	#CAPI_MAXAPPL
 240

	)

14 
	#CAPI_MAXCONTR
 32

	)

15 
	#CAPI_MAXDATAWINDOW
 8

	)

18 
	skÿpi_æagdef
 {

19 
	mcÚŒ
;

20 
	mæag
;

21 } 
	tkÿpi_æagdef
;

23 
	skÿpi_ÿrddef
 {

24 
	mdriv”
[32];

25 
	mpÜt
;

26 
	mœq
;

27 
	mmemba£
;

28 
	mÿrdÄ
;

29 } 
	tkÿpi_ÿrddef
;

32 
	#KCAPI_CMD_TRACE
 10

	)

33 
	#KCAPI_CMD_ADDCARD
 11

	)

39 
	#KCAPI_TRACE_OFF
 0

	)

40 
	#KCAPI_TRACE_SHORT_NO_DATA
 1

	)

41 
	#KCAPI_TRACE_FULL_NO_DATA
 2

	)

42 
	#KCAPI_TRACE_SHORT
 3

	)

43 
	#KCAPI_TRACE_FULL
 4

	)

	@/usr/include/linux/limits.h

1 #iâdeà
_LINUX_LIMITS_H


2 
	#_LINUX_LIMITS_H


	)

4 
	#NR_OPEN
 1024

	)

6 
	#NGROUPS_MAX
 65536

	)

7 
	#ARG_MAX
 131072

	)

8 
	#LINK_MAX
 127

	)

9 
	#MAX_CANON
 255

	)

10 
	#MAX_INPUT
 255

	)

11 
	#NAME_MAX
 255

	)

12 
	#PATH_MAX
 4096

	)

13 
	#PIPE_BUF
 4096

	)

14 
	#XATTR_NAME_MAX
 255

	)

15 
	#XATTR_SIZE_MAX
 65536

	)

16 
	#XATTR_LIST_MAX
 65536

	)

18 
	#RTSIG_MAX
 32

	)

	@/usr/include/linux/ncp.h

10 #iâdeà
_LINUX_NCP_H


11 
	#_LINUX_NCP_H


	)

13 
	~<lšux/ty³s.h
>

15 
	#NCP_PTYPE
 (0x11)

	)

16 
	#NCP_PORT
 (0x0451)

	)

18 
	#NCP_ALLOC_SLOT_REQUEST
 (0x1111)

	)

19 
	#NCP_REQUEST
 (0x2222)

	)

20 
	#NCP_DEALLOC_SLOT_REQUEST
 (0x5555)

	)

22 
	snı_»que¡_h—d”
 {

23 
__u16
 
	mty³
;

24 
__u8
 
	m£qu’û
;

25 
__u8
 
	mcÚn_low
;

26 
__u8
 
	msk
;

27 
__u8
 
	mcÚn_high
;

28 
__u8
 
	mfunùiÚ
;

29 
__u8
 
	md©a
[0];

30 } 
__©Œibu‹__
((
·cked
));

32 
	#NCP_REPLY
 (0x3333)

	)

33 
	#NCP_WATCHDOG
 (0x3E3E)

	)

34 
	#NCP_POSITIVE_ACK
 (0x9999)

	)

36 
	snı_»¶y_h—d”
 {

37 
__u16
 
	mty³
;

38 
__u8
 
	m£qu’û
;

39 
__u8
 
	mcÚn_low
;

40 
__u8
 
	msk
;

41 
__u8
 
	mcÚn_high
;

42 
__u8
 
	mcom¶‘iÚ_code
;

43 
__u8
 
	mcÚÃùiÚ_¡©e
;

44 
__u8
 
	md©a
[0];

45 } 
__©Œibu‹__
((
·cked
));

47 
	#NCP_VOLNAME_LEN
 (16)

	)

48 
	#NCP_NUMBER_OF_VOLUMES
 (256)

	)

49 
	snı_vŞume_šfo
 {

50 
__u32
 
	mtÙ®_blocks
;

51 
__u32
 
	mä“_blocks
;

52 
__u32
 
	mpurg—bË_blocks
;

53 
__u32
 
	mnÙ_y‘_purg—bË_blocks
;

54 
__u32
 
	mtÙ®_dœ_’Œ›s
;

55 
__u32
 
	mavaabË_dœ_’Œ›s
;

56 
__u8
 
	m£ùÜs_³r_block
;

57 
	mvŞume_Çme
[
NCP_VOLNAME_LEN
 + 1];

60 
	#AR_READ
 (
	`ıu_to_Ë16
(1))

	)

61 
	#AR_WRITE
 (
	`ıu_to_Ë16
(2))

	)

62 
	#AR_EXCLUSIVE
 (
	`ıu_to_Ë16
(0x20))

	)

64 
	#NCP_FILE_ID_LEN
 6

	)

67 
	#NW_NS_DOS
 0

	)

68 
	#NW_NS_MAC
 1

	)

69 
	#NW_NS_NFS
 2

	)

70 
	#NW_NS_FTAM
 3

	)

71 
	#NW_NS_OS2
 4

	)

74 
	#RIM_NAME
 (
	`ıu_to_Ë32
(1))

	)

75 
	#RIM_SPACE_ALLOCATED
 (
	`ıu_to_Ë32
(2))

	)

76 
	#RIM_ATTRIBUTES
 (
	`ıu_to_Ë32
(4))

	)

77 
	#RIM_DATA_SIZE
 (
	`ıu_to_Ë32
(8))

	)

78 
	#RIM_TOTAL_SIZE
 (
	`ıu_to_Ë32
(0x10))

	)

79 
	#RIM_EXT_ATTR_INFO
 (
	`ıu_to_Ë32
(0x20))

	)

80 
	#RIM_ARCHIVE
 (
	`ıu_to_Ë32
(0x40))

	)

81 
	#RIM_MODIFY
 (
	`ıu_to_Ë32
(0x80))

	)

82 
	#RIM_CREATION
 (
	`ıu_to_Ë32
(0x100))

	)

83 
	#RIM_OWNING_NAMESPACE
 (
	`ıu_to_Ë32
(0x200))

	)

84 
	#RIM_DIRECTORY
 (
	`ıu_to_Ë32
(0x400))

	)

85 
	#RIM_RIGHTS
 (
	`ıu_to_Ë32
(0x800))

	)

86 
	#RIM_ALL
 (
	`ıu_to_Ë32
(0xFFF))

	)

87 
	#RIM_COMPRESSED_INFO
 (
	`ıu_to_Ë32
(0x80000000))

	)

90 
	#NSIBM_NFS_NAME
 0x0001

	)

91 
	#NSIBM_NFS_MODE
 0x0002

	)

92 
	#NSIBM_NFS_GID
 0x0004

	)

93 
	#NSIBM_NFS_NLINKS
 0x0008

	)

94 
	#NSIBM_NFS_RDEV
 0x0010

	)

95 
	#NSIBM_NFS_LINK
 0x0020

	)

96 
	#NSIBM_NFS_CREATED
 0x0040

	)

97 
	#NSIBM_NFS_UID
 0x0080

	)

98 
	#NSIBM_NFS_ACSFLAG
 0x0100

	)

99 
	#NSIBM_NFS_MYFLAG
 0x0200

	)

102 
	#OC_MODE_OPEN
 0x01

	)

103 
	#OC_MODE_TRUNCATE
 0x02

	)

104 
	#OC_MODE_REPLACE
 0x02

	)

105 
	#OC_MODE_CREATE
 0x08

	)

108 
	#OC_ACTION_NONE
 0x00

	)

109 
	#OC_ACTION_OPEN
 0x01

	)

110 
	#OC_ACTION_CREATE
 0x02

	)

111 
	#OC_ACTION_TRUNCATE
 0x04

	)

112 
	#OC_ACTION_REPLACE
 0x04

	)

115 #iâdeà
AR_READ_ONLY


116 
	#AR_READ_ONLY
 0x0001

	)

117 
	#AR_WRITE_ONLY
 0x0002

	)

118 
	#AR_DENY_READ
 0x0004

	)

119 
	#AR_DENY_WRITE
 0x0008

	)

120 
	#AR_COMPATIBILITY
 0x0010

	)

121 
	#AR_WRITE_THROUGH
 0x0040

	)

122 
	#AR_OPEN_COMPRESSED
 0x0100

	)

125 
	snw_nfs_šfo
 {

126 
__u32
 
	mmode
;

127 
__u32
 
	mrdev
;

130 
	snw_šfo_¡ruù
 {

131 
__u32
 
	m¥aûAÎoc
;

132 
__Ë32
 
	m©Œibu‹s
;

133 
__u16
 
	mæags
;

134 
__Ë32
 
	md©aSŒ—mSize
;

135 
__Ë32
 
	mtÙ®SŒ—mSize
;

136 
__u16
 
	mnumb”OfSŒ—ms
;

137 
__Ë16
 
	mü—tiÚTime
;

138 
__Ë16
 
	mü—tiÚD©e
;

139 
__u32
 
	mü—tÜID
;

140 
__Ë16
 
	mmodifyTime
;

141 
__Ë16
 
	mmodifyD©e
;

142 
__u32
 
	mmodif›rID
;

143 
__Ë16
 
	mÏ¡AcûssD©e
;

144 
__u16
 
	m¬chiveTime
;

145 
__u16
 
	m¬chiveD©e
;

146 
__u32
 
	m¬chiv”ID
;

147 
__u16
 
	mšh”™edRightsMask
;

148 
__Ë32
 
	mdœEÁNum
;

149 
__Ë32
 
	mDosDœNum
;

150 
__u32
 
	mvŞNumb”
;

151 
__u32
 
	mEAD©aSize
;

152 
__u32
 
	mEAKeyCouÁ
;

153 
__u32
 
	mEAKeySize
;

154 
__u32
 
	mNSC»©Ü
;

155 
__u8
 
	mÇmeL’
;

156 
__u8
 
	m’ŒyName
[256];

158 } 
__©Œibu‹__
((
·cked
));

161 
	#DM_ATTRIBUTES
 (
	`ıu_to_Ë32
(0x02))

	)

162 
	#DM_CREATE_DATE
 (
	`ıu_to_Ë32
(0x04))

	)

163 
	#DM_CREATE_TIME
 (
	`ıu_to_Ë32
(0x08))

	)

164 
	#DM_CREATOR_ID
 (
	`ıu_to_Ë32
(0x10))

	)

165 
	#DM_ARCHIVE_DATE
 (
	`ıu_to_Ë32
(0x20))

	)

166 
	#DM_ARCHIVE_TIME
 (
	`ıu_to_Ë32
(0x40))

	)

167 
	#DM_ARCHIVER_ID
 (
	`ıu_to_Ë32
(0x80))

	)

168 
	#DM_MODIFY_DATE
 (
	`ıu_to_Ë32
(0x0100))

	)

169 
	#DM_MODIFY_TIME
 (
	`ıu_to_Ë32
(0x0200))

	)

170 
	#DM_MODIFIER_ID
 (
	`ıu_to_Ë32
(0x0400))

	)

171 
	#DM_LAST_ACCESS_DATE
 (
	`ıu_to_Ë32
(0x0800))

	)

172 
	#DM_INHERITED_RIGHTS_MASK
 (
	`ıu_to_Ë32
(0x1000))

	)

173 
	#DM_MAXIMUM_SPACE
 (
	`ıu_to_Ë32
(0x2000))

	)

175 
	snw_modify_dos_šfo
 {

176 
__Ë32
 
	m©Œibu‹s
;

177 
__Ë16
 
	mü—tiÚD©e
;

178 
__Ë16
 
	mü—tiÚTime
;

179 
__u32
 
	mü—tÜID
;

180 
__Ë16
 
	mmodifyD©e
;

181 
__Ë16
 
	mmodifyTime
;

182 
__u32
 
	mmodif›rID
;

183 
__u16
 
	m¬chiveD©e
;

184 
__u16
 
	m¬chiveTime
;

185 
__u32
 
	m¬chiv”ID
;

186 
__Ë16
 
	mÏ¡AcûssD©e
;

187 
__u16
 
	mšh”™ªûG¿ÁMask
;

188 
__u16
 
	mšh”™ªûRevokeMask
;

189 
__u32
 
	mmaximumS·û
;

190 } 
__©Œibu‹__
((
·cked
));

192 
	snw_£¬ch_£qu’û
 {

193 
__u8
 
	mvŞNumb”
;

194 
__u32
 
	mdœBa£
;

195 
__u32
 
	m£qu’û
;

196 } 
__©Œibu‹__
((
·cked
));

	@/usr/include/linux/patchkey.h

13 #iâdeà
_LINUX_PATCHKEY_H_INDIRECT


17 #iâdeà
_LINUX_PATCHKEY_H


18 
	#_LINUX_PATCHKEY_H


	)

21 
	~<’dŸn.h
>

23 #ià 
defšed
(
__BYTE_ORDER
)

24 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


25 
	#_PATCHKEY
(
id
è(0xfd00|id)

	)

26 #–ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


27 
	#_PATCHKEY
(
id
è((id<<8)|0x00fd)

	)

	@/usr/include/linux/pci_regs.h

22 #iâdeà
LINUX_PCI_REGS_H


23 
	#LINUX_PCI_REGS_H


	)

29 
	#PCI_VENDOR_ID
 0x00

	)

30 
	#PCI_DEVICE_ID
 0x02

	)

31 
	#PCI_COMMAND
 0x04

	)

32 
	#PCI_COMMAND_IO
 0x1

	)

33 
	#PCI_COMMAND_MEMORY
 0x2

	)

34 
	#PCI_COMMAND_MASTER
 0x4

	)

35 
	#PCI_COMMAND_SPECIAL
 0x8

	)

36 
	#PCI_COMMAND_INVALIDATE
 0x10

	)

37 
	#PCI_COMMAND_VGA_PALETTE
 0x20

	)

38 
	#PCI_COMMAND_PARITY
 0x40

	)

39 
	#PCI_COMMAND_WAIT
 0x80

	)

40 
	#PCI_COMMAND_SERR
 0x100

	)

41 
	#PCI_COMMAND_FAST_BACK
 0x200

	)

42 
	#PCI_COMMAND_INTX_DISABLE
 0x400

	)

44 
	#PCI_STATUS
 0x06

	)

45 
	#PCI_STATUS_INTERRUPT
 0x08

	)

46 
	#PCI_STATUS_CAP_LIST
 0x10

	)

47 
	#PCI_STATUS_66MHZ
 0x20

	)

48 
	#PCI_STATUS_UDF
 0x40

	)

49 
	#PCI_STATUS_FAST_BACK
 0x80

	)

50 
	#PCI_STATUS_PARITY
 0x100

	)

51 
	#PCI_STATUS_DEVSEL_MASK
 0x600

	)

52 
	#PCI_STATUS_DEVSEL_FAST
 0x000

	)

53 
	#PCI_STATUS_DEVSEL_MEDIUM
 0x200

	)

54 
	#PCI_STATUS_DEVSEL_SLOW
 0x400

	)

55 
	#PCI_STATUS_SIG_TARGET_ABORT
 0x800

	)

56 
	#PCI_STATUS_REC_TARGET_ABORT
 0x1000

	)

57 
	#PCI_STATUS_REC_MASTER_ABORT
 0x2000

	)

58 
	#PCI_STATUS_SIG_SYSTEM_ERROR
 0x4000

	)

59 
	#PCI_STATUS_DETECTED_PARITY
 0x8000

	)

61 
	#PCI_CLASS_REVISION
 0x08

	)

62 
	#PCI_REVISION_ID
 0x08

	)

63 
	#PCI_CLASS_PROG
 0x09

	)

64 
	#PCI_CLASS_DEVICE
 0x0¨

	)

66 
	#PCI_CACHE_LINE_SIZE
 0x0ø

	)

67 
	#PCI_LATENCY_TIMER
 0x0d

	)

68 
	#PCI_HEADER_TYPE
 0x0

	)

69 
	#PCI_HEADER_TYPE_NORMAL
 0

	)

70 
	#PCI_HEADER_TYPE_BRIDGE
 1

	)

71 
	#PCI_HEADER_TYPE_CARDBUS
 2

	)

73 
	#PCI_BIST
 0x0à

	)

74 
	#PCI_BIST_CODE_MASK
 0x0à

	)

75 
	#PCI_BIST_START
 0x40

	)

76 
	#PCI_BIST_CAPABLE
 0x80

	)

84 
	#PCI_BASE_ADDRESS_0
 0x10

	)

85 
	#PCI_BASE_ADDRESS_1
 0x14

	)

86 
	#PCI_BASE_ADDRESS_2
 0x18

	)

87 
	#PCI_BASE_ADDRESS_3
 0x1ø

	)

88 
	#PCI_BASE_ADDRESS_4
 0x20

	)

89 
	#PCI_BASE_ADDRESS_5
 0x24

	)

90 
	#PCI_BASE_ADDRESS_SPACE
 0x01

	)

91 
	#PCI_BASE_ADDRESS_SPACE_IO
 0x01

	)

92 
	#PCI_BASE_ADDRESS_SPACE_MEMORY
 0x00

	)

93 
	#PCI_BASE_ADDRESS_MEM_TYPE_MASK
 0x06

	)

94 
	#PCI_BASE_ADDRESS_MEM_TYPE_32
 0x00

	)

95 
	#PCI_BASE_ADDRESS_MEM_TYPE_1M
 0x02

	)

96 
	#PCI_BASE_ADDRESS_MEM_TYPE_64
 0x04

	)

97 
	#PCI_BASE_ADDRESS_MEM_PREFETCH
 0x08

	)

98 
	#PCI_BASE_ADDRESS_MEM_MASK
 (~0x0fUL)

	)

99 
	#PCI_BASE_ADDRESS_IO_MASK
 (~0x03UL)

	)

103 
	#PCI_CARDBUS_CIS
 0x28

	)

104 
	#PCI_SUBSYSTEM_VENDOR_ID
 0x2c

	)

105 
	#PCI_SUBSYSTEM_ID
 0x2e

	)

106 
	#PCI_ROM_ADDRESS
 0x30

	)

107 
	#PCI_ROM_ADDRESS_ENABLE
 0x01

	)

108 
	#PCI_ROM_ADDRESS_MASK
 (~0x7ffUL)

	)

110 
	#PCI_CAPABILITY_LIST
 0x34

	)

113 
	#PCI_INTERRUPT_LINE
 0x3ø

	)

114 
	#PCI_INTERRUPT_PIN
 0x3d

	)

115 
	#PCI_MIN_GNT
 0x3

	)

116 
	#PCI_MAX_LAT
 0x3à

	)

119 
	#PCI_PRIMARY_BUS
 0x18

	)

120 
	#PCI_SECONDARY_BUS
 0x19

	)

121 
	#PCI_SUBORDINATE_BUS
 0x1¨

	)

122 
	#PCI_SEC_LATENCY_TIMER
 0x1b

	)

123 
	#PCI_IO_BASE
 0x1ø

	)

124 
	#PCI_IO_LIMIT
 0x1d

	)

125 
	#PCI_IO_RANGE_TYPE_MASK
 0x0fUL

	)

126 
	#PCI_IO_RANGE_TYPE_16
 0x00

	)

127 
	#PCI_IO_RANGE_TYPE_32
 0x01

	)

128 
	#PCI_IO_RANGE_MASK
 (~0x0fUL)

	)

129 
	#PCI_SEC_STATUS
 0x1

	)

130 
	#PCI_MEMORY_BASE
 0x20

	)

131 
	#PCI_MEMORY_LIMIT
 0x22

	)

132 
	#PCI_MEMORY_RANGE_TYPE_MASK
 0x0fUL

	)

133 
	#PCI_MEMORY_RANGE_MASK
 (~0x0fUL)

	)

134 
	#PCI_PREF_MEMORY_BASE
 0x24

	)

135 
	#PCI_PREF_MEMORY_LIMIT
 0x26

	)

136 
	#PCI_PREF_RANGE_TYPE_MASK
 0x0fUL

	)

137 
	#PCI_PREF_RANGE_TYPE_32
 0x00

	)

138 
	#PCI_PREF_RANGE_TYPE_64
 0x01

	)

139 
	#PCI_PREF_RANGE_MASK
 (~0x0fUL)

	)

140 
	#PCI_PREF_BASE_UPPER32
 0x28

	)

141 
	#PCI_PREF_LIMIT_UPPER32
 0x2c

	)

142 
	#PCI_IO_BASE_UPPER16
 0x30

	)

143 
	#PCI_IO_LIMIT_UPPER16
 0x32

	)

146 
	#PCI_ROM_ADDRESS1
 0x38

	)

148 
	#PCI_BRIDGE_CONTROL
 0x3e

	)

149 
	#PCI_BRIDGE_CTL_PARITY
 0x01

	)

150 
	#PCI_BRIDGE_CTL_SERR
 0x02

	)

151 
	#PCI_BRIDGE_CTL_ISA
 0x04

	)

152 
	#PCI_BRIDGE_CTL_VGA
 0x08

	)

153 
	#PCI_BRIDGE_CTL_MASTER_ABORT
 0x20

	)

154 
	#PCI_BRIDGE_CTL_BUS_RESET
 0x40

	)

155 
	#PCI_BRIDGE_CTL_FAST_BACK
 0x80

	)

158 
	#PCI_CB_CAPABILITY_LIST
 0x14

	)

160 
	#PCI_CB_SEC_STATUS
 0x16

	)

161 
	#PCI_CB_PRIMARY_BUS
 0x18

	)

162 
	#PCI_CB_CARD_BUS
 0x19

	)

163 
	#PCI_CB_SUBORDINATE_BUS
 0x1¨

	)

164 
	#PCI_CB_LATENCY_TIMER
 0x1b

	)

165 
	#PCI_CB_MEMORY_BASE_0
 0x1c

	)

166 
	#PCI_CB_MEMORY_LIMIT_0
 0x20

	)

167 
	#PCI_CB_MEMORY_BASE_1
 0x24

	)

168 
	#PCI_CB_MEMORY_LIMIT_1
 0x28

	)

169 
	#PCI_CB_IO_BASE_0
 0x2c

	)

170 
	#PCI_CB_IO_BASE_0_HI
 0x2e

	)

171 
	#PCI_CB_IO_LIMIT_0
 0x30

	)

172 
	#PCI_CB_IO_LIMIT_0_HI
 0x32

	)

173 
	#PCI_CB_IO_BASE_1
 0x34

	)

174 
	#PCI_CB_IO_BASE_1_HI
 0x36

	)

175 
	#PCI_CB_IO_LIMIT_1
 0x38

	)

176 
	#PCI_CB_IO_LIMIT_1_HI
 0x3a

	)

177 
	#PCI_CB_IO_RANGE_MASK
 (~0x03UL)

	)

179 
	#PCI_CB_BRIDGE_CONTROL
 0x3e

	)

180 
	#PCI_CB_BRIDGE_CTL_PARITY
 0x01

	)

181 
	#PCI_CB_BRIDGE_CTL_SERR
 0x02

	)

182 
	#PCI_CB_BRIDGE_CTL_ISA
 0x04

	)

183 
	#PCI_CB_BRIDGE_CTL_VGA
 0x08

	)

184 
	#PCI_CB_BRIDGE_CTL_MASTER_ABORT
 0x20

	)

185 
	#PCI_CB_BRIDGE_CTL_CB_RESET
 0x40

	)

186 
	#PCI_CB_BRIDGE_CTL_16BIT_INT
 0x80

	)

187 
	#PCI_CB_BRIDGE_CTL_PREFETCH_MEM0
 0x100

	)

188 
	#PCI_CB_BRIDGE_CTL_PREFETCH_MEM1
 0x200

	)

189 
	#PCI_CB_BRIDGE_CTL_POST_WRITES
 0x400

	)

190 
	#PCI_CB_SUBSYSTEM_VENDOR_ID
 0x40

	)

191 
	#PCI_CB_SUBSYSTEM_ID
 0x42

	)

192 
	#PCI_CB_LEGACY_MODE_BASE
 0x44

	)

197 
	#PCI_CAP_LIST_ID
 0

	)

198 
	#PCI_CAP_ID_PM
 0x01

	)

199 
	#PCI_CAP_ID_AGP
 0x02

	)

200 
	#PCI_CAP_ID_VPD
 0x03

	)

201 
	#PCI_CAP_ID_SLOTID
 0x04

	)

202 
	#PCI_CAP_ID_MSI
 0x05

	)

203 
	#PCI_CAP_ID_CHSWP
 0x06

	)

204 
	#PCI_CAP_ID_PCIX
 0x07

	)

205 
	#PCI_CAP_ID_HT
 0x08

	)

206 
	#PCI_CAP_ID_VNDR
 0x09

	)

207 
	#PCI_CAP_ID_DBG
 0x0A

	)

208 
	#PCI_CAP_ID_CCRC
 0x0B

	)

209 
	#PCI_CAP_ID_SHPC
 0x0C

	)

210 
	#PCI_CAP_ID_SSVID
 0x0D

	)

211 
	#PCI_CAP_ID_AGP3
 0x0E

	)

212 
	#PCI_CAP_ID_EXP
 0x10

	)

213 
	#PCI_CAP_ID_MSIX
 0x11

	)

214 
	#PCI_CAP_ID_AF
 0x13

	)

215 
	#PCI_CAP_LIST_NEXT
 1

	)

216 
	#PCI_CAP_FLAGS
 2

	)

217 
	#PCI_CAP_SIZEOF
 4

	)

221 
	#PCI_PM_PMC
 2

	)

222 
	#PCI_PM_CAP_VER_MASK
 0x0007

	)

223 
	#PCI_PM_CAP_PME_CLOCK
 0x0008

	)

224 
	#PCI_PM_CAP_RESERVED
 0x0010

	)

225 
	#PCI_PM_CAP_DSI
 0x0020

	)

226 
	#PCI_PM_CAP_AUX_POWER
 0x01C0

	)

227 
	#PCI_PM_CAP_D1
 0x0200

	)

228 
	#PCI_PM_CAP_D2
 0x0400

	)

229 
	#PCI_PM_CAP_PME
 0x0800

	)

230 
	#PCI_PM_CAP_PME_MASK
 0xF800

	)

231 
	#PCI_PM_CAP_PME_D0
 0x0800

	)

232 
	#PCI_PM_CAP_PME_D1
 0x1000

	)

233 
	#PCI_PM_CAP_PME_D2
 0x2000

	)

234 
	#PCI_PM_CAP_PME_D3
 0x4000

	)

235 
	#PCI_PM_CAP_PME_D3cŞd
 0x8000

	)

236 
	#PCI_PM_CAP_PME_SHIFT
 11

	)

237 
	#PCI_PM_CTRL
 4

	)

238 
	#PCI_PM_CTRL_STATE_MASK
 0x0003

	)

239 
	#PCI_PM_CTRL_NO_SOFT_RESET
 0x0008

	)

240 
	#PCI_PM_CTRL_PME_ENABLE
 0x0100

	)

241 
	#PCI_PM_CTRL_DATA_SEL_MASK
 0x1e00

	)

242 
	#PCI_PM_CTRL_DATA_SCALE_MASK
 0x6000

	)

243 
	#PCI_PM_CTRL_PME_STATUS
 0x8000

	)

244 
	#PCI_PM_PPB_EXTENSIONS
 6

	)

245 
	#PCI_PM_PPB_B2_B3
 0x40

	)

246 
	#PCI_PM_BPCC_ENABLE
 0x80

	)

247 
	#PCI_PM_DATA_REGISTER
 7

	)

248 
	#PCI_PM_SIZEOF
 8

	)

252 
	#PCI_AGP_VERSION
 2

	)

253 
	#PCI_AGP_RFU
 3

	)

254 
	#PCI_AGP_STATUS
 4

	)

255 
	#PCI_AGP_STATUS_RQ_MASK
 0xff000000

	)

256 
	#PCI_AGP_STATUS_SBA
 0x0200

	)

257 
	#PCI_AGP_STATUS_64BIT
 0x0020

	)

258 
	#PCI_AGP_STATUS_FW
 0x0010

	)

259 
	#PCI_AGP_STATUS_RATE4
 0x0004

	)

260 
	#PCI_AGP_STATUS_RATE2
 0x0002

	)

261 
	#PCI_AGP_STATUS_RATE1
 0x0001

	)

262 
	#PCI_AGP_COMMAND
 8

	)

263 
	#PCI_AGP_COMMAND_RQ_MASK
 0xff000000

	)

264 
	#PCI_AGP_COMMAND_SBA
 0x0200

	)

265 
	#PCI_AGP_COMMAND_AGP
 0x0100

	)

266 
	#PCI_AGP_COMMAND_64BIT
 0x0020

	)

267 
	#PCI_AGP_COMMAND_FW
 0x0010

	)

268 
	#PCI_AGP_COMMAND_RATE4
 0x0004

	)

269 
	#PCI_AGP_COMMAND_RATE2
 0x0002

	)

270 
	#PCI_AGP_COMMAND_RATE1
 0x0001

	)

271 
	#PCI_AGP_SIZEOF
 12

	)

275 
	#PCI_VPD_ADDR
 2

	)

276 
	#PCI_VPD_ADDR_MASK
 0x7ffà

	)

277 
	#PCI_VPD_ADDR_F
 0x8000

	)

278 
	#PCI_VPD_DATA
 4

	)

282 
	#PCI_SID_ESR
 2

	)

283 
	#PCI_SID_ESR_NSLOTS
 0x1à

	)

284 
	#PCI_SID_ESR_FIC
 0x20

	)

285 
	#PCI_SID_CHASSIS_NR
 3

	)

289 
	#PCI_MSI_FLAGS
 2

	)

290 
	#PCI_MSI_FLAGS_64BIT
 0x80

	)

291 
	#PCI_MSI_FLAGS_QSIZE
 0x70

	)

292 
	#PCI_MSI_FLAGS_QMASK
 0x0

	)

293 
	#PCI_MSI_FLAGS_ENABLE
 0x01

	)

294 
	#PCI_MSI_FLAGS_MASKBIT
 0x100

	)

295 
	#PCI_MSI_RFU
 3

	)

296 
	#PCI_MSI_ADDRESS_LO
 4

	)

297 
	#PCI_MSI_ADDRESS_HI
 8

	)

298 
	#PCI_MSI_DATA_32
 8

	)

299 
	#PCI_MSI_MASK_32
 12

	)

300 
	#PCI_MSI_DATA_64
 12

	)

301 
	#PCI_MSI_MASK_64
 16

	)

304 
	#PCI_MSIX_FLAGS
 2

	)

305 
	#PCI_MSIX_FLAGS_QSIZE
 0x7FF

	)

306 
	#PCI_MSIX_FLAGS_ENABLE
 (1 << 15)

	)

307 
	#PCI_MSIX_FLAGS_MASKALL
 (1 << 14)

	)

308 
	#PCI_MSIX_TABLE
 4

	)

309 
	#PCI_MSIX_PBA
 8

	)

310 
	#PCI_MSIX_FLAGS_BIRMASK
 (7 << 0)

	)

313 
	#PCI_MSIX_ENTRY_SIZE
 16

	)

314 
	#PCI_MSIX_ENTRY_LOWER_ADDR
 0

	)

315 
	#PCI_MSIX_ENTRY_UPPER_ADDR
 4

	)

316 
	#PCI_MSIX_ENTRY_DATA
 8

	)

317 
	#PCI_MSIX_ENTRY_VECTOR_CTRL
 12

	)

318 
	#PCI_MSIX_ENTRY_CTRL_MASKBIT
 1

	)

322 
	#PCI_CHSWP_CSR
 2

	)

323 
	#PCI_CHSWP_DHA
 0x01

	)

324 
	#PCI_CHSWP_EIM
 0x02

	)

325 
	#PCI_CHSWP_PIE
 0x04

	)

326 
	#PCI_CHSWP_LOO
 0x08

	)

327 
	#PCI_CHSWP_PI
 0x30

	)

328 
	#PCI_CHSWP_EXT
 0x40

	)

329 
	#PCI_CHSWP_INS
 0x80

	)

333 
	#PCI_AF_LENGTH
 2

	)

334 
	#PCI_AF_CAP
 3

	)

335 
	#PCI_AF_CAP_TP
 0x01

	)

336 
	#PCI_AF_CAP_FLR
 0x02

	)

337 
	#PCI_AF_CTRL
 4

	)

338 
	#PCI_AF_CTRL_FLR
 0x01

	)

339 
	#PCI_AF_STATUS
 5

	)

340 
	#PCI_AF_STATUS_TP
 0x01

	)

344 
	#PCI_X_CMD
 2

	)

345 
	#PCI_X_CMD_DPERR_E
 0x0001

	)

346 
	#PCI_X_CMD_ERO
 0x0002

	)

347 
	#PCI_X_CMD_READ_512
 0x0000

	)

348 
	#PCI_X_CMD_READ_1K
 0x0004

	)

349 
	#PCI_X_CMD_READ_2K
 0x0008

	)

350 
	#PCI_X_CMD_READ_4K
 0x000ø

	)

351 
	#PCI_X_CMD_MAX_READ
 0x000ø

	)

353 
	#PCI_X_CMD_SPLIT_1
 0x0000

	)

354 
	#PCI_X_CMD_SPLIT_2
 0x0010

	)

355 
	#PCI_X_CMD_SPLIT_3
 0x0020

	)

356 
	#PCI_X_CMD_SPLIT_4
 0x0030

	)

357 
	#PCI_X_CMD_SPLIT_8
 0x0040

	)

358 
	#PCI_X_CMD_SPLIT_12
 0x0050

	)

359 
	#PCI_X_CMD_SPLIT_16
 0x0060

	)

360 
	#PCI_X_CMD_SPLIT_32
 0x0070

	)

361 
	#PCI_X_CMD_MAX_SPLIT
 0x0070

	)

362 
	#PCI_X_CMD_VERSION
(
x
è(((xè>> 12è& 3è

	)

363 
	#PCI_X_STATUS
 4

	)

364 
	#PCI_X_STATUS_DEVFN
 0x000000fà

	)

365 
	#PCI_X_STATUS_BUS
 0x0000ff00

	)

366 
	#PCI_X_STATUS_64BIT
 0x00010000

	)

367 
	#PCI_X_STATUS_133MHZ
 0x00020000

	)

368 
	#PCI_X_STATUS_SPL_DISC
 0x00040000

	)

369 
	#PCI_X_STATUS_UNX_SPL
 0x00080000

	)

370 
	#PCI_X_STATUS_COMPLEX
 0x00100000

	)

371 
	#PCI_X_STATUS_MAX_READ
 0x00600000

	)

372 
	#PCI_X_STATUS_MAX_SPLIT
 0x03800000

	)

373 
	#PCI_X_STATUS_MAX_CUM
 0x1c000000

	)

374 
	#PCI_X_STATUS_SPL_ERR
 0x20000000

	)

375 
	#PCI_X_STATUS_266MHZ
 0x40000000

	)

376 
	#PCI_X_STATUS_533MHZ
 0x80000000

	)

380 
	#PCI_SSVID_VENDOR_ID
 4

	)

381 
	#PCI_SSVID_DEVICE_ID
 6

	)

385 
	#PCI_EXP_FLAGS
 2

	)

386 
	#PCI_EXP_FLAGS_VERS
 0x000à

	)

387 
	#PCI_EXP_FLAGS_TYPE
 0x00f0

	)

388 
	#PCI_EXP_TYPE_ENDPOINT
 0x0

	)

389 
	#PCI_EXP_TYPE_LEG_END
 0x1

	)

390 
	#PCI_EXP_TYPE_ROOT_PORT
 0x4

	)

391 
	#PCI_EXP_TYPE_UPSTREAM
 0x5

	)

392 
	#PCI_EXP_TYPE_DOWNSTREAM
 0x6

	)

393 
	#PCI_EXP_TYPE_PCI_BRIDGE
 0x7

	)

394 
	#PCI_EXP_TYPE_RC_END
 0x9

	)

395 
	#PCI_EXP_TYPE_RC_EC
 0x¨

	)

396 
	#PCI_EXP_FLAGS_SLOT
 0x0100

	)

397 
	#PCI_EXP_FLAGS_IRQ
 0x3e00

	)

398 
	#PCI_EXP_DEVCAP
 4

	)

399 
	#PCI_EXP_DEVCAP_PAYLOAD
 0x07

	)

400 
	#PCI_EXP_DEVCAP_PHANTOM
 0x18

	)

401 
	#PCI_EXP_DEVCAP_EXT_TAG
 0x20

	)

402 
	#PCI_EXP_DEVCAP_L0S
 0x1c0

	)

403 
	#PCI_EXP_DEVCAP_L1
 0xe00

	)

404 
	#PCI_EXP_DEVCAP_ATN_BUT
 0x1000

	)

405 
	#PCI_EXP_DEVCAP_ATN_IND
 0x2000

	)

406 
	#PCI_EXP_DEVCAP_PWR_IND
 0x4000

	)

407 
	#PCI_EXP_DEVCAP_RBER
 0x8000

	)

408 
	#PCI_EXP_DEVCAP_PWR_VAL
 0x3fc0000

	)

409 
	#PCI_EXP_DEVCAP_PWR_SCL
 0xc000000

	)

410 
	#PCI_EXP_DEVCAP_FLR
 0x10000000

	)

411 
	#PCI_EXP_DEVCTL
 8

	)

412 
	#PCI_EXP_DEVCTL_CERE
 0x0001

	)

413 
	#PCI_EXP_DEVCTL_NFERE
 0x0002

	)

414 
	#PCI_EXP_DEVCTL_FERE
 0x0004

	)

415 
	#PCI_EXP_DEVCTL_URRE
 0x0008

	)

416 
	#PCI_EXP_DEVCTL_RELAX_EN
 0x0010

	)

417 
	#PCI_EXP_DEVCTL_PAYLOAD
 0x00e0

	)

418 
	#PCI_EXP_DEVCTL_EXT_TAG
 0x0100

	)

419 
	#PCI_EXP_DEVCTL_PHANTOM
 0x0200

	)

420 
	#PCI_EXP_DEVCTL_AUX_PME
 0x0400

	)

421 
	#PCI_EXP_DEVCTL_NOSNOOP_EN
 0x0800

	)

422 
	#PCI_EXP_DEVCTL_READRQ
 0x7000

	)

423 
	#PCI_EXP_DEVCTL_BCR_FLR
 0x8000

	)

424 
	#PCI_EXP_DEVSTA
 10

	)

425 
	#PCI_EXP_DEVSTA_CED
 0x01

	)

426 
	#PCI_EXP_DEVSTA_NFED
 0x02

	)

427 
	#PCI_EXP_DEVSTA_FED
 0x04

	)

428 
	#PCI_EXP_DEVSTA_URD
 0x08

	)

429 
	#PCI_EXP_DEVSTA_AUXPD
 0x10

	)

430 
	#PCI_EXP_DEVSTA_TRPND
 0x20

	)

431 
	#PCI_EXP_LNKCAP
 12

	)

432 
	#PCI_EXP_LNKCAP_SLS
 0x0000000à

	)

433 
	#PCI_EXP_LNKCAP_MLW
 0x000003f0

	)

434 
	#PCI_EXP_LNKCAP_ASPMS
 0x00000c00

	)

435 
	#PCI_EXP_LNKCAP_L0SEL
 0x00007000

	)

436 
	#PCI_EXP_LNKCAP_L1EL
 0x00038000

	)

437 
	#PCI_EXP_LNKCAP_CLKPM
 0x00040000

	)

438 
	#PCI_EXP_LNKCAP_SDERC
 0x00080000

	)

439 
	#PCI_EXP_LNKCAP_DLLLARC
 0x00100000

	)

440 
	#PCI_EXP_LNKCAP_LBNC
 0x00200000

	)

441 
	#PCI_EXP_LNKCAP_PN
 0xff000000

	)

442 
	#PCI_EXP_LNKCTL
 16

	)

443 
	#PCI_EXP_LNKCTL_ASPMC
 0x0003

	)

444 
	#PCI_EXP_LNKCTL_RCB
 0x0008

	)

445 
	#PCI_EXP_LNKCTL_LD
 0x0010

	)

446 
	#PCI_EXP_LNKCTL_RL
 0x0020

	)

447 
	#PCI_EXP_LNKCTL_CCC
 0x0040

	)

448 
	#PCI_EXP_LNKCTL_ES
 0x0080

	)

449 
	#PCI_EXP_LNKCTL_CLKREQ_EN
 0x100

	)

450 
	#PCI_EXP_LNKCTL_HAWD
 0x0200

	)

451 
	#PCI_EXP_LNKCTL_LBMIE
 0x0400

	)

452 
	#PCI_EXP_LNKCTL_LABIE
 0x0800

	)

453 
	#PCI_EXP_LNKSTA
 18

	)

454 
	#PCI_EXP_LNKSTA_CLS
 0x000à

	)

455 
	#PCI_EXP_LNKSTA_CLS_2_5GB
 0x01

	)

456 
	#PCI_EXP_LNKSTA_CLS_5_0GB
 0x02

	)

457 
	#PCI_EXP_LNKSTA_NLW
 0x03f0

	)

458 
	#PCI_EXP_LNKSTA_NLW_SHIFT
 4

	)

459 
	#PCI_EXP_LNKSTA_LT
 0x0800

	)

460 
	#PCI_EXP_LNKSTA_SLC
 0x1000

	)

461 
	#PCI_EXP_LNKSTA_DLLLA
 0x2000

	)

462 
	#PCI_EXP_LNKSTA_LBMS
 0x4000

	)

463 
	#PCI_EXP_LNKSTA_LABS
 0x8000

	)

464 
	#PCI_EXP_SLTCAP
 20

	)

465 
	#PCI_EXP_SLTCAP_ABP
 0x00000001

	)

466 
	#PCI_EXP_SLTCAP_PCP
 0x00000002

	)

467 
	#PCI_EXP_SLTCAP_MRLSP
 0x00000004

	)

468 
	#PCI_EXP_SLTCAP_AIP
 0x00000008

	)

469 
	#PCI_EXP_SLTCAP_PIP
 0x00000010

	)

470 
	#PCI_EXP_SLTCAP_HPS
 0x00000020

	)

471 
	#PCI_EXP_SLTCAP_HPC
 0x00000040

	)

472 
	#PCI_EXP_SLTCAP_SPLV
 0x00007f80

	)

473 
	#PCI_EXP_SLTCAP_SPLS
 0x00018000

	)

474 
	#PCI_EXP_SLTCAP_EIP
 0x00020000

	)

475 
	#PCI_EXP_SLTCAP_NCCS
 0x00040000

	)

476 
	#PCI_EXP_SLTCAP_PSN
 0xfff80000

	)

477 
	#PCI_EXP_SLTCTL
 24

	)

478 
	#PCI_EXP_SLTCTL_ABPE
 0x0001

	)

479 
	#PCI_EXP_SLTCTL_PFDE
 0x0002

	)

480 
	#PCI_EXP_SLTCTL_MRLSCE
 0x0004

	)

481 
	#PCI_EXP_SLTCTL_PDCE
 0x0008

	)

482 
	#PCI_EXP_SLTCTL_CCIE
 0x0010

	)

483 
	#PCI_EXP_SLTCTL_HPIE
 0x0020

	)

484 
	#PCI_EXP_SLTCTL_AIC
 0x00c0

	)

485 
	#PCI_EXP_SLTCTL_PIC
 0x0300

	)

486 
	#PCI_EXP_SLTCTL_PCC
 0x0400

	)

487 
	#PCI_EXP_SLTCTL_EIC
 0x0800

	)

488 
	#PCI_EXP_SLTCTL_DLLSCE
 0x1000

	)

489 
	#PCI_EXP_SLTSTA
 26

	)

490 
	#PCI_EXP_SLTSTA_ABP
 0x0001

	)

491 
	#PCI_EXP_SLTSTA_PFD
 0x0002

	)

492 
	#PCI_EXP_SLTSTA_MRLSC
 0x0004

	)

493 
	#PCI_EXP_SLTSTA_PDC
 0x0008

	)

494 
	#PCI_EXP_SLTSTA_CC
 0x0010

	)

495 
	#PCI_EXP_SLTSTA_MRLSS
 0x0020

	)

496 
	#PCI_EXP_SLTSTA_PDS
 0x0040

	)

497 
	#PCI_EXP_SLTSTA_EIS
 0x0080

	)

498 
	#PCI_EXP_SLTSTA_DLLSC
 0x0100

	)

499 
	#PCI_EXP_RTCTL
 28

	)

500 
	#PCI_EXP_RTCTL_SECEE
 0x01

	)

501 
	#PCI_EXP_RTCTL_SENFEE
 0x02

	)

502 
	#PCI_EXP_RTCTL_SEFEE
 0x04

	)

503 
	#PCI_EXP_RTCTL_PMEIE
 0x08

	)

504 
	#PCI_EXP_RTCTL_CRSSVE
 0x10

	)

505 
	#PCI_EXP_RTCAP
 30

	)

506 
	#PCI_EXP_RTSTA
 32

	)

507 
	#PCI_EXP_RTSTA_PME
 0x10000

	)

508 
	#PCI_EXP_RTSTA_PENDING
 0x20000

	)

509 
	#PCI_EXP_DEVCAP2
 36

	)

510 
	#PCI_EXP_DEVCAP2_ARI
 0x20

	)

511 
	#PCI_EXP_DEVCAP2_LTR
 0x800

	)

512 
	#PCI_EXP_OBFF_MASK
 0xc0000

	)

513 
	#PCI_EXP_OBFF_MSG
 0x40000

	)

514 
	#PCI_EXP_OBFF_WAKE
 0x80000

	)

515 
	#PCI_EXP_DEVCTL2
 40

	)

516 
	#PCI_EXP_DEVCTL2_ARI
 0x20

	)

517 
	#PCI_EXP_IDO_REQ_EN
 0x100

	)

518 
	#PCI_EXP_IDO_CMP_EN
 0x200

	)

519 
	#PCI_EXP_LTR_EN
 0x400

	)

520 
	#PCI_EXP_OBFF_MSGA_EN
 0x2000

	)

521 
	#PCI_EXP_OBFF_MSGB_EN
 0x4000

	)

522 
	#PCI_EXP_OBFF_WAKE_EN
 0x6000

	)

523 
	#PCI_EXP_LNKCTL2
 48

	)

524 
	#PCI_EXP_SLTCTL2
 56

	)

527 
	#PCI_EXT_CAP_ID
(
h—d”
è(h—d” & 0x0000ffff)

	)

528 
	#PCI_EXT_CAP_VER
(
h—d”
è((h—d” >> 16è& 0xf)

	)

529 
	#PCI_EXT_CAP_NEXT
(
h—d”
è((h—d” >> 20è& 0xffc)

	)

531 
	#PCI_EXT_CAP_ID_ERR
 1

	)

532 
	#PCI_EXT_CAP_ID_VC
 2

	)

533 
	#PCI_EXT_CAP_ID_DSN
 3

	)

534 
	#PCI_EXT_CAP_ID_PWR
 4

	)

535 
	#PCI_EXT_CAP_ID_VNDR
 11

	)

536 
	#PCI_EXT_CAP_ID_ACS
 13

	)

537 
	#PCI_EXT_CAP_ID_ARI
 14

	)

538 
	#PCI_EXT_CAP_ID_ATS
 15

	)

539 
	#PCI_EXT_CAP_ID_SRIOV
 16

	)

540 
	#PCI_EXT_CAP_ID_LTR
 24

	)

543 
	#PCI_ERR_UNCOR_STATUS
 4

	)

544 
	#PCI_ERR_UNC_TRAIN
 0x00000001

	)

545 
	#PCI_ERR_UNC_DLP
 0x00000010

	)

546 
	#PCI_ERR_UNC_POISON_TLP
 0x00001000

	)

547 
	#PCI_ERR_UNC_FCP
 0x00002000

	)

548 
	#PCI_ERR_UNC_COMP_TIME
 0x00004000

	)

549 
	#PCI_ERR_UNC_COMP_ABORT
 0x00008000

	)

550 
	#PCI_ERR_UNC_UNX_COMP
 0x00010000

	)

551 
	#PCI_ERR_UNC_RX_OVER
 0x00020000

	)

552 
	#PCI_ERR_UNC_MALF_TLP
 0x00040000

	)

553 
	#PCI_ERR_UNC_ECRC
 0x00080000

	)

554 
	#PCI_ERR_UNC_UNSUP
 0x00100000

	)

555 
	#PCI_ERR_UNCOR_MASK
 8

	)

557 
	#PCI_ERR_UNCOR_SEVER
 12

	)

559 
	#PCI_ERR_COR_STATUS
 16

	)

560 
	#PCI_ERR_COR_RCVR
 0x00000001

	)

561 
	#PCI_ERR_COR_BAD_TLP
 0x00000040

	)

562 
	#PCI_ERR_COR_BAD_DLLP
 0x00000080

	)

563 
	#PCI_ERR_COR_REP_ROLL
 0x00000100

	)

564 
	#PCI_ERR_COR_REP_TIMER
 0x00001000

	)

565 
	#PCI_ERR_COR_MASK
 20

	)

567 
	#PCI_ERR_CAP
 24

	)

568 
	#PCI_ERR_CAP_FEP
(
x
è((xè& 31è

	)

569 
	#PCI_ERR_CAP_ECRC_GENC
 0x00000020

	)

570 
	#PCI_ERR_CAP_ECRC_GENE
 0x00000040

	)

571 
	#PCI_ERR_CAP_ECRC_CHKC
 0x00000080

	)

572 
	#PCI_ERR_CAP_ECRC_CHKE
 0x00000100

	)

573 
	#PCI_ERR_HEADER_LOG
 28

	)

574 
	#PCI_ERR_ROOT_COMMAND
 44

	)

576 
	#PCI_ERR_ROOT_CMD_COR_EN
 0x00000001

	)

578 
	#PCI_ERR_ROOT_CMD_NONFATAL_EN
 0x00000002

	)

580 
	#PCI_ERR_ROOT_CMD_FATAL_EN
 0x00000004

	)

581 
	#PCI_ERR_ROOT_STATUS
 48

	)

582 
	#PCI_ERR_ROOT_COR_RCV
 0x00000001

	)

584 
	#PCI_ERR_ROOT_MULTI_COR_RCV
 0x00000002

	)

586 
	#PCI_ERR_ROOT_UNCOR_RCV
 0x00000004

	)

588 
	#PCI_ERR_ROOT_MULTI_UNCOR_RCV
 0x00000008

	)

589 
	#PCI_ERR_ROOT_FIRST_FATAL
 0x00000010

	)

590 
	#PCI_ERR_ROOT_NONFATAL_RCV
 0x00000020

	)

591 
	#PCI_ERR_ROOT_FATAL_RCV
 0x00000040

	)

592 
	#PCI_ERR_ROOT_ERR_SRC
 52

	)

595 
	#PCI_VC_PORT_REG1
 4

	)

596 
	#PCI_VC_PORT_REG2
 8

	)

597 
	#PCI_VC_PORT_CTRL
 12

	)

598 
	#PCI_VC_PORT_STATUS
 14

	)

599 
	#PCI_VC_RES_CAP
 16

	)

600 
	#PCI_VC_RES_CTRL
 20

	)

601 
	#PCI_VC_RES_STATUS
 26

	)

604 
	#PCI_PWR_DSR
 4

	)

605 
	#PCI_PWR_DATA
 8

	)

606 
	#PCI_PWR_DATA_BASE
(
x
è((xè& 0xffè

	)

607 
	#PCI_PWR_DATA_SCALE
(
x
è(((xè>> 8è& 3è

	)

608 
	#PCI_PWR_DATA_PM_SUB
(
x
è(((xè>> 10è& 7è

	)

609 
	#PCI_PWR_DATA_PM_STATE
(
x
è(((xè>> 13è& 3è

	)

610 
	#PCI_PWR_DATA_TYPE
(
x
è(((xè>> 15è& 7è

	)

611 
	#PCI_PWR_DATA_RAIL
(
x
è(((xè>> 18è& 7è

	)

612 
	#PCI_PWR_CAP
 12

	)

613 
	#PCI_PWR_CAP_BUDGET
(
x
è((xè& 1è

	)

623 
	#HT_3BIT_CAP_MASK
 0xE0

	)

624 
	#HT_CAPTYPE_SLAVE
 0x00

	)

625 
	#HT_CAPTYPE_HOST
 0x20

	)

627 
	#HT_5BIT_CAP_MASK
 0xF8

	)

628 
	#HT_CAPTYPE_IRQ
 0x80

	)

629 
	#HT_CAPTYPE_REMAPPING_40
 0xA0

	)

630 
	#HT_CAPTYPE_REMAPPING_64
 0xA2

	)

631 
	#HT_CAPTYPE_UNITID_CLUMP
 0x90

	)

632 
	#HT_CAPTYPE_EXTCONF
 0x98

	)

633 
	#HT_CAPTYPE_MSI_MAPPING
 0xA8

	)

634 
	#HT_MSI_FLAGS
 0x02

	)

635 
	#HT_MSI_FLAGS_ENABLE
 0x1

	)

636 
	#HT_MSI_FLAGS_FIXED
 0x2

	)

637 
	#HT_MSI_FIXED_ADDR
 0x00000000FEE00000ULL

	)

638 
	#HT_MSI_ADDR_LO
 0x04

	)

639 
	#HT_MSI_ADDR_LO_MASK
 0xFFF00000

	)

640 
	#HT_MSI_ADDR_HI
 0x08

	)

641 
	#HT_CAPTYPE_DIRECT_ROUTE
 0xB0

	)

642 
	#HT_CAPTYPE_VCSET
 0xB8

	)

643 
	#HT_CAPTYPE_ERROR_RETRY
 0xC0

	)

644 
	#HT_CAPTYPE_GEN3
 0xD0

	)

645 
	#HT_CAPTYPE_PM
 0xE0

	)

648 
	#PCI_ARI_CAP
 0x04

	)

649 
	#PCI_ARI_CAP_MFVC
 0x0001

	)

650 
	#PCI_ARI_CAP_ACS
 0x0002

	)

651 
	#PCI_ARI_CAP_NFN
(
x
è(((xè>> 8è& 0xffè

	)

652 
	#PCI_ARI_CTRL
 0x06

	)

653 
	#PCI_ARI_CTRL_MFVC
 0x0001

	)

654 
	#PCI_ARI_CTRL_ACS
 0x0002

	)

655 
	#PCI_ARI_CTRL_FG
(
x
è(((xè>> 4è& 7è

	)

658 
	#PCI_ATS_CAP
 0x04

	)

659 
	#PCI_ATS_CAP_QDEP
(
x
è((xè& 0x1fè

	)

660 
	#PCI_ATS_MAX_QDEP
 32

	)

661 
	#PCI_ATS_CTRL
 0x06

	)

662 
	#PCI_ATS_CTRL_ENABLE
 0x8000

	)

663 
	#PCI_ATS_CTRL_STU
(
x
è((xè& 0x1fè

	)

664 
	#PCI_ATS_MIN_STU
 12

	)

667 
	#PCI_PRI_CAP
 0x13

	)

668 
	#PCI_PRI_CONTROL_OFF
 0x04

	)

669 
	#PCI_PRI_STATUS_OFF
 0x06

	)

670 
	#PCI_PRI_ENABLE
 0x0001

	)

671 
	#PCI_PRI_RESET
 0x0002

	)

672 
	#PCI_PRI_STATUS_RF
 0x0001

	)

673 
	#PCI_PRI_STATUS_UPRGI
 0x0002

	)

674 
	#PCI_PRI_STATUS_STOPPED
 0x0100

	)

675 
	#PCI_PRI_MAX_REQ_OFF
 0x08

	)

676 
	#PCI_PRI_ALLOC_REQ_OFF
 0x0ø

	)

679 
	#PCI_PASID_CAP
 0x1b

	)

680 
	#PCI_PASID_CAP_OFF
 0x04

	)

681 
	#PCI_PASID_CONTROL_OFF
 0x06

	)

682 
	#PCI_PASID_ENABLE
 0x01

	)

683 
	#PCI_PASID_EXEC
 0x02

	)

684 
	#PCI_PASID_PRIV
 0x04

	)

687 
	#PCI_SRIOV_CAP
 0x04

	)

688 
	#PCI_SRIOV_CAP_VFM
 0x01

	)

689 
	#PCI_SRIOV_CAP_INTR
(
x
è((xè>> 21è

	)

690 
	#PCI_SRIOV_CTRL
 0x08

	)

691 
	#PCI_SRIOV_CTRL_VFE
 0x01

	)

692 
	#PCI_SRIOV_CTRL_VFM
 0x02

	)

693 
	#PCI_SRIOV_CTRL_INTR
 0x04

	)

694 
	#PCI_SRIOV_CTRL_MSE
 0x08

	)

695 
	#PCI_SRIOV_CTRL_ARI
 0x10

	)

696 
	#PCI_SRIOV_STATUS
 0x0¨

	)

697 
	#PCI_SRIOV_STATUS_VFM
 0x01

	)

698 
	#PCI_SRIOV_INITIAL_VF
 0x0ø

	)

699 
	#PCI_SRIOV_TOTAL_VF
 0x0

	)

700 
	#PCI_SRIOV_NUM_VF
 0x10

	)

701 
	#PCI_SRIOV_FUNC_LINK
 0x12

	)

702 
	#PCI_SRIOV_VF_OFFSET
 0x14

	)

703 
	#PCI_SRIOV_VF_STRIDE
 0x16

	)

704 
	#PCI_SRIOV_VF_DID
 0x1¨

	)

705 
	#PCI_SRIOV_SUP_PGSIZE
 0x1ø

	)

706 
	#PCI_SRIOV_SYS_PGSIZE
 0x20

	)

707 
	#PCI_SRIOV_BAR
 0x24

	)

708 
	#PCI_SRIOV_NUM_BARS
 6

	)

709 
	#PCI_SRIOV_VFM
 0x3ø

	)

710 
	#PCI_SRIOV_VFM_BIR
(
x
è((xè& 7è

	)

711 
	#PCI_SRIOV_VFM_OFFSET
(
x
è((xè& ~7è

	)

712 
	#PCI_SRIOV_VFM_UA
 0x0

	)

713 
	#PCI_SRIOV_VFM_MI
 0x1

	)

714 
	#PCI_SRIOV_VFM_MO
 0x2

	)

715 
	#PCI_SRIOV_VFM_AV
 0x3

	)

717 
	#PCI_LTR_MAX_SNOOP_LAT
 0x4

	)

718 
	#PCI_LTR_MAX_NOSNOOP_LAT
 0x6

	)

719 
	#PCI_LTR_VALUE_MASK
 0x000003ff

	)

720 
	#PCI_LTR_SCALE_MASK
 0x00001c00

	)

721 
	#PCI_LTR_SCALE_SHIFT
 10

	)

724 
	#PCI_ACS_CAP
 0x04

	)

725 
	#PCI_ACS_SV
 0x01

	)

726 
	#PCI_ACS_TB
 0x02

	)

727 
	#PCI_ACS_RR
 0x04

	)

728 
	#PCI_ACS_CR
 0x08

	)

729 
	#PCI_ACS_UF
 0x10

	)

730 
	#PCI_ACS_EC
 0x20

	)

731 
	#PCI_ACS_DT
 0x40

	)

732 
	#PCI_ACS_CTRL
 0x06

	)

733 
	#PCI_ACS_EGRESS_CTL_V
 0x08

	)

	@/usr/include/linux/posix_types.h

1 #iâdeà
_LINUX_POSIX_TYPES_H


2 
	#_LINUX_POSIX_TYPES_H


	)

4 
	~<lšux/¡ddef.h
>

21 #undeà
__NFDBITS


22 
	#__NFDBITS
 (8 * ())

	)

24 #undeà
__FD_SETSIZE


25 
	#__FD_SETSIZE
 1024

	)

27 #undeà
__FDSET_LONGS


28 
	#__FDSET_LONGS
 (
__FD_SETSIZE
/
__NFDBITS
)

	)

30 #undeà
__FDELT


31 
	#__FDELT
(
d
è((dè/ 
__NFDBITS
)

	)

33 #undeà
__FDMASK


34 
	#__FDMASK
(
d
è(1UL << ((dè% 
__NFDBITS
))

	)

37 
	mfds_b™s
 [
__FDSET_LONGS
];

38 } 
	t__k”Ãl_fd_£t
;

41 (*
	t__k”Ãl_sighªdËr_t
)();

44 
	t__k”Ãl_key_t
;

45 
	t__k”Ãl_mqd_t
;

47 
	~<asm/posix_ty³s.h
>

	@/usr/include/linux/socket.h

1 #iâdeà
_LINUX_SOCKET_H


2 
	#_LINUX_SOCKET_H


	)

7 
	#_K_SS_MAXSIZE
 128

	)

8 
	#_K_SS_ALIGNSIZE
 (
	`__®ignof__
 (
sockaddr
 *))

	)

11 
	t__k”Ãl_§_çmy_t
;

13 
	s__k”Ãl_sockaddr_¡Üage
 {

14 
__k”Ãl_§_çmy_t
 
	mss_çmy
;

16 
	m__d©a
[
_K_SS_MAXSIZE
 - ()];

19 } 
__©Œibu‹__
 ((
®igÃd
(
_K_SS_ALIGNSIZE
)));

	@/usr/include/linux/sockios.h

18 #iâdeà
_LINUX_SOCKIOS_H


19 
	#_LINUX_SOCKIOS_H


	)

21 
	~<asm/sockios.h
>

24 
	#SIOCINQ
 
FIONREAD


	)

25 
	#SIOCOUTQ
 
TIOCOUTQ


	)

28 
	#SIOCADDRT
 0x890B

	)

29 
	#SIOCDELRT
 0x890C

	)

30 
	#SIOCRTMSG
 0x890D

	)

33 
	#SIOCGIFNAME
 0x8910

	)

34 
	#SIOCSIFLINK
 0x8911

	)

35 
	#SIOCGIFCONF
 0x8912

	)

36 
	#SIOCGIFFLAGS
 0x8913

	)

37 
	#SIOCSIFFLAGS
 0x8914

	)

38 
	#SIOCGIFADDR
 0x8915

	)

39 
	#SIOCSIFADDR
 0x8916

	)

40 
	#SIOCGIFDSTADDR
 0x8917

	)

41 
	#SIOCSIFDSTADDR
 0x8918

	)

42 
	#SIOCGIFBRDADDR
 0x8919

	)

43 
	#SIOCSIFBRDADDR
 0x891¨

	)

44 
	#SIOCGIFNETMASK
 0x891b

	)

45 
	#SIOCSIFNETMASK
 0x891ø

	)

46 
	#SIOCGIFMETRIC
 0x891d

	)

47 
	#SIOCSIFMETRIC
 0x891

	)

48 
	#SIOCGIFMEM
 0x891à

	)

49 
	#SIOCSIFMEM
 0x8920

	)

50 
	#SIOCGIFMTU
 0x8921

	)

51 
	#SIOCSIFMTU
 0x8922

	)

52 
	#SIOCSIFNAME
 0x8923

	)

53 
	#SIOCSIFHWADDR
 0x8924

	)

54 
	#SIOCGIFENCAP
 0x8925

	)

55 
	#SIOCSIFENCAP
 0x8926

	)

56 
	#SIOCGIFHWADDR
 0x8927

	)

57 
	#SIOCGIFSLAVE
 0x8929

	)

58 
	#SIOCSIFSLAVE
 0x8930

	)

59 
	#SIOCADDMULTI
 0x8931

	)

60 
	#SIOCDELMULTI
 0x8932

	)

61 
	#SIOCGIFINDEX
 0x8933

	)

62 
	#SIOGIFINDEX
 
SIOCGIFINDEX


	)

63 
	#SIOCSIFPFLAGS
 0x8934

	)

64 
	#SIOCGIFPFLAGS
 0x8935

	)

65 
	#SIOCDIFADDR
 0x8936

	)

66 
	#SIOCSIFHWBROADCAST
 0x8937

	)

67 
	#SIOCGIFCOUNT
 0x8938

	)

69 
	#SIOCGIFBR
 0x8940

	)

70 
	#SIOCSIFBR
 0x8941

	)

72 
	#SIOCGIFTXQLEN
 0x8942

	)

73 
	#SIOCSIFTXQLEN
 0x8943

	)

78 
	#SIOCETHTOOL
 0x8946

	)

80 
	#SIOCGMIIPHY
 0x8947

	)

81 
	#SIOCGMIIREG
 0x8948

	)

82 
	#SIOCSMIIREG
 0x8949

	)

84 
	#SIOCWANDEV
 0x894A

	)

86 
	#SIOCOUTQNSD
 0x894B

	)

90 
	#SIOCDARP
 0x8953

	)

91 
	#SIOCGARP
 0x8954

	)

92 
	#SIOCSARP
 0x8955

	)

95 
	#SIOCDRARP
 0x8960

	)

96 
	#SIOCGRARP
 0x8961

	)

97 
	#SIOCSRARP
 0x8962

	)

101 
	#SIOCGIFMAP
 0x8970

	)

102 
	#SIOCSIFMAP
 0x8971

	)

106 
	#SIOCADDDLCI
 0x8980

	)

107 
	#SIOCDELDLCI
 0x8981

	)

109 
	#SIOCGIFVLAN
 0x8982

	)

110 
	#SIOCSIFVLAN
 0x8983

	)

114 
	#SIOCBONDENSLAVE
 0x8990

	)

115 
	#SIOCBONDRELEASE
 0x8991

	)

116 
	#SIOCBONDSETHWADDR
 0x8992

	)

117 
	#SIOCBONDSLAVEINFOQUERY
 0x8993

	)

118 
	#SIOCBONDINFOQUERY
 0x8994

	)

119 
	#SIOCBONDCHANGEACTIVE
 0x8995

	)

122 
	#SIOCBRADDBR
 0x89a0

	)

123 
	#SIOCBRDELBR
 0x89a1

	)

124 
	#SIOCBRADDIF
 0x89a2

	)

125 
	#SIOCBRDELIF
 0x89a3

	)

128 
	#SIOCSHWTSTAMP
 0x89b0

	)

141 
	#SIOCDEVPRIVATE
 0x89F0

	)

147 
	#SIOCPROTOPRIVATE
 0x89E0

	)

	@/usr/include/stdint.h

23 #iâdeà
_STDINT_H


24 
	#_STDINT_H
 1

	)

26 
	~<ã©u»s.h
>

27 
	~<b™s/wch¬.h
>

28 
	~<b™s/wÜdsize.h
>

35 #iâdeà
__št8_t_defšed


36 
	#__št8_t_defšed


	)

37 sigÃd 
	tšt8_t
;

38 
	tšt16_t
;

39 
	tšt32_t
;

40 #ià
__WORDSIZE
 == 64

41 
	tšt64_t
;

43 
__ex‹nsiÚ__


44 
	tšt64_t
;

49 
	tušt8_t
;

50 
	tušt16_t
;

51 #iâdeà
__ušt32_t_defšed


52 
	tušt32_t
;

53 
	#__ušt32_t_defšed


	)

55 #ià
__WORDSIZE
 == 64

56 
	tušt64_t
;

58 
__ex‹nsiÚ__


59 
	tušt64_t
;

66 sigÃd 
	tšt_Ëa¡8_t
;

67 
	tšt_Ëa¡16_t
;

68 
	tšt_Ëa¡32_t
;

69 #ià
__WORDSIZE
 == 64

70 
	tšt_Ëa¡64_t
;

72 
__ex‹nsiÚ__


73 
	tšt_Ëa¡64_t
;

77 
	tušt_Ëa¡8_t
;

78 
	tušt_Ëa¡16_t
;

79 
	tušt_Ëa¡32_t
;

80 #ià
__WORDSIZE
 == 64

81 
	tušt_Ëa¡64_t
;

83 
__ex‹nsiÚ__


84 
	tušt_Ëa¡64_t
;

91 sigÃd 
	tšt_ç¡8_t
;

92 #ià
__WORDSIZE
 == 64

93 
	tšt_ç¡16_t
;

94 
	tšt_ç¡32_t
;

95 
	tšt_ç¡64_t
;

97 
	tšt_ç¡16_t
;

98 
	tšt_ç¡32_t
;

99 
__ex‹nsiÚ__


100 
	tšt_ç¡64_t
;

104 
	tušt_ç¡8_t
;

105 #ià
__WORDSIZE
 == 64

106 
	tušt_ç¡16_t
;

107 
	tušt_ç¡32_t
;

108 
	tušt_ç¡64_t
;

110 
	tušt_ç¡16_t
;

111 
	tušt_ç¡32_t
;

112 
__ex‹nsiÚ__


113 
	tušt_ç¡64_t
;

118 #ià
__WORDSIZE
 == 64

119 #iâdeà
__šŒ_t_defšed


120 
	tšŒ_t
;

121 
	#__šŒ_t_defšed


	)

123 
	tušŒ_t
;

125 #iâdeà
__šŒ_t_defšed


126 
	tšŒ_t
;

127 
	#__šŒ_t_defšed


	)

129 
	tušŒ_t
;

134 #ià
__WORDSIZE
 == 64

135 
	tštmax_t
;

136 
	tuštmax_t
;

138 
__ex‹nsiÚ__


139 
	tštmax_t
;

140 
__ex‹nsiÚ__


141 
	tuštmax_t
;

147 #ià!
defšed
 
__ılu¥lus
 || defšed 
__STDC_LIMIT_MACROS


149 #ià
__WORDSIZE
 == 64

150 
	#__INT64_C
(
c
èø## 
L


	)

151 
	#__UINT64_C
(
c
èø## 
UL


	)

153 
	#__INT64_C
(
c
èø## 
LL


	)

154 
	#__UINT64_C
(
c
èø## 
ULL


	)

160 
	#INT8_MIN
 (-128)

	)

161 
	#INT16_MIN
 (-32767-1)

	)

162 
	#INT32_MIN
 (-2147483647-1)

	)

163 
	#INT64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

165 
	#INT8_MAX
 (127)

	)

166 
	#INT16_MAX
 (32767)

	)

167 
	#INT32_MAX
 (2147483647)

	)

168 
	#INT64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

171 
	#UINT8_MAX
 (255)

	)

172 
	#UINT16_MAX
 (65535)

	)

173 
	#UINT32_MAX
 (4294967295U)

	)

174 
	#UINT64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

178 
	#INT_LEAST8_MIN
 (-128)

	)

179 
	#INT_LEAST16_MIN
 (-32767-1)

	)

180 
	#INT_LEAST32_MIN
 (-2147483647-1)

	)

181 
	#INT_LEAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

183 
	#INT_LEAST8_MAX
 (127)

	)

184 
	#INT_LEAST16_MAX
 (32767)

	)

185 
	#INT_LEAST32_MAX
 (2147483647)

	)

186 
	#INT_LEAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

189 
	#UINT_LEAST8_MAX
 (255)

	)

190 
	#UINT_LEAST16_MAX
 (65535)

	)

191 
	#UINT_LEAST32_MAX
 (4294967295U)

	)

192 
	#UINT_LEAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

196 
	#INT_FAST8_MIN
 (-128)

	)

197 #ià
__WORDSIZE
 == 64

198 
	#INT_FAST16_MIN
 (-9223372036854775807L-1)

	)

199 
	#INT_FAST32_MIN
 (-9223372036854775807L-1)

	)

201 
	#INT_FAST16_MIN
 (-2147483647-1)

	)

202 
	#INT_FAST32_MIN
 (-2147483647-1)

	)

204 
	#INT_FAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

206 
	#INT_FAST8_MAX
 (127)

	)

207 #ià
__WORDSIZE
 == 64

208 
	#INT_FAST16_MAX
 (9223372036854775807L)

	)

209 
	#INT_FAST32_MAX
 (9223372036854775807L)

	)

211 
	#INT_FAST16_MAX
 (2147483647)

	)

212 
	#INT_FAST32_MAX
 (2147483647)

	)

214 
	#INT_FAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

217 
	#UINT_FAST8_MAX
 (255)

	)

218 #ià
__WORDSIZE
 == 64

219 
	#UINT_FAST16_MAX
 (18446744073709551615UL)

	)

220 
	#UINT_FAST32_MAX
 (18446744073709551615UL)

	)

222 
	#UINT_FAST16_MAX
 (4294967295U)

	)

223 
	#UINT_FAST32_MAX
 (4294967295U)

	)

225 
	#UINT_FAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

229 #ià
__WORDSIZE
 == 64

230 
	#INTPTR_MIN
 (-9223372036854775807L-1)

	)

231 
	#INTPTR_MAX
 (9223372036854775807L)

	)

232 
	#UINTPTR_MAX
 (18446744073709551615UL)

	)

234 
	#INTPTR_MIN
 (-2147483647-1)

	)

235 
	#INTPTR_MAX
 (2147483647)

	)

236 
	#UINTPTR_MAX
 (4294967295U)

	)

241 
	#INTMAX_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

243 
	#INTMAX_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

246 
	#UINTMAX_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

252 #ià
__WORDSIZE
 == 64

253 
	#PTRDIFF_MIN
 (-9223372036854775807L-1)

	)

254 
	#PTRDIFF_MAX
 (9223372036854775807L)

	)

256 
	#PTRDIFF_MIN
 (-2147483647-1)

	)

257 
	#PTRDIFF_MAX
 (2147483647)

	)

261 
	#SIG_ATOMIC_MIN
 (-2147483647-1)

	)

262 
	#SIG_ATOMIC_MAX
 (2147483647)

	)

265 #ià
__WORDSIZE
 == 64

266 
	#SIZE_MAX
 (18446744073709551615UL)

	)

268 
	#SIZE_MAX
 (4294967295U)

	)

272 #iâdeà
WCHAR_MIN


274 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

275 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

279 
	#WINT_MIN
 (0u)

	)

280 
	#WINT_MAX
 (4294967295u)

	)

287 #ià!
defšed
 
__ılu¥lus
 || defšed 
__STDC_CONSTANT_MACROS


290 
	#INT8_C
(
c
è
	)
c

291 
	#INT16_C
(
c
è
	)
c

292 
	#INT32_C
(
c
è
	)
c

293 #ià
__WORDSIZE
 == 64

294 
	#INT64_C
(
c
èø## 
L


	)

296 
	#INT64_C
(
c
èø## 
LL


	)

300 
	#UINT8_C
(
c
è
	)
c

301 
	#UINT16_C
(
c
è
	)
c

302 
	#UINT32_C
(
c
èø## 
U


	)

303 #ià
__WORDSIZE
 == 64

304 
	#UINT64_C
(
c
èø## 
UL


	)

306 
	#UINT64_C
(
c
èø## 
ULL


	)

310 #ià
__WORDSIZE
 == 64

311 
	#INTMAX_C
(
c
èø## 
L


	)

312 
	#UINTMAX_C
(
c
èø## 
UL


	)

314 
	#INTMAX_C
(
c
èø## 
LL


	)

315 
	#UINTMAX_C
(
c
èø## 
ULL


	)

	@/usr/include/string.h

24 #iâdef 
_STRING_H


25 
	#_STRING_H
 1

	)

27 
	~<ã©u»s.h
>

29 
	g__BEGIN_DECLS


32 
	#__Ãed_size_t


	)

33 
	#__Ãed_NULL


	)

34 
	~<¡ddef.h
>

37 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (4, 4)

38 
	#__CORRECT_ISO_CPP_STRING_H_PROTO


	)

42 
__BEGIN_NAMESPACE_STD


44 *
	$memıy
 (*
__»¡riù
 
__de¡
,

45 
__cÚ¡
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

46 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

49 *
	$memmove
 (*
__de¡
, 
__cÚ¡
 *
__¤c
, 
size_t
 
__n
)

50 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

51 
__END_NAMESPACE_STD


56 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_BSD
 || defšed 
__USE_XOPEN


57 *
	$memcıy
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
,

58 
__c
, 
size_t
 
__n
)

59 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

63 
__BEGIN_NAMESPACE_STD


65 *
	$mem£t
 (*
__s
, 
__c
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

68 
	$memcmp
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
, 
size_t
 
__n
)

69 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

72 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


75 *
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

76 
__THROW
 
	`__asm
 ("memchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

77 
__cÚ¡
 *
	`memchr
 (__cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

78 
__THROW
 
	`__asm
 ("memchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

80 #ifdeà
__OPTIMIZE__


81 
__ex‹º_®ways_šlše
 *

82 
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
è
__THROW


84  
	`__butš_memchr
 (
__s
, 
__c
, 
__n
);

87 
__ex‹º_®ways_šlše
 
__cÚ¡
 *

88 
	`memchr
 (
__cÚ¡
 *
__s
, 
__c
, 
size_t
 
__n
è
__THROW


90  
	`__butš_memchr
 (
__s
, 
__c
, 
__n
);

93 
	}
}

95 *
	$memchr
 (
__cÚ¡
 *
__s
, 
__c
, 
size_t
 
__n
)

96 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

98 
__END_NAMESPACE_STD


100 #ifdeà
__USE_GNU


103 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


104 "C++" *
	$¿wmemchr
 (*
__s
, 
__c
)

105 
__THROW
 
	`__asm
 ("¿wmemchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

106 "C++" 
__cÚ¡
 *
	$¿wmemchr
 (
__cÚ¡
 *
__s
, 
__c
)

107 
__THROW
 
	`__asm
 ("¿wmemchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

109 *
	$¿wmemchr
 (
__cÚ¡
 *
__s
, 
__c
)

110 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

114 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


115 "C++" *
	$memrchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

116 
__THROW
 
	`__asm
 ("memrchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

117 "C++" 
__cÚ¡
 *
	$memrchr
 (
__cÚ¡
 *
__s
, 
__c
, 
size_t
 
__n
)

118 
__THROW
 
	`__asm
 ("memrchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

120 *
	$memrchr
 (
__cÚ¡
 *
__s
, 
__c
, 
size_t
 
__n
)

121 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

126 
__BEGIN_NAMESPACE_STD


128 *
	$¡rıy
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
)

129 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

131 *
	$¡ºıy
 (*
__»¡riù
 
__de¡
,

132 
__cÚ¡
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

133 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

136 *
	$¡rÿt
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
)

137 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

139 *
	$¡ºÿt
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
,

140 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

143 
	$¡rcmp
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
)

144 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

146 
	$¡ºcmp
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
, 
size_t
 
__n
)

147 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

150 
	$¡rcŞl
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
)

151 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

153 
size_t
 
	$¡rxäm
 (*
__»¡riù
 
__de¡
,

154 
__cÚ¡
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

155 
__THROW
 
	`__nÚnuÎ
 ((2));

156 
__END_NAMESPACE_STD


158 #ifdeà
__USE_XOPEN2K8


162 
	~<xloÿË.h
>

165 
	$¡rcŞl_l
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
, 
__loÿË_t
 
__l
)

166 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 3));

168 
size_t
 
	$¡rxäm_l
 (*
__de¡
, 
__cÚ¡
 *
__¤c
, 
size_t
 
__n
,

169 
__loÿË_t
 
__l
è
__THROW
 
	`__nÚnuÎ
 ((2, 4));

172 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 \

173 || 
defšed
 
__USE_XOPEN2K8


175 *
	$¡rdup
 (
__cÚ¡
 *
__s
)

176 
__THROW
 
__©Œibu‹_m®loc__
 
	`__nÚnuÎ
 ((1));

182 #ià
defšed
 
__USE_XOPEN2K8


183 *
	$¡ºdup
 (
__cÚ¡
 *
__¡ršg
, 
size_t
 
__n
)

184 
__THROW
 
__©Œibu‹_m®loc__
 
	`__nÚnuÎ
 ((1));

187 #ià
defšed
 
__USE_GNU
 && defšed 
__GNUC__


189 
	#¡rdu·
(
s
) \

190 (
__ex‹nsiÚ__
 \

192 
__cÚ¡
 *
__Şd
 = (
s
); \

193 
size_t
 
__Ën
 = 
	`¡¾’
 (
__Şd
) + 1; \

194 *
__Ãw
 = (*è
	`__butš_®loÿ
 (
__Ën
); \

195 (*è
	`memıy
 (
__Ãw
, 
__Şd
, 
__Ën
); \

196 
	}
}))

	)

199 
	#¡ºdu·
(
s
, 
n
) \

200 (
__ex‹nsiÚ__
 \

202 
__cÚ¡
 *
__Şd
 = (
s
); \

203 
size_t
 
__Ën
 = 
	`¡ºËn
 (
__Şd
, (
n
)); \

204 *
__Ãw
 = (*è
	`__butš_®loÿ
 (
__Ën
 + 1); \

205 
__Ãw
[
__Ën
] = '\0'; \

206 (*è
	`memıy
 (
__Ãw
, 
__Şd
, 
__Ën
); \

207 }))

	)

210 
	g__BEGIN_NAMESPACE_STD


212 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


215 *
¡rchr
 (*
__s
, 
__c
)

216 
__THROW
 
__asm
 ("¡rchr"è
__©Œibu‹_pu»__
 
__nÚnuÎ
 ((1));

217 
__cÚ¡
 *
¡rchr
 (__cÚ¡ *
__s
, 
__c
)

218 
__THROW
 
__asm
 ("¡rchr"è
__©Œibu‹_pu»__
 
__nÚnuÎ
 ((1));

220 #ifdeà
__OPTIMIZE__


221 
__ex‹º_®ways_šlše
 *

222 
¡rchr
 (*
__s
, 
__c
è
	g__THROW


224  
__butš_¡rchr
 (
__s
, 
__c
);

227 
__ex‹º_®ways_šlše
 
__cÚ¡
 *

228 
¡rchr
 (
__cÚ¡
 *
__s
, 
__c
è
	g__THROW


230  
__butš_¡rchr
 (
__s
, 
__c
);

235 *
	$¡rchr
 (
__cÚ¡
 *
__s
, 
__c
)

236 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

239 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


242 *
	`¡¼chr
 (*
__s
, 
__c
)

243 
__THROW
 
	`__asm
 ("¡¼chr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

244 
__cÚ¡
 *
	`¡¼chr
 (__cÚ¡ *
__s
, 
__c
)

245 
__THROW
 
	`__asm
 ("¡¼chr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

247 #ifdeà
__OPTIMIZE__


248 
__ex‹º_®ways_šlše
 *

249 
	`¡¼chr
 (*
__s
, 
__c
è
__THROW


251  
	`__butš_¡¼chr
 (
__s
, 
__c
);

254 
__ex‹º_®ways_šlše
 
__cÚ¡
 *

255 
	`¡¼chr
 (
__cÚ¡
 *
__s
, 
__c
è
__THROW


257  
	`__butš_¡¼chr
 (
__s
, 
__c
);

260 
	}
}

262 *
	$¡¼chr
 (
__cÚ¡
 *
__s
, 
__c
)

263 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

265 
__END_NAMESPACE_STD


267 #ifdeà
__USE_GNU


270 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


271 "C++" *
	$¡rchºul
 (*
__s
, 
__c
)

272 
__THROW
 
	`__asm
 ("¡rchºul"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

273 "C++" 
__cÚ¡
 *
	$¡rchºul
 (
__cÚ¡
 *
__s
, 
__c
)

274 
__THROW
 
	`__asm
 ("¡rchºul"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

276 *
	$¡rchºul
 (
__cÚ¡
 *
__s
, 
__c
)

277 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

281 
__BEGIN_NAMESPACE_STD


284 
size_t
 
	$¡rc¥n
 (
__cÚ¡
 *
__s
, __cÚ¡ *
__»jeù
)

285 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

288 
size_t
 
	$¡r¥n
 (
__cÚ¡
 *
__s
, __cÚ¡ *
__acû±
)

289 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

291 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


294 *
	`¡½brk
 (*
__s
, 
__cÚ¡
 *
__acû±
)

295 
__THROW
 
	`__asm
 ("¡½brk"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

296 
__cÚ¡
 *
	`¡½brk
 (__cÚ¡ *
__s
, __cÚ¡ *
__acû±
)

297 
__THROW
 
	`__asm
 ("¡½brk"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

299 #ifdeà
__OPTIMIZE__


300 
__ex‹º_®ways_šlše
 *

301 
	`¡½brk
 (*
__s
, 
__cÚ¡
 *
__acû±
è
__THROW


303  
	`__butš_¡½brk
 (
__s
, 
__acû±
);

306 
__ex‹º_®ways_šlše
 
__cÚ¡
 *

307 
	`¡½brk
 (
__cÚ¡
 *
__s
, __cÚ¡ *
__acû±
è
__THROW


309  
	`__butš_¡½brk
 (
__s
, 
__acû±
);

312 
	}
}

314 *
	$¡½brk
 (
__cÚ¡
 *
__s
, __cÚ¡ *
__acû±
)

315 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

318 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


321 *
	`¡r¡r
 (*
__hay¡ack
, 
__cÚ¡
 *
__ÃedË
)

322 
__THROW
 
	`__asm
 ("¡r¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

323 
__cÚ¡
 *
	`¡r¡r
 (__cÚ¡ *
__hay¡ack
,

324 
__cÚ¡
 *
__ÃedË
)

325 
__THROW
 
	`__asm
 ("¡r¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

327 #ifdeà
__OPTIMIZE__


328 
__ex‹º_®ways_šlše
 *

329 
	`¡r¡r
 (*
__hay¡ack
, 
__cÚ¡
 *
__ÃedË
è
__THROW


331  
	`__butš_¡r¡r
 (
__hay¡ack
, 
__ÃedË
);

334 
__ex‹º_®ways_šlše
 
__cÚ¡
 *

335 
	`¡r¡r
 (
__cÚ¡
 *
__hay¡ack
, __cÚ¡ *
__ÃedË
è
__THROW


337  
	`__butš_¡r¡r
 (
__hay¡ack
, 
__ÃedË
);

340 
	}
}

342 *
	$¡r¡r
 (
__cÚ¡
 *
__hay¡ack
, __cÚ¡ *
__ÃedË
)

343 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

348 *
	$¡¹ok
 (*
__»¡riù
 
__s
, 
__cÚ¡
 *__»¡riù 
__d–im
)

349 
__THROW
 
	`__nÚnuÎ
 ((2));

350 
__END_NAMESPACE_STD


354 *
	$__¡¹ok_r
 (*
__»¡riù
 
__s
,

355 
__cÚ¡
 *
__»¡riù
 
__d–im
,

356 **
__»¡riù
 
__§ve_±r
)

357 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

358 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


359 *
	$¡¹ok_r
 (*
__»¡riù
 
__s
, 
__cÚ¡
 *__»¡riù 
__d–im
,

360 **
__»¡riù
 
__§ve_±r
)

361 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

364 #ifdeà
__USE_GNU


366 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


367 "C++" *
	$¡rÿ£¡r
 (*
__hay¡ack
, 
__cÚ¡
 *
__ÃedË
)

368 
__THROW
 
	`__asm
 ("¡rÿ£¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

369 "C++" 
__cÚ¡
 *
	$¡rÿ£¡r
 (
__cÚ¡
 *
__hay¡ack
,

370 
__cÚ¡
 *
__ÃedË
)

371 
__THROW
 
	`__asm
 ("¡rÿ£¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

373 *
	$¡rÿ£¡r
 (
__cÚ¡
 *
__hay¡ack
, __cÚ¡ *
__ÃedË
)

374 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

378 #ifdeà
__USE_GNU


382 *
	$memmem
 (
__cÚ¡
 *
__hay¡ack
, 
size_t
 
__hay¡ackËn
,

383 
__cÚ¡
 *
__ÃedË
, 
size_t
 
__ÃedËËn
)

384 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 3));

388 *
	$__mempıy
 (*
__»¡riù
 
__de¡
,

389 
__cÚ¡
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

390 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

391 *
	$mempıy
 (*
__»¡riù
 
__de¡
,

392 
__cÚ¡
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

393 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

397 
__BEGIN_NAMESPACE_STD


399 
size_t
 
	$¡¾’
 (
__cÚ¡
 *
__s
)

400 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

401 
__END_NAMESPACE_STD


403 #ifdef 
__USE_XOPEN2K8


406 
size_t
 
	$¡ºËn
 (
__cÚ¡
 *
__¡ršg
, 
size_t
 
__maxËn
)

407 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

411 
__BEGIN_NAMESPACE_STD


413 *
	$¡»¼Ü
 (
__”ºum
è
__THROW
;

414 
__END_NAMESPACE_STD


415 #ià
defšed
 
__USE_XOPEN2K
 || defšed 
__USE_MISC


423 #ià
defšed
 
__USE_XOPEN2K
 && !defšed 
__USE_GNU


426 #ifdeà
__REDIRECT_NTH


427 
	`__REDIRECT_NTH
 (
¡»¼Ü_r
,

428 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
),

429 
__xpg_¡»¼Ü_r
è
	`__nÚnuÎ
 ((2));

431 
	$__xpg_¡»¼Ü_r
 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
)

432 
__THROW
 
	`__nÚnuÎ
 ((2));

433 
	#¡»¼Ü_r
 
__xpg_¡»¼Ü_r


	)

438 *
	$¡»¼Ü_r
 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
)

439 
__THROW
 
	`__nÚnuÎ
 ((2));

443 #ifdeà
__USE_XOPEN2K8


445 *
	$¡»¼Ü_l
 (
__”ºum
, 
__loÿË_t
 
__l
è
__THROW
;

451 
	$__bz”o
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

453 #ifdeà
__USE_BSD


455 
	$bcİy
 (
__cÚ¡
 *
__¤c
, *
__de¡
, 
size_t
 
__n
)

456 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

459 
	$bz”o
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

462 
	$bcmp
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
, 
size_t
 
__n
)

463 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

466 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


469 *
	`šdex
 (*
__s
, 
__c
)

470 
__THROW
 
	`__asm
 ("šdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

471 
__cÚ¡
 *
	`šdex
 (__cÚ¡ *
__s
, 
__c
)

472 
__THROW
 
	`__asm
 ("šdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

474 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


475 
__ex‹º_®ways_šlše
 *

476 
	`šdex
 (*
__s
, 
__c
è
__THROW


478  
	`__butš_šdex
 (
__s
, 
__c
);

481 
__ex‹º_®ways_šlše
 
__cÚ¡
 *

482 
	`šdex
 (
__cÚ¡
 *
__s
, 
__c
è
__THROW


484  
	`__butš_šdex
 (
__s
, 
__c
);

487 
	}
}

489 *
	$šdex
 (
__cÚ¡
 *
__s
, 
__c
)

490 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

494 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


497 *
	`ršdex
 (*
__s
, 
__c
)

498 
__THROW
 
	`__asm
 ("ršdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

499 
__cÚ¡
 *
	`ršdex
 (__cÚ¡ *
__s
, 
__c
)

500 
__THROW
 
	`__asm
 ("ršdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

502 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


503 
__ex‹º_®ways_šlše
 *

504 
	`ršdex
 (*
__s
, 
__c
è
__THROW


506  
	`__butš_ršdex
 (
__s
, 
__c
);

509 
__ex‹º_®ways_šlše
 
__cÚ¡
 *

510 
	`ršdex
 (
__cÚ¡
 *
__s
, 
__c
è
__THROW


512  
	`__butš_ršdex
 (
__s
, 
__c
);

515 
	}
}

517 *
	$ršdex
 (
__cÚ¡
 *
__s
, 
__c
)

518 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

523 
	$ffs
 (
__i
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

527 #ifdef 
__USE_GNU


528 
	$ff¦
 (
__l
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

529 #ifdeà
__GNUC__


530 
__ex‹nsiÚ__
 
	$ff¦l
 (
__Î
)

531 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

536 
	$¡rÿ£cmp
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
)

537 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

540 
	$¡ºÿ£cmp
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
, 
size_t
 
__n
)

541 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

544 #ifdef 
__USE_GNU


547 
	$¡rÿ£cmp_l
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
,

548 
__loÿË_t
 
__loc
)

549 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 3));

551 
	$¡ºÿ£cmp_l
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
,

552 
size_t
 
__n
, 
__loÿË_t
 
__loc
)

553 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 4));

556 #ifdef 
__USE_BSD


559 *
	$¡r£p
 (**
__»¡riù
 
__¡ršgp
,

560 
__cÚ¡
 *
__»¡riù
 
__d–im
)

561 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

564 #ifdef 
__USE_XOPEN2K8


566 *
	$¡rsigÇl
 (
__sig
è
__THROW
;

569 *
	$__¡pıy
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
)

570 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

571 *
	$¡pıy
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
)

572 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

576 *
	$__¡²ıy
 (*
__»¡riù
 
__de¡
,

577 
__cÚ¡
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

578 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

579 *
	$¡²ıy
 (*
__»¡riù
 
__de¡
,

580 
__cÚ¡
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

581 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

584 #ifdef 
__USE_GNU


586 
	$¡rv”scmp
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
)

587 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

590 *
	$¡räy
 (*
__¡ršg
è
__THROW
 
	`__nÚnuÎ
 ((1));

593 *
	$memäob
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

595 #iâdeà
ba£Çme


600 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


601 "C++" *
	$ba£Çme
 (*
__f’ame
)

602 
__THROW
 
	`__asm
 ("ba£Çme"è
	`__nÚnuÎ
 ((1));

603 "C++" 
__cÚ¡
 *
	$ba£Çme
 (
__cÚ¡
 *
__f’ame
)

604 
__THROW
 
	`__asm
 ("ba£Çme"è
	`__nÚnuÎ
 ((1));

606 *
	$ba£Çme
 (
__cÚ¡
 *
__f’ame
è
__THROW
 
	`__nÚnuÎ
 ((1));

612 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

613 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__OPTIMIZE_SIZE__
 \

614 && !
defšed
 
__NO_INLINE__
 && !defšed 
__ılu¥lus


634 
	~<b™s/¡ršg.h
>

637 
	~<b™s/¡ršg2.h
>

640 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše


642 
	~<b™s/¡ršg3.h
>

646 
__END_DECLS


	@/usr/include/sys/ioctl.h

19 #iâdef 
_SYS_IOCTL_H


20 
	#_SYS_IOCTL_H
 1

	)

22 
	~<ã©u»s.h
>

24 
	g__BEGIN_DECLS


27 
	~<b™s/ioùls.h
>

30 
	~<b™s/ioùl-ty³s.h
>

37 
	~<sys/‰ydeçuÉs.h
>

42 
	$ioùl
 (
__fd
, 
__»que¡
, ...è
__THROW
;

44 
__END_DECLS


	@/usr/include/sys/time.h

20 #iâdeà
_SYS_TIME_H


21 
	#_SYS_TIME_H
 1

	)

23 
	~<ã©u»s.h
>

25 
	~<b™s/ty³s.h
>

26 
	#__Ãed_time_t


	)

27 
	~<time.h
>

28 
	#__Ãed_timev®


	)

29 
	~<b™s/time.h
>

31 
	~<sys/£Ëù.h
>

33 #iâdeà
__su£cÚds_t_defšed


34 
__su£cÚds_t
 
	tsu£cÚds_t
;

35 
	#__su£cÚds_t_defšed


	)

39 
	g__BEGIN_DECLS


41 #ifdeà
__USE_GNU


43 
	#TIMEVAL_TO_TIMESPEC
(
tv
, 
ts
) { \

44 (
ts
)->
tv_£c
 = (
tv
)->tv_sec; \

45 (
ts
)->
tv_n£c
 = (
tv
)->
tv_u£c
 * 1000; \

46 }

	)

47 
	#TIMESPEC_TO_TIMEVAL
(
tv
, 
ts
) { \

48 (
tv
)->
tv_£c
 = (
ts
)->tv_sec; \

49 (
tv
)->
tv_u£c
 = (
ts
)->
tv_n£c
 / 1000; \

50 }

	)

54 #ifdeà
__USE_BSD


57 
	stimezÚe


59 
	mtz_mšu‹swe¡
;

60 
	mtz_d¡time
;

63 
timezÚe
 *
	t__»¡riù
 
	t__timezÚe_±r_t
;

65 *
	t__»¡riù
 
	t__timezÚe_±r_t
;

73 
	$g‘timeofday
 (
timev®
 *
__»¡riù
 
__tv
,

74 
__timezÚe_±r_t
 
__tz
è
__THROW
 
	`__nÚnuÎ
 ((1));

76 #ifdeà
__USE_BSD


79 
	$£‰imeofday
 (
__cÚ¡
 
timev®
 *
__tv
,

80 
__cÚ¡
 
timezÚe
 *
__tz
)

81 
__THROW
 
	`__nÚnuÎ
 ((1));

87 
	$adjtime
 (
__cÚ¡
 
timev®
 *
__d–
,

88 
timev®
 *
__Şdd–
è
__THROW
;

93 
	e__™im”_which


96 
ITIMER_REAL
 = 0,

97 
	#ITIMER_REAL
 
ITIMER_REAL


	)

99 
ITIMER_VIRTUAL
 = 1,

100 
	#ITIMER_VIRTUAL
 
ITIMER_VIRTUAL


	)

103 
ITIMER_PROF
 = 2

104 
	#ITIMER_PROF
 
ITIMER_PROF


	)

109 
	s™im”v®


112 
timev®
 
™_š‹rv®
;

114 
timev®
 
™_v®ue
;

117 #ià
defšed
 
__USE_GNU
 && !defšed 
__ılu¥lus


120 
__™im”_which
 
	t__™im”_which_t
;

122 
	t__™im”_which_t
;

127 
	$g‘™im”
 (
__™im”_which_t
 
__which
,

128 
™im”v®
 *
__v®ue
è
__THROW
;

133 
	$£t™im”
 (
__™im”_which_t
 
__which
,

134 
__cÚ¡
 
™im”v®
 *
__»¡riù
 
__Ãw
,

135 
™im”v®
 *
__»¡riù
 
__Şd
è
__THROW
;

140 
	$utimes
 (
__cÚ¡
 *
__fe
, __cÚ¡ 
timev®
 
__tvp
[2])

141 
__THROW
 
	`__nÚnuÎ
 ((1));

143 #ifdeà
__USE_BSD


145 
	$lutimes
 (
__cÚ¡
 *
__fe
, __cÚ¡ 
timev®
 
__tvp
[2])

146 
__THROW
 
	`__nÚnuÎ
 ((1));

149 
	$futimes
 (
__fd
, 
__cÚ¡
 
timev®
 
__tvp
[2]è
__THROW
;

152 #ifdeà
__USE_GNU


156 
	$futime§t
 (
__fd
, 
__cÚ¡
 *
__fe
,

157 
__cÚ¡
 
timev®
 
__tvp
[2]è
__THROW
;

161 #ifdeà
__USE_BSD


164 
	#tim”is£t
(
tvp
è(Ñvp)->
tv_£c
 || (tvp)->
tv_u£c
)

	)

165 
	#tim”ş—r
(
tvp
è(Ñvp)->
tv_£c
 = (tvp)->
tv_u£c
 = 0)

	)

166 
	#tim”cmp
(
a
, 
b
, 
CMP
) \

167 (((
a
)->
tv_£c
 =ğ(
b
)->tv_sec) ? \

168 ((
a
)->
tv_u£c
 
	`CMP
 (
b
)->tv_usec) : \

169 ((
a
)->
tv_£c
 
	`CMP
 (
b
)->tv_£c))

	)

170 
	#tim”add
(
a
, 
b
, 
»suÉ
) \

172 (
»suÉ
)->
tv_£c
 = (
a
)->tv_£ø+ (
b
)->tv_sec; \

173 (
»suÉ
)->
tv_u£c
 = (
a
)->tv_u£ø+ (
b
)->tv_usec; \

174 ià((
»suÉ
)->
tv_u£c
 >= 1000000) \

176 ++(
»suÉ
)->
tv_£c
; \

177 (
»suÉ
)->
tv_u£c
 -= 1000000; \

179 
	}
} 0)

	)

180 
	#tim”sub
(
a
, 
b
, 
»suÉ
) \

182 (
»suÉ
)->
tv_£c
 = (
a
)->tv_£ø- (
b
)->tv_sec; \

183 (
»suÉ
)->
tv_u£c
 = (
a
)->tv_u£ø- (
b
)->tv_usec; \

184 ià((
»suÉ
)->
tv_u£c
 < 0) { \

185 --(
»suÉ
)->
tv_£c
; \

186 (
»suÉ
)->
tv_u£c
 += 1000000; \

188 } 0)

	)

191 
	g__END_DECLS


	@/usr/include/time.h

23 #iâdef 
_TIME_H


25 #ià(! 
defšed
 
__Ãed_time_t
 && !defšed 
__Ãed_şock_t
 && \

26 ! 
defšed
 
	g__Ãed_time¥ec
)

27 
	#_TIME_H
 1

	)

28 
	~<ã©u»s.h
>

30 
	g__BEGIN_DECLS


34 #ifdef 
_TIME_H


36 
	#__Ãed_size_t


	)

37 
	#__Ãed_NULL


	)

38 
	~<¡ddef.h
>

42 
	~<b™s/time.h
>

45 #ià!
defšed
 
__STRICT_ANSI__
 && !defšed 
__USE_XOPEN2K


46 #iâdeà
CLK_TCK


47 
	#CLK_TCK
 
CLOCKS_PER_SEC


	)

53 #ià!
defšed
 
__şock_t_defšed
 && (defšed 
_TIME_H
 || defšed 
__Ãed_şock_t
)

54 
	#__şock_t_defšed
 1

	)

56 
	~<b™s/ty³s.h
>

58 
__BEGIN_NAMESPACE_STD


60 
__şock_t
 
	tşock_t
;

61 
	g__END_NAMESPACE_STD


62 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_POSIX
 || defšed 
__USE_MISC


63 
	$__USING_NAMESPACE_STD
(
şock_t
)

67 #undeà
__Ãed_şock_t


69 #ià!
defšed
 
__time_t_defšed
 && (defšed 
_TIME_H
 || defšed 
__Ãed_time_t
)

70 
	#__time_t_defšed
 1

	)

72 
	~<b™s/ty³s.h
>

74 
__BEGIN_NAMESPACE_STD


76 
__time_t
 
	ttime_t
;

77 
__END_NAMESPACE_STD


78 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC
 || defšed 
__USE_SVID


79 
	$__USING_NAMESPACE_STD
(
time_t
)

83 #undeà
__Ãed_time_t


85 #ià!
defšed
 
__şockid_t_defšed
 && \

86 ((
defšed
 
_TIME_H
 && defšed 
__USE_POSIX199309
è|| defšed 
__Ãed_şockid_t
)

87 
	#__şockid_t_defšed
 1

	)

89 
	~<b™s/ty³s.h
>

92 
__şockid_t
 
	tşockid_t
;

95 #undeà
__şockid_time_t


97 #ià!
defšed
 
__tim”_t_defšed
 && \

98 ((
defšed
 
_TIME_H
 && defšed 
__USE_POSIX199309
è|| defšed 
__Ãed_tim”_t
)

99 
	#__tim”_t_defšed
 1

	)

101 
	~<b™s/ty³s.h
>

104 
__tim”_t
 
	ttim”_t
;

107 #undeà
__Ãed_tim”_t


110 #ià!
defšed
 
__time¥ec_defšed
 && \

111 ((
defšed
 
_TIME_H
 && \

112 (
defšed
 
__USE_POSIX199309
 || defšed 
__USE_MISC
)) || \

113 
defšed
 
__Ãed_time¥ec
)

114 
	#__time¥ec_defšed
 1

	)

116 
	~<b™s/ty³s.h
>

120 
	stime¥ec


122 
__time_t
 
tv_£c
;

123 
tv_n£c
;

127 #undeà
__Ãed_time¥ec


130 #ifdef 
_TIME_H


131 
__BEGIN_NAMESPACE_STD


133 
	stm


135 
tm_£c
;

136 
tm_mš
;

137 
tm_hour
;

138 
tm_mday
;

139 
tm_mÚ
;

140 
tm_y—r
;

141 
tm_wday
;

142 
tm_yday
;

143 
tm_isd¡
;

145 #ifdef 
__USE_BSD


146 
tm_gmtoff
;

147 
__cÚ¡
 *
tm_zÚe
;

149 
__tm_gmtoff
;

150 
__cÚ¡
 *
__tm_zÚe
;

153 
__END_NAMESPACE_STD


154 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_POSIX
 || defšed 
__USE_MISC


155 
	$__USING_NAMESPACE_STD
(
tm
)

159 #ifdeà
__USE_POSIX199309


161 
	s™im”¥ec


163 
time¥ec
 
™_š‹rv®
;

164 
time¥ec
 
™_v®ue
;

168 
sigev’t
;

172 #ifdeà
__USE_XOPEN2K


173 #iâdeà
__pid_t_defšed


174 
__pid_t
 
	tpid_t
;

175 
	#__pid_t_defšed


	)

180 
__BEGIN_NAMESPACE_STD


183 
şock_t
 
	$şock
 (è
__THROW
;

186 
time_t
 
	$time
 (
time_t
 *
__tim”
è
__THROW
;

189 
	$difáime
 (
time_t
 
__time1
,ime_ˆ
__time0
)

190 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

193 
time_t
 
	$mktime
 (
tm
 *
__
è
__THROW
;

199 
size_t
 
	$¡ráime
 (*
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

200 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

201 
__cÚ¡
 
tm
 *
__»¡riù
 
__
è
__THROW
;

202 
__END_NAMESPACE_STD


204 #ifdeà
__USE_XOPEN


207 *
	$¡½time
 (
__cÚ¡
 *
__»¡riù
 
__s
,

208 
__cÚ¡
 *
__»¡riù
 
__fmt
, 
tm
 *
__
)

209 
__THROW
;

212 #ifdeà
__USE_XOPEN2K8


215 
	~<xloÿË.h
>

217 
size_t
 
	$¡ráime_l
 (*
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

218 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

219 
__cÚ¡
 
tm
 *
__»¡riù
 
__
,

220 
__loÿË_t
 
__loc
è
__THROW
;

223 #ifdeà
__USE_GNU


224 *
	$¡½time_l
 (
__cÚ¡
 *
__»¡riù
 
__s
,

225 
__cÚ¡
 *
__»¡riù
 
__fmt
, 
tm
 *
__
,

226 
__loÿË_t
 
__loc
è
__THROW
;

230 
__BEGIN_NAMESPACE_STD


233 
tm
 *
	$gmtime
 (
__cÚ¡
 
time_t
 *
__tim”
è
__THROW
;

237 
tm
 *
	$loÿÉime
 (
__cÚ¡
 
time_t
 *
__tim”
è
__THROW
;

238 
__END_NAMESPACE_STD


240 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


243 
tm
 *
	$gmtime_r
 (
__cÚ¡
 
time_t
 *
__»¡riù
 
__tim”
,

244 
tm
 *
__»¡riù
 
__
è
__THROW
;

248 
tm
 *
	$loÿÉime_r
 (
__cÚ¡
 
time_t
 *
__»¡riù
 
__tim”
,

249 
tm
 *
__»¡riù
 
__
è
__THROW
;

252 
__BEGIN_NAMESPACE_STD


255 *
	$asùime
 (
__cÚ¡
 
tm
 *
__
è
__THROW
;

258 *
	$ùime
 (
__cÚ¡
 
time_t
 *
__tim”
è
__THROW
;

259 
__END_NAMESPACE_STD


261 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


266 *
	$asùime_r
 (
__cÚ¡
 
tm
 *
__»¡riù
 
__
,

267 *
__»¡riù
 
__buf
è
__THROW
;

270 *
	$ùime_r
 (
__cÚ¡
 
time_t
 *
__»¡riù
 
__tim”
,

271 *
__»¡riù
 
__buf
è
__THROW
;

276 *
__tzÇme
[2];

277 
__daylight
;

278 
__timezÚe
;

281 #ifdef 
__USE_POSIX


283 *
tzÇme
[2];

287 
	$tz£t
 (è
__THROW
;

290 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


291 
daylight
;

292 
timezÚe
;

295 #ifdeà
__USE_SVID


298 
	$¡ime
 (
__cÚ¡
 
time_t
 *
__wh’
è
__THROW
;

304 
	#__i¦—p
(
y—r
) \

305 ((
y—r
è% 4 =ğ0 && ((y—rè% 100 !ğ0 || (y—rè% 400 =ğ0))

	)

308 #ifdeà
__USE_MISC


313 
time_t
 
	$timegm
 (
tm
 *
__
è
__THROW
;

316 
time_t
 
	$tim–oÿl
 (
tm
 *
__
è
__THROW
;

319 
	$dysize
 (
__y—r
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

323 #ifdeà
__USE_POSIX199309


328 
	`Çno¦“p
 (
__cÚ¡
 
time¥ec
 *
__»que¡ed_time
,

329 
time¥ec
 *
__»maššg
);

333 
	$şock_g‘»s
 (
şockid_t
 
__şock_id
, 
time¥ec
 *
__»s
è
__THROW
;

336 
	$şock_g‘time
 (
şockid_t
 
__şock_id
, 
time¥ec
 *
__
è
__THROW
;

339 
	$şock_£‰ime
 (
şockid_t
 
__şock_id
, 
__cÚ¡
 
time¥ec
 *
__
)

340 
__THROW
;

342 #ifdeà
__USE_XOPEN2K


347 
	`şock_Çno¦“p
 (
şockid_t
 
__şock_id
, 
__æags
,

348 
__cÚ¡
 
time¥ec
 *
__»q
,

349 
time¥ec
 *
__»m
);

352 
	$şock_g‘ıuşockid
 (
pid_t
 
__pid
, 
şockid_t
 *
__şock_id
è
__THROW
;

357 
	$tim”_ü—‹
 (
şockid_t
 
__şock_id
,

358 
sigev’t
 *
__»¡riù
 
__evp
,

359 
tim”_t
 *
__»¡riù
 
__tim”id
è
__THROW
;

362 
	$tim”_d–‘e
 (
tim”_t
 
__tim”id
è
__THROW
;

365 
	$tim”_£‰ime
 (
tim”_t
 
__tim”id
, 
__æags
,

366 
__cÚ¡
 
™im”¥ec
 *
__»¡riù
 
__v®ue
,

367 
™im”¥ec
 *
__»¡riù
 
__ov®ue
è
__THROW
;

370 
	$tim”_g‘time
 (
tim”_t
 
__tim”id
, 
™im”¥ec
 *
__v®ue
)

371 
__THROW
;

374 
	$tim”_g‘ov”run
 (
tim”_t
 
__tim”id
è
__THROW
;

378 #ifdeà
__USE_XOPEN_EXTENDED


390 
g‘d©e_”r
;

399 
tm
 *
	`g‘d©e
 (
__cÚ¡
 *
__¡ršg
);

402 #ifdeà
__USE_GNU


413 
	`g‘d©e_r
 (
__cÚ¡
 *
__»¡riù
 
__¡ršg
,

414 
tm
 *
__»¡riù
 
__»sbuå
);

417 
__END_DECLS


	@/usr/include/unistd.h

23 #iâdef 
_UNISTD_H


24 
	#_UNISTD_H
 1

	)

26 
	~<ã©u»s.h
>

28 
	g__BEGIN_DECLS


33 #ifdeà
__USE_XOPEN2K8


35 
	#_POSIX_VERSION
 200809L

	)

36 #–ià
defšed
 
__USE_XOPEN2K


38 
	#_POSIX_VERSION
 200112L

	)

39 #–ià
defšed
 
__USE_POSIX199506


41 
	#_POSIX_VERSION
 199506L

	)

42 #–ià
defšed
 
__USE_POSIX199309


44 
	#_POSIX_VERSION
 199309L

	)

47 
	#_POSIX_VERSION
 199009L

	)

53 #ifdeà
__USE_XOPEN2K8


54 
	#__POSIX2_THIS_VERSION
 200809L

	)

56 #–ià
defšed
 
__USE_XOPEN2K


58 
	#__POSIX2_THIS_VERSION
 200112L

	)

59 #–ià
defšed
 
__USE_POSIX199506


61 
	#__POSIX2_THIS_VERSION
 199506L

	)

64 
	#__POSIX2_THIS_VERSION
 199209L

	)

68 
	#_POSIX2_VERSION
 
__POSIX2_THIS_VERSION


	)

72 
	#_POSIX2_C_BIND
 
__POSIX2_THIS_VERSION


	)

76 
	#_POSIX2_C_DEV
 
__POSIX2_THIS_VERSION


	)

80 
	#_POSIX2_SW_DEV
 
__POSIX2_THIS_VERSION


	)

84 
	#_POSIX2_LOCALEDEF
 
__POSIX2_THIS_VERSION


	)

87 #ifdeà
__USE_XOPEN2K8


88 
	#_XOPEN_VERSION
 700

	)

89 #–ià
defšed
 
__USE_XOPEN2K


90 
	#_XOPEN_VERSION
 600

	)

91 #–ià
defšed
 
__USE_UNIX98


92 
	#_XOPEN_VERSION
 500

	)

94 
	#_XOPEN_VERSION
 4

	)

98 
	#_XOPEN_XCU_VERSION
 4

	)

101 
	#_XOPEN_XPG2
 1

	)

102 
	#_XOPEN_XPG3
 1

	)

103 
	#_XOPEN_XPG4
 1

	)

106 
	#_XOPEN_UNIX
 1

	)

109 
	#_XOPEN_CRYPT
 1

	)

113 
	#_XOPEN_ENH_I18N
 1

	)

116 
	#_XOPEN_LEGACY
 1

	)

203 
	~<b™s/posix_İt.h
>

206 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


207 
	~<b™s/’vœÚm’ts.h
>

211 
	#STDIN_FILENO
 0

	)

212 
	#STDOUT_FILENO
 1

	)

213 
	#STDERR_FILENO
 2

	)

218 
	~<b™s/ty³s.h
>

220 #iâdef 
__ssize_t_defšed


221 
__ssize_t
 
	tssize_t
;

222 
	#__ssize_t_defšed


	)

225 
	#__Ãed_size_t


	)

226 
	#__Ãed_NULL


	)

227 
	~<¡ddef.h
>

229 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


232 #iâdeà
__gid_t_defšed


233 
__gid_t
 
	tgid_t
;

234 
	#__gid_t_defšed


	)

237 #iâdeà
__uid_t_defšed


238 
__uid_t
 
	tuid_t
;

239 
	#__uid_t_defšed


	)

242 #iâdeà
__off_t_defšed


243 #iâdeà
__USE_FILE_OFFSET64


244 
__off_t
 
	toff_t
;

246 
__off64_t
 
	toff_t
;

248 
	#__off_t_defšed


	)

250 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


251 
__off64_t
 
	toff64_t
;

252 
	#__off64_t_defšed


	)

255 #iâdeà
__u£cÚds_t_defšed


256 
__u£cÚds_t
 
	tu£cÚds_t
;

257 
	#__u£cÚds_t_defšed


	)

260 #iâdeà
__pid_t_defšed


261 
__pid_t
 
	tpid_t
;

262 
	#__pid_t_defšed


	)

266 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


267 #iâdeà
__šŒ_t_defšed


268 
__šŒ_t
 
	tšŒ_t
;

269 
	#__šŒ_t_defšed


	)

273 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN


274 #iâdeà
__sockËn_t_defšed


275 
__sockËn_t
 
	tsockËn_t
;

276 
	#__sockËn_t_defšed


	)

282 
	#R_OK
 4

	)

283 
	#W_OK
 2

	)

284 
	#X_OK
 1

	)

285 
	#F_OK
 0

	)

288 
	$acûss
 (
__cÚ¡
 *
__Çme
, 
__ty³
è
__THROW
 
	`__nÚnuÎ
 ((1));

290 #ifdeà
__USE_GNU


293 
	$euidacûss
 (
__cÚ¡
 *
__Çme
, 
__ty³
)

294 
__THROW
 
	`__nÚnuÎ
 ((1));

297 
	$—cûss
 (
__cÚ¡
 *
__Çme
, 
__ty³
)

298 
__THROW
 
	`__nÚnuÎ
 ((1));

301 #ifdeà
__USE_ATFILE


305 
	$çcûs§t
 (
__fd
, 
__cÚ¡
 *
__fe
, 
__ty³
, 
__æag
)

306 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

311 #iâdef 
_STDIO_H


312 
	#SEEK_SET
 0

	)

313 
	#SEEK_CUR
 1

	)

314 
	#SEEK_END
 2

	)

315 #ifdeà
__USE_GNU


316 
	#SEEK_DATA
 3

	)

317 
	#SEEK_HOLE
 4

	)

321 #ià
defšed
 
__USE_BSD
 && !defšed 
L_SET


323 
	#L_SET
 
SEEK_SET


	)

324 
	#L_INCR
 
SEEK_CUR


	)

325 
	#L_XTND
 
SEEK_END


	)

334 #iâdeà
__USE_FILE_OFFSET64


335 
__off_t
 
	$l£ek
 (
__fd
, 
__off_t
 
__off£t
, 
__wh’û
è
__THROW
;

337 #ifdeà
__REDIRECT_NTH


338 
__off64_t
 
	`__REDIRECT_NTH
 (
l£ek
,

339 (
__fd
, 
__off64_t
 
__off£t
, 
__wh’û
),

340 
l£ek64
);

342 
	#l£ek
 
l£ek64


	)

345 #ifdeà
__USE_LARGEFILE64


346 
__off64_t
 
	$l£ek64
 (
__fd
, 
__off64_t
 
__off£t
, 
__wh’û
)

347 
__THROW
;

354 
	`şo£
 (
__fd
);

361 
ssize_t
 
	$»ad
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
è
__wur
;

367 
ssize_t
 
	$wr™e
 (
__fd
, 
__cÚ¡
 *
__buf
, 
size_t
 
__n
è
__wur
;

369 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8


370 #iâdeà
__USE_FILE_OFFSET64


377 
ssize_t
 
	$´—d
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

378 
__off_t
 
__off£t
è
__wur
;

385 
ssize_t
 
	$pwr™e
 (
__fd
, 
__cÚ¡
 *
__buf
, 
size_t
 
__n
,

386 
__off_t
 
__off£t
è
__wur
;

388 #ifdeà
__REDIRECT


389 
ssize_t
 
	`__REDIRECT
 (
´—d
, (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

390 
__off64_t
 
__off£t
),

391 
´—d64
è
__wur
;

392 
ssize_t
 
	`__REDIRECT
 (
pwr™e
, (
__fd
, 
__cÚ¡
 *
__buf
,

393 
size_t
 
__nby‹s
, 
__off64_t
 
__off£t
),

394 
pwr™e64
è
__wur
;

396 
	#´—d
 
´—d64


	)

397 
	#pwr™e
 
pwr™e64


	)

401 #ifdeà
__USE_LARGEFILE64


405 
ssize_t
 
	$´—d64
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

406 
__off64_t
 
__off£t
è
__wur
;

409 
ssize_t
 
	$pwr™e64
 (
__fd
, 
__cÚ¡
 *
__buf
, 
size_t
 
__n
,

410 
__off64_t
 
__off£t
è
__wur
;

418 
	$pe
 (
__pedes
[2]è
__THROW
 
__wur
;

420 #ifdeà
__USE_GNU


423 
	$pe2
 (
__pedes
[2], 
__æags
è
__THROW
 
__wur
;

433 
	$®¬m
 (
__£cÚds
è
__THROW
;

445 
	`¦“p
 (
__£cÚds
);

447 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

448 || 
defšed
 
__USE_BSD


453 
__u£cÚds_t
 
	$u®¬m
 (
__u£cÚds_t
 
__v®ue
, __u£cÚds_ˆ
__š‹rv®
)

454 
__THROW
;

461 
	`u¦“p
 (
__u£cÚds_t
 
__u£cÚds
);

470 
	`·u£
 ();

474 
	$chown
 (
__cÚ¡
 *
__fe
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
)

475 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

477 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


479 
	$fchown
 (
__fd
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
è
__THROW
 
__wur
;

484 
	$lchown
 (
__cÚ¡
 *
__fe
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
)

485 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

489 #ifdeà
__USE_ATFILE


492 
	$fchowÇt
 (
__fd
, 
__cÚ¡
 *
__fe
, 
__uid_t
 
__owÃr
,

493 
__gid_t
 
__group
, 
__æag
)

494 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

498 
	$chdœ
 (
__cÚ¡
 *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

500 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


502 
	$fchdœ
 (
__fd
è
__THROW
 
__wur
;

512 *
	$g‘cwd
 (*
__buf
, 
size_t
 
__size
è
__THROW
 
__wur
;

514 #ifdef 
__USE_GNU


518 *
	$g‘_cu¼’t_dœ_Çme
 (è
__THROW
;

521 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

522 || 
defšed
 
__USE_BSD


526 *
	$g‘wd
 (*
__buf
)

527 
__THROW
 
	`__nÚnuÎ
 ((1)è
__©Œibu‹_d•»ÿ‹d__
 
__wur
;

532 
	$dup
 (
__fd
è
__THROW
 
__wur
;

535 
	$dup2
 (
__fd
, 
__fd2
è
__THROW
;

537 #ifdeà
__USE_GNU


540 
	$dup3
 (
__fd
, 
__fd2
, 
__æags
è
__THROW
;

544 **
__’vœÚ
;

545 #ifdeà
__USE_GNU


546 **
’vœÚ
;

552 
	$execve
 (
__cÚ¡
 *
__·th
, *__cÚ¡ 
__¬gv
[],

553 *
__cÚ¡
 
__’vp
[]è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

555 #ifdeà
__USE_XOPEN2K8


558 
	$ãxecve
 (
__fd
, *
__cÚ¡
 
__¬gv
[], *__cÚ¡ 
__’vp
[])

559 
__THROW
 
	`__nÚnuÎ
 ((2));

564 
	$execv
 (
__cÚ¡
 *
__·th
, *__cÚ¡ 
__¬gv
[])

565 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

569 
	$exeşe
 (
__cÚ¡
 *
__·th
, __cÚ¡ *
__¬g
, ...)

570 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

574 
	$exeş
 (
__cÚ¡
 *
__·th
, __cÚ¡ *
__¬g
, ...)

575 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

579 
	$execvp
 (
__cÚ¡
 *
__fe
, *__cÚ¡ 
__¬gv
[])

580 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

585 
	$exeşp
 (
__cÚ¡
 *
__fe
, __cÚ¡ *
__¬g
, ...)

586 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

588 #ifdeà
__USE_GNU


591 
	$execv³
 (
__cÚ¡
 *
__fe
, *__cÚ¡ 
__¬gv
[],

592 *
__cÚ¡
 
__’vp
[])

593 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

597 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


599 
	$niû
 (
__šc
è
__THROW
 
__wur
;

604 
	$_ex™
 (
__¡©us
è
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

610 
	~<b™s/cÚâame.h
>

613 
	$·thcÚf
 (
__cÚ¡
 *
__·th
, 
__Çme
)

614 
__THROW
 
	`__nÚnuÎ
 ((1));

617 
	$å©hcÚf
 (
__fd
, 
__Çme
è
__THROW
;

620 
	$syscÚf
 (
__Çme
è
__THROW
;

622 #ifdef 
__USE_POSIX2


624 
size_t
 
	$cÚf¡r
 (
__Çme
, *
__buf
, 
size_t
 
__Ën
è
__THROW
;

629 
__pid_t
 
	$g‘pid
 (è
__THROW
;

632 
__pid_t
 
	$g‘µid
 (è
__THROW
;

636 #iâdeà
__FAVOR_BSD


637 
__pid_t
 
	$g‘pg½
 (è
__THROW
;

639 #ifdeà
__REDIRECT_NTH


640 
__pid_t
 
	`__REDIRECT_NTH
 (
g‘pg½
, (__pid_ˆ
__pid
), 
__g‘pgid
);

642 
	#g‘pg½
 
__g‘pgid


	)

647 
__pid_t
 
	$__g‘pgid
 (
__pid_t
 
__pid
è
__THROW
;

648 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


649 
__pid_t
 
	$g‘pgid
 (
__pid_t
 
__pid
è
__THROW
;

656 
	$£gid
 (
__pid_t
 
__pid
, __pid_ˆ
__pgid
è
__THROW
;

658 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


669 #iâdeà
__FAVOR_BSD


673 
	$£g½
 (è
__THROW
;

678 #ifdeà
__REDIRECT_NTH


679 
	`__REDIRECT_NTH
 (
£g½
, (
__pid_t
 
__pid
, __pid_ˆ
__pg½
), 
£gid
);

681 
	#£g½
 
£gid


	)

690 
__pid_t
 
	$£tsid
 (è
__THROW
;

692 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


694 
__pid_t
 
	$g‘sid
 (
__pid_t
 
__pid
è
__THROW
;

698 
__uid_t
 
	$g‘uid
 (è
__THROW
;

701 
__uid_t
 
	$g‘euid
 (è
__THROW
;

704 
__gid_t
 
	$g‘gid
 (è
__THROW
;

707 
__gid_t
 
	$g‘egid
 (è
__THROW
;

712 
	$g‘groups
 (
__size
, 
__gid_t
 
__li¡
[]è
__THROW
 
__wur
;

714 #ifdef 
__USE_GNU


716 
	$group_memb”
 (
__gid_t
 
__gid
è
__THROW
;

723 
	$£tuid
 (
__uid_t
 
__uid
è
__THROW
;

725 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


728 
	$£Œeuid
 (
__uid_t
 
__ruid
, __uid_ˆ
__euid
è
__THROW
;

731 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN2K


733 
	$£‹uid
 (
__uid_t
 
__uid
è
__THROW
;

740 
	$£tgid
 (
__gid_t
 
__gid
è
__THROW
;

742 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


745 
	$£Œegid
 (
__gid_t
 
__rgid
, __gid_ˆ
__egid
è
__THROW
;

748 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN2K


750 
	$£‹gid
 (
__gid_t
 
__gid
è
__THROW
;

753 #ifdeà
__USE_GNU


756 
	$g‘»suid
 (
__uid_t
 *
__ruid
, __uid_ˆ*
__euid
, __uid_ˆ*
__suid
)

757 
__THROW
;

761 
	$g‘»sgid
 (
__gid_t
 *
__rgid
, __gid_ˆ*
__egid
, __gid_ˆ*
__sgid
)

762 
__THROW
;

766 
	$£Œesuid
 (
__uid_t
 
__ruid
, __uid_ˆ
__euid
, __uid_ˆ
__suid
)

767 
__THROW
;

771 
	$£Œesgid
 (
__gid_t
 
__rgid
, __gid_ˆ
__egid
, __gid_ˆ
__sgid
)

772 
__THROW
;

779 
__pid_t
 
	$fÜk
 (è
__THROWNL
;

781 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

782 || 
defšed
 
__USE_BSD


787 
__pid_t
 
	$vfÜk
 (è
__THROW
;

793 *
	$‰yÇme
 (
__fd
è
__THROW
;

797 
	$‰yÇme_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
)

798 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

802 
	$i§‰y
 (
__fd
è
__THROW
;

804 #ià
defšed
 
__USE_BSD
 \

805 || (
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_UNIX98
)

808 
	$‰y¦Ù
 (è
__THROW
;

813 
	$lšk
 (
__cÚ¡
 *
__äom
, __cÚ¡ *
__to
)

814 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

816 #ifdeà
__USE_ATFILE


819 
	$lšk©
 (
__äomfd
, 
__cÚ¡
 *
__äom
, 
__tofd
,

820 
__cÚ¡
 *
__to
, 
__æags
)

821 
__THROW
 
	`__nÚnuÎ
 ((2, 4)è
__wur
;

824 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


826 
	$symlšk
 (
__cÚ¡
 *
__äom
, __cÚ¡ *
__to
)

827 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

832 
ssize_t
 
	$»adlšk
 (
__cÚ¡
 *
__»¡riù
 
__·th
,

833 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

834 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

837 #ifdeà
__USE_ATFILE


839 
	$symlšk©
 (
__cÚ¡
 *
__äom
, 
__tofd
,

840 
__cÚ¡
 *
__to
è
__THROW
 
	`__nÚnuÎ
 ((1, 3)è
__wur
;

843 
ssize_t
 
	$»adlšk©
 (
__fd
, 
__cÚ¡
 *
__»¡riù
 
__·th
,

844 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

845 
__THROW
 
	`__nÚnuÎ
 ((2, 3)è
__wur
;

849 
	$uÆšk
 (
__cÚ¡
 *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

851 #ifdeà
__USE_ATFILE


853 
	$uÆšk©
 (
__fd
, 
__cÚ¡
 *
__Çme
, 
__æag
)

854 
__THROW
 
	`__nÚnuÎ
 ((2));

858 
	$rmdœ
 (
__cÚ¡
 *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1));

862 
__pid_t
 
	$tcg‘pg½
 (
__fd
è
__THROW
;

865 
	$tc£g½
 (
__fd
, 
__pid_t
 
__pg½_id
è
__THROW
;

872 *
	`g‘logš
 ();

873 #ià
defšed
 
__USE_REENTRANT
 || defšed 
__USE_POSIX199506


880 
	$g‘logš_r
 (*
__Çme
, 
size_t
 
__Çme_Ën
è
	`__nÚnuÎ
 ((1));

883 #ifdef 
__USE_BSD


885 
	$£ogš
 (
__cÚ¡
 *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

889 #ifdef 
__USE_POSIX2


893 
	#__Ãed_g‘İt


	)

894 
	~<g‘İt.h
>

898 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


902 
	$g‘ho¡Çme
 (*
__Çme
, 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((1));

906 #ià
defšed
 
__USE_BSD
 || (defšed 
__USE_XOPEN
 && !defšed 
__USE_UNIX98
)

909 
	$£tho¡Çme
 (
__cÚ¡
 *
__Çme
, 
size_t
 
__Ën
)

910 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

914 
	$£tho¡id
 (
__id
è
__THROW
 
__wur
;

920 
	$g‘domašÇme
 (*
__Çme
, 
size_t
 
__Ën
)

921 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

922 
	$£tdomašÇme
 (
__cÚ¡
 *
__Çme
, 
size_t
 
__Ën
)

923 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

929 
	$vhªgup
 (è
__THROW
;

932 
	$»voke
 (
__cÚ¡
 *
__fe
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

940 
	$´of
 (*
__§m¶e_bufãr
, 
size_t
 
__size
,

941 
size_t
 
__off£t
, 
__sÿË
)

942 
__THROW
 
	`__nÚnuÎ
 ((1));

948 
	$acù
 (
__cÚ¡
 *
__Çme
è
__THROW
;

952 *
	$g‘u£rsh–l
 (è
__THROW
;

953 
	$’du£rsh–l
 (è
__THROW
;

954 
	$£tu£rsh–l
 (è
__THROW
;

960 
	$d«mÚ
 (
__nochdœ
, 
__noşo£
è
__THROW
 
__wur
;

964 #ià
defšed
 
__USE_BSD
 || (defšed 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
)

967 
	$chroÙ
 (
__cÚ¡
 *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

971 *
	$g‘·ss
 (
__cÚ¡
 *
__´om±
è
	`__nÚnuÎ
 ((1));

975 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


980 
	`fsync
 (
__fd
);

984 #ifdeà
__USE_GNU


987 
	$syncfs
 (
__fd
è
__THROW
;

991 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


994 
	`g‘ho¡id
 ();

997 
	$sync
 (è
__THROW
;

1000 #ià
defšed
 
__USE_BSD
 || !defšed 
__USE_XOPEN2K


1003 
	$g‘·gesize
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

1008 
	$g‘dbËsize
 (è
__THROW
;

1014 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


1017 #iâdeà
__USE_FILE_OFFSET64


1018 
	$Œunÿ‹
 (
__cÚ¡
 *
__fe
, 
__off_t
 
__Ëngth
)

1019 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

1021 #ifdeà
__REDIRECT_NTH


1022 
	`__REDIRECT_NTH
 (
Œunÿ‹
,

1023 (
__cÚ¡
 *
__fe
, 
__off64_t
 
__Ëngth
),

1024 
Œunÿ‹64
è
	`__nÚnuÎ
 ((1)è
__wur
;

1026 
	#Œunÿ‹
 
Œunÿ‹64


	)

1029 #ifdeà
__USE_LARGEFILE64


1030 
	$Œunÿ‹64
 (
__cÚ¡
 *
__fe
, 
__off64_t
 
__Ëngth
)

1031 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

1036 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


1039 #iâdeà
__USE_FILE_OFFSET64


1040 
	$árunÿ‹
 (
__fd
, 
__off_t
 
__Ëngth
è
__THROW
 
__wur
;

1042 #ifdeà
__REDIRECT_NTH


1043 
	`__REDIRECT_NTH
 (
árunÿ‹
, (
__fd
, 
__off64_t
 
__Ëngth
),

1044 
árunÿ‹64
è
__wur
;

1046 
	#árunÿ‹
 
árunÿ‹64


	)

1049 #ifdeà
__USE_LARGEFILE64


1050 
	$árunÿ‹64
 (
__fd
, 
__off64_t
 
__Ëngth
è
__THROW
 
__wur
;

1056 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K
) \

1057 || 
defšed
 
__USE_MISC


1061 
	$brk
 (*
__addr
è
__THROW
 
__wur
;

1067 *
	$sbrk
 (
šŒ_t
 
__d–
è
__THROW
;

1071 #ifdeà
__USE_MISC


1082 
	$sysÿÎ
 (
__sy¢o
, ...è
__THROW
;

1087 #ià(
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
è&& !defšed 
F_LOCK


1099 
	#F_ULOCK
 0

	)

1100 
	#F_LOCK
 1

	)

1101 
	#F_TLOCK
 2

	)

1102 
	#F_TEST
 3

	)

1104 #iâdeà
__USE_FILE_OFFSET64


1105 
	$lockf
 (
__fd
, 
__cmd
, 
__off_t
 
__Ën
è
__wur
;

1107 #ifdeà
__REDIRECT


1108 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
),

1109 
lockf64
è
__wur
;

1111 
	#lockf
 
lockf64


	)

1114 #ifdeà
__USE_LARGEFILE64


1115 
	$lockf64
 (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
è
__wur
;

1120 #ifdeà
__USE_GNU


1125 
	#TEMP_FAILURE_RETRY
(
ex´essiÚ
) \

1126 (
__ex‹nsiÚ__
 \

1127 ({ 
__»suÉ
; \

1128 dØ
__»suÉ
 = (è(
ex´essiÚ
); \

1129 
__»suÉ
 =ğ-1L && 
”ºo
 =ğ
EINTR
); \

1130 
__»suÉ
; 
	}
}))

	)

1133 #ià
defšed
 
__USE_POSIX199309
 || defšed 
__USE_UNIX98


1136 
fd©async
 (
__fdes
);

1142 #ifdef 
__USE_XOPEN


1144 *
	$üy±
 (
__cÚ¡
 *
__key
, __cÚ¡ *
__§É
)

1145 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1149 
	$’üy±
 (*
__libc_block
, 
__edæag
è
__THROW
 
	`__nÚnuÎ
 ((1));

1156 
	$swab
 (
__cÚ¡
 *
__»¡riù
 
__äom
, *__»¡riù 
__to
,

1157 
ssize_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1163 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


1165 *
	$ù”mid
 (*
__s
è
__THROW
;

1170 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše


1171 
	~<b™s/uni¡d.h
>

1174 
__END_DECLS


	@/usr/include/asm-generic/errno.h

1 #iâdeà
_ASM_GENERIC_ERRNO_H


2 
	#_ASM_GENERIC_ERRNO_H


	)

4 
	~<asm-g’”ic/”ºo-ba£.h
>

6 
	#EDEADLK
 35

	)

7 
	#ENAMETOOLONG
 36

	)

8 
	#ENOLCK
 37

	)

9 
	#ENOSYS
 38

	)

10 
	#ENOTEMPTY
 39

	)

11 
	#ELOOP
 40

	)

12 
	#EWOULDBLOCK
 
EAGAIN


	)

13 
	#ENOMSG
 42

	)

14 
	#EIDRM
 43

	)

15 
	#ECHRNG
 44

	)

16 
	#EL2NSYNC
 45

	)

17 
	#EL3HLT
 46

	)

18 
	#EL3RST
 47

	)

19 
	#ELNRNG
 48

	)

20 
	#EUNATCH
 49

	)

21 
	#ENOCSI
 50

	)

22 
	#EL2HLT
 51

	)

23 
	#EBADE
 52

	)

24 
	#EBADR
 53

	)

25 
	#EXFULL
 54

	)

26 
	#ENOANO
 55

	)

27 
	#EBADRQC
 56

	)

28 
	#EBADSLT
 57

	)

30 
	#EDEADLOCK
 
EDEADLK


	)

32 
	#EBFONT
 59

	)

33 
	#ENOSTR
 60

	)

34 
	#ENODATA
 61

	)

35 
	#ETIME
 62

	)

36 
	#ENOSR
 63

	)

37 
	#ENONET
 64

	)

38 
	#ENOPKG
 65

	)

39 
	#EREMOTE
 66

	)

40 
	#ENOLINK
 67

	)

41 
	#EADV
 68

	)

42 
	#ESRMNT
 69

	)

43 
	#ECOMM
 70

	)

44 
	#EPROTO
 71

	)

45 
	#EMULTIHOP
 72

	)

46 
	#EDOTDOT
 73

	)

47 
	#EBADMSG
 74

	)

48 
	#EOVERFLOW
 75

	)

49 
	#ENOTUNIQ
 76

	)

50 
	#EBADFD
 77

	)

51 
	#EREMCHG
 78

	)

52 
	#ELIBACC
 79

	)

53 
	#ELIBBAD
 80

	)

54 
	#ELIBSCN
 81

	)

55 
	#ELIBMAX
 82

	)

56 
	#ELIBEXEC
 83

	)

57 
	#EILSEQ
 84

	)

58 
	#ERESTART
 85

	)

59 
	#ESTRPIPE
 86

	)

60 
	#EUSERS
 87

	)

61 
	#ENOTSOCK
 88

	)

62 
	#EDESTADDRREQ
 89

	)

63 
	#EMSGSIZE
 90

	)

64 
	#EPROTOTYPE
 91

	)

65 
	#ENOPROTOOPT
 92

	)

66 
	#EPROTONOSUPPORT
 93

	)

67 
	#ESOCKTNOSUPPORT
 94

	)

68 
	#EOPNOTSUPP
 95

	)

69 
	#EPFNOSUPPORT
 96

	)

70 
	#EAFNOSUPPORT
 97

	)

71 
	#EADDRINUSE
 98

	)

72 
	#EADDRNOTAVAIL
 99

	)

73 
	#ENETDOWN
 100

	)

74 
	#ENETUNREACH
 101

	)

75 
	#ENETRESET
 102

	)

76 
	#ECONNABORTED
 103

	)

77 
	#ECONNRESET
 104

	)

78 
	#ENOBUFS
 105

	)

79 
	#EISCONN
 106

	)

80 
	#ENOTCONN
 107

	)

81 
	#ESHUTDOWN
 108

	)

82 
	#ETOOMANYREFS
 109

	)

83 
	#ETIMEDOUT
 110

	)

84 
	#ECONNREFUSED
 111

	)

85 
	#EHOSTDOWN
 112

	)

86 
	#EHOSTUNREACH
 113

	)

87 
	#EALREADY
 114

	)

88 
	#EINPROGRESS
 115

	)

89 
	#ESTALE
 116

	)

90 
	#EUCLEAN
 117

	)

91 
	#ENOTNAM
 118

	)

92 
	#ENAVAIL
 119

	)

93 
	#EISNAM
 120

	)

94 
	#EREMOTEIO
 121

	)

95 
	#EDQUOT
 122

	)

97 
	#ENOMEDIUM
 123

	)

98 
	#EMEDIUMTYPE
 124

	)

99 
	#ECANCELED
 125

	)

100 
	#ENOKEY
 126

	)

101 
	#EKEYEXPIRED
 127

	)

102 
	#EKEYREVOKED
 128

	)

103 
	#EKEYREJECTED
 129

	)

106 
	#EOWNERDEAD
 130

	)

107 
	#ENOTRECOVERABLE
 131

	)

109 
	#ERFKILL
 132

	)

111 
	#EHWPOISON
 133

	)

	@/usr/include/asm-generic/fcntl.h

1 #iâdeà
_ASM_GENERIC_FCNTL_H


2 
	#_ASM_GENERIC_FCNTL_H


	)

4 
	~<lšux/ty³s.h
>

18 
	#O_ACCMODE
 00000003

	)

19 
	#O_RDONLY
 00000000

	)

20 
	#O_WRONLY
 00000001

	)

21 
	#O_RDWR
 00000002

	)

22 #iâdeà
O_CREAT


23 
	#O_CREAT
 00000100

	)

25 #iâdeà
O_EXCL


26 
	#O_EXCL
 00000200

	)

28 #iâdeà
O_NOCTTY


29 
	#O_NOCTTY
 00000400

	)

31 #iâdeà
O_TRUNC


32 
	#O_TRUNC
 00001000

	)

34 #iâdeà
O_APPEND


35 
	#O_APPEND
 00002000

	)

37 #iâdeà
O_NONBLOCK


38 
	#O_NONBLOCK
 00004000

	)

40 #iâdeà
O_DSYNC


41 
	#O_DSYNC
 00010000

	)

43 #iâdeà
FASYNC


44 
	#FASYNC
 00020000

	)

46 #iâdeà
O_DIRECT


47 
	#O_DIRECT
 00040000

	)

49 #iâdeà
O_LARGEFILE


50 
	#O_LARGEFILE
 00100000

	)

52 #iâdeà
O_DIRECTORY


53 
	#O_DIRECTORY
 00200000

	)

55 #iâdeà
O_NOFOLLOW


56 
	#O_NOFOLLOW
 00400000

	)

58 #iâdeà
O_NOATIME


59 
	#O_NOATIME
 01000000

	)

61 #iâdeà
O_CLOEXEC


62 
	#O_CLOEXEC
 02000000

	)

78 #iâdeà
O_SYNC


79 
	#__O_SYNC
 04000000

	)

80 
	#O_SYNC
 (
__O_SYNC
|
O_DSYNC
)

	)

83 #iâdeà
O_PATH


84 
	#O_PATH
 010000000

	)

87 #iâdeà
O_NDELAY


88 
	#O_NDELAY
 
O_NONBLOCK


	)

91 
	#F_DUPFD
 0

	)

92 
	#F_GETFD
 1

	)

93 
	#F_SETFD
 2

	)

94 
	#F_GETFL
 3

	)

95 
	#F_SETFL
 4

	)

96 #iâdeà
F_GETLK


97 
	#F_GETLK
 5

	)

98 
	#F_SETLK
 6

	)

99 
	#F_SETLKW
 7

	)

101 #iâdeà
F_SETOWN


102 
	#F_SETOWN
 8

	)

103 
	#F_GETOWN
 9

	)

105 #iâdeà
F_SETSIG


106 
	#F_SETSIG
 10

	)

107 
	#F_GETSIG
 11

	)

110 #iâdeà
CONFIG_64BIT


111 #iâdeà
F_GETLK64


112 
	#F_GETLK64
 12

	)

113 
	#F_SETLK64
 13

	)

114 
	#F_SETLKW64
 14

	)

118 #iâdeà
F_SETOWN_EX


119 
	#F_SETOWN_EX
 15

	)

120 
	#F_GETOWN_EX
 16

	)

123 
	#F_OWNER_TID
 0

	)

124 
	#F_OWNER_PID
 1

	)

125 
	#F_OWNER_PGRP
 2

	)

127 
	sf_owÃr_ex
 {

128 
	mty³
;

129 
__k”Ãl_pid_t
 
	mpid
;

133 
	#FD_CLOEXEC
 1

	)

136 #iâdeà
F_RDLCK


137 
	#F_RDLCK
 0

	)

138 
	#F_WRLCK
 1

	)

139 
	#F_UNLCK
 2

	)

143 #iâdeà
F_EXLCK


144 
	#F_EXLCK
 4

	)

145 
	#F_SHLCK
 8

	)

149 
	#LOCK_SH
 1

	)

150 
	#LOCK_EX
 2

	)

151 
	#LOCK_NB
 4

	)

153 
	#LOCK_UN
 8

	)

155 
	#LOCK_MAND
 32

	)

156 
	#LOCK_READ
 64

	)

157 
	#LOCK_WRITE
 128

	)

158 
	#LOCK_RW
 192

	)

160 
	#F_LINUX_SPECIFIC_BASE
 1024

	)

162 #iâdeà
HAVE_ARCH_STRUCT_FLOCK


163 #iâdeà
__ARCH_FLOCK_PAD


164 
	#__ARCH_FLOCK_PAD


	)

167 
	sæock
 {

168 
	ml_ty³
;

169 
	ml_wh’û
;

170 
__k”Ãl_off_t
 
	ml_¡¬t
;

171 
__k”Ãl_off_t
 
	ml_Ën
;

172 
__k”Ãl_pid_t
 
	ml_pid
;

173 
	m__ARCH_FLOCK_PAD


177 #iâdeà
CONFIG_64BIT


179 #iâdeà
HAVE_ARCH_STRUCT_FLOCK64


180 #iâdeà
__ARCH_FLOCK64_PAD


181 
	#__ARCH_FLOCK64_PAD


	)

184 
	sæock64
 {

185 
	ml_ty³
;

186 
	ml_wh’û
;

187 
__k”Ãl_loff_t
 
	ml_¡¬t
;

188 
__k”Ãl_loff_t
 
	ml_Ën
;

189 
__k”Ãl_pid_t
 
	ml_pid
;

190 
	m__ARCH_FLOCK64_PAD


	@/usr/include/asm-generic/ioctl.h

1 #iâdeà
_ASM_GENERIC_IOCTL_H


2 
	#_ASM_GENERIC_IOCTL_H


	)

22 
	#_IOC_NRBITS
 8

	)

23 
	#_IOC_TYPEBITS
 8

	)

30 #iâdeà
_IOC_SIZEBITS


31 
	#_IOC_SIZEBITS
 14

	)

34 #iâdeà
_IOC_DIRBITS


35 
	#_IOC_DIRBITS
 2

	)

38 
	#_IOC_NRMASK
 ((1 << 
_IOC_NRBITS
)-1)

	)

39 
	#_IOC_TYPEMASK
 ((1 << 
_IOC_TYPEBITS
)-1)

	)

40 
	#_IOC_SIZEMASK
 ((1 << 
_IOC_SIZEBITS
)-1)

	)

41 
	#_IOC_DIRMASK
 ((1 << 
_IOC_DIRBITS
)-1)

	)

43 
	#_IOC_NRSHIFT
 0

	)

44 
	#_IOC_TYPESHIFT
 (
_IOC_NRSHIFT
+
_IOC_NRBITS
)

	)

45 
	#_IOC_SIZESHIFT
 (
_IOC_TYPESHIFT
+
_IOC_TYPEBITS
)

	)

46 
	#_IOC_DIRSHIFT
 (
_IOC_SIZESHIFT
+
_IOC_SIZEBITS
)

	)

53 #iâdeà
_IOC_NONE


54 
	#_IOC_NONE
 0U

	)

57 #iâdeà
_IOC_WRITE


58 
	#_IOC_WRITE
 1U

	)

61 #iâdeà
_IOC_READ


62 
	#_IOC_READ
 2U

	)

65 
	#_IOC
(
dœ
,
ty³
,
Ä
,
size
) \

66 (((
dœ
è<< 
_IOC_DIRSHIFT
) | \

67 ((
ty³
è<< 
_IOC_TYPESHIFT
) | \

68 ((
Ä
è<< 
_IOC_NRSHIFT
) | \

69 ((
size
è<< 
_IOC_SIZESHIFT
))

	)

71 
	#_IOC_TYPECHECK
(
t
è(Ñ))

	)

74 
	#_IO
(
ty³
,
Ä
è
	`_IOC
(
_IOC_NONE
,Ñy³),Òr),0)

	)

75 
	#_IOR
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_READ
,Ñy³),Òr),(
	`_IOC_TYPECHECK
(size)))

	)

76 
	#_IOW
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_WRITE
,Ñy³),Òr),(
	`_IOC_TYPECHECK
(size)))

	)

77 
	#_IOWR
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_READ
|
_IOC_WRITE
,Ñy³),Òr),(
	`_IOC_TYPECHECK
(size)))

	)

78 
	#_IOR_BAD
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_READ
,Ñy³),Òr),(size))

	)

79 
	#_IOW_BAD
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_WRITE
,Ñy³),Òr),(size))

	)

80 
	#_IOWR_BAD
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_READ
|
_IOC_WRITE
,Ñy³),Òr),(size))

	)

83 
	#_IOC_DIR
(
Ä
è((Òrè>> 
_IOC_DIRSHIFT
è& 
_IOC_DIRMASK
)

	)

84 
	#_IOC_TYPE
(
Ä
è((Òrè>> 
_IOC_TYPESHIFT
è& 
_IOC_TYPEMASK
)

	)

85 
	#_IOC_NR
(
Ä
è((Òrè>> 
_IOC_NRSHIFT
è& 
_IOC_NRMASK
)

	)

86 
	#_IOC_SIZE
(
Ä
è((Òrè>> 
_IOC_SIZESHIFT
è& 
_IOC_SIZEMASK
)

	)

90 
	#IOC_IN
 (
_IOC_WRITE
 << 
_IOC_DIRSHIFT
)

	)

91 
	#IOC_OUT
 (
_IOC_READ
 << 
_IOC_DIRSHIFT
)

	)

92 
	#IOC_INOUT
 ((
_IOC_WRITE
|
_IOC_READ
è<< 
_IOC_DIRSHIFT
)

	)

93 
	#IOCSIZE_MASK
 (
_IOC_SIZEMASK
 << 
_IOC_SIZESHIFT
)

	)

94 
	#IOCSIZE_SHIFT
 (
_IOC_SIZESHIFT
)

	)

	@/usr/include/asm-generic/mman-common.h

1 #iâdeà
__ASM_GENERIC_MMAN_COMMON_H


2 
	#__ASM_GENERIC_MMAN_COMMON_H


	)

9 
	#PROT_READ
 0x1

	)

10 
	#PROT_WRITE
 0x2

	)

11 
	#PROT_EXEC
 0x4

	)

12 
	#PROT_SEM
 0x8

	)

13 
	#PROT_NONE
 0x0

	)

14 
	#PROT_GROWSDOWN
 0x01000000

	)

15 
	#PROT_GROWSUP
 0x02000000

	)

17 
	#MAP_SHARED
 0x01

	)

18 
	#MAP_PRIVATE
 0x02

	)

19 
	#MAP_TYPE
 0x0à

	)

20 
	#MAP_FIXED
 0x10

	)

21 
	#MAP_ANONYMOUS
 0x20

	)

22 #ifdeà
CONFIG_MMAP_ALLOW_UNINITIALIZED


23 
	#MAP_UNINITIALIZED
 0x4000000

	)

25 
	#MAP_UNINITIALIZED
 0x0

	)

28 
	#MS_ASYNC
 1

	)

29 
	#MS_INVALIDATE
 2

	)

30 
	#MS_SYNC
 4

	)

32 
	#MADV_NORMAL
 0

	)

33 
	#MADV_RANDOM
 1

	)

34 
	#MADV_SEQUENTIAL
 2

	)

35 
	#MADV_WILLNEED
 3

	)

36 
	#MADV_DONTNEED
 4

	)

39 
	#MADV_REMOVE
 9

	)

40 
	#MADV_DONTFORK
 10

	)

41 
	#MADV_DOFORK
 11

	)

42 
	#MADV_HWPOISON
 100

	)

43 
	#MADV_SOFT_OFFLINE
 101

	)

45 
	#MADV_MERGEABLE
 12

	)

46 
	#MADV_UNMERGEABLE
 13

	)

48 
	#MADV_HUGEPAGE
 14

	)

49 
	#MADV_NOHUGEPAGE
 15

	)

52 
	#MAP_FILE
 0

	)

	@/usr/include/asm-generic/shmbuf.h

1 #iâdeà
__ASM_GENERIC_SHMBUF_H


2 
	#__ASM_GENERIC_SHMBUF_H


	)

4 
	~<asm/b™¥”lÚg.h
>

25 
	sshmid64_ds
 {

26 
c64_³rm
 
	mshm_³rm
;

27 
size_t
 
	mshm_£gsz
;

28 
__k”Ãl_time_t
 
	mshm_©ime
;

29 #ià
__BITS_PER_LONG
 != 64

30 
	m__unu£d1
;

32 
__k”Ãl_time_t
 
	mshm_dtime
;

33 #ià
__BITS_PER_LONG
 != 64

34 
	m__unu£d2
;

36 
__k”Ãl_time_t
 
	mshm_ùime
;

37 #ià
__BITS_PER_LONG
 != 64

38 
	m__unu£d3
;

40 
__k”Ãl_pid_t
 
	mshm_ıid
;

41 
__k”Ãl_pid_t
 
	mshm_Íid
;

42 
	mshm_Ç‰ch
;

43 
	m__unu£d4
;

44 
	m__unu£d5
;

47 
	sshmšfo64
 {

48 
	mshmmax
;

49 
	mshmmš
;

50 
	mshmmni
;

51 
	mshm£g
;

52 
	mshm®l
;

53 
	m__unu£d1
;

54 
	m__unu£d2
;

55 
	m__unu£d3
;

56 
	m__unu£d4
;

	@/usr/include/asm-generic/signal-defs.h

1 #iâdeà
__ASM_GENERIC_SIGNAL_DEFS_H


2 
	#__ASM_GENERIC_SIGNAL_DEFS_H


	)

6 #iâdeà
SIG_BLOCK


7 
	#SIG_BLOCK
 0

	)

9 #iâdeà
SIG_UNBLOCK


10 
	#SIG_UNBLOCK
 1

	)

12 #iâdeà
SIG_SETMASK


13 
	#SIG_SETMASK
 2

	)

16 #iâdeà
__ASSEMBLY__


17 
	t__sigÇlâ_t
();

18 
__sigÇlâ_t
 *
	t__sighªdËr_t
;

20 
	t__»¡Üeâ_t
();

21 
__»¡Üeâ_t
 *
	t__sig»¡Üe_t
;

23 
	#SIG_DFL
 ((
__sighªdËr_t
)0è

	)

24 
	#SIG_IGN
 ((
__sighªdËr_t
)1è

	)

25 
	#SIG_ERR
 ((
__sighªdËr_t
)-1è

	)

	@/usr/include/asm-generic/types.h

1 #iâdeà
_ASM_GENERIC_TYPES_H


2 
	#_ASM_GENERIC_TYPES_H


	)

7 
	~<asm-g’”ic/št-Î64.h
>

9 #iâdeà
__ASSEMBLY__


11 
	tumode_t
;

	@/usr/include/asm/ipcbuf.h

1 
	~<asm-g’”ic/cbuf.h
>

	@/usr/include/asm/posix_types_32.h

1 #iâdeà
_ASM_X86_POSIX_TYPES_32_H


2 
	#_ASM_X86_POSIX_TYPES_32_H


	)

10 
	t__k”Ãl_šo_t
;

11 
	t__k”Ãl_mode_t
;

12 
	t__k”Ãl_Æšk_t
;

13 
	t__k”Ãl_off_t
;

14 
	t__k”Ãl_pid_t
;

15 
	t__k”Ãl_c_pid_t
;

16 
	t__k”Ãl_uid_t
;

17 
	t__k”Ãl_gid_t
;

18 
	t__k”Ãl_size_t
;

19 
	t__k”Ãl_ssize_t
;

20 
	t__k”Ãl_±rdiff_t
;

21 
	t__k”Ãl_time_t
;

22 
	t__k”Ãl_su£cÚds_t
;

23 
	t__k”Ãl_şock_t
;

24 
	t__k”Ãl_tim”_t
;

25 
	t__k”Ãl_şockid_t
;

26 
	t__k”Ãl_daddr_t
;

27 * 
	t__k”Ãl_ÿddr_t
;

28 
	t__k”Ãl_uid16_t
;

29 
	t__k”Ãl_gid16_t
;

30 
	t__k”Ãl_uid32_t
;

31 
	t__k”Ãl_gid32_t
;

33 
	t__k”Ãl_Şd_uid_t
;

34 
	t__k”Ãl_Şd_gid_t
;

35 
	t__k”Ãl_Şd_dev_t
;

37 #ifdeà
__GNUC__


38 
	t__k”Ãl_loff_t
;

42 
	mv®
[2];

43 } 
	t__k”Ãl_fsid_t
;

	@/usr/include/asm/posix_types_64.h

1 #iâdeà
_ASM_X86_POSIX_TYPES_64_H


2 
	#_ASM_X86_POSIX_TYPES_64_H


	)

10 
	t__k”Ãl_šo_t
;

11 
	t__k”Ãl_mode_t
;

12 
	t__k”Ãl_Æšk_t
;

13 
	t__k”Ãl_off_t
;

14 
	t__k”Ãl_pid_t
;

15 
	t__k”Ãl_c_pid_t
;

16 
	t__k”Ãl_uid_t
;

17 
	t__k”Ãl_gid_t
;

18 
	t__k”Ãl_size_t
;

19 
	t__k”Ãl_ssize_t
;

20 
	t__k”Ãl_±rdiff_t
;

21 
	t__k”Ãl_time_t
;

22 
	t__k”Ãl_su£cÚds_t
;

23 
	t__k”Ãl_şock_t
;

24 
	t__k”Ãl_tim”_t
;

25 
	t__k”Ãl_şockid_t
;

26 
	t__k”Ãl_daddr_t
;

27 * 
	t__k”Ãl_ÿddr_t
;

28 
	t__k”Ãl_uid16_t
;

29 
	t__k”Ãl_gid16_t
;

31 #ifdeà
__GNUC__


32 
	t__k”Ãl_loff_t
;

36 
	mv®
[2];

37 } 
	t__k”Ãl_fsid_t
;

39 
	t__k”Ãl_Şd_uid_t
;

40 
	t__k”Ãl_Şd_gid_t
;

41 
__k”Ãl_uid_t
 
	t__k”Ãl_uid32_t
;

42 
__k”Ãl_gid_t
 
	t__k”Ãl_gid32_t
;

44 
	t__k”Ãl_Şd_dev_t
;

	@/usr/include/asm/processor-flags.h

1 #iâdeà
_ASM_X86_PROCESSOR_FLAGS_H


2 
	#_ASM_X86_PROCESSOR_FLAGS_H


	)

8 
	#X86_EFLAGS_CF
 0x00000001

	)

9 
	#X86_EFLAGS_PF
 0x00000004

	)

10 
	#X86_EFLAGS_AF
 0x00000010

	)

11 
	#X86_EFLAGS_ZF
 0x00000040

	)

12 
	#X86_EFLAGS_SF
 0x00000080

	)

13 
	#X86_EFLAGS_TF
 0x00000100

	)

14 
	#X86_EFLAGS_IF
 0x00000200

	)

15 
	#X86_EFLAGS_DF
 0x00000400

	)

16 
	#X86_EFLAGS_OF
 0x00000800

	)

17 
	#X86_EFLAGS_IOPL
 0x00003000

	)

18 
	#X86_EFLAGS_NT
 0x00004000

	)

19 
	#X86_EFLAGS_RF
 0x00010000

	)

20 
	#X86_EFLAGS_VM
 0x00020000

	)

21 
	#X86_EFLAGS_AC
 0x00040000

	)

22 
	#X86_EFLAGS_VIF
 0x00080000

	)

23 
	#X86_EFLAGS_VIP
 0x00100000

	)

24 
	#X86_EFLAGS_ID
 0x00200000

	)

29 
	#X86_CR0_PE
 0x00000001

	)

30 
	#X86_CR0_MP
 0x00000002

	)

31 
	#X86_CR0_EM
 0x00000004

	)

32 
	#X86_CR0_TS
 0x00000008

	)

33 
	#X86_CR0_ET
 0x00000010

	)

34 
	#X86_CR0_NE
 0x00000020

	)

35 
	#X86_CR0_WP
 0x00010000

	)

36 
	#X86_CR0_AM
 0x00040000

	)

37 
	#X86_CR0_NW
 0x20000000

	)

38 
	#X86_CR0_CD
 0x40000000

	)

39 
	#X86_CR0_PG
 0x80000000

	)

44 
	#X86_CR3_PWT
 0x00000008

	)

45 
	#X86_CR3_PCD
 0x00000010

	)

50 
	#X86_CR4_VME
 0x00000001

	)

51 
	#X86_CR4_PVI
 0x00000002

	)

52 
	#X86_CR4_TSD
 0x00000004

	)

53 
	#X86_CR4_DE
 0x00000008

	)

54 
	#X86_CR4_PSE
 0x00000010

	)

55 
	#X86_CR4_PAE
 0x00000020

	)

56 
	#X86_CR4_MCE
 0x00000040

	)

57 
	#X86_CR4_PGE
 0x00000080

	)

58 
	#X86_CR4_PCE
 0x00000100

	)

59 
	#X86_CR4_OSFXSR
 0x00000200

	)

60 
	#X86_CR4_OSXMMEXCPT
 0x00000400

	)

61 
	#X86_CR4_VMXE
 0x00002000

	)

62 
	#X86_CR4_RDWRGSFS
 0x00010000

	)

63 
	#X86_CR4_OSXSAVE
 0x00040000

	)

64 
	#X86_CR4_SMEP
 0x00100000

	)

69 
	#X86_CR8_TPR
 0x0000000F

	)

78 
	#CX86_PCR0
 0x20

	)

79 
	#CX86_GCR
 0xb8

	)

80 
	#CX86_CCR0
 0xc0

	)

81 
	#CX86_CCR1
 0xc1

	)

82 
	#CX86_CCR2
 0xc2

	)

83 
	#CX86_CCR3
 0xc3

	)

84 
	#CX86_CCR4
 0xe8

	)

85 
	#CX86_CCR5
 0xe9

	)

86 
	#CX86_CCR6
 0x—

	)

87 
	#CX86_CCR7
 0xeb

	)

88 
	#CX86_PCR1
 0xf0

	)

89 
	#CX86_DIR0
 0xã

	)

90 
	#CX86_DIR1
 0xff

	)

91 
	#CX86_ARR_BASE
 0xc4

	)

92 
	#CX86_RCR_BASE
 0xdc

	)

	@/usr/include/asm/ptrace-abi.h

1 #iâdeà
_ASM_X86_PTRACE_ABI_H


2 
	#_ASM_X86_PTRACE_ABI_H


	)

4 #ifdeà
__i386__


6 
	#EBX
 0

	)

7 
	#ECX
 1

	)

8 
	#EDX
 2

	)

9 
	#ESI
 3

	)

10 
	#EDI
 4

	)

11 
	#EBP
 5

	)

12 
	#EAX
 6

	)

13 
	#DS
 7

	)

14 
	#ES
 8

	)

15 
	#FS
 9

	)

16 
	#GS
 10

	)

17 
	#ORIG_EAX
 11

	)

18 
	#EIP
 12

	)

19 
	#CS
 13

	)

20 
	#EFL
 14

	)

21 
	#UESP
 15

	)

22 
	#SS
 16

	)

23 
	#FRAME_SIZE
 17

	)

27 #ià
defšed
(
__ASSEMBLY__
è|| defšed(
__FRAME_OFFSETS
)

28 
	#R15
 0

	)

29 
	#R14
 8

	)

30 
	#R13
 16

	)

31 
	#R12
 24

	)

32 
	#RBP
 32

	)

33 
	#RBX
 40

	)

35 
	#R11
 48

	)

36 
	#R10
 56

	)

37 
	#R9
 64

	)

38 
	#R8
 72

	)

39 
	#RAX
 80

	)

40 
	#RCX
 88

	)

41 
	#RDX
 96

	)

42 
	#RSI
 104

	)

43 
	#RDI
 112

	)

44 
	#ORIG_RAX
 120

	)

47 
	#RIP
 128

	)

48 
	#CS
 136

	)

49 
	#EFLAGS
 144

	)

50 
	#RSP
 152

	)

51 
	#SS
 160

	)

52 
	#ARGOFFSET
 
R11


	)

56 
	#FRAME_SIZE
 168

	)

61 
	#PTRACE_GETREGS
 12

	)

62 
	#PTRACE_SETREGS
 13

	)

63 
	#PTRACE_GETFPREGS
 14

	)

64 
	#PTRACE_SETFPREGS
 15

	)

65 
	#PTRACE_GETFPXREGS
 18

	)

66 
	#PTRACE_SETFPXREGS
 19

	)

68 
	#PTRACE_OLDSETOPTIONS
 21

	)

71 
	#PTRACE_GET_THREAD_AREA
 25

	)

72 
	#PTRACE_SET_THREAD_AREA
 26

	)

74 #ifdeà
__x86_64__


75 
	#PTRACE_ARCH_PRCTL
 30

	)

78 
	#PTRACE_SYSEMU
 31

	)

79 
	#PTRACE_SYSEMU_SINGLESTEP
 32

	)

81 
	#PTRACE_SINGLEBLOCK
 33

	)

83 #iâdeà
__ASSEMBLY__


84 
	~<lšux/ty³s.h
>

	@/usr/include/asm/sockios.h

1 
	~<asm-g’”ic/sockios.h
>

	@/usr/include/bits/byteswap.h

21 #ià!
defšed
 
_BYTESWAP_H
 && !defšed 
_NETINET_IN_H
 && !defšed 
_ENDIAN_H


25 #iâdeà
_BITS_BYTESWAP_H


26 
	#_BITS_BYTESWAP_H
 1

	)

28 
	~<b™s/wÜdsize.h
>

31 
	#__bsw­_cÚ¡ªt_16
(
x
) \

32 ((è((((
x
è>> 8è& 0xffè| (((xè& 0xffè<< 8)))

	)

34 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

35 
	#__bsw­_16
(
x
) \

36 (
__ex‹nsiÚ__
 \

37 ({ 
__v
, 
__x
 = (è(
x
); \

38 ià(
	`__butš_cÚ¡ªt_p
 (
__x
)) \

39 
__v
 = 
	`__bsw­_cÚ¡ªt_16
 (
__x
); \

41 
	`__asm__
 ("rorw $8, %w0" \

42 : "ô" (
__v
) \

43 : "0" (
__x
) \

45 
__v
; }))

	)

48 
	#__bsw­_16
(
x
) \

49 (
__ex‹nsiÚ__
 \

50 ({ 
__x
 = (è(
x
); \

51 
	`__bsw­_cÚ¡ªt_16
 (
__x
); }))

	)

56 
	#__bsw­_cÚ¡ªt_32
(
x
) \

57 ((((
x
) & 0xff000000) >> 24) | (((x) & 0x00ff0000) >> 8) | \

58 (((
x
è& 0x0000ff00è<< 8è| (((xè& 0x000000ffè<< 24))

	)

60 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

61 #ià
__WORDSIZE
 =ğ64 || (
defšed
 
__i486__
 || defšed 
__³Áium__
 \

62 || 
defšed
 
	g__³Áium´o__
 || defšed 
	g__³Áium4__
 \

63 || 
defšed
 
	g__k8__
 || defšed 
	g__©hlÚ__
 \

64 || 
defšed
 
	g__k6__
 || defšed 
	g__nocÚa__
 \

65 || 
defšed
 
	g__cÜe2__
 || defšed 
	g__geode__
 \

66 || 
defšed
 
	g__amdçm10__
)

69 
	#__bsw­_32
(
x
) \

70 (
__ex‹nsiÚ__
 \

71 ({ 
__v
, 
__x
 = (
x
); \

72 ià(
	`__butš_cÚ¡ªt_p
 (
__x
)) \

73 
__v
 = 
	`__bsw­_cÚ¡ªt_32
 (
__x
); \

75 
	`__asm__
 ("bsw­ %0" : "ô" (
__v
è: "0" (
__x
)); \

76 
__v
; }))

	)

78 
	#__bsw­_32
(
x
) \

79 (
__ex‹nsiÚ__
 \

80 ({ 
__v
, 
__x
 = (
x
); \

81 ià(
	`__butš_cÚ¡ªt_p
 (
__x
)) \

82 
__v
 = 
	`__bsw­_cÚ¡ªt_32
 (
__x
); \

84 
	`__asm__
 ("rorw $8, %w0;" \

87 : "ô" (
__v
) \

88 : "0" (
__x
) \

90 
__v
; }))

	)

93 
	#__bsw­_32
(
x
) \

94 (
__ex‹nsiÚ__
 \

95 ({ 
__x
 = (
x
); 
	`__bsw­_cÚ¡ªt_32
 (__x); }))

	)

99 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

101 
	#__bsw­_cÚ¡ªt_64
(
x
) \

102 (
	`__ex‹nsiÚ__
 ((((
x
) & 0xff00000000000000ull) >> 56) \

103 | (((
x
) & 0x00ff000000000000ull) >> 40) \

104 | (((
x
) & 0x0000ff0000000000ull) >> 24) \

105 | (((
x
) & 0x000000ff00000000ull) >> 8) \

106 | (((
x
) & 0x00000000ff000000ull) << 8) \

107 | (((
x
) & 0x0000000000ff0000ull) << 24) \

108 | (((
x
) & 0x000000000000ff00ull) << 40) \

109 | (((
x
è& 0x00000000000000ffuÎè<< 56)))

	)

111 #ià
__WORDSIZE
 == 64

112 
	#__bsw­_64
(
x
) \

113 (
__ex‹nsiÚ__
 \

114 ({ 
__v
, 
__x
 = (
x
); \

115 ià(
	`__butš_cÚ¡ªt_p
 (
__x
)) \

116 
__v
 = 
	`__bsw­_cÚ¡ªt_64
 (
__x
); \

118 
	`__asm__
 ("bsw­ %q0" : "ô" (
__v
è: "0" (
__x
)); \

119 
__v
; }))

	)

121 
	#__bsw­_64
(
x
) \

122 (
__ex‹nsiÚ__
 \

123 ({ uniÚ { 
__ex‹nsiÚ__
 
__Î
; \

124 
__l
[2]; } 
__w
, 
__r
; \

125 ià(
	`__butš_cÚ¡ªt_p
 (
x
)) \

126 
__r
.
__Î
 = 
	`__bsw­_cÚ¡ªt_64
 (
x
); \

129 
__w
.
__Î
 = (
x
); \

130 
__r
.
__l
[0] = 
	`__bsw­_32
 (
__w
.__l[1]); \

131 
__r
.
__l
[1] = 
	`__bsw­_32
 (
__w
.__l[0]); \

133 
__r
.
__Î
; }))

	)

	@/usr/include/bits/confname.h

21 #iâdeà
_UNISTD_H


28 
	m_PC_LINK_MAX
,

29 
	#_PC_LINK_MAX
 
_PC_LINK_MAX


	)

30 
	m_PC_MAX_CANON
,

31 
	#_PC_MAX_CANON
 
_PC_MAX_CANON


	)

32 
	m_PC_MAX_INPUT
,

33 
	#_PC_MAX_INPUT
 
_PC_MAX_INPUT


	)

34 
	m_PC_NAME_MAX
,

35 
	#_PC_NAME_MAX
 
_PC_NAME_MAX


	)

36 
	m_PC_PATH_MAX
,

37 
	#_PC_PATH_MAX
 
_PC_PATH_MAX


	)

38 
	m_PC_PIPE_BUF
,

39 
	#_PC_PIPE_BUF
 
_PC_PIPE_BUF


	)

40 
	m_PC_CHOWN_RESTRICTED
,

41 
	#_PC_CHOWN_RESTRICTED
 
_PC_CHOWN_RESTRICTED


	)

42 
	m_PC_NO_TRUNC
,

43 
	#_PC_NO_TRUNC
 
_PC_NO_TRUNC


	)

44 
	m_PC_VDISABLE
,

45 
	#_PC_VDISABLE
 
_PC_VDISABLE


	)

46 
	m_PC_SYNC_IO
,

47 
	#_PC_SYNC_IO
 
_PC_SYNC_IO


	)

48 
	m_PC_ASYNC_IO
,

49 
	#_PC_ASYNC_IO
 
_PC_ASYNC_IO


	)

50 
	m_PC_PRIO_IO
,

51 
	#_PC_PRIO_IO
 
_PC_PRIO_IO


	)

52 
	m_PC_SOCK_MAXBUF
,

53 
	#_PC_SOCK_MAXBUF
 
_PC_SOCK_MAXBUF


	)

54 
	m_PC_FILESIZEBITS
,

55 
	#_PC_FILESIZEBITS
 
_PC_FILESIZEBITS


	)

56 
	m_PC_REC_INCR_XFER_SIZE
,

57 
	#_PC_REC_INCR_XFER_SIZE
 
_PC_REC_INCR_XFER_SIZE


	)

58 
	m_PC_REC_MAX_XFER_SIZE
,

59 
	#_PC_REC_MAX_XFER_SIZE
 
_PC_REC_MAX_XFER_SIZE


	)

60 
	m_PC_REC_MIN_XFER_SIZE
,

61 
	#_PC_REC_MIN_XFER_SIZE
 
_PC_REC_MIN_XFER_SIZE


	)

62 
	m_PC_REC_XFER_ALIGN
,

63 
	#_PC_REC_XFER_ALIGN
 
_PC_REC_XFER_ALIGN


	)

64 
	m_PC_ALLOC_SIZE_MIN
,

65 
	#_PC_ALLOC_SIZE_MIN
 
_PC_ALLOC_SIZE_MIN


	)

66 
	m_PC_SYMLINK_MAX
,

67 
	#_PC_SYMLINK_MAX
 
_PC_SYMLINK_MAX


	)

68 
	m_PC_2_SYMLINKS


69 
	#_PC_2_SYMLINKS
 
_PC_2_SYMLINKS


	)

75 
	m_SC_ARG_MAX
,

76 
	#_SC_ARG_MAX
 
_SC_ARG_MAX


	)

77 
	m_SC_CHILD_MAX
,

78 
	#_SC_CHILD_MAX
 
_SC_CHILD_MAX


	)

79 
	m_SC_CLK_TCK
,

80 
	#_SC_CLK_TCK
 
_SC_CLK_TCK


	)

81 
	m_SC_NGROUPS_MAX
,

82 
	#_SC_NGROUPS_MAX
 
_SC_NGROUPS_MAX


	)

83 
	m_SC_OPEN_MAX
,

84 
	#_SC_OPEN_MAX
 
_SC_OPEN_MAX


	)

85 
	m_SC_STREAM_MAX
,

86 
	#_SC_STREAM_MAX
 
_SC_STREAM_MAX


	)

87 
	m_SC_TZNAME_MAX
,

88 
	#_SC_TZNAME_MAX
 
_SC_TZNAME_MAX


	)

89 
	m_SC_JOB_CONTROL
,

90 
	#_SC_JOB_CONTROL
 
_SC_JOB_CONTROL


	)

91 
	m_SC_SAVED_IDS
,

92 
	#_SC_SAVED_IDS
 
_SC_SAVED_IDS


	)

93 
	m_SC_REALTIME_SIGNALS
,

94 
	#_SC_REALTIME_SIGNALS
 
_SC_REALTIME_SIGNALS


	)

95 
	m_SC_PRIORITY_SCHEDULING
,

96 
	#_SC_PRIORITY_SCHEDULING
 
_SC_PRIORITY_SCHEDULING


	)

97 
	m_SC_TIMERS
,

98 
	#_SC_TIMERS
 
_SC_TIMERS


	)

99 
	m_SC_ASYNCHRONOUS_IO
,

100 
	#_SC_ASYNCHRONOUS_IO
 
_SC_ASYNCHRONOUS_IO


	)

101 
	m_SC_PRIORITIZED_IO
,

102 
	#_SC_PRIORITIZED_IO
 
_SC_PRIORITIZED_IO


	)

103 
	m_SC_SYNCHRONIZED_IO
,

104 
	#_SC_SYNCHRONIZED_IO
 
_SC_SYNCHRONIZED_IO


	)

105 
	m_SC_FSYNC
,

106 
	#_SC_FSYNC
 
_SC_FSYNC


	)

107 
	m_SC_MAPPED_FILES
,

108 
	#_SC_MAPPED_FILES
 
_SC_MAPPED_FILES


	)

109 
	m_SC_MEMLOCK
,

110 
	#_SC_MEMLOCK
 
_SC_MEMLOCK


	)

111 
	m_SC_MEMLOCK_RANGE
,

112 
	#_SC_MEMLOCK_RANGE
 
_SC_MEMLOCK_RANGE


	)

113 
	m_SC_MEMORY_PROTECTION
,

114 
	#_SC_MEMORY_PROTECTION
 
_SC_MEMORY_PROTECTION


	)

115 
	m_SC_MESSAGE_PASSING
,

116 
	#_SC_MESSAGE_PASSING
 
_SC_MESSAGE_PASSING


	)

117 
	m_SC_SEMAPHORES
,

118 
	#_SC_SEMAPHORES
 
_SC_SEMAPHORES


	)

119 
	m_SC_SHARED_MEMORY_OBJECTS
,

120 
	#_SC_SHARED_MEMORY_OBJECTS
 
_SC_SHARED_MEMORY_OBJECTS


	)

121 
	m_SC_AIO_LISTIO_MAX
,

122 
	#_SC_AIO_LISTIO_MAX
 
_SC_AIO_LISTIO_MAX


	)

123 
	m_SC_AIO_MAX
,

124 
	#_SC_AIO_MAX
 
_SC_AIO_MAX


	)

125 
	m_SC_AIO_PRIO_DELTA_MAX
,

126 
	#_SC_AIO_PRIO_DELTA_MAX
 
_SC_AIO_PRIO_DELTA_MAX


	)

127 
	m_SC_DELAYTIMER_MAX
,

128 
	#_SC_DELAYTIMER_MAX
 
_SC_DELAYTIMER_MAX


	)

129 
	m_SC_MQ_OPEN_MAX
,

130 
	#_SC_MQ_OPEN_MAX
 
_SC_MQ_OPEN_MAX


	)

131 
	m_SC_MQ_PRIO_MAX
,

132 
	#_SC_MQ_PRIO_MAX
 
_SC_MQ_PRIO_MAX


	)

133 
	m_SC_VERSION
,

134 
	#_SC_VERSION
 
_SC_VERSION


	)

135 
	m_SC_PAGESIZE
,

136 
	#_SC_PAGESIZE
 
_SC_PAGESIZE


	)

137 
	#_SC_PAGE_SIZE
 
_SC_PAGESIZE


	)

138 
	m_SC_RTSIG_MAX
,

139 
	#_SC_RTSIG_MAX
 
_SC_RTSIG_MAX


	)

140 
	m_SC_SEM_NSEMS_MAX
,

141 
	#_SC_SEM_NSEMS_MAX
 
_SC_SEM_NSEMS_MAX


	)

142 
	m_SC_SEM_VALUE_MAX
,

143 
	#_SC_SEM_VALUE_MAX
 
_SC_SEM_VALUE_MAX


	)

144 
	m_SC_SIGQUEUE_MAX
,

145 
	#_SC_SIGQUEUE_MAX
 
_SC_SIGQUEUE_MAX


	)

146 
	m_SC_TIMER_MAX
,

147 
	#_SC_TIMER_MAX
 
_SC_TIMER_MAX


	)

151 
	m_SC_BC_BASE_MAX
,

152 
	#_SC_BC_BASE_MAX
 
_SC_BC_BASE_MAX


	)

153 
	m_SC_BC_DIM_MAX
,

154 
	#_SC_BC_DIM_MAX
 
_SC_BC_DIM_MAX


	)

155 
	m_SC_BC_SCALE_MAX
,

156 
	#_SC_BC_SCALE_MAX
 
_SC_BC_SCALE_MAX


	)

157 
	m_SC_BC_STRING_MAX
,

158 
	#_SC_BC_STRING_MAX
 
_SC_BC_STRING_MAX


	)

159 
	m_SC_COLL_WEIGHTS_MAX
,

160 
	#_SC_COLL_WEIGHTS_MAX
 
_SC_COLL_WEIGHTS_MAX


	)

161 
	m_SC_EQUIV_CLASS_MAX
,

162 
	#_SC_EQUIV_CLASS_MAX
 
_SC_EQUIV_CLASS_MAX


	)

163 
	m_SC_EXPR_NEST_MAX
,

164 
	#_SC_EXPR_NEST_MAX
 
_SC_EXPR_NEST_MAX


	)

165 
	m_SC_LINE_MAX
,

166 
	#_SC_LINE_MAX
 
_SC_LINE_MAX


	)

167 
	m_SC_RE_DUP_MAX
,

168 
	#_SC_RE_DUP_MAX
 
_SC_RE_DUP_MAX


	)

169 
	m_SC_CHARCLASS_NAME_MAX
,

170 
	#_SC_CHARCLASS_NAME_MAX
 
_SC_CHARCLASS_NAME_MAX


	)

172 
	m_SC_2_VERSION
,

173 
	#_SC_2_VERSION
 
_SC_2_VERSION


	)

174 
	m_SC_2_C_BIND
,

175 
	#_SC_2_C_BIND
 
_SC_2_C_BIND


	)

176 
	m_SC_2_C_DEV
,

177 
	#_SC_2_C_DEV
 
_SC_2_C_DEV


	)

178 
	m_SC_2_FORT_DEV
,

179 
	#_SC_2_FORT_DEV
 
_SC_2_FORT_DEV


	)

180 
	m_SC_2_FORT_RUN
,

181 
	#_SC_2_FORT_RUN
 
_SC_2_FORT_RUN


	)

182 
	m_SC_2_SW_DEV
,

183 
	#_SC_2_SW_DEV
 
_SC_2_SW_DEV


	)

184 
	m_SC_2_LOCALEDEF
,

185 
	#_SC_2_LOCALEDEF
 
_SC_2_LOCALEDEF


	)

187 
	m_SC_PII
,

188 
	#_SC_PII
 
_SC_PII


	)

189 
	m_SC_PII_XTI
,

190 
	#_SC_PII_XTI
 
_SC_PII_XTI


	)

191 
	m_SC_PII_SOCKET
,

192 
	#_SC_PII_SOCKET
 
_SC_PII_SOCKET


	)

193 
	m_SC_PII_INTERNET
,

194 
	#_SC_PII_INTERNET
 
_SC_PII_INTERNET


	)

195 
	m_SC_PII_OSI
,

196 
	#_SC_PII_OSI
 
_SC_PII_OSI


	)

197 
	m_SC_POLL
,

198 
	#_SC_POLL
 
_SC_POLL


	)

199 
	m_SC_SELECT
,

200 
	#_SC_SELECT
 
_SC_SELECT


	)

201 
	m_SC_UIO_MAXIOV
,

202 
	#_SC_UIO_MAXIOV
 
_SC_UIO_MAXIOV


	)

203 
	m_SC_IOV_MAX
 = 
_SC_UIO_MAXIOV
,

204 
	#_SC_IOV_MAX
 
_SC_IOV_MAX


	)

205 
	m_SC_PII_INTERNET_STREAM
,

206 
	#_SC_PII_INTERNET_STREAM
 
_SC_PII_INTERNET_STREAM


	)

207 
	m_SC_PII_INTERNET_DGRAM
,

208 
	#_SC_PII_INTERNET_DGRAM
 
_SC_PII_INTERNET_DGRAM


	)

209 
	m_SC_PII_OSI_COTS
,

210 
	#_SC_PII_OSI_COTS
 
_SC_PII_OSI_COTS


	)

211 
	m_SC_PII_OSI_CLTS
,

212 
	#_SC_PII_OSI_CLTS
 
_SC_PII_OSI_CLTS


	)

213 
	m_SC_PII_OSI_M
,

214 
	#_SC_PII_OSI_M
 
_SC_PII_OSI_M


	)

215 
	m_SC_T_IOV_MAX
,

216 
	#_SC_T_IOV_MAX
 
_SC_T_IOV_MAX


	)

219 
	m_SC_THREADS
,

220 
	#_SC_THREADS
 
_SC_THREADS


	)

221 
	m_SC_THREAD_SAFE_FUNCTIONS
,

222 
	#_SC_THREAD_SAFE_FUNCTIONS
 
_SC_THREAD_SAFE_FUNCTIONS


	)

223 
	m_SC_GETGR_R_SIZE_MAX
,

224 
	#_SC_GETGR_R_SIZE_MAX
 
_SC_GETGR_R_SIZE_MAX


	)

225 
	m_SC_GETPW_R_SIZE_MAX
,

226 
	#_SC_GETPW_R_SIZE_MAX
 
_SC_GETPW_R_SIZE_MAX


	)

227 
	m_SC_LOGIN_NAME_MAX
,

228 
	#_SC_LOGIN_NAME_MAX
 
_SC_LOGIN_NAME_MAX


	)

229 
	m_SC_TTY_NAME_MAX
,

230 
	#_SC_TTY_NAME_MAX
 
_SC_TTY_NAME_MAX


	)

231 
	m_SC_THREAD_DESTRUCTOR_ITERATIONS
,

232 
	#_SC_THREAD_DESTRUCTOR_ITERATIONS
 
_SC_THREAD_DESTRUCTOR_ITERATIONS


	)

233 
	m_SC_THREAD_KEYS_MAX
,

234 
	#_SC_THREAD_KEYS_MAX
 
_SC_THREAD_KEYS_MAX


	)

235 
	m_SC_THREAD_STACK_MIN
,

236 
	#_SC_THREAD_STACK_MIN
 
_SC_THREAD_STACK_MIN


	)

237 
	m_SC_THREAD_THREADS_MAX
,

238 
	#_SC_THREAD_THREADS_MAX
 
_SC_THREAD_THREADS_MAX


	)

239 
	m_SC_THREAD_ATTR_STACKADDR
,

240 
	#_SC_THREAD_ATTR_STACKADDR
 
_SC_THREAD_ATTR_STACKADDR


	)

241 
	m_SC_THREAD_ATTR_STACKSIZE
,

242 
	#_SC_THREAD_ATTR_STACKSIZE
 
_SC_THREAD_ATTR_STACKSIZE


	)

243 
	m_SC_THREAD_PRIORITY_SCHEDULING
,

244 
	#_SC_THREAD_PRIORITY_SCHEDULING
 
_SC_THREAD_PRIORITY_SCHEDULING


	)

245 
	m_SC_THREAD_PRIO_INHERIT
,

246 
	#_SC_THREAD_PRIO_INHERIT
 
_SC_THREAD_PRIO_INHERIT


	)

247 
	m_SC_THREAD_PRIO_PROTECT
,

248 
	#_SC_THREAD_PRIO_PROTECT
 
_SC_THREAD_PRIO_PROTECT


	)

249 
	m_SC_THREAD_PROCESS_SHARED
,

250 
	#_SC_THREAD_PROCESS_SHARED
 
_SC_THREAD_PROCESS_SHARED


	)

252 
	m_SC_NPROCESSORS_CONF
,

253 
	#_SC_NPROCESSORS_CONF
 
_SC_NPROCESSORS_CONF


	)

254 
	m_SC_NPROCESSORS_ONLN
,

255 
	#_SC_NPROCESSORS_ONLN
 
_SC_NPROCESSORS_ONLN


	)

256 
	m_SC_PHYS_PAGES
,

257 
	#_SC_PHYS_PAGES
 
_SC_PHYS_PAGES


	)

258 
	m_SC_AVPHYS_PAGES
,

259 
	#_SC_AVPHYS_PAGES
 
_SC_AVPHYS_PAGES


	)

260 
	m_SC_ATEXIT_MAX
,

261 
	#_SC_ATEXIT_MAX
 
_SC_ATEXIT_MAX


	)

262 
	m_SC_PASS_MAX
,

263 
	#_SC_PASS_MAX
 
_SC_PASS_MAX


	)

265 
	m_SC_XOPEN_VERSION
,

266 
	#_SC_XOPEN_VERSION
 
_SC_XOPEN_VERSION


	)

267 
	m_SC_XOPEN_XCU_VERSION
,

268 
	#_SC_XOPEN_XCU_VERSION
 
_SC_XOPEN_XCU_VERSION


	)

269 
	m_SC_XOPEN_UNIX
,

270 
	#_SC_XOPEN_UNIX
 
_SC_XOPEN_UNIX


	)

271 
	m_SC_XOPEN_CRYPT
,

272 
	#_SC_XOPEN_CRYPT
 
_SC_XOPEN_CRYPT


	)

273 
	m_SC_XOPEN_ENH_I18N
,

274 
	#_SC_XOPEN_ENH_I18N
 
_SC_XOPEN_ENH_I18N


	)

275 
	m_SC_XOPEN_SHM
,

276 
	#_SC_XOPEN_SHM
 
_SC_XOPEN_SHM


	)

278 
	m_SC_2_CHAR_TERM
,

279 
	#_SC_2_CHAR_TERM
 
_SC_2_CHAR_TERM


	)

280 
	m_SC_2_C_VERSION
,

281 
	#_SC_2_C_VERSION
 
_SC_2_C_VERSION


	)

282 
	m_SC_2_UPE
,

283 
	#_SC_2_UPE
 
_SC_2_UPE


	)

285 
	m_SC_XOPEN_XPG2
,

286 
	#_SC_XOPEN_XPG2
 
_SC_XOPEN_XPG2


	)

287 
	m_SC_XOPEN_XPG3
,

288 
	#_SC_XOPEN_XPG3
 
_SC_XOPEN_XPG3


	)

289 
	m_SC_XOPEN_XPG4
,

290 
	#_SC_XOPEN_XPG4
 
_SC_XOPEN_XPG4


	)

292 
	m_SC_CHAR_BIT
,

293 
	#_SC_CHAR_BIT
 
_SC_CHAR_BIT


	)

294 
	m_SC_CHAR_MAX
,

295 
	#_SC_CHAR_MAX
 
_SC_CHAR_MAX


	)

296 
	m_SC_CHAR_MIN
,

297 
	#_SC_CHAR_MIN
 
_SC_CHAR_MIN


	)

298 
	m_SC_INT_MAX
,

299 
	#_SC_INT_MAX
 
_SC_INT_MAX


	)

300 
	m_SC_INT_MIN
,

301 
	#_SC_INT_MIN
 
_SC_INT_MIN


	)

302 
	m_SC_LONG_BIT
,

303 
	#_SC_LONG_BIT
 
_SC_LONG_BIT


	)

304 
	m_SC_WORD_BIT
,

305 
	#_SC_WORD_BIT
 
_SC_WORD_BIT


	)

306 
	m_SC_MB_LEN_MAX
,

307 
	#_SC_MB_LEN_MAX
 
_SC_MB_LEN_MAX


	)

308 
	m_SC_NZERO
,

309 
	#_SC_NZERO
 
_SC_NZERO


	)

310 
	m_SC_SSIZE_MAX
,

311 
	#_SC_SSIZE_MAX
 
_SC_SSIZE_MAX


	)

312 
	m_SC_SCHAR_MAX
,

313 
	#_SC_SCHAR_MAX
 
_SC_SCHAR_MAX


	)

314 
	m_SC_SCHAR_MIN
,

315 
	#_SC_SCHAR_MIN
 
_SC_SCHAR_MIN


	)

316 
	m_SC_SHRT_MAX
,

317 
	#_SC_SHRT_MAX
 
_SC_SHRT_MAX


	)

318 
	m_SC_SHRT_MIN
,

319 
	#_SC_SHRT_MIN
 
_SC_SHRT_MIN


	)

320 
	m_SC_UCHAR_MAX
,

321 
	#_SC_UCHAR_MAX
 
_SC_UCHAR_MAX


	)

322 
	m_SC_UINT_MAX
,

323 
	#_SC_UINT_MAX
 
_SC_UINT_MAX


	)

324 
	m_SC_ULONG_MAX
,

325 
	#_SC_ULONG_MAX
 
_SC_ULONG_MAX


	)

326 
	m_SC_USHRT_MAX
,

327 
	#_SC_USHRT_MAX
 
_SC_USHRT_MAX


	)

329 
	m_SC_NL_ARGMAX
,

330 
	#_SC_NL_ARGMAX
 
_SC_NL_ARGMAX


	)

331 
	m_SC_NL_LANGMAX
,

332 
	#_SC_NL_LANGMAX
 
_SC_NL_LANGMAX


	)

333 
	m_SC_NL_MSGMAX
,

334 
	#_SC_NL_MSGMAX
 
_SC_NL_MSGMAX


	)

335 
	m_SC_NL_NMAX
,

336 
	#_SC_NL_NMAX
 
_SC_NL_NMAX


	)

337 
	m_SC_NL_SETMAX
,

338 
	#_SC_NL_SETMAX
 
_SC_NL_SETMAX


	)

339 
	m_SC_NL_TEXTMAX
,

340 
	#_SC_NL_TEXTMAX
 
_SC_NL_TEXTMAX


	)

342 
	m_SC_XBS5_ILP32_OFF32
,

343 
	#_SC_XBS5_ILP32_OFF32
 
_SC_XBS5_ILP32_OFF32


	)

344 
	m_SC_XBS5_ILP32_OFFBIG
,

345 
	#_SC_XBS5_ILP32_OFFBIG
 
_SC_XBS5_ILP32_OFFBIG


	)

346 
	m_SC_XBS5_LP64_OFF64
,

347 
	#_SC_XBS5_LP64_OFF64
 
_SC_XBS5_LP64_OFF64


	)

348 
	m_SC_XBS5_LPBIG_OFFBIG
,

349 
	#_SC_XBS5_LPBIG_OFFBIG
 
_SC_XBS5_LPBIG_OFFBIG


	)

351 
	m_SC_XOPEN_LEGACY
,

352 
	#_SC_XOPEN_LEGACY
 
_SC_XOPEN_LEGACY


	)

353 
	m_SC_XOPEN_REALTIME
,

354 
	#_SC_XOPEN_REALTIME
 
_SC_XOPEN_REALTIME


	)

355 
	m_SC_XOPEN_REALTIME_THREADS
,

356 
	#_SC_XOPEN_REALTIME_THREADS
 
_SC_XOPEN_REALTIME_THREADS


	)

358 
	m_SC_ADVISORY_INFO
,

359 
	#_SC_ADVISORY_INFO
 
_SC_ADVISORY_INFO


	)

360 
	m_SC_BARRIERS
,

361 
	#_SC_BARRIERS
 
_SC_BARRIERS


	)

362 
	m_SC_BASE
,

363 
	#_SC_BASE
 
_SC_BASE


	)

364 
	m_SC_C_LANG_SUPPORT
,

365 
	#_SC_C_LANG_SUPPORT
 
_SC_C_LANG_SUPPORT


	)

366 
	m_SC_C_LANG_SUPPORT_R
,

367 
	#_SC_C_LANG_SUPPORT_R
 
_SC_C_LANG_SUPPORT_R


	)

368 
	m_SC_CLOCK_SELECTION
,

369 
	#_SC_CLOCK_SELECTION
 
_SC_CLOCK_SELECTION


	)

370 
	m_SC_CPUTIME
,

371 
	#_SC_CPUTIME
 
_SC_CPUTIME


	)

372 
	m_SC_THREAD_CPUTIME
,

373 
	#_SC_THREAD_CPUTIME
 
_SC_THREAD_CPUTIME


	)

374 
	m_SC_DEVICE_IO
,

375 
	#_SC_DEVICE_IO
 
_SC_DEVICE_IO


	)

376 
	m_SC_DEVICE_SPECIFIC
,

377 
	#_SC_DEVICE_SPECIFIC
 
_SC_DEVICE_SPECIFIC


	)

378 
	m_SC_DEVICE_SPECIFIC_R
,

379 
	#_SC_DEVICE_SPECIFIC_R
 
_SC_DEVICE_SPECIFIC_R


	)

380 
	m_SC_FD_MGMT
,

381 
	#_SC_FD_MGMT
 
_SC_FD_MGMT


	)

382 
	m_SC_FIFO
,

383 
	#_SC_FIFO
 
_SC_FIFO


	)

384 
	m_SC_PIPE
,

385 
	#_SC_PIPE
 
_SC_PIPE


	)

386 
	m_SC_FILE_ATTRIBUTES
,

387 
	#_SC_FILE_ATTRIBUTES
 
_SC_FILE_ATTRIBUTES


	)

388 
	m_SC_FILE_LOCKING
,

389 
	#_SC_FILE_LOCKING
 
_SC_FILE_LOCKING


	)

390 
	m_SC_FILE_SYSTEM
,

391 
	#_SC_FILE_SYSTEM
 
_SC_FILE_SYSTEM


	)

392 
	m_SC_MONOTONIC_CLOCK
,

393 
	#_SC_MONOTONIC_CLOCK
 
_SC_MONOTONIC_CLOCK


	)

394 
	m_SC_MULTI_PROCESS
,

395 
	#_SC_MULTI_PROCESS
 
_SC_MULTI_PROCESS


	)

396 
	m_SC_SINGLE_PROCESS
,

397 
	#_SC_SINGLE_PROCESS
 
_SC_SINGLE_PROCESS


	)

398 
	m_SC_NETWORKING
,

399 
	#_SC_NETWORKING
 
_SC_NETWORKING


	)

400 
	m_SC_READER_WRITER_LOCKS
,

401 
	#_SC_READER_WRITER_LOCKS
 
_SC_READER_WRITER_LOCKS


	)

402 
	m_SC_SPIN_LOCKS
,

403 
	#_SC_SPIN_LOCKS
 
_SC_SPIN_LOCKS


	)

404 
	m_SC_REGEXP
,

405 
	#_SC_REGEXP
 
_SC_REGEXP


	)

406 
	m_SC_REGEX_VERSION
,

407 
	#_SC_REGEX_VERSION
 
_SC_REGEX_VERSION


	)

408 
	m_SC_SHELL
,

409 
	#_SC_SHELL
 
_SC_SHELL


	)

410 
	m_SC_SIGNALS
,

411 
	#_SC_SIGNALS
 
_SC_SIGNALS


	)

412 
	m_SC_SPAWN
,

413 
	#_SC_SPAWN
 
_SC_SPAWN


	)

414 
	m_SC_SPORADIC_SERVER
,

415 
	#_SC_SPORADIC_SERVER
 
_SC_SPORADIC_SERVER


	)

416 
	m_SC_THREAD_SPORADIC_SERVER
,

417 
	#_SC_THREAD_SPORADIC_SERVER
 
_SC_THREAD_SPORADIC_SERVER


	)

418 
	m_SC_SYSTEM_DATABASE
,

419 
	#_SC_SYSTEM_DATABASE
 
_SC_SYSTEM_DATABASE


	)

420 
	m_SC_SYSTEM_DATABASE_R
,

421 
	#_SC_SYSTEM_DATABASE_R
 
_SC_SYSTEM_DATABASE_R


	)

422 
	m_SC_TIMEOUTS
,

423 
	#_SC_TIMEOUTS
 
_SC_TIMEOUTS


	)

424 
	m_SC_TYPED_MEMORY_OBJECTS
,

425 
	#_SC_TYPED_MEMORY_OBJECTS
 
_SC_TYPED_MEMORY_OBJECTS


	)

426 
	m_SC_USER_GROUPS
,

427 
	#_SC_USER_GROUPS
 
_SC_USER_GROUPS


	)

428 
	m_SC_USER_GROUPS_R
,

429 
	#_SC_USER_GROUPS_R
 
_SC_USER_GROUPS_R


	)

430 
	m_SC_2_PBS
,

431 
	#_SC_2_PBS
 
_SC_2_PBS


	)

432 
	m_SC_2_PBS_ACCOUNTING
,

433 
	#_SC_2_PBS_ACCOUNTING
 
_SC_2_PBS_ACCOUNTING


	)

434 
	m_SC_2_PBS_LOCATE
,

435 
	#_SC_2_PBS_LOCATE
 
_SC_2_PBS_LOCATE


	)

436 
	m_SC_2_PBS_MESSAGE
,

437 
	#_SC_2_PBS_MESSAGE
 
_SC_2_PBS_MESSAGE


	)

438 
	m_SC_2_PBS_TRACK
,

439 
	#_SC_2_PBS_TRACK
 
_SC_2_PBS_TRACK


	)

440 
	m_SC_SYMLOOP_MAX
,

441 
	#_SC_SYMLOOP_MAX
 
_SC_SYMLOOP_MAX


	)

442 
	m_SC_STREAMS
,

443 
	#_SC_STREAMS
 
_SC_STREAMS


	)

444 
	m_SC_2_PBS_CHECKPOINT
,

445 
	#_SC_2_PBS_CHECKPOINT
 
_SC_2_PBS_CHECKPOINT


	)

447 
	m_SC_V6_ILP32_OFF32
,

448 
	#_SC_V6_ILP32_OFF32
 
_SC_V6_ILP32_OFF32


	)

449 
	m_SC_V6_ILP32_OFFBIG
,

450 
	#_SC_V6_ILP32_OFFBIG
 
_SC_V6_ILP32_OFFBIG


	)

451 
	m_SC_V6_LP64_OFF64
,

452 
	#_SC_V6_LP64_OFF64
 
_SC_V6_LP64_OFF64


	)

453 
	m_SC_V6_LPBIG_OFFBIG
,

454 
	#_SC_V6_LPBIG_OFFBIG
 
_SC_V6_LPBIG_OFFBIG


	)

456 
	m_SC_HOST_NAME_MAX
,

457 
	#_SC_HOST_NAME_MAX
 
_SC_HOST_NAME_MAX


	)

458 
	m_SC_TRACE
,

459 
	#_SC_TRACE
 
_SC_TRACE


	)

460 
	m_SC_TRACE_EVENT_FILTER
,

461 
	#_SC_TRACE_EVENT_FILTER
 
_SC_TRACE_EVENT_FILTER


	)

462 
	m_SC_TRACE_INHERIT
,

463 
	#_SC_TRACE_INHERIT
 
_SC_TRACE_INHERIT


	)

464 
	m_SC_TRACE_LOG
,

465 
	#_SC_TRACE_LOG
 
_SC_TRACE_LOG


	)

467 
	m_SC_LEVEL1_ICACHE_SIZE
,

468 
	#_SC_LEVEL1_ICACHE_SIZE
 
_SC_LEVEL1_ICACHE_SIZE


	)

469 
	m_SC_LEVEL1_ICACHE_ASSOC
,

470 
	#_SC_LEVEL1_ICACHE_ASSOC
 
_SC_LEVEL1_ICACHE_ASSOC


	)

471 
	m_SC_LEVEL1_ICACHE_LINESIZE
,

472 
	#_SC_LEVEL1_ICACHE_LINESIZE
 
_SC_LEVEL1_ICACHE_LINESIZE


	)

473 
	m_SC_LEVEL1_DCACHE_SIZE
,

474 
	#_SC_LEVEL1_DCACHE_SIZE
 
_SC_LEVEL1_DCACHE_SIZE


	)

475 
	m_SC_LEVEL1_DCACHE_ASSOC
,

476 
	#_SC_LEVEL1_DCACHE_ASSOC
 
_SC_LEVEL1_DCACHE_ASSOC


	)

477 
	m_SC_LEVEL1_DCACHE_LINESIZE
,

478 
	#_SC_LEVEL1_DCACHE_LINESIZE
 
_SC_LEVEL1_DCACHE_LINESIZE


	)

479 
	m_SC_LEVEL2_CACHE_SIZE
,

480 
	#_SC_LEVEL2_CACHE_SIZE
 
_SC_LEVEL2_CACHE_SIZE


	)

481 
	m_SC_LEVEL2_CACHE_ASSOC
,

482 
	#_SC_LEVEL2_CACHE_ASSOC
 
_SC_LEVEL2_CACHE_ASSOC


	)

483 
	m_SC_LEVEL2_CACHE_LINESIZE
,

484 
	#_SC_LEVEL2_CACHE_LINESIZE
 
_SC_LEVEL2_CACHE_LINESIZE


	)

485 
	m_SC_LEVEL3_CACHE_SIZE
,

486 
	#_SC_LEVEL3_CACHE_SIZE
 
_SC_LEVEL3_CACHE_SIZE


	)

487 
	m_SC_LEVEL3_CACHE_ASSOC
,

488 
	#_SC_LEVEL3_CACHE_ASSOC
 
_SC_LEVEL3_CACHE_ASSOC


	)

489 
	m_SC_LEVEL3_CACHE_LINESIZE
,

490 
	#_SC_LEVEL3_CACHE_LINESIZE
 
_SC_LEVEL3_CACHE_LINESIZE


	)

491 
	m_SC_LEVEL4_CACHE_SIZE
,

492 
	#_SC_LEVEL4_CACHE_SIZE
 
_SC_LEVEL4_CACHE_SIZE


	)

493 
	m_SC_LEVEL4_CACHE_ASSOC
,

494 
	#_SC_LEVEL4_CACHE_ASSOC
 
_SC_LEVEL4_CACHE_ASSOC


	)

495 
	m_SC_LEVEL4_CACHE_LINESIZE
,

496 
	#_SC_LEVEL4_CACHE_LINESIZE
 
_SC_LEVEL4_CACHE_LINESIZE


	)

499 
	m_SC_IPV6
 = 
_SC_LEVEL1_ICACHE_SIZE
 + 50,

500 
	#_SC_IPV6
 
_SC_IPV6


	)

501 
	m_SC_RAW_SOCKETS
,

502 
	#_SC_RAW_SOCKETS
 
_SC_RAW_SOCKETS


	)

504 
	m_SC_V7_ILP32_OFF32
,

505 
	#_SC_V7_ILP32_OFF32
 
_SC_V7_ILP32_OFF32


	)

506 
	m_SC_V7_ILP32_OFFBIG
,

507 
	#_SC_V7_ILP32_OFFBIG
 
_SC_V7_ILP32_OFFBIG


	)

508 
	m_SC_V7_LP64_OFF64
,

509 
	#_SC_V7_LP64_OFF64
 
_SC_V7_LP64_OFF64


	)

510 
	m_SC_V7_LPBIG_OFFBIG
,

511 
	#_SC_V7_LPBIG_OFFBIG
 
_SC_V7_LPBIG_OFFBIG


	)

513 
	m_SC_SS_REPL_MAX
,

514 
	#_SC_SS_REPL_MAX
 
_SC_SS_REPL_MAX


	)

516 
	m_SC_TRACE_EVENT_NAME_MAX
,

517 
	#_SC_TRACE_EVENT_NAME_MAX
 
_SC_TRACE_EVENT_NAME_MAX


	)

518 
	m_SC_TRACE_NAME_MAX
,

519 
	#_SC_TRACE_NAME_MAX
 
_SC_TRACE_NAME_MAX


	)

520 
	m_SC_TRACE_SYS_MAX
,

521 
	#_SC_TRACE_SYS_MAX
 
_SC_TRACE_SYS_MAX


	)

522 
	m_SC_TRACE_USER_EVENT_MAX
,

523 
	#_SC_TRACE_USER_EVENT_MAX
 
_SC_TRACE_USER_EVENT_MAX


	)

525 
	m_SC_XOPEN_STREAMS
,

526 
	#_SC_XOPEN_STREAMS
 
_SC_XOPEN_STREAMS


	)

528 
	m_SC_THREAD_ROBUST_PRIO_INHERIT
,

529 
	#_SC_THREAD_ROBUST_PRIO_INHERIT
 
_SC_THREAD_ROBUST_PRIO_INHERIT


	)

530 
	m_SC_THREAD_ROBUST_PRIO_PROTECT


531 
	#_SC_THREAD_ROBUST_PRIO_PROTECT
 
_SC_THREAD_ROBUST_PRIO_PROTECT


	)

537 
	m_CS_PATH
,

538 
	#_CS_PATH
 
_CS_PATH


	)

540 
	m_CS_V6_WIDTH_RESTRICTED_ENVS
,

541 
	#_CS_V6_WIDTH_RESTRICTED_ENVS
 
_CS_V6_WIDTH_RESTRICTED_ENVS


	)

542 
	#_CS_POSIX_V6_WIDTH_RESTRICTED_ENVS
 
_CS_V6_WIDTH_RESTRICTED_ENVS


	)

544 
	m_CS_GNU_LIBC_VERSION
,

545 
	#_CS_GNU_LIBC_VERSION
 
_CS_GNU_LIBC_VERSION


	)

546 
	m_CS_GNU_LIBPTHREAD_VERSION
,

547 
	#_CS_GNU_LIBPTHREAD_VERSION
 
_CS_GNU_LIBPTHREAD_VERSION


	)

549 
	m_CS_V5_WIDTH_RESTRICTED_ENVS
,

550 
	#_CS_V5_WIDTH_RESTRICTED_ENVS
 
_CS_V5_WIDTH_RESTRICTED_ENVS


	)

551 
	#_CS_POSIX_V5_WIDTH_RESTRICTED_ENVS
 
_CS_V5_WIDTH_RESTRICTED_ENVS


	)

553 
	m_CS_V7_WIDTH_RESTRICTED_ENVS
,

554 
	#_CS_V7_WIDTH_RESTRICTED_ENVS
 
_CS_V7_WIDTH_RESTRICTED_ENVS


	)

555 
	#_CS_POSIX_V7_WIDTH_RESTRICTED_ENVS
 
_CS_V7_WIDTH_RESTRICTED_ENVS


	)

557 
	m_CS_LFS_CFLAGS
 = 1000,

558 
	#_CS_LFS_CFLAGS
 
_CS_LFS_CFLAGS


	)

559 
	m_CS_LFS_LDFLAGS
,

560 
	#_CS_LFS_LDFLAGS
 
_CS_LFS_LDFLAGS


	)

561 
	m_CS_LFS_LIBS
,

562 
	#_CS_LFS_LIBS
 
_CS_LFS_LIBS


	)

563 
	m_CS_LFS_LINTFLAGS
,

564 
	#_CS_LFS_LINTFLAGS
 
_CS_LFS_LINTFLAGS


	)

565 
	m_CS_LFS64_CFLAGS
,

566 
	#_CS_LFS64_CFLAGS
 
_CS_LFS64_CFLAGS


	)

567 
	m_CS_LFS64_LDFLAGS
,

568 
	#_CS_LFS64_LDFLAGS
 
_CS_LFS64_LDFLAGS


	)

569 
	m_CS_LFS64_LIBS
,

570 
	#_CS_LFS64_LIBS
 
_CS_LFS64_LIBS


	)

571 
	m_CS_LFS64_LINTFLAGS
,

572 
	#_CS_LFS64_LINTFLAGS
 
_CS_LFS64_LINTFLAGS


	)

574 
	m_CS_XBS5_ILP32_OFF32_CFLAGS
 = 1100,

575 
	#_CS_XBS5_ILP32_OFF32_CFLAGS
 
_CS_XBS5_ILP32_OFF32_CFLAGS


	)

576 
	m_CS_XBS5_ILP32_OFF32_LDFLAGS
,

577 
	#_CS_XBS5_ILP32_OFF32_LDFLAGS
 
_CS_XBS5_ILP32_OFF32_LDFLAGS


	)

578 
	m_CS_XBS5_ILP32_OFF32_LIBS
,

579 
	#_CS_XBS5_ILP32_OFF32_LIBS
 
_CS_XBS5_ILP32_OFF32_LIBS


	)

580 
	m_CS_XBS5_ILP32_OFF32_LINTFLAGS
,

581 
	#_CS_XBS5_ILP32_OFF32_LINTFLAGS
 
_CS_XBS5_ILP32_OFF32_LINTFLAGS


	)

582 
	m_CS_XBS5_ILP32_OFFBIG_CFLAGS
,

583 
	#_CS_XBS5_ILP32_OFFBIG_CFLAGS
 
_CS_XBS5_ILP32_OFFBIG_CFLAGS


	)

584 
	m_CS_XBS5_ILP32_OFFBIG_LDFLAGS
,

585 
	#_CS_XBS5_ILP32_OFFBIG_LDFLAGS
 
_CS_XBS5_ILP32_OFFBIG_LDFLAGS


	)

586 
	m_CS_XBS5_ILP32_OFFBIG_LIBS
,

587 
	#_CS_XBS5_ILP32_OFFBIG_LIBS
 
_CS_XBS5_ILP32_OFFBIG_LIBS


	)

588 
	m_CS_XBS5_ILP32_OFFBIG_LINTFLAGS
,

589 
	#_CS_XBS5_ILP32_OFFBIG_LINTFLAGS
 
_CS_XBS5_ILP32_OFFBIG_LINTFLAGS


	)

590 
	m_CS_XBS5_LP64_OFF64_CFLAGS
,

591 
	#_CS_XBS5_LP64_OFF64_CFLAGS
 
_CS_XBS5_LP64_OFF64_CFLAGS


	)

592 
	m_CS_XBS5_LP64_OFF64_LDFLAGS
,

593 
	#_CS_XBS5_LP64_OFF64_LDFLAGS
 
_CS_XBS5_LP64_OFF64_LDFLAGS


	)

594 
	m_CS_XBS5_LP64_OFF64_LIBS
,

595 
	#_CS_XBS5_LP64_OFF64_LIBS
 
_CS_XBS5_LP64_OFF64_LIBS


	)

596 
	m_CS_XBS5_LP64_OFF64_LINTFLAGS
,

597 
	#_CS_XBS5_LP64_OFF64_LINTFLAGS
 
_CS_XBS5_LP64_OFF64_LINTFLAGS


	)

598 
	m_CS_XBS5_LPBIG_OFFBIG_CFLAGS
,

599 
	#_CS_XBS5_LPBIG_OFFBIG_CFLAGS
 
_CS_XBS5_LPBIG_OFFBIG_CFLAGS


	)

600 
	m_CS_XBS5_LPBIG_OFFBIG_LDFLAGS
,

601 
	#_CS_XBS5_LPBIG_OFFBIG_LDFLAGS
 
_CS_XBS5_LPBIG_OFFBIG_LDFLAGS


	)

602 
	m_CS_XBS5_LPBIG_OFFBIG_LIBS
,

603 
	#_CS_XBS5_LPBIG_OFFBIG_LIBS
 
_CS_XBS5_LPBIG_OFFBIG_LIBS


	)

604 
	m_CS_XBS5_LPBIG_OFFBIG_LINTFLAGS
,

605 
	#_CS_XBS5_LPBIG_OFFBIG_LINTFLAGS
 
_CS_XBS5_LPBIG_OFFBIG_LINTFLAGS


	)

607 
	m_CS_POSIX_V6_ILP32_OFF32_CFLAGS
,

608 
	#_CS_POSIX_V6_ILP32_OFF32_CFLAGS
 
_CS_POSIX_V6_ILP32_OFF32_CFLAGS


	)

609 
	m_CS_POSIX_V6_ILP32_OFF32_LDFLAGS
,

610 
	#_CS_POSIX_V6_ILP32_OFF32_LDFLAGS
 
_CS_POSIX_V6_ILP32_OFF32_LDFLAGS


	)

611 
	m_CS_POSIX_V6_ILP32_OFF32_LIBS
,

612 
	#_CS_POSIX_V6_ILP32_OFF32_LIBS
 
_CS_POSIX_V6_ILP32_OFF32_LIBS


	)

613 
	m_CS_POSIX_V6_ILP32_OFF32_LINTFLAGS
,

614 
	#_CS_POSIX_V6_ILP32_OFF32_LINTFLAGS
 
_CS_POSIX_V6_ILP32_OFF32_LINTFLAGS


	)

615 
	m_CS_POSIX_V6_ILP32_OFFBIG_CFLAGS
,

616 
	#_CS_POSIX_V6_ILP32_OFFBIG_CFLAGS
 
_CS_POSIX_V6_ILP32_OFFBIG_CFLAGS


	)

617 
	m_CS_POSIX_V6_ILP32_OFFBIG_LDFLAGS
,

618 
	#_CS_POSIX_V6_ILP32_OFFBIG_LDFLAGS
 
_CS_POSIX_V6_ILP32_OFFBIG_LDFLAGS


	)

619 
	m_CS_POSIX_V6_ILP32_OFFBIG_LIBS
,

620 
	#_CS_POSIX_V6_ILP32_OFFBIG_LIBS
 
_CS_POSIX_V6_ILP32_OFFBIG_LIBS


	)

621 
	m_CS_POSIX_V6_ILP32_OFFBIG_LINTFLAGS
,

622 
	#_CS_POSIX_V6_ILP32_OFFBIG_LINTFLAGS
 
_CS_POSIX_V6_ILP32_OFFBIG_LINTFLAGS


	)

623 
	m_CS_POSIX_V6_LP64_OFF64_CFLAGS
,

624 
	#_CS_POSIX_V6_LP64_OFF64_CFLAGS
 
_CS_POSIX_V6_LP64_OFF64_CFLAGS


	)

625 
	m_CS_POSIX_V6_LP64_OFF64_LDFLAGS
,

626 
	#_CS_POSIX_V6_LP64_OFF64_LDFLAGS
 
_CS_POSIX_V6_LP64_OFF64_LDFLAGS


	)

627 
	m_CS_POSIX_V6_LP64_OFF64_LIBS
,

628 
	#_CS_POSIX_V6_LP64_OFF64_LIBS
 
_CS_POSIX_V6_LP64_OFF64_LIBS


	)

629 
	m_CS_POSIX_V6_LP64_OFF64_LINTFLAGS
,

630 
	#_CS_POSIX_V6_LP64_OFF64_LINTFLAGS
 
_CS_POSIX_V6_LP64_OFF64_LINTFLAGS


	)

631 
	m_CS_POSIX_V6_LPBIG_OFFBIG_CFLAGS
,

632 
	#_CS_POSIX_V6_LPBIG_OFFBIG_CFLAGS
 
_CS_POSIX_V6_LPBIG_OFFBIG_CFLAGS


	)

633 
	m_CS_POSIX_V6_LPBIG_OFFBIG_LDFLAGS
,

634 
	#_CS_POSIX_V6_LPBIG_OFFBIG_LDFLAGS
 
_CS_POSIX_V6_LPBIG_OFFBIG_LDFLAGS


	)

635 
	m_CS_POSIX_V6_LPBIG_OFFBIG_LIBS
,

636 
	#_CS_POSIX_V6_LPBIG_OFFBIG_LIBS
 
_CS_POSIX_V6_LPBIG_OFFBIG_LIBS


	)

637 
	m_CS_POSIX_V6_LPBIG_OFFBIG_LINTFLAGS
,

638 
	#_CS_POSIX_V6_LPBIG_OFFBIG_LINTFLAGS
 
_CS_POSIX_V6_LPBIG_OFFBIG_LINTFLAGS


	)

640 
	m_CS_POSIX_V7_ILP32_OFF32_CFLAGS
,

641 
	#_CS_POSIX_V7_ILP32_OFF32_CFLAGS
 
_CS_POSIX_V7_ILP32_OFF32_CFLAGS


	)

642 
	m_CS_POSIX_V7_ILP32_OFF32_LDFLAGS
,

643 
	#_CS_POSIX_V7_ILP32_OFF32_LDFLAGS
 
_CS_POSIX_V7_ILP32_OFF32_LDFLAGS


	)

644 
	m_CS_POSIX_V7_ILP32_OFF32_LIBS
,

645 
	#_CS_POSIX_V7_ILP32_OFF32_LIBS
 
_CS_POSIX_V7_ILP32_OFF32_LIBS


	)

646 
	m_CS_POSIX_V7_ILP32_OFF32_LINTFLAGS
,

647 
	#_CS_POSIX_V7_ILP32_OFF32_LINTFLAGS
 
_CS_POSIX_V7_ILP32_OFF32_LINTFLAGS


	)

648 
	m_CS_POSIX_V7_ILP32_OFFBIG_CFLAGS
,

649 
	#_CS_POSIX_V7_ILP32_OFFBIG_CFLAGS
 
_CS_POSIX_V7_ILP32_OFFBIG_CFLAGS


	)

650 
	m_CS_POSIX_V7_ILP32_OFFBIG_LDFLAGS
,

651 
	#_CS_POSIX_V7_ILP32_OFFBIG_LDFLAGS
 
_CS_POSIX_V7_ILP32_OFFBIG_LDFLAGS


	)

652 
	m_CS_POSIX_V7_ILP32_OFFBIG_LIBS
,

653 
	#_CS_POSIX_V7_ILP32_OFFBIG_LIBS
 
_CS_POSIX_V7_ILP32_OFFBIG_LIBS


	)

654 
	m_CS_POSIX_V7_ILP32_OFFBIG_LINTFLAGS
,

655 
	#_CS_POSIX_V7_ILP32_OFFBIG_LINTFLAGS
 
_CS_POSIX_V7_ILP32_OFFBIG_LINTFLAGS


	)

656 
	m_CS_POSIX_V7_LP64_OFF64_CFLAGS
,

657 
	#_CS_POSIX_V7_LP64_OFF64_CFLAGS
 
_CS_POSIX_V7_LP64_OFF64_CFLAGS


	)

658 
	m_CS_POSIX_V7_LP64_OFF64_LDFLAGS
,

659 
	#_CS_POSIX_V7_LP64_OFF64_LDFLAGS
 
_CS_POSIX_V7_LP64_OFF64_LDFLAGS


	)

660 
	m_CS_POSIX_V7_LP64_OFF64_LIBS
,

661 
	#_CS_POSIX_V7_LP64_OFF64_LIBS
 
_CS_POSIX_V7_LP64_OFF64_LIBS


	)

662 
	m_CS_POSIX_V7_LP64_OFF64_LINTFLAGS
,

663 
	#_CS_POSIX_V7_LP64_OFF64_LINTFLAGS
 
_CS_POSIX_V7_LP64_OFF64_LINTFLAGS


	)

664 
	m_CS_POSIX_V7_LPBIG_OFFBIG_CFLAGS
,

665 
	#_CS_POSIX_V7_LPBIG_OFFBIG_CFLAGS
 
_CS_POSIX_V7_LPBIG_OFFBIG_CFLAGS


	)

666 
	m_CS_POSIX_V7_LPBIG_OFFBIG_LDFLAGS
,

667 
	#_CS_POSIX_V7_LPBIG_OFFBIG_LDFLAGS
 
_CS_POSIX_V7_LPBIG_OFFBIG_LDFLAGS


	)

668 
	m_CS_POSIX_V7_LPBIG_OFFBIG_LIBS
,

669 
	#_CS_POSIX_V7_LPBIG_OFFBIG_LIBS
 
_CS_POSIX_V7_LPBIG_OFFBIG_LIBS


	)

670 
	m_CS_POSIX_V7_LPBIG_OFFBIG_LINTFLAGS
,

671 
	#_CS_POSIX_V7_LPBIG_OFFBIG_LINTFLAGS
 
_CS_POSIX_V7_LPBIG_OFFBIG_LINTFLAGS


	)

673 
	m_CS_V6_ENV
,

674 
	#_CS_V6_ENV
 
_CS_V6_ENV


	)

675 
	m_CS_V7_ENV


676 
	#_CS_V7_ENV
 
_CS_V7_ENV


	)

	@/usr/include/bits/endian.h

3 #iâdeà
_ENDIAN_H


7 
	#__BYTE_ORDER
 
__LITTLE_ENDIAN


	)

	@/usr/include/bits/environments.h

19 #iâdeà
_UNISTD_H


23 
	~<b™s/wÜdsize.h
>

43 #ià
__WORDSIZE
 == 64

57 
	#_POSIX_V7_LPBIG_OFFBIG
 -1

	)

58 
	#_POSIX_V6_LPBIG_OFFBIG
 -1

	)

59 
	#_XBS5_LPBIG_OFFBIG
 -1

	)

62 
	#_POSIX_V7_LP64_OFF64
 1

	)

63 
	#_POSIX_V6_LP64_OFF64
 1

	)

64 
	#_XBS5_LP64_OFF64
 1

	)

70 
	#_POSIX_V7_ILP32_OFF32
 1

	)

71 
	#_POSIX_V7_ILP32_OFFBIG
 1

	)

72 
	#_POSIX_V6_ILP32_OFF32
 1

	)

73 
	#_POSIX_V6_ILP32_OFFBIG
 1

	)

74 
	#_XBS5_ILP32_OFF32
 1

	)

75 
	#_XBS5_ILP32_OFFBIG
 1

	)

92 
	#__ILP32_OFF32_CFLAGS
 "-m32"

	)

93 
	#__ILP32_OFFBIG_CFLAGS
 "-m32 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64"

	)

94 
	#__ILP32_OFF32_LDFLAGS
 "-m32"

	)

95 
	#__ILP32_OFFBIG_LDFLAGS
 "-m32"

	)

96 
	#__LP64_OFF64_CFLAGS
 "-m64"

	)

97 
	#__LP64_OFF64_LDFLAGS
 "-m64"

	)

	@/usr/include/bits/ioctl-types.h

20 #iâdeà
_SYS_IOCTL_H


25 
	~<asm/ioùls.h
>

28 
	swšsize


30 
	mws_row
;

31 
	mws_cŞ
;

32 
	mws_xpix–
;

33 
	mws_ypix–
;

36 
	#NCC
 8

	)

37 
	s‹rmio


39 
	mc_iæag
;

40 
	mc_oæag
;

41 
	mc_cæag
;

42 
	mc_læag
;

43 
	mc_lše
;

44 
	mc_cc
[
NCC
];

48 
	#TIOCM_LE
 0x001

	)

49 
	#TIOCM_DTR
 0x002

	)

50 
	#TIOCM_RTS
 0x004

	)

51 
	#TIOCM_ST
 0x008

	)

52 
	#TIOCM_SR
 0x010

	)

53 
	#TIOCM_CTS
 0x020

	)

54 
	#TIOCM_CAR
 0x040

	)

55 
	#TIOCM_RNG
 0x080

	)

56 
	#TIOCM_DSR
 0x100

	)

57 
	#TIOCM_CD
 
TIOCM_CAR


	)

58 
	#TIOCM_RI
 
TIOCM_RNG


	)

63 
	#N_TTY
 0

	)

64 
	#N_SLIP
 1

	)

65 
	#N_MOUSE
 2

	)

66 
	#N_PPP
 3

	)

67 
	#N_STRIP
 4

	)

68 
	#N_AX25
 5

	)

69 
	#N_X25
 6

	)

70 
	#N_6PACK
 7

	)

71 
	#N_MASC
 8

	)

72 
	#N_R3964
 9

	)

73 
	#N_PROFIBUS_FDL
 10

	)

74 
	#N_IRDA
 11

	)

75 
	#N_SMSBLOCK
 12

	)

76 
	#N_HDLC
 13

	)

77 
	#N_SYNC_PPP
 14

	)

78 
	#N_HCI
 15

	)

	@/usr/include/bits/ioctls.h

19 #iâdeà
_SYS_IOCTL_H


24 
	~<asm/ioùls.h
>

27 
	#SIOCADDRT
 0x890B

	)

28 
	#SIOCDELRT
 0x890C

	)

29 
	#SIOCRTMSG
 0x890D

	)

32 
	#SIOCGIFNAME
 0x8910

	)

33 
	#SIOCSIFLINK
 0x8911

	)

34 
	#SIOCGIFCONF
 0x8912

	)

35 
	#SIOCGIFFLAGS
 0x8913

	)

36 
	#SIOCSIFFLAGS
 0x8914

	)

37 
	#SIOCGIFADDR
 0x8915

	)

38 
	#SIOCSIFADDR
 0x8916

	)

39 
	#SIOCGIFDSTADDR
 0x8917

	)

40 
	#SIOCSIFDSTADDR
 0x8918

	)

41 
	#SIOCGIFBRDADDR
 0x8919

	)

42 
	#SIOCSIFBRDADDR
 0x891¨

	)

43 
	#SIOCGIFNETMASK
 0x891b

	)

44 
	#SIOCSIFNETMASK
 0x891ø

	)

45 
	#SIOCGIFMETRIC
 0x891d

	)

46 
	#SIOCSIFMETRIC
 0x891

	)

47 
	#SIOCGIFMEM
 0x891à

	)

48 
	#SIOCSIFMEM
 0x8920

	)

49 
	#SIOCGIFMTU
 0x8921

	)

50 
	#SIOCSIFMTU
 0x8922

	)

51 
	#SIOCSIFNAME
 0x8923

	)

52 
	#SIOCSIFHWADDR
 0x8924

	)

53 
	#SIOCGIFENCAP
 0x8925

	)

54 
	#SIOCSIFENCAP
 0x8926

	)

55 
	#SIOCGIFHWADDR
 0x8927

	)

56 
	#SIOCGIFSLAVE
 0x8929

	)

57 
	#SIOCSIFSLAVE
 0x8930

	)

58 
	#SIOCADDMULTI
 0x8931

	)

59 
	#SIOCDELMULTI
 0x8932

	)

60 
	#SIOCGIFINDEX
 0x8933

	)

61 
	#SIOGIFINDEX
 
SIOCGIFINDEX


	)

62 
	#SIOCSIFPFLAGS
 0x8934

	)

63 
	#SIOCGIFPFLAGS
 0x8935

	)

64 
	#SIOCDIFADDR
 0x8936

	)

65 
	#SIOCSIFHWBROADCAST
 0x8937

	)

66 
	#SIOCGIFCOUNT
 0x8938

	)

68 
	#SIOCGIFBR
 0x8940

	)

69 
	#SIOCSIFBR
 0x8941

	)

71 
	#SIOCGIFTXQLEN
 0x8942

	)

72 
	#SIOCSIFTXQLEN
 0x8943

	)

77 
	#SIOCDARP
 0x8953

	)

78 
	#SIOCGARP
 0x8954

	)

79 
	#SIOCSARP
 0x8955

	)

82 
	#SIOCDRARP
 0x8960

	)

83 
	#SIOCGRARP
 0x8961

	)

84 
	#SIOCSRARP
 0x8962

	)

88 
	#SIOCGIFMAP
 0x8970

	)

89 
	#SIOCSIFMAP
 0x8971

	)

93 
	#SIOCADDDLCI
 0x8980

	)

94 
	#SIOCDELDLCI
 0x8981

	)

103 
	#SIOCDEVPRIVATE
 0x89F0

	)

109 
	#SIOCPROTOPRIVATE
 0x89E0

	)

	@/usr/include/bits/posix_opt.h

20 #iâdef 
_BITS_POSIX_OPT_H


21 
	#_BITS_POSIX_OPT_H
 1

	)

24 
	#_POSIX_JOB_CONTROL
 1

	)

27 
	#_POSIX_SAVED_IDS
 1

	)

30 
	#_POSIX_PRIORITY_SCHEDULING
 200809L

	)

33 
	#_POSIX_SYNCHRONIZED_IO
 200809L

	)

36 
	#_POSIX_FSYNC
 200809L

	)

39 
	#_POSIX_MAPPED_FILES
 200809L

	)

42 
	#_POSIX_MEMLOCK
 200809L

	)

45 
	#_POSIX_MEMLOCK_RANGE
 200809L

	)

48 
	#_POSIX_MEMORY_PROTECTION
 200809L

	)

51 
	#_POSIX_CHOWN_RESTRICTED
 0

	)

55 
	#_POSIX_VDISABLE
 '\0'

	)

58 
	#_POSIX_NO_TRUNC
 1

	)

61 
	#_XOPEN_REALTIME
 1

	)

64 
	#_XOPEN_REALTIME_THREADS
 1

	)

67 
	#_XOPEN_SHM
 1

	)

70 
	#_POSIX_THREADS
 200809L

	)

73 
	#_POSIX_REENTRANT_FUNCTIONS
 1

	)

74 
	#_POSIX_THREAD_SAFE_FUNCTIONS
 200809L

	)

77 
	#_POSIX_THREAD_PRIORITY_SCHEDULING
 200809L

	)

80 
	#_POSIX_THREAD_ATTR_STACKSIZE
 200809L

	)

83 
	#_POSIX_THREAD_ATTR_STACKADDR
 200809L

	)

86 
	#_POSIX_THREAD_PRIO_INHERIT
 200809L

	)

90 
	#_POSIX_THREAD_PRIO_PROTECT
 200809L

	)

92 #ifdeà
__USE_XOPEN2K8


94 
	#_POSIX_THREAD_ROBUST_PRIO_INHERIT
 200809L

	)

97 
	#_POSIX_THREAD_ROBUST_PRIO_PROTECT
 -1

	)

101 
	#_POSIX_SEMAPHORES
 200809L

	)

104 
	#_POSIX_REALTIME_SIGNALS
 200809L

	)

107 
	#_POSIX_ASYNCHRONOUS_IO
 200809L

	)

108 
	#_POSIX_ASYNC_IO
 1

	)

110 
	#_LFS_ASYNCHRONOUS_IO
 1

	)

112 
	#_POSIX_PRIORITIZED_IO
 200809L

	)

115 
	#_LFS64_ASYNCHRONOUS_IO
 1

	)

118 
	#_LFS_LARGEFILE
 1

	)

119 
	#_LFS64_LARGEFILE
 1

	)

120 
	#_LFS64_STDIO
 1

	)

123 
	#_POSIX_SHARED_MEMORY_OBJECTS
 200809L

	)

126 
	#_POSIX_CPUTIME
 0

	)

129 
	#_POSIX_THREAD_CPUTIME
 0

	)

132 
	#_POSIX_REGEXP
 1

	)

135 
	#_POSIX_READER_WRITER_LOCKS
 200809L

	)

138 
	#_POSIX_SHELL
 1

	)

141 
	#_POSIX_TIMEOUTS
 200809L

	)

144 
	#_POSIX_SPIN_LOCKS
 200809L

	)

147 
	#_POSIX_SPAWN
 200809L

	)

150 
	#_POSIX_TIMERS
 200809L

	)

153 
	#_POSIX_BARRIERS
 200809L

	)

156 
	#_POSIX_MESSAGE_PASSING
 200809L

	)

159 
	#_POSIX_THREAD_PROCESS_SHARED
 200809L

	)

162 
	#_POSIX_MONOTONIC_CLOCK
 0

	)

165 
	#_POSIX_CLOCK_SELECTION
 200809L

	)

168 
	#_POSIX_ADVISORY_INFO
 200809L

	)

171 
	#_POSIX_IPV6
 200809L

	)

174 
	#_POSIX_RAW_SOCKETS
 200809L

	)

177 
	#_POSIX2_CHAR_TERM
 200809L

	)

180 
	#_POSIX_SPORADIC_SERVER
 -1

	)

181 
	#_POSIX_THREAD_SPORADIC_SERVER
 -1

	)

184 
	#_POSIX_TRACE
 -1

	)

185 
	#_POSIX_TRACE_EVENT_FILTER
 -1

	)

186 
	#_POSIX_TRACE_INHERIT
 -1

	)

187 
	#_POSIX_TRACE_LOG
 -1

	)

190 
	#_POSIX_TYPED_MEMORY_OBJECTS
 -1

	)

	@/usr/include/bits/predefs.h

19 #iâdeà
_FEATURES_H


23 #iâdeà
_PREDEFS_H


24 
	#_PREDEFS_H


	)

27 
	#__STDC_IEC_559__
 1

	)

28 
	#__STDC_IEC_559_COMPLEX__
 1

	)

	@/usr/include/bits/string.h

20 #iâdeà
_STRING_H


26 
	#_STRING_ARCH_uÇligÃd
 1

	)

	@/usr/include/bits/string2.h

21 #iâdeà
_STRING_H


25 #ià!
defšed
 
__NO_STRING_INLINES
 && !defšed 
__BOUNDED_POINTERS__


42 #iâdeà
__STRING_INLINE


43 #ifdeà
__ılu¥lus


44 
	#__STRING_INLINE
 
šlše


	)

46 
	#__STRING_INLINE
 
__ex‹º_šlše


	)

50 #ià
_STRING_ARCH_uÇligÃd


52 
	~<’dŸn.h
>

53 
	~<b™s/ty³s.h
>

55 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


56 
	#__STRING2_SMALL_GET16
(
¤c
, 
idx
) \

57 (((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
 + 1] << 8 \

58 | ((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
])

	)

59 
	#__STRING2_SMALL_GET32
(
¤c
, 
idx
) \

60 (((((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
 + 3] << 8 \

61 | ((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
 + 2]) << 8 \

62 | ((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
 + 1]) << 8 \

63 | ((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
])

	)

65 
	#__STRING2_SMALL_GET16
(
¤c
, 
idx
) \

66 (((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
] << 8 \

67 | ((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
 + 1])

	)

68 
	#__STRING2_SMALL_GET32
(
¤c
, 
idx
) \

69 (((((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
] << 8 \

70 | ((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
 + 1]) << 8 \

71 | ((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
 + 2]) << 8 \

72 | ((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
 + 3])

	)

77 
	#__STRING2_COPY_TYPE
(
N
) \

78 ¡ruù { 
__¬r
[
N
]; } \

79 
	t__©Œibu‹__
 ((
	t__·cked__
)è
	t__STRING2_COPY_ARR
##
	tN


	)

80 
	t__STRING2_COPY_TYPE
 (2);

81 
__STRING2_COPY_TYPE
 (3);

82 
__STRING2_COPY_TYPE
 (4);

83 
__STRING2_COPY_TYPE
 (5);

84 
__STRING2_COPY_TYPE
 (6);

85 
__STRING2_COPY_TYPE
 (7);

86 
__STRING2_COPY_TYPE
 (8);

87 #undeà
__STRING2_COPY_TYPE


93 
	#__¡ršg2_1b±r_p
(
__x
) \

94 ((
size_t
)(cÚ¡ *)((
__x
è+ 1è- (size_t)(cÚ¡ *)(__xè=ğ1)

	)

97 #ià!
defšed
 
_HAVE_STRING_ARCH_mem£t


98 #ià!
__GNUC_PREREQ
 (3, 0)

99 #ià
_STRING_ARCH_uÇligÃd


100 
	#mem£t
(
s
, 
c
, 
n
) \

101 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
n
) && (n) <= 16 \

102 ? ((
n
) == 1 \

103 ? 
	`__mem£t_1
 (
s
, 
c
) \

104 : 
	`__mem£t_gc
 (
s
, 
c
, 
n
)) \

105 : (
	`__butš_cÚ¡ªt_p
 (
c
) && (c) == '\0' \

106 ? ({ *
__s
 = (
s
); 
	`__bz”o
 (__s, 
n
); __s; }) \

107 : 
	`mem£t
 (
s
, 
c
, 
n
))))

	)

109 
	#__mem£t_1
(
s
, 
c
è({ *
__s
 = (s); \

110 *((
__ušt8_t
 *è
__s
èğ(__ušt8_tè
c
; __s; })

	)

112 
	#__mem£t_gc
(
s
, 
c
, 
n
) \

113 ({ *
__s
 = (
s
); \

115 
__ui
; \

116 
__usi
; \

117 
__uc
; \

118 } *
__u
 = 
__s
; \

119 
__ušt8_t
 
__c
 = (__ušt8_tè(
c
); \

122 (è(
n
)) \

125 
__u
->
__ui
 = 
__c
 * 0x01010101; \

126 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

128 
__u
->
__ui
 = 
__c
 * 0x01010101; \

129 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

131 
__u
->
__ui
 = 
__c
 * 0x01010101; \

132 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

134 
__u
->
__usi
 = (è
__c
 * 0x0101; \

135 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2); \

136 
__u
->
__uc
 = (è
__c
; \

140 
__u
->
__ui
 = 
__c
 * 0x01010101; \

141 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

143 
__u
->
__ui
 = 
__c
 * 0x01010101; \

144 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

146 
__u
->
__ui
 = 
__c
 * 0x01010101; \

147 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

149 
__u
->
__usi
 = (è
__c
 * 0x0101; \

153 
__u
->
__ui
 = 
__c
 * 0x01010101; \

154 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

156 
__u
->
__ui
 = 
__c
 * 0x01010101; \

157 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

159 
__u
->
__ui
 = 
__c
 * 0x01010101; \

160 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

162 
__u
->
__uc
 = (è
__c
; \

166 
__u
->
__ui
 = 
__c
 * 0x01010101; \

167 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

169 
__u
->
__ui
 = 
__c
 * 0x01010101; \

170 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

172 
__u
->
__ui
 = 
__c
 * 0x01010101; \

173 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

175 
__u
->
__ui
 = 
__c
 * 0x01010101; \

180 
__s
; })

	)

182 
	#mem£t
(
s
, 
c
, 
n
) \

183 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
c
) && (c) == '\0' \

184 ? ({ *
__s
 = (
s
); 
	`__bz”o
 (__s, 
n
); __s; }) \

185 : 
	`mem£t
 (
s
, 
c
, 
n
)))

	)

194 #ià
__GNUC_PREREQ
 (2, 91)

195 
	#__bz”o
(
s
, 
n
è
	`__butš_mem£t
 (s, '\0',‚)

	)

203 #ifdeà
__USE_GNU


204 #ià!
defšed
 
_HAVE_STRING_ARCH_mempıy
 || defšed 
_FORCE_INLINES


205 #iâdeà
_HAVE_STRING_ARCH_mempıy


206 #ià
__GNUC_PREREQ
 (3, 4)

207 
	#__mempıy
(
de¡
, 
¤c
, 
n
è
	`__butš_mempıy
 (de¡, src,‚)

	)

208 #–ià
__GNUC_PREREQ
 (3, 0)

209 
	#__mempıy
(
de¡
, 
¤c
, 
n
) \

210 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
¤c
è&& __butš_cÚ¡ªt_°(
n
) \

211 && 
	`__¡ršg2_1b±r_p
 (
¤c
è&& 
n
 <= 8 \

212 ? 
	`__butš_memıy
 (
de¡
, 
¤c
, 
n
) + (n) \

213 : 
	`__mempıy
 (
de¡
, 
¤c
, 
n
)))

	)

215 
	#__mempıy
(
de¡
, 
¤c
, 
n
) \

216 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
¤c
è&& __butš_cÚ¡ªt_°(
n
) \

217 && 
	`__¡ršg2_1b±r_p
 (
¤c
è&& 
n
 <= 8 \

218 ? 
	`__mempıy_sm®l
 (
de¡
, 
	`__mempıy_¬gs
 (
¤c
), 
n
) \

219 : 
	`__mempıy
 (
de¡
, 
¤c
, 
n
)))

	)

223 
	#mempıy
(
de¡
, 
¤c
, 
n
è
	`__mempıy
 (de¡, src,‚)

	)

226 #ià!
__GNUC_PREREQ
 (3, 0è|| 
defšed
 
_FORCE_INLINES


227 #ià
_STRING_ARCH_uÇligÃd


228 #iâdeà
_FORCE_INLINES


229 
	#__mempıy_¬gs
(
¤c
) \

230 ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[2], \

231 ((
__cÚ¡
 *è(
¤c
))[4], ((__const *) (src))[6], \

232 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET16
 (
¤c
, 0), \

233 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET16
 (
¤c
, 4), \

234 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET32
 (
¤c
, 0), \

235 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET32
 (
¤c
, 4)

	)

237 
__STRING_INLINE
 *
__mempıy_sm®l
 (*, , , , ,

238 
__ušt16_t
, __ušt16_t, 
__ušt32_t
,

239 
__ušt32_t
, 
size_t
);

240 
__STRING_INLINE
 *

241 
	$__mempıy_sm®l
 (*
__de¡1
,

242 
__¤c0_1
, 
__¤c2_1
, 
__¤c4_1
, 
__¤c6_1
,

243 
__ušt16_t
 
__¤c0_2
, __ušt16_ˆ
__¤c4_2
,

244 
__ušt32_t
 
__¤c0_4
, __ušt32_ˆ
__¤c4_4
,

245 
size_t
 
__¤ş’
)

248 
__ušt32_t
 
__ui
;

249 
__ušt16_t
 
__usi
;

250 
__uc
;

251 
__c
;

252 } *
__u
 = 
__de¡1
;

253 (è
__¤ş’
)

256 
__u
->
__c
 = 
__¤c0_1
;

257 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 1);

260 
__u
->
__usi
 = 
__¤c0_2
;

261 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2);

264 
__u
->
__usi
 = 
__¤c0_2
;

265 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2);

266 
__u
->
__c
 = 
__¤c2_1
;

267 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 1);

270 
__u
->
__ui
 = 
__¤c0_4
;

271 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

274 
__u
->
__ui
 = 
__¤c0_4
;

275 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

276 
__u
->
__c
 = 
__¤c4_1
;

277 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 1);

280 
__u
->
__ui
 = 
__¤c0_4
;

281 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

282 
__u
->
__usi
 = 
__¤c4_2
;

283 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2);

286 
__u
->
__ui
 = 
__¤c0_4
;

287 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

288 
__u
->
__usi
 = 
__¤c4_2
;

289 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2);

290 
__u
->
__c
 = 
__¤c6_1
;

291 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 1);

294 
__u
->
__ui
 = 
__¤c0_4
;

295 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

296 
__u
->
__ui
 = 
__¤c4_4
;

297 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

300  (*è
__u
;

301 
	}
}

303 #iâdeà
_FORCE_INLINES


304 
	#__mempıy_¬gs
(
¤c
) \

305 ((
__cÚ¡
 *è(
¤c
))[0], \

306 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR2
) \

307 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1] } }), \

308 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR3
) \

309 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

310 ((
__cÚ¡
 *è(
¤c
))[2] } }), \

311 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR4
) \

312 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

313 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3] } }), \

314 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR5
) \

315 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

316 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

317 ((
__cÚ¡
 *è(
¤c
))[4] } }), \

318 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR6
) \

319 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

320 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

321 ((
__cÚ¡
 *è(
¤c
))[4], ((__const *) (src))[5] } }), \

322 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR7
) \

323 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

324 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

325 ((
__cÚ¡
 *è(
¤c
))[4], ((__const *) (src))[5], \

326 ((
__cÚ¡
 *è(
¤c
))[6] } }), \

327 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR8
) \

328 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

329 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

330 ((
__cÚ¡
 *è(
¤c
))[4], ((__const *) (src))[5], \

331 ((
__cÚ¡
 *è(
¤c
))[6], ((__cÚ¡ *è(¤c))[7] } })

	)

333 
__STRING_INLINE
 *
__mempıy_sm®l
 (*, , 
__STRING2_COPY_ARR2
,

334 
__STRING2_COPY_ARR3
,

335 
__STRING2_COPY_ARR4
,

336 
__STRING2_COPY_ARR5
,

337 
__STRING2_COPY_ARR6
,

338 
__STRING2_COPY_ARR7
,

339 
__STRING2_COPY_ARR8
, 
size_t
);

340 
__STRING_INLINE
 *

341 
	$__mempıy_sm®l
 (*
__de¡
, 
__¤c1
,

342 
__STRING2_COPY_ARR2
 
__¤c2
, 
__STRING2_COPY_ARR3
 
__¤c3
,

343 
__STRING2_COPY_ARR4
 
__¤c4
, 
__STRING2_COPY_ARR5
 
__¤c5
,

344 
__STRING2_COPY_ARR6
 
__¤c6
, 
__STRING2_COPY_ARR7
 
__¤c7
,

345 
__STRING2_COPY_ARR8
 
__¤c8
, 
size_t
 
__¤ş’
)

348 
__c
;

349 
__STRING2_COPY_ARR2
 
__sÿ2
;

350 
__STRING2_COPY_ARR3
 
__sÿ3
;

351 
__STRING2_COPY_ARR4
 
__sÿ4
;

352 
__STRING2_COPY_ARR5
 
__sÿ5
;

353 
__STRING2_COPY_ARR6
 
__sÿ6
;

354 
__STRING2_COPY_ARR7
 
__sÿ7
;

355 
__STRING2_COPY_ARR8
 
__sÿ8
;

356 } *
__u
 = 
__de¡
;

357 (è
__¤ş’
)

360 
__u
->
__c
 = 
__¤c1
;

363 
__ex‹nsiÚ__
 
__u
->
__sÿ2
 = 
__¤c2
;

366 
__ex‹nsiÚ__
 
__u
->
__sÿ3
 = 
__¤c3
;

369 
__ex‹nsiÚ__
 
__u
->
__sÿ4
 = 
__¤c4
;

372 
__ex‹nsiÚ__
 
__u
->
__sÿ5
 = 
__¤c5
;

375 
__ex‹nsiÚ__
 
__u
->
__sÿ6
 = 
__¤c6
;

378 
__ex‹nsiÚ__
 
__u
->
__sÿ7
 = 
__¤c7
;

381 
__ex‹nsiÚ__
 
__u
->
__sÿ8
 = 
__¤c8
;

384  
	`__ex‹nsiÚ__
 ((*è
__u
 + 
__¤ş’
);

385 
	}
}

393 #iâdeà
_HAVE_STRING_ARCH_¡rchr


394 *
__¿wmemchr
 (cÚ¡ *
__s
, 
__c
);

395 #ià
__GNUC_PREREQ
 (3, 2)

396 
	#¡rchr
(
s
, 
c
) \

397 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
c
è&& !__butš_cÚ¡ªt_°(
s
) \

398 && (
c
) == '\0' \

399 ? (*è
	`__¿wmemchr
 (
s
, 
c
) \

400 : 
	`__butš_¡rchr
 (
s
, 
c
)))

	)

402 
	#¡rchr
(
s
, 
c
) \

403 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
c
) && (c) == '\0' \

404 ? (*è
	`__¿wmemchr
 (
s
, 
c
) \

405 : 
	`¡rchr
 (
s
, 
c
)))

	)

411 #ià(!
defšed
 
_HAVE_STRING_ARCH_¡rıy
 && !
__GNUC_PREREQ
 (3, 0)) \

412 || 
defšed
 
	g_FORCE_INLINES


413 #ià!
defšed
 
_HAVE_STRING_ARCH_¡rıy
 && !
__GNUC_PREREQ
 (3, 0)

414 
	#¡rıy
(
de¡
, 
¤c
) \

415 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
¤c
) \

416 ? (
	`__¡ršg2_1b±r_p
 (
¤c
è&& 
	`¡¾’
 (src) + 1 <= 8 \

417 ? 
	`__¡rıy_sm®l
 (
de¡
, 
	`__¡rıy_¬gs
 (
¤c
), \

418 
	`¡¾’
 (
¤c
) + 1) \

419 : (*è
	`memıy
 (
de¡
, 
¤c
, 
	`¡¾’
 (src) + 1)) \

420 : 
	`¡rıy
 (
de¡
, 
¤c
)))

	)

423 #ià
_STRING_ARCH_uÇligÃd


424 #iâdeà
_FORCE_INLINES


425 
	#__¡rıy_¬gs
(
¤c
) \

426 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET16
 (
¤c
, 0), \

427 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET16
 (
¤c
, 4), \

428 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET32
 (
¤c
, 0), \

429 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET32
 (
¤c
, 4)

	)

431 
__STRING_INLINE
 *
__¡rıy_sm®l
 (*, 
__ušt16_t
, __uint16_t,

432 
__ušt32_t
, __ušt32_t, 
size_t
);

433 
__STRING_INLINE
 *

434 
	$__¡rıy_sm®l
 (*
__de¡
,

435 
__ušt16_t
 
__¤c0_2
, __ušt16_ˆ
__¤c4_2
,

436 
__ušt32_t
 
__¤c0_4
, __ušt32_ˆ
__¤c4_4
,

437 
size_t
 
__¤ş’
)

440 
__ušt32_t
 
__ui
;

441 
__ušt16_t
 
__usi
;

442 
__uc
;

443 } *
__u
 = (*è
__de¡
;

444 (è
__¤ş’
)

447 
__u
->
__uc
 = '\0';

450 
__u
->
__usi
 = 
__¤c0_2
;

453 
__u
->
__usi
 = 
__¤c0_2
;

454 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2);

455 
__u
->
__uc
 = '\0';

458 
__u
->
__ui
 = 
__¤c0_4
;

461 
__u
->
__ui
 = 
__¤c0_4
;

462 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

463 
__u
->
__uc
 = '\0';

466 
__u
->
__ui
 = 
__¤c0_4
;

467 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

468 
__u
->
__usi
 = 
__¤c4_2
;

471 
__u
->
__ui
 = 
__¤c0_4
;

472 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

473 
__u
->
__usi
 = 
__¤c4_2
;

474 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2);

475 
__u
->
__uc
 = '\0';

478 
__u
->
__ui
 = 
__¤c0_4
;

479 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

480 
__u
->
__ui
 = 
__¤c4_4
;

483  
__de¡
;

484 
	}
}

486 #iâdeà
_FORCE_INLINES


487 
	#__¡rıy_¬gs
(
¤c
) \

488 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR2
) \

489 { { ((
__cÚ¡
 *è(
¤c
))[0], '\0' } }), \

490 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR3
) \

491 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

493 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR4
) \

494 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

495 ((
__cÚ¡
 *è(
¤c
))[2], '\0' } }), \

496 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR5
) \

497 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

498 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

500 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR6
) \

501 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

502 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

503 ((
__cÚ¡
 *è(
¤c
))[4], '\0' } }), \

504 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR7
) \

505 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

506 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

507 ((
__cÚ¡
 *è(
¤c
))[4], ((__const *) (src))[5], \

509 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR8
) \

510 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

511 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

512 ((
__cÚ¡
 *è(
¤c
))[4], ((__const *) (src))[5], \

513 ((
__cÚ¡
 *è(
¤c
))[6], '\0' } })

	)

515 
__STRING_INLINE
 *
__¡rıy_sm®l
 (*, 
__STRING2_COPY_ARR2
,

516 
__STRING2_COPY_ARR3
,

517 
__STRING2_COPY_ARR4
,

518 
__STRING2_COPY_ARR5
,

519 
__STRING2_COPY_ARR6
,

520 
__STRING2_COPY_ARR7
,

521 
__STRING2_COPY_ARR8
, 
size_t
);

522 
__STRING_INLINE
 *

523 
	$__¡rıy_sm®l
 (*
__de¡
,

524 
__STRING2_COPY_ARR2
 
__¤c2
, 
__STRING2_COPY_ARR3
 
__¤c3
,

525 
__STRING2_COPY_ARR4
 
__¤c4
, 
__STRING2_COPY_ARR5
 
__¤c5
,

526 
__STRING2_COPY_ARR6
 
__¤c6
, 
__STRING2_COPY_ARR7
 
__¤c7
,

527 
__STRING2_COPY_ARR8
 
__¤c8
, 
size_t
 
__¤ş’
)

530 
__c
;

531 
__STRING2_COPY_ARR2
 
__sÿ2
;

532 
__STRING2_COPY_ARR3
 
__sÿ3
;

533 
__STRING2_COPY_ARR4
 
__sÿ4
;

534 
__STRING2_COPY_ARR5
 
__sÿ5
;

535 
__STRING2_COPY_ARR6
 
__sÿ6
;

536 
__STRING2_COPY_ARR7
 
__sÿ7
;

537 
__STRING2_COPY_ARR8
 
__sÿ8
;

538 } *
__u
 = (*è
__de¡
;

539 (è
__¤ş’
)

542 
__u
->
__c
 = '\0';

545 
__ex‹nsiÚ__
 
__u
->
__sÿ2
 = 
__¤c2
;

548 
__ex‹nsiÚ__
 
__u
->
__sÿ3
 = 
__¤c3
;

551 
__ex‹nsiÚ__
 
__u
->
__sÿ4
 = 
__¤c4
;

554 
__ex‹nsiÚ__
 
__u
->
__sÿ5
 = 
__¤c5
;

557 
__ex‹nsiÚ__
 
__u
->
__sÿ6
 = 
__¤c6
;

560 
__ex‹nsiÚ__
 
__u
->
__sÿ7
 = 
__¤c7
;

563 
__ex‹nsiÚ__
 
__u
->
__sÿ8
 = 
__¤c8
;

566  
__de¡
;

567 
	}
}

573 #ifdeà
__USE_GNU


574 #ià!
defšed
 
_HAVE_STRING_ARCH_¡pıy
 || defšed 
_FORCE_INLINES


575 #iâdeà
_HAVE_STRING_ARCH_¡pıy


576 #ià
__GNUC_PREREQ
 (3, 4)

577 
	#__¡pıy
(
de¡
, 
¤c
è
	`__butš_¡pıy
 (de¡, src)

	)

578 #–ià
__GNUC_PREREQ
 (3, 0)

579 
	#__¡pıy
(
de¡
, 
¤c
) \

580 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
¤c
) \

581 ? (
	`__¡ršg2_1b±r_p
 (
¤c
è&& 
	`¡¾’
 (src) + 1 <= 8 \

582 ? 
	`__butš_¡rıy
 (
de¡
, 
¤c
è+ 
	`¡¾’
 (src) \

583 : ((*è(
__mempıy
è(
de¡
, 
¤c
, 
	`¡¾’
 (src) + 1) \

585 : 
	`__¡pıy
 (
de¡
, 
¤c
)))

	)

587 
	#__¡pıy
(
de¡
, 
¤c
) \

588 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
¤c
) \

589 ? (
	`__¡ršg2_1b±r_p
 (
¤c
è&& 
	`¡¾’
 (src) + 1 <= 8 \

590 ? 
	`__¡pıy_sm®l
 (
de¡
, 
	`__¡pıy_¬gs
 (
¤c
), \

591 
	`¡¾’
 (
¤c
) + 1) \

592 : ((*è(
__mempıy
è(
de¡
, 
¤c
, 
	`¡¾’
 (src) + 1) \

594 : 
	`__¡pıy
 (
de¡
, 
¤c
)))

	)

598 
	#¡pıy
(
de¡
, 
¤c
è
	`__¡pıy
 (de¡, src)

	)

601 #ià!
__GNUC_PREREQ
 (3, 0è|| 
defšed
 
_FORCE_INLINES


602 #ià
_STRING_ARCH_uÇligÃd


603 #iâdeà
_FORCE_INLINES


604 
	#__¡pıy_¬gs
(
¤c
) \

605 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET16
 (
¤c
, 0), \

606 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET16
 (
¤c
, 4), \

607 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET32
 (
¤c
, 0), \

608 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET32
 (
¤c
, 4)

	)

610 
__STRING_INLINE
 *
__¡pıy_sm®l
 (*, 
__ušt16_t
, __uint16_t,

611 
__ušt32_t
, __ušt32_t, 
size_t
);

612 
__STRING_INLINE
 *

613 
	$__¡pıy_sm®l
 (*
__de¡
,

614 
__ušt16_t
 
__¤c0_2
, __ušt16_ˆ
__¤c4_2
,

615 
__ušt32_t
 
__¤c0_4
, __ušt32_ˆ
__¤c4_4
,

616 
size_t
 
__¤ş’
)

619 
__ui
;

620 
__usi
;

621 
__uc
;

622 
__c
;

623 } *
__u
 = (*è
__de¡
;

624 (è
__¤ş’
)

627 
__u
->
__uc
 = '\0';

630 
__u
->
__usi
 = 
__¤c0_2
;

631 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 1);

634 
__u
->
__usi
 = 
__¤c0_2
;

635 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2);

636 
__u
->
__uc
 = '\0';

639 
__u
->
__ui
 = 
__¤c0_4
;

640 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 3);

643 
__u
->
__ui
 = 
__¤c0_4
;

644 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

645 
__u
->
__uc
 = '\0';

648 
__u
->
__ui
 = 
__¤c0_4
;

649 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

650 
__u
->
__usi
 = 
__¤c4_2
;

651 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 1);

654 
__u
->
__ui
 = 
__¤c0_4
;

655 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

656 
__u
->
__usi
 = 
__¤c4_2
;

657 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2);

658 
__u
->
__uc
 = '\0';

661 
__u
->
__ui
 = 
__¤c0_4
;

662 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

663 
__u
->
__ui
 = 
__¤c4_4
;

664 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 3);

667  &
__u
->
__c
;

668 
	}
}

670 #iâdeà
_FORCE_INLINES


671 
	#__¡pıy_¬gs
(
¤c
) \

672 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR2
) \

673 { { ((
__cÚ¡
 *è(
¤c
))[0], '\0' } }), \

674 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR3
) \

675 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

677 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR4
) \

678 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

679 ((
__cÚ¡
 *è(
¤c
))[2], '\0' } }), \

680 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR5
) \

681 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

682 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

684 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR6
) \

685 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

686 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

687 ((
__cÚ¡
 *è(
¤c
))[4], '\0' } }), \

688 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR7
) \

689 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

690 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

691 ((
__cÚ¡
 *è(
¤c
))[4], ((__const *) (src))[5], \

693 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR8
) \

694 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

695 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

696 ((
__cÚ¡
 *è(
¤c
))[4], ((__const *) (src))[5], \

697 ((
__cÚ¡
 *è(
¤c
))[6], '\0' } })

	)

699 
__STRING_INLINE
 *
__¡pıy_sm®l
 (*, 
__STRING2_COPY_ARR2
,

700 
__STRING2_COPY_ARR3
,

701 
__STRING2_COPY_ARR4
,

702 
__STRING2_COPY_ARR5
,

703 
__STRING2_COPY_ARR6
,

704 
__STRING2_COPY_ARR7
,

705 
__STRING2_COPY_ARR8
, 
size_t
);

706 
__STRING_INLINE
 *

707 
	$__¡pıy_sm®l
 (*
__de¡
,

708 
__STRING2_COPY_ARR2
 
__¤c2
, 
__STRING2_COPY_ARR3
 
__¤c3
,

709 
__STRING2_COPY_ARR4
 
__¤c4
, 
__STRING2_COPY_ARR5
 
__¤c5
,

710 
__STRING2_COPY_ARR6
 
__¤c6
, 
__STRING2_COPY_ARR7
 
__¤c7
,

711 
__STRING2_COPY_ARR8
 
__¤c8
, 
size_t
 
__¤ş’
)

714 
__c
;

715 
__STRING2_COPY_ARR2
 
__sÿ2
;

716 
__STRING2_COPY_ARR3
 
__sÿ3
;

717 
__STRING2_COPY_ARR4
 
__sÿ4
;

718 
__STRING2_COPY_ARR5
 
__sÿ5
;

719 
__STRING2_COPY_ARR6
 
__sÿ6
;

720 
__STRING2_COPY_ARR7
 
__sÿ7
;

721 
__STRING2_COPY_ARR8
 
__sÿ8
;

722 } *
__u
 = (*è
__de¡
;

723 (è
__¤ş’
)

726 
__u
->
__c
 = '\0';

729 
__ex‹nsiÚ__
 
__u
->
__sÿ2
 = 
__¤c2
;

732 
__ex‹nsiÚ__
 
__u
->
__sÿ3
 = 
__¤c3
;

735 
__ex‹nsiÚ__
 
__u
->
__sÿ4
 = 
__¤c4
;

738 
__ex‹nsiÚ__
 
__u
->
__sÿ5
 = 
__¤c5
;

741 
__ex‹nsiÚ__
 
__u
->
__sÿ6
 = 
__¤c6
;

744 
__ex‹nsiÚ__
 
__u
->
__sÿ7
 = 
__¤c7
;

747 
__ex‹nsiÚ__
 
__u
->
__sÿ8
 = 
__¤c8
;

750  
__de¡
 + 
__¤ş’
 - 1;

751 
	}
}

759 #iâdeà
_HAVE_STRING_ARCH_¡ºıy


760 #ià
__GNUC_PREREQ
 (3, 2)

761 
	#¡ºıy
(
de¡
, 
¤c
, 
n
è
	`__butš_¡ºıy
 (de¡, src,‚)

	)

763 
	#¡ºıy
(
de¡
, 
¤c
, 
n
) \

764 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
¤c
è&& __butš_cÚ¡ªt_°(
n
) \

765 ? (
	`¡¾’
 (
¤c
è+ 1 >ğ((
size_t
è(
n
)) \

766 ? (*è
	`memıy
 (
de¡
, 
¤c
, 
n
) \

767 : 
	`¡ºıy
 (
de¡
, 
¤c
, 
n
)) \

768 : 
	`¡ºıy
 (
de¡
, 
¤c
, 
n
)))

	)

774 #iâdeà
_HAVE_STRING_ARCH_¡ºÿt


775 #ifdeà
_USE_STRING_ARCH_¡rchr


776 
	#¡ºÿt
(
de¡
, 
¤c
, 
n
) \

777 (
	`__ex‹nsiÚ__
 ({ *
__de¡
 = (
de¡
); \

778 
	`__butš_cÚ¡ªt_p
 (
¤c
è&& __butš_cÚ¡ªt_°(
n
) \

779 ? (
	`¡¾’
 (
¤c
è< ((
size_t
è(
n
)) \

780 ? 
	`¡rÿt
 (
__de¡
, 
¤c
) \

781 : (*((*è
	`__mempıy
 (
	`¡rchr
 (
__de¡
, '\0'), \

782 
¤c
, 
n
)èğ'\0', 
__de¡
)) \

783 : 
	`¡ºÿt
 (
de¡
, 
¤c
, 
n
); }))

	)

784 #–ià
__GNUC_PREREQ
 (3, 2)

785 
	#¡ºÿt
(
de¡
, 
¤c
, 
n
è
	`__butš_¡ºÿt
 (de¡, src,‚)

	)

787 
	#¡ºÿt
(
de¡
, 
¤c
, 
n
) \

788 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
¤c
è&& __butš_cÚ¡ªt_°(
n
) \

789 ? (
	`¡¾’
 (
¤c
è< ((
size_t
è(
n
)) \

790 ? 
	`¡rÿt
 (
de¡
, 
¤c
) \

791 : 
	`¡ºÿt
 (
de¡
, 
¤c
, 
n
)) \

792 : 
	`¡ºÿt
 (
de¡
, 
¤c
, 
n
)))

	)

798 #iâdeà
_HAVE_STRING_ARCH_¡rcmp


799 #ià
__GNUC_PREREQ
 (3, 2)

800 
	#¡rcmp
(
s1
, 
s2
) \

801 
__ex‹nsiÚ__
 \

802 ({ 
size_t
 
__s1_Ën
, 
__s2_Ën
; \

803 (
	`__butš_cÚ¡ªt_p
 (
s1
è&& __butš_cÚ¡ªt_°(
s2
) \

804 && (
__s1_Ën
 = 
	`__butš_¡¾’
 (
s1
), 
__s2_Ën
 = __butš_¡¾’ (
s2
), \

805 (!
	`__¡ršg2_1b±r_p
 (
s1
è|| 
__s1_Ën
 >= 4) \

806 && (!
	`__¡ršg2_1b±r_p
 (
s2
è|| 
__s2_Ën
 >= 4)) \

807 ? 
	`__butš_¡rcmp
 (
s1
, 
s2
) \

808 : (
	`__butš_cÚ¡ªt_p
 (
s1
è&& 
	`__¡ršg2_1b±r_p
 (s1) \

809 && (
__s1_Ën
 = 
	`__butš_¡¾’
 (
s1
), __s1_len < 4) \

810 ? (
	`__butš_cÚ¡ªt_p
 (
s2
è&& 
	`__¡ršg2_1b±r_p
 (s2) \

811 ? 
	`__butš_¡rcmp
 (
s1
, 
s2
) \

812 : 
	`__¡rcmp_cg
 (
s1
, 
s2
, 
__s1_Ën
)) \

813 : (
	`__butš_cÚ¡ªt_p
 (
s2
è&& 
	`__¡ršg2_1b±r_p
 (s2) \

814 && (
__s2_Ën
 = 
	`__butš_¡¾’
 (
s2
), __s2_len < 4) \

815 ? (
	`__butš_cÚ¡ªt_p
 (
s1
è&& 
	`__¡ršg2_1b±r_p
 (s1) \

816 ? 
	`__butš_¡rcmp
 (
s1
, 
s2
) \

817 : 
	`__¡rcmp_gc
 (
s1
, 
s2
, 
__s2_Ën
)) \

818 : 
	`__butš_¡rcmp
 (
s1
, 
s2
)))); })

	)

820 
	#¡rcmp
(
s1
, 
s2
) \

821 
__ex‹nsiÚ__
 \

822 ({ 
size_t
 
__s1_Ën
, 
__s2_Ën
; \

823 (
	`__butš_cÚ¡ªt_p
 (
s1
è&& __butš_cÚ¡ªt_°(
s2
) \

824 && (
__s1_Ën
 = 
	`¡¾’
 (
s1
), 
__s2_Ën
 = sŒËÀ(
s2
), \

825 (!
	`__¡ršg2_1b±r_p
 (
s1
è|| 
__s1_Ën
 >= 4) \

826 && (!
	`__¡ršg2_1b±r_p
 (
s2
è|| 
__s2_Ën
 >= 4)) \

827 ? 
	`memcmp
 ((
__cÚ¡
 *è(
s1
), (__cÚ¡ *è(
s2
), \

828 (
__s1_Ën
 < 
__s2_Ën
 ? __s1_len : __s2_len) + 1) \

829 : (
	`__butš_cÚ¡ªt_p
 (
s1
è&& 
	`__¡ršg2_1b±r_p
 (s1) \

830 && (
__s1_Ën
 = 
	`¡¾’
 (
s1
), __s1_len < 4) \

831 ? (
	`__butš_cÚ¡ªt_p
 (
s2
è&& 
	`__¡ršg2_1b±r_p
 (s2) \

832 ? 
	`__¡rcmp_cc
 (
s1
, 
s2
, 
__s1_Ën
) \

833 : 
	`__¡rcmp_cg
 (
s1
, 
s2
, 
__s1_Ën
)) \

834 : (
	`__butš_cÚ¡ªt_p
 (
s2
è&& 
	`__¡ršg2_1b±r_p
 (s2) \

835 && (
__s2_Ën
 = 
	`¡¾’
 (
s2
), __s2_len < 4) \

836 ? (
	`__butš_cÚ¡ªt_p
 (
s1
è&& 
	`__¡ršg2_1b±r_p
 (s1) \

837 ? 
	`__¡rcmp_cc
 (
s1
, 
s2
, 
__s2_Ën
) \

838 : 
	`__¡rcmp_gc
 (
s1
, 
s2
, 
__s2_Ën
)) \

839 : 
	`¡rcmp
 (
s1
, 
s2
)))); })

	)

842 
	#__¡rcmp_cc
(
s1
, 
s2
, 
l
) \

843 (
	`__ex‹nsiÚ__
 ({ 
__»suÉ
 = \

844 (((
__cÚ¡
 *è(__cÚ¡ *è(
s1
))[0] \

845 - ((
__cÚ¡
 *è(__cÚ¡ *)(
s2
))[0]);\

846 ià(
l
 > 0 && 
__»suÉ
 == 0) \

848 
__»suÉ
 = (((
__cÚ¡
 *) \

849 (
__cÚ¡
 *è(
s1
))[1] \

850 - ((
__cÚ¡
 *) \

851 (
__cÚ¡
 *è(
s2
))[1]); \

852 ià(
l
 > 1 && 
__»suÉ
 == 0) \

854 
__»suÉ
 = \

855 (((
__cÚ¡
 *) \

856 (
__cÚ¡
 *è(
s1
))[2] \

857 - ((
__cÚ¡
 *) \

858 (
__cÚ¡
 *è(
s2
))[2]); \

859 ià(
l
 > 2 && 
__»suÉ
 == 0) \

860 
__»suÉ
 = \

861 (((
__cÚ¡
 *) \

862 (
__cÚ¡
 *è(
s1
))[3] \

863 - ((
__cÚ¡
 *) \

864 (
__cÚ¡
 *è(
s2
))[3]); \

867 
__»suÉ
; }))

	)

869 
	#__¡rcmp_cg
(
s1
, 
s2
, 
l1
) \

870 (
	`__ex‹nsiÚ__
 ({ 
__cÚ¡
 *
__s2
 = \

871 (
__cÚ¡
 *è(__cÚ¡ *è(
s2
); \

872 
__»suÉ
 = \

873 (((
__cÚ¡
 *è(__cÚ¡ *è(
s1
))[0] \

874 - 
__s2
[0]); \

875 ià(
l1
 > 0 && 
__»suÉ
 == 0) \

877 
__»suÉ
 = (((
__cÚ¡
 *) \

878 (
__cÚ¡
 *è(
s1
))[1] - 
__s2
[1]); \

879 ià(
l1
 > 1 && 
__»suÉ
 == 0) \

881 
__»suÉ
 = (((
__cÚ¡
 *) \

882 (
__cÚ¡
 *è(
s1
))[2] - 
__s2
[2]);\

883 ià(
l1
 > 2 && 
__»suÉ
 == 0) \

884 
__»suÉ
 = (((
__cÚ¡
 *) \

885 (
__cÚ¡
 *è(
s1
))[3] \

886 - 
__s2
[3]); \

889 
__»suÉ
; }))

	)

891 
	#__¡rcmp_gc
(
s1
, 
s2
, 
l2
) \

892 (
	`__ex‹nsiÚ__
 ({ 
__cÚ¡
 *
__s1
 = \

893 (
__cÚ¡
 *è(__cÚ¡ *è(
s1
); \

894 
__»suÉ
 = \

895 
__s1
[0] - ((
__cÚ¡
 *) \

896 (
__cÚ¡
 *è(
s2
))[0]; \

897 ià(
l2
 > 0 && 
__»suÉ
 == 0) \

899 
__»suÉ
 = (
__s1
[1] \

900 - ((
__cÚ¡
 *) \

901 (
__cÚ¡
 *è(
s2
))[1]); \

902 ià(
l2
 > 1 && 
__»suÉ
 == 0) \

904 
__»suÉ
 = \

905 (
__s1
[2] - ((
__cÚ¡
 *) \

906 (
__cÚ¡
 *è(
s2
))[2]); \

907 ià(
l2
 > 2 && 
__»suÉ
 == 0) \

908 
__»suÉ
 = \

909 (
__s1
[3] \

910 - ((
__cÚ¡
 *) \

911 (
__cÚ¡
 *è(
s2
))[3]); \

914 
__»suÉ
; }))

	)

919 #iâdeà
_HAVE_STRING_ARCH_¡ºcmp


920 
	#¡ºcmp
(
s1
, 
s2
, 
n
) \

921 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
n
) \

922 && ((
	`__butš_cÚ¡ªt_p
 (
s1
) \

923 && 
	`¡¾’
 (
s1
è< ((
size_t
è(
n
))) \

924 || (
	`__butš_cÚ¡ªt_p
 (
s2
) \

925 && 
	`¡¾’
 (
s2
è< ((
size_t
è(
n
)))) \

926 ? 
	`¡rcmp
 (
s1
, 
s2
è: 
	`¡ºcmp
 (s1, s2, 
n
)))

	)

932 #ià!
defšed
 
_HAVE_STRING_ARCH_¡rc¥n
 || defšed 
_FORCE_INLINES


933 #iâdeà
_HAVE_STRING_ARCH_¡rc¥n


934 #ià
__GNUC_PREREQ
 (3, 2)

935 
	#¡rc¥n
(
s
, 
»jeù
) \

936 
__ex‹nsiÚ__
 \

937 ({ 
__r0
, 
__r1
, 
__r2
; \

938 (
	`__butš_cÚ¡ªt_p
 (
»jeù
è&& 
	`__¡ršg2_1b±r_p
 (reject) \

939 ? ((
	`__butš_cÚ¡ªt_p
 (
s
è&& 
	`__¡ršg2_1b±r_p
 (s)) \

940 ? 
	`__butš_¡rc¥n
 (
s
, 
»jeù
) \

941 : ((
__r0
 = ((
__cÚ¡
 *è(
»jeù
))[0], __r0 == '\0') \

942 ? 
	`¡¾’
 (
s
) \

943 : ((
__r1
 = ((
__cÚ¡
 *è(
»jeù
))[1], __r1 == '\0') \

944 ? 
	`__¡rc¥n_c1
 (
s
, 
__r0
) \

945 : ((
__r2
 = ((
__cÚ¡
 *è(
»jeù
))[2], __r2 == '\0') \

946 ? 
	`__¡rc¥n_c2
 (
s
, 
__r0
, 
__r1
) \

947 : (((
__cÚ¡
 *è(
»jeù
))[3] == '\0' \

948 ? 
	`__¡rc¥n_c3
 (
s
, 
__r0
, 
__r1
, 
__r2
) \

949 : 
	`__butš_¡rc¥n
 (
s
, 
»jeù
)))))) \

950 : 
	`__butš_¡rc¥n
 (
s
, 
»jeù
)); })

	)

952 
	#¡rc¥n
(
s
, 
»jeù
) \

953 
__ex‹nsiÚ__
 \

954 ({ 
__r0
, 
__r1
, 
__r2
; \

955 (
	`__butš_cÚ¡ªt_p
 (
»jeù
è&& 
	`__¡ršg2_1b±r_p
 (reject) \

956 ? ((
__r0
 = ((
__cÚ¡
 *è(
»jeù
))[0], __r0 == '\0') \

957 ? 
	`¡¾’
 (
s
) \

958 : ((
__r1
 = ((
__cÚ¡
 *è(
»jeù
))[1], __r1 == '\0') \

959 ? 
	`__¡rc¥n_c1
 (
s
, 
__r0
) \

960 : ((
__r2
 = ((
__cÚ¡
 *è(
»jeù
))[2], __r2 == '\0') \

961 ? 
	`__¡rc¥n_c2
 (
s
, 
__r0
, 
__r1
) \

962 : (((
__cÚ¡
 *è(
»jeù
))[3] == '\0' \

963 ? 
	`__¡rc¥n_c3
 (
s
, 
__r0
, 
__r1
, 
__r2
) \

964 : 
	`¡rc¥n
 (
s
, 
»jeù
))))) \

965 : 
	`¡rc¥n
 (
s
, 
»jeù
)); })

	)

969 
__STRING_INLINE
 
size_t
 
__¡rc¥n_c1
 (
__cÚ¡
 *
__s
, 
__»jeù
);

970 
__STRING_INLINE
 
size_t


971 
	$__¡rc¥n_c1
 (
__cÚ¡
 *
__s
, 
__»jeù
)

973 
size_t
 
__»suÉ
 = 0;

974 
__s
[
__»suÉ
] !ğ'\0' && __s[__»suÉ] !ğ
__»jeù
)

975 ++
__»suÉ
;

976  
__»suÉ
;

977 
	}
}

979 
__STRING_INLINE
 
size_t
 
__¡rc¥n_c2
 (
__cÚ¡
 *
__s
, 
__»jeù1
,

980 
__»jeù2
);

981 
__STRING_INLINE
 
size_t


982 
	$__¡rc¥n_c2
 (
__cÚ¡
 *
__s
, 
__»jeù1
, 
__»jeù2
)

984 
size_t
 
__»suÉ
 = 0;

985 
__s
[
__»suÉ
] !ğ'\0' && __s[__»suÉ] !ğ
__»jeù1


986 && 
__s
[
__»suÉ
] !ğ
__»jeù2
)

987 ++
__»suÉ
;

988  
__»suÉ
;

989 
	}
}

991 
__STRING_INLINE
 
size_t
 
__¡rc¥n_c3
 (
__cÚ¡
 *
__s
, 
__»jeù1
,

992 
__»jeù2
, 
__»jeù3
);

993 
__STRING_INLINE
 
size_t


994 
	$__¡rc¥n_c3
 (
__cÚ¡
 *
__s
, 
__»jeù1
, 
__»jeù2
,

995 
__»jeù3
)

997 
size_t
 
__»suÉ
 = 0;

998 
__s
[
__»suÉ
] !ğ'\0' && __s[__»suÉ] !ğ
__»jeù1


999 && 
__s
[
__»suÉ
] !ğ
__»jeù2
 && __s[__»suÉ] !ğ
__»jeù3
)

1000 ++
__»suÉ
;

1001  
__»suÉ
;

1002 
	}
}

1008 #ià!
defšed
 
_HAVE_STRING_ARCH_¡r¥n
 || defšed 
_FORCE_INLINES


1009 #iâdeà
_HAVE_STRING_ARCH_¡r¥n


1010 #ià
__GNUC_PREREQ
 (3, 2)

1011 
	#¡r¥n
(
s
, 
acû±
) \

1012 
__ex‹nsiÚ__
 \

1013 ({ 
__a0
, 
__a1
, 
__a2
; \

1014 (
	`__butš_cÚ¡ªt_p
 (
acû±
è&& 
	`__¡ršg2_1b±r_p
 (accept) \

1015 ? ((
	`__butš_cÚ¡ªt_p
 (
s
è&& 
	`__¡ršg2_1b±r_p
 (s)) \

1016 ? 
	`__butš_¡r¥n
 (
s
, 
acû±
) \

1017 : ((
__a0
 = ((
__cÚ¡
 *è(
acû±
))[0], __a0 == '\0') \

1018 ? ((è(
s
), 0) \

1019 : ((
__a1
 = ((
__cÚ¡
 *è(
acû±
))[1], __a1 == '\0') \

1020 ? 
	`__¡r¥n_c1
 (
s
, 
__a0
) \

1021 : ((
__a2
 = ((
__cÚ¡
 *è(
acû±
))[2], __a2 == '\0') \

1022 ? 
	`__¡r¥n_c2
 (
s
, 
__a0
, 
__a1
) \

1023 : (((
__cÚ¡
 *è(
acû±
))[3] == '\0' \

1024 ? 
	`__¡r¥n_c3
 (
s
, 
__a0
, 
__a1
, 
__a2
) \

1025 : 
	`__butš_¡r¥n
 (
s
, 
acû±
)))))) \

1026 : 
	`__butš_¡r¥n
 (
s
, 
acû±
)); })

	)

1028 
	#¡r¥n
(
s
, 
acû±
) \

1029 
__ex‹nsiÚ__
 \

1030 ({ 
__a0
, 
__a1
, 
__a2
; \

1031 (
	`__butš_cÚ¡ªt_p
 (
acû±
è&& 
	`__¡ršg2_1b±r_p
 (accept) \

1032 ? ((
__a0
 = ((
__cÚ¡
 *è(
acû±
))[0], __a0 == '\0') \

1033 ? ((è(
s
), 0) \

1034 : ((
__a1
 = ((
__cÚ¡
 *è(
acû±
))[1], __a1 == '\0') \

1035 ? 
	`__¡r¥n_c1
 (
s
, 
__a0
) \

1036 : ((
__a2
 = ((
__cÚ¡
 *è(
acû±
))[2], __a2 == '\0') \

1037 ? 
	`__¡r¥n_c2
 (
s
, 
__a0
, 
__a1
) \

1038 : (((
__cÚ¡
 *è(
acû±
))[3] == '\0' \

1039 ? 
	`__¡r¥n_c3
 (
s
, 
__a0
, 
__a1
, 
__a2
) \

1040 : 
	`¡r¥n
 (
s
, 
acû±
))))) \

1041 : 
	`¡r¥n
 (
s
, 
acû±
)); })

	)

1045 
__STRING_INLINE
 
size_t
 
__¡r¥n_c1
 (
__cÚ¡
 *
__s
, 
__acû±
);

1046 
__STRING_INLINE
 
size_t


1047 
	$__¡r¥n_c1
 (
__cÚ¡
 *
__s
, 
__acû±
)

1049 
size_t
 
__»suÉ
 = 0;

1051 
__s
[
__»suÉ
] =ğ
__acû±
)

1052 ++
__»suÉ
;

1053  
__»suÉ
;

1054 
	}
}

1056 
__STRING_INLINE
 
size_t
 
__¡r¥n_c2
 (
__cÚ¡
 *
__s
, 
__acû±1
,

1057 
__acû±2
);

1058 
__STRING_INLINE
 
size_t


1059 
	$__¡r¥n_c2
 (
__cÚ¡
 *
__s
, 
__acû±1
, 
__acû±2
)

1061 
size_t
 
__»suÉ
 = 0;

1063 
__s
[
__»suÉ
] =ğ
__acû±1
 || __s[__»suÉ] =ğ
__acû±2
)

1064 ++
__»suÉ
;

1065  
__»suÉ
;

1066 
	}
}

1068 
__STRING_INLINE
 
size_t
 
__¡r¥n_c3
 (
__cÚ¡
 *
__s
, 
__acû±1
,

1069 
__acû±2
, 
__acû±3
);

1070 
__STRING_INLINE
 
size_t


1071 
	$__¡r¥n_c3
 (
__cÚ¡
 *
__s
, 
__acû±1
, 
__acû±2
, 
__acû±3
)

1073 
size_t
 
__»suÉ
 = 0;

1075 
__s
[
__»suÉ
] =ğ
__acû±1
 || __s[__»suÉ] =ğ
__acû±2


1076 || 
__s
[
__»suÉ
] =ğ
__acû±3
)

1077 ++
__»suÉ
;

1078  
__»suÉ
;

1079 
	}
}

1084 #ià!
defšed
 
_HAVE_STRING_ARCH_¡½brk
 || defšed 
_FORCE_INLINES


1085 #iâdeà
_HAVE_STRING_ARCH_¡½brk


1086 #ià
__GNUC_PREREQ
 (3, 2)

1087 
	#¡½brk
(
s
, 
acû±
) \

1088 
__ex‹nsiÚ__
 \

1089 ({ 
__a0
, 
__a1
, 
__a2
; \

1090 (
	`__butš_cÚ¡ªt_p
 (
acû±
è&& 
	`__¡ršg2_1b±r_p
 (accept) \

1091 ? ((
	`__butš_cÚ¡ªt_p
 (
s
è&& 
	`__¡ršg2_1b±r_p
 (s)) \

1092 ? 
	`__butš_¡½brk
 (
s
, 
acû±
) \

1093 : ((
__a0
 = ((
__cÚ¡
 *è(
acû±
))[0], __a0 == '\0') \

1094 ? ((è(
s
), (*è
NULL
) \

1095 : ((
__a1
 = ((
__cÚ¡
 *è(
acû±
))[1], __a1 == '\0') \

1096 ? 
	`__butš_¡rchr
 (
s
, 
__a0
) \

1097 : ((
__a2
 = ((
__cÚ¡
 *è(
acû±
))[2], __a2 == '\0') \

1098 ? 
	`__¡½brk_c2
 (
s
, 
__a0
, 
__a1
) \

1099 : (((
__cÚ¡
 *è(
acû±
))[3] == '\0' \

1100 ? 
	`__¡½brk_c3
 (
s
, 
__a0
, 
__a1
, 
__a2
) \

1101 : 
	`__butš_¡½brk
 (
s
, 
acû±
)))))) \

1102 : 
	`__butš_¡½brk
 (
s
, 
acû±
)); })

	)

1104 
	#¡½brk
(
s
, 
acû±
) \

1105 
__ex‹nsiÚ__
 \

1106 ({ 
__a0
, 
__a1
, 
__a2
; \

1107 (
	`__butš_cÚ¡ªt_p
 (
acû±
è&& 
	`__¡ršg2_1b±r_p
 (accept) \

1108 ? ((
__a0
 = ((
__cÚ¡
 *è(
acû±
))[0], __a0 == '\0') \

1109 ? ((è(
s
), (*è
NULL
) \

1110 : ((
__a1
 = ((
__cÚ¡
 *è(
acû±
))[1], __a1 == '\0') \

1111 ? 
	`¡rchr
 (
s
, 
__a0
) \

1112 : ((
__a2
 = ((
__cÚ¡
 *è(
acû±
))[2], __a2 == '\0') \

1113 ? 
	`__¡½brk_c2
 (
s
, 
__a0
, 
__a1
) \

1114 : (((
__cÚ¡
 *è(
acû±
))[3] == '\0' \

1115 ? 
	`__¡½brk_c3
 (
s
, 
__a0
, 
__a1
, 
__a2
) \

1116 : 
	`¡½brk
 (
s
, 
acû±
))))) \

1117 : 
	`¡½brk
 (
s
, 
acû±
)); })

	)

1121 
__STRING_INLINE
 *
__¡½brk_c2
 (
__cÚ¡
 *
__s
, 
__acû±1
,

1122 
__acû±2
);

1123 
__STRING_INLINE
 *

1124 
	$__¡½brk_c2
 (
__cÚ¡
 *
__s
, 
__acû±1
, 
__acû±2
)

1127 *
__s
 !ğ'\0' && *__ !ğ
__acû±1
 && *__ !ğ
__acû±2
)

1128 ++
__s
;

1129  *
__s
 =ğ'\0' ? 
NULL
 : (*è(
size_t
) __s;

1130 
	}
}

1132 
__STRING_INLINE
 *
__¡½brk_c3
 (
__cÚ¡
 *
__s
, 
__acû±1
,

1133 
__acû±2
, 
__acû±3
);

1134 
__STRING_INLINE
 *

1135 
	$__¡½brk_c3
 (
__cÚ¡
 *
__s
, 
__acû±1
, 
__acû±2
,

1136 
__acû±3
)

1139 *
__s
 !ğ'\0' && *__ !ğ
__acû±1
 && *__ !ğ
__acû±2


1140 && *
__s
 !ğ
__acû±3
)

1141 ++
__s
;

1142  *
__s
 =ğ'\0' ? 
NULL
 : (*è(
size_t
) __s;

1143 
	}
}

1149 #ià!
defšed
 
_HAVE_STRING_ARCH_¡r¡r
 && !
__GNUC_PREREQ
 (2, 97)

1150 
	#¡r¡r
(
hay¡ack
, 
ÃedË
) \

1151 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
ÃedË
è&& 
	`__¡ršg2_1b±r_p
 (needle) \

1152 ? (((
__cÚ¡
 *è(
ÃedË
))[0] == '\0' \

1153 ? (*è(
size_t
è(
hay¡ack
) \

1154 : (((
__cÚ¡
 *è(
ÃedË
))[1] == '\0' \

1155 ? 
	`¡rchr
 (
hay¡ack
, \

1156 ((
__cÚ¡
 *è(
ÃedË
))[0]) \

1157 : 
	`¡r¡r
 (
hay¡ack
, 
ÃedË
))) \

1158 : 
	`¡r¡r
 (
hay¡ack
, 
ÃedË
)))

	)

1162 #ià!
defšed
 
_HAVE_STRING_ARCH_¡¹ok_r
 || defšed 
_FORCE_INLINES


1163 #iâdeà
_HAVE_STRING_ARCH_¡¹ok_r


1164 
	#__¡¹ok_r
(
s
, 
£p
, 
Ãx
) \

1165 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
£p
è&& 
	`__¡ršg2_1b±r_p
 (sep) \

1166 && ((
__cÚ¡
 *è(
£p
))[0] != '\0' \

1167 && ((
__cÚ¡
 *è(
£p
))[1] == '\0' \

1168 ? 
	`__¡¹ok_r_1c
 (
s
, ((
__cÚ¡
 *è(
£p
))[0], 
Ãx
) \

1169 : 
	`__¡¹ok_r
 (
s
, 
£p
, 
Ãx
)))

	)

1172 
__STRING_INLINE
 *
__¡¹ok_r_1c
 (*
__s
, 
__£p
, **
__Ãx
);

1173 
__STRING_INLINE
 *

1174 
	$__¡¹ok_r_1c
 (*
__s
, 
__£p
, **
__Ãx
)

1176 *
__»suÉ
;

1177 ià(
__s
 =ğ
NULL
)

1178 
__s
 = *
__Ãx
;

1179 *
__s
 =ğ
__£p
)

1180 ++
__s
;

1181 
__»suÉ
 = 
NULL
;

1182 ià(*
__s
 != '\0')

1184 
__»suÉ
 = 
__s
++;

1185 *
__s
 != '\0')

1186 ià(*
__s
++ =ğ
__£p
)

1188 
__s
[-1] = '\0';

1192 *
__Ãx
 = 
__s
;

1193  
__»suÉ
;

1194 
	}
}

1195 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


1196 
	#¡¹ok_r
(
s
, 
£p
, 
Ãx
è
	`__¡¹ok_r
 (s, s•,‚ex)

	)

1201 #ià!
defšed
 
_HAVE_STRING_ARCH_¡r£p
 || defšed 
_FORCE_INLINES


1202 #iâdeà
_HAVE_STRING_ARCH_¡r£p


1204 *
__¡r£p_g
 (**
__¡ršgp
, 
__cÚ¡
 *
__d–im
);

1205 
	#__¡r£p
(
s
, 
»jeù
) \

1206 
__ex‹nsiÚ__
 \

1207 ({ 
__r0
, 
__r1
, 
__r2
; \

1208 (
	`__butš_cÚ¡ªt_p
 (
»jeù
è&& 
	`__¡ršg2_1b±r_p
 (reject) \

1209 && (
__r0
 = ((
__cÚ¡
 *è(
»jeù
))[0], \

1210 ((
__cÚ¡
 *è(
»jeù
))[0] != '\0') \

1211 ? ((
__r1
 = ((
__cÚ¡
 *è(
»jeù
))[1], \

1212 ((
__cÚ¡
 *è(
»jeù
))[1] == '\0') \

1213 ? 
	`__¡r£p_1c
 (
s
, 
__r0
) \

1214 : ((
__r2
 = ((
__cÚ¡
 *è(
»jeù
))[2], __r2 == '\0') \

1215 ? 
	`__¡r£p_2c
 (
s
, 
__r0
, 
__r1
) \

1216 : (((
__cÚ¡
 *è(
»jeù
))[3] == '\0' \

1217 ? 
	`__¡r£p_3c
 (
s
, 
__r0
, 
__r1
, 
__r2
) \

1218 : 
	`__¡r£p_g
 (
s
, 
»jeù
)))) \

1219 : 
	`__¡r£p_g
 (
s
, 
»jeù
)); })

	)

1222 
__STRING_INLINE
 *
__¡r£p_1c
 (**
__s
, 
__»jeù
);

1223 
__STRING_INLINE
 *

1224 
	$__¡r£p_1c
 (**
__s
, 
__»jeù
)

1226 *
__»tv®
 = *
__s
;

1227 ià(
__»tv®
 !ğ
NULL
 && (*
__s
 = 
	`¡rchr
 (__»tv®, 
__»jeù
)) != NULL)

1228 *(*
__s
)++ = '\0';

1229  
__»tv®
;

1230 
	}
}

1232 
__STRING_INLINE
 *
__¡r£p_2c
 (**
__s
, 
__»jeù1
, 
__»jeù2
);

1233 
__STRING_INLINE
 *

1234 
	$__¡r£p_2c
 (**
__s
, 
__»jeù1
, 
__»jeù2
)

1236 *
__»tv®
 = *
__s
;

1237 ià(
__»tv®
 !ğ
NULL
)

1239 *
__ı
 = 
__»tv®
;

1242 ià(*
__ı
 == '\0')

1244 
__ı
 = 
NULL
;

1247 ià(*
__ı
 =ğ
__»jeù1
 || *__ı =ğ
__»jeù2
)

1249 *
__ı
++ = '\0';

1252 ++
__ı
;

1254 *
__s
 = 
__ı
;

1256  
__»tv®
;

1257 
	}
}

1259 
__STRING_INLINE
 *
__¡r£p_3c
 (**
__s
, 
__»jeù1
, 
__»jeù2
,

1260 
__»jeù3
);

1261 
__STRING_INLINE
 *

1262 
	$__¡r£p_3c
 (**
__s
, 
__»jeù1
, 
__»jeù2
, 
__»jeù3
)

1264 *
__»tv®
 = *
__s
;

1265 ià(
__»tv®
 !ğ
NULL
)

1267 *
__ı
 = 
__»tv®
;

1270 ià(*
__ı
 == '\0')

1272 
__ı
 = 
NULL
;

1275 ià(*
__ı
 =ğ
__»jeù1
 || *__ı =ğ
__»jeù2
 || *__ı =ğ
__»jeù3
)

1277 *
__ı
++ = '\0';

1280 ++
__ı
;

1282 *
__s
 = 
__ı
;

1284  
__»tv®
;

1285 
	}
}

1286 #ifdeà
__USE_BSD


1287 
	#¡r£p
(
s
, 
»jeù
è
	`__¡r£p
 (s,„ejeù)

	)

1294 #ifdeà
__USE_MISC


1296 #ià!
defšed
 
_HAVE_STRING_ARCH_¡rdup
 || !defšed 
_HAVE_STRING_ARCH_¡ºdup


1297 
	#__Ãed_m®loc_ªd_ÿÎoc


	)

1298 
	~<¡dlib.h
>

1301 #iâdeà
_HAVE_STRING_ARCH_¡rdup


1303 *
	$__¡rdup
 (
__cÚ¡
 *
__¡ršg
è
__THROW
 
__©Œibu‹_m®loc__
;

1304 
	#__¡rdup
(
s
) \

1305 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
s
è&& 
	`__¡ršg2_1b±r_p
 (s) \

1306 ? (((
__cÚ¡
 *è(
s
))[0] == '\0' \

1307 ? (*è
	`ÿÎoc
 ((
size_t
) 1, (size_t) 1) \

1308 : ({ 
size_t
 
__Ën
 = 
	`¡¾’
 (
s
) + 1; \

1309 *
__»tv®
 = (*è
	`m®loc
 (
__Ën
); \

1310 ià(
__»tv®
 !ğ
NULL
) \

1311 
__»tv®
 = (*è
	`memıy
 (__»tv®, 
s
, 
__Ën
); \

1312 
__»tv®
; 
	}
})) \

1313 : 
	`__¡rdup
 (
s
)))

	)

1315 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


1316 
	#¡rdup
(
s
è
	`__¡rdup
 (s)

	)

1320 #iâdeà
_HAVE_STRING_ARCH_¡ºdup


1322 *
	$__¡ºdup
 (
__cÚ¡
 *
__¡ršg
, 
size_t
 
__n
)

1323 
__THROW
 
__©Œibu‹_m®loc__
;

1324 
	#__¡ºdup
(
s
, 
n
) \

1325 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
s
è&& 
	`__¡ršg2_1b±r_p
 (s) \

1326 ? (((
__cÚ¡
 *è(
s
))[0] == '\0' \

1327 ? (*è
	`ÿÎoc
 ((
size_t
) 1, (size_t) 1) \

1328 : ({ 
size_t
 
__Ën
 = 
	`¡¾’
 (
s
) + 1; \

1329 
size_t
 
__n
 = (
n
); \

1330 *
__»tv®
; \

1331 ià(
__n
 < 
__Ën
) \

1332 
__Ën
 = 
__n
 + 1; \

1333 
__»tv®
 = (*è
	`m®loc
 (
__Ën
); \

1334 ià(
__»tv®
 !ğ
NULL
) \

1336 
__»tv®
[
__Ën
 - 1] = '\0'; \

1337 
__»tv®
 = (*è
	`memıy
 (__»tv®, 
s
, \

1338 
__Ën
 - 1); \

1340 
__»tv®
; 
	}
})) \

1341 : 
	`__¡ºdup
 (
s
, 
n
)))

	)

1343 #ifdeà
__USE_GNU


1344 
	#¡ºdup
(
s
, 
n
è
	`__¡ºdup
 (s,‚)

	)

1350 #iâdeà
_FORCE_INLINES


1351 #undeà
__STRING_INLINE


	@/usr/include/bits/string3.h

19 #iâdeà
_STRING_H


23 
__w¬ndeş
 (
__w¬n_mem£t_z”o_Ën
,

26 #iâdeà
__ılu¥lus


30 #undeà
memıy


31 #undeà
memmove


32 #undeà
mem£t


33 #undeà
¡rÿt


34 #undeà
¡rıy


35 #undeà
¡ºÿt


36 #undeà
¡ºıy


37 #ifdeà
__USE_GNU


38 #undeà
mempıy


39 #undeà
¡pıy


41 #ifdeà
__USE_BSD


42 #undeà
bcİy


43 #undeà
bz”o


48 
__ex‹º_®ways_šlše
 *

49 
__NTH
 (
	$memıy
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
,

50 
size_t
 
__Ën
))

52  
	`__butš___memıy_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos0
 (__dest));

53 
	}
}

55 
__ex‹º_®ways_šlše
 *

56 
__NTH
 (
	$memmove
 (*
__de¡
, 
__cÚ¡
 *
__¤c
, 
size_t
 
__Ën
))

58  
	`__butš___memmove_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos0
 (__dest));

59 
	}
}

61 #ifdeà
__USE_GNU


62 
__ex‹º_®ways_šlše
 *

63 
__NTH
 (
	$mempıy
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
,

64 
size_t
 
__Ën
))

66  
	`__butš___mempıy_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos0
 (__dest));

67 
	}
}

76 
__ex‹º_®ways_šlše
 *

77 
__NTH
 (
	$mem£t
 (*
__de¡
, 
__ch
, 
size_t
 
__Ën
))

79 ià(
	`__butš_cÚ¡ªt_p
 (
__Ën
) && __len == 0

80 && (!
	`__butš_cÚ¡ªt_p
 (
__ch
) || __ch != 0))

82 
	`__w¬n_mem£t_z”o_Ën
 ();

83  
__de¡
;

85  
	`__butš___mem£t_chk
 (
__de¡
, 
__ch
, 
__Ën
, 
	`__bos0
 (__dest));

86 
	}
}

88 #ifdeà
__USE_BSD


89 
__ex‹º_®ways_šlše
 

90 
__NTH
 (
	$bcİy
 (
__cÚ¡
 *
__¤c
, *
__de¡
, 
size_t
 
__Ën
))

92 (è
	`__butš___memmove_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos0
 (__dest));

93 
	}
}

95 
__ex‹º_®ways_šlše
 

96 
__NTH
 (
	$bz”o
 (*
__de¡
, 
size_t
 
__Ën
))

98 (è
	`__butš___mem£t_chk
 (
__de¡
, '\0', 
__Ën
, 
	`__bos0
 (__dest));

99 
	}
}

102 
__ex‹º_®ways_šlše
 *

103 
__NTH
 (
	$¡rıy
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
))

105  
	`__butš___¡rıy_chk
 (
__de¡
, 
__¤c
, 
	`__bos
 (__dest));

106 
	}
}

108 #ifdeà
__USE_GNU


109 
__ex‹º_®ways_šlše
 *

110 
__NTH
 (
	$¡pıy
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
))

112  
	`__butš___¡pıy_chk
 (
__de¡
, 
__¤c
, 
	`__bos
 (__dest));

113 
	}
}

117 
__ex‹º_®ways_šlše
 *

118 
__NTH
 (
	$¡ºıy
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
,

119 
size_t
 
__Ën
))

121  
	`__butš___¡ºıy_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos
 (__dest));

122 
	}
}

125 *
	$__¡²ıy_chk
 (*
__de¡
, 
__cÚ¡
 *
__¤c
, 
size_t
 
__n
,

126 
size_t
 
__de¡Ën
è
__THROW
;

127 *
	`__REDIRECT_NTH
 (
__¡²ıy_®Ÿs
, (*
__de¡
,

128 
__cÚ¡
 *
__¤c
,

129 
size_t
 
__n
), 
¡²ıy
);

131 
__ex‹º_®ways_šlše
 *

132 
	`__NTH
 (
	$¡²ıy
 (*
__de¡
, 
__cÚ¡
 *
__¤c
, 
size_t
 
__n
))

134 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1

135 && (!
	`__butš_cÚ¡ªt_p
 (
__n
è|| __À<ğ
	`__bos
 (
__de¡
)))

136  
	`__¡²ıy_chk
 (
__de¡
, 
__¤c
, 
__n
, 
	`__bos
 (__dest));

137  
	`__¡²ıy_®Ÿs
 (
__de¡
, 
__¤c
, 
__n
);

138 
	}
}

141 
__ex‹º_®ways_šlše
 *

142 
__NTH
 (
	$¡rÿt
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
))

144  
	`__butš___¡rÿt_chk
 (
__de¡
, 
__¤c
, 
	`__bos
 (__dest));

145 
	}
}

148 
__ex‹º_®ways_šlše
 *

149 
__NTH
 (
	$¡ºÿt
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
,

150 
size_t
 
__Ën
))

152  
	`__butš___¡ºÿt_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos
 (__dest));

153 
	}
}

	@/usr/include/bits/time.h

24 #ià
defšed
 
__Ãed_timev®
 || defšed 
__USE_GNU


25 #iâdeà
_STRUCT_TIMEVAL


26 
	#_STRUCT_TIMEVAL
 1

	)

27 
	~<b™s/ty³s.h
>

31 
	stimev®


33 
__time_t
 
	mtv_£c
;

34 
__su£cÚds_t
 
	mtv_u£c
;

39 #iâdeà
__Ãed_timev®


40 #iâdeà
_BITS_TIME_H


41 
	#_BITS_TIME_H
 1

	)

49 
	#CLOCKS_PER_SEC
 1000000l

	)

51 #ià!
defšed
 
__STRICT_ANSI__
 && !defšed 
__USE_XOPEN2K


54 
	~<b™s/ty³s.h
>

55 
__syscÚf
 ();

56 
	#CLK_TCK
 ((
__şock_t
è
	`__syscÚf
 (2)è

	)

59 #ifdeà
__USE_POSIX199309


61 
	#CLOCK_REALTIME
 0

	)

63 
	#CLOCK_MONOTONIC
 1

	)

65 
	#CLOCK_PROCESS_CPUTIME_ID
 2

	)

67 
	#CLOCK_THREAD_CPUTIME_ID
 3

	)

69 
	#CLOCK_MONOTONIC_RAW
 4

	)

71 
	#CLOCK_REALTIME_COARSE
 5

	)

73 
	#CLOCK_MONOTONIC_COARSE
 6

	)

75 
	#CLOCK_BOOTTIME
 7

	)

77 
	#CLOCK_REALTIME_ALARM
 8

	)

79 
	#CLOCK_BOOTTIME_ALARM
 9

	)

82 
	#TIMER_ABSTIME
 1

	)

85 #ifdeà
__USE_GNU


86 
	~<b™s/timex.h
>

88 
__BEGIN_DECLS


91 
	$şock_adjtime
 (
__şockid_t
 
__şock_id
, 
timex
 *
__utx
è
__THROW
;

93 
__END_DECLS


99 #undeà
__Ãed_timev®


	@/usr/include/bits/types.h

24 #iâdef 
_BITS_TYPES_H


25 
	#_BITS_TYPES_H
 1

	)

27 
	~<ã©u»s.h
>

28 
	~<b™s/wÜdsize.h
>

31 
	t__u_ch¬
;

32 
	t__u_shÜt
;

33 
	t__u_št
;

34 
	t__u_lÚg
;

37 sigÃd 
	t__št8_t
;

38 
	t__ušt8_t
;

39 sigÃd 
	t__št16_t
;

40 
	t__ušt16_t
;

41 sigÃd 
	t__št32_t
;

42 
	t__ušt32_t
;

43 #ià
__WORDSIZE
 == 64

44 sigÃd 
	t__št64_t
;

45 
	t__ušt64_t
;

46 #–ià
defšed
 
__GLIBC_HAVE_LONG_LONG


47 
__ex‹nsiÚ__
 sigÃd 
	t__št64_t
;

48 
__ex‹nsiÚ__
 
	t__ušt64_t
;

52 #ià
__WORDSIZE
 == 64

53 
	t__quad_t
;

54 
	t__u_quad_t
;

55 #–ià
defšed
 
__GLIBC_HAVE_LONG_LONG


56 
__ex‹nsiÚ__
 
	t__quad_t
;

57 
__ex‹nsiÚ__
 
	t__u_quad_t
;

61 
	m__v®
[2];

62 } 
	t__quad_t
;

65 
__u_lÚg
 
	m__v®
[2];

66 } 
	t__u_quad_t
;

99 
	#__S16_TYPE
 

	)

100 
	#__U16_TYPE
 

	)

101 
	#__S32_TYPE
 

	)

102 
	#__U32_TYPE
 

	)

103 
	#__SLONGWORD_TYPE
 

	)

104 
	#__ULONGWORD_TYPE
 

	)

105 #ià
__WORDSIZE
 == 32

106 
	#__SQUAD_TYPE
 
__quad_t


	)

107 
	#__UQUAD_TYPE
 
__u_quad_t


	)

108 
	#__SWORD_TYPE
 

	)

109 
	#__UWORD_TYPE
 

	)

110 
	#__SLONG32_TYPE
 

	)

111 
	#__ULONG32_TYPE
 

	)

112 
	#__S64_TYPE
 
__quad_t


	)

113 
	#__U64_TYPE
 
__u_quad_t


	)

116 
	#__STD_TYPE
 
__ex‹nsiÚ__
 

	)

117 #–ià
__WORDSIZE
 == 64

118 
	t__SQUAD_TYPE
 

	)

119 
	t__UQUAD_TYPE
 

	)

120 
	t__SWORD_TYPE
 

	)

121 
	t__UWORD_TYPE
 

	)

122 
	t__SLONG32_TYPE
 

	)

123 
	t__ULONG32_TYPE
 

	)

124 
	t__S64_TYPE
 

	)

125 
	t__U64_TYPE
 

	)

127 
	t__STD_TYPE
 

	)

131 
	~<b™s/ty³sizes.h
>

134 
__STD_TYPE
 
	t__DEV_T_TYPE
 
	t__dev_t
;

135 
__STD_TYPE
 
__UID_T_TYPE
 
	g__uid_t
;

136 
__STD_TYPE
 
__GID_T_TYPE
 
	g__gid_t
;

137 
__STD_TYPE
 
__INO_T_TYPE
 
	g__šo_t
;

138 
__STD_TYPE
 
__INO64_T_TYPE
 
	g__šo64_t
;

139 
__STD_TYPE
 
__MODE_T_TYPE
 
	g__mode_t
;

140 
__STD_TYPE
 
__NLINK_T_TYPE
 
	g__Æšk_t
;

141 
__STD_TYPE
 
__OFF_T_TYPE
 
	g__off_t
;

142 
__STD_TYPE
 
__OFF64_T_TYPE
 
	g__off64_t
;

143 
__STD_TYPE
 
__PID_T_TYPE
 
	g__pid_t
;

144 
__STD_TYPE
 
__FSID_T_TYPE
 
	g__fsid_t
;

145 
__STD_TYPE
 
__CLOCK_T_TYPE
 
	g__şock_t
;

146 
__STD_TYPE
 
__RLIM_T_TYPE
 
	g__¾im_t
;

147 
__STD_TYPE
 
__RLIM64_T_TYPE
 
	g__¾im64_t
;

148 
__STD_TYPE
 
__ID_T_TYPE
 
	g__id_t
;

149 
__STD_TYPE
 
__TIME_T_TYPE
 
	g__time_t
;

150 
__STD_TYPE
 
__USECONDS_T_TYPE
 
	g__u£cÚds_t
;

151 
__STD_TYPE
 
__SUSECONDS_T_TYPE
 
	g__su£cÚds_t
;

153 
__STD_TYPE
 
__DADDR_T_TYPE
 
	g__daddr_t
;

154 
__STD_TYPE
 
__SWBLK_T_TYPE
 
	g__swblk_t
;

155 
__STD_TYPE
 
__KEY_T_TYPE
 
	g__key_t
;

158 
__STD_TYPE
 
__CLOCKID_T_TYPE
 
	g__şockid_t
;

161 
__STD_TYPE
 
__TIMER_T_TYPE
 
	g__tim”_t
;

164 
__STD_TYPE
 
__BLKSIZE_T_TYPE
 
	g__blksize_t
;

169 
__STD_TYPE
 
__BLKCNT_T_TYPE
 
	g__blkút_t
;

170 
__STD_TYPE
 
__BLKCNT64_T_TYPE
 
	g__blkút64_t
;

173 
__STD_TYPE
 
__FSBLKCNT_T_TYPE
 
	g__fsblkút_t
;

174 
__STD_TYPE
 
__FSBLKCNT64_T_TYPE
 
	g__fsblkút64_t
;

177 
__STD_TYPE
 
__FSFILCNT_T_TYPE
 
	g__fsfút_t
;

178 
__STD_TYPE
 
__FSFILCNT64_T_TYPE
 
	g__fsfút64_t
;

180 
__STD_TYPE
 
__SSIZE_T_TYPE
 
	g__ssize_t
;

184 
__off64_t
 
	t__loff_t
;

185 
__quad_t
 *
	t__qaddr_t
;

186 *
	t__ÿddr_t
;

189 
__STD_TYPE
 
__SWORD_TYPE
 
	g__šŒ_t
;

192 
__STD_TYPE
 
__U32_TYPE
 
	g__sockËn_t
;

195 #undeà
__STD_TYPE


	@/usr/include/bits/unistd.h

20 #iâdeà
_UNISTD_H


24 
ssize_t
 
	$__»ad_chk
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

25 
size_t
 
__buæ’
è
__wur
;

26 
ssize_t
 
	`__REDIRECT
 (
__»ad_®Ÿs
, (
__fd
, *
__buf
,

27 
size_t
 
__nby‹s
), 
»ad
è
__wur
;

28 
ssize_t
 
	`__REDIRECT
 (
__»ad_chk_w¬n
,

29 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

30 
size_t
 
__buæ’
), 
__»ad_chk
)

31 
__wur
 
	`__w¬Ç‰r
 ("read called with bigger†engthhan size of "

34 
__ex‹º_®ways_šlše
 
__wur
 
ssize_t


35 
	$»ad
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
)

37 ià(
	`__bos0
 (
__buf
è!ğ(
size_t
) -1)

39 ià(!
	`__butš_cÚ¡ªt_p
 (
__nby‹s
))

40  
	`__»ad_chk
 (
__fd
, 
__buf
, 
__nby‹s
, 
	`__bos0
 (__buf));

42 ià(
__nby‹s
 > 
	`__bos0
 (
__buf
))

43  
	`__»ad_chk_w¬n
 (
__fd
, 
__buf
, 
__nby‹s
, 
	`__bos0
 (__buf));

45  
	`__»ad_®Ÿs
 (
__fd
, 
__buf
, 
__nby‹s
);

46 
	}
}

48 #ifdeà
__USE_UNIX98


49 
ssize_t
 
	$__´—d_chk
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

50 
__off_t
 
__off£t
, 
size_t
 
__bufsize
è
__wur
;

51 
ssize_t
 
	$__´—d64_chk
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

52 
__off64_t
 
__off£t
, 
size_t
 
__bufsize
è
__wur
;

53 
ssize_t
 
	`__REDIRECT
 (
__´—d_®Ÿs
,

54 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

55 
__off_t
 
__off£t
), 
´—d
è
__wur
;

56 
ssize_t
 
	`__REDIRECT
 (
__´—d64_®Ÿs
,

57 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

58 
__off64_t
 
__off£t
), 
´—d64
è
__wur
;

59 
ssize_t
 
	`__REDIRECT
 (
__´—d_chk_w¬n
,

60 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

61 
__off_t
 
__off£t
, 
size_t
 
__bufsize
), 
__´—d_chk
)

62 
__wur
 
	`__w¬Ç‰r
 ("pread called with bigger†engthhan size of "

64 
ssize_t
 
	`__REDIRECT
 (
__´—d64_chk_w¬n
,

65 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

66 
__off64_t
 
__off£t
, 
size_t
 
__bufsize
),

67 
__´—d64_chk
)

68 
__wur
 
	`__w¬Ç‰r
 ("pread64 called with bigger†engthhan size of "

71 #iâdeà
__USE_FILE_OFFSET64


72 
__ex‹º_®ways_šlše
 
__wur
 
ssize_t


73 
	$´—d
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
, 
__off_t
 
__off£t
)

75 ià(
	`__bos0
 (
__buf
è!ğ(
size_t
) -1)

77 ià(!
	`__butš_cÚ¡ªt_p
 (
__nby‹s
))

78  
	`__´—d_chk
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
, 
	`__bos0
 (__buf));

80 iàĞ
__nby‹s
 > 
	`__bos0
 (
__buf
))

81  
	`__´—d_chk_w¬n
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
,

82 
	`__bos0
 (
__buf
));

84  
	`__´—d_®Ÿs
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
);

85 
	}
}

87 
__ex‹º_®ways_šlše
 
__wur
 
ssize_t


88 
	$´—d
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
, 
__off64_t
 
__off£t
)

90 ià(
	`__bos0
 (
__buf
è!ğ(
size_t
) -1)

92 ià(!
	`__butš_cÚ¡ªt_p
 (
__nby‹s
))

93  
	`__´—d64_chk
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
, 
	`__bos0
 (__buf));

95 iàĞ
__nby‹s
 > 
	`__bos0
 (
__buf
))

96  
	`__´—d64_chk_w¬n
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
,

97 
	`__bos0
 (
__buf
));

100  
	`__´—d64_®Ÿs
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
);

101 
	}
}

104 #ifdeà
__USE_LARGEFILE64


105 
__ex‹º_®ways_šlše
 
__wur
 
ssize_t


106 
	$´—d64
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
, 
__off64_t
 
__off£t
)

108 ià(
	`__bos0
 (
__buf
è!ğ(
size_t
) -1)

110 ià(!
	`__butš_cÚ¡ªt_p
 (
__nby‹s
))

111  
	`__´—d64_chk
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
, 
	`__bos0
 (__buf));

113 iàĞ
__nby‹s
 > 
	`__bos0
 (
__buf
))

114  
	`__´—d64_chk_w¬n
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
,

115 
	`__bos0
 (
__buf
));

118  
	`__´—d64_®Ÿs
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
);

119 
	}
}

123 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


124 
ssize_t
 
	$__»adlšk_chk
 (
__cÚ¡
 *
__»¡riù
 
__·th
,

125 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
,

126 
size_t
 
__buæ’
)

127 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

128 
ssize_t
 
	`__REDIRECT_NTH
 (
__»adlšk_®Ÿs
,

129 (
__cÚ¡
 *
__»¡riù
 
__·th
,

130 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
), 
»adlšk
)

131 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

132 
ssize_t
 
	`__REDIRECT_NTH
 (
__»adlšk_chk_w¬n
,

133 (
__cÚ¡
 *
__»¡riù
 
__·th
,

134 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
,

135 
size_t
 
__buæ’
), 
__»adlšk_chk
)

136 
	`__nÚnuÎ
 ((1, 2)è
__wur
 
	`__w¬Ç‰r
 ("readlink called with bigger†ength "

139 
__ex‹º_®ways_šlše
 
	`__nÚnuÎ
 ((1, 2)è
__wur
 
ssize_t


140 
	`__NTH
 (
	$»adlšk
 (
__cÚ¡
 *
__»¡riù
 
__·th
, *__»¡riù 
__buf
,

141 
size_t
 
__Ën
))

143 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

145 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

146  
	`__»adlšk_chk
 (
__·th
, 
__buf
, 
__Ën
, 
	`__bos
 (__buf));

148 iàĞ
__Ën
 > 
	`__bos
 (
__buf
))

149  
	`__»adlšk_chk_w¬n
 (
__·th
, 
__buf
, 
__Ën
, 
	`__bos
 (__buf));

151  
	`__»adlšk_®Ÿs
 (
__·th
, 
__buf
, 
__Ën
);

152 
	}
}

155 #ifdeà
__USE_ATFILE


156 
ssize_t
 
	$__»adlšk©_chk
 (
__fd
, 
__cÚ¡
 *
__»¡riù
 
__·th
,

157 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
,

158 
size_t
 
__buæ’
)

159 
__THROW
 
	`__nÚnuÎ
 ((2, 3)è
__wur
;

160 
ssize_t
 
	`__REDIRECT_NTH
 (
__»adlšk©_®Ÿs
,

161 (
__fd
, 
__cÚ¡
 *
__»¡riù
 
__·th
,

162 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
),

163 
»adlšk©
)

164 
	`__nÚnuÎ
 ((2, 3)è
__wur
;

165 
ssize_t
 
	`__REDIRECT_NTH
 (
__»adlšk©_chk_w¬n
,

166 (
__fd
, 
__cÚ¡
 *
__»¡riù
 
__·th
,

167 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
,

168 
size_t
 
__buæ’
), 
__»adlšk©_chk
)

169 
	`__nÚnuÎ
 ((2, 3)è
__wur
 
	`__w¬Ç‰r
 ("readlinkat called with bigger "

173 
__ex‹º_®ways_šlše
 
	`__nÚnuÎ
 ((2, 3)è
__wur
 
ssize_t


174 
	`__NTH
 (
	$»adlšk©
 (
__fd
, 
__cÚ¡
 *
__»¡riù
 
__·th
,

175 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
))

177 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

179 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

180  
	`__»adlšk©_chk
 (
__fd
, 
__·th
, 
__buf
, 
__Ën
, 
	`__bos
 (__buf));

182 ià(
__Ën
 > 
	`__bos
 (
__buf
))

183  
	`__»adlšk©_chk_w¬n
 (
__fd
, 
__·th
, 
__buf
, 
__Ën
,

184 
	`__bos
 (
__buf
));

186  
	`__»adlšk©_®Ÿs
 (
__fd
, 
__·th
, 
__buf
, 
__Ën
);

187 
	}
}

190 *
	$__g‘cwd_chk
 (*
__buf
, 
size_t
 
__size
, size_ˆ
__buæ’
)

191 
__THROW
 
__wur
;

192 *
	`__REDIRECT_NTH
 (
__g‘cwd_®Ÿs
,

193 (*
__buf
, 
size_t
 
__size
), 
g‘cwd
è
__wur
;

194 *
	`__REDIRECT_NTH
 (
__g‘cwd_chk_w¬n
,

195 (*
__buf
, 
size_t
 
__size
, size_ˆ
__buæ’
),

196 
__g‘cwd_chk
)

197 
__wur
 
	`__w¬Ç‰r
 ("getcwd caller with bigger†engthhan size of "

200 
__ex‹º_®ways_šlše
 
__wur
 *

201 
	`__NTH
 (
	$g‘cwd
 (*
__buf
, 
size_t
 
__size
))

203 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

205 ià(!
	`__butš_cÚ¡ªt_p
 (
__size
))

206  
	`__g‘cwd_chk
 (
__buf
, 
__size
, 
	`__bos
 (__buf));

208 ià(
__size
 > 
	`__bos
 (
__buf
))

209  
	`__g‘cwd_chk_w¬n
 (
__buf
, 
__size
, 
	`__bos
 (__buf));

211  
	`__g‘cwd_®Ÿs
 (
__buf
, 
__size
);

212 
	}
}

214 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


215 *
	$__g‘wd_chk
 (*
__buf
, 
size_t
 
buæ’
)

216 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

217 *
	`__REDIRECT_NTH
 (
__g‘wd_w¬n
, (*
__buf
), 
g‘wd
)

218 
	`__nÚnuÎ
 ((1)è
__wur
 
	`__w¬Ç‰r
 ("please use getcwd instead,‡s getwd "

221 
__ex‹º_®ways_šlše
 
	`__nÚnuÎ
 ((1)è
__©Œibu‹_d•»ÿ‹d__
 
__wur
 *

222 
	`__NTH
 (
	$g‘wd
 (*
__buf
))

224 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

225  
	`__g‘wd_chk
 (
__buf
, 
	`__bos
 (__buf));

226  
	`__g‘wd_w¬n
 (
__buf
);

227 
	}
}

230 
size_t
 
	$__cÚf¡r_chk
 (
__Çme
, *
__buf
, 
size_t
 
__Ën
,

231 
size_t
 
__buæ’
è
__THROW
;

232 
size_t
 
	`__REDIRECT_NTH
 (
__cÚf¡r_®Ÿs
, (
__Çme
, *
__buf
,

233 
size_t
 
__Ën
), 
cÚf¡r
);

234 
size_t
 
	`__REDIRECT_NTH
 (
__cÚf¡r_chk_w¬n
,

235 (
__Çme
, *
__buf
, 
size_t
 
__Ën
,

236 
size_t
 
__buæ’
), 
__cÚf¡r_chk
)

237 
	`__w¬Ç‰r
 ("confstr called with bigger†engthhan size of destination "

240 
__ex‹º_®ways_šlše
 
size_t


241 
	`__NTH
 (
	$cÚf¡r
 (
__Çme
, *
__buf
, 
size_t
 
__Ën
))

243 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

245 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

246  
	`__cÚf¡r_chk
 (
__Çme
, 
__buf
, 
__Ën
, 
	`__bos
 (__buf));

248 ià(
	`__bos
 (
__buf
è< 
__Ën
)

249  
	`__cÚf¡r_chk_w¬n
 (
__Çme
, 
__buf
, 
__Ën
, 
	`__bos
 (__buf));

251  
	`__cÚf¡r_®Ÿs
 (
__Çme
, 
__buf
, 
__Ën
);

252 
	}
}

255 
	$__g‘groups_chk
 (
__size
, 
__gid_t
 
__li¡
[], 
size_t
 
__li¡Ën
)

256 
__THROW
 
__wur
;

257 
	`__REDIRECT_NTH
 (
__g‘groups_®Ÿs
, (
__size
, 
__gid_t
 
__li¡
[]),

258 
g‘groups
è
__wur
;

259 
	`__REDIRECT_NTH
 (
__g‘groups_chk_w¬n
,

260 (
__size
, 
__gid_t
 
__li¡
[], 
size_t
 
__li¡Ën
),

261 
__g‘groups_chk
)

262 
__wur
 
	`__w¬Ç‰r
 ("getgroups called with bigger group counthan what "

265 
__ex‹º_®ways_šlše
 

266 
	`__NTH
 (
	$g‘groups
 (
__size
, 
__gid_t
 
__li¡
[]))

268 ià(
	`__bos
 (
__li¡
è!ğ(
size_t
) -1)

270 ià(!
	`__butš_cÚ¡ªt_p
 (
__size
) || __size < 0)

271  
	`__g‘groups_chk
 (
__size
, 
__li¡
, 
	`__bos
 (__list));

273 ià(
__size
 *  (
__gid_t
è> 
	`__bos
 (
__li¡
))

274  
	`__g‘groups_chk_w¬n
 (
__size
, 
__li¡
, 
	`__bos
 (__list));

276  
	`__g‘groups_®Ÿs
 (
__size
, 
__li¡
);

277 
	}
}

280 
	$__‰yÇme_r_chk
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
,

281 
size_t
 
__Ä—l
è
__THROW
 
	`__nÚnuÎ
 ((2));

282 
	`__REDIRECT_NTH
 (
__‰yÇme_r_®Ÿs
, (
__fd
, *
__buf
,

283 
size_t
 
__buæ’
), 
‰yÇme_r
)

284 
	`__nÚnuÎ
 ((2));

285 
	`__REDIRECT_NTH
 (
__‰yÇme_r_chk_w¬n
,

286 (
__fd
, *
__buf
, 
size_t
 
__buæ’
,

287 
size_t
 
__Ä—l
), 
__‰yÇme_r_chk
)

288 
	`__nÚnuÎ
 ((2)è
	`__w¬Ç‰r
 ("ttyname_r called with bigger buflenhan "

291 
__ex‹º_®ways_šlše
 

292 
	`__NTH
 (
	$‰yÇme_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
))

294 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

296 ià(!
	`__butš_cÚ¡ªt_p
 (
__buæ’
))

297  
	`__‰yÇme_r_chk
 (
__fd
, 
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

299 ià(
__buæ’
 > 
	`__bos
 (
__buf
))

300  
	`__‰yÇme_r_chk_w¬n
 (
__fd
, 
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

302  
	`__‰yÇme_r_®Ÿs
 (
__fd
, 
__buf
, 
__buæ’
);

303 
	}
}

306 #ià
defšed
 
__USE_REENTRANT
 || defšed 
__USE_POSIX199506


307 
	$__g‘logš_r_chk
 (*
__buf
, 
size_t
 
__buæ’
, size_ˆ
__Ä—l
)

308 
	`__nÚnuÎ
 ((1));

309 
	`__REDIRECT
 (
__g‘logš_r_®Ÿs
, (*
__buf
, 
size_t
 
__buæ’
),

310 
g‘logš_r
è
	`__nÚnuÎ
 ((1));

311 
	`__REDIRECT
 (
__g‘logš_r_chk_w¬n
,

312 (*
__buf
, 
size_t
 
__buæ’
, size_ˆ
__Ä—l
),

313 
__g‘logš_r_chk
)

314 
	`__nÚnuÎ
 ((1)è
	`__w¬Ç‰r
 ("getlogin_r called with bigger buflenhan "

317 
__ex‹º_®ways_šlše
 

318 
	$g‘logš_r
 (*
__buf
, 
size_t
 
__buæ’
)

320 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

322 ià(!
	`__butš_cÚ¡ªt_p
 (
__buæ’
))

323  
	`__g‘logš_r_chk
 (
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

325 ià(
__buæ’
 > 
	`__bos
 (
__buf
))

326  
	`__g‘logš_r_chk_w¬n
 (
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

328  
	`__g‘logš_r_®Ÿs
 (
__buf
, 
__buæ’
);

329 
	}
}

333 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_UNIX98


334 
	$__g‘ho¡Çme_chk
 (*
__buf
, 
size_t
 
__buæ’
, size_ˆ
__Ä—l
)

335 
__THROW
 
	`__nÚnuÎ
 ((1));

336 
	`__REDIRECT_NTH
 (
__g‘ho¡Çme_®Ÿs
, (*
__buf
, 
size_t
 
__buæ’
),

337 
g‘ho¡Çme
è
	`__nÚnuÎ
 ((1));

338 
	`__REDIRECT_NTH
 (
__g‘ho¡Çme_chk_w¬n
,

339 (*
__buf
, 
size_t
 
__buæ’
, size_ˆ
__Ä—l
),

340 
__g‘ho¡Çme_chk
)

341 
	`__nÚnuÎ
 ((1)è
	`__w¬Ç‰r
 ("gethostname called with bigger buflenhan "

344 
__ex‹º_®ways_šlše
 

345 
	`__NTH
 (
	$g‘ho¡Çme
 (*
__buf
, 
size_t
 
__buæ’
))

347 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

349 ià(!
	`__butš_cÚ¡ªt_p
 (
__buæ’
))

350  
	`__g‘ho¡Çme_chk
 (
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

352 ià(
__buæ’
 > 
	`__bos
 (
__buf
))

353  
	`__g‘ho¡Çme_chk_w¬n
 (
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

355  
	`__g‘ho¡Çme_®Ÿs
 (
__buf
, 
__buæ’
);

356 
	}
}

360 #ià
defšed
 
__USE_BSD
 || (defšed 
__USE_XOPEN
 && !defšed 
__USE_UNIX98
)

361 
	$__g‘domašÇme_chk
 (*
__buf
, 
size_t
 
__buæ’
, size_ˆ
__Ä—l
)

362 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

363 
	`__REDIRECT_NTH
 (
__g‘domašÇme_®Ÿs
, (*
__buf
,

364 
size_t
 
__buæ’
),

365 
g‘domašÇme
è
	`__nÚnuÎ
 ((1)è
__wur
;

366 
	`__REDIRECT_NTH
 (
__g‘domašÇme_chk_w¬n
,

367 (*
__buf
, 
size_t
 
__buæ’
, size_ˆ
__Ä—l
),

368 
__g‘domašÇme_chk
)

369 
	`__nÚnuÎ
 ((1)è
__wur
 
	`__w¬Ç‰r
 ("getdomainname called with bigger "

373 
__ex‹º_®ways_šlše
 

374 
	`__NTH
 (
	$g‘domašÇme
 (*
__buf
, 
size_t
 
__buæ’
))

376 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

378 ià(!
	`__butš_cÚ¡ªt_p
 (
__buæ’
))

379  
	`__g‘domašÇme_chk
 (
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

381 ià(
__buæ’
 > 
	`__bos
 (
__buf
))

382  
	`__g‘domašÇme_chk_w¬n
 (
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

384  
	`__g‘domašÇme_®Ÿs
 (
__buf
, 
__buæ’
);

385 
	}
}

	@/usr/include/bits/wchar.h

20 #iâdeà
_BITS_WCHAR_H


21 
	#_BITS_WCHAR_H
 1

	)

24 #ifdeà
__WCHAR_MAX__


25 
	#__WCHAR_MAX
 
__WCHAR_MAX__


	)

27 
	#__WCHAR_MAX
 (2147483647)

	)

32 #ifdeà
__WCHAR_UNSIGNED__


33 
	#__WCHAR_MIN
 
L
'\0'

	)

37 #–ià
L
'\0' - 1 > 0

38 
	#__WCHAR_MIN
 
L
'\0'

	)

40 
	#__WCHAR_MIN
 (-
__WCHAR_MAX
 - 1)

	)

	@/usr/include/bits/wordsize.h

3 #ià
defšed
 
__x86_64__


4 
	#__WORDSIZE
 64

	)

5 
	#__WORDSIZE_COMPAT32
 1

	)

7 
	#__WORDSIZE
 32

	)

	@/usr/include/getopt.h

21 #iâdeà
_GETOPT_H


23 #iâdeà
__Ãed_g‘İt


24 
	#_GETOPT_H
 1

	)

34 #ià!
defšed
 
__GNU_LIBRARY__


35 
	~<ùy³.h
>

38 #iâdeà
__THROW


39 #iâdeà
__GNUC_PREREQ


40 
	#__GNUC_PREREQ
(
maj
, 
mš
è(0)

	)

42 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (2,8)

43 
	#__THROW
 
	`throw
 ()

	)

45 
	#__THROW


	)

49 #ifdef 
__ılu¥lus


59 *
İrg
;

73 
İtšd
;

78 
İ‹¼
;

82 
İtİt
;

84 #iâdeà
__Ãed_g‘İt


106 
	sİtiÚ


108 cÚ¡ *
	gÇme
;

111 
	ghas_¬g
;

112 *
	gæag
;

113 
	gv®
;

118 
	#no_¬gum’t
 0

	)

119 
	#»quœed_¬gum’t
 1

	)

120 
	#İtiÚ®_¬gum’t
 2

	)

148 #ifdeà
__GNU_LIBRARY__


152 
g‘İt
 (
___¬gc
, *cÚ¡ *
___¬gv
, cÚ¡ *
__shÜtİts
)

153 
__THROW
;

155 #ià
defšed
 
__Ãed_g‘İt
 && defšed 
__USE_POSIX2
 \

156 && !
defšed
 
	g__USE_POSIX_IMPLICITLY
 && !defšed 
	g__USE_GNU


160 #ifdeà
__REDIRECT


161 
__REDIRECT_NTH
 (
g‘İt
, (
___¬gc
, *cÚ¡ *
___¬gv
,

162 cÚ¡ *
__shÜtİts
),

163 
__posix_g‘İt
);

165 
__posix_g‘İt
 (
___¬gc
, *cÚ¡ *
___¬gv
,

166 cÚ¡ *
__shÜtİts
è
__THROW
;

167 
	#g‘İt
 
__posix_g‘İt


	)

171 
g‘İt
 ();

174 #iâdeà
__Ãed_g‘İt


175 
g‘İt_lÚg
 (
___¬gc
, *cÚ¡ *
___¬gv
,

176 cÚ¡ *
__shÜtİts
,

177 cÚ¡ 
İtiÚ
 *
__lÚgİts
, *
__lÚgšd
)

178 
__THROW
;

179 
g‘İt_lÚg_Úly
 (
___¬gc
, *cÚ¡ *
___¬gv
,

180 cÚ¡ *
__shÜtİts
,

181 cÚ¡ 
İtiÚ
 *
__lÚgİts
, *
__lÚgšd
)

182 
__THROW
;

186 #ifdef 
__ılu¥lus


191 #undeà
__Ãed_g‘İt


	@/usr/include/gnu/stubs.h

4 
	~<b™s/wÜdsize.h
>

6 #ià
__WORDSIZE
 == 32

7 
	~<gnu/¡ubs-32.h
>

8 #–ià
__WORDSIZE
 == 64

9 
	~<gnu/¡ubs-64.h
>

	@/usr/include/linux/swab.h

1 #iâdeà
_LINUX_SWAB_H


2 
	#_LINUX_SWAB_H


	)

4 
	~<lšux/ty³s.h
>

6 
	~<asm/swab.h
>

12 
	#___cÚ¡ªt_swab16
(
x
è((
__u16
)( \

13 (((
__u16
)(
x
) & (__u16)0x00ffU) << 8) | \

14 (((
__u16
)(
x
è& (__u16)0xff00Uè>> 8)))

	)

16 
	#___cÚ¡ªt_swab32
(
x
è((
__u32
)( \

17 (((
__u32
)(
x
) & (__u32)0x000000ffUL) << 24) | \

18 (((
__u32
)(
x
) & (__u32)0x0000ff00UL) << 8) | \

19 (((
__u32
)(
x
) & (__u32)0x00ff0000UL) >> 8) | \

20 (((
__u32
)(
x
è& (__u32)0xff000000ULè>> 24)))

	)

22 
	#___cÚ¡ªt_swab64
(
x
è((
__u64
)( \

23 (((
__u64
)(
x
) & (__u64)0x00000000000000ffULL) << 56) | \

24 (((
__u64
)(
x
) & (__u64)0x000000000000ff00ULL) << 40) | \

25 (((
__u64
)(
x
) & (__u64)0x0000000000ff0000ULL) << 24) | \

26 (((
__u64
)(
x
) & (__u64)0x00000000ff000000ULL) << 8) | \

27 (((
__u64
)(
x
) & (__u64)0x000000ff00000000ULL) >> 8) | \

28 (((
__u64
)(
x
) & (__u64)0x0000ff0000000000ULL) >> 24) | \

29 (((
__u64
)(
x
) & (__u64)0x00ff000000000000ULL) >> 40) | \

30 (((
__u64
)(
x
è& (__u64)0xff00000000000000ULLè>> 56)))

	)

32 
	#___cÚ¡ªt_swahw32
(
x
è((
__u32
)( \

33 (((
__u32
)(
x
) & (__u32)0x0000ffffUL) << 16) | \

34 (((
__u32
)(
x
è& (__u32)0xffff0000ULè>> 16)))

	)

36 
	#___cÚ¡ªt_swahb32
(
x
è((
__u32
)( \

37 (((
__u32
)(
x
) & (__u32)0x00ff00ffUL) << 8) | \

38 (((
__u32
)(
x
è& (__u32)0xff00ff00ULè>> 8)))

	)

46 
__šlše__
 
__u16
 
	$__fswab16
(
__u16
 
v®
)

48 #ifdeà
__¬ch_swab16


49  
	`__¬ch_swab16
(
v®
);

51  
	`___cÚ¡ªt_swab16
(
v®
);

53 
	}
}

55 
__šlše__
 
__u32
 
	$__fswab32
(
__u32
 
v®
)

57 #ifdeà
__¬ch_swab32


58  
	`__¬ch_swab32
(
v®
);

60  
	`___cÚ¡ªt_swab32
(
v®
);

62 
	}
}

64 
__šlše__
 
__u64
 
	$__fswab64
(
__u64
 
v®
)

66 #ifdeà
__¬ch_swab64


67  
	`__¬ch_swab64
(
v®
);

68 #–ià
	`defšed
(
__SWAB_64_THRU_32__
)

69 
__u32
 
h
 = 
v®
 >> 32;

70 
__u32
 
l
 = 
v®
 & ((1ULL << 32) - 1);

71  (((
__u64
)
	`__fswab32
(
l
)è<< 32è| ((__u64)(__fswab32(
h
)));

73  
	`___cÚ¡ªt_swab64
(
v®
);

75 
	}
}

77 
__šlše__
 
__u32
 
	$__fswahw32
(
__u32
 
v®
)

79 #ifdeà
__¬ch_swahw32


80  
	`__¬ch_swahw32
(
v®
);

82  
	`___cÚ¡ªt_swahw32
(
v®
);

84 
	}
}

86 
__šlše__
 
__u32
 
	$__fswahb32
(
__u32
 
v®
)

88 #ifdeà
__¬ch_swahb32


89  
	`__¬ch_swahb32
(
v®
);

91  
	`___cÚ¡ªt_swahb32
(
v®
);

93 
	}
}

99 
	#__swab16
(
x
) \

100 (
	`__butš_cÚ¡ªt_p
((
__u16
)(
x
)) ? \

101 
	`___cÚ¡ªt_swab16
(
x
) : \

102 
	`__fswab16
(
x
))

	)

108 
	#__swab32
(
x
) \

109 (
	`__butš_cÚ¡ªt_p
((
__u32
)(
x
)) ? \

110 
	`___cÚ¡ªt_swab32
(
x
) : \

111 
	`__fswab32
(
x
))

	)

117 
	#__swab64
(
x
) \

118 (
	`__butš_cÚ¡ªt_p
((
__u64
)(
x
)) ? \

119 
	`___cÚ¡ªt_swab64
(
x
) : \

120 
	`__fswab64
(
x
))

	)

128 
	#__swahw32
(
x
) \

129 (
	`__butš_cÚ¡ªt_p
((
__u32
)(
x
)) ? \

130 
	`___cÚ¡ªt_swahw32
(
x
) : \

131 
	`__fswahw32
(
x
))

	)

139 
	#__swahb32
(
x
) \

140 (
	`__butš_cÚ¡ªt_p
((
__u32
)(
x
)) ? \

141 
	`___cÚ¡ªt_swahb32
(
x
) : \

142 
	`__fswahb32
(
x
))

	)

148 
__šlše__
 
__u16
 
	$__swab16p
(cÚ¡ 
__u16
 *
p
)

150 #ifdeà
__¬ch_swab16p


151  
	`__¬ch_swab16p
(
p
);

153  
	`__swab16
(*
p
);

155 
	}
}

161 
__šlše__
 
__u32
 
	$__swab32p
(cÚ¡ 
__u32
 *
p
)

163 #ifdeà
__¬ch_swab32p


164  
	`__¬ch_swab32p
(
p
);

166  
	`__swab32
(*
p
);

168 
	}
}

174 
__šlše__
 
__u64
 
	$__swab64p
(cÚ¡ 
__u64
 *
p
)

176 #ifdeà
__¬ch_swab64p


177  
	`__¬ch_swab64p
(
p
);

179  
	`__swab64
(*
p
);

181 
	}
}

189 
__šlše__
 
__u32
 
	$__swahw32p
(cÚ¡ 
__u32
 *
p
)

191 #ifdeà
__¬ch_swahw32p


192  
	`__¬ch_swahw32p
(
p
);

194  
	`__swahw32
(*
p
);

196 
	}
}

204 
__šlše__
 
__u32
 
	$__swahb32p
(cÚ¡ 
__u32
 *
p
)

206 #ifdeà
__¬ch_swahb32p


207  
	`__¬ch_swahb32p
(
p
);

209  
	`__swahb32
(*
p
);

211 
	}
}

217 
__šlše__
 
	$__swab16s
(
__u16
 *
p
)

219 #ifdeà
__¬ch_swab16s


220 
	`__¬ch_swab16s
(
p
);

222 *
p
 = 
	`__swab16p
(p);

224 
	}
}

229 
__šlše__
 
	$__swab32s
(
__u32
 *
p
)

231 #ifdeà
__¬ch_swab32s


232 
	`__¬ch_swab32s
(
p
);

234 *
p
 = 
	`__swab32p
(p);

236 
	}
}

242 
__šlše__
 
	$__swab64s
(
__u64
 *
p
)

244 #ifdeà
__¬ch_swab64s


245 
	`__¬ch_swab64s
(
p
);

247 *
p
 = 
	`__swab64p
(p);

249 
	}
}

257 
__šlše__
 
	$__swahw32s
(
__u32
 *
p
)

259 #ifdeà
__¬ch_swahw32s


260 
	`__¬ch_swahw32s
(
p
);

262 *
p
 = 
	`__swahw32p
(p);

264 
	}
}

272 
__šlše__
 
	$__swahb32s
(
__u32
 *
p
)

274 #ifdeà
__¬ch_swahb32s


275 
	`__¬ch_swahb32s
(
p
);

277 *
p
 = 
	`__swahb32p
(p);

279 
	}
}

	@/usr/include/sys/cdefs.h

20 #iâdef 
_SYS_CDEFS_H


21 
	#_SYS_CDEFS_H
 1

	)

24 #iâdeà
_FEATURES_H


25 
	~<ã©u»s.h
>

31 #ià
defšed
 
__GNUC__
 && !defšed 
__STDC__


36 #undeà
__P


37 #undeà
__PMT


39 #ifdeà
__GNUC__


43 #ià
__GNUC_PREREQ
 (4, 6è&& !
defšed
 
_LIBC


44 
	#__LEAF
 , 
__Ëaf__


	)

45 
	#__LEAF_ATTR
 
	`__©Œibu‹__
 ((
__Ëaf__
))

	)

47 
	#__LEAF


	)

48 
	#__LEAF_ATTR


	)

56 #ià!
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (3, 3)

57 
	#__THROW
 
	`__©Œibu‹__
 ((
__nÙhrow__
 
__LEAF
))

	)

58 
	#__THROWNL
 
	`__©Œibu‹__
 ((
__nÙhrow__
))

	)

59 
	#__NTH
(
fù
è
	`__©Œibu‹__
 ((
__nÙhrow__
 
__LEAF
)è
	)
fct

61 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (2,8)

62 
	#__THROW
 
	`throw
 ()

	)

63 
	#__THROWNL
 
	`throw
 ()

	)

64 
	#__NTH
(
fù
è
__LEAF_ATTR
 fù 
	`throw
 ()

	)

66 
	#__THROW


	)

67 
	#__THROWNL


	)

68 
	#__NTH
(
fù
è
	)
fct

74 
	#__šlše


	)

76 
	#__THROW


	)

77 
	#__THROWNL


	)

78 
	#__NTH
(
fù
è
	)
fct

80 
	#__cÚ¡
 cÚ¡

	)

81 
	#__sigÃd
 sigÃd

	)

82 
	#__vŞ©e
 vŞ©e

	)

88 
	#__P
(
¬gs
è
	)
args

89 
	#__PMT
(
¬gs
è
	)
args

94 
	#__CONCAT
(
x
,
y
èx ## 
	)
y

95 
	#__STRING
(
x
è#x

	)

98 
	#__±r_t
 *

	)

99 
	#__lÚg_doubË_t
 

	)

103 #ifdef 
__ılu¥lus


104 
	#__BEGIN_DECLS
 "C" {

	)

105 
	#__END_DECLS
 }

	)

107 
	#__BEGIN_DECLS


	)

108 
	#__END_DECLS


	)

117 #ià
defšed
 
__ılu¥lus
 && defšed 
_GLIBCPP_USE_NAMESPACES


118 
	#__BEGIN_NAMESPACE_STD
 
Çme¥aû
 
¡d
 {

	)

119 
	#__END_NAMESPACE_STD
 }

	)

120 
	#__USING_NAMESPACE_STD
(
Çme
è
usšg
 
¡d
::Çme;

	)

121 
	#__BEGIN_NAMESPACE_C99
 
Çme¥aû
 
__c99
 {

	)

122 
	#__END_NAMESPACE_C99
 }

	)

123 
	#__USING_NAMESPACE_C99
(
Çme
è
usšg
 
__c99
::Çme;

	)

128 
	#__BEGIN_NAMESPACE_STD


	)

129 
	#__END_NAMESPACE_STD


	)

130 
	#__USING_NAMESPACE_STD
(
Çme
)

	)

131 
	#__BEGIN_NAMESPACE_C99


	)

132 
	#__END_NAMESPACE_C99


	)

133 
	#__USING_NAMESPACE_C99
(
Çme
)

	)

138 #iâdeà
__BOUNDED_POINTERS__


139 
	#__bounded


	)

140 
	#__unbounded


	)

141 
	#__±rv®ue


	)

146 
	#__bos
(
±r
è
	`__butš_objeù_size
 (±r, 
__USE_FORTIFY_LEVEL
 > 1)

	)

147 
	#__bos0
(
±r
è
	`__butš_objeù_size
 (±r, 0)

	)

149 #ià
__GNUC_PREREQ
 (4,3)

150 
	#__w¬ndeş
(
Çme
, 
msg
) \

151 
	`Çme
 (è
	`__©Œibu‹__
((
	`__w¬nšg__
 (
msg
)))

	)

152 
	#__w¬Ç‰r
(
msg
è
	`__©Œibu‹__
((
	`__w¬nšg__
 (msg)))

	)

153 
	#__”rÜdeş
(
Çme
, 
msg
) \

154 
	`Çme
 (è
	`__©Œibu‹__
((
	`__”rÜ__
 (
msg
)))

	)

156 
	#__w¬ndeş
(
Çme
, 
msg
è
	`Çme
 ()

	)

157 
	#__w¬Ç‰r
(
msg
)

	)

158 
	#__”rÜdeş
(
Çme
, 
msg
è
	`Çme
 ()

	)

162 #ià
__GNUC_PREREQ
 (2,97)

164 
	#__æex¬r
 []

	)

166 #ifdeà
__GNUC__


167 
	#__æex¬r
 [0]

	)

169 #ià
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

170 
	#__æex¬r
 []

	)

173 
	#__æex¬r
 [1]

	)

189 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

191 
	#__REDIRECT
(
Çme
, 
´Ùo
, 
®Ÿs
èÇm´ÙØ
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs))

	)

192 #ifdeà
__ılu¥lus


193 
	#__REDIRECT_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
) \

194 
Çme
 
´Ùo
 
__THROW
 
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs))

	)

195 
	#__REDIRECT_NTHNL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

196 
Çme
 
´Ùo
 
__THROWNL
 
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs))

	)

198 
	#__REDIRECT_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
) \

199 
Çme
 
´Ùo
 
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs)è
__THROW


	)

200 
	#__REDIRECT_NTHNL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

201 
Çme
 
´Ùo
 
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs)è
__THROWNL


	)

203 
	#__ASMNAME
(
úame
è
	`__ASMNAME2
 (
__USER_LABEL_PREFIX__
, cÇme)

	)

204 
	#__ASMNAME2
(
´efix
, 
úame
è
	`__STRING
 (´efixè
	)
cname

217 #ià!
defšed
 
__GNUC__
 || __GNUC__ < 2

218 
	#__©Œibu‹__
(
xyz
è

	)

224 #ià
__GNUC_PREREQ
 (2,96)

225 
	#__©Œibu‹_m®loc__
 
	`__©Œibu‹__
 ((
__m®loc__
))

	)

227 
	#__©Œibu‹_m®loc__


	)

233 #ià
__GNUC_PREREQ
 (2,96)

234 
	#__©Œibu‹_pu»__
 
	`__©Œibu‹__
 ((
__pu»__
))

	)

236 
	#__©Œibu‹_pu»__


	)

240 #ià
__GNUC_PREREQ
 (2,5)

241 
	#__©Œibu‹_cÚ¡__
 
	`__©Œibu‹__
 ((
__cÚ¡__
))

	)

243 
	#__©Œibu‹_cÚ¡__


	)

249 #ià
__GNUC_PREREQ
 (3,1)

250 
	#__©Œibu‹_u£d__
 
	`__©Œibu‹__
 ((
__u£d__
))

	)

251 
	#__©Œibu‹_nošlše__
 
	`__©Œibu‹__
 ((
__nošlše__
))

	)

253 
	#__©Œibu‹_u£d__
 
	`__©Œibu‹__
 ((
__unu£d__
))

	)

254 
	#__©Œibu‹_nošlše__


	)

258 #ià
__GNUC_PREREQ
 (3,2)

259 
	#__©Œibu‹_d•»ÿ‹d__
 
	`__©Œibu‹__
 ((
__d•»ÿ‹d__
))

	)

261 
	#__©Œibu‹_d•»ÿ‹d__


	)

270 #ià
__GNUC_PREREQ
 (2,8)

271 
	#__©Œibu‹_fÜm©_¬g__
(
x
è
	`__©Œibu‹__
 ((
	`__fÜm©_¬g__
 (x)))

	)

273 
	#__©Œibu‹_fÜm©_¬g__
(
x
è

	)

280 #ià
__GNUC_PREREQ
 (2,97)

281 
	#__©Œibu‹_fÜm©_¡rfmÚ__
(
a
,
b
) \

282 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__¡rfmÚ__
, 
a
, 
b
)))

	)

284 
	#__©Œibu‹_fÜm©_¡rfmÚ__
(
a
,
b
è

	)

289 #ià
__GNUC_PREREQ
 (3,3)

290 
	#__nÚnuÎ
(
·¿ms
è
	`__©Œibu‹__
 ((
__nÚnuÎ__
…¬ams))

	)

292 
	#__nÚnuÎ
(
·¿ms
)

	)

297 #ià
__GNUC_PREREQ
 (3,4)

298 
	#__©Œibu‹_w¬n_unu£d_»suÉ__
 \

299 
	`__©Œibu‹__
 ((
__w¬n_unu£d_»suÉ__
))

	)

300 #ià
__USE_FORTIFY_LEVEL
 > 0

301 
	#__wur
 
__©Œibu‹_w¬n_unu£d_»suÉ__


	)

304 
	#__©Œibu‹_w¬n_unu£d_»suÉ__


	)

306 #iâdeà
__wur


307 
	#__wur


	)

311 #ià
__GNUC_PREREQ
 (3,2)

312 
	#__®ways_šlše
 
__šlše
 
	`__©Œibu‹__
 ((
__®ways_šlše__
))

	)

314 
	#__®ways_šlše
 
__šlše


	)

319 #ià!
defšed
 
__ılu¥lus
 || 
__GNUC_PREREQ
 (4,3)

320 #ià
defšed
 
__GNUC_STDC_INLINE__
 || defšed 
__ılu¥lus


321 
	#__ex‹º_šlše
 
__šlše
 
	`__©Œibu‹__
 ((
__gnu_šlše__
))

	)

322 #ià
__GNUC_PREREQ
 (4,3)

323 
	#__ex‹º_®ways_šlše
 \

324 
__®ways_šlše
 
	`__©Œibu‹__
 ((
__gnu_šlše__
, 
__¬tificŸl__
))

	)

326 
	#__ex‹º_®ways_šlše
 \

327 
__®ways_šlše
 
	`__©Œibu‹__
 ((
__gnu_šlše__
))

	)

330 
	#__ex‹º_šlše
 
__šlše


	)

331 #ià
__GNUC_PREREQ
 (4,3)

332 
	#__ex‹º_®ways_šlše
 \

333 
__®ways_šlše
 
	`__©Œibu‹__
 ((
__¬tificŸl__
))

	)

335 
	#__ex‹º_®ways_šlše
 
__®ways_šlše


	)

342 #ià
__GNUC_PREREQ
 (4,3)

343 
	#__va_¬g_·ck
(è
	`__butš_va_¬g_·ck
 ()

	)

344 
	#__va_¬g_·ck_Ën
(è
	`__butš_va_¬g_·ck_Ën
 ()

	)

351 #ià!
__GNUC_PREREQ
 (2,8)

352 
	#__ex‹nsiÚ__


	)

356 #ià!
__GNUC_PREREQ
 (2,92)

357 
	#__»¡riù


	)

363 #ià
__GNUC_PREREQ
 (3,1è&& !
defšed
 
__GNUG__


364 
	#__»¡riù_¬r
 
__»¡riù


	)

366 #ifdeà
__GNUC__


367 
	#__»¡riù_¬r


	)

369 #ià
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

370 
	#__»¡riù_¬r
 
»¡riù


	)

373 
	#__»¡riù_¬r


	)

378 
	~<b™s/wÜdsize.h
>

380 #ià
defšed
 
__LONG_DOUBLE_MATH_OPTIONAL
 && defšed 
__NO_LONG_DOUBLE_MATH


381 
	#__LDBL_COMPAT
 1

	)

382 #ifdeà
__REDIRECT


383 
	#__LDBL_REDIR1
(
Çme
, 
´Ùo
, 
®Ÿs
è
	`__REDIRECT
 (Çme,…rÙo,‡lŸs)

	)

384 
	#__LDBL_REDIR
(
Çme
, 
´Ùo
) \

385 
	`__LDBL_REDIR1
 (
Çme
, 
´Ùo
, 
__Ædbl_
##Çme)

	)

386 
	#__LDBL_REDIR1_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
è
	`__REDIRECT_NTH
 (Çme,…rÙo,‡lŸs)

	)

387 
	#__LDBL_REDIR_NTH
(
Çme
, 
´Ùo
) \

388 
	`__LDBL_REDIR1_NTH
 (
Çme
, 
´Ùo
, 
__Ædbl_
##Çme)

	)

389 
	#__LDBL_REDIR1_DECL
(
Çme
, 
®Ÿs
) \

390 
	`__ty³of
 (
Çme
èÇm
	`__asm
 (
	`__ASMNAME
 (#®Ÿs));

	)

391 
	#__LDBL_REDIR_DECL
(
Çme
) \

392 
	`__ty³of
 (
Çme
èÇm
	`__asm
 (
	`__ASMNAME
 ("__Ædbl_" #Çme));

	)

393 
	#__REDIRECT_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

394 
	`__LDBL_REDIR1
 (
Çme
, 
´Ùo
, 
__Ædbl_
##
®Ÿs
)

	)

395 
	#__REDIRECT_NTH_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

396 
	`__LDBL_REDIR1_NTH
 (
Çme
, 
´Ùo
, 
__Ædbl_
##
®Ÿs
)

	)

399 #ià!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT


400 
	#__LDBL_REDIR1
(
Çme
, 
´Ùo
, 
®Ÿs
èÇm
	)
proto

401 
	#__LDBL_REDIR
(
Çme
, 
´Ùo
èÇm
	)
proto

402 
	#__LDBL_REDIR1_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
èÇm´ÙØ
__THROW


	)

403 
	#__LDBL_REDIR_NTH
(
Çme
, 
´Ùo
èÇm´ÙØ
__THROW


	)

404 
	#__LDBL_REDIR_DECL
(
Çme
)

	)

405 #ifdeà
__REDIRECT


406 
	#__REDIRECT_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
è
	`__REDIRECT
 (Çme,…rÙo,‡lŸs)

	)

407 
	#__REDIRECT_NTH_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

408 
	`__REDIRECT_NTH
 (
Çme
, 
´Ùo
, 
®Ÿs
)

	)

	@/usr/include/sys/select.h

22 #iâdeà
_SYS_SELECT_H


23 
	#_SYS_SELECT_H
 1

	)

25 
	~<ã©u»s.h
>

28 
	~<b™s/ty³s.h
>

31 
	~<b™s/£Ëù.h
>

34 
	~<b™s/sig£t.h
>

36 #iâdeà
__sig£t_t_defšed


37 
	#__sig£t_t_defšed


	)

38 
__sig£t_t
 
	tsig£t_t
;

42 
	#__Ãed_time_t


	)

43 
	#__Ãed_time¥ec


	)

44 
	~<time.h
>

45 
	#__Ãed_timev®


	)

46 
	~<b™s/time.h
>

48 #iâdeà
__su£cÚds_t_defšed


49 
__su£cÚds_t
 
	tsu£cÚds_t
;

50 
	#__su£cÚds_t_defšed


	)

55 
	t__fd_mask
;

58 #undeà
__NFDBITS


60 
	#__NFDBITS
 (8 * (è (
__fd_mask
))

	)

61 
	#__FD_ELT
(
d
è((dè/ 
__NFDBITS
)

	)

62 
	#__FD_MASK
(
d
è((
__fd_mask
è1 << ((dè% 
__NFDBITS
))

	)

69 #ifdeà
__USE_XOPEN


70 
__fd_mask
 
	mfds_b™s
[
__FD_SETSIZE
 / 
__NFDBITS
];

71 
	#__FDS_BITS
(
£t
è((£t)->
fds_b™s
)

	)

73 
__fd_mask
 
	m__fds_b™s
[
__FD_SETSIZE
 / 
__NFDBITS
];

74 
	#__FDS_BITS
(
£t
è((£t)->
__fds_b™s
)

	)

76 } 
	tfd_£t
;

79 
	#FD_SETSIZE
 
__FD_SETSIZE


	)

81 #ifdeà
__USE_MISC


83 
__fd_mask
 
	tfd_mask
;

86 
	#NFDBITS
 
__NFDBITS


	)

91 
	#FD_SET
(
fd
, 
fd£
è
	`__FD_SET
 (fd, fd£)

	)

92 
	#FD_CLR
(
fd
, 
fd£
è
	`__FD_CLR
 (fd, fd£)

	)

93 
	#FD_ISSET
(
fd
, 
fd£
è
	`__FD_ISSET
 (fd, fd£)

	)

94 
	#FD_ZERO
(
fd£
è
	`__FD_ZERO
 (fd£)

	)

97 
__BEGIN_DECLS


107 
£Ëù
 (
__nfds
, 
fd_£t
 *
__»¡riù
 
__»adfds
,

108 
fd_£t
 *
__»¡riù
 
__wr™efds
,

109 
fd_£t
 *
__»¡riù
 
__exû±fds
,

110 
timev®
 *
__»¡riù
 
__timeout
);

112 #ifdeà
__USE_XOPEN2K


119 
p£Ëù
 (
__nfds
, 
fd_£t
 *
__»¡riù
 
__»adfds
,

120 
fd_£t
 *
__»¡riù
 
__wr™efds
,

121 
fd_£t
 *
__»¡riù
 
__exû±fds
,

122 cÚ¡ 
time¥ec
 *
__»¡riù
 
__timeout
,

123 cÚ¡ 
__sig£t_t
 *
__»¡riù
 
__sigmask
);

128 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__GNUC__


129 
	~<b™s/£Ëù2.h
>

132 
	g__END_DECLS


	@/usr/include/sys/ttydefaults.h

40 #iâdeà
_SYS_TTYDEFAULTS_H_


41 
	#_SYS_TTYDEFAULTS_H_


	)

46 
	#TTYDEF_IFLAG
 (
BRKINT
 | 
ISTRIP
 | 
ICRNL
 | 
IMAXBEL
 | 
IXON
 | 
IXANY
)

	)

47 
	#TTYDEF_OFLAG
 (
OPOST
 | 
ONLCR
 | 
XTABS
)

	)

48 
	#TTYDEF_LFLAG
 (
ECHO
 | 
ICANON
 | 
ISIG
 | 
IEXTEN
 | 
ECHOE
|
ECHOKE
|
ECHOCTL
)

	)

49 
	#TTYDEF_CFLAG
 (
CREAD
 | 
CS7
 | 
PARENB
 | 
HUPCL
)

	)

50 
	#TTYDEF_SPEED
 (
B9600
)

	)

55 
	#CTRL
(
x
è(x&037)

	)

56 
	#CEOF
 
	`CTRL
('d')

	)

57 #ifdeà
_POSIX_VDISABLE


58 
	#CEOL
 
_POSIX_VDISABLE


	)

60 
	#CEOL
 '\0'

	)

62 
	#CERASE
 0177

	)

63 
	#CINTR
 
	`CTRL
('c')

	)

64 #ifdeà
_POSIX_VDISABLE


65 
	#CSTATUS
 
_POSIX_VDISABLE


	)

67 
	#CSTATUS
 '\0'

	)

69 
	#CKILL
 
	`CTRL
('u')

	)

70 
	#CMIN
 1

	)

71 
	#CQUIT
 034

	)

72 
	#CSUSP
 
	`CTRL
('z')

	)

73 
	#CTIME
 0

	)

74 
	#CDSUSP
 
	`CTRL
('y')

	)

75 
	#CSTART
 
	`CTRL
('q')

	)

76 
	#CSTOP
 
	`CTRL
('s')

	)

77 
	#CLNEXT
 
	`CTRL
('v')

	)

78 
	#CDISCARD
 
	`CTRL
('o')

	)

79 
	#CWERASE
 
	`CTRL
('w')

	)

80 
	#CREPRINT
 
	`CTRL
('r')

	)

81 
	#CEOT
 
CEOF


	)

83 
	#CBRK
 
CEOL


	)

84 
	#CRPRNT
 
CREPRINT


	)

85 
	#CFLUSH
 
CDISCARD


	)

93 #ifdeà
TTYDEFCHARS


94 
cc_t
 
	g‰ydefch¬s
[
NCCS
] = {

95 
CEOF
, 
CEOL
, CEOL, 
CERASE
, 
CWERASE
, 
CKILL
, 
CREPRINT
,

96 
_POSIX_VDISABLE
, 
CINTR
, 
CQUIT
, 
CSUSP
, 
CDSUSP
, 
CSTART
, 
CSTOP
, 
CLNEXT
,

97 
CDISCARD
, 
CMIN
, 
CTIME
, 
CSTATUS
, 
_POSIX_VDISABLE


99 #undeà
TTYDEFCHARS


	@/usr/include/sys/types.h

23 #iâdef 
_SYS_TYPES_H


24 
	#_SYS_TYPES_H
 1

	)

26 
	~<ã©u»s.h
>

28 
	g__BEGIN_DECLS


30 
	~<b™s/ty³s.h
>

32 #ifdef 
__USE_BSD


33 #iâdeà
__u_ch¬_defšed


34 
__u_ch¬
 
	tu_ch¬
;

35 
__u_shÜt
 
	tu_shÜt
;

36 
__u_št
 
	tu_št
;

37 
__u_lÚg
 
	tu_lÚg
;

38 
__quad_t
 
	tquad_t
;

39 
__u_quad_t
 
	tu_quad_t
;

40 
__fsid_t
 
	tfsid_t
;

41 
	#__u_ch¬_defšed


	)

45 
__loff_t
 
	tloff_t
;

47 #iâdeà
__šo_t_defšed


48 #iâdeà
__USE_FILE_OFFSET64


49 
__šo_t
 
	tšo_t
;

51 
__šo64_t
 
	tšo_t
;

53 
	#__šo_t_defšed


	)

55 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__šo64_t_defšed


56 
__šo64_t
 
	tšo64_t
;

57 
	#__šo64_t_defšed


	)

60 #iâdeà
__dev_t_defšed


61 
__dev_t
 
	tdev_t
;

62 
	#__dev_t_defšed


	)

65 #iâdeà
__gid_t_defšed


66 
__gid_t
 
	tgid_t
;

67 
	#__gid_t_defšed


	)

70 #iâdeà
__mode_t_defšed


71 
__mode_t
 
	tmode_t
;

72 
	#__mode_t_defšed


	)

75 #iâdeà
__Æšk_t_defšed


76 
__Æšk_t
 
	tÆšk_t
;

77 
	#__Æšk_t_defšed


	)

80 #iâdeà
__uid_t_defšed


81 
__uid_t
 
	tuid_t
;

82 
	#__uid_t_defšed


	)

85 #iâdeà
__off_t_defšed


86 #iâdeà
__USE_FILE_OFFSET64


87 
__off_t
 
	toff_t
;

89 
__off64_t
 
	toff_t
;

91 
	#__off_t_defšed


	)

93 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


94 
__off64_t
 
	toff64_t
;

95 
	#__off64_t_defšed


	)

98 #iâdeà
__pid_t_defšed


99 
__pid_t
 
	tpid_t
;

100 
	#__pid_t_defšed


	)

103 #ià(
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8
) \

104 && !
defšed
 
__id_t_defšed


105 
__id_t
 
	tid_t
;

106 
	#__id_t_defšed


	)

109 #iâdeà
__ssize_t_defšed


110 
__ssize_t
 
	tssize_t
;

111 
	#__ssize_t_defšed


	)

114 #ifdef 
__USE_BSD


115 #iâdeà
__daddr_t_defšed


116 
__daddr_t
 
	tdaddr_t
;

117 
__ÿddr_t
 
	tÿddr_t
;

118 
	#__daddr_t_defšed


	)

122 #ià(
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN
è&& !defšed 
__key_t_defšed


123 
__key_t
 
	tkey_t
;

124 
	#__key_t_defšed


	)

127 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


128 
	#__Ãed_şock_t


	)

130 
	#__Ãed_time_t


	)

131 
	#__Ãed_tim”_t


	)

132 
	#__Ãed_şockid_t


	)

133 
	~<time.h
>

135 #ifdeà
__USE_XOPEN


136 #iâdeà
__u£cÚds_t_defšed


137 
__u£cÚds_t
 
	tu£cÚds_t
;

138 
	#__u£cÚds_t_defšed


	)

140 #iâdeà
__su£cÚds_t_defšed


141 
__su£cÚds_t
 
	tsu£cÚds_t
;

142 
	#__su£cÚds_t_defšed


	)

146 
	#__Ãed_size_t


	)

147 
	~<¡ddef.h
>

149 #ifdeà
__USE_MISC


151 
	tulÚg
;

152 
	tushÜt
;

153 
	tušt
;

158 #ià!
__GNUC_PREREQ
 (2, 7)

161 #iâdeà
__št8_t_defšed


162 
	#__št8_t_defšed


	)

163 
	tšt8_t
;

164 
	tšt16_t
;

165 
	tšt32_t
;

166 #ià
__WORDSIZE
 == 64

167 
	tšt64_t
;

168 #–ià
__GLIBC_HAVE_LONG_LONG


169 
__ex‹nsiÚ__
 
	tšt64_t
;

174 
	tu_št8_t
;

175 
	tu_št16_t
;

176 
	tu_št32_t
;

177 #ià
__WORDSIZE
 == 64

178 
	tu_št64_t
;

179 #–ià
__GLIBC_HAVE_LONG_LONG


180 
__ex‹nsiÚ__
 
	tu_št64_t
;

183 
	t»gi¡”_t
;

188 
	#__štN_t
(
N
, 
MODE
) \

189 ##
	tN
##
	t_t
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	tMODE
)))

	)

190 
	t__u_štN_t
(
	tN
, 
	tMODE
) \

191 
	tu_št
##
	tN
##
	t_t
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	tMODE
)))

	)

193 #iâdeà
	t__št8_t_defšed


194 
	t__št8_t_defšed


	)

195 
	t__štN_t
 (8, 
	t__QI__
);

196 
__štN_t
 (16, 
__HI__
);

197 
__štN_t
 (32, 
__SI__
);

198 
__štN_t
 (64, 
__DI__
);

201 
__u_štN_t
 (8, 
__QI__
);

202 
__u_štN_t
 (16, 
__HI__
);

203 
__u_štN_t
 (32, 
__SI__
);

204 
__u_štN_t
 (64, 
__DI__
);

206 
	t»gi¡”_t
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	t__wÜd__
)));

212 
	#__BIT_TYPES_DEFINED__
 1

	)

215 #ifdef 
__USE_BSD


217 
	~<’dŸn.h
>

220 
	~<sys/£Ëù.h
>

223 
	~<sys/sysmaüos.h
>

227 #ià(
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8
) \

228 && !
defšed
 
__blksize_t_defšed


229 
__blksize_t
 
	tblksize_t
;

230 
	#__blksize_t_defšed


	)

234 #iâdeà
__USE_FILE_OFFSET64


235 #iâdeà
__blkút_t_defšed


236 
__blkút_t
 
	tblkút_t
;

237 
	#__blkút_t_defšed


	)

239 #iâdeà
__fsblkút_t_defšed


240 
__fsblkút_t
 
	tfsblkút_t
;

241 
	#__fsblkút_t_defšed


	)

243 #iâdeà
__fsfút_t_defšed


244 
__fsfút_t
 
	tfsfút_t
;

245 
	#__fsfút_t_defšed


	)

248 #iâdeà
__blkút_t_defšed


249 
__blkút64_t
 
	tblkút_t
;

250 
	#__blkút_t_defšed


	)

252 #iâdeà
__fsblkút_t_defšed


253 
__fsblkút64_t
 
	tfsblkút_t
;

254 
	#__fsblkút_t_defšed


	)

256 #iâdeà
__fsfút_t_defšed


257 
__fsfút64_t
 
	tfsfút_t
;

258 
	#__fsfút_t_defšed


	)

262 #ifdeà
__USE_LARGEFILE64


263 
__blkút64_t
 
	tblkút64_t
;

264 
__fsblkút64_t
 
	tfsblkút64_t
;

265 
__fsfút64_t
 
	tfsfút64_t
;

270 #ià
defšed
 
__USE_POSIX199506
 || defšed 
__USE_UNIX98


271 
	~<b™s/±h»adty³s.h
>

274 
	g__END_DECLS


	@/usr/include/xlocale.h

21 #iâdeà
_XLOCALE_H


22 
	#_XLOCALE_H
 1

	)

28 
	s__loÿË_¡ruù


31 
__loÿË_d©a
 *
	m__loÿËs
[13];

34 cÚ¡ *
	m__ùy³_b
;

35 cÚ¡ *
	m__ùy³_tŞow”
;

36 cÚ¡ *
	m__ùy³_touµ”
;

39 cÚ¡ *
	m__Çmes
[13];

40 } *
	t__loÿË_t
;

43 
__loÿË_t
 
	tloÿË_t
;

	@/usr/include/asm-generic/errno-base.h

1 #iâdeà
_ASM_GENERIC_ERRNO_BASE_H


2 
	#_ASM_GENERIC_ERRNO_BASE_H


	)

4 
	#EPERM
 1

	)

5 
	#ENOENT
 2

	)

6 
	#ESRCH
 3

	)

7 
	#EINTR
 4

	)

8 
	#EIO
 5

	)

9 
	#ENXIO
 6

	)

10 
	#E2BIG
 7

	)

11 
	#ENOEXEC
 8

	)

12 
	#EBADF
 9

	)

13 
	#ECHILD
 10

	)

14 
	#EAGAIN
 11

	)

15 
	#ENOMEM
 12

	)

16 
	#EACCES
 13

	)

17 
	#EFAULT
 14

	)

18 
	#ENOTBLK
 15

	)

19 
	#EBUSY
 16

	)

20 
	#EEXIST
 17

	)

21 
	#EXDEV
 18

	)

22 
	#ENODEV
 19

	)

23 
	#ENOTDIR
 20

	)

24 
	#EISDIR
 21

	)

25 
	#EINVAL
 22

	)

26 
	#ENFILE
 23

	)

27 
	#EMFILE
 24

	)

28 
	#ENOTTY
 25

	)

29 
	#ETXTBSY
 26

	)

30 
	#EFBIG
 27

	)

31 
	#ENOSPC
 28

	)

32 
	#ESPIPE
 29

	)

33 
	#EROFS
 30

	)

34 
	#EMLINK
 31

	)

35 
	#EPIPE
 32

	)

36 
	#EDOM
 33

	)

37 
	#ERANGE
 34

	)

	@/usr/include/asm-generic/int-ll64.h

8 #iâdeà
_ASM_GENERIC_INT_LL64_H


9 
	#_ASM_GENERIC_INT_LL64_H


	)

11 
	~<asm/b™¥”lÚg.h
>

13 #iâdeà
__ASSEMBLY__


19 
__sigÃd__
 
	t__s8
;

20 
	t__u8
;

22 
__sigÃd__
 
	t__s16
;

23 
	t__u16
;

25 
__sigÃd__
 
	t__s32
;

26 
	t__u32
;

28 #ifdeà
__GNUC__


29 
__ex‹nsiÚ__
 
__sigÃd__
 
	t__s64
;

30 
__ex‹nsiÚ__
 
	t__u64
;

32 
__sigÃd__
 
	t__s64
;

33 
	t__u64
;

	@/usr/include/asm-generic/ipcbuf.h

1 #iâdeà
__ASM_GENERIC_IPCBUF_H


2 
	#__ASM_GENERIC_IPCBUF_H


	)

19 
	sc64_³rm
 {

20 
__k”Ãl_key_t
 
	mkey
;

21 
__k”Ãl_uid32_t
 
	muid
;

22 
__k”Ãl_gid32_t
 
	mgid
;

23 
__k”Ãl_uid32_t
 
	mcuid
;

24 
__k”Ãl_gid32_t
 
	mcgid
;

25 
__k”Ãl_mode_t
 
	mmode
;

27 
	m__·d1
[4 - (
__k”Ãl_mode_t
)];

28 
	m£q
;

29 
	m__·d2
;

30 
	m__unu£d1
;

31 
	m__unu£d2
;

	@/usr/include/asm-generic/sockios.h

1 #iâdeà
__ASM_GENERIC_SOCKIOS_H


2 
	#__ASM_GENERIC_SOCKIOS_H


	)

5 
	#FIOSETOWN
 0x8901

	)

6 
	#SIOCSPGRP
 0x8902

	)

7 
	#FIOGETOWN
 0x8903

	)

8 
	#SIOCGPGRP
 0x8904

	)

9 
	#SIOCATMARK
 0x8905

	)

10 
	#SIOCGSTAMP
 0x8906

	)

11 
	#SIOCGSTAMPNS
 0x8907

	)

	@/usr/include/asm/bitsperlong.h

1 #iâdeà
__ASM_X86_BITSPERLONG_H


2 
	#__ASM_X86_BITSPERLONG_H


	)

4 #ifdeà
__x86_64__


5 
	#__BITS_PER_LONG
 64

	)

7 
	#__BITS_PER_LONG
 32

	)

10 
	~<asm-g’”ic/b™¥”lÚg.h
>

	@/usr/include/asm/swab.h

1 #iâdeà
_ASM_X86_SWAB_H


2 
	#_ASM_X86_SWAB_H


	)

4 
	~<lšux/ty³s.h
>

7 
__šlše__
 
__u32
 
	$__¬ch_swab32
(
__u32
 
v®
)

9 #ifdeà
__i386__


10 #ifdeà
CONFIG_X86_BSWAP


11 
	`__asm__
("bsw­ %0" : "ô" (
v®
) : "0" (val));

13 
	`__asm__
("xchgb %b0,%h0\n\t"

16 : "=q" (
v®
)

17 : "0" (
v®
));

21 
	`__asm__
("bswapl %0"

22 : "ô" (
v®
)

23 : "0" (
v®
));

25  
v®
;

26 
	}
}

27 
	#__¬ch_swab32
 
__¬ch_swab32


	)

29 
__šlše__
 
__u64
 
	$__¬ch_swab64
(
__u64
 
v®
)

31 #ifdeà
__i386__


34 
__u32
 
a
;

35 
__u32
 
b
;

36 } 
s
;

37 
__u64
 
u
;

38 } 
v
;

39 
v
.
u
 = 
v®
;

40 #ifdeà
CONFIG_X86_BSWAP


41 
	`__asm__
("bswapl %0 ; bswapl %1 ; xchgl %0,%1"

42 : "ô" (
v
.
s
.
a
), "ô" (v.s.
b
)

43 : "0" (
v
.
s
.
a
), "1" (v.s.
b
));

45 
v
.
s
.
a
 = 
	`__¬ch_swab32
(v.s.a);

46 
v
.
s
.
b
 = 
	`__¬ch_swab32
(v.s.b);

47 
	`__asm__
("xchgl %0,%1"

48 : "ô" (
v
.
s
.
a
), "ô" (v.s.
b
)

49 : "0" (
v
.
s
.
a
), "1" (v.s.
b
));

51  
v
.
u
;

53 
	`__asm__
("bswapq %0"

54 : "ô" (
v®
)

55 : "0" (
v®
));

56  
v®
;

58 
	}
}

59 
	#__¬ch_swab64
 
__¬ch_swab64


	)

	@/usr/include/bits/pthreadtypes.h

20 #iâdeà
_BITS_PTHREADTYPES_H


21 
	#_BITS_PTHREADTYPES_H
 1

	)

23 
	~<b™s/wÜdsize.h
>

25 #ià
__WORDSIZE
 == 64

26 
	#__SIZEOF_PTHREAD_ATTR_T
 56

	)

27 
	#__SIZEOF_PTHREAD_MUTEX_T
 40

	)

28 
	#__SIZEOF_PTHREAD_MUTEXATTR_T
 4

	)

29 
	#__SIZEOF_PTHREAD_COND_T
 48

	)

30 
	#__SIZEOF_PTHREAD_CONDATTR_T
 4

	)

31 
	#__SIZEOF_PTHREAD_RWLOCK_T
 56

	)

32 
	#__SIZEOF_PTHREAD_RWLOCKATTR_T
 8

	)

33 
	#__SIZEOF_PTHREAD_BARRIER_T
 32

	)

34 
	#__SIZEOF_PTHREAD_BARRIERATTR_T
 4

	)

36 
	#__SIZEOF_PTHREAD_ATTR_T
 36

	)

37 
	#__SIZEOF_PTHREAD_MUTEX_T
 24

	)

38 
	#__SIZEOF_PTHREAD_MUTEXATTR_T
 4

	)

39 
	#__SIZEOF_PTHREAD_COND_T
 48

	)

40 
	#__SIZEOF_PTHREAD_CONDATTR_T
 4

	)

41 
	#__SIZEOF_PTHREAD_RWLOCK_T
 32

	)

42 
	#__SIZEOF_PTHREAD_RWLOCKATTR_T
 8

	)

43 
	#__SIZEOF_PTHREAD_BARRIER_T
 20

	)

44 
	#__SIZEOF_PTHREAD_BARRIERATTR_T
 4

	)

50 
	t±h»ad_t
;

55 
	m__size
[
__SIZEOF_PTHREAD_ATTR_T
];

56 
	m__®ign
;

57 } 
	t±h»ad_©Œ_t
;

60 #ià
__WORDSIZE
 == 64

61 
	s__±h»ad_š‹º®_li¡


63 
__±h»ad_š‹º®_li¡
 *
	m__´ev
;

64 
__±h»ad_š‹º®_li¡
 *
	m__Ãxt
;

65 } 
	t__±h»ad_li¡_t
;

67 
	s__±h»ad_š‹º®_¦i¡


69 
__±h»ad_š‹º®_¦i¡
 *
	m__Ãxt
;

70 } 
	t__±h»ad_¦i¡_t
;

78 
	s__±h»ad_mu‹x_s


80 
	m__lock
;

81 
	m__couÁ
;

82 
	m__owÃr
;

83 #ià
__WORDSIZE
 == 64

84 
	m__nu£rs
;

88 
	m__kšd
;

89 #ià
__WORDSIZE
 == 64

90 
	m__¥šs
;

91 
__±h»ad_li¡_t
 
	m__li¡
;

92 
	#__PTHREAD_MUTEX_HAVE_PREV
 1

	)

94 
	m__nu£rs
;

95 
__ex‹nsiÚ__
 union

97 
	m__¥šs
;

98 
__±h»ad_¦i¡_t
 
	m__li¡
;

101 } 
	m__d©a
;

102 
	m__size
[
__SIZEOF_PTHREAD_MUTEX_T
];

103 
	m__®ign
;

104 } 
	t±h»ad_mu‹x_t
;

108 
	m__size
[
__SIZEOF_PTHREAD_MUTEXATTR_T
];

109 
	m__®ign
;

110 } 
	t±h»ad_mu‹x©Œ_t
;

119 
	m__lock
;

120 
	m__fu‹x
;

121 
__ex‹nsiÚ__
 
	m__tÙ®_£q
;

122 
__ex‹nsiÚ__
 
	m__wakeup_£q
;

123 
__ex‹nsiÚ__
 
	m__wok’_£q
;

124 *
	m__mu‹x
;

125 
	m__nwa™”s
;

126 
	m__brßdÿ¡_£q
;

127 } 
	m__d©a
;

128 
	m__size
[
__SIZEOF_PTHREAD_COND_T
];

129 
__ex‹nsiÚ__
 
	m__®ign
;

130 } 
	t±h»ad_cÚd_t
;

134 
	m__size
[
__SIZEOF_PTHREAD_CONDATTR_T
];

135 
	m__®ign
;

136 } 
	t±h»ad_cÚd©Œ_t
;

140 
	t±h»ad_key_t
;

144 
	t±h»ad_Úû_t
;

147 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


152 #ià
__WORDSIZE
 == 64

155 
	m__lock
;

156 
	m__Ä_»ad”s
;

157 
	m__»ad”s_wakeup
;

158 
	m__wr™”_wakeup
;

159 
	m__Ä_»ad”s_queued
;

160 
	m__Ä_wr™”s_queued
;

161 
	m__wr™”
;

162 
	m__sh¬ed
;

163 
	m__·d1
;

164 
	m__·d2
;

167 
	m__æags
;

168 } 
	m__d©a
;

172 
	m__lock
;

173 
	m__Ä_»ad”s
;

174 
	m__»ad”s_wakeup
;

175 
	m__wr™”_wakeup
;

176 
	m__Ä_»ad”s_queued
;

177 
	m__Ä_wr™”s_queued
;

180 
	m__æags
;

181 
	m__sh¬ed
;

182 
	m__·d1
;

183 
	m__·d2
;

184 
	m__wr™”
;

185 } 
	m__d©a
;

187 
	m__size
[
__SIZEOF_PTHREAD_RWLOCK_T
];

188 
	m__®ign
;

189 } 
	t±h»ad_rwlock_t
;

193 
	m__size
[
__SIZEOF_PTHREAD_RWLOCKATTR_T
];

194 
	m__®ign
;

195 } 
	t±h»ad_rwlock©Œ_t
;

199 #ifdeà
__USE_XOPEN2K


201 vŞ©
	t±h»ad_¥šlock_t
;

208 
	m__size
[
__SIZEOF_PTHREAD_BARRIER_T
];

209 
	m__®ign
;

210 } 
	t±h»ad_b¬r›r_t
;

214 
	m__size
[
__SIZEOF_PTHREAD_BARRIERATTR_T
];

215 
	m__®ign
;

216 } 
	t±h»ad_b¬r›¿‰r_t
;

220 #ià
__WORDSIZE
 == 32

222 
	#__ş—nup_fù_©Œibu‹
 
	`__©Œibu‹__
 ((
	`__»g·rm__
 (1)))

	)

	@/usr/include/bits/select.h

19 #iâdeà
_SYS_SELECT_H


23 
	~<b™s/wÜdsize.h
>

26 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

28 #ià
__WORDSIZE
 == 64

29 
	#__FD_ZERO_STOS
 "¡osq"

	)

31 
	#__FD_ZERO_STOS
 "¡o¦"

	)

34 
	#__FD_ZERO
(
fd¥
) \

36 
__d0
, 
__d1
; \

37 
__asm__
 
	`__vŞ©e__
 ("şd;„•; " 
__FD_ZERO_STOS
 \

38 : "=c" (
__d0
), "=D" (
__d1
) \

39 : "a" (0), "0" ( (
fd_£t
) \

40 /  (
__fd_mask
)), \

41 "1" (&
	`__FDS_BITS
 (
fd¥
)[0]) \

43 } 0)

	)

49 
	#__FD_ZERO
(
£t
) \

51 
__i
; \

52 
fd_£t
 *
__¬r
 = (
£t
); \

53 
__i
 = 0; __˜<  (
fd_£t
è/  (
__fd_mask
); ++__i) \

54 
	`__FDS_BITS
 (
__¬r
)[
__i
] = 0; \

55 } 0)

	)

59 
	#__FD_SET
(
d
, 
£t
) \

60 ((è(
	`__FDS_BITS
 (
£t
)[
	`__FD_ELT
 (
d
)] |ğ
	`__FD_MASK
 (d)))

	)

61 
	#__FD_CLR
(
d
, 
£t
) \

62 ((è(
	`__FDS_BITS
 (
£t
)[
	`__FD_ELT
 (
d
)] &ğ~
	`__FD_MASK
 (d)))

	)

63 
	#__FD_ISSET
(
d
, 
£t
) \

64 ((
	`__FDS_BITS
 (
£t
)[
	`__FD_ELT
 (
d
)] & 
	`__FD_MASK
 (d)è!ğ0)

	)

	@/usr/include/bits/select2.h

20 #iâdeà
_SYS_SELECT_H


25 
__fd–t_chk
 (
__d
);

26 
	$__fd–t_w¬n
 (
__d
)

27 
	`__w¬Ç‰r
 ("bit outside of fd_set selected");

28 #undeà
__FD_ELT


29 
	#__FD_ELT
(
d
) \

30 
__ex‹nsiÚ__
 \

31 ({ 
__d
 = (
d
); \

32 (
	`__butš_cÚ¡ªt_p
 (
__d
) \

33 ? (
__d
 >ğ
__FD_SETSIZE
 \

34 ? 
	`__fd–t_w¬n
 (
__d
è: (__d / 
__NFDBITS
)) \

35 : 
	`__fd–t_chk
 (
__d
)); 
	}
})

	)

	@/usr/include/bits/sigset.h

21 #iâdef 
_SIGSET_H_ty³s


22 
	#_SIGSET_H_ty³s
 1

	)

24 
	t__sig_©omic_t
;

28 
	#_SIGSET_NWORDS
 (1024 / (8 *  ()))

	)

31 
	m__v®
[
_SIGSET_NWORDS
];

32 } 
	t__sig£t_t
;

43 #ià!
defšed
 
_SIGSET_H_âs
 && defšed 
_SIGNAL_H


44 
	#_SIGSET_H_âs
 1

	)

46 #iâdeà
_EXTERN_INLINE


47 
	#_EXTERN_INLINE
 
__ex‹º_šlše


	)

51 
	#__sigmask
(
sig
) \

52 (((è1è<< (((
sig
è- 1è% (8 *  ())))

	)

55 
	#__sigwÜd
(
sig
è(((sigè- 1è/ (8 *  ()))

	)

57 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

58 
	#__sigem±y£t
(
£t
) \

59 (
	`__ex‹nsiÚ__
 ({ 
__út
 = 
_SIGSET_NWORDS
; \

60 
sig£t_t
 *
__£t
 = (
£t
); \

61 --
__út
 >ğ0è
__£t
->
__v®
[__cnt] = 0; \

62 0; }))

	)

63 
	#__sigfl£t
(
£t
) \

64 (
	`__ex‹nsiÚ__
 ({ 
__út
 = 
_SIGSET_NWORDS
; \

65 
sig£t_t
 *
__£t
 = (
£t
); \

66 --
__út
 >ğ0è
__£t
->
__v®
[__cnt] = ~0UL; \

67 0; }))

	)

69 #ifdeà
__USE_GNU


73 
	#__sigi£m±y£t
(
£t
) \

74 (
	`__ex‹nsiÚ__
 ({ 
__út
 = 
_SIGSET_NWORDS
; \

75 cÚ¡ 
sig£t_t
 *
__£t
 = (
£t
); \

76 
__»t
 = 
__£t
->
__v®
[--
__út
]; \

77 !
__»t
 && --
__út
 >= 0) \

78 
__»t
 = 
__£t
->
__v®
[
__út
]; \

79 
__»t
 =ğ0; }))

	)

80 
	#__sigªd£t
(
de¡
, 
Ëá
, 
right
) \

81 (
	`__ex‹nsiÚ__
 ({ 
__út
 = 
_SIGSET_NWORDS
; \

82 
sig£t_t
 *
__de¡
 = (
de¡
); \

83 cÚ¡ 
sig£t_t
 *
__Ëá
 = (
Ëá
); \

84 cÚ¡ 
sig£t_t
 *
__right
 = (
right
); \

85 --
__út
 >= 0) \

86 
__de¡
->
__v®
[
__út
] = (
__Ëá
->__val[__cnt] \

87 & 
__right
->
__v®
[
__út
]); \

88 0; }))

	)

89 
	#__sigÜ£t
(
de¡
, 
Ëá
, 
right
) \

90 (
	`__ex‹nsiÚ__
 ({ 
__út
 = 
_SIGSET_NWORDS
; \

91 
sig£t_t
 *
__de¡
 = (
de¡
); \

92 cÚ¡ 
sig£t_t
 *
__Ëá
 = (
Ëá
); \

93 cÚ¡ 
sig£t_t
 *
__right
 = (
right
); \

94 --
__út
 >= 0) \

95 
__de¡
->
__v®
[
__út
] = (
__Ëá
->__val[__cnt] \

96 | 
__right
->
__v®
[
__út
]); \

97 0; }))

	)

104 
__sigismemb”
 (
__cÚ¡
 
__sig£t_t
 *, );

105 
__sigadd£t
 (
__sig£t_t
 *, );

106 
__sigd–£t
 (
__sig£t_t
 *, );

108 #ifdeà
__USE_EXTERN_INLINES


109 
	#__SIGSETFN
(
NAME
, 
BODY
, 
CONST
) \

110 
_EXTERN_INLINE
 \

111 
	`NAME
 (
CONST
 
__sig£t_t
 *
__£t
, 
__sig
) \

113 
__mask
 = 
	`__sigmask
 (
__sig
); \

114 
__wÜd
 = 
	`__sigwÜd
 (
__sig
); \

115  
BODY
; \

116 }

	)

118 
__SIGSETFN
 (
__sigismemb”
, (
__£t
->
__v®
[
__wÜd
] & 
__mask
è? 1 : 0, 
__cÚ¡
)

119 
__SIGSETFN
 (
__sigadd£t
, ((
__£t
->
__v®
[
__wÜd
] |ğ
__mask
), 0), )

120 
__SIGSETFN
 (
__sigd–£t
, ((
__£t
->
__v®
[
__wÜd
] &ğ~
__mask
), 0), )

122 #undeà
__SIGSETFN


	@/usr/include/bits/timex.h

19 #iâdef 
_BITS_TIMEX_H


20 
	#_BITS_TIMEX_H
 1

	)

24 
	stimex


26 
	mmodes
;

27 
	moff£t
;

28 
	mäeq
;

29 
	mmax”rÜ
;

30 
	me¡”rÜ
;

31 
	m¡©us
;

32 
	mcÚ¡ªt
;

33 
	m´ecisiÚ
;

34 
	mtŞ”ªû
;

35 
timev®
 
	mtime
;

36 
	mtick
;

38 
	mµsäeq
;

39 
	mj™‹r
;

40 
	mshiá
;

41 
	m¡ab
;

42 
	mj™út
;

43 
	mÿlút
;

44 
	m”rút
;

45 
	m¡bút
;

47 
	mi
;

56 
	#ADJ_OFFSET
 0x0001

	)

57 
	#ADJ_FREQUENCY
 0x0002

	)

58 
	#ADJ_MAXERROR
 0x0004

	)

59 
	#ADJ_ESTERROR
 0x0008

	)

60 
	#ADJ_STATUS
 0x0010

	)

61 
	#ADJ_TIMECONST
 0x0020

	)

62 
	#ADJ_TAI
 0x0080

	)

63 
	#ADJ_MICRO
 0x1000

	)

64 
	#ADJ_NANO
 0x2000

	)

65 
	#ADJ_TICK
 0x4000

	)

66 
	#ADJ_OFFSET_SINGLESHOT
 0x8001

	)

67 
	#ADJ_OFFSET_SS_READ
 0xa001

	)

70 
	#MOD_OFFSET
 
ADJ_OFFSET


	)

71 
	#MOD_FREQUENCY
 
ADJ_FREQUENCY


	)

72 
	#MOD_MAXERROR
 
ADJ_MAXERROR


	)

73 
	#MOD_ESTERROR
 
ADJ_ESTERROR


	)

74 
	#MOD_STATUS
 
ADJ_STATUS


	)

75 
	#MOD_TIMECONST
 
ADJ_TIMECONST


	)

76 
	#MOD_CLKB
 
ADJ_TICK


	)

77 
	#MOD_CLKA
 
ADJ_OFFSET_SINGLESHOT


	)

78 
	#MOD_TAI
 
ADJ_TAI


	)

79 
	#MOD_MICRO
 
ADJ_MICRO


	)

80 
	#MOD_NANO
 
ADJ_NANO


	)

84 
	#STA_PLL
 0x0001

	)

85 
	#STA_PPSFREQ
 0x0002

	)

86 
	#STA_PPSTIME
 0x0004

	)

87 
	#STA_FLL
 0x0008

	)

89 
	#STA_INS
 0x0010

	)

90 
	#STA_DEL
 0x0020

	)

91 
	#STA_UNSYNC
 0x0040

	)

92 
	#STA_FREQHOLD
 0x0080

	)

94 
	#STA_PPSSIGNAL
 0x0100

	)

95 
	#STA_PPSJITTER
 0x0200

	)

96 
	#STA_PPSWANDER
 0x0400

	)

97 
	#STA_PPSERROR
 0x0800

	)

99 
	#STA_CLOCKERR
 0x1000

	)

100 
	#STA_NANO
 0x2000

	)

101 
	#STA_MODE
 0x4000

	)

102 
	#STA_CLK
 0x8000

	)

105 
	#STA_RONLY
 (
STA_PPSSIGNAL
 | 
STA_PPSJITTER
 | 
STA_PPSWANDER
 | \

106 
STA_PPSERROR
 | 
STA_CLOCKERR
 | 
STA_NANO
 | 
STA_MODE
 | 
STA_CLK
)

	)

	@/usr/include/bits/typesizes.h

20 #iâdeà
_BITS_TYPES_H


24 #iâdef 
_BITS_TYPESIZES_H


25 
	#_BITS_TYPESIZES_H
 1

	)

30 
	#__DEV_T_TYPE
 
__UQUAD_TYPE


	)

31 
	#__UID_T_TYPE
 
__U32_TYPE


	)

32 
	#__GID_T_TYPE
 
__U32_TYPE


	)

33 
	#__INO_T_TYPE
 
__ULONGWORD_TYPE


	)

34 
	#__INO64_T_TYPE
 
__UQUAD_TYPE


	)

35 
	#__MODE_T_TYPE
 
__U32_TYPE


	)

36 
	#__NLINK_T_TYPE
 
__UWORD_TYPE


	)

37 
	#__OFF_T_TYPE
 
__SLONGWORD_TYPE


	)

38 
	#__OFF64_T_TYPE
 
__SQUAD_TYPE


	)

39 
	#__PID_T_TYPE
 
__S32_TYPE


	)

40 
	#__RLIM_T_TYPE
 
__ULONGWORD_TYPE


	)

41 
	#__RLIM64_T_TYPE
 
__UQUAD_TYPE


	)

42 
	#__BLKCNT_T_TYPE
 
__SLONGWORD_TYPE


	)

43 
	#__BLKCNT64_T_TYPE
 
__SQUAD_TYPE


	)

44 
	#__FSBLKCNT_T_TYPE
 
__ULONGWORD_TYPE


	)

45 
	#__FSBLKCNT64_T_TYPE
 
__UQUAD_TYPE


	)

46 
	#__FSFILCNT_T_TYPE
 
__ULONGWORD_TYPE


	)

47 
	#__FSFILCNT64_T_TYPE
 
__UQUAD_TYPE


	)

48 
	#__ID_T_TYPE
 
__U32_TYPE


	)

49 
	#__CLOCK_T_TYPE
 
__SLONGWORD_TYPE


	)

50 
	#__TIME_T_TYPE
 
__SLONGWORD_TYPE


	)

51 
	#__USECONDS_T_TYPE
 
__U32_TYPE


	)

52 
	#__SUSECONDS_T_TYPE
 
__SLONGWORD_TYPE


	)

53 
	#__DADDR_T_TYPE
 
__S32_TYPE


	)

54 
	#__SWBLK_T_TYPE
 
__SLONGWORD_TYPE


	)

55 
	#__KEY_T_TYPE
 
__S32_TYPE


	)

56 
	#__CLOCKID_T_TYPE
 
__S32_TYPE


	)

57 
	#__TIMER_T_TYPE
 *

	)

58 
	#__BLKSIZE_T_TYPE
 
__SLONGWORD_TYPE


	)

59 
	#__FSID_T_TYPE
 sŒuù { 
__v®
[2]; }

	)

60 
	#__SSIZE_T_TYPE
 
__SWORD_TYPE


	)

63 
	#__FD_SETSIZE
 1024

	)

	@/usr/include/ctype.h

24 #iâdef 
_CTYPE_H


25 
	#_CTYPE_H
 1

	)

27 
	~<ã©u»s.h
>

28 
	~<b™s/ty³s.h
>

30 
	g__BEGIN_DECLS


32 #iâdeà
_ISb™


41 
	~<’dŸn.h
>

42 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


43 
	#_ISb™
(
b™
è(1 << (b™))

	)

45 
	#_ISb™
(
b™
è((b™è< 8 ? ((1 << (b™)è<< 8è: ((1 << (b™)è>> 8))

	)

50 
	m_ISuµ”
 = 
_ISb™
 (0),

51 
	m_ISlow”
 = 
_ISb™
 (1),

52 
	m_IS®pha
 = 
_ISb™
 (2),

53 
	m_ISdig™
 = 
_ISb™
 (3),

54 
	m_ISxdig™
 = 
_ISb™
 (4),

55 
	m_IS¥aû
 = 
_ISb™
 (5),

56 
	m_IS´št
 = 
_ISb™
 (6),

57 
	m_ISg¿ph
 = 
_ISb™
 (7),

58 
	m_ISbÏnk
 = 
_ISb™
 (8),

59 
	m_ISúŒl
 = 
_ISb™
 (9),

60 
	m_ISpunù
 = 
_ISb™
 (10),

61 
	m_IS®num
 = 
_ISb™
 (11)

81 
__cÚ¡
 **
	$__ùy³_b_loc
 ()

82 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡
));

83 
__cÚ¡
 
__št32_t
 **
	$__ùy³_tŞow”_loc
 ()

84 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡
));

85 
__cÚ¡
 
__št32_t
 **
	$__ùy³_touµ”_loc
 ()

86 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡
));

89 #iâdeà
__ılu¥lus


90 
	#__isùy³
(
c
, 
ty³
) \

91 ((*
	`__ùy³_b_loc
 ())[(è(
c
)] & (è
ty³
)

	)

92 #–ià
defšed
 
__USE_EXTERN_INLINES


93 
	#__isùy³_f
(
ty³
) \

94 
__ex‹º_šlše
 \

95 
is
##
	`ty³
 (
__c
è
__THROW
 \

97  (*
	`__ùy³_b_loc
 ())[(è(
__c
)] & (è
_IS
##
ty³
; \

98 
	}

	)
}

101 
	#__i§scii
(
c
è(((cè& ~0x7fè=ğ0è

	)

102 
	#__tßscii
(
c
è((cè& 0x7fè

	)

104 
	#__exùy³
(
Çme
è
	`Çme
 (è
__THROW


	)

106 
__BEGIN_NAMESPACE_STD


112 
__exùy³
 (
i§Êum
);

113 
__exùy³
 (
i§Íha
);

114 
__exùy³
 (
isúŒl
);

115 
__exùy³
 (
isdig™
);

116 
__exùy³
 (
i¦ow”
);

117 
__exùy³
 (
isg¿ph
);

118 
__exùy³
 (
i¥ršt
);

119 
__exùy³
 (
i¥unù
);

120 
__exùy³
 (
is¥aû
);

121 
__exùy³
 (
isuµ”
);

122 
__exùy³
 (
isxdig™
);

126 
	$tŞow”
 (
__c
è
__THROW
;

129 
	$touµ”
 (
__c
è
__THROW
;

131 
__END_NAMESPACE_STD


135 #ifdef 
__USE_ISOC99


136 
__BEGIN_NAMESPACE_C99


138 
	`__exùy³
 (
isbÏnk
);

140 
__END_NAMESPACE_C99


143 #ifdeà
__USE_GNU


145 
	$isùy³
 (
__c
, 
__mask
è
__THROW
;

148 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


152 
	$i§scii
 (
__c
è
__THROW
;

156 
	$tßscii
 (
__c
è
__THROW
;

160 
	`__exùy³
 (
_touµ”
);

161 
	`__exùy³
 (
_tŞow”
);

165 
	#__tobody
(
c
, 
f
, 
a
, 
¬gs
) \

166 (
__ex‹nsiÚ__
 \

167 ({ 
__»s
; \

168 ià( (
c
) > 1) \

170 ià(
	`__butš_cÚ¡ªt_p
 (
c
)) \

172 
__c
 = (
c
); \

173 
__»s
 = 
__c
 < -128 || __ø> 255 ? __ø: (
a
)[__c]; \

176 
__»s
 = 
f
 
¬gs
; \

179 
__»s
 = (
a
)[(è(
c
)]; \

180 
__»s
; 
	}
}))

	)

182 #ià!
defšed
 
__NO_CTYPE


183 #ifdeà
__isùy³_f


184 
	$__isùy³_f
 (
®num
)

185 
	$__isùy³_f
 (
®pha
)

186 
	$__isùy³_f
 (
úŒl
)

187 
	$__isùy³_f
 (
dig™
)

188 
	$__isùy³_f
 (
low”
)

189 
	$__isùy³_f
 (
g¿ph
)

190 
	$__isùy³_f
 (
´št
)

191 
	$__isùy³_f
 (
punù
)

192 
	$__isùy³_f
 (
¥aû
)

193 
	$__isùy³_f
 (
uµ”
)

194 
	$__isùy³_f
 (
xdig™
)

195 #ifdeà
__USE_ISOC99


196 
	$__isùy³_f
 (
bÏnk
)

198 #–ià
defšed
 
__isùy³


199 
	#i§Êum
(
c
è
	`__isùy³
((c), 
_IS®num
)

	)

200 
	#i§Íha
(
c
è
	`__isùy³
((c), 
_IS®pha
)

	)

201 
	#isúŒl
(
c
è
	`__isùy³
((c), 
_ISúŒl
)

	)

202 
	#isdig™
(
c
è
	`__isùy³
((c), 
_ISdig™
)

	)

203 
	#i¦ow”
(
c
è
	`__isùy³
((c), 
_ISlow”
)

	)

204 
	#isg¿ph
(
c
è
	`__isùy³
((c), 
_ISg¿ph
)

	)

205 
	#i¥ršt
(
c
è
	`__isùy³
((c), 
_IS´št
)

	)

206 
	#i¥unù
(
c
è
	`__isùy³
((c), 
_ISpunù
)

	)

207 
	#is¥aû
(
c
è
	`__isùy³
((c), 
_IS¥aû
)

	)

208 
	#isuµ”
(
c
è
	`__isùy³
((c), 
_ISuµ”
)

	)

209 
	#isxdig™
(
c
è
	`__isùy³
((c), 
_ISxdig™
)

	)

210 #ifdeà
__USE_ISOC99


211 
	#isbÏnk
(
c
è
	`__isùy³
((c), 
_ISbÏnk
)

	)

215 #ifdeà
__USE_EXTERN_INLINES


216 
__ex‹º_šlše
 

217 
	`__NTH
 (
	$tŞow”
 (
__c
))

219  
__c
 >ğ-128 && __ø< 256 ? (*
	`__ùy³_tŞow”_loc
 ())[__c] : __c;

220 
	}
}

222 
__ex‹º_šlše
 

223 
__NTH
 (
	$touµ”
 (
__c
))

225  
__c
 >ğ-128 && __ø< 256 ? (*
	`__ùy³_touµ”_loc
 ())[__c] : __c;

226 
	}
}

229 #ià
__GNUC__
 >ğ2 && 
defšed
 
__OPTIMIZE__
 && !defšed 
__ılu¥lus


230 
	#tŞow”
(
c
è
	`__tobody
 (c, 
tŞow”
, *
	`__ùy³_tŞow”_loc
 (), (c))

	)

231 
	#touµ”
(
c
è
	`__tobody
 (c, 
touµ”
, *
	`__ùy³_touµ”_loc
 (), (c))

	)

234 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


235 
	#i§scii
(
c
è
	`__i§scii
 (c)

	)

236 
	#tßscii
(
c
è
	`__tßscii
 (c)

	)

238 
	#_tŞow”
(
c
è((è(*
	`__ùy³_tŞow”_loc
 ())[(è(c)])

	)

239 
	#_touµ”
(
c
è((è(*
	`__ùy³_touµ”_loc
 ())[(è(c)])

	)

245 #ifdeà
__USE_XOPEN2K8


259 
	~<xloÿË.h
>

263 
	#__isùy³_l
(
c
, 
ty³
, 
loÿË
) \

264 ((
loÿË
)->
__ùy³_b
[(è(
c
)] & (è
ty³
)

	)

266 
	#__exùy³_l
(
Çme
) \

267 
	`Çme
 (, 
__loÿË_t
è
__THROW


	)

273 
__exùy³_l
 (
i§Êum_l
);

274 
__exùy³_l
 (
i§Íha_l
);

275 
__exùy³_l
 (
isúŒl_l
);

276 
__exùy³_l
 (
isdig™_l
);

277 
__exùy³_l
 (
i¦ow”_l
);

278 
__exùy³_l
 (
isg¿ph_l
);

279 
__exùy³_l
 (
i¥ršt_l
);

280 
__exùy³_l
 (
i¥unù_l
);

281 
__exùy³_l
 (
is¥aû_l
);

282 
__exùy³_l
 (
isuµ”_l
);

283 
__exùy³_l
 (
isxdig™_l
);

285 
__exùy³_l
 (
isbÏnk_l
);

289 
	$__tŞow”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

290 
	$tŞow”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

293 
	$__touµ”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

294 
	$touµ”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

296 #ià
__GNUC__
 >ğ2 && 
defšed
 
__OPTIMIZE__
 && !defšed 
__ılu¥lus


297 
	#__tŞow”_l
(
c
, 
loÿË
) \

298 
	`__tobody
 (
c
, 
__tŞow”_l
, (
loÿË
)->
__ùy³_tŞow”
, (c,†oÿË))

	)

299 
	#__touµ”_l
(
c
, 
loÿË
) \

300 
	`__tobody
 (
c
, 
__touµ”_l
, (
loÿË
)->
__ùy³_touµ”
, (c,†oÿË))

	)

301 
	#tŞow”_l
(
c
, 
loÿË
è
	`__tŞow”_l
 ((c), (loÿË))

	)

302 
	#touµ”_l
(
c
, 
loÿË
è
	`__touµ”_l
 ((c), (loÿË))

	)

306 #iâdeà
__NO_CTYPE


307 
	#__i§Êum_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS®num
, (l))

	)

308 
	#__i§Íha_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS®pha
, (l))

	)

309 
	#__isúŒl_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISúŒl
, (l))

	)

310 
	#__isdig™_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISdig™
, (l))

	)

311 
	#__i¦ow”_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISlow”
, (l))

	)

312 
	#__isg¿ph_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISg¿ph
, (l))

	)

313 
	#__i¥ršt_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS´št
, (l))

	)

314 
	#__i¥unù_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISpunù
, (l))

	)

315 
	#__is¥aû_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS¥aû
, (l))

	)

316 
	#__isuµ”_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISuµ”
, (l))

	)

317 
	#__isxdig™_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISxdig™
, (l))

	)

319 
	#__isbÏnk_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISbÏnk
, (l))

	)

321 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC


322 
	#__i§scii_l
(
c
,
l
è(Ö), 
	`__i§scii
 (c))

	)

323 
	#__tßscii_l
(
c
,
l
è(Ö), 
	`__tßscii
 (c))

	)

326 
	#i§Êum_l
(
c
,
l
è
	`__i§Êum_l
 ((c), (l))

	)

327 
	#i§Íha_l
(
c
,
l
è
	`__i§Íha_l
 ((c), (l))

	)

328 
	#isúŒl_l
(
c
,
l
è
	`__isúŒl_l
 ((c), (l))

	)

329 
	#isdig™_l
(
c
,
l
è
	`__isdig™_l
 ((c), (l))

	)

330 
	#i¦ow”_l
(
c
,
l
è
	`__i¦ow”_l
 ((c), (l))

	)

331 
	#isg¿ph_l
(
c
,
l
è
	`__isg¿ph_l
 ((c), (l))

	)

332 
	#i¥ršt_l
(
c
,
l
è
	`__i¥ršt_l
 ((c), (l))

	)

333 
	#i¥unù_l
(
c
,
l
è
	`__i¥unù_l
 ((c), (l))

	)

334 
	#is¥aû_l
(
c
,
l
è
	`__is¥aû_l
 ((c), (l))

	)

335 
	#isuµ”_l
(
c
,
l
è
	`__isuµ”_l
 ((c), (l))

	)

336 
	#isxdig™_l
(
c
,
l
è
	`__isxdig™_l
 ((c), (l))

	)

338 
	#isbÏnk_l
(
c
,
l
è
	`__isbÏnk_l
 ((c), (l))

	)

340 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC


341 
	#i§scii_l
(
c
,
l
è
	`__i§scii_l
 ((c), (l))

	)

342 
	#tßscii_l
(
c
,
l
è
	`__tßscii_l
 ((c), (l))

	)

349 
__END_DECLS


	@/usr/include/gnu/stubs-32.h

6 #ifdeà
_LIBC


7 #”rÜ 
AµliÿtiÚs
 
may
 
nÙ
 
defše
 
the
 
maüo
 
_LIBC


10 
	#__¡ub___k”Ãl_co¦


	)

11 
	#__¡ub___k”Ãl_sšl


	)

12 
	#__¡ub___k”Ãl_Æ


	)

13 
	#__¡ub_chæags


	)

14 
	#__¡ub_ç‰ach


	)

15 
	#__¡ub_fchæags


	)

16 
	#__¡ub_fd‘ach


	)

17 
	#__¡ub_g‰y


	)

18 
	#__¡ub_lchmod


	)

19 
	#__¡ub_»voke


	)

20 
	#__¡ub_£ogš


	)

21 
	#__¡ub_sig»tuº


	)

22 
	#__¡ub_s¡k


	)

23 
	#__¡ub_¡ty


	)

	@/usr/include/gnu/stubs-64.h

6 #ifdeà
_LIBC


7 #”rÜ 
AµliÿtiÚs
 
may
 
nÙ
 
defše
 
the
 
maüo
 
_LIBC


10 
	#__¡ub_bdæush


	)

11 
	#__¡ub_chæags


	)

12 
	#__¡ub_ç‰ach


	)

13 
	#__¡ub_fchæags


	)

14 
	#__¡ub_fd‘ach


	)

15 
	#__¡ub_g‘msg


	)

16 
	#__¡ub_g‰y


	)

17 
	#__¡ub_lchmod


	)

18 
	#__¡ub_putmsg


	)

19 
	#__¡ub_»voke


	)

20 
	#__¡ub_£ogš


	)

21 
	#__¡ub_sig»tuº


	)

22 
	#__¡ub_s¡k


	)

23 
	#__¡ub_¡ty


	)

	@/usr/include/stdlib.h

23 #iâdef 
_STDLIB_H


25 
	~<ã©u»s.h
>

28 
	#__Ãed_size_t


	)

29 #iâdeà
__Ãed_m®loc_ªd_ÿÎoc


30 
	#__Ãed_wch¬_t


	)

31 
	#__Ãed_NULL


	)

33 
	~<¡ddef.h
>

35 
	g__BEGIN_DECLS


37 #iâdeà
__Ãed_m®loc_ªd_ÿÎoc


38 
	#_STDLIB_H
 1

	)

40 #ià(
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8
è&& !defšed 
_SYS_WAIT_H


42 
	~<b™s/wa™æags.h
>

43 
	~<b™s/wa™¡©us.h
>

45 #ifdeà
__USE_BSD


50 #ià
defšed
 
__GNUC__
 && !defšed 
__ılu¥lus


51 
	#__WAIT_INT
(
¡©us
) \

52 (
	`__ex‹nsiÚ__
 (((uniÚ { 
	`__ty³of
(
¡©us
è
__š
; 
__i
; }) \

53 { .
__š
 = (
¡©us
è}).
__i
))

	)

55 
	#__WAIT_INT
(
¡©us
è(*(*è&(¡©us))

	)

63 #ià!
defšed
 
__GNUC__
 || __GNUC__ < 2 || defšed 
__ılu¥lus


64 
	#__WAIT_STATUS
 *

	)

65 
	#__WAIT_STATUS_DEFN
 *

	)

70 
wa™
 *
	m__u±r
;

71 *
	m__Œ
;

72 } 
	t__WAIT_STATUS
 
	t__©Œibu‹__
 ((
	t__Œª¥¬’t_uniÚ__
));

73 
	#__WAIT_STATUS_DEFN
 *

	)

78 
	#__WAIT_INT
(
¡©us
è(¡©us)

	)

79 
	#__WAIT_STATUS
 *

	)

80 
	#__WAIT_STATUS_DEFN
 *

	)

85 
	#WEXITSTATUS
(
¡©us
è
	`__WEXITSTATUS
 (
	`__WAIT_INT
 (¡©us))

	)

86 
	#WTERMSIG
(
¡©us
è
	`__WTERMSIG
 (
	`__WAIT_INT
 (¡©us))

	)

87 
	#WSTOPSIG
(
¡©us
è
	`__WSTOPSIG
 (
	`__WAIT_INT
 (¡©us))

	)

88 
	#WIFEXITED
(
¡©us
è
	`__WIFEXITED
 (
	`__WAIT_INT
 (¡©us))

	)

89 
	#WIFSIGNALED
(
¡©us
è
	`__WIFSIGNALED
 (
	`__WAIT_INT
 (¡©us))

	)

90 
	#WIFSTOPPED
(
¡©us
è
	`__WIFSTOPPED
 (
	`__WAIT_INT
 (¡©us))

	)

91 #ifdeà
__WIFCONTINUED


92 
	#WIFCONTINUED
(
¡©us
è
	`__WIFCONTINUED
 (
	`__WAIT_INT
 (¡©us))

	)

96 
__BEGIN_NAMESPACE_STD


100 
	mquÙ
;

101 
	m»m
;

102 } 
	tdiv_t
;

105 #iâdeà
__ldiv_t_defšed


108 
	mquÙ
;

109 
	m»m
;

110 } 
	tldiv_t
;

111 
	#__ldiv_t_defšed
 1

	)

113 
	g__END_NAMESPACE_STD


115 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__Îdiv_t_defšed


116 
__BEGIN_NAMESPACE_C99


118 
__ex‹nsiÚ__
 struct

120 
	mquÙ
;

121 
	m»m
;

122 } 
	tÎdiv_t
;

123 
	#__Îdiv_t_defšed
 1

	)

124 
	g__END_NAMESPACE_C99


129 
	#RAND_MAX
 2147483647

	)

134 
	#EXIT_FAILURE
 1

	)

135 
	#EXIT_SUCCESS
 0

	)

139 
	#MB_CUR_MAX
 (
	`__ùy³_g‘_mb_cur_max
 ())

	)

140 
size_t
 
	$__ùy³_g‘_mb_cur_max
 (è
__THROW
 
__wur
;

143 
__BEGIN_NAMESPACE_STD


145 
	$©of
 (
__cÚ¡
 *
__ÅŒ
)

146 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

148 
	$©oi
 (
__cÚ¡
 *
__ÅŒ
)

149 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

151 
	$©Ş
 (
__cÚ¡
 *
__ÅŒ
)

152 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

153 
__END_NAMESPACE_STD


155 #ià
defšed
 
__USE_ISOC99
 || (defšed 
__GLIBC_HAVE_LONG_LONG
 && defšed 
__USE_MISC
)

156 
__BEGIN_NAMESPACE_C99


158 
__ex‹nsiÚ__
 
	$©Şl
 (
__cÚ¡
 *
__ÅŒ
)

159 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

160 
__END_NAMESPACE_C99


163 
__BEGIN_NAMESPACE_STD


165 
	$¡¹od
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

166 **
__»¡riù
 
__’d±r
)

167 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

168 
__END_NAMESPACE_STD


170 #ifdef 
__USE_ISOC99


171 
__BEGIN_NAMESPACE_C99


173 
	$¡¹of
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

174 **
__»¡riù
 
__’d±r
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

176 
	$¡¹Şd
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

177 **
__»¡riù
 
__’d±r
)

178 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

179 
__END_NAMESPACE_C99


182 
__BEGIN_NAMESPACE_STD


184 
	$¡¹Ş
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

185 **
__»¡riù
 
__’d±r
, 
__ba£
)

186 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

188 
	$¡¹oul
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

189 **
__»¡riù
 
__’d±r
, 
__ba£
)

190 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

191 
__END_NAMESPACE_STD


193 #ià
defšed
 
__GLIBC_HAVE_LONG_LONG
 && defšed 
__USE_BSD


195 
__ex‹nsiÚ__


196 
	$¡¹oq
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

197 **
__»¡riù
 
__’d±r
, 
__ba£
)

198 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

200 
__ex‹nsiÚ__


201 
	$¡¹ouq
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

202 **
__»¡riù
 
__’d±r
, 
__ba£
)

203 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

206 #ià
defšed
 
__USE_ISOC99
 || (defšed 
__GLIBC_HAVE_LONG_LONG
 && defšed 
__USE_MISC
)

207 
__BEGIN_NAMESPACE_C99


209 
__ex‹nsiÚ__


210 
	$¡¹Şl
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

211 **
__»¡riù
 
__’d±r
, 
__ba£
)

212 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

214 
__ex‹nsiÚ__


215 
	$¡¹ouÎ
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

216 **
__»¡riù
 
__’d±r
, 
__ba£
)

217 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

218 
__END_NAMESPACE_C99


222 #ifdeà
__USE_GNU


236 
	~<xloÿË.h
>

240 
	$¡¹Ş_l
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

241 **
__»¡riù
 
__’d±r
, 
__ba£
,

242 
__loÿË_t
 
__loc
è
__THROW
 
	`__nÚnuÎ
 ((1, 4)è
__wur
;

244 
	$¡¹oul_l
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

245 **
__»¡riù
 
__’d±r
,

246 
__ba£
, 
__loÿË_t
 
__loc
)

247 
__THROW
 
	`__nÚnuÎ
 ((1, 4)è
__wur
;

249 
__ex‹nsiÚ__


250 
	$¡¹Şl_l
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

251 **
__»¡riù
 
__’d±r
, 
__ba£
,

252 
__loÿË_t
 
__loc
)

253 
__THROW
 
	`__nÚnuÎ
 ((1, 4)è
__wur
;

255 
__ex‹nsiÚ__


256 
	$¡¹ouÎ_l
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

257 **
__»¡riù
 
__’d±r
,

258 
__ba£
, 
__loÿË_t
 
__loc
)

259 
__THROW
 
	`__nÚnuÎ
 ((1, 4)è
__wur
;

261 
	$¡¹od_l
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

262 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

263 
__THROW
 
	`__nÚnuÎ
 ((1, 3)è
__wur
;

265 
	$¡¹of_l
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

266 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

267 
__THROW
 
	`__nÚnuÎ
 ((1, 3)è
__wur
;

269 
	$¡¹Şd_l
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

270 **
__»¡riù
 
__’d±r
,

271 
__loÿË_t
 
__loc
)

272 
__THROW
 
	`__nÚnuÎ
 ((1, 3)è
__wur
;

276 #ifdeà
__USE_EXTERN_INLINES


277 
__BEGIN_NAMESPACE_STD


278 
__ex‹º_šlše
 

279 
	`__NTH
 (
	$©of
 (
__cÚ¡
 *
__ÅŒ
))

281  
	`¡¹od
 (
__ÅŒ
, (**è
NULL
);

282 
	}
}

283 
__ex‹º_šlše
 

284 
__NTH
 (
	$©oi
 (
__cÚ¡
 *
__ÅŒ
))

286  (è
	`¡¹Ş
 (
__ÅŒ
, (**è
NULL
, 10);

287 
	}
}

288 
__ex‹º_šlše
 

289 
__NTH
 (
	$©Ş
 (
__cÚ¡
 *
__ÅŒ
))

291  
	`¡¹Ş
 (
__ÅŒ
, (**è
NULL
, 10);

292 
	}
}

293 
	g__END_NAMESPACE_STD


295 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_ISOC99


296 
__BEGIN_NAMESPACE_C99


297 
__ex‹nsiÚ__
 
__ex‹º_šlše
 

298 
__NTH
 (
	$©Şl
 (
__cÚ¡
 *
__ÅŒ
))

300  
	`¡¹Şl
 (
__ÅŒ
, (**è
NULL
, 10);

301 
	}
}

302 
	g__END_NAMESPACE_C99


307 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN_EXTENDED


311 *
	$l64a
 (
__n
è
__THROW
 
__wur
;

314 
	$a64l
 (
__cÚ¡
 *
__s
)

315 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

319 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_BSD


320 
	~<sys/ty³s.h
>

327 
	$¿ndom
 (è
__THROW
;

330 
	$¤ªdom
 (
__£ed
è
__THROW
;

336 *
	$š™¡©e
 (
__£ed
, *
__¡©ebuf
,

337 
size_t
 
__¡©–’
è
__THROW
 
	`__nÚnuÎ
 ((2));

341 *
	$£t¡©e
 (*
__¡©ebuf
è
__THROW
 
	`__nÚnuÎ
 ((1));

344 #ifdeà
__USE_MISC


349 
	s¿ndom_d©a


351 
št32_t
 *
åŒ
;

352 
št32_t
 *
½Œ
;

353 
št32_t
 *
¡©e
;

354 
¿nd_ty³
;

355 
¿nd_deg
;

356 
¿nd_£p
;

357 
št32_t
 *
’d_±r
;

360 
	$¿ndom_r
 (
¿ndom_d©a
 *
__»¡riù
 
__buf
,

361 
št32_t
 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

363 
	$¤ªdom_r
 (
__£ed
, 
¿ndom_d©a
 *
__buf
)

364 
__THROW
 
	`__nÚnuÎ
 ((2));

366 
	$š™¡©e_r
 (
__£ed
, *
__»¡riù
 
__¡©ebuf
,

367 
size_t
 
__¡©–’
,

368 
¿ndom_d©a
 *
__»¡riù
 
__buf
)

369 
__THROW
 
	`__nÚnuÎ
 ((2, 4));

371 
	$£t¡©e_r
 (*
__»¡riù
 
__¡©ebuf
,

372 
¿ndom_d©a
 *
__»¡riù
 
__buf
)

373 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

378 
__BEGIN_NAMESPACE_STD


380 
	$¿nd
 (è
__THROW
;

382 
	$¤ªd
 (
__£ed
è
__THROW
;

383 
__END_NAMESPACE_STD


385 #ifdeà
__USE_POSIX


387 
	$¿nd_r
 (*
__£ed
è
__THROW
;

391 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


395 
	$d¿nd48
 (è
__THROW
;

396 
	$”ªd48
 (
__xsubi
[3]è
__THROW
 
	`__nÚnuÎ
 ((1));

399 
	$Ìªd48
 (è
__THROW
;

400 
	$Äªd48
 (
__xsubi
[3])

401 
__THROW
 
	`__nÚnuÎ
 ((1));

404 
	$m¿nd48
 (è
__THROW
;

405 
	$j¿nd48
 (
__xsubi
[3])

406 
__THROW
 
	`__nÚnuÎ
 ((1));

409 
	$¤ªd48
 (
__£edv®
è
__THROW
;

410 *
	$£ed48
 (
__£ed16v
[3])

411 
__THROW
 
	`__nÚnuÎ
 ((1));

412 
	$lcÚg48
 (
__·¿m
[7]è
__THROW
 
	`__nÚnuÎ
 ((1));

414 #ifdeà
__USE_MISC


418 
	sd¿nd48_d©a


420 
__x
[3];

421 
__Şd_x
[3];

422 
__c
;

423 
__š™
;

424 
__a
;

428 
	$d¿nd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

429 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

430 
	$”ªd48_r
 (
__xsubi
[3],

431 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

432 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

435 
	$Ìªd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

436 *
__»¡riù
 
__»suÉ
)

437 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

438 
	$Äªd48_r
 (
__xsubi
[3],

439 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

440 *
__»¡riù
 
__»suÉ
)

441 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

444 
	$m¿nd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

445 *
__»¡riù
 
__»suÉ
)

446 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

447 
	$j¿nd48_r
 (
__xsubi
[3],

448 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

449 *
__»¡riù
 
__»suÉ
)

450 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

453 
	$¤ªd48_r
 (
__£edv®
, 
d¿nd48_d©a
 *
__bufãr
)

454 
__THROW
 
	`__nÚnuÎ
 ((2));

456 
	$£ed48_r
 (
__£ed16v
[3],

457 
d¿nd48_d©a
 *
__bufãr
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

459 
	$lcÚg48_r
 (
__·¿m
[7],

460 
d¿nd48_d©a
 *
__bufãr
)

461 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

467 #iâdeà
__m®loc_ªd_ÿÎoc_defšed


468 
	#__m®loc_ªd_ÿÎoc_defšed


	)

469 
__BEGIN_NAMESPACE_STD


471 *
	$m®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

473 *
	$ÿÎoc
 (
size_t
 
__nmemb
, size_ˆ
__size
)

474 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

475 
__END_NAMESPACE_STD


478 #iâdeà
__Ãed_m®loc_ªd_ÿÎoc


479 
__BEGIN_NAMESPACE_STD


485 *
	$»®loc
 (*
__±r
, 
size_t
 
__size
)

486 
__THROW
 
__©Œibu‹_w¬n_unu£d_»suÉ__
;

488 
	$ä“
 (*
__±r
è
__THROW
;

489 
__END_NAMESPACE_STD


491 #ifdef 
__USE_MISC


493 
	$cä“
 (*
__±r
è
__THROW
;

496 #ià
defšed
 
__USE_GNU
 || defšed 
__USE_BSD
 || defšed 
__USE_MISC


497 
	~<®loÿ.h
>

500 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K
) \

501 || 
defšed
 
__USE_BSD


503 *
	$v®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

506 #ifdeà
__USE_XOPEN2K


508 
	$posix_mem®ign
 (**
__mem±r
, 
size_t
 
__®ignm’t
, size_ˆ
__size
)

509 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

512 
__BEGIN_NAMESPACE_STD


514 
	$abÜt
 (è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

518 
	`©ex™
 ((*
__func
è()è
__THROW
 
	`__nÚnuÎ
 ((1));

520 #ifdeà
__USE_GNU


524 #ifdeà
__ılu¥lus


525 "C++" 
	`©_quick_ex™
 ((*
__func
) ())

526 
__THROW
 
	`__asm
 ("©_quick_ex™"è
	`__nÚnuÎ
 ((1));

528 
	`©_quick_ex™
 ((*
__func
è()è
__THROW
 
	`__nÚnuÎ
 ((1));

531 
__END_NAMESPACE_STD


533 #ifdef 
__USE_MISC


536 
	`Ú_ex™
 ((*
__func
è(
__¡©us
, *
__¬g
), *__arg)

537 
__THROW
 
	`__nÚnuÎ
 ((1));

540 
__BEGIN_NAMESPACE_STD


544 
	$ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

546 #ifdeà
__USE_GNU


552 
	$quick_ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

554 
__END_NAMESPACE_STD


556 #ifdeà
__USE_ISOC99


557 
__BEGIN_NAMESPACE_C99


560 
	$_Ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

561 
__END_NAMESPACE_C99


565 
__BEGIN_NAMESPACE_STD


567 *
	$g‘’v
 (
__cÚ¡
 *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

568 
__END_NAMESPACE_STD


572 *
	$__£cu»_g‘’v
 (
__cÚ¡
 *
__Çme
)

573 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

575 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


579 
	$pu‹nv
 (*
__¡ršg
è
__THROW
 
	`__nÚnuÎ
 ((1));

582 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN2K


585 
	$£‹nv
 (
__cÚ¡
 *
__Çme
, __cÚ¡ *
__v®ue
, 
__»¶aû
)

586 
__THROW
 
	`__nÚnuÎ
 ((2));

589 
	$un£‹nv
 (
__cÚ¡
 *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

592 #ifdef 
__USE_MISC


596 
	$ş—»nv
 (è
__THROW
;

600 #ià
defšed
 
__USE_MISC
 \

601 || (
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K
)

606 *
	$mk‹mp
 (*
__‹m¶©e
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

609 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
 \

610 || 
defšed
 
__USE_XOPEN2K8


619 #iâdeà
__USE_FILE_OFFSET64


620 
	$mk¡emp
 (*
__‹m¶©e
è
	`__nÚnuÎ
 ((1)è
__wur
;

622 #ifdeà
__REDIRECT


623 
	`__REDIRECT
 (
mk¡emp
, (*
__‹m¶©e
), 
mk¡emp64
)

624 
	`__nÚnuÎ
 ((1)è
__wur
;

626 
	#mk¡emp
 
mk¡emp64


	)

629 #ifdeà
__USE_LARGEFILE64


630 
	$mk¡emp64
 (*
__‹m¶©e
è
	`__nÚnuÎ
 ((1)è
__wur
;

634 #ifdeà
__USE_MISC


641 #iâdeà
__USE_FILE_OFFSET64


642 
	$mk¡emps
 (*
__‹m¶©e
, 
__suffixËn
è
	`__nÚnuÎ
 ((1)è
__wur
;

644 #ifdeà
__REDIRECT


645 
	`__REDIRECT
 (
mk¡emps
, (*
__‹m¶©e
, 
__suffixËn
),

646 
mk¡emps64
è
	`__nÚnuÎ
 ((1)è
__wur
;

648 
	#mk¡emps
 
mk¡emps64


	)

651 #ifdeà
__USE_LARGEFILE64


652 
	$mk¡emps64
 (*
__‹m¶©e
, 
__suffixËn
)

653 
	`__nÚnuÎ
 ((1)è
__wur
;

657 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN2K8


663 *
	$mkd‹mp
 (*
__‹m¶©e
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

666 #ifdeà
__USE_GNU


673 #iâdeà
__USE_FILE_OFFSET64


674 
	$mko¡emp
 (*
__‹m¶©e
, 
__æags
è
	`__nÚnuÎ
 ((1)è
__wur
;

676 #ifdeà
__REDIRECT


677 
	`__REDIRECT
 (
mko¡emp
, (*
__‹m¶©e
, 
__æags
), 
mko¡emp64
)

678 
	`__nÚnuÎ
 ((1)è
__wur
;

680 
	#mko¡emp
 
mko¡emp64


	)

683 #ifdeà
__USE_LARGEFILE64


684 
	$mko¡emp64
 (*
__‹m¶©e
, 
__æags
è
	`__nÚnuÎ
 ((1)è
__wur
;

693 #iâdeà
__USE_FILE_OFFSET64


694 
	$mko¡emps
 (*
__‹m¶©e
, 
__suffixËn
, 
__æags
)

695 
	`__nÚnuÎ
 ((1)è
__wur
;

697 #ifdeà
__REDIRECT


698 
	`__REDIRECT
 (
mko¡emps
, (*
__‹m¶©e
, 
__suffixËn
,

699 
__æags
), 
mko¡emps64
)

700 
	`__nÚnuÎ
 ((1)è
__wur
;

702 
	#mko¡emps
 
mko¡emps64


	)

705 #ifdeà
__USE_LARGEFILE64


706 
	$mko¡emps64
 (*
__‹m¶©e
, 
__suffixËn
, 
__æags
)

707 
	`__nÚnuÎ
 ((1)è
__wur
;

712 
__BEGIN_NAMESPACE_STD


717 
	$sy¡em
 (
__cÚ¡
 *
__commªd
è
__wur
;

718 
__END_NAMESPACE_STD


721 #ifdef 
__USE_GNU


724 *
	$ÿnÚiÿlize_fe_Çme
 (
__cÚ¡
 *
__Çme
)

725 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

728 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


734 *
	$»®·th
 (
__cÚ¡
 *
__»¡riù
 
__Çme
,

735 *
__»¡riù
 
__»sŞved
è
__THROW
 
__wur
;

740 #iâdeà
__COMPAR_FN_T


741 
	#__COMPAR_FN_T


	)

742 (*
	t__com·r_â_t
è(
	t__cÚ¡
 *, __const *);

744 #ifdef 
__USE_GNU


745 
__com·r_â_t
 
	tcom·risÚ_â_t
;

748 #ifdeà
__USE_GNU


749 (*
	t__com·r_d_â_t
è(
	t__cÚ¡
 *, __const *, *);

752 
__BEGIN_NAMESPACE_STD


755 *
	$b£¬ch
 (
__cÚ¡
 *
__key
, __cÚ¡ *
__ba£
,

756 
size_t
 
__nmemb
, size_ˆ
__size
, 
__com·r_â_t
 
__com·r
)

757 
	`__nÚnuÎ
 ((1, 2, 5)è
__wur
;

761 
	$qsÜt
 (*
__ba£
, 
size_t
 
__nmemb
, size_ˆ
__size
,

762 
__com·r_â_t
 
__com·r
è
	`__nÚnuÎ
 ((1, 4));

763 #ifdeà
__USE_GNU


764 
	$qsÜt_r
 (*
__ba£
, 
size_t
 
__nmemb
, size_ˆ
__size
,

765 
__com·r_d_â_t
 
__com·r
, *
__¬g
)

766 
	`__nÚnuÎ
 ((1, 4));

771 
	$abs
 (
__x
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

772 
	$Ïbs
 (
__x
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

773 
__END_NAMESPACE_STD


775 #ifdeà
__USE_ISOC99


776 
__ex‹nsiÚ__
 
	$Îabs
 (
__x
)

777 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

781 
__BEGIN_NAMESPACE_STD


785 
div_t
 
	$div
 (
__num”
, 
__d’om
)

786 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

787 
ldiv_t
 
	$ldiv
 (
__num”
, 
__d’om
)

788 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

789 
__END_NAMESPACE_STD


791 #ifdeà
__USE_ISOC99


792 
__BEGIN_NAMESPACE_C99


793 
__ex‹nsiÚ__
 
Îdiv_t
 
	$Îdiv
 (
__num”
,

794 
__d’om
)

795 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

796 
__END_NAMESPACE_C99


800 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K
) \

801 || 
defšed
 
__USE_SVID


808 *
	$ecvt
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

809 *
__»¡riù
 
__sign
è
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

814 *
	$fcvt
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

815 *
__»¡riù
 
__sign
è
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

820 *
	$gcvt
 (
__v®ue
, 
__ndig™
, *
__buf
)

821 
__THROW
 
	`__nÚnuÎ
 ((3)è
__wur
;

824 #ifdeà
__USE_MISC


826 *
	$qecvt
 (
__v®ue
, 
__ndig™
,

827 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
)

828 
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

829 *
	$qfcvt
 (
__v®ue
, 
__ndig™
,

830 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
)

831 
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

832 *
	$qgcvt
 (
__v®ue
, 
__ndig™
, *
__buf
)

833 
__THROW
 
	`__nÚnuÎ
 ((3)è
__wur
;

838 
	$ecvt_r
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

839 *
__»¡riù
 
__sign
, *__»¡riù 
__buf
,

840 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

841 
	$fcvt_r
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

842 *
__»¡riù
 
__sign
, *__»¡riù 
__buf
,

843 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

845 
	$qecvt_r
 (
__v®ue
, 
__ndig™
,

846 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
,

847 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

848 
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

849 
	$qfcvt_r
 (
__v®ue
, 
__ndig™
,

850 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
,

851 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

852 
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

857 
__BEGIN_NAMESPACE_STD


860 
	$mbËn
 (
__cÚ¡
 *
__s
, 
size_t
 
__n
è
__THROW
 
__wur
;

863 
	$mbtowc
 (
wch¬_t
 *
__»¡riù
 
__pwc
,

864 
__cÚ¡
 *
__»¡riù
 
__s
, 
size_t
 
__n
è
__THROW
 
__wur
;

867 
	$wùomb
 (*
__s
, 
wch¬_t
 
__wch¬
è
__THROW
 
__wur
;

871 
size_t
 
	$mb¡owcs
 (
wch¬_t
 *
__»¡riù
 
__pwcs
,

872 
__cÚ¡
 *
__»¡riù
 
__s
, 
size_t
 
__n
è
__THROW
;

874 
size_t
 
	$wc¡ombs
 (*
__»¡riù
 
__s
,

875 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__pwcs
, 
size_t
 
__n
)

876 
__THROW
;

877 
__END_NAMESPACE_STD


880 #ifdeà
__USE_SVID


885 
	$½m©ch
 (
__cÚ¡
 *
__»¥Ú£
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

889 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


896 
	$g‘subİt
 (**
__»¡riù
 
__İtiÚp
,

897 *
__cÚ¡
 *
__»¡riù
 
__tok’s
,

898 **
__»¡riù
 
__v®u•
)

899 
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3)è
__wur
;

903 #ifdeà
__USE_XOPEN


905 
	$£tkey
 (
__cÚ¡
 *
__key
è
__THROW
 
	`__nÚnuÎ
 ((1));

911 #ifdeà
__USE_XOPEN2KXSI


913 
	$posix_İ’±
 (
__oæag
è
__wur
;

916 #ifdeà
__USE_XOPEN


921 
	$g¿Á±
 (
__fd
è
__THROW
;

925 
	$uÆock±
 (
__fd
è
__THROW
;

930 *
	$±¢ame
 (
__fd
è
__THROW
 
__wur
;

933 #ifdeà
__USE_GNU


937 
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
)

938 
__THROW
 
	`__nÚnuÎ
 ((2));

941 
	`g‘±
 ();

944 #ifdeà
__USE_BSD


948 
	$g‘lßdavg
 (
__lßdavg
[], 
__ÃËm
)

949 
__THROW
 
	`__nÚnuÎ
 ((1));

954 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše


955 
	~<b™s/¡dlib.h
>

957 #ifdeà
__LDBL_COMPAT


958 
	~<b™s/¡dlib-ldbl.h
>

962 #undeà
__Ãed_m®loc_ªd_ÿÎoc


964 
__END_DECLS


	@/usr/include/sys/sysmacros.h

21 #iâdeà
_SYS_SYSMACROS_H


22 
	#_SYS_SYSMACROS_H
 1

	)

24 
	~<ã©u»s.h
>

29 #ifdeà
__GLIBC_HAVE_LONG_LONG


30 
__BEGIN_DECLS


32 
__ex‹nsiÚ__


33 
	$gnu_dev_majÜ
 (
__dev
)

34 
__THROW
 
__©Œibu‹_cÚ¡__
;

35 
__ex‹nsiÚ__


36 
	$gnu_dev_mšÜ
 (
__dev
)

37 
__THROW
 
__©Œibu‹_cÚ¡__
;

38 
__ex‹nsiÚ__


39 
	$gnu_dev_makedev
 (
__majÜ
,

40 
__mšÜ
)

41 
__THROW
 
__©Œibu‹_cÚ¡__
;

43 #ià
defšed
 
__GNUC__
 && __GNUC__ >ğ2 && defšed 
__USE_EXTERN_INLINES


44 
__ex‹nsiÚ__
 
__ex‹º_šlše
 
__©Œibu‹_cÚ¡__
 

45 
	`__NTH
 (
	$gnu_dev_majÜ
 (
__dev
))

47  ((
__dev
 >> 8) & 0xfff) | (() (__dev >> 32) & ~0xfff);

48 
	}
}

50 
__ex‹nsiÚ__
 
__ex‹º_šlše
 
__©Œibu‹_cÚ¡__
 

51 
__NTH
 (
	$gnu_dev_mšÜ
 (
__dev
))

53  (
__dev
 & 0xff) | (() (__dev >> 12) & ~0xff);

54 
	}
}

56 
__ex‹nsiÚ__
 
__ex‹º_šlše
 
__©Œibu‹_cÚ¡__
 

57 
__NTH
 (
	$gnu_dev_makedev
 (
__majÜ
, 
__mšÜ
))

59  ((
__mšÜ
 & 0xffè| ((
__majÜ
 & 0xfff) << 8)

60 | (((è(
__mšÜ
 & ~0xff)) << 12)

61 | (((è(
__majÜ
 & ~0xfff)) << 32));

62 
	}
}

64 
	g__END_DECLS


67 
	#majÜ
(
dev
è
	`gnu_dev_majÜ
 (dev)

	)

68 
	#mšÜ
(
dev
è
	`gnu_dev_mšÜ
 (dev)

	)

69 
	#makedev
(
maj
, 
mš
è
	`gnu_dev_makedev
 (maj, mš)

	)

	@/usr/include/alloca.h

19 #iâdef 
_ALLOCA_H


20 
	#_ALLOCA_H
 1

	)

22 
	~<ã©u»s.h
>

24 
	#__Ãed_size_t


	)

25 
	~<¡ddef.h
>

27 
	g__BEGIN_DECLS


30 #undeà
®loÿ


33 *
	$®loÿ
 (
size_t
 
__size
è
__THROW
;

35 #ifdef 
__GNUC__


36 
	#®loÿ
(
size
è
	`__butš_®loÿ
 (size)

	)

39 
__END_DECLS


	@/usr/include/asm-generic/bitsperlong.h

1 #iâdeà
__ASM_GENERIC_BITS_PER_LONG


2 
	#__ASM_GENERIC_BITS_PER_LONG


	)

11 #iâdeà
__BITS_PER_LONG


12 
	#__BITS_PER_LONG
 32

	)

	@/usr/include/bits/stdlib-ldbl.h

20 #iâdeà
_STDLIB_H


24 #ifdef 
__USE_ISOC99


25 
__BEGIN_NAMESPACE_C99


26 
	$__LDBL_REDIR1_DECL
 (
¡¹Şd
, 
¡¹od
)

27 
__END_NAMESPACE_C99


30 #ifdeà
__USE_GNU


31 
	$__LDBL_REDIR1_DECL
 (
¡¹Şd_l
, 
¡¹od_l
)

34 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN_EXTENDED


35 #ifdeà
__USE_MISC


36 
	$__LDBL_REDIR1_DECL
 (
qecvt
, 
ecvt
)

37 
	$__LDBL_REDIR1_DECL
 (
qfcvt
, 
fcvt
)

38 
	$__LDBL_REDIR1_DECL
 (
qgcvt
, 
gcvt
)

39 
	$__LDBL_REDIR1_DECL
 (
qecvt_r
, 
ecvt_r
)

40 
	$__LDBL_REDIR1_DECL
 (
qfcvt_r
, 
fcvt_r
)

	@/usr/include/bits/stdlib.h

20 #iâdeà
_STDLIB_H


24 *
	$__»®·th_chk
 (
__cÚ¡
 *
__»¡riù
 
__Çme
,

25 *
__»¡riù
 
__»sŞved
,

26 
size_t
 
__»sŞvedËn
è
__THROW
 
__wur
;

27 *
	`__REDIRECT_NTH
 (
__»®·th_®Ÿs
,

28 (
__cÚ¡
 *
__»¡riù
 
__Çme
,

29 *
__»¡riù
 
__»sŞved
), 
»®·th
è
__wur
;

30 *
	`__REDIRECT_NTH
 (
__»®·th_chk_w¬n
,

31 (
__cÚ¡
 *
__»¡riù
 
__Çme
,

32 *
__»¡riù
 
__»sŞved
,

33 
size_t
 
__»sŞvedËn
), 
__»®·th_chk
è
__wur


34 
	`__w¬Ç‰r
 ("second‡rgument of„ealpath must beƒither NULL or‡t "

37 
__ex‹º_®ways_šlše
 
__wur
 *

38 
	`__NTH
 (
	$»®·th
 (
__cÚ¡
 *
__»¡riù
 
__Çme
, *__»¡riù 
__»sŞved
))

40 ià(
	`__bos
 (
__»sŞved
è!ğ(
size_t
) -1)

42 #ià
defšed
 
_LIBC_LIMITS_H_
 && defšed 
PATH_MAX


43 ià(
	`__bos
 (
__»sŞved
è< 
PATH_MAX
)

44  
	`__»®·th_chk_w¬n
 (
__Çme
, 
__»sŞved
, 
	`__bos
 (__resolved));

46  
	`__»®·th_chk
 (
__Çme
, 
__»sŞved
, 
	`__bos
 (__resolved));

49  
	`__»®·th_®Ÿs
 (
__Çme
, 
__»sŞved
);

50 
	}
}

53 
	$__±¢ame_r_chk
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
,

54 
size_t
 
__Ä—l
è
__THROW
 
	`__nÚnuÎ
 ((2));

55 
	`__REDIRECT_NTH
 (
__±¢ame_r_®Ÿs
, (
__fd
, *
__buf
,

56 
size_t
 
__buæ’
), 
±¢ame_r
)

57 
	`__nÚnuÎ
 ((2));

58 
	`__REDIRECT_NTH
 (
__±¢ame_r_chk_w¬n
,

59 (
__fd
, *
__buf
, 
size_t
 
__buæ’
,

60 
size_t
 
__Ä—l
), 
__±¢ame_r_chk
)

61 
	`__nÚnuÎ
 ((2)è
	`__w¬Ç‰r
 ("ptsname_r called with buflen biggerhan "

64 
__ex‹º_®ways_šlše
 

65 
	`__NTH
 (
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
))

67 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

69 ià(!
	`__butš_cÚ¡ªt_p
 (
__buæ’
))

70  
	`__±¢ame_r_chk
 (
__fd
, 
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

71 ià(
__buæ’
 > 
	`__bos
 (
__buf
))

72  
	`__±¢ame_r_chk_w¬n
 (
__fd
, 
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

74  
	`__±¢ame_r_®Ÿs
 (
__fd
, 
__buf
, 
__buæ’
);

75 
	}
}

78 
	$__wùomb_chk
 (*
__s
, 
wch¬_t
 
__wch¬
, 
size_t
 
__buæ’
)

79 
__THROW
 
__wur
;

80 
	`__REDIRECT_NTH
 (
__wùomb_®Ÿs
, (*
__s
, 
wch¬_t
 
__wch¬
),

81 
wùomb
è
__wur
;

83 
__ex‹º_®ways_šlše
 
__wur
 

84 
	`__NTH
 (
	$wùomb
 (*
__s
, 
wch¬_t
 
__wch¬
))

89 
	#__STDLIB_MB_LEN_MAX
 16

	)

90 #ià
defšed
 
MB_LEN_MAX
 && MB_LEN_MAX !ğ
__STDLIB_MB_LEN_MAX


93 ià(
	`__bos
 (
__s
è!ğ(
size_t
è-1 && 
__STDLIB_MB_LEN_MAX
 > __bos (__s))

94  
	`__wùomb_chk
 (
__s
, 
__wch¬
, 
	`__bos
 (__s));

95  
	`__wùomb_®Ÿs
 (
__s
, 
__wch¬
);

96 
	}
}

99 
size_t
 
	$__mb¡owcs_chk
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

100 
__cÚ¡
 *
__»¡riù
 
__¤c
,

101 
size_t
 
__Ën
, size_ˆ
__d¡Ën
è
__THROW
;

102 
size_t
 
	`__REDIRECT_NTH
 (
__mb¡owcs_®Ÿs
,

103 (
wch¬_t
 *
__»¡riù
 
__d¡
,

104 
__cÚ¡
 *
__»¡riù
 
__¤c
,

105 
size_t
 
__Ën
), 
mb¡owcs
);

106 
size_t
 
	`__REDIRECT_NTH
 (
__mb¡owcs_chk_w¬n
,

107 (
wch¬_t
 *
__»¡riù
 
__d¡
,

108 
__cÚ¡
 *
__»¡riù
 
__¤c
,

109 
size_t
 
__Ën
, size_ˆ
__d¡Ën
), 
__mb¡owcs_chk
)

110 
	`__w¬Ç‰r
 ("mbstowcs called with dst buffer smallerhan†en "

113 
__ex‹º_®ways_šlše
 
size_t


114 
	`__NTH
 (
	$mb¡owcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
, 
__cÚ¡
 *__»¡riù 
__¤c
,

115 
size_t
 
__Ën
))

117 ià(
	`__bos
 (
__d¡
è!ğ(
size_t
) -1)

119 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

120  
	`__mb¡owcs_chk
 (
__d¡
, 
__¤c
, 
__Ën
,

121 
	`__bos
 (
__d¡
è/  (
wch¬_t
));

123 ià(
__Ën
 > 
	`__bos
 (
__d¡
è/  (
wch¬_t
))

124  
	`__mb¡owcs_chk_w¬n
 (
__d¡
, 
__¤c
, 
__Ën
,

125 
	`__bos
 (
__d¡
è/  (
wch¬_t
));

127  
	`__mb¡owcs_®Ÿs
 (
__d¡
, 
__¤c
, 
__Ën
);

128 
	}
}

131 
size_t
 
	$__wc¡ombs_chk
 (*
__»¡riù
 
__d¡
,

132 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
,

133 
size_t
 
__Ën
, size_ˆ
__d¡Ën
è
__THROW
;

134 
size_t
 
	`__REDIRECT_NTH
 (
__wc¡ombs_®Ÿs
,

135 (*
__»¡riù
 
__d¡
,

136 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
,

137 
size_t
 
__Ën
), 
wc¡ombs
);

138 
size_t
 
	`__REDIRECT_NTH
 (
__wc¡ombs_chk_w¬n
,

139 (*
__»¡riù
 
__d¡
,

140 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
,

141 
size_t
 
__Ën
, size_ˆ
__d¡Ën
), 
__wc¡ombs_chk
)

142 
	`__w¬Ç‰r
 ("wcstombs called with dst buffer smallerhan†en");

144 
__ex‹º_®ways_šlše
 
size_t


145 
	`__NTH
 (
	$wc¡ombs
 (*
__»¡riù
 
__d¡
, 
__cÚ¡
 
wch¬_t
 *__»¡riù 
__¤c
,

146 
size_t
 
__Ën
))

148 ià(
	`__bos
 (
__d¡
è!ğ(
size_t
) -1)

150 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

151  
	`__wc¡ombs_chk
 (
__d¡
, 
__¤c
, 
__Ën
, 
	`__bos
 (__dst));

152 ià(
__Ën
 > 
	`__bos
 (
__d¡
))

153  
	`__wc¡ombs_chk_w¬n
 (
__d¡
, 
__¤c
, 
__Ën
, 
	`__bos
 (__dst));

155  
	`__wc¡ombs_®Ÿs
 (
__d¡
, 
__¤c
, 
__Ën
);

156 
	}
}

	@/usr/include/bits/waitflags.h

20 #ià!
defšed
 
_SYS_WAIT_H
 && !defšed 
_STDLIB_H


26 
	#WNOHANG
 1

	)

27 
	#WUNTRACED
 2

	)

30 
	#WSTOPPED
 2

	)

31 
	#WEXITED
 4

	)

32 
	#WCONTINUED
 8

	)

33 
	#WNOWAIT
 0x01000000

	)

35 
	#__WNOTHREAD
 0x20000000

	)

37 
	#__WALL
 0x40000000

	)

38 
	#__WCLONE
 0x80000000

	)

	@/usr/include/bits/waitstatus.h

20 #ià!
defšed
 
_SYS_WAIT_H
 && !defšed 
_STDLIB_H


29 
	#__WEXITSTATUS
(
¡©us
è(((¡©usè& 0xff00è>> 8)

	)

32 
	#__WTERMSIG
(
¡©us
è((¡©usè& 0x7f)

	)

35 
	#__WSTOPSIG
(
¡©us
è
	`__WEXITSTATUS
(¡©us)

	)

38 
	#__WIFEXITED
(
¡©us
è(
	`__WTERMSIG
(¡©usè=ğ0)

	)

41 
	#__WIFSIGNALED
(
¡©us
) \

42 (((sigÃd è(((
¡©us
è& 0x7fè+ 1è>> 1è> 0)

	)

45 
	#__WIFSTOPPED
(
¡©us
è(((¡©usè& 0xffè=ğ0x7f)

	)

49 #ifdeà
WCONTINUED


50 
	#__WIFCONTINUED
(
¡©us
è((¡©usè=ğ
__W_CONTINUED
)

	)

54 
	#__WCOREDUMP
(
¡©us
è((¡©usè& 
__WCOREFLAG
)

	)

57 
	#__W_EXITCODE
(
»t
, 
sig
è(Ô‘è<< 8 | (sig))

	)

58 
	#__W_STOPCODE
(
sig
è((sigè<< 8 | 0x7f)

	)

59 
	#__W_CONTINUED
 0xffff

	)

60 
	#__WCOREFLAG
 0x80

	)

63 #ifdef 
__USE_BSD


65 
	~<’dŸn.h
>

67 
	uwa™


69 
	mw_¡©us
;

72 #if 
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


73 
	m__w_‹rmsig
:7;

74 
	m__w_cÜedump
:1;

75 
	m__w_»tcode
:8;

78 #if 
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


80 
	m__w_»tcode
:8;

81 
	m__w_cÜedump
:1;

82 
	m__w_‹rmsig
:7;

84 } 
	m__wa™_‹rmš©ed
;

87 #if 
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


88 
	m__w_¡İv®
:8;

89 
	m__w_¡İsig
:8;

92 #if 
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


94 
	m__w_¡İsig
:8;

95 
	m__w_¡İv®
:8;

97 } 
	m__wa™_¡İ³d
;

100 
	#w_‹rmsig
 
__wa™_‹rmš©ed
.
__w_‹rmsig


	)

101 
	#w_cÜedump
 
__wa™_‹rmš©ed
.
__w_cÜedump


	)

102 
	#w_»tcode
 
__wa™_‹rmš©ed
.
__w_»tcode


	)

103 
	#w_¡İsig
 
__wa™_¡İ³d
.
__w_¡İsig


	)

104 
	#w_¡İv®
 
__wa™_¡İ³d
.
__w_¡İv®


	)

	@
1
.
1
/usr/include
294
7072
aio.c
anon_inodes.c
attr.c
bad_inode.c
binfmt_aout.c
binfmt_elf.c
binfmt_elf_fdpic.c
binfmt_em86.c
binfmt_flat.c
binfmt_misc.c
binfmt_pod.c
binfmt_pod_1.c
binfmt_pod_fdpic.c
binfmt_script.c
binfmt_som.c
bio-integrity.c
bio.c
block_dev.c
buffer.c
char_dev.c
compat.c
compat_binfmt_elf.c
compat_binfmt_pod.c
compat_ioctl.c
dcache.c
dcookies.c
direct-io.c
drop_caches.c
eventfd.c
eventpoll.c
exec.c
fcntl.c
fhandle.c
fifo.c
file.c
file_table.c
filesystems.c
fs-writeback.c
fs_struct.c
generic_acl.c
inode.c
internal.h
ioctl.c
ioprio.c
libfs.c
locks.c
mbcache.c
mpage.c
namei.c
namespace.c
no-block.c
open.c
pipe.c
pnode.c
pnode.h
posix_acl.c
read_write.c
read_write.h
readdir.c
select.c
seq_file.c
signalfd.c
splice.c
stack.c
stat.c
statfs.c
super.c
sync.c
timerfd.c
utimes.c
xattr.c
xattr_acl.c
/usr/include/asm/byteorder.h
/usr/include/asm/ioctls.h
/usr/include/asm/mman.h
/usr/include/asm/param.h
/usr/include/asm/poll.h
/usr/include/asm/siginfo.h
/usr/include/asm/unistd.h
/usr/include/linux/a.out.h
/usr/include/linux/acct.h
/usr/include/linux/aio_abi.h
/usr/include/linux/atalk.h
/usr/include/linux/atm.h
/usr/include/linux/atm_tcp.h
/usr/include/linux/atmarp.h
/usr/include/linux/atmclip.h
/usr/include/linux/atmdev.h
/usr/include/linux/atmioc.h
/usr/include/linux/atmlec.h
/usr/include/linux/atmmpc.h
/usr/include/linux/atmsvc.h
/usr/include/linux/audit.h
/usr/include/linux/auto_fs.h
/usr/include/linux/auto_fs4.h
/usr/include/linux/binfmts.h
/usr/include/linux/blkpg.h
/usr/include/linux/capability.h
/usr/include/linux/capi.h
/usr/include/linux/cdrom.h
/usr/include/linux/cn_proc.h
/usr/include/linux/dvb/audio.h
/usr/include/linux/dvb/dmx.h
/usr/include/linux/dvb/frontend.h
/usr/include/linux/dvb/video.h
/usr/include/linux/elf-fdpic.h
/usr/include/linux/elf.h
/usr/include/linux/elfcore.h
/usr/include/linux/errno.h
/usr/include/linux/ethtool.h
/usr/include/linux/eventpoll.h
/usr/include/linux/falloc.h
/usr/include/linux/fb.h
/usr/include/linux/fcntl.h
/usr/include/linux/fd.h
/usr/include/linux/filter.h
/usr/include/linux/flat.h
/usr/include/linux/fs.h
/usr/include/linux/gigaset_dev.h
/usr/include/linux/hiddev.h
/usr/include/linux/i2c-dev.h
/usr/include/linux/i2c.h
/usr/include/linux/if.h
/usr/include/linux/if_bonding.h
/usr/include/linux/if_bridge.h
/usr/include/linux/if_ppp.h
/usr/include/linux/if_pppox.h
/usr/include/linux/if_tun.h
/usr/include/linux/in6.h
/usr/include/linux/ioctl.h
/usr/include/linux/ipv6_route.h
/usr/include/linux/joystick.h
/usr/include/linux/kd.h
/usr/include/linux/kdev_t.h
/usr/include/linux/kernel.h
/usr/include/linux/loop.h
/usr/include/linux/lp.h
/usr/include/linux/magic.h
/usr/include/linux/major.h
/usr/include/linux/mii.h
/usr/include/linux/mman.h
/usr/include/linux/mtio.h
/usr/include/linux/nbd.h
/usr/include/linux/ncp_mount.h
/usr/include/linux/netdevice.h
/usr/include/linux/netlink.h
/usr/include/linux/nfs4_mount.h
/usr/include/linux/oom.h
/usr/include/linux/pci.h
/usr/include/linux/perf_event.h
/usr/include/linux/personality.h
/usr/include/linux/poll.h
/usr/include/linux/ppdev.h
/usr/include/linux/ppp_defs.h
/usr/include/linux/ptrace.h
/usr/include/linux/raid/md_u.h
/usr/include/linux/random.h
/usr/include/linux/raw.h
/usr/include/linux/route.h
/usr/include/linux/rtc.h
/usr/include/linux/sched.h
/usr/include/linux/securebits.h
/usr/include/linux/serial.h
/usr/include/linux/shm.h
/usr/include/linux/signal.h
/usr/include/linux/signalfd.h
/usr/include/linux/som.h
/usr/include/linux/sonet.h
/usr/include/linux/soundcard.h
/usr/include/linux/stat.h
/usr/include/linux/stddef.h
/usr/include/linux/string.h
/usr/include/linux/sysctl.h
/usr/include/linux/time.h
/usr/include/linux/tty.h
/usr/include/linux/types.h
/usr/include/linux/uio.h
/usr/include/linux/unistd.h
/usr/include/linux/usbdevice_fs.h
/usr/include/linux/utime.h
/usr/include/linux/utsname.h
/usr/include/linux/videodev2.h
/usr/include/linux/vt.h
/usr/include/linux/wait.h
/usr/include/linux/watchdog.h
/usr/include/linux/xattr.h
/usr/include/scsi/scsi.h
/usr/include/scsi/scsi_ioctl.h
/usr/include/scsi/sg.h
/usr/include/asm-generic/ioctls.h
/usr/include/asm-generic/mman.h
/usr/include/asm-generic/param.h
/usr/include/asm-generic/poll.h
/usr/include/asm-generic/siginfo.h
/usr/include/asm/a.out.h
/usr/include/asm/errno.h
/usr/include/asm/fcntl.h
/usr/include/asm/ioctl.h
/usr/include/asm/posix_types.h
/usr/include/asm/ptrace.h
/usr/include/asm/shmbuf.h
/usr/include/asm/signal.h
/usr/include/asm/types.h
/usr/include/asm/unistd_32.h
/usr/include/asm/unistd_64.h
/usr/include/endian.h
/usr/include/features.h
/usr/include/linux/atmapi.h
/usr/include/linux/atmsap.h
/usr/include/linux/blk_types.h
/usr/include/linux/byteorder/little_endian.h
/usr/include/linux/elf-em.h
/usr/include/linux/hdlc/ioctl.h
/usr/include/linux/if_ether.h
/usr/include/linux/if_link.h
/usr/include/linux/if_packet.h
/usr/include/linux/if_pppol2tp.h
/usr/include/linux/input.h
/usr/include/linux/ipc.h
/usr/include/linux/irqnr.h
/usr/include/linux/kernelcapi.h
/usr/include/linux/limits.h
/usr/include/linux/ncp.h
/usr/include/linux/patchkey.h
/usr/include/linux/pci_regs.h
/usr/include/linux/posix_types.h
/usr/include/linux/socket.h
/usr/include/linux/sockios.h
/usr/include/stdint.h
/usr/include/string.h
/usr/include/sys/ioctl.h
/usr/include/sys/time.h
/usr/include/time.h
/usr/include/unistd.h
/usr/include/asm-generic/errno.h
/usr/include/asm-generic/fcntl.h
/usr/include/asm-generic/ioctl.h
/usr/include/asm-generic/mman-common.h
/usr/include/asm-generic/shmbuf.h
/usr/include/asm-generic/signal-defs.h
/usr/include/asm-generic/types.h
/usr/include/asm/ipcbuf.h
/usr/include/asm/posix_types_32.h
/usr/include/asm/posix_types_64.h
/usr/include/asm/processor-flags.h
/usr/include/asm/ptrace-abi.h
/usr/include/asm/sockios.h
/usr/include/bits/byteswap.h
/usr/include/bits/confname.h
/usr/include/bits/endian.h
/usr/include/bits/environments.h
/usr/include/bits/ioctl-types.h
/usr/include/bits/ioctls.h
/usr/include/bits/posix_opt.h
/usr/include/bits/predefs.h
/usr/include/bits/string.h
/usr/include/bits/string2.h
/usr/include/bits/string3.h
/usr/include/bits/time.h
/usr/include/bits/types.h
/usr/include/bits/unistd.h
/usr/include/bits/wchar.h
/usr/include/bits/wordsize.h
/usr/include/getopt.h
/usr/include/gnu/stubs.h
/usr/include/linux/swab.h
/usr/include/sys/cdefs.h
/usr/include/sys/select.h
/usr/include/sys/ttydefaults.h
/usr/include/sys/types.h
/usr/include/xlocale.h
/usr/include/asm-generic/errno-base.h
/usr/include/asm-generic/int-ll64.h
/usr/include/asm-generic/ipcbuf.h
/usr/include/asm-generic/sockios.h
/usr/include/asm/bitsperlong.h
/usr/include/asm/swab.h
/usr/include/bits/pthreadtypes.h
/usr/include/bits/select.h
/usr/include/bits/select2.h
/usr/include/bits/sigset.h
/usr/include/bits/timex.h
/usr/include/bits/typesizes.h
/usr/include/ctype.h
/usr/include/gnu/stubs-32.h
/usr/include/gnu/stubs-64.h
/usr/include/stdlib.h
/usr/include/sys/sysmacros.h
/usr/include/alloca.h
/usr/include/asm-generic/bitsperlong.h
/usr/include/bits/stdlib-ldbl.h
/usr/include/bits/stdlib.h
/usr/include/bits/waitflags.h
/usr/include/bits/waitstatus.h
